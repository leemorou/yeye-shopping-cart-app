(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function VS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var S1={exports:{}},Mf={};var Sb;function G6(){if(Sb)return Mf;Sb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,i){var o=null;if(i!==void 0&&(o=""+i),a.key!==void 0&&(o=""+a.key),"key"in a){i={};for(var u in a)u!=="key"&&(i[u]=a[u])}else i=a;return a=i.ref,{$$typeof:t,type:n,key:o,ref:a!==void 0?a:null,props:i}}return Mf.Fragment=e,Mf.jsx=r,Mf.jsxs=r,Mf}var Ab;function q6(){return Ab||(Ab=1,S1.exports=G6()),S1.exports}var m=q6(),A1={exports:{}},pt={};var kb;function W6(){if(kb)return pt;kb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),y=Symbol.iterator;function w(Q){return Q===null||typeof Q!="object"?null:(Q=y&&Q[y]||Q["@@iterator"],typeof Q=="function"?Q:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,T={};function I(Q,O,Y){this.props=Q,this.context=O,this.refs=T,this.updater=Y||b}I.prototype.isReactComponent={},I.prototype.setState=function(Q,O){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,O,"setState")},I.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function R(){}R.prototype=I.prototype;function C(Q,O,Y){this.props=Q,this.context=O,this.refs=T,this.updater=Y||b}var z=C.prototype=new R;z.constructor=C,E(z,I.prototype),z.isPureReactComponent=!0;var H=Array.isArray;function X(){}var A={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function N(Q,O,Y){var q=Y.ref;return{$$typeof:t,type:Q,key:O,ref:q!==void 0?q:null,props:Y}}function P(Q,O){return N(Q.type,O,Q.props)}function M(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function j(Q){var O={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(Y){return O[Y]})}var B=/\/+/g;function Se(Q,O){return typeof Q=="object"&&Q!==null&&Q.key!=null?j(""+Q.key):O.toString(36)}function we(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(X,X):(Q.status="pending",Q.then(function(O){Q.status==="pending"&&(Q.status="fulfilled",Q.value=O)},function(O){Q.status==="pending"&&(Q.status="rejected",Q.reason=O)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function se(Q,O,Y,q,te){var ce=typeof Q;(ce==="undefined"||ce==="boolean")&&(Q=null);var Te=!1;if(Q===null)Te=!0;else switch(ce){case"bigint":case"string":case"number":Te=!0;break;case"object":switch(Q.$$typeof){case t:case e:Te=!0;break;case p:return Te=Q._init,se(Te(Q._payload),O,Y,q,te)}}if(Te)return te=te(Q),Te=q===""?"."+Se(Q,0):q,H(te)?(Y="",Te!=null&&(Y=Te.replace(B,"$&/")+"/"),se(te,O,Y,"",function(ke){return ke})):te!=null&&(M(te)&&(te=P(te,Y+(te.key==null||Q&&Q.key===te.key?"":(""+te.key).replace(B,"$&/")+"/")+Te)),O.push(te)),1;Te=0;var Re=q===""?".":q+":";if(H(Q))for(var _e=0;_e<Q.length;_e++)q=Q[_e],ce=Re+Se(q,_e),Te+=se(q,O,Y,ce,te);else if(_e=w(Q),typeof _e=="function")for(Q=_e.call(Q),_e=0;!(q=Q.next()).done;)q=q.value,ce=Re+Se(q,_e++),Te+=se(q,O,Y,ce,te);else if(ce==="object"){if(typeof Q.then=="function")return se(we(Q),O,Y,q,te);throw O=String(Q),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.")}return Te}function oe(Q,O,Y){if(Q==null)return Q;var q=[],te=0;return se(Q,q,"","",function(ce){return O.call(Y,ce,te++)}),q}function le(Q){if(Q._status===-1){var O=Q._result;O=O(),O.then(function(Y){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=Y)},function(Y){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=Y)}),Q._status===-1&&(Q._status=0,Q._result=O)}if(Q._status===1)return Q._result.default;throw Q._result}var ne=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var O=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(O))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)},ye={map:oe,forEach:function(Q,O,Y){oe(Q,function(){O.apply(this,arguments)},Y)},count:function(Q){var O=0;return oe(Q,function(){O++}),O},toArray:function(Q){return oe(Q,function(O){return O})||[]},only:function(Q){if(!M(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}};return pt.Activity=x,pt.Children=ye,pt.Component=I,pt.Fragment=r,pt.Profiler=a,pt.PureComponent=C,pt.StrictMode=n,pt.Suspense=f,pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,pt.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return A.H.useMemoCache(Q)}},pt.cache=function(Q){return function(){return Q.apply(null,arguments)}},pt.cacheSignal=function(){return null},pt.cloneElement=function(Q,O,Y){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var q=E({},Q.props),te=Q.key;if(O!=null)for(ce in O.key!==void 0&&(te=""+O.key),O)!F.call(O,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&O.ref===void 0||(q[ce]=O[ce]);var ce=arguments.length-2;if(ce===1)q.children=Y;else if(1<ce){for(var Te=Array(ce),Re=0;Re<ce;Re++)Te[Re]=arguments[Re+2];q.children=Te}return N(Q.type,te,q)},pt.createContext=function(Q){return Q={$$typeof:o,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:i,_context:Q},Q},pt.createElement=function(Q,O,Y){var q,te={},ce=null;if(O!=null)for(q in O.key!==void 0&&(ce=""+O.key),O)F.call(O,q)&&q!=="key"&&q!=="__self"&&q!=="__source"&&(te[q]=O[q]);var Te=arguments.length-2;if(Te===1)te.children=Y;else if(1<Te){for(var Re=Array(Te),_e=0;_e<Te;_e++)Re[_e]=arguments[_e+2];te.children=Re}if(Q&&Q.defaultProps)for(q in Te=Q.defaultProps,Te)te[q]===void 0&&(te[q]=Te[q]);return N(Q,ce,te)},pt.createRef=function(){return{current:null}},pt.forwardRef=function(Q){return{$$typeof:u,render:Q}},pt.isValidElement=M,pt.lazy=function(Q){return{$$typeof:p,_payload:{_status:-1,_result:Q},_init:le}},pt.memo=function(Q,O){return{$$typeof:d,type:Q,compare:O===void 0?null:O}},pt.startTransition=function(Q){var O=A.T,Y={};A.T=Y;try{var q=Q(),te=A.S;te!==null&&te(Y,q),typeof q=="object"&&q!==null&&typeof q.then=="function"&&q.then(X,ne)}catch(ce){ne(ce)}finally{O!==null&&Y.types!==null&&(O.types=Y.types),A.T=O}},pt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},pt.use=function(Q){return A.H.use(Q)},pt.useActionState=function(Q,O,Y){return A.H.useActionState(Q,O,Y)},pt.useCallback=function(Q,O){return A.H.useCallback(Q,O)},pt.useContext=function(Q){return A.H.useContext(Q)},pt.useDebugValue=function(){},pt.useDeferredValue=function(Q,O){return A.H.useDeferredValue(Q,O)},pt.useEffect=function(Q,O){return A.H.useEffect(Q,O)},pt.useEffectEvent=function(Q){return A.H.useEffectEvent(Q)},pt.useId=function(){return A.H.useId()},pt.useImperativeHandle=function(Q,O,Y){return A.H.useImperativeHandle(Q,O,Y)},pt.useInsertionEffect=function(Q,O){return A.H.useInsertionEffect(Q,O)},pt.useLayoutEffect=function(Q,O){return A.H.useLayoutEffect(Q,O)},pt.useMemo=function(Q,O){return A.H.useMemo(Q,O)},pt.useOptimistic=function(Q,O){return A.H.useOptimistic(Q,O)},pt.useReducer=function(Q,O,Y){return A.H.useReducer(Q,O,Y)},pt.useRef=function(Q){return A.H.useRef(Q)},pt.useState=function(Q){return A.H.useState(Q)},pt.useSyncExternalStore=function(Q,O,Y){return A.H.useSyncExternalStore(Q,O,Y)},pt.useTransition=function(){return A.H.useTransition()},pt.version="19.2.1",pt}var Cb;function sv(){return Cb||(Cb=1,A1.exports=W6()),A1.exports}var re=sv();const Ws=VS(re);var k1={exports:{}},Pf={},C1={exports:{}},N1={};var Nb;function X6(){return Nb||(Nb=1,(function(t){function e(se,oe){var le=se.length;se.push(oe);e:for(;0<le;){var ne=le-1>>>1,ye=se[ne];if(0<a(ye,oe))se[ne]=oe,se[le]=ye,le=ne;else break e}}function r(se){return se.length===0?null:se[0]}function n(se){if(se.length===0)return null;var oe=se[0],le=se.pop();if(le!==oe){se[0]=le;e:for(var ne=0,ye=se.length,Q=ye>>>1;ne<Q;){var O=2*(ne+1)-1,Y=se[O],q=O+1,te=se[q];if(0>a(Y,le))q<ye&&0>a(te,Y)?(se[ne]=te,se[q]=le,ne=q):(se[ne]=Y,se[O]=le,ne=O);else if(q<ye&&0>a(te,le))se[ne]=te,se[q]=le,ne=q;else break e}}return oe}function a(se,oe){var le=se.sortIndex-oe.sortIndex;return le!==0?le:se.id-oe.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var f=[],d=[],p=1,x=null,y=3,w=!1,b=!1,E=!1,T=!1,I=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function z(se){for(var oe=r(d);oe!==null;){if(oe.callback===null)n(d);else if(oe.startTime<=se)n(d),oe.sortIndex=oe.expirationTime,e(f,oe);else break;oe=r(d)}}function H(se){if(E=!1,z(se),!b)if(r(f)!==null)b=!0,X||(X=!0,j());else{var oe=r(d);oe!==null&&we(H,oe.startTime-se)}}var X=!1,A=-1,F=5,N=-1;function P(){return T?!0:!(t.unstable_now()-N<F)}function M(){if(T=!1,X){var se=t.unstable_now();N=se;var oe=!0;try{e:{b=!1,E&&(E=!1,R(A),A=-1),w=!0;var le=y;try{t:{for(z(se),x=r(f);x!==null&&!(x.expirationTime>se&&P());){var ne=x.callback;if(typeof ne=="function"){x.callback=null,y=x.priorityLevel;var ye=ne(x.expirationTime<=se);if(se=t.unstable_now(),typeof ye=="function"){x.callback=ye,z(se),oe=!0;break t}x===r(f)&&n(f),z(se)}else n(f);x=r(f)}if(x!==null)oe=!0;else{var Q=r(d);Q!==null&&we(H,Q.startTime-se),oe=!1}}break e}finally{x=null,y=le,w=!1}oe=void 0}}finally{oe?j():X=!1}}}var j;if(typeof C=="function")j=function(){C(M)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,Se=B.port2;B.port1.onmessage=M,j=function(){Se.postMessage(null)}}else j=function(){I(M,0)};function we(se,oe){A=I(function(){se(t.unstable_now())},oe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(se){se.callback=null},t.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<se?Math.floor(1e3/se):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(se){switch(y){case 1:case 2:case 3:var oe=3;break;default:oe=y}var le=y;y=oe;try{return se()}finally{y=le}},t.unstable_requestPaint=function(){T=!0},t.unstable_runWithPriority=function(se,oe){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var le=y;y=se;try{return oe()}finally{y=le}},t.unstable_scheduleCallback=function(se,oe,le){var ne=t.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?ne+le:ne):le=ne,se){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=le+ye,se={id:p++,callback:oe,priorityLevel:se,startTime:le,expirationTime:ye,sortIndex:-1},le>ne?(se.sortIndex=le,e(d,se),r(f)===null&&se===r(d)&&(E?(R(A),A=-1):E=!0,we(H,le-ne))):(se.sortIndex=ye,e(f,se),b||w||(b=!0,X||(X=!0,j()))),se},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(se){var oe=y;return function(){var le=y;y=oe;try{return se.apply(this,arguments)}finally{y=le}}}})(N1)),N1}var Rb;function Y6(){return Rb||(Rb=1,C1.exports=X6()),C1.exports}var R1={exports:{}},In={};var Ib;function $6(){if(Ib)return In;Ib=1;var t=sv();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(f,d,p){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:f,containerInfo:d,implementation:p}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return In.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,In.createPortal=function(f,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return i(f,d,null,p)},In.flushSync=function(f){var d=o.T,p=n.p;try{if(o.T=null,n.p=2,f)return f()}finally{o.T=d,n.p=p,n.d.f()}},In.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},In.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},In.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var p=d.as,x=u(p,d.crossOrigin),y=typeof d.integrity=="string"?d.integrity:void 0,w=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:w}):p==="script"&&n.d.X(f,{crossOrigin:x,integrity:y,fetchPriority:w,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},In.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},In.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,x=u(p,d.crossOrigin);n.d.L(f,p,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},In.preloadModule=function(f,d){if(typeof f=="string")if(d){var p=u(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},In.requestFormReset=function(f){n.d.r(f)},In.unstable_batchedUpdates=function(f,d){return f(d)},In.useFormState=function(f,d,p){return o.H.useFormState(f,d,p)},In.useFormStatus=function(){return o.H.useHostTransitionStatus()},In.version="19.2.1",In}var Db;function K6(){if(Db)return R1.exports;Db=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),R1.exports=$6(),R1.exports}var Ob;function Q6(){if(Ob)return Pf;Ob=1;var t=Y6(),e=sv(),r=K6();function n(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)l+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var l=s,c=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(c=l.return),s=l.return;while(s)}return l.tag===3?c:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function f(s){if(i(s)!==s)throw Error(n(188))}function d(s){var l=s.alternate;if(!l){if(l=i(s),l===null)throw Error(n(188));return l!==s?null:s}for(var c=s,h=l;;){var v=c.return;if(v===null)break;var _=v.alternate;if(_===null){if(h=v.return,h!==null){c=h;continue}break}if(v.child===_.child){for(_=v.child;_;){if(_===c)return f(v),s;if(_===h)return f(v),l;_=_.sibling}throw Error(n(188))}if(c.return!==h.return)c=v,h=_;else{for(var k=!1,U=v.child;U;){if(U===c){k=!0,c=v,h=_;break}if(U===h){k=!0,h=v,c=_;break}U=U.sibling}if(!k){for(U=_.child;U;){if(U===c){k=!0,c=_,h=v;break}if(U===h){k=!0,h=_,c=v;break}U=U.sibling}if(!k)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:l}function p(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=p(s),l!==null)return l;s=s.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),C=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function j(s){return s===null||typeof s!="object"?null:(s=M&&s[M]||s["@@iterator"],typeof s=="function"?s:null)}var B=Symbol.for("react.client.reference");function Se(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===B?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case E:return"Fragment";case I:return"Profiler";case T:return"StrictMode";case H:return"Suspense";case X:return"SuspenseList";case N:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case b:return"Portal";case C:return s.displayName||"Context";case R:return(s._context.displayName||"Context")+".Consumer";case z:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:Se(s.type)||"Memo";case F:l=s._payload,s=s._init;try{return Se(s(l))}catch{}}return null}var we=Array.isArray,se=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},ne=[],ye=-1;function Q(s){return{current:s}}function O(s){0>ye||(s.current=ne[ye],ne[ye]=null,ye--)}function Y(s,l){ye++,ne[ye]=s.current,s.current=l}var q=Q(null),te=Q(null),ce=Q(null),Te=Q(null);function Re(s,l){switch(Y(ce,l),Y(te,s),Y(q,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?Yw(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=Yw(l),s=$w(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}O(q),Y(q,s)}function _e(){O(q),O(te),O(ce)}function ke(s){s.memoizedState!==null&&Y(Te,s);var l=q.current,c=$w(l,s.type);l!==c&&(Y(te,s),Y(q,c))}function rt(s){te.current===s&&(O(q),O(te)),Te.current===s&&(O(Te),If._currentValue=le)}var L,Xe;function Pe(s){if(L===void 0)try{throw Error()}catch(c){var l=c.stack.trim().match(/\n( *(at )?)/);L=l&&l[1]||"",Xe=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+L+s+Xe}var et=!1;function We(s,l){if(!s||et)return"";et=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(l){var Oe=function(){throw Error()};if(Object.defineProperty(Oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Oe,[])}catch(Ee){var ve=Ee}Reflect.construct(s,[],Oe)}else{try{Oe.call()}catch(Ee){ve=Ee}s.call(Oe.prototype)}}else{try{throw Error()}catch(Ee){ve=Ee}(Oe=s())&&typeof Oe.catch=="function"&&Oe.catch(function(){})}}catch(Ee){if(Ee&&ve&&typeof Ee.stack=="string")return[Ee.stack,ve.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=h.DetermineComponentFrameRoot(),k=_[0],U=_[1];if(k&&U){var ae=k.split(`
`),pe=U.split(`
`);for(v=h=0;h<ae.length&&!ae[h].includes("DetermineComponentFrameRoot");)h++;for(;v<pe.length&&!pe[v].includes("DetermineComponentFrameRoot");)v++;if(h===ae.length||v===pe.length)for(h=ae.length-1,v=pe.length-1;1<=h&&0<=v&&ae[h]!==pe[v];)v--;for(;1<=h&&0<=v;h--,v--)if(ae[h]!==pe[v]){if(h!==1||v!==1)do if(h--,v--,0>v||ae[h]!==pe[v]){var Ne=`
`+ae[h].replace(" at new "," at ");return s.displayName&&Ne.includes("<anonymous>")&&(Ne=Ne.replace("<anonymous>",s.displayName)),Ne}while(1<=h&&0<=v);break}}}finally{et=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?Pe(c):""}function je(s,l){switch(s.tag){case 26:case 27:case 5:return Pe(s.type);case 16:return Pe("Lazy");case 13:return s.child!==l&&l!==null?Pe("Suspense Fallback"):Pe("Suspense");case 19:return Pe("SuspenseList");case 0:case 15:return We(s.type,!1);case 11:return We(s.type.render,!1);case 1:return We(s.type,!0);case 31:return Pe("Activity");default:return""}}function ht(s){try{var l="",c=null;do l+=je(s,c),c=s,s=s.return;while(s);return l}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var wt=Object.prototype.hasOwnProperty,Ft=t.unstable_scheduleCallback,Hr=t.unstable_cancelCallback,ns=t.unstable_shouldYield,Gn=t.unstable_requestPaint,zt=t.unstable_now,Gr=t.unstable_getCurrentPriorityLevel,an=t.unstable_ImmediatePriority,qn=t.unstable_UserBlockingPriority,Xt=t.unstable_NormalPriority,Fr=t.unstable_LowPriority,dt=t.unstable_IdlePriority,rr=t.log,sn=t.unstable_setDisableYieldValue,Mt=null,or=null;function qr(s){if(typeof rr=="function"&&sn(s),or&&typeof or.setStrictMode=="function")try{or.setStrictMode(Mt,s)}catch{}}var dr=Math.clz32?Math.clz32:so,cc=Math.log,Js=Math.LN2;function so(s){return s>>>=0,s===0?32:31-(cc(s)/Js|0)|0}var ma=256,Zs=262144,kr=4194304;function Wn(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Da(s,l,c){var h=s.pendingLanes;if(h===0)return 0;var v=0,_=s.suspendedLanes,k=s.pingedLanes;s=s.warmLanes;var U=h&134217727;return U!==0?(h=U&~_,h!==0?v=Wn(h):(k&=U,k!==0?v=Wn(k):c||(c=U&~s,c!==0&&(v=Wn(c))))):(U=h&~_,U!==0?v=Wn(U):k!==0?v=Wn(k):c||(c=h&~s,c!==0&&(v=Wn(c)))),v===0?0:l!==0&&l!==v&&(l&_)===0&&(_=v&-v,c=l&-l,_>=c||_===32&&(c&4194048)!==0)?l:v}function pa(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function Vu(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uc(){var s=kr;return kr<<=1,(kr&62914560)===0&&(kr=4194304),s}function Oa(s){for(var l=[],c=0;31>c;c++)l.push(s);return l}function ei(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Uu(s,l,c,h,v,_){var k=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var U=s.entanglements,ae=s.expirationTimes,pe=s.hiddenUpdates;for(c=k&~c;0<c;){var Ne=31-dr(c),Oe=1<<Ne;U[Ne]=0,ae[Ne]=-1;var ve=pe[Ne];if(ve!==null)for(pe[Ne]=null,Ne=0;Ne<ve.length;Ne++){var Ee=ve[Ne];Ee!==null&&(Ee.lane&=-536870913)}c&=~Oe}h!==0&&ti(s,h,0),_!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=_&~(k&~l))}function ti(s,l,c){s.pendingLanes|=l,s.suspendedLanes&=~l;var h=31-dr(l);s.entangledLanes|=l,s.entanglements[h]=s.entanglements[h]|1073741824|c&261930}function ri(s,l){var c=s.entangledLanes|=l;for(s=s.entanglements;c;){var h=31-dr(c),v=1<<h;v&l|s[h]&l&&(s[h]|=l),c&=~v}}function io(s,l){var c=l&-l;return c=(c&42)!==0?1:ni(c),(c&(s.suspendedLanes|l))!==0?0:c}function ni(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function as(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function V(){var s=oe.p;return s!==0?s:(s=window.event,s===void 0?32:vb(s.type))}function Z(s,l){var c=oe.p;try{return oe.p=s,l()}finally{oe.p=c}}var G=Math.random().toString(36).slice(2),K="__reactFiber$"+G,J="__reactProps$"+G,ee="__reactContainer$"+G,de="__reactEvents$"+G,Ce="__reactListeners$"+G,me="__reactHandles$"+G,xe="__reactResources$"+G,ge="__reactMarker$"+G;function Be(s){delete s[K],delete s[J],delete s[de],delete s[Ce],delete s[me]}function Ve(s){var l=s[K];if(l)return l;for(var c=s.parentNode;c;){if(l=c[ee]||c[K]){if(c=l.alternate,l.child!==null||c!==null&&c.child!==null)for(s=rb(s);s!==null;){if(c=s[K])return c;s=rb(s)}return l}s=c,c=s.parentNode}return null}function qe(s){if(s=s[K]||s[ee]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function Le(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(n(33))}function Ge(s){var l=s[xe];return l||(l=s[xe]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Ze(s){s[ge]=!0}var Yt=new Set,$t={};function cr(s,l){Nn(s,l),Nn(s+"Capture",l)}function Nn(s,l){for($t[s]=l,s=0;s<l.length;s++)Yt.add(l[s])}var ss=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),is={},ga={};function zi(s){return wt.call(ga,s)?!0:wt.call(is,s)?!1:ss.test(s)?ga[s]=!0:(is[s]=!0,!1)}function Rn(s,l,c){if(zi(l))if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var h=l.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+c)}}function xa(s,l,c){if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+c)}}function Wr(s,l,c,h){if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(l,c,""+h)}}function hn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Hi(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function zu(s,l,c){var h=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var v=h.get,_=h.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return v.call(this)},set:function(k){c=""+k,_.call(this,k)}}),Object.defineProperty(s,l,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(k){c=""+k},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Kt(s){if(!s._valueTracker){var l=Hi(s)?"checked":"value";s._valueTracker=zu(s,l,""+s[l])}}function lo(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var c=l.getValue(),h="";return s&&(h=Hi(s)?s.checked?"true":"false":s.value),s=h,s!==c?(l.setValue(s),!0):!1}function Ts(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var oo=/[\n"\\]/g;function ea(s){return s.replace(oo,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function fc(s,l,c,h,v,_,k,U){s.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.type=k:s.removeAttribute("type"),l!=null?k==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+hn(l)):s.value!==""+hn(l)&&(s.value=""+hn(l)):k!=="submit"&&k!=="reset"||s.removeAttribute("value"),l!=null?Hu(s,k,hn(l)):c!=null?Hu(s,k,hn(c)):h!=null&&s.removeAttribute("value"),v==null&&_!=null&&(s.defaultChecked=!!_),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?s.name=""+hn(U):s.removeAttribute("name")}function uh(s,l,c,h,v,_,k,U){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),l!=null||c!=null){if(!(_!=="submit"&&_!=="reset"||l!=null)){Kt(s);return}c=c!=null?""+hn(c):"",l=l!=null?""+hn(l):c,U||l===s.value||(s.value=l),s.defaultValue=l}h=h??v,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=U?s.checked:!!h,s.defaultChecked=!!h,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(s.name=k),Kt(s)}function Hu(s,l,c){l==="number"&&Ts(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Gi(s,l,c,h){if(s=s.options,l){l={};for(var v=0;v<c.length;v++)l["$"+c[v]]=!0;for(c=0;c<s.length;c++)v=l.hasOwnProperty("$"+s[c].value),s[c].selected!==v&&(s[c].selected=v),v&&h&&(s[c].defaultSelected=!0)}else{for(c=""+hn(c),l=null,v=0;v<s.length;v++){if(s[v].value===c){s[v].selected=!0,h&&(s[v].defaultSelected=!0);return}l!==null||s[v].disabled||(l=s[v])}l!==null&&(l.selected=!0)}}function fh(s,l,c){if(l!=null&&(l=""+hn(l),l!==s.value&&(s.value=l),c==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=c!=null?""+hn(c):""}function qi(s,l,c,h){if(l==null){if(h!=null){if(c!=null)throw Error(n(92));if(we(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),l=c}c=hn(l),s.defaultValue=c,h=s.textContent,h===c&&h!==""&&h!==null&&(s.value=h),Kt(s)}function ta(s,l){if(l){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=l;return}}s.textContent=l}var hh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Gu(s,l,c){var h=l.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":h?s.setProperty(l,c):typeof c!="number"||c===0||hh.has(l)?l==="float"?s.cssFloat=c:s[l]=(""+c).trim():s[l]=c+"px"}function qu(s,l,c){if(l!=null&&typeof l!="object")throw Error(n(62));if(s=s.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||l!=null&&l.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var v in l)h=l[v],l.hasOwnProperty(v)&&c[v]!==h&&Gu(s,v,h)}else for(var _ in l)l.hasOwnProperty(_)&&Gu(s,_,l[_])}function hc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Wi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function dc(s){return Wi.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ls(){}var Wu=null;function Fa(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Xi=null,Ss=null;function co(s){var l=qe(s);if(l&&(s=l.stateNode)){var c=s[J]||null;e:switch(s=l.stateNode,l.type){case"input":if(fc(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),l=c.name,c.type==="radio"&&l!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ea(""+l)+'"][type="radio"]'),l=0;l<c.length;l++){var h=c[l];if(h!==s&&h.form===s.form){var v=h[J]||null;if(!v)throw Error(n(90));fc(h,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(l=0;l<c.length;l++)h=c[l],h.form===s.form&&lo(h)}break e;case"textarea":fh(s,c.value,c.defaultValue);break e;case"select":l=c.value,l!=null&&Gi(s,!!c.multiple,l,!1)}}}var mc=!1;function Yi(s,l,c){if(mc)return s(l,c);mc=!0;try{var h=s(l);return h}finally{if(mc=!1,(Xi!==null||Ss!==null)&&(id(),Xi&&(l=Xi,s=Ss,Ss=Xi=null,co(l),s)))for(l=0;l<s.length;l++)co(s[l])}}function os(s,l){var c=s.stateNode;if(c===null)return null;var h=c[J]||null;if(h===null)return null;c=h[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,l,typeof c));return c}var Ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uo=!1;if(Ma)try{var nr={};Object.defineProperty(nr,"passive",{get:function(){uo=!0}}),window.addEventListener("test",nr,nr),window.removeEventListener("test",nr,nr)}catch{uo=!1}var As=null,Xu=null,fo=null;function Yu(){if(fo)return fo;var s,l=Xu,c=l.length,h,v="value"in As?As.value:As.textContent,_=v.length;for(s=0;s<c&&l[s]===v[s];s++);var k=c-s;for(h=1;h<=k&&l[c-h]===v[_-h];h++);return fo=v.slice(s,1<h?1-h:void 0)}function ho(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function ai(){return!0}function cs(){return!1}function vn(s){function l(c,h,v,_,k){this._reactName=c,this._targetInst=v,this.type=h,this.nativeEvent=_,this.target=k,this.currentTarget=null;for(var U in s)s.hasOwnProperty(U)&&(c=s[U],this[U]=c?c(_):_[U]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?ai:cs,this.isPropagationStopped=cs,this}return x(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ai)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ai)},persist:function(){},isPersistent:ai}),l}var si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ks=vn(si),$i=x({},si,{view:0,detail:0}),$u=vn($i),Ki,pc,Cs,gc=x({},$i,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qi,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Cs&&(Cs&&s.type==="mousemove"?(Ki=s.screenX-Cs.screenX,pc=s.screenY-Cs.screenY):pc=Ki=0,Cs=s),Ki)},movementY:function(s){return"movementY"in s?s.movementY:pc}}),Ku=vn(gc),mo=x({},gc,{dataTransfer:0}),mh=vn(mo),ph=x({},$i,{relatedTarget:0}),po=vn(ph),Qu=x({},si,{animationName:0,elapsedTime:0,pseudoElement:0}),gh=vn(Qu),xc=x({},si,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),xh=vn(xc),vh=x({},si,{data:0}),Ns=vn(vh),yh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_h={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bh(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=wh[s])?!!l[s]:!1}function Qi(){return bh}var Xn=x({},$i,{key:function(s){if(s.key){var l=yh[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=ho(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?_h[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qi,charCode:function(s){return s.type==="keypress"?ho(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ho(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Eh=vn(Xn),Th=x({},gc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ii=vn(Th),g=x({},$i,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qi}),S=vn(g),D=x({},si,{propertyName:0,elapsedTime:0,pseudoElement:0}),W=vn(D),fe=x({},gc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),be=vn(fe),He=x({},si,{newState:0,oldState:0}),xt=vn(He),Mr=[9,13,27,32],Ht=Ma&&"CompositionEvent"in window,_r=null;Ma&&"documentMode"in document&&(_r=document.documentMode);var Pa=Ma&&"TextEvent"in window&&!_r,Rs=Ma&&(!Ht||_r&&8<_r&&11>=_r),us=" ",fs=!1;function go(s,l){switch(s){case"keyup":return Mr.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var yc=!1;function m3(s,l){switch(s){case"compositionend":return vc(l);case"keypress":return l.which!==32?null:(fs=!0,us);case"textInput":return s=l.data,s===us&&fs?null:s;default:return null}}function p3(s,l){if(yc)return s==="compositionend"||!Ht&&go(s,l)?(s=Yu(),fo=Xu=As=null,yc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Rs&&l.locale!=="ko"?null:l.data;default:return null}}var g3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function s_(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!g3[s.type]:l==="textarea"}function i_(s,l,c,h){Xi?Ss?Ss.push(h):Ss=[h]:Xi=h,l=dd(l,"onChange"),0<l.length&&(c=new ks("onChange","change",null,c,h),s.push({event:c,listeners:l}))}var Ju=null,Zu=null;function x3(s){zw(s,0)}function Sh(s){var l=Le(s);if(lo(l))return s}function l_(s,l){if(s==="change")return l}var o_=!1;if(Ma){var Dp;if(Ma){var Op="oninput"in document;if(!Op){var c_=document.createElement("div");c_.setAttribute("oninput","return;"),Op=typeof c_.oninput=="function"}Dp=Op}else Dp=!1;o_=Dp&&(!document.documentMode||9<document.documentMode)}function u_(){Ju&&(Ju.detachEvent("onpropertychange",f_),Zu=Ju=null)}function f_(s){if(s.propertyName==="value"&&Sh(Zu)){var l=[];i_(l,Zu,s,Fa(s)),Yi(x3,l)}}function v3(s,l,c){s==="focusin"?(u_(),Ju=l,Zu=c,Ju.attachEvent("onpropertychange",f_)):s==="focusout"&&u_()}function y3(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Sh(Zu)}function _3(s,l){if(s==="click")return Sh(l)}function w3(s,l){if(s==="input"||s==="change")return Sh(l)}function b3(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var va=typeof Object.is=="function"?Object.is:b3;function ef(s,l){if(va(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var c=Object.keys(s),h=Object.keys(l);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var v=c[h];if(!wt.call(l,v)||!va(s[v],l[v]))return!1}return!0}function h_(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function d_(s,l){var c=h_(s);s=0;for(var h;c;){if(c.nodeType===3){if(h=s+c.textContent.length,s<=l&&h>=l)return{node:c,offset:l-s};s=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=h_(c)}}function m_(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?m_(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function p_(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=Ts(s.document);l instanceof s.HTMLIFrameElement;){try{var c=typeof l.contentWindow.location.href=="string"}catch{c=!1}if(c)s=l.contentWindow;else break;l=Ts(s.document)}return l}function Fp(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var E3=Ma&&"documentMode"in document&&11>=document.documentMode,_c=null,Mp=null,tf=null,Pp=!1;function g_(s,l,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Pp||_c==null||_c!==Ts(h)||(h=_c,"selectionStart"in h&&Fp(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),tf&&ef(tf,h)||(tf=h,h=dd(Mp,"onSelect"),0<h.length&&(l=new ks("onSelect","select",null,l,c),s.push({event:l,listeners:h}),l.target=_c)))}function xo(s,l){var c={};return c[s.toLowerCase()]=l.toLowerCase(),c["Webkit"+s]="webkit"+l,c["Moz"+s]="moz"+l,c}var wc={animationend:xo("Animation","AnimationEnd"),animationiteration:xo("Animation","AnimationIteration"),animationstart:xo("Animation","AnimationStart"),transitionrun:xo("Transition","TransitionRun"),transitionstart:xo("Transition","TransitionStart"),transitioncancel:xo("Transition","TransitionCancel"),transitionend:xo("Transition","TransitionEnd")},jp={},x_={};Ma&&(x_=document.createElement("div").style,"AnimationEvent"in window||(delete wc.animationend.animation,delete wc.animationiteration.animation,delete wc.animationstart.animation),"TransitionEvent"in window||delete wc.transitionend.transition);function vo(s){if(jp[s])return jp[s];if(!wc[s])return s;var l=wc[s],c;for(c in l)if(l.hasOwnProperty(c)&&c in x_)return jp[s]=l[c];return s}var v_=vo("animationend"),y_=vo("animationiteration"),__=vo("animationstart"),T3=vo("transitionrun"),S3=vo("transitionstart"),A3=vo("transitioncancel"),w_=vo("transitionend"),b_=new Map,Lp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lp.push("scrollEnd");function hs(s,l){b_.set(s,l),cr(l,[s])}var Ah=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},ja=[],bc=0,Bp=0;function kh(){for(var s=bc,l=Bp=bc=0;l<s;){var c=ja[l];ja[l++]=null;var h=ja[l];ja[l++]=null;var v=ja[l];ja[l++]=null;var _=ja[l];if(ja[l++]=null,h!==null&&v!==null){var k=h.pending;k===null?v.next=v:(v.next=k.next,k.next=v),h.pending=v}_!==0&&E_(c,v,_)}}function Ch(s,l,c,h){ja[bc++]=s,ja[bc++]=l,ja[bc++]=c,ja[bc++]=h,Bp|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function Vp(s,l,c,h){return Ch(s,l,c,h),Nh(s)}function yo(s,l){return Ch(s,null,null,l),Nh(s)}function E_(s,l,c){s.lanes|=c;var h=s.alternate;h!==null&&(h.lanes|=c);for(var v=!1,_=s.return;_!==null;)_.childLanes|=c,h=_.alternate,h!==null&&(h.childLanes|=c),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(v=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,v&&l!==null&&(v=31-dr(c),s=_.hiddenUpdates,h=s[v],h===null?s[v]=[l]:h.push(l),l.lane=c|536870912),_):null}function Nh(s){if(50<Tf)throw Tf=0,$g=null,Error(n(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var Ec={};function k3(s,l,c,h){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ya(s,l,c,h){return new k3(s,l,c,h)}function Up(s){return s=s.prototype,!(!s||!s.isReactComponent)}function li(s,l){var c=s.alternate;return c===null?(c=ya(s.tag,l,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=l,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,l=s.dependencies,c.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function T_(s,l){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,l=c.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Rh(s,l,c,h,v,_){var k=0;if(h=s,typeof s=="function")Up(s)&&(k=1);else if(typeof s=="string")k=D6(s,c,q.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case N:return s=ya(31,c,l,v),s.elementType=N,s.lanes=_,s;case E:return _o(c.children,v,_,l);case T:k=8,v|=24;break;case I:return s=ya(12,c,l,v|2),s.elementType=I,s.lanes=_,s;case H:return s=ya(13,c,l,v),s.elementType=H,s.lanes=_,s;case X:return s=ya(19,c,l,v),s.elementType=X,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case C:k=10;break e;case R:k=9;break e;case z:k=11;break e;case A:k=14;break e;case F:k=16,h=null;break e}k=29,c=Error(n(130,s===null?"null":typeof s,"")),h=null}return l=ya(k,c,l,v),l.elementType=s,l.type=h,l.lanes=_,l}function _o(s,l,c,h){return s=ya(7,s,h,l),s.lanes=c,s}function zp(s,l,c){return s=ya(6,s,null,l),s.lanes=c,s}function S_(s){var l=ya(18,null,null,0);return l.stateNode=s,l}function Hp(s,l,c){return l=ya(4,s.children!==null?s.children:[],s.key,l),l.lanes=c,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var A_=new WeakMap;function La(s,l){if(typeof s=="object"&&s!==null){var c=A_.get(s);return c!==void 0?c:(l={value:s,source:l,stack:ht(l)},A_.set(s,l),l)}return{value:s,source:l,stack:ht(l)}}var Tc=[],Sc=0,Ih=null,rf=0,Ba=[],Va=0,Ji=null,Is=1,Ds="";function oi(s,l){Tc[Sc++]=rf,Tc[Sc++]=Ih,Ih=s,rf=l}function k_(s,l,c){Ba[Va++]=Is,Ba[Va++]=Ds,Ba[Va++]=Ji,Ji=s;var h=Is;s=Ds;var v=32-dr(h)-1;h&=~(1<<v),c+=1;var _=32-dr(l)+v;if(30<_){var k=v-v%5;_=(h&(1<<k)-1).toString(32),h>>=k,v-=k,Is=1<<32-dr(l)+v|c<<v|h,Ds=_+s}else Is=1<<_|c<<v|h,Ds=s}function Gp(s){s.return!==null&&(oi(s,1),k_(s,1,0))}function qp(s){for(;s===Ih;)Ih=Tc[--Sc],Tc[Sc]=null,rf=Tc[--Sc],Tc[Sc]=null;for(;s===Ji;)Ji=Ba[--Va],Ba[Va]=null,Ds=Ba[--Va],Ba[Va]=null,Is=Ba[--Va],Ba[Va]=null}function C_(s,l){Ba[Va++]=Is,Ba[Va++]=Ds,Ba[Va++]=Ji,Is=l.id,Ds=l.overflow,Ji=s}var yn=null,mr=null,Ot=!1,Zi=null,Ua=!1,Wp=Error(n(519));function el(s){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw nf(La(l,s)),Wp}function N_(s){var l=s.stateNode,c=s.type,h=s.memoizedProps;switch(l[K]=s,l[J]=h,c){case"dialog":kt("cancel",l),kt("close",l);break;case"iframe":case"object":case"embed":kt("load",l);break;case"video":case"audio":for(c=0;c<Af.length;c++)kt(Af[c],l);break;case"source":kt("error",l);break;case"img":case"image":case"link":kt("error",l),kt("load",l);break;case"details":kt("toggle",l);break;case"input":kt("invalid",l),uh(l,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":kt("invalid",l);break;case"textarea":kt("invalid",l),qi(l,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||l.textContent===""+c||h.suppressHydrationWarning===!0||Ww(l.textContent,c)?(h.popover!=null&&(kt("beforetoggle",l),kt("toggle",l)),h.onScroll!=null&&kt("scroll",l),h.onScrollEnd!=null&&kt("scrollend",l),h.onClick!=null&&(l.onclick=ls),l=!0):l=!1,l||el(s,!0)}function R_(s){for(yn=s.return;yn;)switch(yn.tag){case 5:case 31:case 13:Ua=!1;return;case 27:case 3:Ua=!0;return;default:yn=yn.return}}function Ac(s){if(s!==yn)return!1;if(!Ot)return R_(s),Ot=!0,!1;var l=s.tag,c;if((c=l!==3&&l!==27)&&((c=l===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||u1(s.type,s.memoizedProps)),c=!c),c&&mr&&el(s),R_(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));mr=tb(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));mr=tb(s)}else l===27?(l=mr,ml(s.type)?(s=p1,p1=null,mr=s):mr=l):mr=yn?Ha(s.stateNode.nextSibling):null;return!0}function wo(){mr=yn=null,Ot=!1}function Xp(){var s=Zi;return s!==null&&(sa===null?sa=s:sa.push.apply(sa,s),Zi=null),s}function nf(s){Zi===null?Zi=[s]:Zi.push(s)}var Yp=Q(null),bo=null,ci=null;function tl(s,l,c){Y(Yp,l._currentValue),l._currentValue=c}function ui(s){s._currentValue=Yp.current,O(Yp)}function $p(s,l,c){for(;s!==null;){var h=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,h!==null&&(h.childLanes|=l)):h!==null&&(h.childLanes&l)!==l&&(h.childLanes|=l),s===c)break;s=s.return}}function Kp(s,l,c,h){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var _=v.dependencies;if(_!==null){var k=v.child;_=_.firstContext;e:for(;_!==null;){var U=_;_=v;for(var ae=0;ae<l.length;ae++)if(U.context===l[ae]){_.lanes|=c,U=_.alternate,U!==null&&(U.lanes|=c),$p(_.return,c,s),h||(k=null);break e}_=U.next}}else if(v.tag===18){if(k=v.return,k===null)throw Error(n(341));k.lanes|=c,_=k.alternate,_!==null&&(_.lanes|=c),$p(k,c,s),k=null}else k=v.child;if(k!==null)k.return=v;else for(k=v;k!==null;){if(k===s){k=null;break}if(v=k.sibling,v!==null){v.return=k.return,k=v;break}k=k.return}v=k}}function kc(s,l,c,h){s=null;for(var v=l,_=!1;v!==null;){if(!_){if((v.flags&524288)!==0)_=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var k=v.alternate;if(k===null)throw Error(n(387));if(k=k.memoizedProps,k!==null){var U=v.type;va(v.pendingProps.value,k.value)||(s!==null?s.push(U):s=[U])}}else if(v===Te.current){if(k=v.alternate,k===null)throw Error(n(387));k.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(If):s=[If])}v=v.return}s!==null&&Kp(l,s,c,h),l.flags|=262144}function Dh(s){for(s=s.firstContext;s!==null;){if(!va(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Eo(s){bo=s,ci=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function _n(s){return I_(bo,s)}function Oh(s,l){return bo===null&&Eo(s),I_(s,l)}function I_(s,l){var c=l._currentValue;if(l={context:l,memoizedValue:c,next:null},ci===null){if(s===null)throw Error(n(308));ci=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else ci=ci.next=l;return c}var C3=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(c,h){s.push(h)}};this.abort=function(){l.aborted=!0,s.forEach(function(c){return c()})}},N3=t.unstable_scheduleCallback,R3=t.unstable_NormalPriority,Xr={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qp(){return{controller:new C3,data:new Map,refCount:0}}function af(s){s.refCount--,s.refCount===0&&N3(R3,function(){s.controller.abort()})}var sf=null,Jp=0,Cc=0,Nc=null;function I3(s,l){if(sf===null){var c=sf=[];Jp=0,Cc=t1(),Nc={status:"pending",value:void 0,then:function(h){c.push(h)}}}return Jp++,l.then(D_,D_),l}function D_(){if(--Jp===0&&sf!==null){Nc!==null&&(Nc.status="fulfilled");var s=sf;sf=null,Cc=0,Nc=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function D3(s,l){var c=[],h={status:"pending",value:null,reason:null,then:function(v){c.push(v)}};return s.then(function(){h.status="fulfilled",h.value=l;for(var v=0;v<c.length;v++)(0,c[v])(l)},function(v){for(h.status="rejected",h.reason=v,v=0;v<c.length;v++)(0,c[v])(void 0)}),h}var O_=se.S;se.S=function(s,l){gw=zt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&I3(s,l),O_!==null&&O_(s,l)};var To=Q(null);function Zp(){var s=To.current;return s!==null?s:ur.pooledCache}function Fh(s,l){l===null?Y(To,To.current):Y(To,l.pool)}function F_(){var s=Zp();return s===null?null:{parent:Xr._currentValue,pool:s}}var Rc=Error(n(460)),eg=Error(n(474)),Mh=Error(n(542)),Ph={then:function(){}};function M_(s){return s=s.status,s==="fulfilled"||s==="rejected"}function P_(s,l,c){switch(c=s[c],c===void 0?s.push(l):c!==l&&(l.then(ls,ls),l=c),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,L_(s),s;default:if(typeof l.status=="string")l.then(ls,ls);else{if(s=ur,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=l,s.status="pending",s.then(function(h){if(l.status==="pending"){var v=l;v.status="fulfilled",v.value=h}},function(h){if(l.status==="pending"){var v=l;v.status="rejected",v.reason=h}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,L_(s),s}throw Ao=l,Rc}}function So(s){try{var l=s._init;return l(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Ao=c,Rc):c}}var Ao=null;function j_(){if(Ao===null)throw Error(n(459));var s=Ao;return Ao=null,s}function L_(s){if(s===Rc||s===Mh)throw Error(n(483))}var Ic=null,lf=0;function jh(s){var l=lf;return lf+=1,Ic===null&&(Ic=[]),P_(Ic,s,l)}function of(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Lh(s,l){throw l.$$typeof===y?Error(n(525)):(s=Object.prototype.toString.call(l),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function B_(s){function l(ue,ie){if(s){var he=ue.deletions;he===null?(ue.deletions=[ie],ue.flags|=16):he.push(ie)}}function c(ue,ie){if(!s)return null;for(;ie!==null;)l(ue,ie),ie=ie.sibling;return null}function h(ue){for(var ie=new Map;ue!==null;)ue.key!==null?ie.set(ue.key,ue):ie.set(ue.index,ue),ue=ue.sibling;return ie}function v(ue,ie){return ue=li(ue,ie),ue.index=0,ue.sibling=null,ue}function _(ue,ie,he){return ue.index=he,s?(he=ue.alternate,he!==null?(he=he.index,he<ie?(ue.flags|=67108866,ie):he):(ue.flags|=67108866,ie)):(ue.flags|=1048576,ie)}function k(ue){return s&&ue.alternate===null&&(ue.flags|=67108866),ue}function U(ue,ie,he,Ie){return ie===null||ie.tag!==6?(ie=zp(he,ue.mode,Ie),ie.return=ue,ie):(ie=v(ie,he),ie.return=ue,ie)}function ae(ue,ie,he,Ie){var nt=he.type;return nt===E?Ne(ue,ie,he.props.children,Ie,he.key):ie!==null&&(ie.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===F&&So(nt)===ie.type)?(ie=v(ie,he.props),of(ie,he),ie.return=ue,ie):(ie=Rh(he.type,he.key,he.props,null,ue.mode,Ie),of(ie,he),ie.return=ue,ie)}function pe(ue,ie,he,Ie){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==he.containerInfo||ie.stateNode.implementation!==he.implementation?(ie=Hp(he,ue.mode,Ie),ie.return=ue,ie):(ie=v(ie,he.children||[]),ie.return=ue,ie)}function Ne(ue,ie,he,Ie,nt){return ie===null||ie.tag!==7?(ie=_o(he,ue.mode,Ie,nt),ie.return=ue,ie):(ie=v(ie,he),ie.return=ue,ie)}function Oe(ue,ie,he){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=zp(""+ie,ue.mode,he),ie.return=ue,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case w:return he=Rh(ie.type,ie.key,ie.props,null,ue.mode,he),of(he,ie),he.return=ue,he;case b:return ie=Hp(ie,ue.mode,he),ie.return=ue,ie;case F:return ie=So(ie),Oe(ue,ie,he)}if(we(ie)||j(ie))return ie=_o(ie,ue.mode,he,null),ie.return=ue,ie;if(typeof ie.then=="function")return Oe(ue,jh(ie),he);if(ie.$$typeof===C)return Oe(ue,Oh(ue,ie),he);Lh(ue,ie)}return null}function ve(ue,ie,he,Ie){var nt=ie!==null?ie.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return nt!==null?null:U(ue,ie,""+he,Ie);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case w:return he.key===nt?ae(ue,ie,he,Ie):null;case b:return he.key===nt?pe(ue,ie,he,Ie):null;case F:return he=So(he),ve(ue,ie,he,Ie)}if(we(he)||j(he))return nt!==null?null:Ne(ue,ie,he,Ie,null);if(typeof he.then=="function")return ve(ue,ie,jh(he),Ie);if(he.$$typeof===C)return ve(ue,ie,Oh(ue,he),Ie);Lh(ue,he)}return null}function Ee(ue,ie,he,Ie,nt){if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return ue=ue.get(he)||null,U(ie,ue,""+Ie,nt);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case w:return ue=ue.get(Ie.key===null?he:Ie.key)||null,ae(ie,ue,Ie,nt);case b:return ue=ue.get(Ie.key===null?he:Ie.key)||null,pe(ie,ue,Ie,nt);case F:return Ie=So(Ie),Ee(ue,ie,he,Ie,nt)}if(we(Ie)||j(Ie))return ue=ue.get(he)||null,Ne(ie,ue,Ie,nt,null);if(typeof Ie.then=="function")return Ee(ue,ie,he,jh(Ie),nt);if(Ie.$$typeof===C)return Ee(ue,ie,he,Oh(ie,Ie),nt);Lh(ie,Ie)}return null}function Je(ue,ie,he,Ie){for(var nt=null,Bt=null,tt=ie,bt=ie=0,Nt=null;tt!==null&&bt<he.length;bt++){tt.index>bt?(Nt=tt,tt=null):Nt=tt.sibling;var Vt=ve(ue,tt,he[bt],Ie);if(Vt===null){tt===null&&(tt=Nt);break}s&&tt&&Vt.alternate===null&&l(ue,tt),ie=_(Vt,ie,bt),Bt===null?nt=Vt:Bt.sibling=Vt,Bt=Vt,tt=Nt}if(bt===he.length)return c(ue,tt),Ot&&oi(ue,bt),nt;if(tt===null){for(;bt<he.length;bt++)tt=Oe(ue,he[bt],Ie),tt!==null&&(ie=_(tt,ie,bt),Bt===null?nt=tt:Bt.sibling=tt,Bt=tt);return Ot&&oi(ue,bt),nt}for(tt=h(tt);bt<he.length;bt++)Nt=Ee(tt,ue,bt,he[bt],Ie),Nt!==null&&(s&&Nt.alternate!==null&&tt.delete(Nt.key===null?bt:Nt.key),ie=_(Nt,ie,bt),Bt===null?nt=Nt:Bt.sibling=Nt,Bt=Nt);return s&&tt.forEach(function(yl){return l(ue,yl)}),Ot&&oi(ue,bt),nt}function it(ue,ie,he,Ie){if(he==null)throw Error(n(151));for(var nt=null,Bt=null,tt=ie,bt=ie=0,Nt=null,Vt=he.next();tt!==null&&!Vt.done;bt++,Vt=he.next()){tt.index>bt?(Nt=tt,tt=null):Nt=tt.sibling;var yl=ve(ue,tt,Vt.value,Ie);if(yl===null){tt===null&&(tt=Nt);break}s&&tt&&yl.alternate===null&&l(ue,tt),ie=_(yl,ie,bt),Bt===null?nt=yl:Bt.sibling=yl,Bt=yl,tt=Nt}if(Vt.done)return c(ue,tt),Ot&&oi(ue,bt),nt;if(tt===null){for(;!Vt.done;bt++,Vt=he.next())Vt=Oe(ue,Vt.value,Ie),Vt!==null&&(ie=_(Vt,ie,bt),Bt===null?nt=Vt:Bt.sibling=Vt,Bt=Vt);return Ot&&oi(ue,bt),nt}for(tt=h(tt);!Vt.done;bt++,Vt=he.next())Vt=Ee(tt,ue,bt,Vt.value,Ie),Vt!==null&&(s&&Vt.alternate!==null&&tt.delete(Vt.key===null?bt:Vt.key),ie=_(Vt,ie,bt),Bt===null?nt=Vt:Bt.sibling=Vt,Bt=Vt);return s&&tt.forEach(function(H6){return l(ue,H6)}),Ot&&oi(ue,bt),nt}function ir(ue,ie,he,Ie){if(typeof he=="object"&&he!==null&&he.type===E&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case w:e:{for(var nt=he.key;ie!==null;){if(ie.key===nt){if(nt=he.type,nt===E){if(ie.tag===7){c(ue,ie.sibling),Ie=v(ie,he.props.children),Ie.return=ue,ue=Ie;break e}}else if(ie.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===F&&So(nt)===ie.type){c(ue,ie.sibling),Ie=v(ie,he.props),of(Ie,he),Ie.return=ue,ue=Ie;break e}c(ue,ie);break}else l(ue,ie);ie=ie.sibling}he.type===E?(Ie=_o(he.props.children,ue.mode,Ie,he.key),Ie.return=ue,ue=Ie):(Ie=Rh(he.type,he.key,he.props,null,ue.mode,Ie),of(Ie,he),Ie.return=ue,ue=Ie)}return k(ue);case b:e:{for(nt=he.key;ie!==null;){if(ie.key===nt)if(ie.tag===4&&ie.stateNode.containerInfo===he.containerInfo&&ie.stateNode.implementation===he.implementation){c(ue,ie.sibling),Ie=v(ie,he.children||[]),Ie.return=ue,ue=Ie;break e}else{c(ue,ie);break}else l(ue,ie);ie=ie.sibling}Ie=Hp(he,ue.mode,Ie),Ie.return=ue,ue=Ie}return k(ue);case F:return he=So(he),ir(ue,ie,he,Ie)}if(we(he))return Je(ue,ie,he,Ie);if(j(he)){if(nt=j(he),typeof nt!="function")throw Error(n(150));return he=nt.call(he),it(ue,ie,he,Ie)}if(typeof he.then=="function")return ir(ue,ie,jh(he),Ie);if(he.$$typeof===C)return ir(ue,ie,Oh(ue,he),Ie);Lh(ue,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,ie!==null&&ie.tag===6?(c(ue,ie.sibling),Ie=v(ie,he),Ie.return=ue,ue=Ie):(c(ue,ie),Ie=zp(he,ue.mode,Ie),Ie.return=ue,ue=Ie),k(ue)):c(ue,ie)}return function(ue,ie,he,Ie){try{lf=0;var nt=ir(ue,ie,he,Ie);return Ic=null,nt}catch(tt){if(tt===Rc||tt===Mh)throw tt;var Bt=ya(29,tt,null,ue.mode);return Bt.lanes=Ie,Bt.return=ue,Bt}finally{}}}var ko=B_(!0),V_=B_(!1),rl=!1;function tg(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rg(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function nl(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function al(s,l,c){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(Gt&2)!==0){var v=h.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),h.pending=l,l=Nh(s),E_(s,null,c),l}return Ch(s,h,l,c),Nh(s)}function cf(s,l,c){if(l=l.updateQueue,l!==null&&(l=l.shared,(c&4194048)!==0)){var h=l.lanes;h&=s.pendingLanes,c|=h,l.lanes=c,ri(s,c)}}function ng(s,l){var c=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var v=null,_=null;if(c=c.firstBaseUpdate,c!==null){do{var k={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};_===null?v=_=k:_=_.next=k,c=c.next}while(c!==null);_===null?v=_=l:_=_.next=l}else v=_=l;c={baseState:h.baseState,firstBaseUpdate:v,lastBaseUpdate:_,shared:h.shared,callbacks:h.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=l}var ag=!1;function uf(){if(ag){var s=Nc;if(s!==null)throw s}}function ff(s,l,c,h){ag=!1;var v=s.updateQueue;rl=!1;var _=v.firstBaseUpdate,k=v.lastBaseUpdate,U=v.shared.pending;if(U!==null){v.shared.pending=null;var ae=U,pe=ae.next;ae.next=null,k===null?_=pe:k.next=pe,k=ae;var Ne=s.alternate;Ne!==null&&(Ne=Ne.updateQueue,U=Ne.lastBaseUpdate,U!==k&&(U===null?Ne.firstBaseUpdate=pe:U.next=pe,Ne.lastBaseUpdate=ae))}if(_!==null){var Oe=v.baseState;k=0,Ne=pe=ae=null,U=_;do{var ve=U.lane&-536870913,Ee=ve!==U.lane;if(Ee?(Ct&ve)===ve:(h&ve)===ve){ve!==0&&ve===Cc&&(ag=!0),Ne!==null&&(Ne=Ne.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var Je=s,it=U;ve=l;var ir=c;switch(it.tag){case 1:if(Je=it.payload,typeof Je=="function"){Oe=Je.call(ir,Oe,ve);break e}Oe=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=it.payload,ve=typeof Je=="function"?Je.call(ir,Oe,ve):Je,ve==null)break e;Oe=x({},Oe,ve);break e;case 2:rl=!0}}ve=U.callback,ve!==null&&(s.flags|=64,Ee&&(s.flags|=8192),Ee=v.callbacks,Ee===null?v.callbacks=[ve]:Ee.push(ve))}else Ee={lane:ve,tag:U.tag,payload:U.payload,callback:U.callback,next:null},Ne===null?(pe=Ne=Ee,ae=Oe):Ne=Ne.next=Ee,k|=ve;if(U=U.next,U===null){if(U=v.shared.pending,U===null)break;Ee=U,U=Ee.next,Ee.next=null,v.lastBaseUpdate=Ee,v.shared.pending=null}}while(!0);Ne===null&&(ae=Oe),v.baseState=ae,v.firstBaseUpdate=pe,v.lastBaseUpdate=Ne,_===null&&(v.shared.lanes=0),cl|=k,s.lanes=k,s.memoizedState=Oe}}function U_(s,l){if(typeof s!="function")throw Error(n(191,s));s.call(l)}function z_(s,l){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)U_(c[s],l)}var Dc=Q(null),Bh=Q(0);function H_(s,l){s=yi,Y(Bh,s),Y(Dc,l),yi=s|l.baseLanes}function sg(){Y(Bh,yi),Y(Dc,Dc.current)}function ig(){yi=Bh.current,O(Dc),O(Bh)}var _a=Q(null),za=null;function sl(s){var l=s.alternate;Y(Pr,Pr.current&1),Y(_a,s),za===null&&(l===null||Dc.current!==null||l.memoizedState!==null)&&(za=s)}function lg(s){Y(Pr,Pr.current),Y(_a,s),za===null&&(za=s)}function G_(s){s.tag===22?(Y(Pr,Pr.current),Y(_a,s),za===null&&(za=s)):il()}function il(){Y(Pr,Pr.current),Y(_a,_a.current)}function wa(s){O(_a),za===s&&(za=null),O(Pr)}var Pr=Q(0);function Vh(s){for(var l=s;l!==null;){if(l.tag===13){var c=l.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||d1(c)||m1(c)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var fi=0,vt=null,ar=null,Yr=null,Uh=!1,Oc=!1,Co=!1,zh=0,hf=0,Fc=null,O3=0;function Cr(){throw Error(n(321))}function og(s,l){if(l===null)return!1;for(var c=0;c<l.length&&c<s.length;c++)if(!va(s[c],l[c]))return!1;return!0}function cg(s,l,c,h,v,_){return fi=_,vt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,se.H=s===null||s.memoizedState===null?k2:Tg,Co=!1,_=c(h,v),Co=!1,Oc&&(_=W_(l,c,h,v)),q_(s),_}function q_(s){se.H=pf;var l=ar!==null&&ar.next!==null;if(fi=0,Yr=ar=vt=null,Uh=!1,hf=0,Fc=null,l)throw Error(n(300));s===null||$r||(s=s.dependencies,s!==null&&Dh(s)&&($r=!0))}function W_(s,l,c,h){vt=s;var v=0;do{if(Oc&&(Fc=null),hf=0,Oc=!1,25<=v)throw Error(n(301));if(v+=1,Yr=ar=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}se.H=C2,_=l(c,h)}while(Oc);return _}function F3(){var s=se.H,l=s.useState()[0];return l=typeof l.then=="function"?df(l):l,s=s.useState()[0],(ar!==null?ar.memoizedState:null)!==s&&(vt.flags|=1024),l}function ug(){var s=zh!==0;return zh=0,s}function fg(s,l,c){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~c}function hg(s){if(Uh){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Uh=!1}fi=0,Yr=ar=vt=null,Oc=!1,hf=zh=0,Fc=null}function Yn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yr===null?vt.memoizedState=Yr=s:Yr=Yr.next=s,Yr}function jr(){if(ar===null){var s=vt.alternate;s=s!==null?s.memoizedState:null}else s=ar.next;var l=Yr===null?vt.memoizedState:Yr.next;if(l!==null)Yr=l,ar=s;else{if(s===null)throw vt.alternate===null?Error(n(467)):Error(n(310));ar=s,s={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},Yr===null?vt.memoizedState=Yr=s:Yr=Yr.next=s}return Yr}function Hh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function df(s){var l=hf;return hf+=1,Fc===null&&(Fc=[]),s=P_(Fc,s,l),l=vt,(Yr===null?l.memoizedState:Yr.next)===null&&(l=l.alternate,se.H=l===null||l.memoizedState===null?k2:Tg),s}function Gh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return df(s);if(s.$$typeof===C)return _n(s)}throw Error(n(438,String(s)))}function dg(s){var l=null,c=vt.updateQueue;if(c!==null&&(l=c.memoCache),l==null){var h=vt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(l={data:h.data.map(function(v){return v.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),c===null&&(c=Hh(),vt.updateQueue=c),c.memoCache=l,c=l.data[l.index],c===void 0)for(c=l.data[l.index]=Array(s),h=0;h<s;h++)c[h]=P;return l.index++,c}function hi(s,l){return typeof l=="function"?l(s):l}function qh(s){var l=jr();return mg(l,ar,s)}function mg(s,l,c){var h=s.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=c;var v=s.baseQueue,_=h.pending;if(_!==null){if(v!==null){var k=v.next;v.next=_.next,_.next=k}l.baseQueue=v=_,h.pending=null}if(_=s.baseState,v===null)s.memoizedState=_;else{l=v.next;var U=k=null,ae=null,pe=l,Ne=!1;do{var Oe=pe.lane&-536870913;if(Oe!==pe.lane?(Ct&Oe)===Oe:(fi&Oe)===Oe){var ve=pe.revertLane;if(ve===0)ae!==null&&(ae=ae.next={lane:0,revertLane:0,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),Oe===Cc&&(Ne=!0);else if((fi&ve)===ve){pe=pe.next,ve===Cc&&(Ne=!0);continue}else Oe={lane:0,revertLane:pe.revertLane,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},ae===null?(U=ae=Oe,k=_):ae=ae.next=Oe,vt.lanes|=ve,cl|=ve;Oe=pe.action,Co&&c(_,Oe),_=pe.hasEagerState?pe.eagerState:c(_,Oe)}else ve={lane:Oe,revertLane:pe.revertLane,gesture:pe.gesture,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},ae===null?(U=ae=ve,k=_):ae=ae.next=ve,vt.lanes|=Oe,cl|=Oe;pe=pe.next}while(pe!==null&&pe!==l);if(ae===null?k=_:ae.next=U,!va(_,s.memoizedState)&&($r=!0,Ne&&(c=Nc,c!==null)))throw c;s.memoizedState=_,s.baseState=k,s.baseQueue=ae,h.lastRenderedState=_}return v===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function pg(s){var l=jr(),c=l.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var h=c.dispatch,v=c.pending,_=l.memoizedState;if(v!==null){c.pending=null;var k=v=v.next;do _=s(_,k.action),k=k.next;while(k!==v);va(_,l.memoizedState)||($r=!0),l.memoizedState=_,l.baseQueue===null&&(l.baseState=_),c.lastRenderedState=_}return[_,h]}function X_(s,l,c){var h=vt,v=jr(),_=Ot;if(_){if(c===void 0)throw Error(n(407));c=c()}else c=l();var k=!va((ar||v).memoizedState,c);if(k&&(v.memoizedState=c,$r=!0),v=v.queue,vg(K_.bind(null,h,v,s),[s]),v.getSnapshot!==l||k||Yr!==null&&Yr.memoizedState.tag&1){if(h.flags|=2048,Mc(9,{destroy:void 0},$_.bind(null,h,v,c,l),null),ur===null)throw Error(n(349));_||(fi&127)!==0||Y_(h,l,c)}return c}function Y_(s,l,c){s.flags|=16384,s={getSnapshot:l,value:c},l=vt.updateQueue,l===null?(l=Hh(),vt.updateQueue=l,l.stores=[s]):(c=l.stores,c===null?l.stores=[s]:c.push(s))}function $_(s,l,c,h){l.value=c,l.getSnapshot=h,Q_(l)&&J_(s)}function K_(s,l,c){return c(function(){Q_(l)&&J_(s)})}function Q_(s){var l=s.getSnapshot;s=s.value;try{var c=l();return!va(s,c)}catch{return!0}}function J_(s){var l=yo(s,2);l!==null&&ia(l,s,2)}function gg(s){var l=Yn();if(typeof s=="function"){var c=s;if(s=c(),Co){qr(!0);try{c()}finally{qr(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:s},l}function Z_(s,l,c,h){return s.baseState=c,mg(s,ar,typeof h=="function"?h:hi)}function M3(s,l,c,h,v){if(Yh(s))throw Error(n(485));if(s=l.action,s!==null){var _={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){_.listeners.push(k)}};se.T!==null?c(!0):_.isTransition=!1,h(_),c=l.pending,c===null?(_.next=l.pending=_,e2(l,_)):(_.next=c.next,l.pending=c.next=_)}}function e2(s,l){var c=l.action,h=l.payload,v=s.state;if(l.isTransition){var _=se.T,k={};se.T=k;try{var U=c(v,h),ae=se.S;ae!==null&&ae(k,U),t2(s,l,U)}catch(pe){xg(s,l,pe)}finally{_!==null&&k.types!==null&&(_.types=k.types),se.T=_}}else try{_=c(v,h),t2(s,l,_)}catch(pe){xg(s,l,pe)}}function t2(s,l,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){r2(s,l,h)},function(h){return xg(s,l,h)}):r2(s,l,c)}function r2(s,l,c){l.status="fulfilled",l.value=c,n2(l),s.state=c,l=s.pending,l!==null&&(c=l.next,c===l?s.pending=null:(c=c.next,l.next=c,e2(s,c)))}function xg(s,l,c){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do l.status="rejected",l.reason=c,n2(l),l=l.next;while(l!==h)}s.action=null}function n2(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function a2(s,l){return l}function s2(s,l){if(Ot){var c=ur.formState;if(c!==null){e:{var h=vt;if(Ot){if(mr){t:{for(var v=mr,_=Ua;v.nodeType!==8;){if(!_){v=null;break t}if(v=Ha(v.nextSibling),v===null){v=null;break t}}_=v.data,v=_==="F!"||_==="F"?v:null}if(v){mr=Ha(v.nextSibling),h=v.data==="F!";break e}}el(h)}h=!1}h&&(l=c[0])}}return c=Yn(),c.memoizedState=c.baseState=l,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a2,lastRenderedState:l},c.queue=h,c=T2.bind(null,vt,h),h.dispatch=c,h=gg(!1),_=Eg.bind(null,vt,!1,h.queue),h=Yn(),v={state:l,dispatch:null,action:s,pending:null},h.queue=v,c=M3.bind(null,vt,v,_,c),v.dispatch=c,h.memoizedState=s,[l,c,!1]}function i2(s){var l=jr();return l2(l,ar,s)}function l2(s,l,c){if(l=mg(s,l,a2)[0],s=qh(hi)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var h=df(l)}catch(k){throw k===Rc?Mh:k}else h=l;l=jr();var v=l.queue,_=v.dispatch;return c!==l.memoizedState&&(vt.flags|=2048,Mc(9,{destroy:void 0},P3.bind(null,v,c),null)),[h,_,s]}function P3(s,l){s.action=l}function o2(s){var l=jr(),c=ar;if(c!==null)return l2(l,c,s);jr(),l=l.memoizedState,c=jr();var h=c.queue.dispatch;return c.memoizedState=s,[l,h,!1]}function Mc(s,l,c,h){return s={tag:s,create:c,deps:h,inst:l,next:null},l=vt.updateQueue,l===null&&(l=Hh(),vt.updateQueue=l),c=l.lastEffect,c===null?l.lastEffect=s.next=s:(h=c.next,c.next=s,s.next=h,l.lastEffect=s),s}function c2(){return jr().memoizedState}function Wh(s,l,c,h){var v=Yn();vt.flags|=s,v.memoizedState=Mc(1|l,{destroy:void 0},c,h===void 0?null:h)}function Xh(s,l,c,h){var v=jr();h=h===void 0?null:h;var _=v.memoizedState.inst;ar!==null&&h!==null&&og(h,ar.memoizedState.deps)?v.memoizedState=Mc(l,_,c,h):(vt.flags|=s,v.memoizedState=Mc(1|l,_,c,h))}function u2(s,l){Wh(8390656,8,s,l)}function vg(s,l){Xh(2048,8,s,l)}function j3(s){vt.flags|=4;var l=vt.updateQueue;if(l===null)l=Hh(),vt.updateQueue=l,l.events=[s];else{var c=l.events;c===null?l.events=[s]:c.push(s)}}function f2(s){var l=jr().memoizedState;return j3({ref:l,nextImpl:s}),function(){if((Gt&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function h2(s,l){return Xh(4,2,s,l)}function d2(s,l){return Xh(4,4,s,l)}function m2(s,l){if(typeof l=="function"){s=s();var c=l(s);return function(){typeof c=="function"?c():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function p2(s,l,c){c=c!=null?c.concat([s]):null,Xh(4,4,m2.bind(null,l,s),c)}function yg(){}function g2(s,l){var c=jr();l=l===void 0?null:l;var h=c.memoizedState;return l!==null&&og(l,h[1])?h[0]:(c.memoizedState=[s,l],s)}function x2(s,l){var c=jr();l=l===void 0?null:l;var h=c.memoizedState;if(l!==null&&og(l,h[1]))return h[0];if(h=s(),Co){qr(!0);try{s()}finally{qr(!1)}}return c.memoizedState=[h,l],h}function _g(s,l,c){return c===void 0||(fi&1073741824)!==0&&(Ct&261930)===0?s.memoizedState=l:(s.memoizedState=c,s=vw(),vt.lanes|=s,cl|=s,c)}function v2(s,l,c,h){return va(c,l)?c:Dc.current!==null?(s=_g(s,c,h),va(s,l)||($r=!0),s):(fi&42)===0||(fi&1073741824)!==0&&(Ct&261930)===0?($r=!0,s.memoizedState=c):(s=vw(),vt.lanes|=s,cl|=s,l)}function y2(s,l,c,h,v){var _=oe.p;oe.p=_!==0&&8>_?_:8;var k=se.T,U={};se.T=U,Eg(s,!1,l,c);try{var ae=v(),pe=se.S;if(pe!==null&&pe(U,ae),ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Ne=D3(ae,h);mf(s,l,Ne,Ta(s))}else mf(s,l,h,Ta(s))}catch(Oe){mf(s,l,{then:function(){},status:"rejected",reason:Oe},Ta())}finally{oe.p=_,k!==null&&U.types!==null&&(k.types=U.types),se.T=k}}function L3(){}function wg(s,l,c,h){if(s.tag!==5)throw Error(n(476));var v=_2(s).queue;y2(s,v,l,le,c===null?L3:function(){return w2(s),c(h)})}function _2(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:le},next:null};var c={};return l.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:c},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function w2(s){var l=_2(s);l.next===null&&(l=s.alternate.memoizedState),mf(s,l.next.queue,{},Ta())}function bg(){return _n(If)}function b2(){return jr().memoizedState}function E2(){return jr().memoizedState}function B3(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var c=Ta();s=nl(c);var h=al(l,s,c);h!==null&&(ia(h,l,c),cf(h,l,c)),l={cache:Qp()},s.payload=l;return}l=l.return}}function V3(s,l,c){var h=Ta();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Yh(s)?S2(l,c):(c=Vp(s,l,c,h),c!==null&&(ia(c,s,h),A2(c,l,h)))}function T2(s,l,c){var h=Ta();mf(s,l,c,h)}function mf(s,l,c,h){var v={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Yh(s))S2(l,v);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=l.lastRenderedReducer,_!==null))try{var k=l.lastRenderedState,U=_(k,c);if(v.hasEagerState=!0,v.eagerState=U,va(U,k))return Ch(s,l,v,0),ur===null&&kh(),!1}catch{}finally{}if(c=Vp(s,l,v,h),c!==null)return ia(c,s,h),A2(c,l,h),!0}return!1}function Eg(s,l,c,h){if(h={lane:2,revertLane:t1(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Yh(s)){if(l)throw Error(n(479))}else l=Vp(s,c,h,2),l!==null&&ia(l,s,2)}function Yh(s){var l=s.alternate;return s===vt||l!==null&&l===vt}function S2(s,l){Oc=Uh=!0;var c=s.pending;c===null?l.next=l:(l.next=c.next,c.next=l),s.pending=l}function A2(s,l,c){if((c&4194048)!==0){var h=l.lanes;h&=s.pendingLanes,c|=h,l.lanes=c,ri(s,c)}}var pf={readContext:_n,use:Gh,useCallback:Cr,useContext:Cr,useEffect:Cr,useImperativeHandle:Cr,useLayoutEffect:Cr,useInsertionEffect:Cr,useMemo:Cr,useReducer:Cr,useRef:Cr,useState:Cr,useDebugValue:Cr,useDeferredValue:Cr,useTransition:Cr,useSyncExternalStore:Cr,useId:Cr,useHostTransitionStatus:Cr,useFormState:Cr,useActionState:Cr,useOptimistic:Cr,useMemoCache:Cr,useCacheRefresh:Cr};pf.useEffectEvent=Cr;var k2={readContext:_n,use:Gh,useCallback:function(s,l){return Yn().memoizedState=[s,l===void 0?null:l],s},useContext:_n,useEffect:u2,useImperativeHandle:function(s,l,c){c=c!=null?c.concat([s]):null,Wh(4194308,4,m2.bind(null,l,s),c)},useLayoutEffect:function(s,l){return Wh(4194308,4,s,l)},useInsertionEffect:function(s,l){Wh(4,2,s,l)},useMemo:function(s,l){var c=Yn();l=l===void 0?null:l;var h=s();if(Co){qr(!0);try{s()}finally{qr(!1)}}return c.memoizedState=[h,l],h},useReducer:function(s,l,c){var h=Yn();if(c!==void 0){var v=c(l);if(Co){qr(!0);try{c(l)}finally{qr(!1)}}}else v=l;return h.memoizedState=h.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},h.queue=s,s=s.dispatch=V3.bind(null,vt,s),[h.memoizedState,s]},useRef:function(s){var l=Yn();return s={current:s},l.memoizedState=s},useState:function(s){s=gg(s);var l=s.queue,c=T2.bind(null,vt,l);return l.dispatch=c,[s.memoizedState,c]},useDebugValue:yg,useDeferredValue:function(s,l){var c=Yn();return _g(c,s,l)},useTransition:function(){var s=gg(!1);return s=y2.bind(null,vt,s.queue,!0,!1),Yn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,c){var h=vt,v=Yn();if(Ot){if(c===void 0)throw Error(n(407));c=c()}else{if(c=l(),ur===null)throw Error(n(349));(Ct&127)!==0||Y_(h,l,c)}v.memoizedState=c;var _={value:c,getSnapshot:l};return v.queue=_,u2(K_.bind(null,h,_,s),[s]),h.flags|=2048,Mc(9,{destroy:void 0},$_.bind(null,h,_,c,l),null),c},useId:function(){var s=Yn(),l=ur.identifierPrefix;if(Ot){var c=Ds,h=Is;c=(h&~(1<<32-dr(h)-1)).toString(32)+c,l="_"+l+"R_"+c,c=zh++,0<c&&(l+="H"+c.toString(32)),l+="_"}else c=O3++,l="_"+l+"r_"+c.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:bg,useFormState:s2,useActionState:s2,useOptimistic:function(s){var l=Yn();l.memoizedState=l.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=c,l=Eg.bind(null,vt,!0,c),c.dispatch=l,[s,l]},useMemoCache:dg,useCacheRefresh:function(){return Yn().memoizedState=B3.bind(null,vt)},useEffectEvent:function(s){var l=Yn(),c={impl:s};return l.memoizedState=c,function(){if((Gt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},Tg={readContext:_n,use:Gh,useCallback:g2,useContext:_n,useEffect:vg,useImperativeHandle:p2,useInsertionEffect:h2,useLayoutEffect:d2,useMemo:x2,useReducer:qh,useRef:c2,useState:function(){return qh(hi)},useDebugValue:yg,useDeferredValue:function(s,l){var c=jr();return v2(c,ar.memoizedState,s,l)},useTransition:function(){var s=qh(hi)[0],l=jr().memoizedState;return[typeof s=="boolean"?s:df(s),l]},useSyncExternalStore:X_,useId:b2,useHostTransitionStatus:bg,useFormState:i2,useActionState:i2,useOptimistic:function(s,l){var c=jr();return Z_(c,ar,s,l)},useMemoCache:dg,useCacheRefresh:E2};Tg.useEffectEvent=f2;var C2={readContext:_n,use:Gh,useCallback:g2,useContext:_n,useEffect:vg,useImperativeHandle:p2,useInsertionEffect:h2,useLayoutEffect:d2,useMemo:x2,useReducer:pg,useRef:c2,useState:function(){return pg(hi)},useDebugValue:yg,useDeferredValue:function(s,l){var c=jr();return ar===null?_g(c,s,l):v2(c,ar.memoizedState,s,l)},useTransition:function(){var s=pg(hi)[0],l=jr().memoizedState;return[typeof s=="boolean"?s:df(s),l]},useSyncExternalStore:X_,useId:b2,useHostTransitionStatus:bg,useFormState:o2,useActionState:o2,useOptimistic:function(s,l){var c=jr();return ar!==null?Z_(c,ar,s,l):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:dg,useCacheRefresh:E2};C2.useEffectEvent=f2;function Sg(s,l,c,h){l=s.memoizedState,c=c(h,l),c=c==null?l:x({},l,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Ag={enqueueSetState:function(s,l,c){s=s._reactInternals;var h=Ta(),v=nl(h);v.payload=l,c!=null&&(v.callback=c),l=al(s,v,h),l!==null&&(ia(l,s,h),cf(l,s,h))},enqueueReplaceState:function(s,l,c){s=s._reactInternals;var h=Ta(),v=nl(h);v.tag=1,v.payload=l,c!=null&&(v.callback=c),l=al(s,v,h),l!==null&&(ia(l,s,h),cf(l,s,h))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var c=Ta(),h=nl(c);h.tag=2,l!=null&&(h.callback=l),l=al(s,h,c),l!==null&&(ia(l,s,c),cf(l,s,c))}};function N2(s,l,c,h,v,_,k){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,_,k):l.prototype&&l.prototype.isPureReactComponent?!ef(c,h)||!ef(v,_):!0}function R2(s,l,c,h){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(c,h),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(c,h),l.state!==s&&Ag.enqueueReplaceState(l,l.state,null)}function No(s,l){var c=l;if("ref"in l){c={};for(var h in l)h!=="ref"&&(c[h]=l[h])}if(s=s.defaultProps){c===l&&(c=x({},c));for(var v in s)c[v]===void 0&&(c[v]=s[v])}return c}function I2(s){Ah(s)}function D2(s){console.error(s)}function O2(s){Ah(s)}function $h(s,l){try{var c=s.onUncaughtError;c(l.value,{componentStack:l.stack})}catch(h){setTimeout(function(){throw h})}}function F2(s,l,c){try{var h=s.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function kg(s,l,c){return c=nl(c),c.tag=3,c.payload={element:null},c.callback=function(){$h(s,l)},c}function M2(s){return s=nl(s),s.tag=3,s}function P2(s,l,c,h){var v=c.type.getDerivedStateFromError;if(typeof v=="function"){var _=h.value;s.payload=function(){return v(_)},s.callback=function(){F2(l,c,h)}}var k=c.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(s.callback=function(){F2(l,c,h),typeof v!="function"&&(ul===null?ul=new Set([this]):ul.add(this));var U=h.stack;this.componentDidCatch(h.value,{componentStack:U!==null?U:""})})}function U3(s,l,c,h,v){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(l=c.alternate,l!==null&&kc(l,c,v,!0),c=_a.current,c!==null){switch(c.tag){case 31:case 13:return za===null?ld():c.alternate===null&&Nr===0&&(Nr=3),c.flags&=-257,c.flags|=65536,c.lanes=v,h===Ph?c.flags|=16384:(l=c.updateQueue,l===null?c.updateQueue=new Set([h]):l.add(h),Jg(s,h,v)),!1;case 22:return c.flags|=65536,h===Ph?c.flags|=16384:(l=c.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=l):(c=l.retryQueue,c===null?l.retryQueue=new Set([h]):c.add(h)),Jg(s,h,v)),!1}throw Error(n(435,c.tag))}return Jg(s,h,v),ld(),!1}if(Ot)return l=_a.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=v,h!==Wp&&(s=Error(n(422),{cause:h}),nf(La(s,c)))):(h!==Wp&&(l=Error(n(423),{cause:h}),nf(La(l,c))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,h=La(h,c),v=kg(s.stateNode,h,v),ng(s,v),Nr!==4&&(Nr=2)),!1;var _=Error(n(520),{cause:h});if(_=La(_,c),Ef===null?Ef=[_]:Ef.push(_),Nr!==4&&(Nr=2),l===null)return!0;h=La(h,c),c=l;do{switch(c.tag){case 3:return c.flags|=65536,s=v&-v,c.lanes|=s,s=kg(c.stateNode,h,s),ng(c,s),!1;case 1:if(l=c.type,_=c.stateNode,(c.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(ul===null||!ul.has(_))))return c.flags|=65536,v&=-v,c.lanes|=v,v=M2(v),P2(v,s,c,h),ng(c,v),!1}c=c.return}while(c!==null);return!1}var Cg=Error(n(461)),$r=!1;function wn(s,l,c,h){l.child=s===null?V_(l,null,c,h):ko(l,s.child,c,h)}function j2(s,l,c,h,v){c=c.render;var _=l.ref;if("ref"in h){var k={};for(var U in h)U!=="ref"&&(k[U]=h[U])}else k=h;return Eo(l),h=cg(s,l,c,k,_,v),U=ug(),s!==null&&!$r?(fg(s,l,v),di(s,l,v)):(Ot&&U&&Gp(l),l.flags|=1,wn(s,l,h,v),l.child)}function L2(s,l,c,h,v){if(s===null){var _=c.type;return typeof _=="function"&&!Up(_)&&_.defaultProps===void 0&&c.compare===null?(l.tag=15,l.type=_,B2(s,l,_,h,v)):(s=Rh(c.type,null,h,l,l.mode,v),s.ref=l.ref,s.return=l,l.child=s)}if(_=s.child,!Pg(s,v)){var k=_.memoizedProps;if(c=c.compare,c=c!==null?c:ef,c(k,h)&&s.ref===l.ref)return di(s,l,v)}return l.flags|=1,s=li(_,h),s.ref=l.ref,s.return=l,l.child=s}function B2(s,l,c,h,v){if(s!==null){var _=s.memoizedProps;if(ef(_,h)&&s.ref===l.ref)if($r=!1,l.pendingProps=h=_,Pg(s,v))(s.flags&131072)!==0&&($r=!0);else return l.lanes=s.lanes,di(s,l,v)}return Ng(s,l,c,h,v)}function V2(s,l,c,h){var v=h.children,_=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((l.flags&128)!==0){if(_=_!==null?_.baseLanes|c:c,s!==null){for(h=l.child=s.child,v=0;h!==null;)v=v|h.lanes|h.childLanes,h=h.sibling;h=v&~_}else h=0,l.child=null;return U2(s,l,_,c,h)}if((c&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Fh(l,_!==null?_.cachePool:null),_!==null?H_(l,_):sg(),G_(l);else return h=l.lanes=536870912,U2(s,l,_!==null?_.baseLanes|c:c,c,h)}else _!==null?(Fh(l,_.cachePool),H_(l,_),il(),l.memoizedState=null):(s!==null&&Fh(l,null),sg(),il());return wn(s,l,v,c),l.child}function gf(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function U2(s,l,c,h,v){var _=Zp();return _=_===null?null:{parent:Xr._currentValue,pool:_},l.memoizedState={baseLanes:c,cachePool:_},s!==null&&Fh(l,null),sg(),G_(l),s!==null&&kc(s,l,h,!0),l.childLanes=v,null}function Kh(s,l){return l=Jh({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function z2(s,l,c){return ko(l,s.child,null,c),s=Kh(l,l.pendingProps),s.flags|=2,wa(l),l.memoizedState=null,s}function z3(s,l,c){var h=l.pendingProps,v=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(Ot){if(h.mode==="hidden")return s=Kh(l,h),l.lanes=536870912,gf(null,s);if(lg(l),(s=mr)?(s=eb(s,Ua),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:Ji!==null?{id:Is,overflow:Ds}:null,retryLane:536870912,hydrationErrors:null},c=S_(s),c.return=l,l.child=c,yn=l,mr=null)):s=null,s===null)throw el(l);return l.lanes=536870912,null}return Kh(l,h)}var _=s.memoizedState;if(_!==null){var k=_.dehydrated;if(lg(l),v)if(l.flags&256)l.flags&=-257,l=z2(s,l,c);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(n(558));else if($r||kc(s,l,c,!1),v=(c&s.childLanes)!==0,$r||v){if(h=ur,h!==null&&(k=io(h,c),k!==0&&k!==_.retryLane))throw _.retryLane=k,yo(s,k),ia(h,s,k),Cg;ld(),l=z2(s,l,c)}else s=_.treeContext,mr=Ha(k.nextSibling),yn=l,Ot=!0,Zi=null,Ua=!1,s!==null&&C_(l,s),l=Kh(l,h),l.flags|=4096;return l}return s=li(s.child,{mode:h.mode,children:h.children}),s.ref=l.ref,l.child=s,s.return=l,s}function Qh(s,l){var c=l.ref;if(c===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(s===null||s.ref!==c)&&(l.flags|=4194816)}}function Ng(s,l,c,h,v){return Eo(l),c=cg(s,l,c,h,void 0,v),h=ug(),s!==null&&!$r?(fg(s,l,v),di(s,l,v)):(Ot&&h&&Gp(l),l.flags|=1,wn(s,l,c,v),l.child)}function H2(s,l,c,h,v,_){return Eo(l),l.updateQueue=null,c=W_(l,h,c,v),q_(s),h=ug(),s!==null&&!$r?(fg(s,l,_),di(s,l,_)):(Ot&&h&&Gp(l),l.flags|=1,wn(s,l,c,_),l.child)}function G2(s,l,c,h,v){if(Eo(l),l.stateNode===null){var _=Ec,k=c.contextType;typeof k=="object"&&k!==null&&(_=_n(k)),_=new c(h,_),l.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Ag,l.stateNode=_,_._reactInternals=l,_=l.stateNode,_.props=h,_.state=l.memoizedState,_.refs={},tg(l),k=c.contextType,_.context=typeof k=="object"&&k!==null?_n(k):Ec,_.state=l.memoizedState,k=c.getDerivedStateFromProps,typeof k=="function"&&(Sg(l,c,k,h),_.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(k=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),k!==_.state&&Ag.enqueueReplaceState(_,_.state,null),ff(l,h,_,v),uf(),_.state=l.memoizedState),typeof _.componentDidMount=="function"&&(l.flags|=4194308),h=!0}else if(s===null){_=l.stateNode;var U=l.memoizedProps,ae=No(c,U);_.props=ae;var pe=_.context,Ne=c.contextType;k=Ec,typeof Ne=="object"&&Ne!==null&&(k=_n(Ne));var Oe=c.getDerivedStateFromProps;Ne=typeof Oe=="function"||typeof _.getSnapshotBeforeUpdate=="function",U=l.pendingProps!==U,Ne||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(U||pe!==k)&&R2(l,_,h,k),rl=!1;var ve=l.memoizedState;_.state=ve,ff(l,h,_,v),uf(),pe=l.memoizedState,U||ve!==pe||rl?(typeof Oe=="function"&&(Sg(l,c,Oe,h),pe=l.memoizedState),(ae=rl||N2(l,c,ae,h,ve,pe,k))?(Ne||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(l.flags|=4194308)):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=h,l.memoizedState=pe),_.props=h,_.state=pe,_.context=k,h=ae):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),h=!1)}else{_=l.stateNode,rg(s,l),k=l.memoizedProps,Ne=No(c,k),_.props=Ne,Oe=l.pendingProps,ve=_.context,pe=c.contextType,ae=Ec,typeof pe=="object"&&pe!==null&&(ae=_n(pe)),U=c.getDerivedStateFromProps,(pe=typeof U=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(k!==Oe||ve!==ae)&&R2(l,_,h,ae),rl=!1,ve=l.memoizedState,_.state=ve,ff(l,h,_,v),uf();var Ee=l.memoizedState;k!==Oe||ve!==Ee||rl||s!==null&&s.dependencies!==null&&Dh(s.dependencies)?(typeof U=="function"&&(Sg(l,c,U,h),Ee=l.memoizedState),(Ne=rl||N2(l,c,Ne,h,ve,Ee,ae)||s!==null&&s.dependencies!==null&&Dh(s.dependencies))?(pe||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(h,Ee,ae),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(h,Ee,ae)),typeof _.componentDidUpdate=="function"&&(l.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof _.componentDidUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=1024),l.memoizedProps=h,l.memoizedState=Ee),_.props=h,_.state=Ee,_.context=ae,h=Ne):(typeof _.componentDidUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=1024),h=!1)}return _=h,Qh(s,l),h=(l.flags&128)!==0,_||h?(_=l.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:_.render(),l.flags|=1,s!==null&&h?(l.child=ko(l,s.child,null,v),l.child=ko(l,null,c,v)):wn(s,l,c,v),l.memoizedState=_.state,s=l.child):s=di(s,l,v),s}function q2(s,l,c,h){return wo(),l.flags|=256,wn(s,l,c,h),l.child}var Rg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ig(s){return{baseLanes:s,cachePool:F_()}}function Dg(s,l,c){return s=s!==null?s.childLanes&~c:0,l&&(s|=Ea),s}function W2(s,l,c){var h=l.pendingProps,v=!1,_=(l.flags&128)!==0,k;if((k=_)||(k=s!==null&&s.memoizedState===null?!1:(Pr.current&2)!==0),k&&(v=!0,l.flags&=-129),k=(l.flags&32)!==0,l.flags&=-33,s===null){if(Ot){if(v?sl(l):il(),(s=mr)?(s=eb(s,Ua),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:Ji!==null?{id:Is,overflow:Ds}:null,retryLane:536870912,hydrationErrors:null},c=S_(s),c.return=l,l.child=c,yn=l,mr=null)):s=null,s===null)throw el(l);return m1(s)?l.lanes=32:l.lanes=536870912,null}var U=h.children;return h=h.fallback,v?(il(),v=l.mode,U=Jh({mode:"hidden",children:U},v),h=_o(h,v,c,null),U.return=l,h.return=l,U.sibling=h,l.child=U,h=l.child,h.memoizedState=Ig(c),h.childLanes=Dg(s,k,c),l.memoizedState=Rg,gf(null,h)):(sl(l),Og(l,U))}var ae=s.memoizedState;if(ae!==null&&(U=ae.dehydrated,U!==null)){if(_)l.flags&256?(sl(l),l.flags&=-257,l=Fg(s,l,c)):l.memoizedState!==null?(il(),l.child=s.child,l.flags|=128,l=null):(il(),U=h.fallback,v=l.mode,h=Jh({mode:"visible",children:h.children},v),U=_o(U,v,c,null),U.flags|=2,h.return=l,U.return=l,h.sibling=U,l.child=h,ko(l,s.child,null,c),h=l.child,h.memoizedState=Ig(c),h.childLanes=Dg(s,k,c),l.memoizedState=Rg,l=gf(null,h));else if(sl(l),m1(U)){if(k=U.nextSibling&&U.nextSibling.dataset,k)var pe=k.dgst;k=pe,h=Error(n(419)),h.stack="",h.digest=k,nf({value:h,source:null,stack:null}),l=Fg(s,l,c)}else if($r||kc(s,l,c,!1),k=(c&s.childLanes)!==0,$r||k){if(k=ur,k!==null&&(h=io(k,c),h!==0&&h!==ae.retryLane))throw ae.retryLane=h,yo(s,h),ia(k,s,h),Cg;d1(U)||ld(),l=Fg(s,l,c)}else d1(U)?(l.flags|=192,l.child=s.child,l=null):(s=ae.treeContext,mr=Ha(U.nextSibling),yn=l,Ot=!0,Zi=null,Ua=!1,s!==null&&C_(l,s),l=Og(l,h.children),l.flags|=4096);return l}return v?(il(),U=h.fallback,v=l.mode,ae=s.child,pe=ae.sibling,h=li(ae,{mode:"hidden",children:h.children}),h.subtreeFlags=ae.subtreeFlags&65011712,pe!==null?U=li(pe,U):(U=_o(U,v,c,null),U.flags|=2),U.return=l,h.return=l,h.sibling=U,l.child=h,gf(null,h),h=l.child,U=s.child.memoizedState,U===null?U=Ig(c):(v=U.cachePool,v!==null?(ae=Xr._currentValue,v=v.parent!==ae?{parent:ae,pool:ae}:v):v=F_(),U={baseLanes:U.baseLanes|c,cachePool:v}),h.memoizedState=U,h.childLanes=Dg(s,k,c),l.memoizedState=Rg,gf(s.child,h)):(sl(l),c=s.child,s=c.sibling,c=li(c,{mode:"visible",children:h.children}),c.return=l,c.sibling=null,s!==null&&(k=l.deletions,k===null?(l.deletions=[s],l.flags|=16):k.push(s)),l.child=c,l.memoizedState=null,c)}function Og(s,l){return l=Jh({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Jh(s,l){return s=ya(22,s,null,l),s.lanes=0,s}function Fg(s,l,c){return ko(l,s.child,null,c),s=Og(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function X2(s,l,c){s.lanes|=l;var h=s.alternate;h!==null&&(h.lanes|=l),$p(s.return,l,c)}function Mg(s,l,c,h,v,_){var k=s.memoizedState;k===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:v,treeForkCount:_}:(k.isBackwards=l,k.rendering=null,k.renderingStartTime=0,k.last=h,k.tail=c,k.tailMode=v,k.treeForkCount=_)}function Y2(s,l,c){var h=l.pendingProps,v=h.revealOrder,_=h.tail;h=h.children;var k=Pr.current,U=(k&2)!==0;if(U?(k=k&1|2,l.flags|=128):k&=1,Y(Pr,k),wn(s,l,h,c),h=Ot?rf:0,!U&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&X2(s,c,l);else if(s.tag===19)X2(s,c,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(c=l.child,v=null;c!==null;)s=c.alternate,s!==null&&Vh(s)===null&&(v=c),c=c.sibling;c=v,c===null?(v=l.child,l.child=null):(v=c.sibling,c.sibling=null),Mg(l,!1,v,c,_,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,v=l.child,l.child=null;v!==null;){if(s=v.alternate,s!==null&&Vh(s)===null){l.child=v;break}s=v.sibling,v.sibling=c,c=v,v=s}Mg(l,!0,c,null,_,h);break;case"together":Mg(l,!1,null,null,void 0,h);break;default:l.memoizedState=null}return l.child}function di(s,l,c){if(s!==null&&(l.dependencies=s.dependencies),cl|=l.lanes,(c&l.childLanes)===0)if(s!==null){if(kc(s,l,c,!1),(c&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(n(153));if(l.child!==null){for(s=l.child,c=li(s,s.pendingProps),l.child=c,c.return=l;s.sibling!==null;)s=s.sibling,c=c.sibling=li(s,s.pendingProps),c.return=l;c.sibling=null}return l.child}function Pg(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Dh(s)))}function H3(s,l,c){switch(l.tag){case 3:Re(l,l.stateNode.containerInfo),tl(l,Xr,s.memoizedState.cache),wo();break;case 27:case 5:ke(l);break;case 4:Re(l,l.stateNode.containerInfo);break;case 10:tl(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,lg(l),null;break;case 13:var h=l.memoizedState;if(h!==null)return h.dehydrated!==null?(sl(l),l.flags|=128,null):(c&l.child.childLanes)!==0?W2(s,l,c):(sl(l),s=di(s,l,c),s!==null?s.sibling:null);sl(l);break;case 19:var v=(s.flags&128)!==0;if(h=(c&l.childLanes)!==0,h||(kc(s,l,c,!1),h=(c&l.childLanes)!==0),v){if(h)return Y2(s,l,c);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Y(Pr,Pr.current),h)break;return null;case 22:return l.lanes=0,V2(s,l,c,l.pendingProps);case 24:tl(l,Xr,s.memoizedState.cache)}return di(s,l,c)}function $2(s,l,c){if(s!==null)if(s.memoizedProps!==l.pendingProps)$r=!0;else{if(!Pg(s,c)&&(l.flags&128)===0)return $r=!1,H3(s,l,c);$r=(s.flags&131072)!==0}else $r=!1,Ot&&(l.flags&1048576)!==0&&k_(l,rf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var h=l.pendingProps;if(s=So(l.elementType),l.type=s,typeof s=="function")Up(s)?(h=No(s,h),l.tag=1,l=G2(null,l,s,h,c)):(l.tag=0,l=Ng(null,l,s,h,c));else{if(s!=null){var v=s.$$typeof;if(v===z){l.tag=11,l=j2(null,l,s,h,c);break e}else if(v===A){l.tag=14,l=L2(null,l,s,h,c);break e}}throw l=Se(s)||s,Error(n(306,l,""))}}return l;case 0:return Ng(s,l,l.type,l.pendingProps,c);case 1:return h=l.type,v=No(h,l.pendingProps),G2(s,l,h,v,c);case 3:e:{if(Re(l,l.stateNode.containerInfo),s===null)throw Error(n(387));h=l.pendingProps;var _=l.memoizedState;v=_.element,rg(s,l),ff(l,h,null,c);var k=l.memoizedState;if(h=k.cache,tl(l,Xr,h),h!==_.cache&&Kp(l,[Xr],c,!0),uf(),h=k.element,_.isDehydrated)if(_={element:h,isDehydrated:!1,cache:k.cache},l.updateQueue.baseState=_,l.memoizedState=_,l.flags&256){l=q2(s,l,h,c);break e}else if(h!==v){v=La(Error(n(424)),l),nf(v),l=q2(s,l,h,c);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(mr=Ha(s.firstChild),yn=l,Ot=!0,Zi=null,Ua=!0,c=V_(l,null,h,c),l.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(wo(),h===v){l=di(s,l,c);break e}wn(s,l,h,c)}l=l.child}return l;case 26:return Qh(s,l),s===null?(c=ib(l.type,null,l.pendingProps,null))?l.memoizedState=c:Ot||(c=l.type,s=l.pendingProps,h=md(ce.current).createElement(c),h[K]=l,h[J]=s,bn(h,c,s),Ze(h),l.stateNode=h):l.memoizedState=ib(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return ke(l),s===null&&Ot&&(h=l.stateNode=nb(l.type,l.pendingProps,ce.current),yn=l,Ua=!0,v=mr,ml(l.type)?(p1=v,mr=Ha(h.firstChild)):mr=v),wn(s,l,l.pendingProps.children,c),Qh(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&Ot&&((v=h=mr)&&(h=y6(h,l.type,l.pendingProps,Ua),h!==null?(l.stateNode=h,yn=l,mr=Ha(h.firstChild),Ua=!1,v=!0):v=!1),v||el(l)),ke(l),v=l.type,_=l.pendingProps,k=s!==null?s.memoizedProps:null,h=_.children,u1(v,_)?h=null:k!==null&&u1(v,k)&&(l.flags|=32),l.memoizedState!==null&&(v=cg(s,l,F3,null,null,c),If._currentValue=v),Qh(s,l),wn(s,l,h,c),l.child;case 6:return s===null&&Ot&&((s=c=mr)&&(c=_6(c,l.pendingProps,Ua),c!==null?(l.stateNode=c,yn=l,mr=null,s=!0):s=!1),s||el(l)),null;case 13:return W2(s,l,c);case 4:return Re(l,l.stateNode.containerInfo),h=l.pendingProps,s===null?l.child=ko(l,null,h,c):wn(s,l,h,c),l.child;case 11:return j2(s,l,l.type,l.pendingProps,c);case 7:return wn(s,l,l.pendingProps,c),l.child;case 8:return wn(s,l,l.pendingProps.children,c),l.child;case 12:return wn(s,l,l.pendingProps.children,c),l.child;case 10:return h=l.pendingProps,tl(l,l.type,h.value),wn(s,l,h.children,c),l.child;case 9:return v=l.type._context,h=l.pendingProps.children,Eo(l),v=_n(v),h=h(v),l.flags|=1,wn(s,l,h,c),l.child;case 14:return L2(s,l,l.type,l.pendingProps,c);case 15:return B2(s,l,l.type,l.pendingProps,c);case 19:return Y2(s,l,c);case 31:return z3(s,l,c);case 22:return V2(s,l,c,l.pendingProps);case 24:return Eo(l),h=_n(Xr),s===null?(v=Zp(),v===null&&(v=ur,_=Qp(),v.pooledCache=_,_.refCount++,_!==null&&(v.pooledCacheLanes|=c),v=_),l.memoizedState={parent:h,cache:v},tg(l),tl(l,Xr,v)):((s.lanes&c)!==0&&(rg(s,l),ff(l,null,null,c),uf()),v=s.memoizedState,_=l.memoizedState,v.parent!==h?(v={parent:h,cache:h},l.memoizedState=v,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=v),tl(l,Xr,h)):(h=_.cache,tl(l,Xr,h),h!==v.cache&&Kp(l,[Xr],c,!0))),wn(s,l,l.pendingProps.children,c),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function mi(s){s.flags|=4}function jg(s,l,c,h,v){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(bw())s.flags|=8192;else throw Ao=Ph,eg}else s.flags&=-16777217}function K2(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!fb(l))if(bw())s.flags|=8192;else throw Ao=Ph,eg}function Zh(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?uc():536870912,s.lanes|=l,Bc|=l)}function xf(s,l){if(!Ot)switch(s.tailMode){case"hidden":l=s.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function pr(s){var l=s.alternate!==null&&s.alternate.child===s.child,c=0,h=0;if(l)for(var v=s.child;v!==null;)c|=v.lanes|v.childLanes,h|=v.subtreeFlags&65011712,h|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)c|=v.lanes|v.childLanes,h|=v.subtreeFlags,h|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=h,s.childLanes=c,l}function G3(s,l,c){var h=l.pendingProps;switch(qp(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pr(l),null;case 1:return pr(l),null;case 3:return c=l.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),l.memoizedState.cache!==h&&(l.flags|=2048),ui(Xr),_e(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(Ac(l)?mi(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Xp())),pr(l),null;case 26:var v=l.type,_=l.memoizedState;return s===null?(mi(l),_!==null?(pr(l),K2(l,_)):(pr(l),jg(l,v,null,h,c))):_?_!==s.memoizedState?(mi(l),pr(l),K2(l,_)):(pr(l),l.flags&=-16777217):(s=s.memoizedProps,s!==h&&mi(l),pr(l),jg(l,v,s,h,c)),null;case 27:if(rt(l),c=ce.current,v=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==h&&mi(l);else{if(!h){if(l.stateNode===null)throw Error(n(166));return pr(l),null}s=q.current,Ac(l)?N_(l):(s=nb(v,h,c),l.stateNode=s,mi(l))}return pr(l),null;case 5:if(rt(l),v=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==h&&mi(l);else{if(!h){if(l.stateNode===null)throw Error(n(166));return pr(l),null}if(_=q.current,Ac(l))N_(l);else{var k=md(ce.current);switch(_){case 1:_=k.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:_=k.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":_=k.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":_=k.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":_=k.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof h.is=="string"?k.createElement("select",{is:h.is}):k.createElement("select"),h.multiple?_.multiple=!0:h.size&&(_.size=h.size);break;default:_=typeof h.is=="string"?k.createElement(v,{is:h.is}):k.createElement(v)}}_[K]=l,_[J]=h;e:for(k=l.child;k!==null;){if(k.tag===5||k.tag===6)_.appendChild(k.stateNode);else if(k.tag!==4&&k.tag!==27&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===l)break e;for(;k.sibling===null;){if(k.return===null||k.return===l)break e;k=k.return}k.sibling.return=k.return,k=k.sibling}l.stateNode=_;e:switch(bn(_,v,h),v){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&mi(l)}}return pr(l),jg(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,c),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==h&&mi(l);else{if(typeof h!="string"&&l.stateNode===null)throw Error(n(166));if(s=ce.current,Ac(l)){if(s=l.stateNode,c=l.memoizedProps,h=null,v=yn,v!==null)switch(v.tag){case 27:case 5:h=v.memoizedProps}s[K]=l,s=!!(s.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||Ww(s.nodeValue,c)),s||el(l,!0)}else s=md(s).createTextNode(h),s[K]=l,l.stateNode=s}return pr(l),null;case 31:if(c=l.memoizedState,s===null||s.memoizedState!==null){if(h=Ac(l),c!==null){if(s===null){if(!h)throw Error(n(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[K]=l}else wo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;pr(l),s=!1}else c=Xp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return l.flags&256?(wa(l),l):(wa(l),null);if((l.flags&128)!==0)throw Error(n(558))}return pr(l),null;case 13:if(h=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=Ac(l),h!==null&&h.dehydrated!==null){if(s===null){if(!v)throw Error(n(318));if(v=l.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[K]=l}else wo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;pr(l),v=!1}else v=Xp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return l.flags&256?(wa(l),l):(wa(l),null)}return wa(l),(l.flags&128)!==0?(l.lanes=c,l):(c=h!==null,s=s!==null&&s.memoizedState!==null,c&&(h=l.child,v=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(v=h.alternate.memoizedState.cachePool.pool),_=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(_=h.memoizedState.cachePool.pool),_!==v&&(h.flags|=2048)),c!==s&&c&&(l.child.flags|=8192),Zh(l,l.updateQueue),pr(l),null);case 4:return _e(),s===null&&s1(l.stateNode.containerInfo),pr(l),null;case 10:return ui(l.type),pr(l),null;case 19:if(O(Pr),h=l.memoizedState,h===null)return pr(l),null;if(v=(l.flags&128)!==0,_=h.rendering,_===null)if(v)xf(h,!1);else{if(Nr!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(_=Vh(s),_!==null){for(l.flags|=128,xf(h,!1),s=_.updateQueue,l.updateQueue=s,Zh(l,s),l.subtreeFlags=0,s=c,c=l.child;c!==null;)T_(c,s),c=c.sibling;return Y(Pr,Pr.current&1|2),Ot&&oi(l,h.treeForkCount),l.child}s=s.sibling}h.tail!==null&&zt()>ad&&(l.flags|=128,v=!0,xf(h,!1),l.lanes=4194304)}else{if(!v)if(s=Vh(_),s!==null){if(l.flags|=128,v=!0,s=s.updateQueue,l.updateQueue=s,Zh(l,s),xf(h,!0),h.tail===null&&h.tailMode==="hidden"&&!_.alternate&&!Ot)return pr(l),null}else 2*zt()-h.renderingStartTime>ad&&c!==536870912&&(l.flags|=128,v=!0,xf(h,!1),l.lanes=4194304);h.isBackwards?(_.sibling=l.child,l.child=_):(s=h.last,s!==null?s.sibling=_:l.child=_,h.last=_)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=zt(),s.sibling=null,c=Pr.current,Y(Pr,v?c&1|2:c&1),Ot&&oi(l,h.treeForkCount),s):(pr(l),null);case 22:case 23:return wa(l),ig(),h=l.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(l.flags|=8192):h&&(l.flags|=8192),h?(c&536870912)!==0&&(l.flags&128)===0&&(pr(l),l.subtreeFlags&6&&(l.flags|=8192)):pr(l),c=l.updateQueue,c!==null&&Zh(l,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),h=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(h=l.memoizedState.cachePool.pool),h!==c&&(l.flags|=2048),s!==null&&O(To),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),l.memoizedState.cache!==c&&(l.flags|=2048),ui(Xr),pr(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function q3(s,l){switch(qp(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return ui(Xr),_e(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return rt(l),null;case 31:if(l.memoizedState!==null){if(wa(l),l.alternate===null)throw Error(n(340));wo()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(wa(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(n(340));wo()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return O(Pr),null;case 4:return _e(),null;case 10:return ui(l.type),null;case 22:case 23:return wa(l),ig(),s!==null&&O(To),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return ui(Xr),null;case 25:return null;default:return null}}function Q2(s,l){switch(qp(l),l.tag){case 3:ui(Xr),_e();break;case 26:case 27:case 5:rt(l);break;case 4:_e();break;case 31:l.memoizedState!==null&&wa(l);break;case 13:wa(l);break;case 19:O(Pr);break;case 10:ui(l.type);break;case 22:case 23:wa(l),ig(),s!==null&&O(To);break;case 24:ui(Xr)}}function vf(s,l){try{var c=l.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var v=h.next;c=v;do{if((c.tag&s)===s){h=void 0;var _=c.create,k=c.inst;h=_(),k.destroy=h}c=c.next}while(c!==v)}}catch(U){Jt(l,l.return,U)}}function ll(s,l,c){try{var h=l.updateQueue,v=h!==null?h.lastEffect:null;if(v!==null){var _=v.next;h=_;do{if((h.tag&s)===s){var k=h.inst,U=k.destroy;if(U!==void 0){k.destroy=void 0,v=l;var ae=c,pe=U;try{pe()}catch(Ne){Jt(v,ae,Ne)}}}h=h.next}while(h!==_)}}catch(Ne){Jt(l,l.return,Ne)}}function J2(s){var l=s.updateQueue;if(l!==null){var c=s.stateNode;try{z_(l,c)}catch(h){Jt(s,s.return,h)}}}function Z2(s,l,c){c.props=No(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(h){Jt(s,l,h)}}function yf(s,l){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof c=="function"?s.refCleanup=c(h):c.current=h}}catch(v){Jt(s,l,v)}}function Os(s,l){var c=s.ref,h=s.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(v){Jt(s,l,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(v){Jt(s,l,v)}else c.current=null}function ew(s){var l=s.type,c=s.memoizedProps,h=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(v){Jt(s,s.return,v)}}function Lg(s,l,c){try{var h=s.stateNode;d6(h,s.type,c,l),h[J]=l}catch(v){Jt(s,s.return,v)}}function tw(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ml(s.type)||s.tag===4}function Bg(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||tw(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ml(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vg(s,l,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,l?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,l):(l=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,l.appendChild(s),c=c._reactRootContainer,c!=null||l.onclick!==null||(l.onclick=ls));else if(h!==4&&(h===27&&ml(s.type)&&(c=s.stateNode,l=null),s=s.child,s!==null))for(Vg(s,l,c),s=s.sibling;s!==null;)Vg(s,l,c),s=s.sibling}function ed(s,l,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,l?c.insertBefore(s,l):c.appendChild(s);else if(h!==4&&(h===27&&ml(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(ed(s,l,c),s=s.sibling;s!==null;)ed(s,l,c),s=s.sibling}function rw(s){var l=s.stateNode,c=s.memoizedProps;try{for(var h=s.type,v=l.attributes;v.length;)l.removeAttributeNode(v[0]);bn(l,h,c),l[K]=s,l[J]=c}catch(_){Jt(s,s.return,_)}}var pi=!1,Kr=!1,Ug=!1,nw=typeof WeakSet=="function"?WeakSet:Set,dn=null;function W3(s,l){if(s=s.containerInfo,o1=wd,s=p_(s),Fp(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var v=h.anchorOffset,_=h.focusNode;h=h.focusOffset;try{c.nodeType,_.nodeType}catch{c=null;break e}var k=0,U=-1,ae=-1,pe=0,Ne=0,Oe=s,ve=null;t:for(;;){for(var Ee;Oe!==c||v!==0&&Oe.nodeType!==3||(U=k+v),Oe!==_||h!==0&&Oe.nodeType!==3||(ae=k+h),Oe.nodeType===3&&(k+=Oe.nodeValue.length),(Ee=Oe.firstChild)!==null;)ve=Oe,Oe=Ee;for(;;){if(Oe===s)break t;if(ve===c&&++pe===v&&(U=k),ve===_&&++Ne===h&&(ae=k),(Ee=Oe.nextSibling)!==null)break;Oe=ve,ve=Oe.parentNode}Oe=Ee}c=U===-1||ae===-1?null:{start:U,end:ae}}else c=null}c=c||{start:0,end:0}}else c=null;for(c1={focusedElem:s,selectionRange:c},wd=!1,dn=l;dn!==null;)if(l=dn,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,dn=s;else for(;dn!==null;){switch(l=dn,_=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)v=s[c],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,c=l,v=_.memoizedProps,_=_.memoizedState,h=c.stateNode;try{var Je=No(c.type,v);s=h.getSnapshotBeforeUpdate(Je,_),h.__reactInternalSnapshotBeforeUpdate=s}catch(it){Jt(c,c.return,it)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,c=s.nodeType,c===9)h1(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":h1(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=l.sibling,s!==null){s.return=l.return,dn=s;break}dn=l.return}}function aw(s,l,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:xi(s,c),h&4&&vf(5,c);break;case 1:if(xi(s,c),h&4)if(s=c.stateNode,l===null)try{s.componentDidMount()}catch(k){Jt(c,c.return,k)}else{var v=No(c.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(v,l,s.__reactInternalSnapshotBeforeUpdate)}catch(k){Jt(c,c.return,k)}}h&64&&J2(c),h&512&&yf(c,c.return);break;case 3:if(xi(s,c),h&64&&(s=c.updateQueue,s!==null)){if(l=null,c.child!==null)switch(c.child.tag){case 27:case 5:l=c.child.stateNode;break;case 1:l=c.child.stateNode}try{z_(s,l)}catch(k){Jt(c,c.return,k)}}break;case 27:l===null&&h&4&&rw(c);case 26:case 5:xi(s,c),l===null&&h&4&&ew(c),h&512&&yf(c,c.return);break;case 12:xi(s,c);break;case 31:xi(s,c),h&4&&lw(s,c);break;case 13:xi(s,c),h&4&&ow(s,c),h&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=t6.bind(null,c),w6(s,c))));break;case 22:if(h=c.memoizedState!==null||pi,!h){l=l!==null&&l.memoizedState!==null||Kr,v=pi;var _=Kr;pi=h,(Kr=l)&&!_?vi(s,c,(c.subtreeFlags&8772)!==0):xi(s,c),pi=v,Kr=_}break;case 30:break;default:xi(s,c)}}function sw(s){var l=s.alternate;l!==null&&(s.alternate=null,sw(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Be(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var wr=null,ra=!1;function gi(s,l,c){for(c=c.child;c!==null;)iw(s,l,c),c=c.sibling}function iw(s,l,c){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(Mt,c)}catch{}switch(c.tag){case 26:Kr||Os(c,l),gi(s,l,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Kr||Os(c,l);var h=wr,v=ra;ml(c.type)&&(wr=c.stateNode,ra=!1),gi(s,l,c),Cf(c.stateNode),wr=h,ra=v;break;case 5:Kr||Os(c,l);case 6:if(h=wr,v=ra,wr=null,gi(s,l,c),wr=h,ra=v,wr!==null)if(ra)try{(wr.nodeType===9?wr.body:wr.nodeName==="HTML"?wr.ownerDocument.body:wr).removeChild(c.stateNode)}catch(_){Jt(c,l,_)}else try{wr.removeChild(c.stateNode)}catch(_){Jt(c,l,_)}break;case 18:wr!==null&&(ra?(s=wr,Jw(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Xc(s)):Jw(wr,c.stateNode));break;case 4:h=wr,v=ra,wr=c.stateNode.containerInfo,ra=!0,gi(s,l,c),wr=h,ra=v;break;case 0:case 11:case 14:case 15:ll(2,c,l),Kr||ll(4,c,l),gi(s,l,c);break;case 1:Kr||(Os(c,l),h=c.stateNode,typeof h.componentWillUnmount=="function"&&Z2(c,l,h)),gi(s,l,c);break;case 21:gi(s,l,c);break;case 22:Kr=(h=Kr)||c.memoizedState!==null,gi(s,l,c),Kr=h;break;default:gi(s,l,c)}}function lw(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Xc(s)}catch(c){Jt(l,l.return,c)}}}function ow(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Xc(s)}catch(c){Jt(l,l.return,c)}}function X3(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new nw),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new nw),l;default:throw Error(n(435,s.tag))}}function td(s,l){var c=X3(s);l.forEach(function(h){if(!c.has(h)){c.add(h);var v=r6.bind(null,s,h);h.then(v,v)}})}function na(s,l){var c=l.deletions;if(c!==null)for(var h=0;h<c.length;h++){var v=c[h],_=s,k=l,U=k;e:for(;U!==null;){switch(U.tag){case 27:if(ml(U.type)){wr=U.stateNode,ra=!1;break e}break;case 5:wr=U.stateNode,ra=!1;break e;case 3:case 4:wr=U.stateNode.containerInfo,ra=!0;break e}U=U.return}if(wr===null)throw Error(n(160));iw(_,k,v),wr=null,ra=!1,_=v.alternate,_!==null&&(_.return=null),v.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)cw(l,s),l=l.sibling}var ds=null;function cw(s,l){var c=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:na(l,s),aa(s),h&4&&(ll(3,s,s.return),vf(3,s),ll(5,s,s.return));break;case 1:na(l,s),aa(s),h&512&&(Kr||c===null||Os(c,c.return)),h&64&&pi&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var v=ds;if(na(l,s),aa(s),h&512&&(Kr||c===null||Os(c,c.return)),h&4){var _=c!==null?c.memoizedState:null;if(h=s.memoizedState,c===null)if(h===null)if(s.stateNode===null){e:{h=s.type,c=s.memoizedProps,v=v.ownerDocument||v;t:switch(h){case"title":_=v.getElementsByTagName("title")[0],(!_||_[ge]||_[K]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=v.createElement(h),v.head.insertBefore(_,v.querySelector("head > title"))),bn(_,h,c),_[K]=s,Ze(_),h=_;break e;case"link":var k=cb("link","href",v).get(h+(c.href||""));if(k){for(var U=0;U<k.length;U++)if(_=k[U],_.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&_.getAttribute("rel")===(c.rel==null?null:c.rel)&&_.getAttribute("title")===(c.title==null?null:c.title)&&_.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){k.splice(U,1);break t}}_=v.createElement(h),bn(_,h,c),v.head.appendChild(_);break;case"meta":if(k=cb("meta","content",v).get(h+(c.content||""))){for(U=0;U<k.length;U++)if(_=k[U],_.getAttribute("content")===(c.content==null?null:""+c.content)&&_.getAttribute("name")===(c.name==null?null:c.name)&&_.getAttribute("property")===(c.property==null?null:c.property)&&_.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&_.getAttribute("charset")===(c.charSet==null?null:c.charSet)){k.splice(U,1);break t}}_=v.createElement(h),bn(_,h,c),v.head.appendChild(_);break;default:throw Error(n(468,h))}_[K]=s,Ze(_),h=_}s.stateNode=h}else ub(v,s.type,s.stateNode);else s.stateNode=ob(v,h,s.memoizedProps);else _!==h?(_===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):_.count--,h===null?ub(v,s.type,s.stateNode):ob(v,h,s.memoizedProps)):h===null&&s.stateNode!==null&&Lg(s,s.memoizedProps,c.memoizedProps)}break;case 27:na(l,s),aa(s),h&512&&(Kr||c===null||Os(c,c.return)),c!==null&&h&4&&Lg(s,s.memoizedProps,c.memoizedProps);break;case 5:if(na(l,s),aa(s),h&512&&(Kr||c===null||Os(c,c.return)),s.flags&32){v=s.stateNode;try{ta(v,"")}catch(Je){Jt(s,s.return,Je)}}h&4&&s.stateNode!=null&&(v=s.memoizedProps,Lg(s,v,c!==null?c.memoizedProps:v)),h&1024&&(Ug=!0);break;case 6:if(na(l,s),aa(s),h&4){if(s.stateNode===null)throw Error(n(162));h=s.memoizedProps,c=s.stateNode;try{c.nodeValue=h}catch(Je){Jt(s,s.return,Je)}}break;case 3:if(xd=null,v=ds,ds=pd(l.containerInfo),na(l,s),ds=v,aa(s),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Xc(l.containerInfo)}catch(Je){Jt(s,s.return,Je)}Ug&&(Ug=!1,uw(s));break;case 4:h=ds,ds=pd(s.stateNode.containerInfo),na(l,s),aa(s),ds=h;break;case 12:na(l,s),aa(s);break;case 31:na(l,s),aa(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,td(s,h)));break;case 13:na(l,s),aa(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(nd=zt()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,td(s,h)));break;case 22:v=s.memoizedState!==null;var ae=c!==null&&c.memoizedState!==null,pe=pi,Ne=Kr;if(pi=pe||v,Kr=Ne||ae,na(l,s),Kr=Ne,pi=pe,aa(s),h&8192)e:for(l=s.stateNode,l._visibility=v?l._visibility&-2:l._visibility|1,v&&(c===null||ae||pi||Kr||Ro(s)),c=null,l=s;;){if(l.tag===5||l.tag===26){if(c===null){ae=c=l;try{if(_=ae.stateNode,v)k=_.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{U=ae.stateNode;var Oe=ae.memoizedProps.style,ve=Oe!=null&&Oe.hasOwnProperty("display")?Oe.display:null;U.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(Je){Jt(ae,ae.return,Je)}}}else if(l.tag===6){if(c===null){ae=l;try{ae.stateNode.nodeValue=v?"":ae.memoizedProps}catch(Je){Jt(ae,ae.return,Je)}}}else if(l.tag===18){if(c===null){ae=l;try{var Ee=ae.stateNode;v?Zw(Ee,!0):Zw(ae.stateNode,!1)}catch(Je){Jt(ae,ae.return,Je)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;c===l&&(c=null),l=l.return}c===l&&(c=null),l.sibling.return=l.return,l=l.sibling}h&4&&(h=s.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,td(s,c))));break;case 19:na(l,s),aa(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,td(s,h)));break;case 30:break;case 21:break;default:na(l,s),aa(s)}}function aa(s){var l=s.flags;if(l&2){try{for(var c,h=s.return;h!==null;){if(tw(h)){c=h;break}h=h.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var v=c.stateNode,_=Bg(s);ed(s,_,v);break;case 5:var k=c.stateNode;c.flags&32&&(ta(k,""),c.flags&=-33);var U=Bg(s);ed(s,U,k);break;case 3:case 4:var ae=c.stateNode.containerInfo,pe=Bg(s);Vg(s,pe,ae);break;default:throw Error(n(161))}}catch(Ne){Jt(s,s.return,Ne)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function uw(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;uw(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function xi(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)aw(s,l.alternate,l),l=l.sibling}function Ro(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:ll(4,l,l.return),Ro(l);break;case 1:Os(l,l.return);var c=l.stateNode;typeof c.componentWillUnmount=="function"&&Z2(l,l.return,c),Ro(l);break;case 27:Cf(l.stateNode);case 26:case 5:Os(l,l.return),Ro(l);break;case 22:l.memoizedState===null&&Ro(l);break;case 30:Ro(l);break;default:Ro(l)}s=s.sibling}}function vi(s,l,c){for(c=c&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var h=l.alternate,v=s,_=l,k=_.flags;switch(_.tag){case 0:case 11:case 15:vi(v,_,c),vf(4,_);break;case 1:if(vi(v,_,c),h=_,v=h.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(pe){Jt(h,h.return,pe)}if(h=_,v=h.updateQueue,v!==null){var U=h.stateNode;try{var ae=v.shared.hiddenCallbacks;if(ae!==null)for(v.shared.hiddenCallbacks=null,v=0;v<ae.length;v++)U_(ae[v],U)}catch(pe){Jt(h,h.return,pe)}}c&&k&64&&J2(_),yf(_,_.return);break;case 27:rw(_);case 26:case 5:vi(v,_,c),c&&h===null&&k&4&&ew(_),yf(_,_.return);break;case 12:vi(v,_,c);break;case 31:vi(v,_,c),c&&k&4&&lw(v,_);break;case 13:vi(v,_,c),c&&k&4&&ow(v,_);break;case 22:_.memoizedState===null&&vi(v,_,c),yf(_,_.return);break;case 30:break;default:vi(v,_,c)}l=l.sibling}}function zg(s,l){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&af(c))}function Hg(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&af(s))}function ms(s,l,c,h){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)fw(s,l,c,h),l=l.sibling}function fw(s,l,c,h){var v=l.flags;switch(l.tag){case 0:case 11:case 15:ms(s,l,c,h),v&2048&&vf(9,l);break;case 1:ms(s,l,c,h);break;case 3:ms(s,l,c,h),v&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&af(s)));break;case 12:if(v&2048){ms(s,l,c,h),s=l.stateNode;try{var _=l.memoizedProps,k=_.id,U=_.onPostCommit;typeof U=="function"&&U(k,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ae){Jt(l,l.return,ae)}}else ms(s,l,c,h);break;case 31:ms(s,l,c,h);break;case 13:ms(s,l,c,h);break;case 23:break;case 22:_=l.stateNode,k=l.alternate,l.memoizedState!==null?_._visibility&2?ms(s,l,c,h):_f(s,l):_._visibility&2?ms(s,l,c,h):(_._visibility|=2,Pc(s,l,c,h,(l.subtreeFlags&10256)!==0||!1)),v&2048&&zg(k,l);break;case 24:ms(s,l,c,h),v&2048&&Hg(l.alternate,l);break;default:ms(s,l,c,h)}}function Pc(s,l,c,h,v){for(v=v&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var _=s,k=l,U=c,ae=h,pe=k.flags;switch(k.tag){case 0:case 11:case 15:Pc(_,k,U,ae,v),vf(8,k);break;case 23:break;case 22:var Ne=k.stateNode;k.memoizedState!==null?Ne._visibility&2?Pc(_,k,U,ae,v):_f(_,k):(Ne._visibility|=2,Pc(_,k,U,ae,v)),v&&pe&2048&&zg(k.alternate,k);break;case 24:Pc(_,k,U,ae,v),v&&pe&2048&&Hg(k.alternate,k);break;default:Pc(_,k,U,ae,v)}l=l.sibling}}function _f(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var c=s,h=l,v=h.flags;switch(h.tag){case 22:_f(c,h),v&2048&&zg(h.alternate,h);break;case 24:_f(c,h),v&2048&&Hg(h.alternate,h);break;default:_f(c,h)}l=l.sibling}}var wf=8192;function jc(s,l,c){if(s.subtreeFlags&wf)for(s=s.child;s!==null;)hw(s,l,c),s=s.sibling}function hw(s,l,c){switch(s.tag){case 26:jc(s,l,c),s.flags&wf&&s.memoizedState!==null&&O6(c,ds,s.memoizedState,s.memoizedProps);break;case 5:jc(s,l,c);break;case 3:case 4:var h=ds;ds=pd(s.stateNode.containerInfo),jc(s,l,c),ds=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=wf,wf=16777216,jc(s,l,c),wf=h):jc(s,l,c));break;default:jc(s,l,c)}}function dw(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function bf(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var h=l[c];dn=h,pw(h,s)}dw(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)mw(s),s=s.sibling}function mw(s){switch(s.tag){case 0:case 11:case 15:bf(s),s.flags&2048&&ll(9,s,s.return);break;case 3:bf(s);break;case 12:bf(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,rd(s)):bf(s);break;default:bf(s)}}function rd(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var h=l[c];dn=h,pw(h,s)}dw(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:ll(8,l,l.return),rd(l);break;case 22:c=l.stateNode,c._visibility&2&&(c._visibility&=-3,rd(l));break;default:rd(l)}s=s.sibling}}function pw(s,l){for(;dn!==null;){var c=dn;switch(c.tag){case 0:case 11:case 15:ll(8,c,l);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:af(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,dn=h;else e:for(c=s;dn!==null;){h=dn;var v=h.sibling,_=h.return;if(sw(h),h===c){dn=null;break e}if(v!==null){v.return=_,dn=v;break e}dn=_}}}var Y3={getCacheForType:function(s){var l=_n(Xr),c=l.data.get(s);return c===void 0&&(c=s(),l.data.set(s,c)),c},cacheSignal:function(){return _n(Xr).controller.signal}},$3=typeof WeakMap=="function"?WeakMap:Map,Gt=0,ur=null,At=null,Ct=0,Qt=0,ba=null,ol=!1,Lc=!1,Gg=!1,yi=0,Nr=0,cl=0,Io=0,qg=0,Ea=0,Bc=0,Ef=null,sa=null,Wg=!1,nd=0,gw=0,ad=1/0,sd=null,ul=null,ln=0,fl=null,Vc=null,_i=0,Xg=0,Yg=null,xw=null,Tf=0,$g=null;function Ta(){return(Gt&2)!==0&&Ct!==0?Ct&-Ct:se.T!==null?t1():V()}function vw(){if(Ea===0)if((Ct&536870912)===0||Ot){var s=Zs;Zs<<=1,(Zs&3932160)===0&&(Zs=262144),Ea=s}else Ea=536870912;return s=_a.current,s!==null&&(s.flags|=32),Ea}function ia(s,l,c){(s===ur&&(Qt===2||Qt===9)||s.cancelPendingCommit!==null)&&(Uc(s,0),hl(s,Ct,Ea,!1)),ei(s,c),((Gt&2)===0||s!==ur)&&(s===ur&&((Gt&2)===0&&(Io|=c),Nr===4&&hl(s,Ct,Ea,!1)),Fs(s))}function yw(s,l,c){if((Gt&6)!==0)throw Error(n(327));var h=!c&&(l&127)===0&&(l&s.expiredLanes)===0||pa(s,l),v=h?J3(s,l):Qg(s,l,!0),_=h;do{if(v===0){Lc&&!h&&hl(s,l,0,!1);break}else{if(c=s.current.alternate,_&&!K3(c)){v=Qg(s,l,!1),_=!1;continue}if(v===2){if(_=l,s.errorRecoveryDisabledLanes&_)var k=0;else k=s.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){l=k;e:{var U=s;v=Ef;var ae=U.current.memoizedState.isDehydrated;if(ae&&(Uc(U,k).flags|=256),k=Qg(U,k,!1),k!==2){if(Gg&&!ae){U.errorRecoveryDisabledLanes|=_,Io|=_,v=4;break e}_=sa,sa=v,_!==null&&(sa===null?sa=_:sa.push.apply(sa,_))}v=k}if(_=!1,v!==2)continue}}if(v===1){Uc(s,0),hl(s,l,0,!0);break}e:{switch(h=s,_=v,_){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:hl(h,l,Ea,!ol);break e;case 2:sa=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(v=nd+300-zt(),10<v)){if(hl(h,l,Ea,!ol),Da(h,0,!0)!==0)break e;_i=l,h.timeoutHandle=Kw(_w.bind(null,h,c,sa,sd,Wg,l,Ea,Io,Bc,ol,_,"Throttled",-0,0),v);break e}_w(h,c,sa,sd,Wg,l,Ea,Io,Bc,ol,_,null,-0,0)}}break}while(!0);Fs(s)}function _w(s,l,c,h,v,_,k,U,ae,pe,Ne,Oe,ve,Ee){if(s.timeoutHandle=-1,Oe=l.subtreeFlags,Oe&8192||(Oe&16785408)===16785408){Oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ls},hw(l,_,Oe);var Je=(_&62914560)===_?nd-zt():(_&4194048)===_?gw-zt():0;if(Je=F6(Oe,Je),Je!==null){_i=_,s.cancelPendingCommit=Je(Cw.bind(null,s,l,_,c,h,v,k,U,ae,Ne,Oe,null,ve,Ee)),hl(s,_,k,!pe);return}}Cw(s,l,_,c,h,v,k,U,ae)}function K3(s){for(var l=s;;){var c=l.tag;if((c===0||c===11||c===15)&&l.flags&16384&&(c=l.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var v=c[h],_=v.getSnapshot;v=v.value;try{if(!va(_(),v))return!1}catch{return!1}}if(c=l.child,l.subtreeFlags&16384&&c!==null)c.return=l,l=c;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function hl(s,l,c,h){l&=~qg,l&=~Io,s.suspendedLanes|=l,s.pingedLanes&=~l,h&&(s.warmLanes|=l),h=s.expirationTimes;for(var v=l;0<v;){var _=31-dr(v),k=1<<_;h[_]=-1,v&=~k}c!==0&&ti(s,c,l)}function id(){return(Gt&6)===0?(Sf(0),!1):!0}function Kg(){if(At!==null){if(Qt===0)var s=At.return;else s=At,ci=bo=null,hg(s),Ic=null,lf=0,s=At;for(;s!==null;)Q2(s.alternate,s),s=s.return;At=null}}function Uc(s,l){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,g6(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),_i=0,Kg(),ur=s,At=c=li(s.current,null),Ct=l,Qt=0,ba=null,ol=!1,Lc=pa(s,l),Gg=!1,Bc=Ea=qg=Io=cl=Nr=0,sa=Ef=null,Wg=!1,(l&8)!==0&&(l|=l&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=l;0<h;){var v=31-dr(h),_=1<<v;l|=s[v],h&=~_}return yi=l,kh(),c}function ww(s,l){vt=null,se.H=pf,l===Rc||l===Mh?(l=j_(),Qt=3):l===eg?(l=j_(),Qt=4):Qt=l===Cg?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,ba=l,At===null&&(Nr=1,$h(s,La(l,s.current)))}function bw(){var s=_a.current;return s===null?!0:(Ct&4194048)===Ct?za===null:(Ct&62914560)===Ct||(Ct&536870912)!==0?s===za:!1}function Ew(){var s=se.H;return se.H=pf,s===null?pf:s}function Tw(){var s=se.A;return se.A=Y3,s}function ld(){Nr=4,ol||(Ct&4194048)!==Ct&&_a.current!==null||(Lc=!0),(cl&134217727)===0&&(Io&134217727)===0||ur===null||hl(ur,Ct,Ea,!1)}function Qg(s,l,c){var h=Gt;Gt|=2;var v=Ew(),_=Tw();(ur!==s||Ct!==l)&&(sd=null,Uc(s,l)),l=!1;var k=Nr;e:do try{if(Qt!==0&&At!==null){var U=At,ae=ba;switch(Qt){case 8:Kg(),k=6;break e;case 3:case 2:case 9:case 6:_a.current===null&&(l=!0);var pe=Qt;if(Qt=0,ba=null,zc(s,U,ae,pe),c&&Lc){k=0;break e}break;default:pe=Qt,Qt=0,ba=null,zc(s,U,ae,pe)}}Q3(),k=Nr;break}catch(Ne){ww(s,Ne)}while(!0);return l&&s.shellSuspendCounter++,ci=bo=null,Gt=h,se.H=v,se.A=_,At===null&&(ur=null,Ct=0,kh()),k}function Q3(){for(;At!==null;)Sw(At)}function J3(s,l){var c=Gt;Gt|=2;var h=Ew(),v=Tw();ur!==s||Ct!==l?(sd=null,ad=zt()+500,Uc(s,l)):Lc=pa(s,l);e:do try{if(Qt!==0&&At!==null){l=At;var _=ba;t:switch(Qt){case 1:Qt=0,ba=null,zc(s,l,_,1);break;case 2:case 9:if(M_(_)){Qt=0,ba=null,Aw(l);break}l=function(){Qt!==2&&Qt!==9||ur!==s||(Qt=7),Fs(s)},_.then(l,l);break e;case 3:Qt=7;break e;case 4:Qt=5;break e;case 7:M_(_)?(Qt=0,ba=null,Aw(l)):(Qt=0,ba=null,zc(s,l,_,7));break;case 5:var k=null;switch(At.tag){case 26:k=At.memoizedState;case 5:case 27:var U=At;if(k?fb(k):U.stateNode.complete){Qt=0,ba=null;var ae=U.sibling;if(ae!==null)At=ae;else{var pe=U.return;pe!==null?(At=pe,od(pe)):At=null}break t}}Qt=0,ba=null,zc(s,l,_,5);break;case 6:Qt=0,ba=null,zc(s,l,_,6);break;case 8:Kg(),Nr=6;break e;default:throw Error(n(462))}}Z3();break}catch(Ne){ww(s,Ne)}while(!0);return ci=bo=null,se.H=h,se.A=v,Gt=c,At!==null?0:(ur=null,Ct=0,kh(),Nr)}function Z3(){for(;At!==null&&!ns();)Sw(At)}function Sw(s){var l=$2(s.alternate,s,yi);s.memoizedProps=s.pendingProps,l===null?od(s):At=l}function Aw(s){var l=s,c=l.alternate;switch(l.tag){case 15:case 0:l=H2(c,l,l.pendingProps,l.type,void 0,Ct);break;case 11:l=H2(c,l,l.pendingProps,l.type.render,l.ref,Ct);break;case 5:hg(l);default:Q2(c,l),l=At=T_(l,yi),l=$2(c,l,yi)}s.memoizedProps=s.pendingProps,l===null?od(s):At=l}function zc(s,l,c,h){ci=bo=null,hg(l),Ic=null,lf=0;var v=l.return;try{if(U3(s,v,l,c,Ct)){Nr=1,$h(s,La(c,s.current)),At=null;return}}catch(_){if(v!==null)throw At=v,_;Nr=1,$h(s,La(c,s.current)),At=null;return}l.flags&32768?(Ot||h===1?s=!0:Lc||(Ct&536870912)!==0?s=!1:(ol=s=!0,(h===2||h===9||h===3||h===6)&&(h=_a.current,h!==null&&h.tag===13&&(h.flags|=16384))),kw(l,s)):od(l)}function od(s){var l=s;do{if((l.flags&32768)!==0){kw(l,ol);return}s=l.return;var c=G3(l.alternate,l,yi);if(c!==null){At=c;return}if(l=l.sibling,l!==null){At=l;return}At=l=s}while(l!==null);Nr===0&&(Nr=5)}function kw(s,l){do{var c=q3(s.alternate,s);if(c!==null){c.flags&=32767,At=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!l&&(s=s.sibling,s!==null)){At=s;return}At=s=c}while(s!==null);Nr=6,At=null}function Cw(s,l,c,h,v,_,k,U,ae){s.cancelPendingCommit=null;do cd();while(ln!==0);if((Gt&6)!==0)throw Error(n(327));if(l!==null){if(l===s.current)throw Error(n(177));if(_=l.lanes|l.childLanes,_|=Bp,Uu(s,c,_,k,U,ae),s===ur&&(At=ur=null,Ct=0),Vc=l,fl=s,_i=c,Xg=_,Yg=v,xw=h,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,n6(Xt,function(){return Ow(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||h){h=se.T,se.T=null,v=oe.p,oe.p=2,k=Gt,Gt|=4;try{W3(s,l,c)}finally{Gt=k,oe.p=v,se.T=h}}ln=1,Nw(),Rw(),Iw()}}function Nw(){if(ln===1){ln=0;var s=fl,l=Vc,c=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||c){c=se.T,se.T=null;var h=oe.p;oe.p=2;var v=Gt;Gt|=4;try{cw(l,s);var _=c1,k=p_(s.containerInfo),U=_.focusedElem,ae=_.selectionRange;if(k!==U&&U&&U.ownerDocument&&m_(U.ownerDocument.documentElement,U)){if(ae!==null&&Fp(U)){var pe=ae.start,Ne=ae.end;if(Ne===void 0&&(Ne=pe),"selectionStart"in U)U.selectionStart=pe,U.selectionEnd=Math.min(Ne,U.value.length);else{var Oe=U.ownerDocument||document,ve=Oe&&Oe.defaultView||window;if(ve.getSelection){var Ee=ve.getSelection(),Je=U.textContent.length,it=Math.min(ae.start,Je),ir=ae.end===void 0?it:Math.min(ae.end,Je);!Ee.extend&&it>ir&&(k=ir,ir=it,it=k);var ue=d_(U,it),ie=d_(U,ir);if(ue&&ie&&(Ee.rangeCount!==1||Ee.anchorNode!==ue.node||Ee.anchorOffset!==ue.offset||Ee.focusNode!==ie.node||Ee.focusOffset!==ie.offset)){var he=Oe.createRange();he.setStart(ue.node,ue.offset),Ee.removeAllRanges(),it>ir?(Ee.addRange(he),Ee.extend(ie.node,ie.offset)):(he.setEnd(ie.node,ie.offset),Ee.addRange(he))}}}}for(Oe=[],Ee=U;Ee=Ee.parentNode;)Ee.nodeType===1&&Oe.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<Oe.length;U++){var Ie=Oe[U];Ie.element.scrollLeft=Ie.left,Ie.element.scrollTop=Ie.top}}wd=!!o1,c1=o1=null}finally{Gt=v,oe.p=h,se.T=c}}s.current=l,ln=2}}function Rw(){if(ln===2){ln=0;var s=fl,l=Vc,c=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||c){c=se.T,se.T=null;var h=oe.p;oe.p=2;var v=Gt;Gt|=4;try{aw(s,l.alternate,l)}finally{Gt=v,oe.p=h,se.T=c}}ln=3}}function Iw(){if(ln===4||ln===3){ln=0,Gn();var s=fl,l=Vc,c=_i,h=xw;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?ln=5:(ln=0,Vc=fl=null,Dw(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(ul=null),as(c),l=l.stateNode,or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(Mt,l,void 0,(l.current.flags&128)===128)}catch{}if(h!==null){l=se.T,v=oe.p,oe.p=2,se.T=null;try{for(var _=s.onRecoverableError,k=0;k<h.length;k++){var U=h[k];_(U.value,{componentStack:U.stack})}}finally{se.T=l,oe.p=v}}(_i&3)!==0&&cd(),Fs(s),v=s.pendingLanes,(c&261930)!==0&&(v&42)!==0?s===$g?Tf++:(Tf=0,$g=s):Tf=0,Sf(0)}}function Dw(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,af(l)))}function cd(){return Nw(),Rw(),Iw(),Ow()}function Ow(){if(ln!==5)return!1;var s=fl,l=Xg;Xg=0;var c=as(_i),h=se.T,v=oe.p;try{oe.p=32>c?32:c,se.T=null,c=Yg,Yg=null;var _=fl,k=_i;if(ln=0,Vc=fl=null,_i=0,(Gt&6)!==0)throw Error(n(331));var U=Gt;if(Gt|=4,mw(_.current),fw(_,_.current,k,c),Gt=U,Sf(0,!1),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(Mt,_)}catch{}return!0}finally{oe.p=v,se.T=h,Dw(s,l)}}function Fw(s,l,c){l=La(c,l),l=kg(s.stateNode,l,2),s=al(s,l,2),s!==null&&(ei(s,2),Fs(s))}function Jt(s,l,c){if(s.tag===3)Fw(s,s,c);else for(;l!==null;){if(l.tag===3){Fw(l,s,c);break}else if(l.tag===1){var h=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ul===null||!ul.has(h))){s=La(c,s),c=M2(2),h=al(l,c,2),h!==null&&(P2(c,h,l,s),ei(h,2),Fs(h));break}}l=l.return}}function Jg(s,l,c){var h=s.pingCache;if(h===null){h=s.pingCache=new $3;var v=new Set;h.set(l,v)}else v=h.get(l),v===void 0&&(v=new Set,h.set(l,v));v.has(c)||(Gg=!0,v.add(c),s=e6.bind(null,s,l,c),l.then(s,s))}function e6(s,l,c){var h=s.pingCache;h!==null&&h.delete(l),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,ur===s&&(Ct&c)===c&&(Nr===4||Nr===3&&(Ct&62914560)===Ct&&300>zt()-nd?(Gt&2)===0&&Uc(s,0):qg|=c,Bc===Ct&&(Bc=0)),Fs(s)}function Mw(s,l){l===0&&(l=uc()),s=yo(s,l),s!==null&&(ei(s,l),Fs(s))}function t6(s){var l=s.memoizedState,c=0;l!==null&&(c=l.retryLane),Mw(s,c)}function r6(s,l){var c=0;switch(s.tag){case 31:case 13:var h=s.stateNode,v=s.memoizedState;v!==null&&(c=v.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(l),Mw(s,c)}function n6(s,l){return Ft(s,l)}var ud=null,Hc=null,Zg=!1,fd=!1,e1=!1,dl=0;function Fs(s){s!==Hc&&s.next===null&&(Hc===null?ud=Hc=s:Hc=Hc.next=s),fd=!0,Zg||(Zg=!0,s6())}function Sf(s,l){if(!e1&&fd){e1=!0;do for(var c=!1,h=ud;h!==null;){if(s!==0){var v=h.pendingLanes;if(v===0)var _=0;else{var k=h.suspendedLanes,U=h.pingedLanes;_=(1<<31-dr(42|s)+1)-1,_&=v&~(k&~U),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(c=!0,Bw(h,_))}else _=Ct,_=Da(h,h===ur?_:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(_&3)===0||pa(h,_)||(c=!0,Bw(h,_));h=h.next}while(c);e1=!1}}function a6(){Pw()}function Pw(){fd=Zg=!1;var s=0;dl!==0&&p6()&&(s=dl);for(var l=zt(),c=null,h=ud;h!==null;){var v=h.next,_=jw(h,l);_===0?(h.next=null,c===null?ud=v:c.next=v,v===null&&(Hc=c)):(c=h,(s!==0||(_&3)!==0)&&(fd=!0)),h=v}ln!==0&&ln!==5||Sf(s),dl!==0&&(dl=0)}function jw(s,l){for(var c=s.suspendedLanes,h=s.pingedLanes,v=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var k=31-dr(_),U=1<<k,ae=v[k];ae===-1?((U&c)===0||(U&h)!==0)&&(v[k]=Vu(U,l)):ae<=l&&(s.expiredLanes|=U),_&=~U}if(l=ur,c=Ct,c=Da(s,s===l?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,c===0||s===l&&(Qt===2||Qt===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&Hr(h),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||pa(s,c)){if(l=c&-c,l===s.callbackPriority)return l;switch(h!==null&&Hr(h),as(c)){case 2:case 8:c=qn;break;case 32:c=Xt;break;case 268435456:c=dt;break;default:c=Xt}return h=Lw.bind(null,s),c=Ft(c,h),s.callbackPriority=l,s.callbackNode=c,l}return h!==null&&h!==null&&Hr(h),s.callbackPriority=2,s.callbackNode=null,2}function Lw(s,l){if(ln!==0&&ln!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(cd()&&s.callbackNode!==c)return null;var h=Ct;return h=Da(s,s===ur?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(yw(s,h,l),jw(s,zt()),s.callbackNode!=null&&s.callbackNode===c?Lw.bind(null,s):null)}function Bw(s,l){if(cd())return null;yw(s,l,!0)}function s6(){x6(function(){(Gt&6)!==0?Ft(an,a6):Pw()})}function t1(){if(dl===0){var s=Cc;s===0&&(s=ma,ma<<=1,(ma&261888)===0&&(ma=256)),dl=s}return dl}function Vw(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:dc(""+s)}function Uw(s,l){var c=l.ownerDocument.createElement("input");return c.name=l.name,c.value=l.value,s.id&&c.setAttribute("form",s.id),l.parentNode.insertBefore(c,l),s=new FormData(s),c.parentNode.removeChild(c),s}function i6(s,l,c,h,v){if(l==="submit"&&c&&c.stateNode===v){var _=Vw((v[J]||null).action),k=h.submitter;k&&(l=(l=k[J]||null)?Vw(l.formAction):k.getAttribute("formAction"),l!==null&&(_=l,k=null));var U=new ks("action","action",null,h,v);s.push({event:U,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(dl!==0){var ae=k?Uw(v,k):new FormData(v);wg(c,{pending:!0,data:ae,method:v.method,action:_},null,ae)}}else typeof _=="function"&&(U.preventDefault(),ae=k?Uw(v,k):new FormData(v),wg(c,{pending:!0,data:ae,method:v.method,action:_},_,ae))},currentTarget:v}]})}}for(var r1=0;r1<Lp.length;r1++){var n1=Lp[r1],l6=n1.toLowerCase(),o6=n1[0].toUpperCase()+n1.slice(1);hs(l6,"on"+o6)}hs(v_,"onAnimationEnd"),hs(y_,"onAnimationIteration"),hs(__,"onAnimationStart"),hs("dblclick","onDoubleClick"),hs("focusin","onFocus"),hs("focusout","onBlur"),hs(T3,"onTransitionRun"),hs(S3,"onTransitionStart"),hs(A3,"onTransitionCancel"),hs(w_,"onTransitionEnd"),Nn("onMouseEnter",["mouseout","mouseover"]),Nn("onMouseLeave",["mouseout","mouseover"]),Nn("onPointerEnter",["pointerout","pointerover"]),Nn("onPointerLeave",["pointerout","pointerover"]),cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),cr("onBeforeInput",["compositionend","keypress","textInput","paste"]),cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Af="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),c6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Af));function zw(s,l){l=(l&4)!==0;for(var c=0;c<s.length;c++){var h=s[c],v=h.event;h=h.listeners;e:{var _=void 0;if(l)for(var k=h.length-1;0<=k;k--){var U=h[k],ae=U.instance,pe=U.currentTarget;if(U=U.listener,ae!==_&&v.isPropagationStopped())break e;_=U,v.currentTarget=pe;try{_(v)}catch(Ne){Ah(Ne)}v.currentTarget=null,_=ae}else for(k=0;k<h.length;k++){if(U=h[k],ae=U.instance,pe=U.currentTarget,U=U.listener,ae!==_&&v.isPropagationStopped())break e;_=U,v.currentTarget=pe;try{_(v)}catch(Ne){Ah(Ne)}v.currentTarget=null,_=ae}}}}function kt(s,l){var c=l[de];c===void 0&&(c=l[de]=new Set);var h=s+"__bubble";c.has(h)||(Hw(l,s,2,!1),c.add(h))}function a1(s,l,c){var h=0;l&&(h|=4),Hw(c,s,h,l)}var hd="_reactListening"+Math.random().toString(36).slice(2);function s1(s){if(!s[hd]){s[hd]=!0,Yt.forEach(function(c){c!=="selectionchange"&&(c6.has(c)||a1(c,!1,s),a1(c,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[hd]||(l[hd]=!0,a1("selectionchange",!1,l))}}function Hw(s,l,c,h){switch(vb(l)){case 2:var v=j6;break;case 8:v=L6;break;default:v=_1}c=v.bind(null,l,c,s),v=void 0,!uo||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),h?v!==void 0?s.addEventListener(l,c,{capture:!0,passive:v}):s.addEventListener(l,c,!0):v!==void 0?s.addEventListener(l,c,{passive:v}):s.addEventListener(l,c,!1)}function i1(s,l,c,h,v){var _=h;if((l&1)===0&&(l&2)===0&&h!==null)e:for(;;){if(h===null)return;var k=h.tag;if(k===3||k===4){var U=h.stateNode.containerInfo;if(U===v)break;if(k===4)for(k=h.return;k!==null;){var ae=k.tag;if((ae===3||ae===4)&&k.stateNode.containerInfo===v)return;k=k.return}for(;U!==null;){if(k=Ve(U),k===null)return;if(ae=k.tag,ae===5||ae===6||ae===26||ae===27){h=_=k;continue e}U=U.parentNode}}h=h.return}Yi(function(){var pe=_,Ne=Fa(c),Oe=[];e:{var ve=b_.get(s);if(ve!==void 0){var Ee=ks,Je=s;switch(s){case"keypress":if(ho(c)===0)break e;case"keydown":case"keyup":Ee=Eh;break;case"focusin":Je="focus",Ee=po;break;case"focusout":Je="blur",Ee=po;break;case"beforeblur":case"afterblur":Ee=po;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=Ku;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=mh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=S;break;case v_:case y_:case __:Ee=gh;break;case w_:Ee=W;break;case"scroll":case"scrollend":Ee=$u;break;case"wheel":Ee=be;break;case"copy":case"cut":case"paste":Ee=xh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=ii;break;case"toggle":case"beforetoggle":Ee=xt}var it=(l&4)!==0,ir=!it&&(s==="scroll"||s==="scrollend"),ue=it?ve!==null?ve+"Capture":null:ve;it=[];for(var ie=pe,he;ie!==null;){var Ie=ie;if(he=Ie.stateNode,Ie=Ie.tag,Ie!==5&&Ie!==26&&Ie!==27||he===null||ue===null||(Ie=os(ie,ue),Ie!=null&&it.push(kf(ie,Ie,he))),ir)break;ie=ie.return}0<it.length&&(ve=new Ee(ve,Je,null,c,Ne),Oe.push({event:ve,listeners:it}))}}if((l&7)===0){e:{if(ve=s==="mouseover"||s==="pointerover",Ee=s==="mouseout"||s==="pointerout",ve&&c!==Wu&&(Je=c.relatedTarget||c.fromElement)&&(Ve(Je)||Je[ee]))break e;if((Ee||ve)&&(ve=Ne.window===Ne?Ne:(ve=Ne.ownerDocument)?ve.defaultView||ve.parentWindow:window,Ee?(Je=c.relatedTarget||c.toElement,Ee=pe,Je=Je?Ve(Je):null,Je!==null&&(ir=i(Je),it=Je.tag,Je!==ir||it!==5&&it!==27&&it!==6)&&(Je=null)):(Ee=null,Je=pe),Ee!==Je)){if(it=Ku,Ie="onMouseLeave",ue="onMouseEnter",ie="mouse",(s==="pointerout"||s==="pointerover")&&(it=ii,Ie="onPointerLeave",ue="onPointerEnter",ie="pointer"),ir=Ee==null?ve:Le(Ee),he=Je==null?ve:Le(Je),ve=new it(Ie,ie+"leave",Ee,c,Ne),ve.target=ir,ve.relatedTarget=he,Ie=null,Ve(Ne)===pe&&(it=new it(ue,ie+"enter",Je,c,Ne),it.target=he,it.relatedTarget=ir,Ie=it),ir=Ie,Ee&&Je)t:{for(it=u6,ue=Ee,ie=Je,he=0,Ie=ue;Ie;Ie=it(Ie))he++;Ie=0;for(var nt=ie;nt;nt=it(nt))Ie++;for(;0<he-Ie;)ue=it(ue),he--;for(;0<Ie-he;)ie=it(ie),Ie--;for(;he--;){if(ue===ie||ie!==null&&ue===ie.alternate){it=ue;break t}ue=it(ue),ie=it(ie)}it=null}else it=null;Ee!==null&&Gw(Oe,ve,Ee,it,!1),Je!==null&&ir!==null&&Gw(Oe,ir,Je,it,!0)}}e:{if(ve=pe?Le(pe):window,Ee=ve.nodeName&&ve.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&ve.type==="file")var Bt=l_;else if(s_(ve))if(o_)Bt=w3;else{Bt=y3;var tt=v3}else Ee=ve.nodeName,!Ee||Ee.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?pe&&hc(pe.elementType)&&(Bt=l_):Bt=_3;if(Bt&&(Bt=Bt(s,pe))){i_(Oe,Bt,c,Ne);break e}tt&&tt(s,ve,pe),s==="focusout"&&pe&&ve.type==="number"&&pe.memoizedProps.value!=null&&Hu(ve,"number",ve.value)}switch(tt=pe?Le(pe):window,s){case"focusin":(s_(tt)||tt.contentEditable==="true")&&(_c=tt,Mp=pe,tf=null);break;case"focusout":tf=Mp=_c=null;break;case"mousedown":Pp=!0;break;case"contextmenu":case"mouseup":case"dragend":Pp=!1,g_(Oe,c,Ne);break;case"selectionchange":if(E3)break;case"keydown":case"keyup":g_(Oe,c,Ne)}var bt;if(Ht)e:{switch(s){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else yc?go(s,c)&&(Nt="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Nt="onCompositionStart");Nt&&(Rs&&c.locale!=="ko"&&(yc||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&yc&&(bt=Yu()):(As=Ne,Xu="value"in As?As.value:As.textContent,yc=!0)),tt=dd(pe,Nt),0<tt.length&&(Nt=new Ns(Nt,s,null,c,Ne),Oe.push({event:Nt,listeners:tt}),bt?Nt.data=bt:(bt=vc(c),bt!==null&&(Nt.data=bt)))),(bt=Pa?m3(s,c):p3(s,c))&&(Nt=dd(pe,"onBeforeInput"),0<Nt.length&&(tt=new Ns("onBeforeInput","beforeinput",null,c,Ne),Oe.push({event:tt,listeners:Nt}),tt.data=bt)),i6(Oe,s,pe,c,Ne)}zw(Oe,l)})}function kf(s,l,c){return{instance:s,listener:l,currentTarget:c}}function dd(s,l){for(var c=l+"Capture",h=[];s!==null;){var v=s,_=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||_===null||(v=os(s,c),v!=null&&h.unshift(kf(s,v,_)),v=os(s,l),v!=null&&h.push(kf(s,v,_))),s.tag===3)return h;s=s.return}return[]}function u6(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Gw(s,l,c,h,v){for(var _=l._reactName,k=[];c!==null&&c!==h;){var U=c,ae=U.alternate,pe=U.stateNode;if(U=U.tag,ae!==null&&ae===h)break;U!==5&&U!==26&&U!==27||pe===null||(ae=pe,v?(pe=os(c,_),pe!=null&&k.unshift(kf(c,pe,ae))):v||(pe=os(c,_),pe!=null&&k.push(kf(c,pe,ae)))),c=c.return}k.length!==0&&s.push({event:l,listeners:k})}var f6=/\r\n?/g,h6=/\u0000|\uFFFD/g;function qw(s){return(typeof s=="string"?s:""+s).replace(f6,`
`).replace(h6,"")}function Ww(s,l){return l=qw(l),qw(s)===l}function sr(s,l,c,h,v,_){switch(c){case"children":typeof h=="string"?l==="body"||l==="textarea"&&h===""||ta(s,h):(typeof h=="number"||typeof h=="bigint")&&l!=="body"&&ta(s,""+h);break;case"className":xa(s,"class",h);break;case"tabIndex":xa(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":xa(s,c,h);break;case"style":qu(s,h,_);break;case"data":if(l!=="object"){xa(s,"data",h);break}case"src":case"href":if(h===""&&(l!=="a"||c!=="href")){s.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=dc(""+h),s.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(c==="formAction"?(l!=="input"&&sr(s,l,"name",v.name,v,null),sr(s,l,"formEncType",v.formEncType,v,null),sr(s,l,"formMethod",v.formMethod,v,null),sr(s,l,"formTarget",v.formTarget,v,null)):(sr(s,l,"encType",v.encType,v,null),sr(s,l,"method",v.method,v,null),sr(s,l,"target",v.target,v,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=dc(""+h),s.setAttribute(c,h);break;case"onClick":h!=null&&(s.onclick=ls);break;case"onScroll":h!=null&&kt("scroll",s);break;case"onScrollEnd":h!=null&&kt("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}c=dc(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""+h):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":h===!0?s.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,h):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(c,h):s.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(c):s.setAttribute(c,h);break;case"popover":kt("beforetoggle",s),kt("toggle",s),Rn(s,"popover",h);break;case"xlinkActuate":Wr(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Wr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Wr(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Wr(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Wr(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Wr(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Wr(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Wr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Wr(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Rn(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=dh.get(c)||c,Rn(s,c,h))}}function l1(s,l,c,h,v,_){switch(c){case"style":qu(s,h,_);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"children":typeof h=="string"?ta(s,h):(typeof h=="number"||typeof h=="bigint")&&ta(s,""+h);break;case"onScroll":h!=null&&kt("scroll",s);break;case"onScrollEnd":h!=null&&kt("scrollend",s);break;case"onClick":h!=null&&(s.onclick=ls);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$t.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(v=c.endsWith("Capture"),l=c.slice(2,v?c.length-7:void 0),_=s[J]||null,_=_!=null?_[c]:null,typeof _=="function"&&s.removeEventListener(l,_,v),typeof h=="function")){typeof _!="function"&&_!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(l,h,v);break e}c in s?s[c]=h:h===!0?s.setAttribute(c,""):Rn(s,c,h)}}}function bn(s,l,c){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":kt("error",s),kt("load",s);var h=!1,v=!1,_;for(_ in c)if(c.hasOwnProperty(_)){var k=c[_];if(k!=null)switch(_){case"src":h=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:sr(s,l,_,k,c,null)}}v&&sr(s,l,"srcSet",c.srcSet,c,null),h&&sr(s,l,"src",c.src,c,null);return;case"input":kt("invalid",s);var U=_=k=v=null,ae=null,pe=null;for(h in c)if(c.hasOwnProperty(h)){var Ne=c[h];if(Ne!=null)switch(h){case"name":v=Ne;break;case"type":k=Ne;break;case"checked":ae=Ne;break;case"defaultChecked":pe=Ne;break;case"value":_=Ne;break;case"defaultValue":U=Ne;break;case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(n(137,l));break;default:sr(s,l,h,Ne,c,null)}}uh(s,_,U,ae,pe,k,v,!1);return;case"select":kt("invalid",s),h=k=_=null;for(v in c)if(c.hasOwnProperty(v)&&(U=c[v],U!=null))switch(v){case"value":_=U;break;case"defaultValue":k=U;break;case"multiple":h=U;default:sr(s,l,v,U,c,null)}l=_,c=k,s.multiple=!!h,l!=null?Gi(s,!!h,l,!1):c!=null&&Gi(s,!!h,c,!0);return;case"textarea":kt("invalid",s),_=v=h=null;for(k in c)if(c.hasOwnProperty(k)&&(U=c[k],U!=null))switch(k){case"value":h=U;break;case"defaultValue":v=U;break;case"children":_=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(n(91));break;default:sr(s,l,k,U,c,null)}qi(s,h,v,_);return;case"option":for(ae in c)if(c.hasOwnProperty(ae)&&(h=c[ae],h!=null))switch(ae){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:sr(s,l,ae,h,c,null)}return;case"dialog":kt("beforetoggle",s),kt("toggle",s),kt("cancel",s),kt("close",s);break;case"iframe":case"object":kt("load",s);break;case"video":case"audio":for(h=0;h<Af.length;h++)kt(Af[h],s);break;case"image":kt("error",s),kt("load",s);break;case"details":kt("toggle",s);break;case"embed":case"source":case"link":kt("error",s),kt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in c)if(c.hasOwnProperty(pe)&&(h=c[pe],h!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:sr(s,l,pe,h,c,null)}return;default:if(hc(l)){for(Ne in c)c.hasOwnProperty(Ne)&&(h=c[Ne],h!==void 0&&l1(s,l,Ne,h,c,void 0));return}}for(U in c)c.hasOwnProperty(U)&&(h=c[U],h!=null&&sr(s,l,U,h,c,null))}function d6(s,l,c,h){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,_=null,k=null,U=null,ae=null,pe=null,Ne=null;for(Ee in c){var Oe=c[Ee];if(c.hasOwnProperty(Ee)&&Oe!=null)switch(Ee){case"checked":break;case"value":break;case"defaultValue":ae=Oe;default:h.hasOwnProperty(Ee)||sr(s,l,Ee,null,h,Oe)}}for(var ve in h){var Ee=h[ve];if(Oe=c[ve],h.hasOwnProperty(ve)&&(Ee!=null||Oe!=null))switch(ve){case"type":_=Ee;break;case"name":v=Ee;break;case"checked":pe=Ee;break;case"defaultChecked":Ne=Ee;break;case"value":k=Ee;break;case"defaultValue":U=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,l));break;default:Ee!==Oe&&sr(s,l,ve,Ee,h,Oe)}}fc(s,k,U,ae,pe,Ne,_,v);return;case"select":Ee=k=U=ve=null;for(_ in c)if(ae=c[_],c.hasOwnProperty(_)&&ae!=null)switch(_){case"value":break;case"multiple":Ee=ae;default:h.hasOwnProperty(_)||sr(s,l,_,null,h,ae)}for(v in h)if(_=h[v],ae=c[v],h.hasOwnProperty(v)&&(_!=null||ae!=null))switch(v){case"value":ve=_;break;case"defaultValue":U=_;break;case"multiple":k=_;default:_!==ae&&sr(s,l,v,_,h,ae)}l=U,c=k,h=Ee,ve!=null?Gi(s,!!c,ve,!1):!!h!=!!c&&(l!=null?Gi(s,!!c,l,!0):Gi(s,!!c,c?[]:"",!1));return;case"textarea":Ee=ve=null;for(U in c)if(v=c[U],c.hasOwnProperty(U)&&v!=null&&!h.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:sr(s,l,U,null,h,v)}for(k in h)if(v=h[k],_=c[k],h.hasOwnProperty(k)&&(v!=null||_!=null))switch(k){case"value":ve=v;break;case"defaultValue":Ee=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(n(91));break;default:v!==_&&sr(s,l,k,v,h,_)}fh(s,ve,Ee);return;case"option":for(var Je in c)if(ve=c[Je],c.hasOwnProperty(Je)&&ve!=null&&!h.hasOwnProperty(Je))switch(Je){case"selected":s.selected=!1;break;default:sr(s,l,Je,null,h,ve)}for(ae in h)if(ve=h[ae],Ee=c[ae],h.hasOwnProperty(ae)&&ve!==Ee&&(ve!=null||Ee!=null))switch(ae){case"selected":s.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:sr(s,l,ae,ve,h,Ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var it in c)ve=c[it],c.hasOwnProperty(it)&&ve!=null&&!h.hasOwnProperty(it)&&sr(s,l,it,null,h,ve);for(pe in h)if(ve=h[pe],Ee=c[pe],h.hasOwnProperty(pe)&&ve!==Ee&&(ve!=null||Ee!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,l));break;default:sr(s,l,pe,ve,h,Ee)}return;default:if(hc(l)){for(var ir in c)ve=c[ir],c.hasOwnProperty(ir)&&ve!==void 0&&!h.hasOwnProperty(ir)&&l1(s,l,ir,void 0,h,ve);for(Ne in h)ve=h[Ne],Ee=c[Ne],!h.hasOwnProperty(Ne)||ve===Ee||ve===void 0&&Ee===void 0||l1(s,l,Ne,ve,h,Ee);return}}for(var ue in c)ve=c[ue],c.hasOwnProperty(ue)&&ve!=null&&!h.hasOwnProperty(ue)&&sr(s,l,ue,null,h,ve);for(Oe in h)ve=h[Oe],Ee=c[Oe],!h.hasOwnProperty(Oe)||ve===Ee||ve==null&&Ee==null||sr(s,l,Oe,ve,h,Ee)}function Xw(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function m6(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var v=c[h],_=v.transferSize,k=v.initiatorType,U=v.duration;if(_&&U&&Xw(k)){for(k=0,U=v.responseEnd,h+=1;h<c.length;h++){var ae=c[h],pe=ae.startTime;if(pe>U)break;var Ne=ae.transferSize,Oe=ae.initiatorType;Ne&&Xw(Oe)&&(ae=ae.responseEnd,k+=Ne*(ae<U?1:(U-pe)/(ae-pe)))}if(--h,l+=8*(_+k)/(v.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var o1=null,c1=null;function md(s){return s.nodeType===9?s:s.ownerDocument}function Yw(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $w(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function u1(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var f1=null;function p6(){var s=window.event;return s&&s.type==="popstate"?s===f1?!1:(f1=s,!0):(f1=null,!1)}var Kw=typeof setTimeout=="function"?setTimeout:void 0,g6=typeof clearTimeout=="function"?clearTimeout:void 0,Qw=typeof Promise=="function"?Promise:void 0,x6=typeof queueMicrotask=="function"?queueMicrotask:typeof Qw<"u"?function(s){return Qw.resolve(null).then(s).catch(v6)}:Kw;function v6(s){setTimeout(function(){throw s})}function ml(s){return s==="head"}function Jw(s,l){var c=l,h=0;do{var v=c.nextSibling;if(s.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"||c==="/&"){if(h===0){s.removeChild(v),Xc(l);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")Cf(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,Cf(c);for(var _=c.firstChild;_;){var k=_.nextSibling,U=_.nodeName;_[ge]||U==="SCRIPT"||U==="STYLE"||U==="LINK"&&_.rel.toLowerCase()==="stylesheet"||c.removeChild(_),_=k}}else c==="body"&&Cf(s.ownerDocument.body);c=v}while(c);Xc(l)}function Zw(s,l){var c=s;s=0;do{var h=c.nextSibling;if(c.nodeType===1?l?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(l?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=h}while(c)}function h1(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var c=l;switch(l=l.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":h1(c),Be(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function y6(s,l,c,h){for(;s.nodeType===1;){var v=c;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[ge])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var _=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=Ha(s.nextSibling),s===null)break}return null}function _6(s,l,c){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Ha(s.nextSibling),s===null))return null;return s}function eb(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Ha(s.nextSibling),s===null))return null;return s}function d1(s){return s.data==="$?"||s.data==="$~"}function m1(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function w6(s,l){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||c.readyState!=="loading")l();else{var h=function(){l(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function Ha(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var p1=null;function tb(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(l===0)return Ha(s.nextSibling);l--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||l++}s=s.nextSibling}return null}function rb(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(l===0)return s;l--}else c!=="/$"&&c!=="/&"||l++}s=s.previousSibling}return null}function nb(s,l,c){switch(l=md(c),s){case"html":if(s=l.documentElement,!s)throw Error(n(452));return s;case"head":if(s=l.head,!s)throw Error(n(453));return s;case"body":if(s=l.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Cf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Be(s)}var Ga=new Map,ab=new Set;function pd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var wi=oe.d;oe.d={f:b6,r:E6,D:T6,C:S6,L:A6,m:k6,X:N6,S:C6,M:R6};function b6(){var s=wi.f(),l=id();return s||l}function E6(s){var l=qe(s);l!==null&&l.tag===5&&l.type==="form"?w2(l):wi.r(s)}var Gc=typeof document>"u"?null:document;function sb(s,l,c){var h=Gc;if(h&&typeof l=="string"&&l){var v=ea(l);v='link[rel="'+s+'"][href="'+v+'"]',typeof c=="string"&&(v+='[crossorigin="'+c+'"]'),ab.has(v)||(ab.add(v),s={rel:s,crossOrigin:c,href:l},h.querySelector(v)===null&&(l=h.createElement("link"),bn(l,"link",s),Ze(l),h.head.appendChild(l)))}}function T6(s){wi.D(s),sb("dns-prefetch",s,null)}function S6(s,l){wi.C(s,l),sb("preconnect",s,l)}function A6(s,l,c){wi.L(s,l,c);var h=Gc;if(h&&s&&l){var v='link[rel="preload"][as="'+ea(l)+'"]';l==="image"&&c&&c.imageSrcSet?(v+='[imagesrcset="'+ea(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(v+='[imagesizes="'+ea(c.imageSizes)+'"]')):v+='[href="'+ea(s)+'"]';var _=v;switch(l){case"style":_=qc(s);break;case"script":_=Wc(s)}Ga.has(_)||(s=x({rel:"preload",href:l==="image"&&c&&c.imageSrcSet?void 0:s,as:l},c),Ga.set(_,s),h.querySelector(v)!==null||l==="style"&&h.querySelector(Nf(_))||l==="script"&&h.querySelector(Rf(_))||(l=h.createElement("link"),bn(l,"link",s),Ze(l),h.head.appendChild(l)))}}function k6(s,l){wi.m(s,l);var c=Gc;if(c&&s){var h=l&&typeof l.as=="string"?l.as:"script",v='link[rel="modulepreload"][as="'+ea(h)+'"][href="'+ea(s)+'"]',_=v;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Wc(s)}if(!Ga.has(_)&&(s=x({rel:"modulepreload",href:s},l),Ga.set(_,s),c.querySelector(v)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Rf(_)))return}h=c.createElement("link"),bn(h,"link",s),Ze(h),c.head.appendChild(h)}}}function C6(s,l,c){wi.S(s,l,c);var h=Gc;if(h&&s){var v=Ge(h).hoistableStyles,_=qc(s);l=l||"default";var k=v.get(_);if(!k){var U={loading:0,preload:null};if(k=h.querySelector(Nf(_)))U.loading=5;else{s=x({rel:"stylesheet",href:s,"data-precedence":l},c),(c=Ga.get(_))&&g1(s,c);var ae=k=h.createElement("link");Ze(ae),bn(ae,"link",s),ae._p=new Promise(function(pe,Ne){ae.onload=pe,ae.onerror=Ne}),ae.addEventListener("load",function(){U.loading|=1}),ae.addEventListener("error",function(){U.loading|=2}),U.loading|=4,gd(k,l,h)}k={type:"stylesheet",instance:k,count:1,state:U},v.set(_,k)}}}function N6(s,l){wi.X(s,l);var c=Gc;if(c&&s){var h=Ge(c).hoistableScripts,v=Wc(s),_=h.get(v);_||(_=c.querySelector(Rf(v)),_||(s=x({src:s,async:!0},l),(l=Ga.get(v))&&x1(s,l),_=c.createElement("script"),Ze(_),bn(_,"link",s),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},h.set(v,_))}}function R6(s,l){wi.M(s,l);var c=Gc;if(c&&s){var h=Ge(c).hoistableScripts,v=Wc(s),_=h.get(v);_||(_=c.querySelector(Rf(v)),_||(s=x({src:s,async:!0,type:"module"},l),(l=Ga.get(v))&&x1(s,l),_=c.createElement("script"),Ze(_),bn(_,"link",s),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},h.set(v,_))}}function ib(s,l,c,h){var v=(v=ce.current)?pd(v):null;if(!v)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(l=qc(c.href),c=Ge(v).hoistableStyles,h=c.get(l),h||(h={type:"style",instance:null,count:0,state:null},c.set(l,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=qc(c.href);var _=Ge(v).hoistableStyles,k=_.get(s);if(k||(v=v.ownerDocument||v,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,k),(_=v.querySelector(Nf(s)))&&!_._p&&(k.instance=_,k.state.loading=5),Ga.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ga.set(s,c),_||I6(v,s,c,k.state))),l&&h===null)throw Error(n(528,""));return k}if(l&&h!==null)throw Error(n(529,""));return null;case"script":return l=c.async,c=c.src,typeof c=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Wc(c),c=Ge(v).hoistableScripts,h=c.get(l),h||(h={type:"script",instance:null,count:0,state:null},c.set(l,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function qc(s){return'href="'+ea(s)+'"'}function Nf(s){return'link[rel="stylesheet"]['+s+"]"}function lb(s){return x({},s,{"data-precedence":s.precedence,precedence:null})}function I6(s,l,c,h){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?h.loading=1:(l=s.createElement("link"),h.preload=l,l.addEventListener("load",function(){return h.loading|=1}),l.addEventListener("error",function(){return h.loading|=2}),bn(l,"link",c),Ze(l),s.head.appendChild(l))}function Wc(s){return'[src="'+ea(s)+'"]'}function Rf(s){return"script[async]"+s}function ob(s,l,c){if(l.count++,l.instance===null)switch(l.type){case"style":var h=s.querySelector('style[data-href~="'+ea(c.href)+'"]');if(h)return l.instance=h,Ze(h),h;var v=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),Ze(h),bn(h,"style",v),gd(h,c.precedence,s),l.instance=h;case"stylesheet":v=qc(c.href);var _=s.querySelector(Nf(v));if(_)return l.state.loading|=4,l.instance=_,Ze(_),_;h=lb(c),(v=Ga.get(v))&&g1(h,v),_=(s.ownerDocument||s).createElement("link"),Ze(_);var k=_;return k._p=new Promise(function(U,ae){k.onload=U,k.onerror=ae}),bn(_,"link",h),l.state.loading|=4,gd(_,c.precedence,s),l.instance=_;case"script":return _=Wc(c.src),(v=s.querySelector(Rf(_)))?(l.instance=v,Ze(v),v):(h=c,(v=Ga.get(_))&&(h=x({},c),x1(h,v)),s=s.ownerDocument||s,v=s.createElement("script"),Ze(v),bn(v,"link",h),s.head.appendChild(v),l.instance=v);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(h=l.instance,l.state.loading|=4,gd(h,c.precedence,s));return l.instance}function gd(s,l,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=h.length?h[h.length-1]:null,_=v,k=0;k<h.length;k++){var U=h[k];if(U.dataset.precedence===l)_=U;else if(_!==v)break}_?_.parentNode.insertBefore(s,_.nextSibling):(l=c.nodeType===9?c.head:c,l.insertBefore(s,l.firstChild))}function g1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function x1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var xd=null;function cb(s,l,c){if(xd===null){var h=new Map,v=xd=new Map;v.set(c,h)}else v=xd,h=v.get(c),h||(h=new Map,v.set(c,h));if(h.has(s))return h;for(h.set(s,null),c=c.getElementsByTagName(s),v=0;v<c.length;v++){var _=c[v];if(!(_[ge]||_[K]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var k=_.getAttribute(l)||"";k=s+k;var U=h.get(k);U?U.push(_):h.set(k,[_])}}return h}function ub(s,l,c){s=s.ownerDocument||s,s.head.insertBefore(c,l==="title"?s.querySelector("head > title"):null)}function D6(s,l,c){if(c===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function fb(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function O6(s,l,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var v=qc(h.href),_=l.querySelector(Nf(v));if(_){l=_._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=vd.bind(s),l.then(s,s)),c.state.loading|=4,c.instance=_,Ze(_);return}_=l.ownerDocument||l,h=lb(h),(v=Ga.get(v))&&g1(h,v),_=_.createElement("link"),Ze(_);var k=_;k._p=new Promise(function(U,ae){k.onload=U,k.onerror=ae}),bn(_,"link",h),c.instance=_}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,l),(l=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=vd.bind(s),l.addEventListener("load",c),l.addEventListener("error",c))}}var v1=0;function F6(s,l){return s.stylesheets&&s.count===0&&_d(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var h=setTimeout(function(){if(s.stylesheets&&_d(s,s.stylesheets),s.unsuspend){var _=s.unsuspend;s.unsuspend=null,_()}},6e4+l);0<s.imgBytes&&v1===0&&(v1=62500*m6());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&_d(s,s.stylesheets),s.unsuspend)){var _=s.unsuspend;s.unsuspend=null,_()}},(s.imgBytes>v1?50:800)+l);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(h),clearTimeout(v)}}:null}function vd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)_d(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var yd=null;function _d(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,yd=new Map,l.forEach(M6,s),yd=null,vd.call(s))}function M6(s,l){if(!(l.state.loading&4)){var c=yd.get(s);if(c)var h=c.get(null);else{c=new Map,yd.set(s,c);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<v.length;_++){var k=v[_];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(c.set(k.dataset.precedence,k),h=k)}h&&c.set(null,h)}v=l.instance,k=v.getAttribute("data-precedence"),_=c.get(k)||h,_===h&&c.set(null,v),c.set(k,v),this.count++,h=vd.bind(this),v.addEventListener("load",h),v.addEventListener("error",h),_?_.parentNode.insertBefore(v,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),l.state.loading|=4}}var If={$$typeof:C,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function P6(s,l,c,h,v,_,k,U,ae){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oa(0),this.hiddenUpdates=Oa(null),this.identifierPrefix=h,this.onUncaughtError=v,this.onCaughtError=_,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ae,this.incompleteTransitions=new Map}function hb(s,l,c,h,v,_,k,U,ae,pe,Ne,Oe){return s=new P6(s,l,c,k,ae,pe,Ne,Oe,U),l=1,_===!0&&(l|=24),_=ya(3,null,null,l),s.current=_,_.stateNode=s,l=Qp(),l.refCount++,s.pooledCache=l,l.refCount++,_.memoizedState={element:h,isDehydrated:c,cache:l},tg(_),s}function db(s){return s?(s=Ec,s):Ec}function mb(s,l,c,h,v,_){v=db(v),h.context===null?h.context=v:h.pendingContext=v,h=nl(l),h.payload={element:c},_=_===void 0?null:_,_!==null&&(h.callback=_),c=al(s,h,l),c!==null&&(ia(c,s,l),cf(c,s,l))}function pb(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<l?c:l}}function y1(s,l){pb(s,l),(s=s.alternate)&&pb(s,l)}function gb(s){if(s.tag===13||s.tag===31){var l=yo(s,67108864);l!==null&&ia(l,s,67108864),y1(s,67108864)}}function xb(s){if(s.tag===13||s.tag===31){var l=Ta();l=ni(l);var c=yo(s,l);c!==null&&ia(c,s,l),y1(s,l)}}var wd=!0;function j6(s,l,c,h){var v=se.T;se.T=null;var _=oe.p;try{oe.p=2,_1(s,l,c,h)}finally{oe.p=_,se.T=v}}function L6(s,l,c,h){var v=se.T;se.T=null;var _=oe.p;try{oe.p=8,_1(s,l,c,h)}finally{oe.p=_,se.T=v}}function _1(s,l,c,h){if(wd){var v=w1(h);if(v===null)i1(s,l,h,bd,c),yb(s,h);else if(V6(v,s,l,c,h))h.stopPropagation();else if(yb(s,h),l&4&&-1<B6.indexOf(s)){for(;v!==null;){var _=qe(v);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var k=Wn(_.pendingLanes);if(k!==0){var U=_;for(U.pendingLanes|=2,U.entangledLanes|=2;k;){var ae=1<<31-dr(k);U.entanglements[1]|=ae,k&=~ae}Fs(_),(Gt&6)===0&&(ad=zt()+500,Sf(0))}}break;case 31:case 13:U=yo(_,2),U!==null&&ia(U,_,2),id(),y1(_,2)}if(_=w1(h),_===null&&i1(s,l,h,bd,c),_===v)break;v=_}v!==null&&h.stopPropagation()}else i1(s,l,h,null,c)}}function w1(s){return s=Fa(s),b1(s)}var bd=null;function b1(s){if(bd=null,s=Ve(s),s!==null){var l=i(s);if(l===null)s=null;else{var c=l.tag;if(c===13){if(s=o(l),s!==null)return s;s=null}else if(c===31){if(s=u(l),s!==null)return s;s=null}else if(c===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return bd=s,null}function vb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Gr()){case an:return 2;case qn:return 8;case Xt:case Fr:return 32;case dt:return 268435456;default:return 32}default:return 32}}var E1=!1,pl=null,gl=null,xl=null,Df=new Map,Of=new Map,vl=[],B6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yb(s,l){switch(s){case"focusin":case"focusout":pl=null;break;case"dragenter":case"dragleave":gl=null;break;case"mouseover":case"mouseout":xl=null;break;case"pointerover":case"pointerout":Df.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Of.delete(l.pointerId)}}function Ff(s,l,c,h,v,_){return s===null||s.nativeEvent!==_?(s={blockedOn:l,domEventName:c,eventSystemFlags:h,nativeEvent:_,targetContainers:[v]},l!==null&&(l=qe(l),l!==null&&gb(l)),s):(s.eventSystemFlags|=h,l=s.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),s)}function V6(s,l,c,h,v){switch(l){case"focusin":return pl=Ff(pl,s,l,c,h,v),!0;case"dragenter":return gl=Ff(gl,s,l,c,h,v),!0;case"mouseover":return xl=Ff(xl,s,l,c,h,v),!0;case"pointerover":var _=v.pointerId;return Df.set(_,Ff(Df.get(_)||null,s,l,c,h,v)),!0;case"gotpointercapture":return _=v.pointerId,Of.set(_,Ff(Of.get(_)||null,s,l,c,h,v)),!0}return!1}function _b(s){var l=Ve(s.target);if(l!==null){var c=i(l);if(c!==null){if(l=c.tag,l===13){if(l=o(c),l!==null){s.blockedOn=l,Z(s.priority,function(){xb(c)});return}}else if(l===31){if(l=u(c),l!==null){s.blockedOn=l,Z(s.priority,function(){xb(c)});return}}else if(l===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ed(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var c=w1(s.nativeEvent);if(c===null){c=s.nativeEvent;var h=new c.constructor(c.type,c);Wu=h,c.target.dispatchEvent(h),Wu=null}else return l=qe(c),l!==null&&gb(l),s.blockedOn=c,!1;l.shift()}return!0}function wb(s,l,c){Ed(s)&&c.delete(l)}function U6(){E1=!1,pl!==null&&Ed(pl)&&(pl=null),gl!==null&&Ed(gl)&&(gl=null),xl!==null&&Ed(xl)&&(xl=null),Df.forEach(wb),Of.forEach(wb)}function Td(s,l){s.blockedOn===l&&(s.blockedOn=null,E1||(E1=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,U6)))}var Sd=null;function bb(s){Sd!==s&&(Sd=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Sd===s&&(Sd=null);for(var l=0;l<s.length;l+=3){var c=s[l],h=s[l+1],v=s[l+2];if(typeof h!="function"){if(b1(h||c)===null)continue;break}var _=qe(c);_!==null&&(s.splice(l,3),l-=3,wg(_,{pending:!0,data:v,method:c.method,action:h},h,v))}}))}function Xc(s){function l(ae){return Td(ae,s)}pl!==null&&Td(pl,s),gl!==null&&Td(gl,s),xl!==null&&Td(xl,s),Df.forEach(l),Of.forEach(l);for(var c=0;c<vl.length;c++){var h=vl[c];h.blockedOn===s&&(h.blockedOn=null)}for(;0<vl.length&&(c=vl[0],c.blockedOn===null);)_b(c),c.blockedOn===null&&vl.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var v=c[h],_=c[h+1],k=v[J]||null;if(typeof _=="function")k||bb(c);else if(k){var U=null;if(_&&_.hasAttribute("formAction")){if(v=_,k=_[J]||null)U=k.formAction;else if(b1(v)!==null)continue}else U=k.action;typeof U=="function"?c[h+1]=U:(c.splice(h,3),h-=3),bb(c)}}}function Eb(){function s(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(k){return v=k})},focusReset:"manual",scroll:"manual"})}function l(){v!==null&&(v(),v=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),v!==null&&(v(),v=null)}}}function T1(s){this._internalRoot=s}Ad.prototype.render=T1.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(n(409));var c=l.current,h=Ta();mb(c,h,s,l,null,null)},Ad.prototype.unmount=T1.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;mb(s.current,2,null,s,null,null),id(),l[ee]=null}};function Ad(s){this._internalRoot=s}Ad.prototype.unstable_scheduleHydration=function(s){if(s){var l=V();s={blockedOn:null,target:s,priority:l};for(var c=0;c<vl.length&&l!==0&&l<vl[c].priority;c++);vl.splice(c,0,s),c===0&&_b(s)}};var Tb=e.version;if(Tb!=="19.2.1")throw Error(n(527,Tb,"19.2.1"));oe.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=d(l),s=s!==null?p(s):null,s=s===null?null:s.stateNode,s};var z6={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:se,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kd.isDisabled&&kd.supportsFiber)try{Mt=kd.inject(z6),or=kd}catch{}}return Pf.createRoot=function(s,l){if(!a(s))throw Error(n(299));var c=!1,h="",v=I2,_=D2,k=O2;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(h=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(_=l.onCaughtError),l.onRecoverableError!==void 0&&(k=l.onRecoverableError)),l=hb(s,1,!1,null,null,c,h,null,v,_,k,Eb),s[ee]=l.current,s1(s),new T1(l)},Pf.hydrateRoot=function(s,l,c){if(!a(s))throw Error(n(299));var h=!1,v="",_=I2,k=D2,U=O2,ae=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onUncaughtError!==void 0&&(_=c.onUncaughtError),c.onCaughtError!==void 0&&(k=c.onCaughtError),c.onRecoverableError!==void 0&&(U=c.onRecoverableError),c.formState!==void 0&&(ae=c.formState)),l=hb(s,1,!0,l,c??null,h,v,ae,_,k,U,Eb),l.context=db(null),c=l.current,h=Ta(),h=ni(h),v=nl(h),v.callback=null,al(c,v,h),c=h,l.current.lanes=c,ei(l,c),Fs(l),s[ee]=l.current,s1(s),new Ad(l)},Pf.version="19.2.1",Pf}var Fb;function J6(){if(Fb)return k1.exports;Fb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),k1.exports=Q6(),k1.exports}var Z6=J6();const eR=VS(Z6);var Mb="popstate";function tR(t={}){function e(a,i){let{pathname:o="/",search:u="",hash:f=""}=ec(a.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),fx("",{pathname:o,search:u,hash:f},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(a,i){let o=a.document.querySelector("base"),u="";if(o&&o.getAttribute("href")){let f=a.location.href,d=f.indexOf("#");u=d===-1?f:f.slice(0,d)}return u+"#"+(typeof i=="string"?i:c0(i))}function n(a,i){Ra(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return nR(e,r,n,t)}function Er(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ra(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function rR(){return Math.random().toString(36).substring(2,10)}function Pb(t,e){return{usr:t.state,key:t.key,idx:e}}function fx(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ec(e):e,state:r,key:e&&e.key||n||rR()}}function c0({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ec(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function nR(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,u="POP",f=null,d=p();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function p(){return(o.state||{idx:null}).idx}function x(){u="POP";let T=p(),I=T==null?null:T-d;d=T,f&&f({action:u,location:E.location,delta:I})}function y(T,I){u="PUSH";let R=fx(E.location,T,I);r&&r(R,T),d=p()+1;let C=Pb(R,d),z=E.createHref(R);try{o.pushState(C,"",z)}catch(H){if(H instanceof DOMException&&H.name==="DataCloneError")throw H;a.location.assign(z)}i&&f&&f({action:u,location:E.location,delta:1})}function w(T,I){u="REPLACE";let R=fx(E.location,T,I);r&&r(R,T),d=p();let C=Pb(R,d),z=E.createHref(R);o.replaceState(C,"",z),i&&f&&f({action:u,location:E.location,delta:0})}function b(T){return aR(T)}let E={get action(){return u},get location(){return t(a,o)},listen(T){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Mb,x),f=T,()=>{a.removeEventListener(Mb,x),f=null}},createHref(T){return e(a,T)},createURL:b,encodeLocation(T){let I=b(T);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:y,replace:w,go(T){return o.go(T)}};return E}function aR(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Er(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:c0(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function US(t,e,r="/"){return sR(t,e,r,!1)}function sR(t,e,r,n){let a=typeof e=="string"?ec(e):e,i=Ii(a.pathname||"/",r);if(i==null)return null;let o=zS(t);iR(o);let u=null;for(let f=0;u==null&&f<o.length;++f){let d=xR(i);u=pR(o[f],d,n)}return u}function zS(t,e=[],r=[],n="",a=!1){let i=(o,u,f=a,d)=>{let p={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&f)return;Er(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let x=Ai([n,p.relativePath]),y=r.concat(p);o.children&&o.children.length>0&&(Er(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),zS(o.children,e,y,x,f)),!(o.path==null&&!o.index)&&e.push({path:x,score:dR(x,o.index),routesMeta:y})};return t.forEach((o,u)=>{if(o.path===""||!o.path?.includes("?"))i(o,u);else for(let f of HS(o.path))i(o,u,!0,f)}),e}function HS(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=HS(n.join("/")),u=[];return u.push(...o.map(f=>f===""?i:[i,f].join("/"))),a&&u.push(...o),u.map(f=>t.startsWith("/")&&f===""?"/":f)}function iR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:mR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var lR=/^:[\w-]+$/,oR=3,cR=2,uR=1,fR=10,hR=-2,jb=t=>t==="*";function dR(t,e){let r=t.split("/"),n=r.length;return r.some(jb)&&(n+=hR),e&&(n+=cR),r.filter(a=>!jb(a)).reduce((a,i)=>a+(lR.test(i)?oR:i===""?uR:fR),n)}function mR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function pR(t,e,r=!1){let{routesMeta:n}=t,a={},i="/",o=[];for(let u=0;u<n.length;++u){let f=n[u],d=u===n.length-1,p=i==="/"?e:e.slice(i.length)||"/",x=um({path:f.relativePath,caseSensitive:f.caseSensitive,end:d},p),y=f.route;if(!x&&d&&r&&!n[n.length-1].route.index&&(x=um({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!x)return null;Object.assign(a,x.params),o.push({params:a,pathname:Ai([i,x.pathname]),pathnameBase:bR(Ai([i,x.pathnameBase])),route:y}),x.pathnameBase!=="/"&&(i=Ai([i,x.pathnameBase]))}return o}function um(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=gR(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((d,{paramName:p,isOptional:x},y)=>{if(p==="*"){let b=u[y]||"";o=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const w=u[y];return x&&!w?d[p]=void 0:d[p]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function gR(t,e=!1,r=!0){Ra(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,f)=>(n.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function xR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ra(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ii(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}var vR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yR=t=>vR.test(t);function _R(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?ec(t):t,i;if(r)if(yR(r))i=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Ra(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${r}`)}r.startsWith("/")?i=Lb(r.substring(1),"/"):i=Lb(r,e)}else i=e;return{pathname:i,search:ER(n),hash:TR(a)}}function Lb(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function I1(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wR(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function iv(t){let e=wR(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function lv(t,e,r,n=!1){let a;typeof t=="string"?a=ec(t):(a={...t},Er(!a.pathname||!a.pathname.includes("?"),I1("?","pathname","search",a)),Er(!a.pathname||!a.pathname.includes("#"),I1("#","pathname","hash",a)),Er(!a.search||!a.search.includes("#"),I1("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,u;if(o==null)u=r;else{let x=e.length-1;if(!n&&o.startsWith("..")){let y=o.split("/");for(;y[0]==="..";)y.shift(),x-=1;a.pathname=y.join("/")}u=x>=0?e[x]:"/"}let f=_R(a,u),d=o&&o!=="/"&&o.endsWith("/"),p=(i||o===".")&&r.endsWith("/");return!f.pathname.endsWith("/")&&(d||p)&&(f.pathname+="/"),f}var Ai=t=>t.join("/").replace(/\/\/+/g,"/"),bR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),ER=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,TR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function SR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function AR(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var GS=["POST","PUT","PATCH","DELETE"];new Set(GS);var kR=["GET",...GS];new Set(kR);var Au=re.createContext(null);Au.displayName="DataRouter";var Ym=re.createContext(null);Ym.displayName="DataRouterState";re.createContext(!1);var qS=re.createContext({isTransitioning:!1});qS.displayName="ViewTransition";var CR=re.createContext(new Map);CR.displayName="Fetchers";var NR=re.createContext(null);NR.displayName="Await";var ts=re.createContext(null);ts.displayName="Navigation";var F0=re.createContext(null);F0.displayName="Location";var $s=re.createContext({outlet:null,matches:[],isDataRoute:!1});$s.displayName="Route";var ov=re.createContext(null);ov.displayName="RouteError";function RR(t,{relative:e}={}){Er(ku(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=re.useContext(ts),{hash:a,pathname:i,search:o}=P0(t,{relative:e}),u=i;return r!=="/"&&(u=i==="/"?r:Ai([r,i])),n.createHref({pathname:u,search:o,hash:a})}function ku(){return re.useContext(F0)!=null}function Ql(){return Er(ku(),"useLocation() may be used only in the context of a <Router> component."),re.useContext(F0).location}var WS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function XS(t){re.useContext(ts).static||re.useLayoutEffect(t)}function M0(){let{isDataRoute:t}=re.useContext($s);return t?HR():IR()}function IR(){Er(ku(),"useNavigate() may be used only in the context of a <Router> component.");let t=re.useContext(Au),{basename:e,navigator:r}=re.useContext(ts),{matches:n}=re.useContext($s),{pathname:a}=Ql(),i=JSON.stringify(iv(n)),o=re.useRef(!1);return XS(()=>{o.current=!0}),re.useCallback((f,d={})=>{if(Ra(o.current,WS),!o.current)return;if(typeof f=="number"){r.go(f);return}let p=lv(f,JSON.parse(i),a,d.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Ai([e,p.pathname])),(d.replace?r.replace:r.push)(p,d.state,d)},[e,r,i,a,t])}re.createContext(null);function P0(t,{relative:e}={}){let{matches:r}=re.useContext($s),{pathname:n}=Ql(),a=JSON.stringify(iv(r));return re.useMemo(()=>lv(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function DR(t,e){return YS(t,e)}function YS(t,e,r,n,a){Er(ku(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=re.useContext(ts),{matches:o}=re.useContext($s),u=o[o.length-1],f=u?u.params:{},d=u?u.pathname:"/",p=u?u.pathnameBase:"/",x=u&&u.route;{let R=x&&x.path||"";$S(d,!x||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let y=Ql(),w;if(e){let R=typeof e=="string"?ec(e):e;Er(p==="/"||R.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${R.pathname}" was given in the \`location\` prop.`),w=R}else w=y;let b=w.pathname||"/",E=b;if(p!=="/"){let R=p.replace(/^\//,"").split("/");E="/"+b.replace(/^\//,"").split("/").slice(R.length).join("/")}let T=US(t,{pathname:E});Ra(x||T!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),Ra(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let I=jR(T&&T.map(R=>Object.assign({},R,{params:Object.assign({},f,R.params),pathname:Ai([p,i.encodeLocation?i.encodeLocation(R.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?p:Ai([p,i.encodeLocation?i.encodeLocation(R.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathnameBase])})),o,r,n,a);return e&&I?re.createElement(F0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},I):I}function OR(){let t=zR(),e=SR(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=re.createElement(re.Fragment,null,re.createElement("p",null," Hey developer "),re.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",re.createElement("code",{style:i},"ErrorBoundary")," or"," ",re.createElement("code",{style:i},"errorElement")," prop on your route.")),re.createElement(re.Fragment,null,re.createElement("h2",null,"Unexpected Application Error!"),re.createElement("h3",{style:{fontStyle:"italic"}},e),r?re.createElement("pre",{style:a},r):null,o)}var FR=re.createElement(OR,null),MR=class extends re.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?re.createElement($s.Provider,{value:this.props.routeContext},re.createElement(ov.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function PR({routeContext:t,match:e,children:r}){let n=re.useContext(Au);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),re.createElement($s.Provider,{value:t},r)}function jR(t,e=[],r=null,n=null,a=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,o=r?.errors;if(o!=null){let p=i.findIndex(x=>x.route.id&&o?.[x.route.id]!==void 0);Er(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,p+1))}let u=!1,f=-1;if(r)for(let p=0;p<i.length;p++){let x=i[p];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(f=p),x.route.id){let{loaderData:y,errors:w}=r,b=x.route.loader&&!y.hasOwnProperty(x.route.id)&&(!w||w[x.route.id]===void 0);if(x.route.lazy||b){u=!0,f>=0?i=i.slice(0,f+1):i=[i[0]];break}}}let d=r&&n?(p,x)=>{n(p,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:AR(r.matches),errorInfo:x})}:void 0;return i.reduceRight((p,x,y)=>{let w,b=!1,E=null,T=null;r&&(w=o&&x.route.id?o[x.route.id]:void 0,E=x.route.errorElement||FR,u&&(f<0&&y===0?($S("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,T=null):f===y&&(b=!0,T=x.route.hydrateFallbackElement||null)));let I=e.concat(i.slice(0,y+1)),R=()=>{let C;return w?C=E:b?C=T:x.route.Component?C=re.createElement(x.route.Component,null):x.route.element?C=x.route.element:C=p,re.createElement(PR,{match:x,routeContext:{outlet:p,matches:I,isDataRoute:r!=null},children:C})};return r&&(x.route.ErrorBoundary||x.route.errorElement||y===0)?re.createElement(MR,{location:r.location,revalidation:r.revalidation,component:E,error:w,children:R(),routeContext:{outlet:null,matches:I,isDataRoute:!0},onError:d}):R()},null)}function cv(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function LR(t){let e=re.useContext(Au);return Er(e,cv(t)),e}function BR(t){let e=re.useContext(Ym);return Er(e,cv(t)),e}function VR(t){let e=re.useContext($s);return Er(e,cv(t)),e}function uv(t){let e=VR(t),r=e.matches[e.matches.length-1];return Er(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function UR(){return uv("useRouteId")}function zR(){let t=re.useContext(ov),e=BR("useRouteError"),r=uv("useRouteError");return t!==void 0?t:e.errors?.[r]}function HR(){let{router:t}=LR("useNavigate"),e=uv("useNavigate"),r=re.useRef(!1);return XS(()=>{r.current=!0}),re.useCallback(async(a,i={})=>{Ra(r.current,WS),r.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...i}))},[t,e])}var Bb={};function $S(t,e,r){!e&&!Bb[t]&&(Bb[t]=!0,Ra(!1,r))}re.memo(GR);function GR({routes:t,future:e,state:r,unstable_onError:n}){return YS(t,void 0,r,n,e)}function Cd({to:t,replace:e,state:r,relative:n}){Er(ku(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=re.useContext(ts);Ra(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=re.useContext($s),{pathname:o}=Ql(),u=M0(),f=lv(t,iv(i),o,n==="path"),d=JSON.stringify(f);return re.useEffect(()=>{u(JSON.parse(d),{replace:e,state:r,relative:n})},[u,d,n,e,r]),null}function Vf(t){Er(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function qR({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:i=!1,unstable_useTransitions:o}){Er(!ku(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),f=re.useMemo(()=>({basename:u,navigator:a,static:i,unstable_useTransitions:o,future:{}}),[u,a,i,o]);typeof r=="string"&&(r=ec(r));let{pathname:d="/",search:p="",hash:x="",state:y=null,key:w="default"}=r,b=re.useMemo(()=>{let E=Ii(d,u);return E==null?null:{location:{pathname:E,search:p,hash:x,state:y,key:w},navigationType:n}},[u,d,p,x,y,w,n]);return Ra(b!=null,`<Router basename="${u}"> is not able to match the URL "${d}${p}${x}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:re.createElement(ts.Provider,{value:f},re.createElement(F0.Provider,{children:e,value:b}))}function WR({children:t,location:e}){return DR(hx(t),e)}function hx(t,e=[]){let r=[];return re.Children.forEach(t,(n,a)=>{if(!re.isValidElement(n))return;let i=[...e,a];if(n.type===re.Fragment){r.push.apply(r,hx(n.props.children,i));return}Er(n.type===Vf,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Er(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=hx(n.props.children,i)),r.push(o)}),r}var Qd="get",Jd="application/x-www-form-urlencoded";function $m(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function XR(t){return $m(t)&&t.tagName.toLowerCase()==="button"}function YR(t){return $m(t)&&t.tagName.toLowerCase()==="form"}function $R(t){return $m(t)&&t.tagName.toLowerCase()==="input"}function KR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function QR(t,e){return t.button===0&&(!e||e==="_self")&&!KR(t)}var Nd=null;function JR(){if(Nd===null)try{new FormData(document.createElement("form"),0),Nd=!1}catch{Nd=!0}return Nd}var ZR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function D1(t){return t!=null&&!ZR.has(t)?(Ra(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Jd}"`),null):t}function e5(t,e){let r,n,a,i,o;if(YR(t)){let u=t.getAttribute("action");n=u?Ii(u,e):null,r=t.getAttribute("method")||Qd,a=D1(t.getAttribute("enctype"))||Jd,i=new FormData(t)}else if(XR(t)||$R(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||u.getAttribute("action");if(n=f?Ii(f,e):null,r=t.getAttribute("formmethod")||u.getAttribute("method")||Qd,a=D1(t.getAttribute("formenctype"))||D1(u.getAttribute("enctype"))||Jd,i=new FormData(u,t),!JR()){let{name:d,type:p,value:x}=t;if(p==="image"){let y=d?`${d}.`:"";i.append(`${y}x`,"0"),i.append(`${y}y`,"0")}else d&&i.append(d,x)}}else{if($m(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Qd,n=null,a=Jd,o=t}return i&&a==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function fv(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function t5(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&Ii(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function r5(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function n5(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function a5(t,e,r){let n=await Promise.all(t.map(async a=>{let i=e.routes[a.route.id];if(i){let o=await r5(i,r);return o.links?o.links():[]}return[]}));return o5(n.flat(1).filter(n5).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Vb(t,e,r,n,a,i){let o=(f,d)=>r[d]?f.route.id!==r[d].route.id:!0,u=(f,d)=>r[d].pathname!==f.pathname||r[d].route.path?.endsWith("*")&&r[d].params["*"]!==f.params["*"];return i==="assets"?e.filter((f,d)=>o(f,d)||u(f,d)):i==="data"?e.filter((f,d)=>{let p=n.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(o(f,d)||u(f,d))return!0;if(f.route.shouldRevalidate){let x=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function s5(t,e,{includeHydrateFallback:r}={}){return i5(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function i5(t){return[...new Set(t)]}function l5(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function o5(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let i=JSON.stringify(l5(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}function KS(){let t=re.useContext(Au);return fv(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function c5(){let t=re.useContext(Ym);return fv(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var hv=re.createContext(void 0);hv.displayName="FrameworkContext";function QS(){let t=re.useContext(hv);return fv(t,"You must render this element inside a <HydratedRouter> element"),t}function u5(t,e){let r=re.useContext(hv),[n,a]=re.useState(!1),[i,o]=re.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:d,onMouseLeave:p,onTouchStart:x}=e,y=re.useRef(null);re.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let E=I=>{I.forEach(R=>{o(R.isIntersecting)})},T=new IntersectionObserver(E,{threshold:.5});return y.current&&T.observe(y.current),()=>{T.disconnect()}}},[t]),re.useEffect(()=>{if(n){let E=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(E)}}},[n]);let w=()=>{a(!0)},b=()=>{a(!1),o(!1)};return r?t!=="intent"?[i,y,{}]:[i,y,{onFocus:jf(u,w),onBlur:jf(f,b),onMouseEnter:jf(d,w),onMouseLeave:jf(p,b),onTouchStart:jf(x,w)}]:[!1,y,{}]}function jf(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function f5({page:t,...e}){let{router:r}=KS(),n=re.useMemo(()=>US(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?re.createElement(d5,{page:t,matches:n,...e}):null}function h5(t){let{manifest:e,routeModules:r}=QS(),[n,a]=re.useState([]);return re.useEffect(()=>{let i=!1;return a5(t,e,r).then(o=>{i||a(o)}),()=>{i=!0}},[t,e,r]),n}function d5({page:t,matches:e,...r}){let n=Ql(),{manifest:a,routeModules:i}=QS(),{basename:o}=KS(),{loaderData:u,matches:f}=c5(),d=re.useMemo(()=>Vb(t,e,f,a,n,"data"),[t,e,f,a,n]),p=re.useMemo(()=>Vb(t,e,f,a,n,"assets"),[t,e,f,a,n]),x=re.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let b=new Set,E=!1;if(e.forEach(I=>{let R=a.routes[I.route.id];!R||!R.hasLoader||(!d.some(C=>C.route.id===I.route.id)&&I.route.id in u&&i[I.route.id]?.shouldRevalidate||R.hasClientLoader?E=!0:b.add(I.route.id))}),b.size===0)return[];let T=t5(t,o,"data");return E&&b.size>0&&T.searchParams.set("_routes",e.filter(I=>b.has(I.route.id)).map(I=>I.route.id).join(",")),[T.pathname+T.search]},[o,u,n,a,d,e,t,i]),y=re.useMemo(()=>s5(p,a),[p,a]),w=h5(p);return re.createElement(re.Fragment,null,x.map(b=>re.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...r})),y.map(b=>re.createElement("link",{key:b,rel:"modulepreload",href:b,...r})),w.map(({key:b,link:E})=>re.createElement("link",{key:b,nonce:r.nonce,...E})))}function m5(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var JS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{JS&&(window.__reactRouterVersion="7.10.1")}catch{}function p5({basename:t,children:e,unstable_useTransitions:r,window:n}){let a=re.useRef();a.current==null&&(a.current=tR({window:n,v5Compat:!0}));let i=a.current,[o,u]=re.useState({action:i.action,location:i.location}),f=re.useCallback(d=>{r===!1?u(d):re.startTransition(()=>u(d))},[r]);return re.useLayoutEffect(()=>i.listen(f),[i,f]),re.createElement(qR,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:r===!0})}var ZS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,du=re.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:o,state:u,target:f,to:d,preventScrollReset:p,viewTransition:x,...y},w){let{basename:b,unstable_useTransitions:E}=re.useContext(ts),T=typeof d=="string"&&ZS.test(d),I,R=!1;if(typeof d=="string"&&T&&(I=d,JS))try{let P=new URL(window.location.href),M=d.startsWith("//")?new URL(P.protocol+d):new URL(d),j=Ii(M.pathname,b);M.origin===P.origin&&j!=null?d=j+M.search+M.hash:R=!0}catch{Ra(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=RR(d,{relative:a}),[z,H,X]=u5(n,y),A=y5(d,{replace:o,state:u,target:f,preventScrollReset:p,relative:a,viewTransition:x,unstable_useTransitions:E});function F(P){e&&e(P),P.defaultPrevented||A(P)}let N=re.createElement("a",{...y,...X,href:I||C,onClick:R||i?e:F,ref:m5(w,H),target:f,"data-discover":!T&&r==="render"?"true":void 0});return z&&!T?re.createElement(re.Fragment,null,N,re.createElement(f5,{page:C})):N});du.displayName="Link";var g5=re.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:o,viewTransition:u,children:f,...d},p){let x=P0(o,{relative:d.relative}),y=Ql(),w=re.useContext(Ym),{navigator:b,basename:E}=re.useContext(ts),T=w!=null&&T5(x)&&u===!0,I=b.encodeLocation?b.encodeLocation(x).pathname:x.pathname,R=y.pathname,C=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;r||(R=R.toLowerCase(),C=C?C.toLowerCase():null,I=I.toLowerCase()),C&&E&&(C=Ii(C,E)||C);const z=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let H=R===I||!a&&R.startsWith(I)&&R.charAt(z)==="/",X=C!=null&&(C===I||!a&&C.startsWith(I)&&C.charAt(I.length)==="/"),A={isActive:H,isPending:X,isTransitioning:T},F=H?e:void 0,N;typeof n=="function"?N=n(A):N=[n,H?"active":null,X?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let P=typeof i=="function"?i(A):i;return re.createElement(du,{...d,"aria-current":F,className:N,ref:p,style:P,to:o,viewTransition:u},typeof f=="function"?f(A):f)});g5.displayName="NavLink";var x5=re.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:i,method:o=Qd,action:u,onSubmit:f,relative:d,preventScrollReset:p,viewTransition:x,...y},w)=>{let{unstable_useTransitions:b}=re.useContext(ts),E=b5(),T=E5(u,{relative:d}),I=o.toLowerCase()==="get"?"get":"post",R=typeof u=="string"&&ZS.test(u),C=z=>{if(f&&f(z),z.defaultPrevented)return;z.preventDefault();let H=z.nativeEvent.submitter,X=H?.getAttribute("formmethod")||o,A=()=>E(H||z.currentTarget,{fetcherKey:e,method:X,navigate:r,replace:a,state:i,relative:d,preventScrollReset:p,viewTransition:x});b&&r!==!1?re.startTransition(()=>A()):A()};return re.createElement("form",{ref:w,method:I,action:T,onSubmit:n?f:C,...y,"data-discover":!R&&t==="render"?"true":void 0})});x5.displayName="Form";function v5(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function e4(t){let e=re.useContext(Au);return Er(e,v5(t)),e}function y5(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:o,unstable_useTransitions:u}={}){let f=M0(),d=Ql(),p=P0(t,{relative:i});return re.useCallback(x=>{if(QR(x,e)){x.preventDefault();let y=r!==void 0?r:c0(d)===c0(p),w=()=>f(t,{replace:y,state:n,preventScrollReset:a,relative:i,viewTransition:o});u?re.startTransition(()=>w()):w()}},[d,f,p,r,n,e,t,a,i,o,u])}var _5=0,w5=()=>`__${String(++_5)}__`;function b5(){let{router:t}=e4("useSubmit"),{basename:e}=re.useContext(ts),r=UR(),n=t.fetch,a=t.navigate;return re.useCallback(async(i,o={})=>{let{action:u,method:f,encType:d,formData:p,body:x}=e5(i,e);if(o.navigate===!1){let y=o.fetcherKey||w5();await n(y,r,o.action||u,{preventScrollReset:o.preventScrollReset,formData:p,body:x,formMethod:o.method||f,formEncType:o.encType||d,flushSync:o.flushSync})}else await a(o.action||u,{preventScrollReset:o.preventScrollReset,formData:p,body:x,formMethod:o.method||f,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[n,a,e,r])}function E5(t,{relative:e}={}){let{basename:r}=re.useContext(ts),n=re.useContext($s);Er(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...P0(t||".",{relative:e})},o=Ql();if(t==null){i.search=o.search;let u=new URLSearchParams(i.search),f=u.getAll("index");if(f.some(p=>p==="")){u.delete("index"),f.filter(x=>x).forEach(x=>u.append("index",x));let p=u.toString();i.search=p?`?${p}`:""}}return(!t||t===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:Ai([r,i.pathname])),c0(i)}function T5(t,{relative:e}={}){let r=re.useContext(qS);Er(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=e4("useViewTransitionState"),a=P0(t,{relative:e});if(!r.isTransitioning)return!1;let i=Ii(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Ii(r.nextLocation.pathname,n)||r.nextLocation.pathname;return um(a.pathname,o)!=null||um(a.pathname,i)!=null}const S5=()=>{};var Ub={};const t4=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},A5=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const i=t[r++];e[n++]=String.fromCharCode((a&31)<<6|i&63)}else if(a>239&&a<365){const i=t[r++],o=t[r++],u=t[r++],f=((a&7)<<18|(i&63)<<12|(o&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(i&63)<<6|o&63)}}return e.join("")},r4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const i=t[a],o=a+1<t.length,u=o?t[a+1]:0,f=a+2<t.length,d=f?t[a+2]:0,p=i>>2,x=(i&3)<<4|u>>4;let y=(u&15)<<2|d>>6,w=d&63;f||(w=64,o||(y=64)),n.push(r[p],r[x],r[y],r[w])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(t4(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):A5(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const i=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const d=a<t.length?r[t.charAt(a)]:64;++a;const x=a<t.length?r[t.charAt(a)]:64;if(++a,i==null||u==null||d==null||x==null)throw new k5;const y=i<<2|u>>4;if(n.push(y),d!==64){const w=u<<4&240|d>>2;if(n.push(w),x!==64){const b=d<<6&192|x;n.push(b)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class k5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const C5=function(t){const e=t4(t);return r4.encodeByteArray(e,!0)},fm=function(t){return C5(t).replace(/\./g,"")},n4=function(t){try{return r4.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function N5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const R5=()=>N5().__FIREBASE_DEFAULTS__,I5=()=>{if(typeof process>"u"||typeof Ub>"u")return;const t=Ub.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},D5=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&n4(t[1]);return e&&JSON.parse(e)},Km=()=>{try{return S5()||R5()||I5()||D5()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},a4=t=>Km()?.emulatorHosts?.[t],O5=t=>{const e=a4(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},s4=()=>Km()?.config,i4=t=>Km()?.[`_${t}`];class F5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function Cu(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function l4(t){return(await fetch(t,{credentials:"include"})).ok}function M5(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[fm(JSON.stringify(r)),fm(JSON.stringify(o)),""].join(".")}const Yf={};function P5(){const t={prod:[],emulator:[]};for(const e of Object.keys(Yf))Yf[e]?t.emulator.push(e):t.prod.push(e);return t}function j5(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let zb=!1;function o4(t,e){if(typeof window>"u"||typeof document>"u"||!Cu(window.location.host)||Yf[t]===e||Yf[t]||zb)return;Yf[t]=e;function r(y){return`__firebase__banner__${y}`}const n="__firebase__banner",i=P5().prod.length>0;function o(){const y=document.getElementById(n);y&&y.remove()}function u(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function f(y,w){y.setAttribute("width","24"),y.setAttribute("id",w),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function d(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{zb=!0,o()},y}function p(y,w){y.setAttribute("id",w),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function x(){const y=j5(n),w=r("text"),b=document.getElementById(w)||document.createElement("span"),E=r("learnmore"),T=document.getElementById(E)||document.createElement("a"),I=r("preprendIcon"),R=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const C=y.element;u(C),p(T,E);const z=d();f(R,I),C.append(R,b,T,z),document.body.appendChild(C)}i?(b.innerText="Preview backend disconnected.",R.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(R.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}function Un(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function L5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Un())}function B5(){const t=Km()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function V5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function U5(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function z5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function H5(){const t=Un();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function G5(){return!B5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function q5(){try{return typeof indexedDB=="object"}catch{return!1}}function W5(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(r){e(r)}})}const X5="FirebaseError";class Li extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=X5,Object.setPrototypeOf(this,Li.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,j0.prototype.create)}}class j0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,i=this.errors[e],o=i?Y5(i,n):"Error",u=`${this.serviceName}: ${o} (${a}).`;return new Li(a,u,n)}}function Y5(t,e){return t.replace($5,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const $5=/\{\$([^}]+)}/g;function K5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ho(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const i=t[a],o=e[a];if(Hb(i)&&Hb(o)){if(!Ho(i,o))return!1}else if(i!==o)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function Hb(t){return t!==null&&typeof t=="object"}function L0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Q5(t,e){const r=new J5(t,e);return r.subscribe.bind(r)}class J5{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Z5(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=O1),a.error===void 0&&(a.error=O1),a.complete===void 0&&(a.complete=O1);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Z5(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function O1(){}function un(t){return t&&t._delegate?t._delegate:t}class Go{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Do="[DEFAULT]";class eI{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new F5;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(rI(e))try{this.getOrInitializeService({instanceIdentifier:Do})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:a});n.resolve(i)}catch{}}}}clearInstance(e=Do){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Do){return this.instances.has(e)}getOptions(e=Do){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(i);n===u&&o.resolve(a)}return a}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const i=this.instances.get(n);return i&&e(i,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:tI(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Do){return this.component?this.component.multipleInstances?e:Do:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function tI(t){return t===Do?void 0:t}function rI(t){return t.instantiationMode==="EAGER"}class nI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new eI(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var Rt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Rt||(Rt={}));const aI={debug:Rt.DEBUG,verbose:Rt.VERBOSE,info:Rt.INFO,warn:Rt.WARN,error:Rt.ERROR,silent:Rt.SILENT},sI=Rt.INFO,iI={[Rt.DEBUG]:"log",[Rt.VERBOSE]:"log",[Rt.INFO]:"info",[Rt.WARN]:"warn",[Rt.ERROR]:"error"},lI=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=iI[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dv{constructor(e){this.name=e,this._logLevel=sI,this._logHandler=lI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Rt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Rt.DEBUG,...e),this._logHandler(this,Rt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Rt.VERBOSE,...e),this._logHandler(this,Rt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Rt.INFO,...e),this._logHandler(this,Rt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Rt.WARN,...e),this._logHandler(this,Rt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Rt.ERROR,...e),this._logHandler(this,Rt.ERROR,...e)}}const oI=(t,e)=>e.some(r=>t instanceof r);let Gb,qb;function cI(){return Gb||(Gb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uI(){return qb||(qb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const c4=new WeakMap,dx=new WeakMap,u4=new WeakMap,F1=new WeakMap,mv=new WeakMap;function fI(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(Il(t.result)),a()},o=()=>{n(t.error),a()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&c4.set(r,t)}).catch(()=>{}),mv.set(e,t),e}function hI(t){if(dx.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),a()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});dx.set(t,e)}let mx={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return dx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||u4.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Il(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function dI(t){mx=t(mx)}function mI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(M1(this),e,...r);return u4.set(n,e.sort?e.sort():[e]),Il(n)}:uI().includes(t)?function(...e){return t.apply(M1(this),e),Il(c4.get(this))}:function(...e){return Il(t.apply(M1(this),e))}}function pI(t){return typeof t=="function"?mI(t):(t instanceof IDBTransaction&&hI(t),oI(t,cI())?new Proxy(t,mx):t)}function Il(t){if(t instanceof IDBRequest)return fI(t);if(F1.has(t))return F1.get(t);const e=pI(t);return e!==t&&(F1.set(t,e),mv.set(e,t)),e}const M1=t=>mv.get(t);function gI(t,e,{blocked:r,upgrade:n,blocking:a,terminated:i}={}){const o=indexedDB.open(t,e),u=Il(o);return n&&o.addEventListener("upgradeneeded",f=>{n(Il(o.result),f.oldVersion,f.newVersion,Il(o.transaction),f)}),r&&o.addEventListener("blocked",f=>r(f.oldVersion,f.newVersion,f)),u.then(f=>{i&&f.addEventListener("close",()=>i()),a&&f.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const xI=["get","getKey","getAll","getAllKeys","count"],vI=["put","add","delete","clear"],P1=new Map;function Wb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(P1.get(e))return P1.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=vI.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||xI.includes(r)))return;const i=async function(o,...u){const f=this.transaction(o,a?"readwrite":"readonly");let d=f.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),a&&f.done]))[0]};return P1.set(e,i),i}dI(t=>({...t,get:(e,r,n)=>Wb(e,r)||t.get(e,r,n),has:(e,r)=>!!Wb(e,r)||t.has(e,r)}));class yI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(_I(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function _I(t){return t.getComponent()?.type==="VERSION"}const px="@firebase/app",Xb="0.14.6";const Di=new dv("@firebase/app"),wI="@firebase/app-compat",bI="@firebase/analytics-compat",EI="@firebase/analytics",TI="@firebase/app-check-compat",SI="@firebase/app-check",AI="@firebase/auth",kI="@firebase/auth-compat",CI="@firebase/database",NI="@firebase/data-connect",RI="@firebase/database-compat",II="@firebase/functions",DI="@firebase/functions-compat",OI="@firebase/installations",FI="@firebase/installations-compat",MI="@firebase/messaging",PI="@firebase/messaging-compat",jI="@firebase/performance",LI="@firebase/performance-compat",BI="@firebase/remote-config",VI="@firebase/remote-config-compat",UI="@firebase/storage",zI="@firebase/storage-compat",HI="@firebase/firestore",GI="@firebase/ai",qI="@firebase/firestore-compat",WI="firebase",XI="12.6.0";const gx="[DEFAULT]",YI={[px]:"fire-core",[wI]:"fire-core-compat",[EI]:"fire-analytics",[bI]:"fire-analytics-compat",[SI]:"fire-app-check",[TI]:"fire-app-check-compat",[AI]:"fire-auth",[kI]:"fire-auth-compat",[CI]:"fire-rtdb",[NI]:"fire-data-connect",[RI]:"fire-rtdb-compat",[II]:"fire-fn",[DI]:"fire-fn-compat",[OI]:"fire-iid",[FI]:"fire-iid-compat",[MI]:"fire-fcm",[PI]:"fire-fcm-compat",[jI]:"fire-perf",[LI]:"fire-perf-compat",[BI]:"fire-rc",[VI]:"fire-rc-compat",[UI]:"fire-gcs",[zI]:"fire-gcs-compat",[HI]:"fire-fst",[qI]:"fire-fst-compat",[GI]:"fire-vertex","fire-js":"fire-js",[WI]:"fire-js-all"};const hm=new Map,$I=new Map,xx=new Map;function Yb(t,e){try{t.container.addComponent(e)}catch(r){Di.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function mu(t){const e=t.name;if(xx.has(e))return Di.debug(`There were multiple attempts to register component ${e}.`),!1;xx.set(e,t);for(const r of hm.values())Yb(r,t);for(const r of $I.values())Yb(r,t);return!0}function pv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function xs(t){return t==null?!1:t.settings!==void 0}const KI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Dl=new j0("app","Firebase",KI);class QI{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Go("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Dl.create("app-deleted",{appName:this._name})}}const Nu=XI;function f4(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:gx,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw Dl.create("bad-app-name",{appName:String(a)});if(r||(r=s4()),!r)throw Dl.create("no-options");const i=hm.get(a);if(i){if(Ho(r,i.options)&&Ho(n,i.config))return i;throw Dl.create("duplicate-app",{appName:a})}const o=new nI(a);for(const f of xx.values())o.addComponent(f);const u=new QI(r,n,o);return hm.set(a,u),u}function h4(t=gx){const e=hm.get(t);if(!e&&t===gx&&s4())return f4();if(!e)throw Dl.create("no-app",{appName:t});return e}function Ol(t,e,r){let n=YI[t]??t;r&&(n+=`-${r}`);const a=n.match(/\s|\//),i=e.match(/\s|\//);if(a||i){const o=[`Unable to register library "${n}" with version "${e}":`];a&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Di.warn(o.join(" "));return}mu(new Go(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const JI="firebase-heartbeat-database",ZI=1,u0="firebase-heartbeat-store";let j1=null;function d4(){return j1||(j1=gI(JI,ZI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(u0)}catch(r){console.warn(r)}}}}).catch(t=>{throw Dl.create("idb-open",{originalErrorMessage:t.message})})),j1}async function eD(t){try{const r=(await d4()).transaction(u0),n=await r.objectStore(u0).get(m4(t));return await r.done,n}catch(e){if(e instanceof Li)Di.warn(e.message);else{const r=Dl.create("idb-get",{originalErrorMessage:e?.message});Di.warn(r.message)}}}async function $b(t,e){try{const n=(await d4()).transaction(u0,"readwrite");await n.objectStore(u0).put(e,m4(t)),await n.done}catch(r){if(r instanceof Li)Di.warn(r.message);else{const n=Dl.create("idb-set",{originalErrorMessage:r?.message});Di.warn(n.message)}}}function m4(t){return`${t.name}!${t.options.appId}`}const tD=1024,rD=30;class nD{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new sD(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Kb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(a=>a.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>rD){const a=iD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Di.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Kb(),{heartbeatsToSend:r,unsentEntries:n}=aD(this._heartbeatsCache.heartbeats),a=fm(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Di.warn(e),""}}}function Kb(){return new Date().toISOString().substring(0,10)}function aD(t,e=tD){const r=[];let n=t.slice();for(const a of t){const i=r.find(o=>o.agent===a.agent);if(i){if(i.dates.push(a.date),Qb(r)>e){i.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),Qb(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class sD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return q5()?W5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await eD(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return $b(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return $b(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Qb(t){return fm(JSON.stringify({version:2,heartbeats:t})).length}function iD(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}function lD(t){mu(new Go("platform-logger",e=>new yI(e),"PRIVATE")),mu(new Go("heartbeat",e=>new nD(e),"PRIVATE")),Ol(px,Xb,t),Ol(px,Xb,"esm2020"),Ol("fire-js","")}lD("");var Jb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Fl,p4;(function(){var t;function e(A,F){function N(){}N.prototype=F.prototype,A.F=F.prototype,A.prototype=new N,A.prototype.constructor=A,A.D=function(P,M,j){for(var B=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)B[Se-2]=arguments[Se];return F.prototype[M].apply(P,B)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(A,F,N){N||(N=0);const P=Array(16);if(typeof F=="string")for(var M=0;M<16;++M)P[M]=F.charCodeAt(N++)|F.charCodeAt(N++)<<8|F.charCodeAt(N++)<<16|F.charCodeAt(N++)<<24;else for(M=0;M<16;++M)P[M]=F[N++]|F[N++]<<8|F[N++]<<16|F[N++]<<24;F=A.g[0],N=A.g[1],M=A.g[2];let j=A.g[3],B;B=F+(j^N&(M^j))+P[0]+3614090360&4294967295,F=N+(B<<7&4294967295|B>>>25),B=j+(M^F&(N^M))+P[1]+3905402710&4294967295,j=F+(B<<12&4294967295|B>>>20),B=M+(N^j&(F^N))+P[2]+606105819&4294967295,M=j+(B<<17&4294967295|B>>>15),B=N+(F^M&(j^F))+P[3]+3250441966&4294967295,N=M+(B<<22&4294967295|B>>>10),B=F+(j^N&(M^j))+P[4]+4118548399&4294967295,F=N+(B<<7&4294967295|B>>>25),B=j+(M^F&(N^M))+P[5]+1200080426&4294967295,j=F+(B<<12&4294967295|B>>>20),B=M+(N^j&(F^N))+P[6]+2821735955&4294967295,M=j+(B<<17&4294967295|B>>>15),B=N+(F^M&(j^F))+P[7]+4249261313&4294967295,N=M+(B<<22&4294967295|B>>>10),B=F+(j^N&(M^j))+P[8]+1770035416&4294967295,F=N+(B<<7&4294967295|B>>>25),B=j+(M^F&(N^M))+P[9]+2336552879&4294967295,j=F+(B<<12&4294967295|B>>>20),B=M+(N^j&(F^N))+P[10]+4294925233&4294967295,M=j+(B<<17&4294967295|B>>>15),B=N+(F^M&(j^F))+P[11]+2304563134&4294967295,N=M+(B<<22&4294967295|B>>>10),B=F+(j^N&(M^j))+P[12]+1804603682&4294967295,F=N+(B<<7&4294967295|B>>>25),B=j+(M^F&(N^M))+P[13]+4254626195&4294967295,j=F+(B<<12&4294967295|B>>>20),B=M+(N^j&(F^N))+P[14]+2792965006&4294967295,M=j+(B<<17&4294967295|B>>>15),B=N+(F^M&(j^F))+P[15]+1236535329&4294967295,N=M+(B<<22&4294967295|B>>>10),B=F+(M^j&(N^M))+P[1]+4129170786&4294967295,F=N+(B<<5&4294967295|B>>>27),B=j+(N^M&(F^N))+P[6]+3225465664&4294967295,j=F+(B<<9&4294967295|B>>>23),B=M+(F^N&(j^F))+P[11]+643717713&4294967295,M=j+(B<<14&4294967295|B>>>18),B=N+(j^F&(M^j))+P[0]+3921069994&4294967295,N=M+(B<<20&4294967295|B>>>12),B=F+(M^j&(N^M))+P[5]+3593408605&4294967295,F=N+(B<<5&4294967295|B>>>27),B=j+(N^M&(F^N))+P[10]+38016083&4294967295,j=F+(B<<9&4294967295|B>>>23),B=M+(F^N&(j^F))+P[15]+3634488961&4294967295,M=j+(B<<14&4294967295|B>>>18),B=N+(j^F&(M^j))+P[4]+3889429448&4294967295,N=M+(B<<20&4294967295|B>>>12),B=F+(M^j&(N^M))+P[9]+568446438&4294967295,F=N+(B<<5&4294967295|B>>>27),B=j+(N^M&(F^N))+P[14]+3275163606&4294967295,j=F+(B<<9&4294967295|B>>>23),B=M+(F^N&(j^F))+P[3]+4107603335&4294967295,M=j+(B<<14&4294967295|B>>>18),B=N+(j^F&(M^j))+P[8]+1163531501&4294967295,N=M+(B<<20&4294967295|B>>>12),B=F+(M^j&(N^M))+P[13]+2850285829&4294967295,F=N+(B<<5&4294967295|B>>>27),B=j+(N^M&(F^N))+P[2]+4243563512&4294967295,j=F+(B<<9&4294967295|B>>>23),B=M+(F^N&(j^F))+P[7]+1735328473&4294967295,M=j+(B<<14&4294967295|B>>>18),B=N+(j^F&(M^j))+P[12]+2368359562&4294967295,N=M+(B<<20&4294967295|B>>>12),B=F+(N^M^j)+P[5]+4294588738&4294967295,F=N+(B<<4&4294967295|B>>>28),B=j+(F^N^M)+P[8]+2272392833&4294967295,j=F+(B<<11&4294967295|B>>>21),B=M+(j^F^N)+P[11]+1839030562&4294967295,M=j+(B<<16&4294967295|B>>>16),B=N+(M^j^F)+P[14]+4259657740&4294967295,N=M+(B<<23&4294967295|B>>>9),B=F+(N^M^j)+P[1]+2763975236&4294967295,F=N+(B<<4&4294967295|B>>>28),B=j+(F^N^M)+P[4]+1272893353&4294967295,j=F+(B<<11&4294967295|B>>>21),B=M+(j^F^N)+P[7]+4139469664&4294967295,M=j+(B<<16&4294967295|B>>>16),B=N+(M^j^F)+P[10]+3200236656&4294967295,N=M+(B<<23&4294967295|B>>>9),B=F+(N^M^j)+P[13]+681279174&4294967295,F=N+(B<<4&4294967295|B>>>28),B=j+(F^N^M)+P[0]+3936430074&4294967295,j=F+(B<<11&4294967295|B>>>21),B=M+(j^F^N)+P[3]+3572445317&4294967295,M=j+(B<<16&4294967295|B>>>16),B=N+(M^j^F)+P[6]+76029189&4294967295,N=M+(B<<23&4294967295|B>>>9),B=F+(N^M^j)+P[9]+3654602809&4294967295,F=N+(B<<4&4294967295|B>>>28),B=j+(F^N^M)+P[12]+3873151461&4294967295,j=F+(B<<11&4294967295|B>>>21),B=M+(j^F^N)+P[15]+530742520&4294967295,M=j+(B<<16&4294967295|B>>>16),B=N+(M^j^F)+P[2]+3299628645&4294967295,N=M+(B<<23&4294967295|B>>>9),B=F+(M^(N|~j))+P[0]+4096336452&4294967295,F=N+(B<<6&4294967295|B>>>26),B=j+(N^(F|~M))+P[7]+1126891415&4294967295,j=F+(B<<10&4294967295|B>>>22),B=M+(F^(j|~N))+P[14]+2878612391&4294967295,M=j+(B<<15&4294967295|B>>>17),B=N+(j^(M|~F))+P[5]+4237533241&4294967295,N=M+(B<<21&4294967295|B>>>11),B=F+(M^(N|~j))+P[12]+1700485571&4294967295,F=N+(B<<6&4294967295|B>>>26),B=j+(N^(F|~M))+P[3]+2399980690&4294967295,j=F+(B<<10&4294967295|B>>>22),B=M+(F^(j|~N))+P[10]+4293915773&4294967295,M=j+(B<<15&4294967295|B>>>17),B=N+(j^(M|~F))+P[1]+2240044497&4294967295,N=M+(B<<21&4294967295|B>>>11),B=F+(M^(N|~j))+P[8]+1873313359&4294967295,F=N+(B<<6&4294967295|B>>>26),B=j+(N^(F|~M))+P[15]+4264355552&4294967295,j=F+(B<<10&4294967295|B>>>22),B=M+(F^(j|~N))+P[6]+2734768916&4294967295,M=j+(B<<15&4294967295|B>>>17),B=N+(j^(M|~F))+P[13]+1309151649&4294967295,N=M+(B<<21&4294967295|B>>>11),B=F+(M^(N|~j))+P[4]+4149444226&4294967295,F=N+(B<<6&4294967295|B>>>26),B=j+(N^(F|~M))+P[11]+3174756917&4294967295,j=F+(B<<10&4294967295|B>>>22),B=M+(F^(j|~N))+P[2]+718787259&4294967295,M=j+(B<<15&4294967295|B>>>17),B=N+(j^(M|~F))+P[9]+3951481745&4294967295,A.g[0]=A.g[0]+F&4294967295,A.g[1]=A.g[1]+(M+(B<<21&4294967295|B>>>11))&4294967295,A.g[2]=A.g[2]+M&4294967295,A.g[3]=A.g[3]+j&4294967295}n.prototype.v=function(A,F){F===void 0&&(F=A.length);const N=F-this.blockSize,P=this.C;let M=this.h,j=0;for(;j<F;){if(M==0)for(;j<=N;)a(this,A,j),j+=this.blockSize;if(typeof A=="string"){for(;j<F;)if(P[M++]=A.charCodeAt(j++),M==this.blockSize){a(this,P),M=0;break}}else for(;j<F;)if(P[M++]=A[j++],M==this.blockSize){a(this,P),M=0;break}}this.h=M,this.o+=F},n.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var F=1;F<A.length-8;++F)A[F]=0;F=this.o*8;for(var N=A.length-8;N<A.length;++N)A[N]=F&255,F/=256;for(this.v(A),A=Array(16),F=0,N=0;N<4;++N)for(let P=0;P<32;P+=8)A[F++]=this.g[N]>>>P&255;return A};function i(A,F){var N=u;return Object.prototype.hasOwnProperty.call(N,A)?N[A]:N[A]=F(A)}function o(A,F){this.h=F;const N=[];let P=!0;for(let M=A.length-1;M>=0;M--){const j=A[M]|0;P&&j==F||(N[M]=j,P=!1)}this.g=N}var u={};function f(A){return-128<=A&&A<128?i(A,function(F){return new o([F|0],F<0?-1:0)}):new o([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return x;if(A<0)return T(d(-A));const F=[];let N=1;for(let P=0;A>=N;P++)F[P]=A/N|0,N*=4294967296;return new o(F,0)}function p(A,F){if(A.length==0)throw Error("number format error: empty string");if(F=F||10,F<2||36<F)throw Error("radix out of range: "+F);if(A.charAt(0)=="-")return T(p(A.substring(1),F));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=d(Math.pow(F,8));let P=x;for(let j=0;j<A.length;j+=8){var M=Math.min(8,A.length-j);const B=parseInt(A.substring(j,j+M),F);M<8?(M=d(Math.pow(F,M)),P=P.j(M).add(d(B))):(P=P.j(N),P=P.add(d(B)))}return P}var x=f(0),y=f(1),w=f(16777216);t=o.prototype,t.m=function(){if(E(this))return-T(this).m();let A=0,F=1;for(let N=0;N<this.g.length;N++){const P=this.i(N);A+=(P>=0?P:4294967296+P)*F,F*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(b(this))return"0";if(E(this))return"-"+T(this).toString(A);const F=d(Math.pow(A,6));var N=this;let P="";for(;;){const M=z(N,F).g;N=I(N,M.j(F));let j=((N.g.length>0?N.g[0]:N.h)>>>0).toString(A);if(N=M,b(N))return j+P;for(;j.length<6;)j="0"+j;P=j+P}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function b(A){if(A.h!=0)return!1;for(let F=0;F<A.g.length;F++)if(A.g[F]!=0)return!1;return!0}function E(A){return A.h==-1}t.l=function(A){return A=I(this,A),E(A)?-1:b(A)?0:1};function T(A){const F=A.g.length,N=[];for(let P=0;P<F;P++)N[P]=~A.g[P];return new o(N,~A.h).add(y)}t.abs=function(){return E(this)?T(this):this},t.add=function(A){const F=Math.max(this.g.length,A.g.length),N=[];let P=0;for(let M=0;M<=F;M++){let j=P+(this.i(M)&65535)+(A.i(M)&65535),B=(j>>>16)+(this.i(M)>>>16)+(A.i(M)>>>16);P=B>>>16,j&=65535,B&=65535,N[M]=B<<16|j}return new o(N,N[N.length-1]&-2147483648?-1:0)};function I(A,F){return A.add(T(F))}t.j=function(A){if(b(this)||b(A))return x;if(E(this))return E(A)?T(this).j(T(A)):T(T(this).j(A));if(E(A))return T(this.j(T(A)));if(this.l(w)<0&&A.l(w)<0)return d(this.m()*A.m());const F=this.g.length+A.g.length,N=[];for(var P=0;P<2*F;P++)N[P]=0;for(P=0;P<this.g.length;P++)for(let M=0;M<A.g.length;M++){const j=this.i(P)>>>16,B=this.i(P)&65535,Se=A.i(M)>>>16,we=A.i(M)&65535;N[2*P+2*M]+=B*we,R(N,2*P+2*M),N[2*P+2*M+1]+=j*we,R(N,2*P+2*M+1),N[2*P+2*M+1]+=B*Se,R(N,2*P+2*M+1),N[2*P+2*M+2]+=j*Se,R(N,2*P+2*M+2)}for(A=0;A<F;A++)N[A]=N[2*A+1]<<16|N[2*A];for(A=F;A<2*F;A++)N[A]=0;return new o(N,0)};function R(A,F){for(;(A[F]&65535)!=A[F];)A[F+1]+=A[F]>>>16,A[F]&=65535,F++}function C(A,F){this.g=A,this.h=F}function z(A,F){if(b(F))throw Error("division by zero");if(b(A))return new C(x,x);if(E(A))return F=z(T(A),F),new C(T(F.g),T(F.h));if(E(F))return F=z(A,T(F)),new C(T(F.g),F.h);if(A.g.length>30){if(E(A)||E(F))throw Error("slowDivide_ only works with positive integers.");for(var N=y,P=F;P.l(A)<=0;)N=H(N),P=H(P);var M=X(N,1),j=X(P,1);for(P=X(P,2),N=X(N,2);!b(P);){var B=j.add(P);B.l(A)<=0&&(M=M.add(N),j=B),P=X(P,1),N=X(N,1)}return F=I(A,M.j(F)),new C(M,F)}for(M=x;A.l(F)>=0;){for(N=Math.max(1,Math.floor(A.m()/F.m())),P=Math.ceil(Math.log(N)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),j=d(N),B=j.j(F);E(B)||B.l(A)>0;)N-=P,j=d(N),B=j.j(F);b(j)&&(j=y),M=M.add(j),A=I(A,B)}return new C(M,A)}t.B=function(A){return z(this,A).h},t.and=function(A){const F=Math.max(this.g.length,A.g.length),N=[];for(let P=0;P<F;P++)N[P]=this.i(P)&A.i(P);return new o(N,this.h&A.h)},t.or=function(A){const F=Math.max(this.g.length,A.g.length),N=[];for(let P=0;P<F;P++)N[P]=this.i(P)|A.i(P);return new o(N,this.h|A.h)},t.xor=function(A){const F=Math.max(this.g.length,A.g.length),N=[];for(let P=0;P<F;P++)N[P]=this.i(P)^A.i(P);return new o(N,this.h^A.h)};function H(A){const F=A.g.length+1,N=[];for(let P=0;P<F;P++)N[P]=A.i(P)<<1|A.i(P-1)>>>31;return new o(N,A.h)}function X(A,F){const N=F>>5;F%=32;const P=A.g.length-N,M=[];for(let j=0;j<P;j++)M[j]=F>0?A.i(j+N)>>>F|A.i(j+N+1)<<32-F:A.i(j+N);return new o(M,A.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,p4=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=p,Fl=o}).apply(typeof Jb<"u"?Jb:typeof self<"u"?self:typeof window<"u"?window:{});var Rd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var g4,Uf,x4,Zd,vx,v4,y4,_4;(function(){var t,e=Object.defineProperty;function r(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Rd=="object"&&Rd];for(var S=0;S<g.length;++S){var D=g[S];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var n=r(this);function a(g,S){if(S)e:{var D=n;g=g.split(".");for(var W=0;W<g.length-1;W++){var fe=g[W];if(!(fe in D))break e;D=D[fe]}g=g[g.length-1],W=D[g],S=S(W),S!=W&&S!=null&&e(D,g,{configurable:!0,writable:!0,value:S})}}a("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(g){return g||function(S){var D=[],W;for(W in S)Object.prototype.hasOwnProperty.call(S,W)&&D.push([W,S[W]]);return D}});var i=i||{},o=this||self;function u(g){var S=typeof g;return S=="object"&&g!=null||S=="function"}function f(g,S,D){return g.call.apply(g.bind,arguments)}function d(g,S,D){return d=f,d.apply(null,arguments)}function p(g,S){var D=Array.prototype.slice.call(arguments,1);return function(){var W=D.slice();return W.push.apply(W,arguments),g.apply(this,W)}}function x(g,S){function D(){}D.prototype=S.prototype,g.Z=S.prototype,g.prototype=new D,g.prototype.constructor=g,g.Ob=function(W,fe,be){for(var He=Array(arguments.length-2),xt=2;xt<arguments.length;xt++)He[xt-2]=arguments[xt];return S.prototype[fe].apply(W,He)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function w(g){const S=g.length;if(S>0){const D=Array(S);for(let W=0;W<S;W++)D[W]=g[W];return D}return[]}function b(g,S){for(let W=1;W<arguments.length;W++){const fe=arguments[W];var D=typeof fe;if(D=D!="object"?D:fe?Array.isArray(fe)?"array":D:"null",D=="array"||D=="object"&&typeof fe.length=="number"){D=g.length||0;const be=fe.length||0;g.length=D+be;for(let He=0;He<be;He++)g[D+He]=fe[He]}else g.push(fe)}}class E{constructor(S,D){this.i=S,this.j=D,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function T(g){o.setTimeout(()=>{throw g},0)}function I(){var g=A;let S=null;return g.g&&(S=g.g,g.g=g.g.next,g.g||(g.h=null),S.next=null),S}class R{constructor(){this.h=this.g=null}add(S,D){const W=C.get();W.set(S,D),this.h?this.h.next=W:this.g=W,this.h=W}}var C=new E(()=>new z,g=>g.reset());class z{constructor(){this.next=this.g=this.h=null}set(S,D){this.h=S,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let H,X=!1,A=new R,F=()=>{const g=Promise.resolve(void 0);H=()=>{g.then(N)}};function N(){for(var g;g=I();){try{g.h.call(g.g)}catch(D){T(D)}var S=C;S.j(g),S.h<100&&(S.h++,g.next=S.g,S.g=g)}X=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function M(g,S){this.type=g,this.g=this.target=S,this.defaultPrevented=!1}M.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,S=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const D=()=>{};o.addEventListener("test",D,S),o.removeEventListener("test",D,S)}catch{}return g})();function B(g){return/^[\s\xa0]*$/.test(g)}function Se(g,S){M.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,S)}x(Se,M),Se.prototype.init=function(g,S){const D=this.type=g.type,W=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=S,S=g.relatedTarget,S||(D=="mouseover"?S=g.fromElement:D=="mouseout"&&(S=g.toElement)),this.relatedTarget=S,W?(this.clientX=W.clientX!==void 0?W.clientX:W.pageX,this.clientY=W.clientY!==void 0?W.clientY:W.pageY,this.screenX=W.screenX||0,this.screenY=W.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&Se.Z.h.call(this)},Se.prototype.h=function(){Se.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var we="closure_listenable_"+(Math.random()*1e6|0),se=0;function oe(g,S,D,W,fe){this.listener=g,this.proxy=null,this.src=S,this.type=D,this.capture=!!W,this.ha=fe,this.key=++se,this.da=this.fa=!1}function le(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function ne(g,S,D){for(const W in g)S.call(D,g[W],W,g)}function ye(g,S){for(const D in g)S.call(void 0,g[D],D,g)}function Q(g){const S={};for(const D in g)S[D]=g[D];return S}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Y(g,S){let D,W;for(let fe=1;fe<arguments.length;fe++){W=arguments[fe];for(D in W)g[D]=W[D];for(let be=0;be<O.length;be++)D=O[be],Object.prototype.hasOwnProperty.call(W,D)&&(g[D]=W[D])}}function q(g){this.src=g,this.g={},this.h=0}q.prototype.add=function(g,S,D,W,fe){const be=g.toString();g=this.g[be],g||(g=this.g[be]=[],this.h++);const He=ce(g,S,W,fe);return He>-1?(S=g[He],D||(S.fa=!1)):(S=new oe(S,this.src,be,!!W,fe),S.fa=D,g.push(S)),S};function te(g,S){const D=S.type;if(D in g.g){var W=g.g[D],fe=Array.prototype.indexOf.call(W,S,void 0),be;(be=fe>=0)&&Array.prototype.splice.call(W,fe,1),be&&(le(S),g.g[D].length==0&&(delete g.g[D],g.h--))}}function ce(g,S,D,W){for(let fe=0;fe<g.length;++fe){const be=g[fe];if(!be.da&&be.listener==S&&be.capture==!!D&&be.ha==W)return fe}return-1}var Te="closure_lm_"+(Math.random()*1e6|0),Re={};function _e(g,S,D,W,fe){if(Array.isArray(S)){for(let be=0;be<S.length;be++)_e(g,S[be],D,W,fe);return null}return D=ht(D),g&&g[we]?g.J(S,D,u(W)?!!W.capture:!1,fe):ke(g,S,D,!1,W,fe)}function ke(g,S,D,W,fe,be){if(!S)throw Error("Invalid event type");const He=u(fe)?!!fe.capture:!!fe;let xt=We(g);if(xt||(g[Te]=xt=new q(g)),D=xt.add(S,D,W,He,be),D.proxy)return D;if(W=rt(),D.proxy=W,W.src=g,W.listener=D,g.addEventListener)j||(fe=He),fe===void 0&&(fe=!1),g.addEventListener(S.toString(),W,fe);else if(g.attachEvent)g.attachEvent(Pe(S.toString()),W);else if(g.addListener&&g.removeListener)g.addListener(W);else throw Error("addEventListener and attachEvent are unavailable.");return D}function rt(){function g(D){return S.call(g.src,g.listener,D)}const S=et;return g}function L(g,S,D,W,fe){if(Array.isArray(S))for(var be=0;be<S.length;be++)L(g,S[be],D,W,fe);else W=u(W)?!!W.capture:!!W,D=ht(D),g&&g[we]?(g=g.i,be=String(S).toString(),be in g.g&&(S=g.g[be],D=ce(S,D,W,fe),D>-1&&(le(S[D]),Array.prototype.splice.call(S,D,1),S.length==0&&(delete g.g[be],g.h--)))):g&&(g=We(g))&&(S=g.g[S.toString()],g=-1,S&&(g=ce(S,D,W,fe)),(D=g>-1?S[g]:null)&&Xe(D))}function Xe(g){if(typeof g!="number"&&g&&!g.da){var S=g.src;if(S&&S[we])te(S.i,g);else{var D=g.type,W=g.proxy;S.removeEventListener?S.removeEventListener(D,W,g.capture):S.detachEvent?S.detachEvent(Pe(D),W):S.addListener&&S.removeListener&&S.removeListener(W),(D=We(S))?(te(D,g),D.h==0&&(D.src=null,S[Te]=null)):le(g)}}}function Pe(g){return g in Re?Re[g]:Re[g]="on"+g}function et(g,S){if(g.da)g=!0;else{S=new Se(S,this);const D=g.listener,W=g.ha||g.src;g.fa&&Xe(g),g=D.call(W,S)}return g}function We(g){return g=g[Te],g instanceof q?g:null}var je="__closure_events_fn_"+(Math.random()*1e9>>>0);function ht(g){return typeof g=="function"?g:(g[je]||(g[je]=function(S){return g.handleEvent(S)}),g[je])}function wt(){P.call(this),this.i=new q(this),this.M=this,this.G=null}x(wt,P),wt.prototype[we]=!0,wt.prototype.removeEventListener=function(g,S,D,W){L(this,g,S,D,W)};function Ft(g,S){var D,W=g.G;if(W)for(D=[];W;W=W.G)D.push(W);if(g=g.M,W=S.type||S,typeof S=="string")S=new M(S,g);else if(S instanceof M)S.target=S.target||g;else{var fe=S;S=new M(W,g),Y(S,fe)}fe=!0;let be,He;if(D)for(He=D.length-1;He>=0;He--)be=S.g=D[He],fe=Hr(be,W,!0,S)&&fe;if(be=S.g=g,fe=Hr(be,W,!0,S)&&fe,fe=Hr(be,W,!1,S)&&fe,D)for(He=0;He<D.length;He++)be=S.g=D[He],fe=Hr(be,W,!1,S)&&fe}wt.prototype.N=function(){if(wt.Z.N.call(this),this.i){var g=this.i;for(const S in g.g){const D=g.g[S];for(let W=0;W<D.length;W++)le(D[W]);delete g.g[S],g.h--}}this.G=null},wt.prototype.J=function(g,S,D,W){return this.i.add(String(g),S,!1,D,W)},wt.prototype.K=function(g,S,D,W){return this.i.add(String(g),S,!0,D,W)};function Hr(g,S,D,W){if(S=g.i.g[String(S)],!S)return!0;S=S.concat();let fe=!0;for(let be=0;be<S.length;++be){const He=S[be];if(He&&!He.da&&He.capture==D){const xt=He.listener,Mr=He.ha||He.src;He.fa&&te(g.i,He),fe=xt.call(Mr,W)!==!1&&fe}}return fe&&!W.defaultPrevented}function ns(g,S){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=d(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:o.setTimeout(g,S||0)}function Gn(g){g.g=ns(()=>{g.g=null,g.i&&(g.i=!1,Gn(g))},g.l);const S=g.h;g.h=null,g.m.apply(null,S)}class zt extends P{constructor(S,D){super(),this.m=S,this.l=D,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:Gn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gr(g){P.call(this),this.h=g,this.g={}}x(Gr,P);var an=[];function qn(g){ne(g.g,function(S,D){this.g.hasOwnProperty(D)&&Xe(S)},g),g.g={}}Gr.prototype.N=function(){Gr.Z.N.call(this),qn(this)},Gr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xt=o.JSON.stringify,Fr=o.JSON.parse,dt=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function rr(){}function sn(){}var Mt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function or(){M.call(this,"d")}x(or,M);function qr(){M.call(this,"c")}x(qr,M);var dr={},cc=null;function Js(){return cc=cc||new wt}dr.Ia="serverreachability";function so(g){M.call(this,dr.Ia,g)}x(so,M);function ma(g){const S=Js();Ft(S,new so(S))}dr.STAT_EVENT="statevent";function Zs(g,S){M.call(this,dr.STAT_EVENT,g),this.stat=S}x(Zs,M);function kr(g){const S=Js();Ft(S,new Zs(S,g))}dr.Ja="timingevent";function Wn(g,S){M.call(this,dr.Ja,g),this.size=S}x(Wn,M);function Da(g,S){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},S)}function pa(){this.g=!0}pa.prototype.ua=function(){this.g=!1};function Vu(g,S,D,W,fe,be){g.info(function(){if(g.g)if(be){var He="",xt=be.split("&");for(let Ht=0;Ht<xt.length;Ht++){var Mr=xt[Ht].split("=");if(Mr.length>1){const _r=Mr[0];Mr=Mr[1];const Pa=_r.split("_");He=Pa.length>=2&&Pa[1]=="type"?He+(_r+"="+Mr+"&"):He+(_r+"=redacted&")}}}else He=null;else He=be;return"XMLHTTP REQ ("+W+") [attempt "+fe+"]: "+S+`
`+D+`
`+He})}function uc(g,S,D,W,fe,be,He){g.info(function(){return"XMLHTTP RESP ("+W+") [ attempt "+fe+"]: "+S+`
`+D+`
`+be+" "+He})}function Oa(g,S,D,W){g.info(function(){return"XMLHTTP TEXT ("+S+"): "+Uu(g,D)+(W?" "+W:"")})}function ei(g,S){g.info(function(){return"TIMEOUT: "+S})}pa.prototype.info=function(){};function Uu(g,S){if(!g.g)return S;if(!S)return null;try{const be=JSON.parse(S);if(be){for(g=0;g<be.length;g++)if(Array.isArray(be[g])){var D=be[g];if(!(D.length<2)){var W=D[1];if(Array.isArray(W)&&!(W.length<1)){var fe=W[0];if(fe!="noop"&&fe!="stop"&&fe!="close")for(let He=1;He<W.length;He++)W[He]=""}}}}return Xt(be)}catch{return S}}var ti={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ri={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},io;function ni(){}x(ni,rr),ni.prototype.g=function(){return new XMLHttpRequest},io=new ni;function as(g){return encodeURIComponent(String(g))}function V(g){var S=1;g=g.split(":");const D=[];for(;S>0&&g.length;)D.push(g.shift()),S--;return g.length&&D.push(g.join(":")),D}function Z(g,S,D,W){this.j=g,this.i=S,this.l=D,this.S=W||1,this.V=new Gr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new G}function G(){this.i=null,this.g="",this.h=!1}var K={},J={};function ee(g,S,D){g.M=1,g.A=lo(Wr(S)),g.u=D,g.R=!0,de(g,null)}function de(g,S){g.F=Date.now(),ge(g),g.B=Wr(g.A);var D=g.B,W=g.S;Array.isArray(W)||(W=[String(W)]),hc(D.i,"t",W),g.C=0,D=g.j.L,g.h=new G,g.g=wh(g.j,D?S:null,!g.u),g.P>0&&(g.O=new zt(d(g.Y,g,g.g),g.P)),S=g.V,D=g.g,W=g.ba;var fe="readystatechange";Array.isArray(fe)||(fe&&(an[0]=fe.toString()),fe=an);for(let be=0;be<fe.length;be++){const He=_e(D,fe[be],W||S.handleEvent,!1,S.h||S);if(!He)break;S.g[He.key]=He}S=g.J?Q(g.J):{},g.u?(g.v||(g.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,S)):(g.v="GET",g.g.ea(g.B,g.v,null,S)),ma(),Vu(g.i,g.v,g.B,g.l,g.S,g.u)}Z.prototype.ba=function(g){g=g.target;const S=this.O;S&&cs(g)==3?S.j():this.Y(g)},Z.prototype.Y=function(g){try{if(g==this.g)e:{const xt=cs(this.g),Mr=this.g.ya(),Ht=this.g.ca();if(!(xt<3)&&(xt!=3||this.g&&(this.h.h||this.g.la()||vn(this.g)))){this.K||xt!=4||Mr==7||(Mr==8||Ht<=0?ma(3):ma(2)),Ve(this);var S=this.g.ca();this.X=S;var D=Ce(this);if(this.o=S==200,uc(this.i,this.v,this.B,this.l,this.S,xt,S),this.o){if(this.U&&!this.L){t:{if(this.g){var W,fe=this.g;if((W=fe.g?fe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(W)){var be=W;break t}}be=null}if(g=be)Oa(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ge(this,g);else{this.o=!1,this.m=3,kr(12),Le(this),qe(this);break e}}if(this.R){g=!0;let _r;for(;!this.K&&this.C<D.length;)if(_r=xe(this,D),_r==J){xt==4&&(this.m=4,kr(14),g=!1),Oa(this.i,this.l,null,"[Incomplete Response]");break}else if(_r==K){this.m=4,kr(15),Oa(this.i,this.l,D,"[Invalid Chunk]"),g=!1;break}else Oa(this.i,this.l,_r,null),Ge(this,_r);if(me(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xt!=4||D.length!=0||this.h.h||(this.m=1,kr(16),g=!1),this.o=this.o&&g,!g)Oa(this.i,this.l,D,"[Invalid Chunked Response]"),Le(this),qe(this);else if(D.length>0&&!this.W){this.W=!0;var He=this.j;He.g==this&&He.aa&&!He.P&&(He.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),Qu(He),He.P=!0,kr(11))}}else Oa(this.i,this.l,D,null),Ge(this,D);xt==4&&Le(this),this.o&&!this.K&&(xt==4?xh(this.j,this):(this.o=!1,ge(this)))}else si(this.g),S==400&&D.indexOf("Unknown SID")>0?(this.m=3,kr(12)):(this.m=0,kr(13)),Le(this),qe(this)}}}catch{}finally{}};function Ce(g){if(!me(g))return g.g.la();const S=vn(g.g);if(S==="")return"";let D="";const W=S.length,fe=cs(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return Le(g),qe(g),"";g.h.i=new o.TextDecoder}for(let be=0;be<W;be++)g.h.h=!0,D+=g.h.i.decode(S[be],{stream:!(fe&&be==W-1)});return S.length=0,g.h.g+=D,g.C=0,g.h.g}function me(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function xe(g,S){var D=g.C,W=S.indexOf(`
`,D);return W==-1?J:(D=Number(S.substring(D,W)),isNaN(D)?K:(W+=1,W+D>S.length?J:(S=S.slice(W,W+D),g.C=W+D,S)))}Z.prototype.cancel=function(){this.K=!0,Le(this)};function ge(g){g.T=Date.now()+g.H,Be(g,g.H)}function Be(g,S){if(g.D!=null)throw Error("WatchDog timer not null");g.D=Da(d(g.aa,g),S)}function Ve(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Z.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(ei(this.i,this.B),this.M!=2&&(ma(),kr(17)),Le(this),this.m=2,qe(this)):Be(this,this.T-g)};function qe(g){g.j.I==0||g.K||xh(g.j,g)}function Le(g){Ve(g);var S=g.O;S&&typeof S.dispose=="function"&&S.dispose(),g.O=null,qn(g.V),g.g&&(S=g.g,g.g=null,S.abort(),S.dispose())}function Ge(g,S){try{var D=g.j;if(D.I!=0&&(D.g==g||Nn(D.h,g))){if(!g.L&&Nn(D.h,g)&&D.I==3){try{var W=D.Ba.g.parse(S)}catch{W=null}if(Array.isArray(W)&&W.length==3){var fe=W;if(fe[0]==0){e:if(!D.v){if(D.g)if(D.g.F+3e3<g.F)xc(D),Ki(D);else break e;po(D),kr(18)}}else D.xa=fe[1],0<D.xa-D.K&&fe[2]<37500&&D.F&&D.A==0&&!D.C&&(D.C=Da(d(D.Va,D),6e3));cr(D.h)<=1&&D.ta&&(D.ta=void 0)}else Ns(D,11)}else if((g.L||D.g==g)&&xc(D),!B(S))for(fe=D.Ba.g.parse(S),S=0;S<fe.length;S++){let Ht=fe[S];const _r=Ht[0];if(!(_r<=D.K))if(D.K=_r,Ht=Ht[1],D.I==2)if(Ht[0]=="c"){D.M=Ht[1],D.ba=Ht[2];const Pa=Ht[3];Pa!=null&&(D.ka=Pa,D.j.info("VER="+D.ka));const Rs=Ht[4];Rs!=null&&(D.za=Rs,D.j.info("SVER="+D.za));const us=Ht[5];us!=null&&typeof us=="number"&&us>0&&(W=1.5*us,D.O=W,D.j.info("backChannelRequestTimeoutMs_="+W)),W=D;const fs=g.g;if(fs){const go=fs.g?fs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(go){var be=W.h;be.g||go.indexOf("spdy")==-1&&go.indexOf("quic")==-1&&go.indexOf("h2")==-1||(be.j=be.l,be.g=new Set,be.h&&(ss(be,be.h),be.h=null))}if(W.G){const vc=fs.g?fs.g.getResponseHeader("X-HTTP-Session-Id"):null;vc&&(W.wa=vc,Kt(W.J,W.G,vc))}}D.I=3,D.l&&D.l.ra(),D.aa&&(D.T=Date.now()-g.F,D.j.info("Handshake RTT: "+D.T+"ms")),W=D;var He=g;if(W.na=_h(W,W.L?W.ba:null,W.W),He.L){is(W.h,He);var xt=He,Mr=W.O;Mr&&(xt.H=Mr),xt.D&&(Ve(xt),ge(xt)),W.g=He}else ph(W);D.i.length>0&&Cs(D)}else Ht[0]!="stop"&&Ht[0]!="close"||Ns(D,7);else D.I==3&&(Ht[0]=="stop"||Ht[0]=="close"?Ht[0]=="stop"?Ns(D,7):$u(D):Ht[0]!="noop"&&D.l&&D.l.qa(Ht),D.A=0)}}ma(4)}catch{}}var Ze=class{constructor(g,S){this.g=g,this.map=S}};function Yt(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function $t(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function cr(g){return g.h?1:g.g?g.g.size:0}function Nn(g,S){return g.h?g.h==S:g.g?g.g.has(S):!1}function ss(g,S){g.g?g.g.add(S):g.h=S}function is(g,S){g.h&&g.h==S?g.h=null:g.g&&g.g.has(S)&&g.g.delete(S)}Yt.prototype.cancel=function(){if(this.i=ga(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function ga(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let S=g.i;for(const D of g.g.values())S=S.concat(D.G);return S}return w(g.i)}var zi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Rn(g,S){if(g){g=g.split("&");for(let D=0;D<g.length;D++){const W=g[D].indexOf("=");let fe,be=null;W>=0?(fe=g[D].substring(0,W),be=g[D].substring(W+1)):fe=g[D],S(fe,be?decodeURIComponent(be.replace(/\+/g," ")):"")}}}function xa(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;g instanceof xa?(this.l=g.l,hn(this,g.j),this.o=g.o,this.g=g.g,Hi(this,g.u),this.h=g.h,zu(this,dh(g.i)),this.m=g.m):g&&(S=String(g).match(zi))?(this.l=!1,hn(this,S[1]||"",!0),this.o=Ts(S[2]||""),this.g=Ts(S[3]||"",!0),Hi(this,S[4]),this.h=Ts(S[5]||"",!0),zu(this,S[6]||"",!0),this.m=Ts(S[7]||"")):(this.l=!1,this.i=new qi(null,this.l))}xa.prototype.toString=function(){const g=[];var S=this.j;S&&g.push(oo(S,fc,!0),":");var D=this.g;return(D||S=="file")&&(g.push("//"),(S=this.o)&&g.push(oo(S,fc,!0),"@"),g.push(as(D).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.u,D!=null&&g.push(":",String(D))),(D=this.h)&&(this.g&&D.charAt(0)!="/"&&g.push("/"),g.push(oo(D,D.charAt(0)=="/"?Hu:uh,!0))),(D=this.i.toString())&&g.push("?",D),(D=this.m)&&g.push("#",oo(D,fh)),g.join("")},xa.prototype.resolve=function(g){const S=Wr(this);let D=!!g.j;D?hn(S,g.j):D=!!g.o,D?S.o=g.o:D=!!g.g,D?S.g=g.g:D=g.u!=null;var W=g.h;if(D)Hi(S,g.u);else if(D=!!g.h){if(W.charAt(0)!="/")if(this.g&&!this.h)W="/"+W;else{var fe=S.h.lastIndexOf("/");fe!=-1&&(W=S.h.slice(0,fe+1)+W)}if(fe=W,fe==".."||fe==".")W="";else if(fe.indexOf("./")!=-1||fe.indexOf("/.")!=-1){W=fe.lastIndexOf("/",0)==0,fe=fe.split("/");const be=[];for(let He=0;He<fe.length;){const xt=fe[He++];xt=="."?W&&He==fe.length&&be.push(""):xt==".."?((be.length>1||be.length==1&&be[0]!="")&&be.pop(),W&&He==fe.length&&be.push("")):(be.push(xt),W=!0)}W=be.join("/")}else W=fe}return D?S.h=W:D=g.i.toString()!=="",D?zu(S,dh(g.i)):D=!!g.m,D&&(S.m=g.m),S};function Wr(g){return new xa(g)}function hn(g,S,D){g.j=D?Ts(S,!0):S,g.j&&(g.j=g.j.replace(/:$/,""))}function Hi(g,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);g.u=S}else g.u=null}function zu(g,S,D){S instanceof qi?(g.i=S,dc(g.i,g.l)):(D||(S=oo(S,Gi)),g.i=new qi(S,g.l))}function Kt(g,S,D){g.i.set(S,D)}function lo(g){return Kt(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function Ts(g,S){return g?S?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function oo(g,S,D){return typeof g=="string"?(g=encodeURI(g).replace(S,ea),D&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function ea(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var fc=/[#\/\?@]/g,uh=/[#\?:]/g,Hu=/[#\?]/g,Gi=/[#\?@]/g,fh=/#/g;function qi(g,S){this.h=this.g=null,this.i=g||null,this.j=!!S}function ta(g){g.g||(g.g=new Map,g.h=0,g.i&&Rn(g.i,function(S,D){g.add(decodeURIComponent(S.replace(/\+/g," ")),D)}))}t=qi.prototype,t.add=function(g,S){ta(this),this.i=null,g=Wi(this,g);let D=this.g.get(g);return D||this.g.set(g,D=[]),D.push(S),this.h+=1,this};function hh(g,S){ta(g),S=Wi(g,S),g.g.has(S)&&(g.i=null,g.h-=g.g.get(S).length,g.g.delete(S))}function Gu(g,S){return ta(g),S=Wi(g,S),g.g.has(S)}t.forEach=function(g,S){ta(this),this.g.forEach(function(D,W){D.forEach(function(fe){g.call(S,fe,W,this)},this)},this)};function qu(g,S){ta(g);let D=[];if(typeof S=="string")Gu(g,S)&&(D=D.concat(g.g.get(Wi(g,S))));else for(g=Array.from(g.g.values()),S=0;S<g.length;S++)D=D.concat(g[S]);return D}t.set=function(g,S){return ta(this),this.i=null,g=Wi(this,g),Gu(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[S]),this.h+=1,this},t.get=function(g,S){return g?(g=qu(this,g),g.length>0?String(g[0]):S):S};function hc(g,S,D){hh(g,S),D.length>0&&(g.i=null,g.g.set(Wi(g,S),w(D)),g.h+=D.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],S=Array.from(this.g.keys());for(let W=0;W<S.length;W++){var D=S[W];const fe=as(D);D=qu(this,D);for(let be=0;be<D.length;be++){let He=fe;D[be]!==""&&(He+="="+as(D[be])),g.push(He)}}return this.i=g.join("&")};function dh(g){const S=new qi;return S.i=g.i,g.g&&(S.g=new Map(g.g),S.h=g.h),S}function Wi(g,S){return S=String(S),g.j&&(S=S.toLowerCase()),S}function dc(g,S){S&&!g.j&&(ta(g),g.i=null,g.g.forEach(function(D,W){const fe=W.toLowerCase();W!=fe&&(hh(this,W),hc(this,fe,D))},g)),g.j=S}function ls(g,S){const D=new pa;if(o.Image){const W=new Image;W.onload=p(Fa,D,"TestLoadImage: loaded",!0,S,W),W.onerror=p(Fa,D,"TestLoadImage: error",!1,S,W),W.onabort=p(Fa,D,"TestLoadImage: abort",!1,S,W),W.ontimeout=p(Fa,D,"TestLoadImage: timeout",!1,S,W),o.setTimeout(function(){W.ontimeout&&W.ontimeout()},1e4),W.src=g}else S(!1)}function Wu(g,S){const D=new pa,W=new AbortController,fe=setTimeout(()=>{W.abort(),Fa(D,"TestPingServer: timeout",!1,S)},1e4);fetch(g,{signal:W.signal}).then(be=>{clearTimeout(fe),be.ok?Fa(D,"TestPingServer: ok",!0,S):Fa(D,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(fe),Fa(D,"TestPingServer: error",!1,S)})}function Fa(g,S,D,W,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),W(D)}catch{}}function Xi(){this.g=new dt}function Ss(g){this.i=g.Sb||null,this.h=g.ab||!1}x(Ss,rr),Ss.prototype.g=function(){return new co(this.i,this.h)};function co(g,S){wt.call(this),this.H=g,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(co,wt),t=co.prototype,t.open=function(g,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=S,this.readyState=1,os(this)},t.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(S.body=g),(this.H||o).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Yi(this)),this.readyState=0},t.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,os(this)),this.g&&(this.readyState=3,os(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;mc(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function mc(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}t.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var S=g.value?g.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!g.done}))&&(this.response=this.responseText+=S)}g.done?Yi(this):os(this),this.readyState==3&&mc(this)}},t.Oa=function(g){this.g&&(this.response=this.responseText=g,Yi(this))},t.Na=function(g){this.g&&(this.response=g,Yi(this))},t.ga=function(){this.g&&Yi(this)};function Yi(g){g.readyState=4,g.l=null,g.j=null,g.B=null,os(g)}t.setRequestHeader=function(g,S){this.A.append(g,S)},t.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],S=this.h.entries();for(var D=S.next();!D.done;)D=D.value,g.push(D[0]+": "+D[1]),D=S.next();return g.join(`\r
`)};function os(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(co.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Ma(g){let S="";return ne(g,function(D,W){S+=W,S+=":",S+=D,S+=`\r
`}),S}function uo(g,S,D){e:{for(W in D){var W=!1;break e}W=!0}W||(D=Ma(D),typeof g=="string"?D!=null&&as(D):Kt(g,S,D))}function nr(g){wt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(nr,wt);var As=/^https?$/i,Xu=["POST","PUT"];t=nr.prototype,t.Fa=function(g){this.H=g},t.ea=function(g,S,D,W){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);S=S?S.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():io.g(),this.g.onreadystatechange=y(d(this.Ca,this));try{this.B=!0,this.g.open(S,String(g),!0),this.B=!1}catch(be){fo(this,be);return}if(g=D||"",D=new Map(this.headers),W)if(Object.getPrototypeOf(W)===Object.prototype)for(var fe in W)D.set(fe,W[fe]);else if(typeof W.keys=="function"&&typeof W.get=="function")for(const be of W.keys())D.set(be,W.get(be));else throw Error("Unknown input type for opt_headers: "+String(W));W=Array.from(D.keys()).find(be=>be.toLowerCase()=="content-type"),fe=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(Xu,S,void 0)>=0)||W||fe||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[be,He]of D)this.g.setRequestHeader(be,He);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(be){fo(this,be)}};function fo(g,S){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=S,g.o=5,Yu(g),ai(g)}function Yu(g){g.A||(g.A=!0,Ft(g,"complete"),Ft(g,"error"))}t.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,Ft(this,"complete"),Ft(this,"abort"),ai(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ai(this,!0)),nr.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ho(this):this.Xa())},t.Xa=function(){ho(this)};function ho(g){if(g.h&&typeof i<"u"){if(g.v&&cs(g)==4)setTimeout(g.Ca.bind(g),0);else if(Ft(g,"readystatechange"),cs(g)==4){g.h=!1;try{const be=g.ca();e:switch(be){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var D;if(!(D=S)){var W;if(W=be===0){let He=String(g.D).match(zi)[1]||null;!He&&o.self&&o.self.location&&(He=o.self.location.protocol.slice(0,-1)),W=!As.test(He?He.toLowerCase():"")}D=W}if(D)Ft(g,"complete"),Ft(g,"success");else{g.o=6;try{var fe=cs(g)>2?g.g.statusText:""}catch{fe=""}g.l=fe+" ["+g.ca()+"]",Yu(g)}}finally{ai(g)}}}}function ai(g,S){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const D=g.g;g.g=null,S||Ft(g,"ready");try{D.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function cs(g){return g.g?g.g.readyState:0}t.ca=function(){try{return cs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(g){if(this.g){var S=this.g.responseText;return g&&S.indexOf(g)==0&&(S=S.substring(g.length)),Fr(S)}};function vn(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function si(g){const S={};g=(g.g&&cs(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let W=0;W<g.length;W++){if(B(g[W]))continue;var D=V(g[W]);const fe=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const be=S[fe]||[];S[fe]=be,be.push(D)}ye(S,function(W){return W.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ks(g,S,D){return D&&D.internalChannelParams&&D.internalChannelParams[g]||S}function $i(g){this.za=0,this.i=[],this.j=new pa,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ks("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ks("baseRetryDelayMs",5e3,g),this.Za=ks("retryDelaySeedMs",1e4,g),this.Ta=ks("forwardChannelMaxRetries",2,g),this.va=ks("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Yt(g&&g.concurrentRequestLimit),this.Ba=new Xi,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=$i.prototype,t.ka=8,t.I=1,t.connect=function(g,S,D,W){kr(0),this.W=g,this.H=S||{},D&&W!==void 0&&(this.H.OSID=D,this.H.OAID=W),this.F=this.X,this.J=_h(this,null,this.W),Cs(this)};function $u(g){if(pc(g),g.I==3){var S=g.V++,D=Wr(g.J);if(Kt(D,"SID",g.M),Kt(D,"RID",S),Kt(D,"TYPE","terminate"),mo(g,D),S=new Z(g,g.j,S),S.M=2,S.A=lo(Wr(D)),D=!1,o.navigator&&o.navigator.sendBeacon)try{D=o.navigator.sendBeacon(S.A.toString(),"")}catch{}!D&&o.Image&&(new Image().src=S.A,D=!0),D||(S.g=wh(S.j,null),S.g.ea(S.A)),S.F=Date.now(),ge(S)}yh(g)}function Ki(g){g.g&&(Qu(g),g.g.cancel(),g.g=null)}function pc(g){Ki(g),g.v&&(o.clearTimeout(g.v),g.v=null),xc(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function Cs(g){if(!$t(g.h)&&!g.m){g.m=!0;var S=g.Ea;H||F(),X||(H(),X=!0),A.add(S,g),g.D=0}}function gc(g,S){return cr(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=S.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=Da(d(g.Ea,g,S),vh(g,g.D)),g.D++,!0)}t.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const fe=new Z(this,this.j,g);let be=this.o;if(this.U&&(be?(be=Q(be),Y(be,this.U)):be=this.U),this.u!==null||this.R||(fe.J=be,be=null),this.S)e:{for(var S=0,D=0;D<this.i.length;D++){t:{var W=this.i[D];if("__data__"in W.map&&(W=W.map.__data__,typeof W=="string")){W=W.length;break t}W=void 0}if(W===void 0)break;if(S+=W,S>4096){S=D;break e}if(S===4096||D===this.i.length-1){S=D+1;break e}}S=1e3}else S=1e3;S=mh(this,fe,S),D=Wr(this.J),Kt(D,"RID",g),Kt(D,"CVER",22),this.G&&Kt(D,"X-HTTP-Session-Id",this.G),mo(this,D),be&&(this.R?S="headers="+as(Ma(be))+"&"+S:this.u&&uo(D,this.u,be)),ss(this.h,fe),this.Ra&&Kt(D,"TYPE","init"),this.S?(Kt(D,"$req",S),Kt(D,"SID","null"),fe.U=!0,ee(fe,D,null)):ee(fe,D,S),this.I=2}}else this.I==3&&(g?Ku(this,g):this.i.length==0||$t(this.h)||Ku(this))};function Ku(g,S){var D;S?D=S.l:D=g.V++;const W=Wr(g.J);Kt(W,"SID",g.M),Kt(W,"RID",D),Kt(W,"AID",g.K),mo(g,W),g.u&&g.o&&uo(W,g.u,g.o),D=new Z(g,g.j,D,g.D+1),g.u===null&&(D.J=g.o),S&&(g.i=S.G.concat(g.i)),S=mh(g,D,1e3),D.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),ss(g.h,D),ee(D,W,S)}function mo(g,S){g.H&&ne(g.H,function(D,W){Kt(S,W,D)}),g.l&&ne({},function(D,W){Kt(S,W,D)})}function mh(g,S,D){D=Math.min(g.i.length,D);const W=g.l?d(g.l.Ka,g.l,g):null;e:{var fe=g.i;let xt=-1;for(;;){const Mr=["count="+D];xt==-1?D>0?(xt=fe[0].g,Mr.push("ofs="+xt)):xt=0:Mr.push("ofs="+xt);let Ht=!0;for(let _r=0;_r<D;_r++){var be=fe[_r].g;const Pa=fe[_r].map;if(be-=xt,be<0)xt=Math.max(0,fe[_r].g-100),Ht=!1;else try{be="req"+be+"_"||"";try{var He=Pa instanceof Map?Pa:Object.entries(Pa);for(const[Rs,us]of He){let fs=us;u(us)&&(fs=Xt(us)),Mr.push(be+Rs+"="+encodeURIComponent(fs))}}catch(Rs){throw Mr.push(be+"type="+encodeURIComponent("_badmap")),Rs}}catch{W&&W(Pa)}}if(Ht){He=Mr.join("&");break e}}He=void 0}return g=g.i.splice(0,D),S.G=g,He}function ph(g){if(!g.g&&!g.v){g.Y=1;var S=g.Da;H||F(),X||(H(),X=!0),A.add(S,g),g.A=0}}function po(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=Da(d(g.Da,g),vh(g,g.A)),g.A++,!0)}t.Da=function(){if(this.v=null,gh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=Da(d(this.Wa,this),g)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,kr(10),Ki(this),gh(this))};function Qu(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function gh(g){g.g=new Z(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var S=Wr(g.na);Kt(S,"RID","rpc"),Kt(S,"SID",g.M),Kt(S,"AID",g.K),Kt(S,"CI",g.F?"0":"1"),!g.F&&g.ia&&Kt(S,"TO",g.ia),Kt(S,"TYPE","xmlhttp"),mo(g,S),g.u&&g.o&&uo(S,g.u,g.o),g.O&&(g.g.H=g.O);var D=g.g;g=g.ba,D.M=1,D.A=lo(Wr(S)),D.u=null,D.R=!0,de(D,g)}t.Va=function(){this.C!=null&&(this.C=null,Ki(this),po(this),kr(19))};function xc(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function xh(g,S){var D=null;if(g.g==S){xc(g),Qu(g),g.g=null;var W=2}else if(Nn(g.h,S))D=S.G,is(g.h,S),W=1;else return;if(g.I!=0){if(S.o)if(W==1){D=S.u?S.u.length:0,S=Date.now()-S.F;var fe=g.D;W=Js(),Ft(W,new Wn(W,D)),Cs(g)}else ph(g);else if(fe=S.m,fe==3||fe==0&&S.X>0||!(W==1&&gc(g,S)||W==2&&po(g)))switch(D&&D.length>0&&(S=g.h,S.i=S.i.concat(D)),fe){case 1:Ns(g,5);break;case 4:Ns(g,10);break;case 3:Ns(g,6);break;default:Ns(g,2)}}}function vh(g,S){let D=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(D*=2),D*S}function Ns(g,S){if(g.j.info("Error code "+S),S==2){var D=d(g.bb,g),W=g.Ua;const fe=!W;W=new xa(W||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||hn(W,"https"),lo(W),fe?ls(W.toString(),D):Wu(W.toString(),D)}else kr(2);g.I=0,g.l&&g.l.pa(S),yh(g),pc(g)}t.bb=function(g){g?(this.j.info("Successfully pinged google.com"),kr(2)):(this.j.info("Failed to ping google.com"),kr(1))};function yh(g){if(g.I=0,g.ja=[],g.l){const S=ga(g.h);(S.length!=0||g.i.length!=0)&&(b(g.ja,S),b(g.ja,g.i),g.h.i.length=0,w(g.i),g.i.length=0),g.l.oa()}}function _h(g,S,D){var W=D instanceof xa?Wr(D):new xa(D);if(W.g!="")S&&(W.g=S+"."+W.g),Hi(W,W.u);else{var fe=o.location;W=fe.protocol,S=S?S+"."+fe.hostname:fe.hostname,fe=+fe.port;const be=new xa(null);W&&hn(be,W),S&&(be.g=S),fe&&Hi(be,fe),D&&(be.h=D),W=be}return D=g.G,S=g.wa,D&&S&&Kt(W,D,S),Kt(W,"VER",g.ka),mo(g,W),W}function wh(g,S,D){if(S&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=g.Aa&&!g.ma?new nr(new Ss({ab:D})):new nr(g.ma),S.Fa(g.L),S}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function bh(){}t=bh.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Qi(){}Qi.prototype.g=function(g,S){return new Xn(g,S)};function Xn(g,S){wt.call(this),this.g=new $i(S),this.l=g,this.h=S&&S.messageUrlParams||null,g=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(g?g["X-WebChannel-Content-Type"]=S.messageContentType:g={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(g?g["X-WebChannel-Client-Profile"]=S.sa:g={"X-WebChannel-Client-Profile":S.sa}),this.g.U=g,(g=S&&S.Qb)&&!B(g)&&(this.g.u=g),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!B(S)&&(this.g.G=S,g=this.h,g!==null&&S in g&&(g=this.h,S in g&&delete g[S])),this.j=new ii(this)}x(Xn,wt),Xn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Xn.prototype.close=function(){$u(this.g)},Xn.prototype.o=function(g){var S=this.g;if(typeof g=="string"){var D={};D.__data__=g,g=D}else this.v&&(D={},D.__data__=Xt(g),g=D);S.i.push(new Ze(S.Ya++,g)),S.I==3&&Cs(S)},Xn.prototype.N=function(){this.g.l=null,delete this.j,$u(this.g),delete this.g,Xn.Z.N.call(this)};function Eh(g){or.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var S=g.__sm__;if(S){e:{for(const D in S){g=D;break e}g=void 0}(this.i=g)&&(g=this.i,S=S!==null&&g in S?S[g]:void 0),this.data=S}else this.data=g}x(Eh,or);function Th(){qr.call(this),this.status=1}x(Th,qr);function ii(g){this.g=g}x(ii,bh),ii.prototype.ra=function(){Ft(this.g,"a")},ii.prototype.qa=function(g){Ft(this.g,new Eh(g))},ii.prototype.pa=function(g){Ft(this.g,new Th)},ii.prototype.oa=function(){Ft(this.g,"b")},Qi.prototype.createWebChannel=Qi.prototype.g,Xn.prototype.send=Xn.prototype.o,Xn.prototype.open=Xn.prototype.m,Xn.prototype.close=Xn.prototype.close,_4=function(){return new Qi},y4=function(){return Js()},v4=dr,vx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ti.NO_ERROR=0,ti.TIMEOUT=8,ti.HTTP_ERROR=6,Zd=ti,ri.COMPLETE="complete",x4=ri,sn.EventType=Mt,Mt.OPEN="a",Mt.CLOSE="b",Mt.ERROR="c",Mt.MESSAGE="d",wt.prototype.listen=wt.prototype.J,Uf=sn,nr.prototype.listenOnce=nr.prototype.K,nr.prototype.getLastError=nr.prototype.Ha,nr.prototype.getLastErrorCode=nr.prototype.ya,nr.prototype.getStatus=nr.prototype.ca,nr.prototype.getResponseJson=nr.prototype.La,nr.prototype.getResponseText=nr.prototype.la,nr.prototype.send=nr.prototype.ea,nr.prototype.setWithCredentials=nr.prototype.Fa,g4=nr}).apply(typeof Rd<"u"?Rd:typeof self<"u"?self:typeof window<"u"?window:{});const Zb="@firebase/firestore",eE="4.9.2";let Fn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Fn.UNAUTHENTICATED=new Fn(null),Fn.GOOGLE_CREDENTIALS=new Fn("google-credentials-uid"),Fn.FIRST_PARTY=new Fn("first-party-uid"),Fn.MOCK_USER=new Fn("mock-user");let Ru="12.3.0";const qo=new dv("@firebase/firestore");function Qc(){return qo.logLevel}function Qe(t,...e){if(qo.logLevel<=Rt.DEBUG){const r=e.map(gv);qo.debug(`Firestore (${Ru}): ${t}`,...r)}}function Oi(t,...e){if(qo.logLevel<=Rt.ERROR){const r=e.map(gv);qo.error(`Firestore (${Ru}): ${t}`,...r)}}function pu(t,...e){if(qo.logLevel<=Rt.WARN){const r=e.map(gv);qo.warn(`Firestore (${Ru}): ${t}`,...r)}}function gv(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function ct(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,w4(t,n,r)}function w4(t,e,r){let n=`FIRESTORE (${Ru}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Oi(n),new Error(n)}function Wt(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||w4(e,a,n)}function gt(t,e){return t}const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends Li{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ki{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class b4{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(Fn.UNAUTHENTICATED)))}shutdown(){}}class cD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class uD{constructor(e){this.t=e,this.currentUser=Fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Wt(this.o===void 0,42304);let n=this.i;const a=f=>this.i!==n?(n=this.i,r(f)):Promise.resolve();let i=new ki;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ki,e.enqueueRetryable((()=>a(this.currentUser)))};const o=()=>{const f=i;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},u=f=>{Qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((f=>u(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(Qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ki)}}),0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(Qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Wt(typeof n.accessToken=="string",31837,{l:n}),new b4(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Wt(e===null||typeof e=="string",2055,{h:e}),new Fn(e)}}class fD{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hD{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new fD(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(Fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class tE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dD{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,xs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Wt(this.o===void 0,3512);const n=i=>{i.error!=null&&Qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Qe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>n(i)))};const a=i=>{Qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>a(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?a(i):Qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new tE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Wt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new tE(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function mD(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class xv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=mD(40);for(let i=0;i<a.length;++i)n.length<20&&a[i]<r&&(n+=e.charAt(a[i]%62))}return n}}function It(t,e){return t<e?-1:t>e?1:0}function yx(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const a=t.charAt(n),i=e.charAt(n);if(a!==i)return L1(a)===L1(i)?It(a,i):L1(a)?1:-1}return It(t.length,e.length)}const pD=55296,gD=57343;function L1(t){const e=t.charCodeAt(0);return e>=pD&&e<=gD}function gu(t,e,r){return t.length===e.length&&t.every(((n,a)=>r(n,e[a])))}const rE="__name__";class Ls{constructor(e,r,n){r===void 0?r=0:r>e.length&&ct(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ct(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ls.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ls?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const i=Ls.compareSegments(e.get(a),r.get(a));if(i!==0)return i}return It(e.length,r.length)}static compareSegments(e,r){const n=Ls.isNumericId(e),a=Ls.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?Ls.extractNumericId(e).compare(Ls.extractNumericId(r)):yx(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fl.fromString(e.substring(4,e.length-2))}}class hr extends Ls{construct(e,r,n){return new hr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new $e(De.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((a=>a.length>0)))}return new hr(r)}static emptyPath(){return new hr([])}}const xD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class An extends Ls{construct(e,r,n){return new An(e,r,n)}static isValidIdentifier(e){return xD.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),An.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rE}static keyField(){return new An([rE])}static fromServerFormat(e){const r=[];let n="",a=0;const i=()=>{if(n.length===0)throw new $e(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new $e(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new $e(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,a+=2}else u==="`"?(o=!o,a++):u!=="."||o?(n+=u,a++):(i(),a++)}if(i(),o)throw new $e(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new An(r)}static emptyPath(){return new An([])}}class st{constructor(e){this.path=e}static fromPath(e){return new st(hr.fromString(e))}static fromName(e){return new st(hr.fromString(e).popFirst(5))}static empty(){return new st(hr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&hr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return hr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new st(new hr(e.slice()))}}function E4(t,e,r){if(!r)throw new $e(De.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function vD(t,e,r,n){if(e===!0&&n===!0)throw new $e(De.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function nE(t){if(!st.isDocumentKey(t))throw new $e(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function aE(t){if(st.isDocumentKey(t))throw new $e(De.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function T4(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Qm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ct(12329,{type:typeof t})}function Qn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $e(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Qm(t);throw new $e(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function nn(t,e){const r={typeString:t};return e&&(r.value=e),r}function B0(t,e){if(!T4(t))throw new $e(De.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const a=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(a&&typeof o!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(i!==void 0&&o!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new $e(De.INVALID_ARGUMENT,r);return!0}const sE=-62135596800,iE=1e6;class xr{static now(){return xr.fromMillis(Date.now())}static fromDate(e){return xr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*iE);return new xr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new $e(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new $e(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<sE)throw new $e(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $e(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/iE}_compareTo(e){return this.seconds===e.seconds?It(this.nanoseconds,e.nanoseconds):It(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(B0(e,xr._jsonSchema))return new xr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-sE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xr._jsonSchemaVersion="firestore/timestamp/1.0",xr._jsonSchema={type:nn("string",xr._jsonSchemaVersion),seconds:nn("number"),nanoseconds:nn("number")};class mt{static fromTimestamp(e){return new mt(e)}static min(){return new mt(new xr(0,0))}static max(){return new mt(new xr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const f0=-1;function yD(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=mt.fromTimestamp(n===1e9?new xr(r+1,0):new xr(r,n));return new Ll(a,st.empty(),e)}function _D(t){return new Ll(t.readTime,t.key,f0)}class Ll{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ll(mt.min(),st.empty(),f0)}static max(){return new Ll(mt.max(),st.empty(),f0)}}function wD(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=st.comparator(t.documentKey,e.documentKey),r!==0?r:It(t.largestBatchId,e.largestBatchId))}const bD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ED{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Iu(t){if(t.code!==De.FAILED_PRECONDITION||t.message!==bD)throw t;Qe("LocalStore","Unexpectedly lost primary lease")}class Fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ct(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Fe(((n,a)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,a)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,a)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof Fe?r:Fe.resolve(r)}catch(r){return Fe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):Fe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):Fe.reject(r)}static resolve(e){return new Fe(((r,n)=>{r(e)}))}static reject(e){return new Fe(((r,n)=>{n(e)}))}static waitFor(e){return new Fe(((r,n)=>{let a=0,i=0,o=!1;e.forEach((u=>{++a,u.next((()=>{++i,o&&i===a&&r()}),(f=>n(f)))})),o=!0,i===a&&r()}))}static or(e){let r=Fe.resolve(!1);for(const n of e)r=r.next((a=>a?Fe.resolve(a):n()));return r}static forEach(e,r){const n=[];return e.forEach(((a,i)=>{n.push(r.call(this,a,i))})),this.waitFor(n)}static mapArray(e,r){return new Fe(((n,a)=>{const i=e.length,o=new Array(i);let u=0;for(let f=0;f<i;f++){const d=f;r(e[d]).next((p=>{o[d]=p,++u,u===i&&n(o)}),(p=>a(p)))}}))}static doWhile(e,r){return new Fe(((n,a)=>{const i=()=>{e()===!0?r().next((()=>{i()}),a):n()};i()}))}}function TD(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Du(t){return t.name==="IndexedDbTransactionError"}class Jm{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Jm.ce=-1;const vv=-1;function Zm(t){return t==null}function dm(t){return t===0&&1/t==-1/0}function SD(t){return typeof t=="number"&&Number.isInteger(t)&&!dm(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const S4="";function AD(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=lE(e)),e=kD(t.get(r),e);return lE(e)}function kD(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const i=t.charAt(a);switch(i){case"\0":r+="";break;case S4:r+="";break;default:r+=i}}return r}function lE(t){return t+S4+""}function oE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Jl(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function A4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Ar{constructor(e,r){this.comparator=e,this.root=r||Tn.EMPTY}insert(e,r){return new Ar(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Tn.BLACK,null,null))}remove(e){return new Ar(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Tn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Id(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Id(this.root,e,this.comparator,!1)}getReverseIterator(){return new Id(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Id(this.root,e,this.comparator,!0)}}class Id{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&a&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Tn{constructor(e,r,n,a,i){this.key=e,this.value=r,this.color=n??Tn.RED,this.left=a??Tn.EMPTY,this.right=i??Tn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,i){return new Tn(e??this.key,r??this.value,n??this.color,a??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const i=n(e,a.key);return a=i<0?a.copy(null,null,null,a.left.insert(e,r,n),null):i===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Tn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return Tn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Tn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Tn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ct(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ct(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ct(27949);return e+(this.isRed()?0:1)}}Tn.EMPTY=null,Tn.RED=!0,Tn.BLACK=!1;Tn.EMPTY=new class{constructor(){this.size=0}get key(){throw ct(57766)}get value(){throw ct(16141)}get color(){throw ct(16727)}get left(){throw ct(29726)}get right(){throw ct(36894)}copy(e,r,n,a,i){return this}insert(e,r,n){return new Tn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class cn{constructor(e){this.comparator=e,this.data=new Ar(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new cE(this.data.getIterator())}getIteratorFrom(e){return new cE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof cn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,i=n.getNext().key;if(this.comparator(a,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new cn(this.comparator);return r.data=e,r}}class cE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Na{constructor(e){this.fields=e,e.sort(An.comparator)}static empty(){return new Na([])}unionWith(e){let r=new cn(An.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Na(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return gu(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}class k4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Cn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(a){try{return atob(a)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new k4("Invalid base64 string: "+i):i}})(e);return new Cn(r)}static fromUint8Array(e){const r=(function(a){let i="";for(let o=0;o<a.length;++o)i+=String.fromCharCode(a[o]);return i})(e);return new Cn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return It(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cn.EMPTY_BYTE_STRING=new Cn("");const CD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bl(t){if(Wt(!!t,39018),typeof t=="string"){let e=0;const r=CD.exec(t);if(Wt(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Br(t.seconds),nanos:Br(t.nanos)}}function Br(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Vl(t){return typeof t=="string"?Cn.fromBase64String(t):Cn.fromUint8Array(t)}const C4="server_timestamp",N4="__type__",R4="__previous_value__",I4="__local_write_time__";function yv(t){return(t?.mapValue?.fields||{})[N4]?.stringValue===C4}function ep(t){const e=t.mapValue.fields[R4];return yv(e)?ep(e):e}function h0(t){const e=Bl(t.mapValue.fields[I4].timestampValue);return new xr(e.seconds,e.nanos)}class ND{constructor(e,r,n,a,i,o,u,f,d,p){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=d,this.isUsingEmulator=p}}const mm="(default)";class d0{constructor(e,r){this.projectId=e,this.database=r||mm}static empty(){return new d0("","")}get isDefaultDatabase(){return this.database===mm}isEqual(e){return e instanceof d0&&e.projectId===this.projectId&&e.database===this.database}}const D4="__type__",RD="__max__",Dd={mapValue:{}},O4="__vector__",pm="value";function Ul(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yv(t)?4:DD(t)?9007199254740991:ID(t)?10:11:ct(28295,{value:t})}function Xs(t,e){if(t===e)return!0;const r=Ul(t);if(r!==Ul(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return h0(t).isEqual(h0(e));case 3:return(function(a,i){if(typeof a.timestampValue=="string"&&typeof i.timestampValue=="string"&&a.timestampValue.length===i.timestampValue.length)return a.timestampValue===i.timestampValue;const o=Bl(a.timestampValue),u=Bl(i.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,i){return Vl(a.bytesValue).isEqual(Vl(i.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,i){return Br(a.geoPointValue.latitude)===Br(i.geoPointValue.latitude)&&Br(a.geoPointValue.longitude)===Br(i.geoPointValue.longitude)})(t,e);case 2:return(function(a,i){if("integerValue"in a&&"integerValue"in i)return Br(a.integerValue)===Br(i.integerValue);if("doubleValue"in a&&"doubleValue"in i){const o=Br(a.doubleValue),u=Br(i.doubleValue);return o===u?dm(o)===dm(u):isNaN(o)&&isNaN(u)}return!1})(t,e);case 9:return gu(t.arrayValue.values||[],e.arrayValue.values||[],Xs);case 10:case 11:return(function(a,i){const o=a.mapValue.fields||{},u=i.mapValue.fields||{};if(oE(o)!==oE(u))return!1;for(const f in o)if(o.hasOwnProperty(f)&&(u[f]===void 0||!Xs(o[f],u[f])))return!1;return!0})(t,e);default:return ct(52216,{left:t})}}function m0(t,e){return(t.values||[]).find((r=>Xs(r,e)))!==void 0}function xu(t,e){if(t===e)return 0;const r=Ul(t),n=Ul(e);if(r!==n)return It(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return It(t.booleanValue,e.booleanValue);case 2:return(function(i,o){const u=Br(i.integerValue||i.doubleValue),f=Br(o.integerValue||o.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1})(t,e);case 3:return uE(t.timestampValue,e.timestampValue);case 4:return uE(h0(t),h0(e));case 5:return yx(t.stringValue,e.stringValue);case 6:return(function(i,o){const u=Vl(i),f=Vl(o);return u.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(i,o){const u=i.split("/"),f=o.split("/");for(let d=0;d<u.length&&d<f.length;d++){const p=It(u[d],f[d]);if(p!==0)return p}return It(u.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(i,o){const u=It(Br(i.latitude),Br(o.latitude));return u!==0?u:It(Br(i.longitude),Br(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return fE(t.arrayValue,e.arrayValue);case 10:return(function(i,o){const u=i.fields||{},f=o.fields||{},d=u[pm]?.arrayValue,p=f[pm]?.arrayValue,x=It(d?.values?.length||0,p?.values?.length||0);return x!==0?x:fE(d,p)})(t.mapValue,e.mapValue);case 11:return(function(i,o){if(i===Dd.mapValue&&o===Dd.mapValue)return 0;if(i===Dd.mapValue)return 1;if(o===Dd.mapValue)return-1;const u=i.fields||{},f=Object.keys(u),d=o.fields||{},p=Object.keys(d);f.sort(),p.sort();for(let x=0;x<f.length&&x<p.length;++x){const y=yx(f[x],p[x]);if(y!==0)return y;const w=xu(u[f[x]],d[p[x]]);if(w!==0)return w}return It(f.length,p.length)})(t.mapValue,e.mapValue);default:throw ct(23264,{he:r})}}function uE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return It(t,e);const r=Bl(t),n=Bl(e),a=It(r.seconds,n.seconds);return a!==0?a:It(r.nanos,n.nanos)}function fE(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const i=xu(r[a],n[a]);if(i)return i}return It(r.length,n.length)}function vu(t){return _x(t)}function _x(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=Bl(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return Vl(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return st.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",a=!0;for(const i of r.values||[])a?a=!1:n+=",",n+=_x(i);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let a="{",i=!0;for(const o of n)i?i=!1:a+=",",a+=`${o}:${_x(r.fields[o])}`;return a+"}"})(t.mapValue):ct(61005,{value:t})}function em(t){switch(Ul(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ep(t);return e?16+em(e):16;case 5:return 2*t.stringValue.length;case 6:return Vl(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,i)=>a+em(i)),0)})(t.arrayValue);case 10:case 11:return(function(n){let a=0;return Jl(n.fields,((i,o)=>{a+=i.length+em(o)})),a})(t.mapValue);default:throw ct(13486,{value:t})}}function hE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function wx(t){return!!t&&"integerValue"in t}function _v(t){return!!t&&"arrayValue"in t}function dE(t){return!!t&&"nullValue"in t}function mE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function tm(t){return!!t&&"mapValue"in t}function ID(t){return(t?.mapValue?.fields||{})[D4]?.stringValue===O4}function $f(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Jl(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=$f(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=$f(t.arrayValue.values[r]);return e}return{...t}}function DD(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===RD}class ua{constructor(e){this.value=e}static empty(){return new ua({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!tm(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=$f(r)}setAll(e){let r=An.emptyPath(),n={},a=[];e.forEach(((o,u)=>{if(!r.isImmediateParentOf(u)){const f=this.getFieldsMap(r);this.applyChanges(f,n,a),n={},a=[],r=u.popLast()}o?n[u.lastSegment()]=$f(o):a.push(u.lastSegment())}));const i=this.getFieldsMap(r);this.applyChanges(i,n,a)}delete(e){const r=this.field(e.popLast());tm(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Xs(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];tm(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Jl(r,((a,i)=>e[a]=i));for(const a of n)delete e[a]}clone(){return new ua($f(this.value))}}function F4(t){const e=[];return Jl(t.fields,((r,n)=>{const a=new An([r]);if(tm(n)){const i=F4(n.mapValue).fields;if(i.length===0)e.push(a);else for(const o of i)e.push(a.child(o))}else e.push(a)})),new Na(e)}class jn{constructor(e,r,n,a,i,o,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=i,this.data=o,this.documentState=u}static newInvalidDocument(e){return new jn(e,0,mt.min(),mt.min(),mt.min(),ua.empty(),0)}static newFoundDocument(e,r,n,a){return new jn(e,1,r,mt.min(),n,a,0)}static newNoDocument(e,r){return new jn(e,2,r,mt.min(),mt.min(),ua.empty(),0)}static newUnknownDocument(e,r){return new jn(e,3,r,mt.min(),mt.min(),ua.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ua.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ua.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof jn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new jn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class gm{constructor(e,r){this.position=e,this.inclusive=r}}function pE(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const i=e[a],o=t.position[a];if(i.field.isKeyField()?n=st.comparator(st.fromName(o.referenceValue),r.key):n=xu(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function gE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Xs(t.position[r],e.position[r]))return!1;return!0}class p0{constructor(e,r="asc"){this.field=e,this.dir=r}}function OD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class M4{}class rn extends M4{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new MD(e,r,n):r==="array-contains"?new LD(e,n):r==="in"?new BD(e,n):r==="not-in"?new VD(e,n):r==="array-contains-any"?new UD(e,n):new rn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new PD(e,n):new jD(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(xu(r,this.value)):r!==null&&Ul(this.value)===Ul(r)&&this.matchesComparison(xu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ct(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Es extends M4{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Es(e,r)}matches(e){return P4(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function P4(t){return t.op==="and"}function j4(t){return FD(t)&&P4(t)}function FD(t){for(const e of t.filters)if(e instanceof Es)return!1;return!0}function bx(t){if(t instanceof rn)return t.field.canonicalString()+t.op.toString()+vu(t.value);if(j4(t))return t.filters.map((e=>bx(e))).join(",");{const e=t.filters.map((r=>bx(r))).join(",");return`${t.op}(${e})`}}function L4(t,e){return t instanceof rn?(function(n,a){return a instanceof rn&&n.op===a.op&&n.field.isEqual(a.field)&&Xs(n.value,a.value)})(t,e):t instanceof Es?(function(n,a){return a instanceof Es&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((i,o,u)=>i&&L4(o,a.filters[u])),!0):!1})(t,e):void ct(19439)}function B4(t){return t instanceof rn?(function(r){return`${r.field.canonicalString()} ${r.op} ${vu(r.value)}`})(t):t instanceof Es?(function(r){return r.op.toString()+" {"+r.getFilters().map(B4).join(" ,")+"}"})(t):"Filter"}class MD extends rn{constructor(e,r,n){super(e,r,n),this.key=st.fromName(n.referenceValue)}matches(e){const r=st.comparator(e.key,this.key);return this.matchesComparison(r)}}class PD extends rn{constructor(e,r){super(e,"in",r),this.keys=V4("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class jD extends rn{constructor(e,r){super(e,"not-in",r),this.keys=V4("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function V4(t,e){return(e.arrayValue?.values||[]).map((r=>st.fromName(r.referenceValue)))}class LD extends rn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return _v(r)&&m0(r.arrayValue,this.value)}}class BD extends rn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&m0(this.value.arrayValue,r)}}class VD extends rn{constructor(e,r){super(e,"not-in",r)}matches(e){if(m0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!m0(this.value.arrayValue,r)}}class UD extends rn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!_v(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>m0(this.value.arrayValue,n)))}}class zD{constructor(e,r=null,n=[],a=[],i=null,o=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=i,this.startAt=o,this.endAt=u,this.Te=null}}function xE(t,e=null,r=[],n=[],a=null,i=null,o=null){return new zD(t,e,r,n,a,i,o)}function wv(t){const e=gt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>bx(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(i){return i.field.canonicalString()+i.dir})(n))).join(","),Zm(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>vu(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>vu(n))).join(",")),e.Te=r}return e.Te}function bv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!OD(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!L4(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!gE(t.startAt,e.startAt)&&gE(t.endAt,e.endAt)}function Ex(t){return st.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Ou{constructor(e,r=null,n=[],a=[],i=null,o="F",u=null,f=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function HD(t,e,r,n,a,i,o,u){return new Ou(t,e,r,n,a,i,o,u)}function tp(t){return new Ou(t)}function vE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function U4(t){return t.collectionGroup!==null}function Kf(t){const e=gt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new cn(An.comparator);return o.filters.forEach((f=>{f.getFlattenedFilters().forEach((d=>{d.isInequality()&&(u=u.add(d.field))}))})),u})(e).forEach((i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new p0(i,n))})),r.has(An.keyField().canonicalString())||e.Ie.push(new p0(An.keyField(),n))}return e.Ie}function Vs(t){const e=gt(t);return e.Ee||(e.Ee=GD(e,Kf(t))),e.Ee}function GD(t,e){if(t.limitType==="F")return xE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const i=a.dir==="desc"?"asc":"desc";return new p0(a.field,i)}));const r=t.endAt?new gm(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new gm(t.startAt.position,t.startAt.inclusive):null;return xE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Tx(t,e){const r=t.filters.concat([e]);return new Ou(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Sx(t,e,r){return new Ou(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function rp(t,e){return bv(Vs(t),Vs(e))&&t.limitType===e.limitType}function z4(t){return`${wv(Vs(t))}|lt:${t.limitType}`}function Jc(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((a=>B4(a))).join(", ")}]`),Zm(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((a=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(a))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((a=>vu(a))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((a=>vu(a))).join(",")),`Target(${n})`})(Vs(t))}; limitType=${t.limitType})`}function np(t,e){return e.isFoundDocument()&&(function(n,a){const i=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):st.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)})(t,e)&&(function(n,a){for(const i of Kf(n))if(!i.field.isKeyField()&&a.data.field(i.field)===null)return!1;return!0})(t,e)&&(function(n,a){for(const i of n.filters)if(!i.matches(a))return!1;return!0})(t,e)&&(function(n,a){return!(n.startAt&&!(function(o,u,f){const d=pE(o,u,f);return o.inclusive?d<=0:d<0})(n.startAt,Kf(n),a)||n.endAt&&!(function(o,u,f){const d=pE(o,u,f);return o.inclusive?d>=0:d>0})(n.endAt,Kf(n),a))})(t,e)}function qD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function H4(t){return(e,r)=>{let n=!1;for(const a of Kf(t)){const i=WD(a,e,r);if(i!==0)return i;n=n||a.field.isKeyField()}return 0}}function WD(t,e,r){const n=t.field.isKeyField()?st.comparator(e.key,r.key):(function(i,o,u){const f=o.data.field(i),d=u.data.field(i);return f!==null&&d!==null?xu(f,d):ct(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ct(19790,{direction:t.dir})}}class tc{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,i]of n)if(this.equalsFn(a,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<a.length;i++)if(this.equalsFn(a[i][0],e))return void(a[i]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Jl(this.inner,((r,n)=>{for(const[a,i]of n)e(a,i)}))}isEmpty(){return A4(this.inner)}size(){return this.innerSize}}const XD=new Ar(st.comparator);function Fi(){return XD}const G4=new Ar(st.comparator);function zf(...t){let e=G4;for(const r of t)e=e.insert(r.key,r);return e}function q4(t){let e=G4;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function Fo(){return Qf()}function W4(){return Qf()}function Qf(){return new tc((t=>t.toString()),((t,e)=>t.isEqual(e)))}const YD=new Ar(st.comparator),$D=new cn(st.comparator);function Dt(...t){let e=$D;for(const r of t)e=e.add(r);return e}const KD=new cn(It);function QD(){return KD}function Ev(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dm(e)?"-0":e}}function X4(t){return{integerValue:""+t}}function JD(t,e){return SD(e)?X4(e):Ev(t,e)}class ap{constructor(){this._=void 0}}function ZD(t,e,r){return t instanceof xm?(function(a,i){const o={fields:{[N4]:{stringValue:C4},[I4]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return i&&yv(i)&&(i=ep(i)),i&&(o.fields[R4]=i),{mapValue:o}})(r,e):t instanceof g0?$4(t,e):t instanceof x0?K4(t,e):(function(a,i){const o=Y4(a,i),u=yE(o)+yE(a.Ae);return wx(o)&&wx(a.Ae)?X4(u):Ev(a.serializer,u)})(t,e)}function e8(t,e,r){return t instanceof g0?$4(t,e):t instanceof x0?K4(t,e):r}function Y4(t,e){return t instanceof vm?(function(n){return wx(n)||(function(i){return!!i&&"doubleValue"in i})(n)})(e)?e:{integerValue:0}:null}class xm extends ap{}class g0 extends ap{constructor(e){super(),this.elements=e}}function $4(t,e){const r=Q4(e);for(const n of t.elements)r.some((a=>Xs(a,n)))||r.push(n);return{arrayValue:{values:r}}}class x0 extends ap{constructor(e){super(),this.elements=e}}function K4(t,e){let r=Q4(e);for(const n of t.elements)r=r.filter((a=>!Xs(a,n)));return{arrayValue:{values:r}}}class vm extends ap{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function yE(t){return Br(t.integerValue||t.doubleValue)}function Q4(t){return _v(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function t8(t,e){return t.field.isEqual(e.field)&&(function(n,a){return n instanceof g0&&a instanceof g0||n instanceof x0&&a instanceof x0?gu(n.elements,a.elements,Xs):n instanceof vm&&a instanceof vm?Xs(n.Ae,a.Ae):n instanceof xm&&a instanceof xm})(t.transform,e.transform)}class r8{constructor(e,r){this.version=e,this.transformResults=r}}class Jn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Jn}static exists(e){return new Jn(void 0,e)}static updateTime(e){return new Jn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function rm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class sp{}function J4(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ip(t.key,Jn.none()):new V0(t.key,t.data,Jn.none());{const r=t.data,n=ua.empty();let a=new cn(An.comparator);for(let i of e.fields)if(!a.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),a=a.add(i)}return new Zl(t.key,n,new Na(a.toArray()),Jn.none())}}function n8(t,e,r){t instanceof V0?(function(a,i,o){const u=a.value.clone(),f=wE(a.fieldTransforms,i,o.transformResults);u.setAll(f),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(t,e,r):t instanceof Zl?(function(a,i,o){if(!rm(a.precondition,i))return void i.convertToUnknownDocument(o.version);const u=wE(a.fieldTransforms,i,o.transformResults),f=i.data;f.setAll(Z4(a)),f.setAll(u),i.convertToFoundDocument(o.version,f).setHasCommittedMutations()})(t,e,r):(function(a,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,r)}function Jf(t,e,r,n){return t instanceof V0?(function(i,o,u,f){if(!rm(i.precondition,o))return u;const d=i.value.clone(),p=bE(i.fieldTransforms,f,o);return d.setAll(p),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(t,e,r,n):t instanceof Zl?(function(i,o,u,f){if(!rm(i.precondition,o))return u;const d=bE(i.fieldTransforms,f,o),p=o.data;return p.setAll(Z4(i)),p.setAll(d),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),u===null?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((x=>x.field)))})(t,e,r,n):(function(i,o,u){return rm(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u})(t,e,r)}function a8(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),i=Y4(n.transform,a||null);i!=null&&(r===null&&(r=ua.empty()),r.set(n.field,i))}return r||null}function _E(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&gu(n,a,((i,o)=>t8(i,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class V0 extends sp{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Zl extends sp{constructor(e,r,n,a,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Z4(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function wE(t,e,r){const n=new Map;Wt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let a=0;a<r.length;a++){const i=t[a],o=i.transform,u=e.data.field(i.field);n.set(i.field,e8(o,u,r[a]))}return n}function bE(t,e,r){const n=new Map;for(const a of t){const i=a.transform,o=r.data.field(a.field);n.set(a.field,ZD(i,o,e))}return n}class ip extends sp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class s8 extends sp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class i8{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const i=this.mutations[a];i.key.isEqual(e.key)&&n8(i,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Jf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Jf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=W4();return this.mutations.forEach((a=>{const i=e.get(a.key),o=i.overlayedDocument;let u=this.applyToLocalView(o,i.mutatedFields);u=r.has(a.key)?null:u;const f=J4(o,u);f!==null&&n.set(a.key,f),o.isValidDocument()||o.convertToNoDocument(mt.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Dt())}isEqual(e){return this.batchId===e.batchId&&gu(this.mutations,e.mutations,((r,n)=>_E(r,n)))&&gu(this.baseMutations,e.baseMutations,((r,n)=>_E(r,n)))}}class Tv{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Wt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return YD})();const i=e.mutations;for(let o=0;o<i.length;o++)a=a.insert(i[o].key,n[o].version);return new Tv(e,r,n,a)}}class l8{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class o8{constructor(e,r){this.count=e,this.unchangedNames=r}}var Jr,Pt;function c8(t){switch(t){case De.OK:return ct(64938);case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0;default:return ct(15467,{code:t})}}function eA(t){if(t===void 0)return Oi("GRPC error has no .code"),De.UNKNOWN;switch(t){case Jr.OK:return De.OK;case Jr.CANCELLED:return De.CANCELLED;case Jr.UNKNOWN:return De.UNKNOWN;case Jr.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case Jr.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case Jr.INTERNAL:return De.INTERNAL;case Jr.UNAVAILABLE:return De.UNAVAILABLE;case Jr.UNAUTHENTICATED:return De.UNAUTHENTICATED;case Jr.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case Jr.NOT_FOUND:return De.NOT_FOUND;case Jr.ALREADY_EXISTS:return De.ALREADY_EXISTS;case Jr.PERMISSION_DENIED:return De.PERMISSION_DENIED;case Jr.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case Jr.ABORTED:return De.ABORTED;case Jr.OUT_OF_RANGE:return De.OUT_OF_RANGE;case Jr.UNIMPLEMENTED:return De.UNIMPLEMENTED;case Jr.DATA_LOSS:return De.DATA_LOSS;default:return ct(39323,{code:t})}}(Pt=Jr||(Jr={}))[Pt.OK=0]="OK",Pt[Pt.CANCELLED=1]="CANCELLED",Pt[Pt.UNKNOWN=2]="UNKNOWN",Pt[Pt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Pt[Pt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Pt[Pt.NOT_FOUND=5]="NOT_FOUND",Pt[Pt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Pt[Pt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Pt[Pt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Pt[Pt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Pt[Pt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Pt[Pt.ABORTED=10]="ABORTED",Pt[Pt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Pt[Pt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Pt[Pt.INTERNAL=13]="INTERNAL",Pt[Pt.UNAVAILABLE=14]="UNAVAILABLE",Pt[Pt.DATA_LOSS=15]="DATA_LOSS";function u8(){return new TextEncoder}const f8=new Fl([4294967295,4294967295],0);function EE(t){const e=u8().encode(t),r=new p4;return r.update(e),new Uint8Array(r.digest())}function TE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Fl([r,n],0),new Fl([a,i],0)]}class Sv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Hf(`Invalid padding: ${r}`);if(n<0)throw new Hf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Hf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Hf(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Fl.fromNumber(this.ge)}ye(e,r,n){let a=e.add(r.multiply(Fl.fromNumber(n)));return a.compare(f8)===1&&(a=new Fl([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=EE(e),[n,a]=TE(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,a,i);if(!this.we(o))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Sv(i,a,r);return n.forEach((u=>o.insert(u))),o}insert(e){if(this.ge===0)return;const r=EE(e),[n,a]=TE(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,a,i);this.Se(o)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Hf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class lp{constructor(e,r,n,a,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,U0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new lp(mt.min(),a,new Ar(It),Fi(),Dt())}}class U0{constructor(e,r,n,a,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new U0(n,r,Dt(),Dt(),Dt())}}class nm{constructor(e,r,n,a){this.be=e,this.removedTargetIds=r,this.key=n,this.De=a}}class tA{constructor(e,r){this.targetId=e,this.Ce=r}}class rA{constructor(e,r,n=Cn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class SE{constructor(){this.ve=0,this.Fe=AE(),this.Me=Cn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Dt(),r=Dt(),n=Dt();return this.Fe.forEach(((a,i)=>{switch(i){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:ct(38017,{changeType:i})}})),new U0(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=AE()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Wt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class h8{constructor(e){this.Ge=e,this.ze=new Map,this.je=Fi(),this.Je=Od(),this.He=Od(),this.Ye=new Ar(It)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ct(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,a)=>{this.rt(a)&&r(a)}))}st(e){const r=e.targetId,n=e.Ce.count,a=this.ot(r);if(a){const i=a.target;if(Ex(i))if(n===0){const o=new st(i.path);this.et(r,o,jn.newNoDocument(o,mt.min()))}else Wt(n===1,20013,{expectedCount:n});else{const o=this._t(r);if(o!==n){const u=this.ut(e),f=u?this.ct(u,e,o):1;if(f!==0){this.it(r);const d=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,d)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:i=0}=r;let o,u;try{o=Vl(n).toUint8Array()}catch(f){if(f instanceof k4)return pu("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new Sv(o,a,i)}catch(f){return pu(f instanceof Hf?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.ge===0?null:u}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let a=0;return n.forEach((i=>{const o=this.Ge.ht(),u=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(u)||(this.et(r,i,null),a++)})),a}Tt(e){const r=new Map;this.ze.forEach(((i,o)=>{const u=this.ot(o);if(u){if(i.current&&Ex(u.target)){const f=new st(u.target.path);this.It(f).has(o)||this.Et(o,f)||this.et(o,f,jn.newNoDocument(f,e))}i.Be&&(r.set(o,i.ke()),i.qe())}}));let n=Dt();this.He.forEach(((i,o)=>{let u=!0;o.forEachWhile((f=>{const d=this.ot(f);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const a=new lp(e,r,this.Ye,this.je,n);return this.je=Fi(),this.Je=Od(),this.He=Od(),this.Ye=new Ar(It),a}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,r)?a.Qe(r,1):a.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new SE,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new cn(It),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new cn(It),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Qe("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new SE),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Od(){return new Ar(st.comparator)}function AE(){return new Ar(st.comparator)}const d8={asc:"ASCENDING",desc:"DESCENDING"},m8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},p8={and:"AND",or:"OR"};class g8{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Ax(t,e){return t.useProto3Json||Zm(e)?e:{value:e}}function ym(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function nA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function x8(t,e){return ym(t,e.toTimestamp())}function Us(t){return Wt(!!t,49232),mt.fromTimestamp((function(r){const n=Bl(r);return new xr(n.seconds,n.nanos)})(t))}function Av(t,e){return kx(t,e).canonicalString()}function kx(t,e){const r=(function(a){return new hr(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?r:r.child(e)}function aA(t){const e=hr.fromString(t);return Wt(cA(e),10190,{key:e.toString()}),e}function Cx(t,e){return Av(t.databaseId,e.path)}function B1(t,e){const r=aA(e);if(r.get(1)!==t.databaseId.projectId)throw new $e(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new $e(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new st(iA(r))}function sA(t,e){return Av(t.databaseId,e)}function v8(t){const e=aA(t);return e.length===4?hr.emptyPath():iA(e)}function Nx(t){return new hr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function iA(t){return Wt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function kE(t,e,r){return{name:Cx(t,e),fields:r.value.mapValue.fields}}function y8(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ct(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],i=(function(d,p){return d.useProto3Json?(Wt(p===void 0||typeof p=="string",58123),Cn.fromBase64String(p||"")):(Wt(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Cn.fromUint8Array(p||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&(function(d){const p=d.code===void 0?De.UNKNOWN:eA(d.code);return new $e(p,d.message||"")})(o);r=new rA(n,a,i,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=B1(t,n.document.name),i=Us(n.document.updateTime),o=n.document.createTime?Us(n.document.createTime):mt.min(),u=new ua({mapValue:{fields:n.document.fields}}),f=jn.newFoundDocument(a,i,o,u),d=n.targetIds||[],p=n.removedTargetIds||[];r=new nm(d,p,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=B1(t,n.document),i=n.readTime?Us(n.readTime):mt.min(),o=jn.newNoDocument(a,i),u=n.removedTargetIds||[];r=new nm([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=B1(t,n.document),i=n.removedTargetIds||[];r=new nm([],i,a,null)}else{if(!("filter"in e))return ct(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:i}=n,o=new o8(a,i),u=n.targetId;r=new tA(u,o)}}return r}function _8(t,e){let r;if(e instanceof V0)r={update:kE(t,e.key,e.value)};else if(e instanceof ip)r={delete:Cx(t,e.key)};else if(e instanceof Zl)r={update:kE(t,e.key,e.data),updateMask:N8(e.fieldMask)};else{if(!(e instanceof s8))return ct(16599,{Vt:e.type});r={verify:Cx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(i,o){const u=o.transform;if(u instanceof xm)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof g0)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof x0)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof vm)return{fieldPath:o.field.canonicalString(),increment:u.Ae};throw ct(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(a,i){return i.updateTime!==void 0?{updateTime:x8(a,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ct(27497)})(t,e.precondition)),r}function w8(t,e){return t&&t.length>0?(Wt(e!==void 0,14353),t.map((r=>(function(a,i){let o=a.updateTime?Us(a.updateTime):Us(i);return o.isEqual(mt.min())&&(o=Us(i)),new r8(o,a.transformResults||[])})(r,e)))):[]}function b8(t,e){return{documents:[sA(t,e.path)]}}function E8(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=sA(t,a);const i=(function(d){if(d.length!==0)return oA(Es.create(d,"and"))})(e.filters);i&&(r.structuredQuery.where=i);const o=(function(d){if(d.length!==0)return d.map((p=>(function(y){return{field:Zc(y.field),direction:A8(y.dir)}})(p)))})(e.orderBy);o&&(r.structuredQuery.orderBy=o);const u=Ax(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:r,parent:a}}function T8(t){let e=v8(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Wt(n===1,65062);const p=r.from[0];p.allDescendants?a=p.collectionId:e=e.child(p.collectionId)}let i=[];r.where&&(i=(function(x){const y=lA(x);return y instanceof Es&&j4(y)?y.getFilters():[y]})(r.where));let o=[];r.orderBy&&(o=(function(x){return x.map((y=>(function(b){return new p0(eu(b.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(b.direction))})(y)))})(r.orderBy));let u=null;r.limit&&(u=(function(x){let y;return y=typeof x=="object"?x.value:x,Zm(y)?null:y})(r.limit));let f=null;r.startAt&&(f=(function(x){const y=!!x.before,w=x.values||[];return new gm(w,y)})(r.startAt));let d=null;return r.endAt&&(d=(function(x){const y=!x.before,w=x.values||[];return new gm(w,y)})(r.endAt)),HD(e,a,o,i,u,"F",f,d)}function S8(t,e){const r=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ct(28987,{purpose:a})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function lA(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=eu(r.unaryFilter.field);return rn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=eu(r.unaryFilter.field);return rn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=eu(r.unaryFilter.field);return rn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=eu(r.unaryFilter.field);return rn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ct(61313);default:return ct(60726)}})(t):t.fieldFilter!==void 0?(function(r){return rn.create(eu(r.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ct(58110);default:return ct(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return Es.create(r.compositeFilter.filters.map((n=>lA(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ct(1026)}})(r.compositeFilter.op))})(t):ct(30097,{filter:t})}function A8(t){return d8[t]}function k8(t){return m8[t]}function C8(t){return p8[t]}function Zc(t){return{fieldPath:t.canonicalString()}}function eu(t){return An.fromServerFormat(t.fieldPath)}function oA(t){return t instanceof rn?(function(r){if(r.op==="=="){if(mE(r.value))return{unaryFilter:{field:Zc(r.field),op:"IS_NAN"}};if(dE(r.value))return{unaryFilter:{field:Zc(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(mE(r.value))return{unaryFilter:{field:Zc(r.field),op:"IS_NOT_NAN"}};if(dE(r.value))return{unaryFilter:{field:Zc(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zc(r.field),op:k8(r.op),value:r.value}}})(t):t instanceof Es?(function(r){const n=r.getFilters().map((a=>oA(a)));return n.length===1?n[0]:{compositeFilter:{op:C8(r.op),filters:n}}})(t):ct(54877,{filter:t})}function N8(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function cA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class kl{constructor(e,r,n,a,i=mt.min(),o=mt.min(),u=Cn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new kl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new kl(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new kl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new kl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class R8{constructor(e){this.yt=e}}function I8(t){const e=T8({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Sx(e,e.limit,"L"):e}class D8{constructor(){this.Cn=new O8}addToCollectionParentIndex(e,r){return this.Cn.add(r),Fe.resolve()}getCollectionParents(e,r){return Fe.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Fe.resolve()}deleteFieldIndex(e,r){return Fe.resolve()}deleteAllFieldIndexes(e){return Fe.resolve()}createTargetIndexes(e,r){return Fe.resolve()}getDocumentsMatchingTarget(e,r){return Fe.resolve(null)}getIndexType(e,r){return Fe.resolve(0)}getFieldIndexes(e,r){return Fe.resolve([])}getNextCollectionGroupToUpdate(e){return Fe.resolve(null)}getMinOffset(e,r){return Fe.resolve(Ll.min())}getMinOffsetFromCollectionGroup(e,r){return Fe.resolve(Ll.min())}updateCollectionGroup(e,r,n){return Fe.resolve()}updateIndexEntries(e,r){return Fe.resolve()}}class O8{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new cn(hr.comparator),i=!a.has(n);return this.index[r]=a.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new cn(hr.comparator)).toArray()}}const CE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},uA=41943040;class oa{static withCacheSize(e){return new oa(e,oa.DEFAULT_COLLECTION_PERCENTILE,oa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}oa.DEFAULT_COLLECTION_PERCENTILE=10,oa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oa.DEFAULT=new oa(uA,oa.DEFAULT_COLLECTION_PERCENTILE,oa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oa.DISABLED=new oa(-1,0,0);class yu{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new yu(0)}static cr(){return new yu(-1)}}const NE="LruGarbageCollector",F8=1048576;function RE([t,e],[r,n]){const a=It(t,r);return a===0?It(e,n):a}class M8{constructor(e){this.Ir=e,this.buffer=new cn(RE),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();RE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class P8{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Qe(NE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Du(r)?Qe(NE,"Ignoring IndexedDB error during garbage collection: ",r):await Iu(r)}await this.Vr(3e5)}))}}class j8{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return Fe.resolve(Jm.ce);const n=new M8(r);return this.mr.forEachTarget(e,(a=>n.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>n.Ar(a))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Qe("LruGarbageCollector","Garbage collection skipped; disabled"),Fe.resolve(CE)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Qe("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),CE):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,a,i,o,u,f,d;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(Qe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),a=this.params.maximumSequenceNumbersToCollect):a=x,o=Date.now(),this.nthSequenceNumber(e,a)))).next((x=>(n=x,u=Date.now(),this.removeTargets(e,n,r)))).next((x=>(i=x,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((x=>(d=Date.now(),Qc()<=Rt.DEBUG&&Qe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-p}ms
	Determined least recently used ${a} in `+(u-o)+`ms
	Removed ${i} targets in `+(f-u)+`ms
	Removed ${x} documents in `+(d-f)+`ms
Total Duration: ${d-p}ms`),Fe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:i,documentsRemoved:x}))))}}function L8(t,e){return new j8(t,e)}class B8{constructor(){this.changes=new tc((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,jn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Fe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class V8{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}class U8{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,r)))).next((a=>(n!==null&&Jf(n.mutation,a,Na.empty(),xr.now()),a)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Dt()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Dt()){const a=Fo();return this.populateOverlays(e,a,r).next((()=>this.computeViews(e,r,a,n).next((i=>{let o=zf();return i.forEach(((u,f)=>{o=o.insert(u,f.overlayedDocument)})),o}))))}getOverlayedDocuments(e,r){const n=Fo();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Dt())))}populateOverlays(e,r,n){const a=[];return n.forEach((i=>{r.has(i)||a.push(i)})),this.documentOverlayCache.getOverlays(e,a).next((i=>{i.forEach(((o,u)=>{r.set(o,u)}))}))}computeViews(e,r,n,a){let i=Fi();const o=Qf(),u=(function(){return Qf()})();return r.forEach(((f,d)=>{const p=n.get(d.key);a.has(d.key)&&(p===void 0||p.mutation instanceof Zl)?i=i.insert(d.key,d):p!==void 0?(o.set(d.key,p.mutation.getFieldMask()),Jf(p.mutation,d,p.mutation.getFieldMask(),xr.now())):o.set(d.key,Na.empty())})),this.recalculateAndSaveOverlays(e,i).next((f=>(f.forEach(((d,p)=>o.set(d,p))),r.forEach(((d,p)=>u.set(d,new V8(p,o.get(d)??null)))),u)))}recalculateAndSaveOverlays(e,r){const n=Qf();let a=new Ar(((o,u)=>o-u)),i=Dt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((o=>{for(const u of o)u.keys().forEach((f=>{const d=r.get(f);if(d===null)return;let p=n.get(f)||Na.empty();p=u.applyToLocalView(d,p),n.set(f,p);const x=(a.get(u.batchId)||Dt()).add(f);a=a.insert(u.batchId,x)}))})).next((()=>{const o=[],u=a.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),d=f.key,p=f.value,x=W4();p.forEach((y=>{if(!i.has(y)){const w=J4(r.get(y),n.get(y));w!==null&&x.set(y,w),i=i.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,x))}return Fe.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,a){return(function(o){return st.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):U4(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next((i=>{const o=a-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-i.size):Fe.resolve(Fo());let u=f0,f=i;return o.next((d=>Fe.forEach(d,((p,x)=>(u<x.largestBatchId&&(u=x.largestBatchId),i.get(p)?Fe.resolve():this.remoteDocumentCache.getEntry(e,p).next((y=>{f=f.insert(p,y)}))))).next((()=>this.populateOverlays(e,d,i))).next((()=>this.computeViews(e,f,d,Dt()))).next((p=>({batchId:u,changes:q4(p)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new st(r)).next((n=>{let a=zf();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const i=r.collectionGroup;let o=zf();return this.indexManager.getCollectionParents(e,i).next((u=>Fe.forEach(u,(f=>{const d=(function(x,y){return new Ou(y,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(r,f.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next((p=>{p.forEach(((x,y)=>{o=o.insert(x,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,r,n,a){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,a)))).next((o=>{i.forEach(((f,d)=>{const p=d.getKey();o.get(p)===null&&(o=o.insert(p,jn.newInvalidDocument(p)))}));let u=zf();return o.forEach(((f,d)=>{const p=i.get(f);p!==void 0&&Jf(p.mutation,d,Na.empty(),xr.now()),np(r,d)&&(u=u.insert(f,d))})),u}))}}class z8{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Fe.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(a){return{id:a.id,version:a.version,createTime:Us(a.createTime)}})(r)),Fe.resolve()}getNamedQuery(e,r){return Fe.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(a){return{name:a.name,query:I8(a.bundledQuery),readTime:Us(a.readTime)}})(r)),Fe.resolve()}}class H8{constructor(){this.overlays=new Ar(st.comparator),this.qr=new Map}getOverlay(e,r){return Fe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Fo();return Fe.forEach(r,(a=>this.getOverlay(e,a).next((i=>{i!==null&&n.set(a,i)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((a,i)=>{this.St(e,r,i)})),Fe.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.qr.get(n);return a!==void 0&&(a.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(n)),Fe.resolve()}getOverlaysForCollection(e,r,n){const a=Fo(),i=r.length+1,o=new st(r.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const f=u.getNext().value,d=f.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===i&&f.largestBatchId>n&&a.set(f.getKey(),f)}return Fe.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let i=new Ar(((d,p)=>d-p));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let p=i.get(d.largestBatchId);p===null&&(p=Fo(),i=i.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const u=Fo(),f=i.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((d,p)=>u.set(d,p))),!(u.size()>=a)););return Fe.resolve(u)}St(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const o=this.qr.get(a.largestBatchId).delete(n.key);this.qr.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new l8(r,n));let i=this.qr.get(r);i===void 0&&(i=Dt(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}class G8{constructor(){this.sessionToken=Cn.EMPTY_BYTE_STRING}getSessionToken(e){return Fe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Fe.resolve()}}class kv{constructor(){this.Qr=new cn(mn.$r),this.Ur=new cn(mn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new mn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new mn(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new st(new hr([])),n=new mn(r,e),a=new mn(r,e+1),i=[];return this.Ur.forEachInRange([n,a],(o=>{this.Gr(o),i.push(o.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new st(new hr([])),n=new mn(r,e),a=new mn(r,e+1);let i=Dt();return this.Ur.forEachInRange([n,a],(o=>{i=i.add(o.key)})),i}containsKey(e){const r=new mn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class mn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return st.comparator(e.key,r.key)||It(e.Yr,r.Yr)}static Kr(e,r){return It(e.Yr,r.Yr)||st.comparator(e.key,r.key)}}class q8{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new cn(mn.$r)}checkEmpty(e){return Fe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new i8(i,r,n,a);this.mutationQueue.push(o);for(const u of a)this.Zr=this.Zr.add(new mn(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Fe.resolve(o)}lookupMutationBatch(e,r){return Fe.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.ei(n),i=a<0?0:a;return Fe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Fe.resolve(this.mutationQueue.length===0?vv:this.tr-1)}getAllMutationBatches(e){return Fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new mn(r,0),a=new mn(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,a],(o=>{const u=this.Xr(o.Yr);i.push(u)})),Fe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new cn(It);return r.forEach((a=>{const i=new mn(a,0),o=new mn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],(u=>{n=n.add(u.Yr)}))})),Fe.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let i=n;st.isDocumentKey(i)||(i=i.child(""));const o=new mn(new st(i),0);let u=new cn(It);return this.Zr.forEachWhile((f=>{const d=f.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(u=u.add(f.Yr)),!0)}),o),Fe.resolve(this.ti(u))}ti(e){const r=[];return e.forEach((n=>{const a=this.Xr(n);a!==null&&r.push(a)})),r}removeMutationBatch(e,r){Wt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Fe.forEach(r.mutations,(a=>{const i=new mn(a.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new mn(r,0),a=this.Zr.firstAfterOrEqual(n);return Fe.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Fe.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}class W8{constructor(e){this.ri=e,this.docs=(function(){return new Ar(st.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),i=a?a.size:0,o=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Fe.resolve(n?n.document.mutableCopy():jn.newInvalidDocument(r))}getEntries(e,r){let n=Fi();return r.forEach((a=>{const i=this.docs.get(a);n=n.insert(a,i?i.document.mutableCopy():jn.newInvalidDocument(a))})),Fe.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let i=Fi();const o=r.path,u=new st(o.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:d,value:{document:p}}=f.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||wD(_D(p),n)<=0||(a.has(p.key)||np(r,p))&&(i=i.insert(p.key,p.mutableCopy()))}return Fe.resolve(i)}getAllFromCollectionGroup(e,r,n,a){ct(9500)}ii(e,r){return Fe.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new X8(this)}getSize(e){return Fe.resolve(this.size)}}class X8 extends B8{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?r.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(n)})),Fe.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}class Y8{constructor(e){this.persistence=e,this.si=new tc((r=>wv(r)),bv),this.lastRemoteSnapshotVersion=mt.min(),this.highestTargetId=0,this.oi=0,this._i=new kv,this.targetCount=0,this.ai=yu.ur()}forEachTarget(e,r){return this.si.forEach(((n,a)=>r(a))),Fe.resolve()}getLastRemoteSnapshotVersion(e){return Fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Fe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Fe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Fe.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new yu(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Fe.resolve()}updateTargetData(e,r){return this.Pr(r),Fe.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Fe.resolve()}removeTargets(e,r,n){let a=0;const i=[];return this.si.forEach(((o,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)})),Fe.waitFor(i).next((()=>a))}getTargetCount(e){return Fe.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Fe.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Fe.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const a=this.persistence.referenceDelegate,i=[];return a&&r.forEach((o=>{i.push(a.markPotentiallyOrphaned(e,o))})),Fe.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Fe.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Fe.resolve(n)}containsKey(e,r){return Fe.resolve(this._i.containsKey(r))}}class fA{constructor(e,r){this.ui={},this.overlays={},this.ci=new Jm(0),this.li=!1,this.li=!0,this.hi=new G8,this.referenceDelegate=e(this),this.Pi=new Y8(this),this.indexManager=new D8,this.remoteDocumentCache=(function(a){return new W8(a)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new R8(r),this.Ii=new z8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new H8,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new q8(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Qe("MemoryPersistence","Starting transaction:",e);const a=new $8(this.ci.next());return this.referenceDelegate.Ei(),n(a).next((i=>this.referenceDelegate.di(a).next((()=>i)))).toPromise().then((i=>(a.raiseOnCommittedEvent(),i)))}Ai(e,r){return Fe.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class $8 extends ED{constructor(e){super(),this.currentSequenceNumber=e}}class Cv{constructor(e){this.persistence=e,this.Ri=new kv,this.Vi=null}static mi(e){return new Cv(e)}get fi(){if(this.Vi)return this.Vi;throw ct(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Fe.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Fe.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Fe.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((a=>this.fi.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((a=>{a.forEach((i=>this.fi.add(i.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fe.forEach(this.fi,(n=>{const a=st.fromPath(n);return this.gi(e,a).next((i=>{i||r.removeEntry(a,mt.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return Fe.or([()=>Fe.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class _m{constructor(e,r){this.persistence=e,this.pi=new tc((n=>AD(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=L8(this,r)}static mi(e,r){return new _m(e,r)}Ei(){}di(e){return Fe.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((a=>n+a))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return Fe.forEach(this.pi,((n,a)=>this.br(e,n,a).next((i=>i?Fe.resolve():r(a)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),i=a.newChangeBuffer();return a.ii(e,(o=>this.br(e,o,r).next((u=>{u||(n++,i.removeEntry(o,mt.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Fe.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Fe.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Fe.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Fe.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=em(e.data.value)),r}br(e,r,n){return Fe.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.pi.get(r);return Fe.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Nv{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=a}static As(e,r){let n=Dt(),a=Dt();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:a=a.add(i.doc.key)}return new Nv(e,r.fromCache,n,a)}}class K8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Q8{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return G5()?8:TD(Un())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,a){const i={result:null};return this.ys(e,r).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ws(e,r,a,n).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new K8;return this.Ss(e,r,o).next((u=>{if(i.result=u,this.Vs)return this.bs(e,r,o,u.size)}))})).next((()=>i.result))}bs(e,r,n,a){return n.documentReadCount<this.fs?(Qc()<=Rt.DEBUG&&Qe("QueryEngine","SDK will not create cache indexes for query:",Jc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Fe.resolve()):(Qc()<=Rt.DEBUG&&Qe("QueryEngine","Query:",Jc(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.gs*a?(Qc()<=Rt.DEBUG&&Qe("QueryEngine","The SDK decides to create cache indexes for query:",Jc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Vs(r))):Fe.resolve())}ys(e,r){if(vE(r))return Fe.resolve(null);let n=Vs(r);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(r.limit!==null&&a===1&&(r=Sx(r,null,"F"),n=Vs(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const o=Dt(...i);return this.ps.getDocuments(e,o).next((u=>this.indexManager.getMinOffset(e,n).next((f=>{const d=this.Ds(r,u);return this.Cs(r,d,o,f.readTime)?this.ys(e,Sx(r,null,"F")):this.vs(e,d,r,f)}))))})))))}ws(e,r,n,a){return vE(r)||a.isEqual(mt.min())?Fe.resolve(null):this.ps.getDocuments(e,n).next((i=>{const o=this.Ds(r,i);return this.Cs(r,o,n,a)?Fe.resolve(null):(Qc()<=Rt.DEBUG&&Qe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Jc(r)),this.vs(e,o,r,yD(a,f0)).next((u=>u)))}))}Ds(e,r){let n=new cn(H4(e));return r.forEach(((a,i)=>{np(e,i)&&(n=n.add(i))})),n}Cs(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(a)>0)}Ss(e,r,n){return Qc()<=Rt.DEBUG&&Qe("QueryEngine","Using full collection scan to execute query:",Jc(r)),this.ps.getDocumentsMatchingQuery(e,r,Ll.min(),n)}vs(e,r,n,a){return this.ps.getDocumentsMatchingQuery(e,n,a).next((i=>(r.forEach((o=>{i=i.insert(o.key,o)})),i)))}}const Rv="LocalStore",J8=3e8;class Z8{constructor(e,r,n,a){this.persistence=e,this.Fs=r,this.serializer=a,this.Ms=new Ar(It),this.xs=new tc((i=>wv(i)),bv),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new U8(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function eO(t,e,r,n){return new Z8(t,e,r,n)}async function hA(t,e){const r=gt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next((i=>(a=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((i=>{const o=[],u=[];let f=Dt();for(const d of a){o.push(d.batchId);for(const p of d.mutations)f=f.add(p.key)}for(const d of i){u.push(d.batchId);for(const p of d.mutations)f=f.add(p.key)}return r.localDocuments.getDocuments(n,f).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:u})))}))}))}function tO(t,e){const r=gt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,f,d,p){const x=d.batch,y=x.keys();let w=Fe.resolve();return y.forEach((b=>{w=w.next((()=>p.getEntry(f,b))).next((E=>{const T=d.docVersions.get(b);Wt(T!==null,48541),E.version.compareTo(T)<0&&(x.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),p.addEntry(E)))}))})),w.next((()=>u.mutationQueue.removeMutationBatch(f,x)))})(r,n,e,i).next((()=>i.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let f=Dt();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(f=f.add(u.batch.mutations[d].key));return f})(e)))).next((()=>r.localDocuments.getDocuments(n,a)))}))}function dA(t){const e=gt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function rO(t,e){const r=gt(t),n=e.snapshotVersion;let a=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=r.Ns.newChangeBuffer({trackRemovals:!0});a=r.Ms;const u=[];e.targetChanges.forEach(((p,x)=>{const y=a.get(x);if(!y)return;u.push(r.Pi.removeMatchingKeys(i,p.removedDocuments,x).next((()=>r.Pi.addMatchingKeys(i,p.addedDocuments,x))));let w=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(x)!==null?w=w.withResumeToken(Cn.EMPTY_BYTE_STRING,mt.min()).withLastLimboFreeSnapshotVersion(mt.min()):p.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(p.resumeToken,n)),a=a.insert(x,w),(function(E,T,I){return E.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=J8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0})(y,w,p)&&u.push(r.Pi.updateTargetData(i,w))}));let f=Fi(),d=Dt();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(i,p))})),u.push(nO(i,o,e.documentUpdates).next((p=>{f=p.ks,d=p.qs}))),!n.isEqual(mt.min())){const p=r.Pi.getLastRemoteSnapshotVersion(i).next((x=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n)));u.push(p)}return Fe.waitFor(u).next((()=>o.apply(i))).next((()=>r.localDocuments.getLocalViewOfDocuments(i,f,d))).next((()=>f))})).then((i=>(r.Ms=a,i)))}function nO(t,e,r){let n=Dt(),a=Dt();return r.forEach((i=>n=n.add(i))),e.getEntries(t,n).next((i=>{let o=Fi();return r.forEach(((u,f)=>{const d=i.get(u);f.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(u)),f.isNoDocument()&&f.version.isEqual(mt.min())?(e.removeEntry(u,f.readTime),o=o.insert(u,f)):!d.isValidDocument()||f.version.compareTo(d.version)>0||f.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(f),o=o.insert(u,f)):Qe(Rv,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",f.version)})),{ks:o,qs:a}}))}function aO(t,e){const r=gt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=vv),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function sO(t,e){const r=gt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return r.Pi.getTargetData(n,e).next((i=>i?(a=i,Fe.resolve(a)):r.Pi.allocateTargetId(n).next((o=>(a=new kl(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=r.Ms.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function Rx(t,e,r){const n=gt(t),a=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,(o=>n.persistence.referenceDelegate.removeTarget(o,a)))}catch(o){if(!Du(o))throw o;Qe(Rv,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(a.target)}function IE(t,e,r){const n=gt(t);let a=mt.min(),i=Dt();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(f,d,p){const x=gt(f),y=x.xs.get(p);return y!==void 0?Fe.resolve(x.Ms.get(y)):x.Pi.getTargetData(d,p)})(n,o,Vs(e)).next((u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,u.targetId).next((f=>{i=f}))})).next((()=>n.Fs.getDocumentsMatchingQuery(o,e,r?a:mt.min(),r?i:Dt()))).next((u=>(iO(n,qD(e),u),{documents:u,Qs:i})))))}function iO(t,e,r){let n=t.Os.get(e)||mt.min();r.forEach(((a,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)})),t.Os.set(e,n)}class DE{constructor(){this.activeTargetIds=QD()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lO{constructor(){this.Mo=new DE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new DE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class oO{Oo(e){}shutdown(){}}const OE="ConnectivityMonitor";class FE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Qe(OE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Qe(OE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Fd=null;function Ix(){return Fd===null?Fd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Fd++,"0x"+Fd.toString(16)}const V1="RestConnection",cO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class uO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${a}`,this.Wo=this.databaseId.database===mm?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Go(e,r,n,a,i){const o=Ix(),u=this.zo(e,r.toUriEncodedString());Qe(V1,`Sending RPC '${e}' ${o}:`,u,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,i);const{host:d}=new URL(u),p=Cu(d);return this.Jo(e,u,f,n,p).then((x=>(Qe(V1,`Received RPC '${e}' ${o}: `,x),x)),(x=>{throw pu(V1,`RPC '${e}' ${o} failed with error: `,x,"url: ",u,"request:",n),x}))}Ho(e,r,n,a,i,o){return this.Go(e,r,n,a,i)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ru})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((a,i)=>e[i]=a)),n&&n.headers.forEach(((a,i)=>e[i]=a))}zo(e,r){const n=cO[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}class fO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Dn="WebChannelConnection";class hO extends uO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,a,i){const o=Ix();return new Promise(((u,f)=>{const d=new g4;d.setWithCredentials(!0),d.listenOnce(x4.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Zd.NO_ERROR:const x=d.getResponseJson();Qe(Dn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(x)),u(x);break;case Zd.TIMEOUT:Qe(Dn,`RPC '${e}' ${o} timed out`),f(new $e(De.DEADLINE_EXCEEDED,"Request time out"));break;case Zd.HTTP_ERROR:const y=d.getStatus();if(Qe(Dn,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);const b=w?.error;if(b&&b.status&&b.message){const E=(function(I){const R=I.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(R)>=0?R:De.UNKNOWN})(b.status);f(new $e(E,b.message))}else f(new $e(De.UNKNOWN,"Server responded with status "+d.getStatus()))}else f(new $e(De.UNAVAILABLE,"Connection failed."));break;default:ct(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Qe(Dn,`RPC '${e}' ${o} completed.`)}}));const p=JSON.stringify(a);Qe(Dn,`RPC '${e}' ${o} sending request:`,a),d.send(r,"POST",p,n,15)}))}T_(e,r,n){const a=Ix(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=_4(),u=y4(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,r,n),f.encodeInitMessageHeaders=!0;const p=i.join("");Qe(Dn,`Creating RPC '${e}' stream ${a}: ${p}`,f);const x=o.createWebChannel(p,f);this.I_(x);let y=!1,w=!1;const b=new fO({Yo:T=>{w?Qe(Dn,`Not sending because RPC '${e}' stream ${a} is closed:`,T):(y||(Qe(Dn,`Opening RPC '${e}' stream ${a} transport.`),x.open(),y=!0),Qe(Dn,`RPC '${e}' stream ${a} sending:`,T),x.send(T))},Zo:()=>x.close()}),E=(T,I,R)=>{T.listen(I,(C=>{try{R(C)}catch(z){setTimeout((()=>{throw z}),0)}}))};return E(x,Uf.EventType.OPEN,(()=>{w||(Qe(Dn,`RPC '${e}' stream ${a} transport opened.`),b.o_())})),E(x,Uf.EventType.CLOSE,(()=>{w||(w=!0,Qe(Dn,`RPC '${e}' stream ${a} transport closed`),b.a_(),this.E_(x))})),E(x,Uf.EventType.ERROR,(T=>{w||(w=!0,pu(Dn,`RPC '${e}' stream ${a} transport errored. Name:`,T.name,"Message:",T.message),b.a_(new $e(De.UNAVAILABLE,"The operation could not be completed")))})),E(x,Uf.EventType.MESSAGE,(T=>{if(!w){const I=T.data[0];Wt(!!I,16349);const R=I,C=R?.error||R[0]?.error;if(C){Qe(Dn,`RPC '${e}' stream ${a} received error:`,C);const z=C.status;let H=(function(F){const N=Jr[F];if(N!==void 0)return eA(N)})(z),X=C.message;H===void 0&&(H=De.INTERNAL,X="Unknown error status: "+z+" with message "+C.message),w=!0,b.a_(new $e(H,X)),x.close()}else Qe(Dn,`RPC '${e}' stream ${a} received:`,I),b.u_(I)}})),E(u,v4.STAT_EVENT,(T=>{T.stat===vx.PROXY?Qe(Dn,`RPC '${e}' stream ${a} detected buffering proxy`):T.stat===vx.NOPROXY&&Qe(Dn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{b.__()}),0),b}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function U1(){return typeof document<"u"?document:null}function op(t){return new g8(t,!0)}class mA{constructor(e,r,n=1e3,a=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=a,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,r-n);a>0&&Qe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const ME="PersistentStream";class pA{constructor(e,r,n,a,i,o,u,f){this.Mi=e,this.S_=n,this.b_=a,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new mA(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===De.RESOURCE_EXHAUSTED?(Oi(r.toString()),Oi("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===r&&this.G_(n,a)}),(n=>{e((()=>{const a=new $e(De.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Qe(ME,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(Qe(ME,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dO extends pA{constructor(e,r,n,a,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,o),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=y8(this.serializer,e),n=(function(i){if(!("targetChange"in i))return mt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?mt.min():o.readTime?Us(o.readTime):mt.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=Nx(this.serializer),r.addTarget=(function(i,o){let u;const f=o.target;if(u=Ex(f)?{documents:b8(i,f)}:{query:E8(i,f).ft},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=nA(i,o.resumeToken);const d=Ax(i,o.expectedCount);d!==null&&(u.expectedCount=d)}else if(o.snapshotVersion.compareTo(mt.min())>0){u.readTime=ym(i,o.snapshotVersion.toTimestamp());const d=Ax(i,o.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);const n=S8(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=Nx(this.serializer),r.removeTarget=e,this.q_(r)}}class mO extends pA{constructor(e,r,n,a,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Wt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Wt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Wt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=w8(e.writeResults,e.commitTime),n=Us(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=Nx(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>_8(this.serializer,n)))};this.q_(r)}}class pO{}class gO extends pO{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new $e(De.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Go(e,kx(r,n),a,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new $e(De.UNKNOWN,i.toString())}))}Ho(e,r,n,a,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.Ho(e,kx(r,n),a,o,u,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $e(De.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class xO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Oi(r),this.aa=!1):Qe("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Wo="RemoteStore";class vO{constructor(e,r,n,a,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((o=>{n.enqueueAndForget((async()=>{rc(this)&&(Qe(Wo,"Restarting streams for network reachability change."),await(async function(f){const d=gt(f);d.Ea.add(4),await z0(d),d.Ra.set("Unknown"),d.Ea.delete(4),await cp(d)})(this))}))})),this.Ra=new xO(n,a)}}async function cp(t){if(rc(t))for(const e of t.da)await e(!0)}async function z0(t){for(const e of t.da)await e(!1)}function gA(t,e){const r=gt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Fv(r)?Ov(r):Fu(r).O_()&&Dv(r,e))}function Iv(t,e){const r=gt(t),n=Fu(r);r.Ia.delete(e),n.O_()&&xA(r,e),r.Ia.size===0&&(n.O_()?n.L_():rc(r)&&r.Ra.set("Unknown"))}function Dv(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(mt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Fu(t).Y_(e)}function xA(t,e){t.Va.Ue(e),Fu(t).Z_(e)}function Ov(t){t.Va=new h8({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Fu(t).start(),t.Ra.ua()}function Fv(t){return rc(t)&&!Fu(t).x_()&&t.Ia.size>0}function rc(t){return gt(t).Ea.size===0}function vA(t){t.Va=void 0}async function yO(t){t.Ra.set("Online")}async function _O(t){t.Ia.forEach(((e,r)=>{Dv(t,e)}))}async function wO(t,e){vA(t),Fv(t)?(t.Ra.ha(e),Ov(t)):t.Ra.set("Unknown")}async function bO(t,e,r){if(t.Ra.set("Online"),e instanceof rA&&e.state===2&&e.cause)try{await(async function(a,i){const o=i.cause;for(const u of i.targetIds)a.Ia.has(u)&&(await a.remoteSyncer.rejectListen(u,o),a.Ia.delete(u),a.Va.removeTarget(u))})(t,e)}catch(n){Qe(Wo,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await wm(t,n)}else if(e instanceof nm?t.Va.Ze(e):e instanceof tA?t.Va.st(e):t.Va.tt(e),!r.isEqual(mt.min()))try{const n=await dA(t.localStore);r.compareTo(n)>=0&&await(function(i,o){const u=i.Va.Tt(o);return u.targetChanges.forEach(((f,d)=>{if(f.resumeToken.approximateByteSize()>0){const p=i.Ia.get(d);p&&i.Ia.set(d,p.withResumeToken(f.resumeToken,o))}})),u.targetMismatches.forEach(((f,d)=>{const p=i.Ia.get(f);if(!p)return;i.Ia.set(f,p.withResumeToken(Cn.EMPTY_BYTE_STRING,p.snapshotVersion)),xA(i,f);const x=new kl(p.target,f,d,p.sequenceNumber);Dv(i,x)})),i.remoteSyncer.applyRemoteEvent(u)})(t,r)}catch(n){Qe(Wo,"Failed to raise snapshot:",n),await wm(t,n)}}async function wm(t,e,r){if(!Du(e))throw e;t.Ea.add(1),await z0(t),t.Ra.set("Offline"),r||(r=()=>dA(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Qe(Wo,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await cp(t)}))}function yA(t,e){return e().catch((r=>wm(t,r,e)))}async function up(t){const e=gt(t),r=zl(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vv;for(;EO(e);)try{const a=await aO(e.localStore,n);if(a===null){e.Ta.length===0&&r.L_();break}n=a.batchId,TO(e,a)}catch(a){await wm(e,a)}_A(e)&&wA(e)}function EO(t){return rc(t)&&t.Ta.length<10}function TO(t,e){t.Ta.push(e);const r=zl(t);r.O_()&&r.X_&&r.ea(e.mutations)}function _A(t){return rc(t)&&!zl(t).x_()&&t.Ta.length>0}function wA(t){zl(t).start()}async function SO(t){zl(t).ra()}async function AO(t){const e=zl(t);for(const r of t.Ta)e.ea(r.mutations)}async function kO(t,e,r){const n=t.Ta.shift(),a=Tv.from(n,e,r);await yA(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await up(t)}async function CO(t,e){e&&zl(t).X_&&await(async function(n,a){if((function(o){return c8(o)&&o!==De.ABORTED})(a.code)){const i=n.Ta.shift();zl(n).B_(),await yA(n,(()=>n.remoteSyncer.rejectFailedWrite(i.batchId,a))),await up(n)}})(t,e),_A(t)&&wA(t)}async function PE(t,e){const r=gt(t);r.asyncQueue.verifyOperationInProgress(),Qe(Wo,"RemoteStore received new credentials");const n=rc(r);r.Ea.add(3),await z0(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await cp(r)}async function NO(t,e){const r=gt(t);e?(r.Ea.delete(2),await cp(r)):e||(r.Ea.add(2),await z0(r),r.Ra.set("Unknown"))}function Fu(t){return t.ma||(t.ma=(function(r,n,a){const i=gt(r);return i.sa(),new dO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(t.datastore,t.asyncQueue,{Xo:yO.bind(null,t),t_:_O.bind(null,t),r_:wO.bind(null,t),H_:bO.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Fv(t)?Ov(t):t.Ra.set("Unknown")):(await t.ma.stop(),vA(t))}))),t.ma}function zl(t){return t.fa||(t.fa=(function(r,n,a){const i=gt(r);return i.sa(),new mO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:SO.bind(null,t),r_:CO.bind(null,t),ta:AO.bind(null,t),na:kO.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await up(t)):(await t.fa.stop(),t.Ta.length>0&&(Qe(Wo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class Mv{constructor(e,r,n,a,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=i,this.deferred=new ki,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,i){const o=Date.now()+n,u=new Mv(e,r,o,a,i);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $e(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pv(t,e){if(Oi("AsyncQueue",`${e}: ${t}`),Du(t))return new $e(De.UNAVAILABLE,`${e}: ${t}`);throw t}class au{static emptySet(e){return new au(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||st.comparator(r.key,n.key):(r,n)=>st.comparator(r.key,n.key),this.keyedMap=zf(),this.sortedSet=new Ar(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof au)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,i=n.getNext().key;if(!a.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new au;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}class jE{constructor(){this.ga=new Ar(st.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ct(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class _u{constructor(e,r,n,a,i,o,u,f,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,a,i){const o=[];return r.forEach((u=>{o.push({type:0,doc:u})})),new _u(e,r,au.emptySet(r),o,n,a,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&rp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}class RO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class IO{constructor(){this.queries=LE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const a=gt(r),i=a.queries;a.queries=LE(),i.forEach(((o,u)=>{for(const f of u.Sa)f.onError(n)}))})(this,new $e(De.ABORTED,"Firestore shutting down"))}}function LE(){return new tc((t=>z4(t)),rp)}async function jv(t,e){const r=gt(t);let n=3;const a=e.query;let i=r.queries.get(a);i?!i.ba()&&e.Da()&&(n=2):(i=new RO,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(a,!0);break;case 1:i.wa=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(o){const u=Pv(o,`Initialization of query '${Jc(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&Bv(r)}async function Lv(t,e){const r=gt(t),n=e.query;let a=3;const i=r.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?a=e.Da()?0:1:!i.ba()&&e.Da()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function DO(t,e){const r=gt(t);let n=!1;for(const a of e){const i=a.query,o=r.queries.get(i);if(o){for(const u of o.Sa)u.Fa(a)&&(n=!0);o.wa=a}}n&&Bv(r)}function OO(t,e,r){const n=gt(t),a=n.queries.get(e);if(a)for(const i of a.Sa)i.onError(r);n.queries.delete(e)}function Bv(t){t.Ca.forEach((e=>{e.next()}))}var Dx,BE;(BE=Dx||(Dx={})).Ma="default",BE.Cache="cache";class Vv{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new _u(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=_u.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Dx.Cache}}class bA{constructor(e){this.key=e}}class EA{constructor(e){this.key=e}}class FO{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Dt(),this.mutatedKeys=Dt(),this.eu=H4(e),this.tu=new au(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new jE,a=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,o=a,u=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((p,x)=>{const y=a.get(p),w=np(this.query,x)?x:null,b=!!y&&this.mutatedKeys.has(y.key),E=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let T=!1;y&&w?y.data.isEqual(w.data)?b!==E&&(n.track({type:3,doc:w}),T=!0):this.su(y,w)||(n.track({type:2,doc:w}),T=!0,(f&&this.eu(w,f)>0||d&&this.eu(w,d)<0)&&(u=!0)):!y&&w?(n.track({type:0,doc:w}),T=!0):y&&!w&&(n.track({type:1,doc:y}),T=!0,(f||d)&&(u=!0)),T&&(w?(o=o.add(w),i=E?i.add(p):i.delete(p)):(o=o.delete(p),i=i.delete(p)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),i=i.delete(p.key),n.track({type:1,doc:p})}return{tu:o,iu:n,Cs:u,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((p,x)=>(function(w,b){const E=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ct(20277,{Rt:T})}};return E(w)-E(b)})(p.type,x.type)||this.eu(p.doc,x.doc))),this.ou(n),a=a??!1;const u=r&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,d=f!==this.Za;return this.Za=f,o.length!==0||d?{snapshot:new _u(this.query,e.tu,i,o,e.mutatedKeys,f===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new jE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Dt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new EA(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new bA(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=Dt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return _u.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Uv="SyncEngine";class MO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class PO{constructor(e){this.key=e,this.hu=!1}}class jO{constructor(e,r,n,a,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new tc((u=>z4(u)),rp),this.Iu=new Map,this.Eu=new Set,this.du=new Ar(st.comparator),this.Au=new Map,this.Ru=new kv,this.Vu={},this.mu=new Map,this.fu=yu.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function LO(t,e,r=!0){const n=NA(t);let a;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.lu()):a=await TA(n,e,r,!0),a}async function BO(t,e){const r=NA(t);await TA(r,e,!0,!1)}async function TA(t,e,r,n){const a=await sO(t.localStore,Vs(e)),i=a.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let u;return n&&(u=await VO(t,e,i,o==="current",a.resumeToken)),t.isPrimaryClient&&r&&gA(t.remoteStore,a),u}async function VO(t,e,r,n,a){t.pu=(x,y,w)=>(async function(E,T,I,R){let C=T.view.ru(I);C.Cs&&(C=await IE(E.localStore,T.query,!1).then((({documents:A})=>T.view.ru(A,C))));const z=R&&R.targetChanges.get(T.targetId),H=R&&R.targetMismatches.get(T.targetId)!=null,X=T.view.applyChanges(C,E.isPrimaryClient,z,H);return UE(E,T.targetId,X.au),X.snapshot})(t,x,y,w);const i=await IE(t.localStore,e,!0),o=new FO(e,i.Qs),u=o.ru(i.documents),f=U0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),d=o.applyChanges(u,t.isPrimaryClient,f);UE(t,r,d.au);const p=new MO(e,r,o);return t.Tu.set(e,p),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),d.snapshot}async function UO(t,e,r){const n=gt(t),a=n.Tu.get(e),i=n.Iu.get(a.targetId);if(i.length>1)return n.Iu.set(a.targetId,i.filter((o=>!rp(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Rx(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),r&&Iv(n.remoteStore,a.targetId),Ox(n,a.targetId)})).catch(Iu)):(Ox(n,a.targetId),await Rx(n.localStore,a.targetId,!0))}async function zO(t,e){const r=gt(t),n=r.Tu.get(e),a=r.Iu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Iv(r.remoteStore,n.targetId))}async function HO(t,e,r){const n=KO(t);try{const a=await(function(o,u){const f=gt(o),d=xr.now(),p=u.reduce(((w,b)=>w.add(b.key)),Dt());let x,y;return f.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let b=Fi(),E=Dt();return f.Ns.getEntries(w,p).next((T=>{b=T,b.forEach(((I,R)=>{R.isValidDocument()||(E=E.add(I))}))})).next((()=>f.localDocuments.getOverlayedDocuments(w,b))).next((T=>{x=T;const I=[];for(const R of u){const C=a8(R,x.get(R.key).overlayedDocument);C!=null&&I.push(new Zl(R.key,C,F4(C.value.mapValue),Jn.exists(!0)))}return f.mutationQueue.addMutationBatch(w,d,I,u)})).next((T=>{y=T;const I=T.applyToLocalDocumentSet(x,E);return f.documentOverlayCache.saveOverlays(w,T.batchId,I)}))})).then((()=>({batchId:y.batchId,changes:q4(x)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(o,u,f){let d=o.Vu[o.currentUser.toKey()];d||(d=new Ar(It)),d=d.insert(u,f),o.Vu[o.currentUser.toKey()]=d})(n,a.batchId,r),await H0(n,a.changes),await up(n.remoteStore)}catch(a){const i=Pv(a,"Failed to persist write");r.reject(i)}}async function SA(t,e){const r=gt(t);try{const n=await rO(r.localStore,e);e.targetChanges.forEach(((a,i)=>{const o=r.Au.get(i);o&&(Wt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?o.hu=!0:a.modifiedDocuments.size>0?Wt(o.hu,14607):a.removedDocuments.size>0&&(Wt(o.hu,42227),o.hu=!1))})),await H0(r,n,e)}catch(n){await Iu(n)}}function VE(t,e,r){const n=gt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Tu.forEach(((i,o)=>{const u=o.view.va(e);u.snapshot&&a.push(u.snapshot)})),(function(o,u){const f=gt(o);f.onlineState=u;let d=!1;f.queries.forEach(((p,x)=>{for(const y of x.Sa)y.va(u)&&(d=!0)})),d&&Bv(f)})(n.eventManager,e),a.length&&n.Pu.H_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function GO(t,e,r){const n=gt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Au.get(e),i=a&&a.key;if(i){let o=new Ar(st.comparator);o=o.insert(i,jn.newNoDocument(i,mt.min()));const u=Dt().add(i),f=new lp(mt.min(),new Map,new Ar(It),o,u);await SA(n,f),n.du=n.du.remove(i),n.Au.delete(e),zv(n)}else await Rx(n.localStore,e,!1).then((()=>Ox(n,e,r))).catch(Iu)}async function qO(t,e){const r=gt(t),n=e.batch.batchId;try{const a=await tO(r.localStore,e);kA(r,n,null),AA(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await H0(r,a)}catch(a){await Iu(a)}}async function WO(t,e,r){const n=gt(t);try{const a=await(function(o,u){const f=gt(o);return f.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let p;return f.mutationQueue.lookupMutationBatch(d,u).next((x=>(Wt(x!==null,37113),p=x.keys(),f.mutationQueue.removeMutationBatch(d,x)))).next((()=>f.mutationQueue.performConsistencyCheck(d))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(d,p,u))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p))).next((()=>f.localDocuments.getDocuments(d,p)))}))})(n.localStore,e);kA(n,e,r),AA(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await H0(n,a)}catch(a){await Iu(a)}}function AA(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function kA(t,e,r){const n=gt(t);let a=n.Vu[n.currentUser.toKey()];if(a){const i=a.get(e);i&&(r?i.reject(r):i.resolve(),a=a.remove(e)),n.Vu[n.currentUser.toKey()]=a}}function Ox(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||CA(t,n)}))}function CA(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Iv(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),zv(t))}function UE(t,e,r){for(const n of r)n instanceof bA?(t.Ru.addReference(n.key,e),XO(t,n)):n instanceof EA?(Qe(Uv,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||CA(t,n.key)):ct(19791,{wu:n})}function XO(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Qe(Uv,"New document in limbo: "+r),t.Eu.add(n),zv(t))}function zv(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new st(hr.fromString(e)),n=t.fu.next();t.Au.set(n,new PO(r)),t.du=t.du.insert(r,n),gA(t.remoteStore,new kl(Vs(tp(r.path)),n,"TargetPurposeLimboResolution",Jm.ce))}}async function H0(t,e,r){const n=gt(t),a=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,f)=>{o.push(n.pu(f,e,r).then((d=>{if((d||r)&&n.isPrimaryClient){const p=d?!d.fromCache:r?.targetChanges.get(f.targetId)?.current;n.sharedClientState.updateQueryState(f.targetId,p?"current":"not-current")}if(d){a.push(d);const p=Nv.As(f.targetId,d);i.push(p)}})))})),await Promise.all(o),n.Pu.H_(a),await(async function(f,d){const p=gt(f);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>Fe.forEach(d,(y=>Fe.forEach(y.Es,(w=>p.persistence.referenceDelegate.addReference(x,y.targetId,w))).next((()=>Fe.forEach(y.ds,(w=>p.persistence.referenceDelegate.removeReference(x,y.targetId,w)))))))))}catch(x){if(!Du(x))throw x;Qe(Rv,"Failed to update sequence numbers: "+x)}for(const x of d){const y=x.targetId;if(!x.fromCache){const w=p.Ms.get(y),b=w.snapshotVersion,E=w.withLastLimboFreeSnapshotVersion(b);p.Ms=p.Ms.insert(y,E)}}})(n.localStore,i))}async function YO(t,e){const r=gt(t);if(!r.currentUser.isEqual(e)){Qe(Uv,"User change. New user:",e.toKey());const n=await hA(r.localStore,e);r.currentUser=e,(function(i,o){i.mu.forEach((u=>{u.forEach((f=>{f.reject(new $e(De.CANCELLED,o))}))})),i.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await H0(r,n.Ls)}}function $O(t,e){const r=gt(t),n=r.Au.get(e);if(n&&n.hu)return Dt().add(n.key);{let a=Dt();const i=r.Iu.get(e);if(!i)return a;for(const o of i){const u=r.Tu.get(o);a=a.unionWith(u.view.nu)}return a}}function NA(t){const e=gt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=SA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$O.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=GO.bind(null,e),e.Pu.H_=DO.bind(null,e.eventManager),e.Pu.yu=OO.bind(null,e.eventManager),e}function KO(t){const e=gt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WO.bind(null,e),e}class bm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=op(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return eO(this.persistence,new Q8,e.initialUser,this.serializer)}Cu(e){return new fA(Cv.mi,this.serializer)}Du(e){return new lO}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bm.provider={build:()=>new bm};class QO extends bm{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Wt(this.persistence.referenceDelegate instanceof _m,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new P8(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?oa.withCacheSize(this.cacheSizeBytes):oa.DEFAULT;return new fA((n=>_m.mi(n,r)),this.serializer)}}class Fx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>VE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=YO.bind(null,this.syncEngine),await NO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new IO})()}createDatastore(e){const r=op(e.databaseInfo.databaseId),n=(function(i){return new hO(i)})(e.databaseInfo);return(function(i,o,u,f){return new gO(i,o,u,f)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,a,i,o,u){return new vO(n,a,i,o,u)})(this.localStore,this.datastore,e.asyncQueue,(r=>VE(this.syncEngine,r,0)),(function(){return FE.v()?new FE:new oO})())}createSyncEngine(e,r){return(function(a,i,o,u,f,d,p){const x=new jO(a,i,o,u,f,d);return p&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){const n=gt(r);Qe(Wo,"RemoteStore shutting down."),n.Ea.add(5),await z0(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Fx.provider={build:()=>new Fx};class Hv{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Oi("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}const Hl="FirestoreClient";class JO{constructor(e,r,n,a,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Fn.UNAUTHENTICATED,this.clientId=xv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async o=>{Qe(Hl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(Qe(Hl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ki;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Pv(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function z1(t,e){t.asyncQueue.verifyOperationInProgress(),Qe(Hl,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async a=>{n.isEqual(a)||(await hA(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function zE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await ZO(t);Qe(Hl,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>PE(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,a)=>PE(e.remoteStore,a))),t._onlineComponents=e}async function ZO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Qe(Hl,"Using user provided OfflineComponentProvider");try{await z1(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(a){return a.name==="FirebaseError"?a.code===De.FAILED_PRECONDITION||a.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(r))throw r;pu("Error using user provided cache. Falling back to memory cache: "+r),await z1(t,new bm)}}else Qe(Hl,"Using default OfflineComponentProvider"),await z1(t,new QO(void 0));return t._offlineComponents}async function RA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Qe(Hl,"Using user provided OnlineComponentProvider"),await zE(t,t._uninitializedComponentsProvider._online)):(Qe(Hl,"Using default OnlineComponentProvider"),await zE(t,new Fx))),t._onlineComponents}function e9(t){return RA(t).then((e=>e.syncEngine))}async function Em(t){const e=await RA(t),r=e.eventManager;return r.onListen=LO.bind(null,e.syncEngine),r.onUnlisten=UO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=BO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=zO.bind(null,e.syncEngine),r}function t9(t,e,r={}){const n=new ki;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,u,f,d){const p=new Hv({next:y=>{p.Nu(),o.enqueueAndForget((()=>Lv(i,x)));const w=y.docs.has(u);!w&&y.fromCache?d.reject(new $e(De.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&y.fromCache&&f&&f.source==="server"?d.reject(new $e(De.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(y)},error:y=>d.reject(y)}),x=new Vv(tp(u.path),p,{includeMetadataChanges:!0,qa:!0});return jv(i,x)})(await Em(t),t.asyncQueue,e,r,n))),n.promise}function r9(t,e,r={}){const n=new ki;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,u,f,d){const p=new Hv({next:y=>{p.Nu(),o.enqueueAndForget((()=>Lv(i,x))),y.fromCache&&f.source==="server"?d.reject(new $e(De.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),x=new Vv(u,p,{includeMetadataChanges:!0,qa:!0});return jv(i,x)})(await Em(t),t.asyncQueue,e,r,n))),n.promise}function IA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const HE=new Map;const DA="firestore.googleapis.com",GE=!0;class qE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new $e(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=DA,this.ssl=GE}else this.host=e.host,this.ssl=e.ssl??GE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=uA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<F8)throw new $e(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=IA(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new $e(De.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new $e(De.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new $e(De.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class fp{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new qE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $e(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $e(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new qE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new oD;switch(n.type){case"firstParty":return new hD(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new $e(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=HE.get(r);n&&(Qe("ComponentProvider","Removing Datastore"),HE.delete(r),n.terminate())})(this),Promise.resolve()}}function n9(t,e,r,n={}){t=Qn(t,fp);const a=Cu(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},u=`${e}:${r}`;a&&(l4(`https://${u}`),o4("Firestore",!0)),i.host!==DA&&i.host!==u&&pu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...i,host:u,ssl:a,emulatorOptions:n};if(!Ho(f,o)&&(t._setSettings(f),n.mockUserToken)){let d,p;if(typeof n.mockUserToken=="string")d=n.mockUserToken,p=Fn.MOCK_USER;else{d=M5(n.mockUserToken,t._app?.options.projectId);const x=n.mockUserToken.sub||n.mockUserToken.user_id;if(!x)throw new $e(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Fn(x)}t._authCredentials=new cD(new b4(d,p))}}class eo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new eo(this.firestore,e,this._query)}}class Ir{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ml(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ir(this.firestore,e,this._key)}toJSON(){return{type:Ir._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(B0(r,Ir._jsonSchema))return new Ir(e,n||null,new st(hr.fromString(r.referencePath)))}}Ir._jsonSchemaVersion="firestore/documentReference/1.0",Ir._jsonSchema={type:nn("string",Ir._jsonSchemaVersion),referencePath:nn("string")};class Ml extends eo{constructor(e,r,n){super(e,r,tp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ir(this.firestore,null,new st(e))}withConverter(e){return new Ml(this.firestore,e,this._path)}}function qt(t,e,...r){if(t=un(t),E4("collection","path",e),t instanceof fp){const n=hr.fromString(e,...r);return aE(n),new Ml(t,null,n)}{if(!(t instanceof Ir||t instanceof Ml))throw new $e(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(hr.fromString(e,...r));return aE(n),new Ml(t.firestore,null,n)}}function yt(t,e,...r){if(t=un(t),arguments.length===1&&(e=xv.newId()),E4("doc","path",e),t instanceof fp){const n=hr.fromString(e,...r);return nE(n),new Ir(t,null,new st(n))}{if(!(t instanceof Ir||t instanceof Ml))throw new $e(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(hr.fromString(e,...r));return nE(n),new Ir(t.firestore,t instanceof Ml?t.converter:null,new st(n))}}const WE="AsyncQueue";class XE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new mA(this,"async_queue_retry"),this._c=()=>{const n=U1();n&&Qe(WE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=U1();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=U1();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new ki;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Du(e))throw e;Qe(WE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Oi("INTERNAL UNHANDLED ERROR: ",YE(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const a=Mv.createAndSchedule(this,e,r,n,(i=>this.hc(i)));return this.tc.push(a),a}uc(){this.nc&&ct(47125,{Pc:YE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function YE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function $E(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const i of n)if(i in a&&typeof a[i]=="function")return!0;return!1})(t,["next","error","complete"])}class Ys extends fp{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new XE,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new XE(e),this._firestoreClient=void 0,await e}}}function a9(t,e){const r=typeof t=="object"?t:h4(),n=typeof t=="string"?t:mm,a=pv(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const i=O5("firestore");i&&n9(a,...i)}return a}function G0(t){if(t._terminated)throw new $e(De.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||s9(t),t._firestoreClient}function s9(t){const e=t._freezeSettings(),r=(function(a,i,o,u){return new ND(a,i,o,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,IA(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new JO(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(a){const i=a?._online.build();return{_offline:a?._offline.build(i),_online:i}})(t._componentsProvider))}class Qa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qa(Cn.fromBase64String(e))}catch(r){throw new $e(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Qa(Cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Qa._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(B0(e,Qa._jsonSchema))return Qa.fromBase64String(e.bytes)}}Qa._jsonSchemaVersion="firestore/bytes/1.0",Qa._jsonSchema={type:nn("string",Qa._jsonSchemaVersion),bytes:nn("string")};class q0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new $e(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new An(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Gv{constructor(e){this._methodName=e}}class zs{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new $e(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new $e(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return It(this._lat,e._lat)||It(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:zs._jsonSchemaVersion}}static fromJSON(e){if(B0(e,zs._jsonSchema))return new zs(e.latitude,e.longitude)}}zs._jsonSchemaVersion="firestore/geoPoint/1.0",zs._jsonSchema={type:nn("string",zs._jsonSchemaVersion),latitude:nn("number"),longitude:nn("number")};class Hs{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==a[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Hs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(B0(e,Hs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new Hs(e.vectorValues);throw new $e(De.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Hs._jsonSchemaVersion="firestore/vectorValue/1.0",Hs._jsonSchema={type:nn("string",Hs._jsonSchemaVersion),vectorValues:nn("object")};const i9=/^__.*__$/;class l9{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Zl(e,this.data,this.fieldMask,r,this.fieldTransforms):new V0(e,this.data,r,this.fieldTransforms)}}class OA{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Zl(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function FA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ct(40011,{Ac:t})}}class qv{constructor(e,r,n,a,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new qv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Tm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(FA(this.Ac)&&i9.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class o9{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||op(e)}Cc(e,r,n,a=!1){return new qv({Ac:e,methodName:r,Dc:n,path:An.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function W0(t){const e=t._freezeSettings(),r=op(t._databaseId);return new o9(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Wv(t,e,r,n,a,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,r,a);Xv("Data must be an object, but it was:",o,n);const u=jA(n,o);let f,d;if(i.merge)f=new Na(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const p=[];for(const x of i.mergeFields){const y=Mx(e,x,r);if(!o.contains(y))throw new $e(De.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);BA(p,y)||p.push(y)}f=new Na(p),d=o.fieldTransforms.filter((x=>f.covers(x.field)))}else f=null,d=o.fieldTransforms;return new l9(new ua(u),f,d)}class hp extends Gv{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof hp}}function MA(t,e,r,n){const a=t.Cc(1,e,r);Xv("Data must be an object, but it was:",a,n);const i=[],o=ua.empty();Jl(n,((f,d)=>{const p=Yv(e,f,r);d=un(d);const x=a.yc(p);if(d instanceof hp)i.push(p);else{const y=X0(d,x);y!=null&&(i.push(p),o.set(p,y))}}));const u=new Na(i);return new OA(o,u,a.fieldTransforms)}function PA(t,e,r,n,a,i){const o=t.Cc(1,e,r),u=[Mx(e,n,r)],f=[a];if(i.length%2!=0)throw new $e(De.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)u.push(Mx(e,i[y])),f.push(i[y+1]);const d=[],p=ua.empty();for(let y=u.length-1;y>=0;--y)if(!BA(d,u[y])){const w=u[y];let b=f[y];b=un(b);const E=o.yc(w);if(b instanceof hp)d.push(w);else{const T=X0(b,E);T!=null&&(d.push(w),p.set(w,T))}}const x=new Na(d);return new OA(p,x,o.fieldTransforms)}function c9(t,e,r,n=!1){return X0(r,t.Cc(n?4:3,e))}function X0(t,e){if(LA(t=un(t)))return Xv("Unsupported field value:",e,t),jA(t,e);if(t instanceof Gv)return(function(n,a){if(!FA(a.Ac))throw a.Sc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(a);i&&a.fieldTransforms.push(i)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,a){const i=[];let o=0;for(const u of n){let f=X0(u,a.wc(o));f==null&&(f={nullValue:"NULL_VALUE"}),i.push(f),o++}return{arrayValue:{values:i}}})(t,e)}return(function(n,a){if((n=un(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return JD(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=xr.fromDate(n);return{timestampValue:ym(a.serializer,i)}}if(n instanceof xr){const i=new xr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:ym(a.serializer,i)}}if(n instanceof zs)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Qa)return{bytesValue:nA(a.serializer,n._byteString)};if(n instanceof Ir){const i=a.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw a.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Av(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Hs)return(function(o,u){return{mapValue:{fields:{[D4]:{stringValue:O4},[pm]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw u.Sc("VectorValues must only contain numeric values.");return Ev(u.serializer,d)}))}}}}}})(n,a);throw a.Sc(`Unsupported field value: ${Qm(n)}`)})(t,e)}function jA(t,e){const r={};return A4(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jl(t,((n,a)=>{const i=X0(a,e.mc(n));i!=null&&(r[n]=i)})),{mapValue:{fields:r}}}function LA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xr||t instanceof zs||t instanceof Qa||t instanceof Ir||t instanceof Gv||t instanceof Hs)}function Xv(t,e,r){if(!LA(r)||!T4(r)){const n=Qm(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Mx(t,e,r){if((e=un(e))instanceof q0)return e._internalPath;if(typeof e=="string")return Yv(t,e);throw Tm("Field path arguments must be of type string or ",t,!1,void 0,r)}const u9=new RegExp("[~\\*/\\[\\]]");function Yv(t,e,r){if(e.search(u9)>=0)throw Tm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new q0(...e.split("."))._internalPath}catch{throw Tm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Tm(t,e,r,n,a){const i=n&&!n.isEmpty(),o=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(i||o)&&(f+=" (found",i&&(f+=` in field ${n}`),o&&(f+=` in document ${a}`),f+=")"),new $e(De.INVALID_ARGUMENT,u+t+f)}function BA(t,e){return t.some((r=>r.isEqual(e)))}class VA{constructor(e,r,n,a,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ir(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new f9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(dp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class f9 extends VA{data(){return super.data()}}function dp(t,e){return typeof e=="string"?Yv(t,e):e instanceof q0?e._internalPath:e._delegate._internalPath}function UA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $e(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class $v{}class zA extends $v{}function Px(t,e,...r){let n=[];e instanceof $v&&n.push(e),n=n.concat(r),(function(i){const o=i.filter((f=>f instanceof Kv)).length,u=i.filter((f=>f instanceof mp)).length;if(o>1||o>0&&u>0)throw new $e(De.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const a of n)t=a._apply(t);return t}class mp extends zA{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new mp(e,r,n)}_apply(e){const r=this._parse(e);return GA(e._query,r),new eo(e.firestore,e.converter,Tx(e._query,r))}_parse(e){const r=W0(e.firestore);return(function(i,o,u,f,d,p,x){let y;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new $e(De.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){QE(x,p);const b=[];for(const E of x)b.push(KE(f,i,E));y={arrayValue:{values:b}}}else y=KE(f,i,x)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||QE(x,p),y=c9(u,o,x,p==="in"||p==="not-in");return rn.create(d,p,y)})(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function HA(t,e,r){const n=e,a=dp("where",t);return mp._create(a,n,r)}class Kv extends $v{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Kv(e,r)}_parse(e){const r=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return r.length===1?r[0]:Es.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:((function(a,i){let o=a;const u=i.getFlattenedFilters();for(const f of u)GA(o,f),o=Tx(o,f)})(e._query,r),new eo(e.firestore,e.converter,Tx(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Qv extends zA{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Qv(e,r)}_apply(e){const r=(function(a,i,o){if(a.startAt!==null)throw new $e(De.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new $e(De.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new p0(i,o)})(e._query,this._field,this._direction);return new eo(e.firestore,e.converter,(function(a,i){const o=a.explicitOrderBy.concat([i]);return new Ou(a.path,a.collectionGroup,o,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,r))}}function h9(t,e="asc"){const r=e,n=dp("orderBy",t);return Qv._create(n,r)}function KE(t,e,r){if(typeof(r=un(r))=="string"){if(r==="")throw new $e(De.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!U4(e)&&r.indexOf("/")!==-1)throw new $e(De.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(hr.fromString(r));if(!st.isDocumentKey(n))throw new $e(De.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return hE(t,new st(n))}if(r instanceof Ir)return hE(t,r._key);throw new $e(De.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Qm(r)}.`)}function QE(t,e){if(!Array.isArray(t)||t.length===0)throw new $e(De.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function GA(t,e){const r=(function(a,i){for(const o of a)for(const u of o.getFlattenedFilters())if(i.indexOf(u.op)>=0)return u.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(r!==null)throw r===e.op?new $e(De.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $e(De.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class d9{convertValue(e,r="none"){switch(Ul(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Br(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Vl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ct(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Jl(e,((a,i)=>{n[a]=this.convertValue(i,r)})),n}convertVectorValue(e){const r=e.fields?.[pm].arrayValue?.values?.map((n=>Br(n.doubleValue)));return new Hs(r)}convertGeoPoint(e){return new zs(Br(e.latitude),Br(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=ep(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(h0(e));default:return null}}convertTimestamp(e){const r=Bl(e);return new xr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=hr.fromString(e);Wt(cA(n),9688,{name:e});const a=new d0(n.get(1),n.get(3)),i=new st(n.popFirst(5));return a.isEqual(r)||Oi(`Document ${i} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}function Jv(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Gf{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Po extends VA{constructor(e,r,n,a,i,o){super(e,r,n,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new am(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(dp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new $e(De.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Po._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Po._jsonSchemaVersion="firestore/documentSnapshot/1.0",Po._jsonSchema={type:nn("string",Po._jsonSchemaVersion),bundleSource:nn("string","DocumentSnapshot"),bundleName:nn("string"),bundle:nn("string")};class am extends Po{data(e={}){return super.data(e)}}class jo{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new Gf(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new am(this._firestore,this._userDataWriter,n.key,n,new Gf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new $e(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(a,i){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map((u=>{const f=new am(a._firestore,a._userDataWriter,u.doc.key,u.doc,new Gf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:o++}}))}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((u=>i||u.type!==3)).map((u=>{const f=new am(a._firestore,a._userDataWriter,u.doc.key,u.doc,new Gf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,p=-1;return u.type!==0&&(d=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),p=o.indexOf(u.doc.key)),{type:m9(u.type),doc:f,oldIndex:d,newIndex:p}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new $e(De.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=jo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach((i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),a.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function m9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ct(61501,{type:t})}}function p9(t){t=Qn(t,Ir);const e=Qn(t.firestore,Ys);return t9(G0(e),t._key).then((r=>qA(e,t,r)))}jo._jsonSchemaVersion="firestore/querySnapshot/1.0",jo._jsonSchema={type:nn("string",jo._jsonSchemaVersion),bundleSource:nn("string","QuerySnapshot"),bundleName:nn("string"),bundle:nn("string")};class Zv extends d9{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qa(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ir(this.firestore,null,r)}}function bl(t){t=Qn(t,eo);const e=Qn(t.firestore,Ys),r=G0(e),n=new Zv(e);return UA(t._query),r9(r,t._query).then((a=>new jo(e,n,t,a)))}function su(t,e,r){t=Qn(t,Ir);const n=Qn(t.firestore,Ys),a=Jv(t.converter,e,r);return Y0(n,[Wv(W0(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,Jn.none())])}function tn(t,e,r,...n){t=Qn(t,Ir);const a=Qn(t.firestore,Ys),i=W0(a);let o;return o=typeof(e=un(e))=="string"||e instanceof q0?PA(i,"updateDoc",t._key,e,r,n):MA(i,"updateDoc",t._key,e),Y0(a,[o.toMutation(t._key,Jn.exists(!0))])}function v0(t){return Y0(Qn(t.firestore,Ys),[new ip(t._key,Jn.none())])}function bi(t,e){const r=Qn(t.firestore,Ys),n=yt(t),a=Jv(t.converter,e);return Y0(r,[Wv(W0(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,Jn.exists(!1))]).then((()=>n))}function Vr(t,...e){t=un(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||$E(e[n])||(r=e[n++]);const a={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if($E(e[n])){const f=e[n];e[n]=f.next?.bind(f),e[n+1]=f.error?.bind(f),e[n+2]=f.complete?.bind(f)}let i,o,u;if(t instanceof Ir)o=Qn(t.firestore,Ys),u=tp(t._key.path),i={next:f=>{e[n]&&e[n](qA(o,t,f))},error:e[n+1],complete:e[n+2]};else{const f=Qn(t,eo);o=Qn(f.firestore,Ys),u=f._query;const d=new Zv(o);i={next:p=>{e[n]&&e[n](new jo(o,d,f,p))},error:e[n+1],complete:e[n+2]},UA(t._query)}return(function(d,p,x,y){const w=new Hv(y),b=new Vv(p,w,x);return d.asyncQueue.enqueueAndForget((async()=>jv(await Em(d),b))),()=>{w.Nu(),d.asyncQueue.enqueueAndForget((async()=>Lv(await Em(d),b)))}})(G0(o),u,a,i)}function Y0(t,e){return(function(n,a){const i=new ki;return n.asyncQueue.enqueueAndForget((async()=>HO(await e9(n),a,i))),i.promise})(G0(t),e)}function qA(t,e,r){const n=r.docs.get(e._key),a=new Zv(t);return new Po(t,a,e._key,n,new Gf(r.hasPendingWrites,r.fromCache),e.converter)}class g9{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=W0(e)}set(e,r,n){this._verifyNotCommitted();const a=H1(e,this._firestore),i=Jv(a.converter,r,n),o=Wv(this._dataReader,"WriteBatch.set",a._key,i,a.converter!==null,n);return this._mutations.push(o.toMutation(a._key,Jn.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const i=H1(e,this._firestore);let o;return o=typeof(r=un(r))=="string"||r instanceof q0?PA(this._dataReader,"WriteBatch.update",i._key,r,n,a):MA(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,Jn.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=H1(e,this._firestore);return this._mutations=this._mutations.concat(new ip(r._key,Jn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new $e(De.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function H1(t,e){if((t=un(t)).firestore!==e)throw new $e(De.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function jx(t){return G0(t=Qn(t,Ys)),new g9(t,(e=>Y0(t,e)))}(function(e,r=!0){(function(a){Ru=a})(Nu),mu(new Go("firestore",((n,{instanceIdentifier:a,options:i})=>{const o=n.getProvider("app").getImmediate(),u=new Ys(new uD(n.getProvider("auth-internal")),new dD(o,n.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new $e(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new d0(d.options.projectId,p)})(o,a),o);return i={useFetchStreams:r,...i},u._setSettings(i),u}),"PUBLIC").setMultipleInstances(!0)),Ol(Zb,eE,e),Ol(Zb,eE,"esm2020")})();function WA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const x9=WA,XA=new j0("auth","Firebase",WA());const Sm=new dv("@firebase/auth");function v9(t,...e){Sm.logLevel<=Rt.WARN&&Sm.warn(`Auth (${Nu}): ${t}`,...e)}function sm(t,...e){Sm.logLevel<=Rt.ERROR&&Sm.error(`Auth (${Nu}): ${t}`,...e)}function Mi(t,...e){throw ey(t,...e)}function Gs(t,...e){return ey(t,...e)}function YA(t,e,r){const n={...x9(),[e]:r};return new j0("auth","Firebase",n).create(e,{appName:t.name})}function Pl(t){return YA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ey(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return XA.create(t,...e)}function ft(t,e,...r){if(!t)throw ey(e,...r)}function Ei(t){const e="INTERNAL ASSERTION FAILED: "+t;throw sm(e),new Error(e)}function Pi(t,e){t||Ei(e)}function Lx(){return typeof self<"u"&&self.location?.href||""}function y9(){return JE()==="http:"||JE()==="https:"}function JE(){return typeof self<"u"&&self.location?.protocol||null}function _9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(y9()||U5()||"connection"in navigator)?navigator.onLine:!0}function w9(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class $0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Pi(r>e,"Short delay should be less than long delay!"),this.isMobile=L5()||z5()}get(){return _9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ty(t,e){Pi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class $A{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const b9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const E9=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],T9=new $0(3e4,6e4);function pp(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Mu(t,e,r,n,a={}){return KA(t,a,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const u=L0({key:t.config.apiKey,...o}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:f,...i};return V5()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Cu(t.emulatorConfig.host)&&(d.credentials="include"),$A.fetch()(await JA(t,t.config.apiHost,r,u),d)})}async function KA(t,e,r){t._canInitEmulator=!1;const n={...b9,...e};try{const a=new S9(t),i=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Md(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const u=i.ok?o.errorMessage:o.error.message,[f,d]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Md(t,"credential-already-in-use",o);if(f==="EMAIL_EXISTS")throw Md(t,"email-already-in-use",o);if(f==="USER_DISABLED")throw Md(t,"user-disabled",o);const p=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw YA(t,p,d);Mi(t,p)}}catch(a){if(a instanceof Li)throw a;Mi(t,"network-request-failed",{message:String(a)})}}async function QA(t,e,r,n,a={}){const i=await Mu(t,e,r,n,a);return"mfaPendingCredential"in i&&Mi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function JA(t,e,r,n){const a=`${e}${r}?${n}`,i=t,o=i.config.emulator?ty(t.config,a):`${t.config.apiScheme}://${a}`;return E9.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class S9{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Gs(this.auth,"network-request-failed")),T9.get())})}}function Md(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=Gs(t,e,n);return a.customData._tokenResponse=r,a}async function A9(t,e){return Mu(t,"POST","/v1/accounts:delete",e)}async function Am(t,e){return Mu(t,"POST","/v1/accounts:lookup",e)}function Zf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function k9(t,e=!1){const r=un(t),n=await r.getIdToken(e),a=ry(n);ft(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const i=typeof a.firebase=="object"?a.firebase:void 0,o=i?.sign_in_provider;return{claims:a,token:n,authTime:Zf(G1(a.auth_time)),issuedAtTime:Zf(G1(a.iat)),expirationTime:Zf(G1(a.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function G1(t){return Number(t)*1e3}function ry(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return sm("JWT malformed, contained fewer than 3 sections"),null;try{const a=n4(r);return a?JSON.parse(a):(sm("Failed to decode base64 JWT payload"),null)}catch(a){return sm("Caught error parsing JWT payload as JSON",a?.toString()),null}}function ZE(t){const e=ry(t);return ft(e,"internal-error"),ft(typeof e.exp<"u","internal-error"),ft(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function y0(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Li&&C9(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function C9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class N9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Bx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zf(this.lastLoginAt),this.creationTime=Zf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function km(t){const e=t.auth,r=await t.getIdToken(),n=await y0(t,Am(e,{idToken:r}));ft(n?.users.length,e,"internal-error");const a=n.users[0];t._notifyReloadListener(a);const i=a.providerUserInfo?.length?ZA(a.providerUserInfo):[],o=I9(t.providerData,i),u=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!o?.length,d=u?f:!1,p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new Bx(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(t,p)}async function R9(t){const e=un(t);await km(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function I9(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function ZA(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function D9(t,e){const r=await KA(t,{},async()=>{const n=L0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:i}=t.config,o=await JA(t,a,"/v1/token",`key=${i}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:n};return t.emulatorConfig&&Cu(t.emulatorConfig.host)&&(f.credentials="include"),$A.fetch()(o,f)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function O9(t,e){return Mu(t,"POST","/v2/accounts:revokeToken",pp(t,e))}class iu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ft(e.idToken,"internal-error"),ft(typeof e.idToken<"u","internal-error"),ft(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ZE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ft(e.length!==0,"internal-error");const r=ZE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ft(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:i}=await D9(e,r);this.updateTokensAndExpiration(n,a,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:i}=r,o=new iu;return n&&(ft(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),a&&(ft(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),i&&(ft(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new iu,this.toJSON())}_performRefresh(){return Ei("not implemented")}}function _l(t,e){ft(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class vs{constructor({uid:e,auth:r,stsTokenManager:n,...a}){this.providerId="firebase",this.proactiveRefresh=new N9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Bx(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await y0(this,this.stsTokenManager.getToken(this.auth,e));return ft(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return k9(this,e)}reload(){return R9(this)}_assign(e){this!==e&&(ft(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new vs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await km(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xs(this.auth.app))return Promise.reject(Pl(this.auth));const e=await this.getIdToken();return await y0(this,A9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,a=r.email??void 0,i=r.phoneNumber??void 0,o=r.photoURL??void 0,u=r.tenantId??void 0,f=r._redirectEventId??void 0,d=r.createdAt??void 0,p=r.lastLoginAt??void 0,{uid:x,emailVerified:y,isAnonymous:w,providerData:b,stsTokenManager:E}=r;ft(x&&E,e,"internal-error");const T=iu.fromJSON(this.name,E);ft(typeof x=="string",e,"internal-error"),_l(n,e.name),_l(a,e.name),ft(typeof y=="boolean",e,"internal-error"),ft(typeof w=="boolean",e,"internal-error"),_l(i,e.name),_l(o,e.name),_l(u,e.name),_l(f,e.name),_l(d,e.name),_l(p,e.name);const I=new vs({uid:x,auth:e,email:a,emailVerified:y,displayName:n,isAnonymous:w,photoURL:o,phoneNumber:i,tenantId:u,stsTokenManager:T,createdAt:d,lastLoginAt:p});return b&&Array.isArray(b)&&(I.providerData=b.map(R=>({...R}))),f&&(I._redirectEventId=f),I}static async _fromIdTokenResponse(e,r,n=!1){const a=new iu;a.updateFromServerResponse(r);const i=new vs({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await km(i),i}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];ft(a.localId!==void 0,"internal-error");const i=a.providerUserInfo!==void 0?ZA(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!i?.length,u=new iu;u.updateFromIdToken(n);const f=new vs({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:o}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:i,metadata:new Bx(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!i?.length};return Object.assign(f,d),f}}const eT=new Map;function Ti(t){Pi(t instanceof Function,"Expected a class definition");let e=eT.get(t);return e?(Pi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,eT.set(t,e),e)}class ek{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}ek.type="NONE";const tT=ek;function im(t,e,r){return`firebase:${t}:${e}:${r}`}class lu{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:i}=this.auth;this.fullUserKey=im(this.userKey,a.apiKey,i),this.fullPersistenceKey=im("persistence",a.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Am(this.auth,{idToken:e}).catch(()=>{});return r?vs._fromGetAccountInfoResponse(this.auth,r,e):null}return vs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new lu(Ti(tT),e,n);const a=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=a[0]||Ti(tT);const o=im(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const p=await d._get(o);if(p){let x;if(typeof p=="string"){const y=await Am(e,{idToken:p}).catch(()=>{});if(!y)break;x=await vs._fromGetAccountInfoResponse(e,y,p)}else x=vs._fromJSON(e,p);d!==i&&(u=x),i=d;break}}catch{}const f=a.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!f.length?new lu(i,e,n):(i=f[0],u&&await i._set(o,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new lu(i,e,n))}}function rT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ak(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ik(e))return"Blackberry";if(lk(e))return"Webos";if(rk(e))return"Safari";if((e.includes("chrome/")||nk(e))&&!e.includes("edge/"))return"Chrome";if(sk(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function tk(t=Un()){return/firefox\//i.test(t)}function rk(t=Un()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nk(t=Un()){return/crios\//i.test(t)}function ak(t=Un()){return/iemobile/i.test(t)}function sk(t=Un()){return/android/i.test(t)}function ik(t=Un()){return/blackberry/i.test(t)}function lk(t=Un()){return/webos/i.test(t)}function ny(t=Un()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function F9(t=Un()){return ny(t)&&!!window.navigator?.standalone}function M9(){return H5()&&document.documentMode===10}function ok(t=Un()){return ny(t)||sk(t)||lk(t)||ik(t)||/windows phone/i.test(t)||ak(t)}function ck(t,e=[]){let r;switch(t){case"Browser":r=rT(Un());break;case"Worker":r=`${rT(Un())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Nu}/${n}`}class P9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,u)=>{try{const f=e(i);o(f)}catch(f){u(f)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function j9(t,e={}){return Mu(t,"GET","/v2/passwordPolicy",pp(t,e))}const L9=6;class B9{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??L9,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class V9{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nT(this),this.idTokenSubscription=new nT(this),this.beforeStateQueue=new P9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=XA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ti(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await lu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Am(this,{idToken:e}),n=await vs._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(xs(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=n?._redirectEventId,u=await this.tryRedirectSignIn(e);(!i||i===o)&&u?.user&&(n=u.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await km(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=w9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xs(this.app))return Promise.reject(Pl(this));const r=e?un(e):null;return r&&ft(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ft(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xs(this.app)?Promise.reject(Pl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xs(this.app)?Promise.reject(Pl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ti(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await j9(this),r=new B9(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new j0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await O9(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ti(e)||this._popupRedirectResolver;ft(r,this,"argument-error"),this.redirectPersistenceManager=await lu.create(this,[Ti(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ft(u,this,"internal-error"),u.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const f=e.addObserver(r,n,a);return()=>{o=!0,f()}}else{const f=e.addObserver(r);return()=>{o=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ck(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(xs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&v9(`Error while retrieving App Check token: ${e.error}`),e?.token}}function gp(t){return un(t)}class nT{constructor(e){this.auth=e,this.observer=null,this.addObserver=Q5(r=>this.observer=r)}get next(){return ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ay={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function U9(t){ay=t}function z9(t){return ay.loadJS(t)}function H9(){return ay.gapiScript}function G9(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function q9(t,e){const r=pv(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),i=r.getOptions();if(Ho(i,e??{}))return a;Mi(a,"already-initialized")}return r.initialize({options:e})}function W9(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Ti);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function X9(t,e,r){const n=gp(t);ft(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,i=uk(e),{host:o,port:u}=Y9(e),f=u===null?"":`:${u}`,d={url:`${i}//${o}${f}/`},p=Object.freeze({host:o,port:u,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){ft(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ft(Ho(d,n.config.emulator)&&Ho(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,Cu(o)?(l4(`${i}//${o}${f}`),o4("Auth",!0)):$9()}function uk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Y9(t){const e=uk(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const i=a[1];return{host:i,port:aT(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:aT(o)}}}function aT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function $9(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class fk{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ei("not implemented")}_getIdTokenResponse(e){return Ei("not implemented")}_linkToIdToken(e,r){return Ei("not implemented")}_getReauthenticationResolver(e){return Ei("not implemented")}}async function ou(t,e){return QA(t,"POST","/v1/accounts:signInWithIdp",pp(t,e))}const K9="http://localhost";class Xo extends fk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Xo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Mi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,...i}=r;if(!n||!a)return null;const o=new Xo(n,a);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return ou(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ou(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ou(e,r)}buildRequest(){const e={requestUri:K9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=L0(r)}return e}}class hk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class K0 extends hk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class El extends K0{constructor(){super("facebook.com")}static credential(e){return Xo._fromParams({providerId:El.PROVIDER_ID,signInMethod:El.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return El.credentialFromTaggedObject(e)}static credentialFromError(e){return El.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return El.credential(e.oauthAccessToken)}catch{return null}}}El.FACEBOOK_SIGN_IN_METHOD="facebook.com";El.PROVIDER_ID="facebook.com";class Tl extends K0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Xo._fromParams({providerId:Tl.PROVIDER_ID,signInMethod:Tl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Tl.credentialFromTaggedObject(e)}static credentialFromError(e){return Tl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Tl.credential(r,n)}catch{return null}}}Tl.GOOGLE_SIGN_IN_METHOD="google.com";Tl.PROVIDER_ID="google.com";class Sl extends K0{constructor(){super("github.com")}static credential(e){return Xo._fromParams({providerId:Sl.PROVIDER_ID,signInMethod:Sl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sl.credentialFromTaggedObject(e)}static credentialFromError(e){return Sl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sl.credential(e.oauthAccessToken)}catch{return null}}}Sl.GITHUB_SIGN_IN_METHOD="github.com";Sl.PROVIDER_ID="github.com";class Al extends K0{constructor(){super("twitter.com")}static credential(e,r){return Xo._fromParams({providerId:Al.PROVIDER_ID,signInMethod:Al.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Al.credentialFromTaggedObject(e)}static credentialFromError(e){return Al.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Al.credential(r,n)}catch{return null}}}Al.TWITTER_SIGN_IN_METHOD="twitter.com";Al.PROVIDER_ID="twitter.com";async function Q9(t,e){return QA(t,"POST","/v1/accounts:signUp",pp(t,e))}class Gl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const i=await vs._fromIdTokenResponse(e,n,a),o=sT(n);return new Gl({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=sT(n);return new Gl({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function sT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function J9(t){if(xs(t.app))return Promise.reject(Pl(t));const e=gp(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Gl({user:e.currentUser,providerId:null,operationType:"signIn"});const r=await Q9(e,{returnSecureToken:!0}),n=await Gl._fromIdTokenResponse(e,"signIn",r,!0);return await e._updateCurrentUser(n.user),n}class Cm extends Li{constructor(e,r,n,a){super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,Cm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new Cm(e,r,n,a)}}function dk(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Cm._fromErrorAndOperation(t,i,e,n):i})}async function Z9(t,e,r=!1){const n=await y0(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Gl._forOperation(t,"link",n)}async function eF(t,e,r=!1){const{auth:n}=t;if(xs(n.app))return Promise.reject(Pl(n));const a="reauthenticate";try{const i=await y0(t,dk(n,a,e,t),r);ft(i.idToken,n,"internal-error");const o=ry(i.idToken);ft(o,n,"internal-error");const{sub:u}=o;return ft(t.uid===u,n,"user-mismatch"),Gl._forOperation(t,a,i)}catch(i){throw i?.code==="auth/user-not-found"&&Mi(n,"user-mismatch"),i}}async function tF(t,e,r=!1){if(xs(t.app))return Promise.reject(Pl(t));const n="signIn",a=await dk(t,n,e),i=await Gl._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(i.user),i}function rF(t,e,r,n){return un(t).onIdTokenChanged(e,r,n)}function nF(t,e,r){return un(t).beforeAuthStateChanged(e,r)}function aF(t,e,r,n){return un(t).onAuthStateChanged(e,r,n)}const Nm="__sak";class mk{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Nm,"1"),this.storage.removeItem(Nm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const sF=1e3,iF=10;class pk extends mk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ok(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,u,f)=>{this.notifyListeners(o,f)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);M9()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,iF):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},sF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}pk.type="LOCAL";const lF=pk;class gk extends mk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}gk.type="SESSION";const xk=gk;function oF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class xp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new xp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:i}=r.data,o=this.handlersMap[a];if(!o?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(o).map(async d=>d(r.origin,i)),f=await oF(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:f})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}xp.receivers=[];function sy(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class cF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let i,o;return new Promise((u,f)=>{const d=sy("",20);a.port1.start();const p=setTimeout(()=>{f(new Error("unsupported_event"))},n);o={messageChannel:a,onMessage(x){const y=x;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(p),i=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),u(y.data.response);break;default:clearTimeout(p),clearTimeout(i),f(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function qs(){return window}function uF(t){qs().location.href=t}function vk(){return typeof qs().WorkerGlobalScope<"u"&&typeof qs().importScripts=="function"}async function fF(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function hF(){return navigator?.serviceWorker?.controller||null}function dF(){return vk()?self:null}const yk="firebaseLocalStorageDb",mF=1,Rm="firebaseLocalStorage",_k="fbase_key";class Q0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function vp(t,e){return t.transaction([Rm],e?"readwrite":"readonly").objectStore(Rm)}function pF(){const t=indexedDB.deleteDatabase(yk);return new Q0(t).toPromise()}function Vx(){const t=indexedDB.open(yk,mF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Rm,{keyPath:_k})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Rm)?e(n):(n.close(),await pF(),e(await Vx()))})})}async function iT(t,e,r){const n=vp(t,!0).put({[_k]:e,value:r});return new Q0(n).toPromise()}async function gF(t,e){const r=vp(t,!1).get(e),n=await new Q0(r).toPromise();return n===void 0?null:n.value}function lT(t,e){const r=vp(t,!0).delete(e);return new Q0(r).toPromise()}const xF=800,vF=3;class wk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>vF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return vk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=xp._getInstance(dF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await fF(),!this.activeServiceWorker)return;this.sender=new cF(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||hF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vx();return await iT(e,Nm,"1"),await lT(e,Nm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>iT(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>gF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>lT(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const i=vp(a,!1).getAll();return new Q0(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:i}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(i)&&(this.notifyListeners(a,i),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),xF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wk.type="LOCAL";const yF=wk;new $0(3e4,6e4);function _F(t,e){return e?Ti(e):(ft(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class iy extends fk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ou(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ou(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ou(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function wF(t){return tF(t.auth,new iy(t),t.bypassAuthState)}function bF(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),eF(r,new iy(t),t.bypassAuthState)}async function EF(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),Z9(r,new iy(t),t.bypassAuthState)}class bk{constructor(e,r,n,a,i=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:i,error:o,type:u}=e;if(o){this.reject(o);return}const f={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return wF;case"linkViaPopup":case"linkViaRedirect":return EF;case"reauthViaPopup":case"reauthViaRedirect":return bF;default:Mi(this.auth,"internal-error")}}resolve(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const TF=new $0(2e3,1e4);class ru extends bk{constructor(e,r,n,a,i){super(e,r,a,i),this.provider=n,this.authWindow=null,this.pollId=null,ru.currentPopupAction&&ru.currentPopupAction.cancel(),ru.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ft(e,this.auth,"internal-error"),e}async onExecution(){Pi(this.filter.length===1,"Popup operations only handle one event");const e=sy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Gs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Gs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ru.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Gs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,TF.get())};e()}}ru.currentPopupAction=null;const SF="pendingRedirect",lm=new Map;class AF extends bk{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=lm.get(this.auth._key());if(!e){try{const n=await kF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}lm.set(this.auth._key(),e)}return this.bypassAuthState||lm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function kF(t,e){const r=RF(e),n=NF(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function CF(t,e){lm.set(t._key(),e)}function NF(t){return Ti(t._redirectPersistence)}function RF(t){return im(SF,t.config.apiKey,t.name)}async function IF(t,e,r=!1){if(xs(t.app))return Promise.reject(Pl(t));const n=gp(t),a=_F(n,e),o=await new AF(n,a,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}const DF=600*1e3;class OF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!FF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!Ek(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Gs(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=DF&&this.cachedEventUids.clear(),this.cachedEventUids.has(oT(e))}saveEventToCache(e){this.cachedEventUids.add(oT(e)),this.lastProcessedEventTime=Date.now()}}function oT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Ek({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function FF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ek(t);default:return!1}}async function MF(t,e={}){return Mu(t,"GET","/v1/projects",e)}const PF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,jF=/^https?/;async function LF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await MF(t);for(const r of e)try{if(BF(r))return}catch{}Mi(t,"unauthorized-domain")}function BF(t){const e=Lx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!jF.test(r))return!1;if(PF.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}const VF=new $0(3e4,6e4);function cT(){const t=qs().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function UF(t){return new Promise((e,r)=>{function n(){cT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cT(),r(Gs(t,"network-request-failed"))},timeout:VF.get()})}if(qs().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(qs().gapi?.load)n();else{const a=G9("iframefcb");return qs()[a]=()=>{gapi.load?n():r(Gs(t,"network-request-failed"))},z9(`${H9()}?onload=${a}`).catch(i=>r(i))}}).catch(e=>{throw om=null,e})}let om=null;function zF(t){return om=om||UF(t),om}const HF=new $0(5e3,15e3),GF="__/auth/iframe",qF="emulator/auth/iframe",WF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},XF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function YF(t){const e=t.config;ft(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?ty(e,qF):`https://${t.config.authDomain}/${GF}`,n={apiKey:e.apiKey,appName:t.name,v:Nu},a=XF.get(t.config.apiHost);a&&(n.eid=a);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${L0(n).slice(1)}`}async function $F(t){const e=await zF(t),r=qs().gapi;return ft(r,t,"internal-error"),e.open({where:document.body,url:YF(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:WF,dontclear:!0},n=>new Promise(async(a,i)=>{await n.restyle({setHideOnLeave:!1});const o=Gs(t,"network-request-failed"),u=qs().setTimeout(()=>{i(o)},HF.get());function f(){qs().clearTimeout(u),a(n)}n.ping(f).then(f,()=>{i(o)})}))}const KF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},QF=500,JF=600,ZF="_blank",eM="http://localhost";class uT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function tM(t,e,r,n=QF,a=JF){const i=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const f={...KF,width:n.toString(),height:a.toString(),top:i,left:o},d=Un().toLowerCase();r&&(u=nk(d)?ZF:r),tk(d)&&(e=e||eM,f.scrollbars="yes");const p=Object.entries(f).reduce((y,[w,b])=>`${y}${w}=${b},`,"");if(F9(d)&&u!=="_self")return rM(e||"",u),new uT(null);const x=window.open(e||"",u,p);ft(x,t,"popup-blocked");try{x.focus()}catch{}return new uT(x)}function rM(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const nM="__/auth/handler",aM="emulator/auth/handler",sM=encodeURIComponent("fac");async function fT(t,e,r,n,a,i){ft(t.config.authDomain,t,"auth-domain-config-required"),ft(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Nu,eventId:a};if(e instanceof hk){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",K5(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,x]of Object.entries({}))o[p]=x}if(e instanceof K0){const p=e.getScopes().filter(x=>x!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const u=o;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const f=await t._getAppCheckToken(),d=f?`#${sM}=${encodeURIComponent(f)}`:"";return`${iM(t)}?${L0(u).slice(1)}${d}`}function iM({config:t}){return t.emulator?ty(t,aM):`https://${t.authDomain}/${nM}`}const q1="webStorageSupport";class lM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xk,this._completeRedirectFn=IF,this._overrideRedirectResult=CF}async _openPopup(e,r,n,a){Pi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await fT(e,r,n,Lx(),a);return tM(e,i,sy())}async _openRedirect(e,r,n,a){await this._originValidation(e);const i=await fT(e,r,n,Lx(),a);return uF(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:i}=this.eventManagers[r];return a?Promise.resolve(a):(Pi(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await $F(e),n=new OF(e);return r.register("authEvent",a=>(ft(a?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(q1,{type:q1},a=>{const i=a?.[0]?.[q1];i!==void 0&&r(!!i),Mi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=LF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return ok()||rk()||ny()}}const oM=lM;var hT="@firebase/auth",dT="1.11.1";class cM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function uM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function fM(t){mu(new Go("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=n.options;ft(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:o,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ck(t)},d=new V9(n,a,i,f);return W9(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),mu(new Go("auth-internal",e=>{const r=gp(e.getProvider("auth").getImmediate());return(n=>new cM(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ol(hT,dT,uM(t)),Ol(hT,dT,"esm2020")}const hM=300,dM=i4("authIdTokenMaxAge")||hM;let mT=null;const mM=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>dM)return;const a=r?.token;mT!==a&&(mT=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function pM(t=h4()){const e=pv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=q9(t,{popupRedirectResolver:oM,persistence:[yF,lF,xk]}),n=i4("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=mM(i.toString());nF(r,o,()=>o(r.currentUser)),rF(r,u=>o(u))}}const a=a4("auth");return a&&X9(r,`http://${a}`),r}function gM(){return document.getElementsByTagName("head")?.[0]??document}U9({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const i=Gs("internal-error");i.customData=a,r(i)},n.type="text/javascript",n.charset="UTF-8",gM().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});fM("Browser");const xM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),vM=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),pT=t=>{const e=vM(t);return e.charAt(0).toUpperCase()+e.slice(1)},Tk=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),yM=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var _M={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const wM=re.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...u},f)=>re.createElement("svg",{ref:f,..._M,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:Tk("lucide",a),...!i&&!yM(u)&&{"aria-hidden":"true"},...u},[...o.map(([d,p])=>re.createElement(d,p)),...Array.isArray(i)?i:[i]]));const Ye=(t,e)=>{const r=re.forwardRef(({className:n,...a},i)=>re.createElement(wM,{ref:i,iconNode:e,className:Tk(`lucide-${xM(pT(t))}`,`lucide-${t}`,n),...a}));return r.displayName=pT(t),r};const bM=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],EM=Ye("archive",bM);const TM=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Sk=Ye("arrow-down",TM);const SM=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ak=Ye("arrow-left",SM);const AM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],kM=Ye("arrow-right",AM);const CM=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],NM=Ye("arrow-up",CM);const RM=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],IM=Ye("bold",RM);const DM=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],ly=Ye("calculator",DM);const OM=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],FM=Ye("calendar",OM);const MM=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],oy=Ye("camera",MM);const PM=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],jM=Ye("chevron-down",PM);const LM=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],BM=Ye("chevron-left",LM);const VM=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],kk=Ye("chevron-right",VM);const UM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],zM=Ye("circle-alert",UM);const HM=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ck=Ye("circle-check-big",HM);const GM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Ux=Ye("circle-question-mark",GM);const qM=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],WM=Ye("clock-3",qM);const XM=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],YM=Ye("cloud-upload",XM);const $M=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Im=Ye("crown",$M);const KM=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],QM=Ye("database",KM);const JM=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Nk=Ye("dollar-sign",JM);const ZM=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],eP=Ye("download",ZM);const tP=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Cl=Ye("external-link",tP);const rP=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Rk=Ye("file-spreadsheet",rP);const nP=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ik=Ye("file-text",nP);const aP=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],gT=Ye("folder",aP);const sP=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],xT=Ye("heart",sP);const iP=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],J0=Ye("image",iP);const lP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Z0=Ye("info",lP);const oP=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],cP=Ye("italic",oP);const uP=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Dk=Ye("key",uP);const fP=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Dm=Ye("link",fP);const hP=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],dP=Ye("list-checks",hP);const mP=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],pP=Ye("list",mP);const gP=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],xP=Ye("lock",gP);const vP=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Ok=Ye("log-out",vP);const yP=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],_P=Ye("map-pin",yP);const wP=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],zx=Ye("megaphone",wP);const bP=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],vT=Ye("message-square",bP);const EP=[["path",{d:"M5 12h14",key:"1ays0h"}]],cy=Ye("minus",EP);const TP=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],yT=Ye("music",TP);const SP=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Fk=Ye("package",SP);const AP=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],uy=Ye("pen-line",AP);const kP=[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]],Mk=Ye("plane",kP);const CP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],wu=Ye("plus",CP);const NP=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],RP=Ye("refresh-ccw",NP);const IP=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],DP=Ye("refresh-cw",IP);const OP=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],_T=Ye("rocket",OP);const FP=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],MP=Ye("rotate-ccw",FP);const PP=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ql=Ye("save",PP);const jP=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],fy=Ye("scale",jP);const LP=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],BP=Ye("school",LP);const VP=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Pk=Ye("search",VP);const UP=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],jk=Ye("settings",UP);const zP=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],HP=Ye("shield",zP);const GP=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],Lk=Ye("shopping-bag",GP);const qP=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],yp=Ye("shopping-cart",qP);const WP=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],XP=Ye("square-check-big",WP);const YP=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],bu=Ye("tag",YP);const $P=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]],KP=Ye("text-align-end",$P);const QP=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]],JP=Ye("text-align-center",QP);const ZP=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],ej=Ye("text-align-start",ZP);const tj=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],e0=Ye("ticket",tj);const rj=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],hy=Ye("trash-2",rj);const nj=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Bk=Ye("triangle-alert",nj);const aj=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],_p=Ye("truck",aj);const sj=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],W1=Ye("type",sj);const ij=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],lj=Ye("underline",ij);const oj=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],dy=Ye("upload",oj);const cj=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Om=Ye("user",cj);const uj=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],wT=Ye("users",uj);const fj=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],hj=Ye("volume-2",fj);const dj=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],mj=Ye("volume-x",dj);const pj=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],fa=Ye("x",pj);const gj=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Fm=Ye("zap",gj);const xj=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],vj=Ye("zoom-in",xj);const yj=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],_j=Ye("zoom-out",yj);function wj({users:t,onLogin:e}){const[r,n]=re.useState(""),[a,i]=re.useState(""),o=d=>{d.preventDefault(),e(r,a)},f="PLUS ULTRA  GO BEYOND  PLUS ULTRA  GO BEYOND  ".repeat(4);return m.jsxs("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[m.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"radial-gradient(#ffffff 1px, transparent 1px)",backgroundSize:"20px 20px"}}),m.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-32 flex justify-center pointer-events-none overflow-hidden select-none opacity-10",children:m.jsxs("div",{className:"animate-scroll-down whitespace-nowrap text-8xl font-black text-slate-100 tracking-tighter",style:{writingMode:"vertical-rl"},children:[m.jsx("span",{children:f}),m.jsx("span",{children:f})]})}),m.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-32 flex justify-center pointer-events-none overflow-hidden select-none opacity-10",children:m.jsxs("div",{className:"animate-scroll-up whitespace-nowrap text-8xl font-black text-slate-100 tracking-tighter",style:{writingMode:"vertical-rl"},children:[m.jsx("span",{children:f}),m.jsx("span",{children:f})]})}),m.jsx("style",{jsx:!0,children:`
        @keyframes scroll-up {
          0% { transform: translateY(0); }
          100% { transform: translateY(-50%); }
        }
        
        @keyframes scroll-down {
          0% { transform: translateY(-50%); }
          100% { transform: translateY(0); }
        }

        .animate-scroll-up {
          /* 1.  50s */
          animation: scroll-up 50s linear infinite;
          /* 2.   GPU  () */
          will-change: transform;
        }

        .animate-scroll-down {
          /* 1.  50s */
          animation: scroll-down 50s linear infinite;
          /* 2.   */
          will-change: transform;
        }
      `}),m.jsxs("form",{onSubmit:o,className:`\r
          bg-white w-full max-w-md p-8 rounded-lg \r
          border-4 border-slate-900 \r
          shadow-[8px_8px_0px_0px_#FACC15] \r
          relative overflow-hidden z-10\r
        `,children:[m.jsx("div",{className:"absolute top-0 left-0 w-full h-1/4 bg-red-600 transform -skew-y-3 -mt-8 opacity-10"}),m.jsxs("div",{className:"text-center mb-8 relative z-10",children:[m.jsx("div",{className:"inline-block p-4 bg-slate-900 rounded-full text-yellow-400 mb-4 border-2 border-yellow-400",children:m.jsx(HP,{size:36})}),m.jsx("h1",{className:"text-3xl font-black italic text-slate-900 tracking-wider",children:""}),m.jsx("p",{className:"text-slate-500 text-sm mt-1 font-bold",children:"U.A. ACADEMY LOGIN"})]}),m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsxs("label",{className:"text-slate-900 text-sm font-black italic block mb-1 flex items-center gap-1",children:[m.jsx(Om,{size:16}),"  (Your ID)"]}),m.jsxs("select",{className:`\r
                w-full border-2 border-slate-900 rounded-lg px-3 py-2.5 \r
                bg-slate-50 text-slate-800 font-bold \r
                focus:outline-none focus:ring-4 focus:ring-yellow-400 \r
                transition-all appearance-none\r
              `,value:r,onChange:d=>n(d.target.value),required:!0,children:[m.jsx("option",{value:"",children:"..."}),t.map(d=>m.jsx("option",{value:d.id,children:d.name},d.id))]})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-slate-900 text-sm font-black italic block mb-1 flex items-center gap-1",children:[m.jsx(xP,{size:16}),"  (Password)"]}),m.jsx("input",{type:"password",value:a,onChange:d=>i(d.target.value),placeholder:"",className:`\r
                w-full border-2 border-slate-900 rounded-lg px-3 py-2 \r
                bg-slate-50 text-slate-900 font-bold \r
                focus:outline-none focus:ring-4 focus:ring-yellow-400 \r
                placeholder-slate-400 transition-all\r
              `,required:!0}),m.jsx("span",{className:"text-xs text-slate-500 font-medium mt-1",children:" 4  0 "})]}),m.jsxs("button",{type:"submit",className:`\r
              w-full py-3 mt-4 text-xl \r
              bg-red-600 text-white font-black italic \r
              rounded-lg border-2 border-red-800\r
              shadow-[4px_4px_0px_0px_rgba(15,23,42,1)]\r
              hover:bg-red-700 \r
              disabled:opacity-50 disabled:shadow-none\r
              transition-all transform active:translate-y-0.5 active:translate-x-0.5 active:shadow-none\r
            `,disabled:!r||!a,children:[m.jsx(kM,{size:20,className:"inline mr-2"})," (LOGIN!)"]})]})]})]})}var bj="firebase",Ej="12.6.0";Ol(bj,Ej,"app");console.log("FB KEY =","AIzaSyD97NjWJOV7NPgAzEEgzX7U31yXkq6L0VI");const Tj={apiKey:"AIzaSyD97NjWJOV7NPgAzEEgzX7U31yXkq6L0VI",authDomain:"my-shopping-cart-be7df.firebaseapp.com",projectId:"my-shopping-cart-be7df",storageBucket:"my-shopping-cart-be7df.firebasestorage.app",messagingSenderId:"968807957116",appId:"1:968807957116:web:b4d0c85cc06c9afed53ff9",measurementId:"G-M4E24RKXL0"},Vk=f4(Tj),Ke=a9(Vk),X1=pM(Vk);var Ja=function(t,e){return Number(t.toFixed(e))},Sj=function(t,e){return e},br=function(t,e,r){r&&typeof r=="function"&&r(t,e)},Aj=function(t){return-Math.cos(t*Math.PI)/2+.5},kj=function(t){return t},Cj=function(t){return t*t},Nj=function(t){return t*(2-t)},Rj=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},Ij=function(t){return t*t*t},Dj=function(t){return--t*t*t+1},Oj=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},Fj=function(t){return t*t*t*t},Mj=function(t){return 1- --t*t*t*t},Pj=function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},jj=function(t){return t*t*t*t*t},Lj=function(t){return 1+--t*t*t*t*t},Bj=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},Uk={easeOut:Aj,linear:kj,easeInQuad:Cj,easeOutQuad:Nj,easeInOutQuad:Rj,easeInCubic:Ij,easeOutCubic:Dj,easeInOutCubic:Oj,easeInQuart:Fj,easeOutQuart:Mj,easeInOutQuart:Pj,easeInQuint:jj,easeOutQuint:Lj,easeInOutQuint:Bj},zk=function(t){typeof t=="number"&&cancelAnimationFrame(t)},gs=function(t){t.mounted&&(zk(t.animation),t.animate=!1,t.animation=null,t.velocity=null)};function Hk(t,e,r,n){if(t.mounted){var a=new Date().getTime(),i=1;gs(t),t.animation=function(){if(!t.mounted)return zk(t.animation);var o=new Date().getTime()-a,u=o/r,f=Uk[e],d=f(u);o>=r?(n(i),t.animation=null):t.animation&&(n(d),requestAnimationFrame(t.animation))},requestAnimationFrame(t.animation)}}function Vj(t){var e=t.scale,r=t.positionX,n=t.positionY;return!(Number.isNaN(e)||Number.isNaN(r)||Number.isNaN(n))}function to(t,e,r,n){var a=Vj(e);if(!(!t.mounted||!a)){var i=t.setTransformState,o=t.transformState,u=o.scale,f=o.positionX,d=o.positionY,p=e.scale-u,x=e.positionX-f,y=e.positionY-d;r===0?i(e.scale,e.positionX,e.positionY):Hk(t,n,r,function(w){var b=u+p*w,E=f+x*w,T=d+y*w;i(b,E,T)})}}function Uj(t,e,r){var n=t.offsetWidth,a=t.offsetHeight,i=e.offsetWidth,o=e.offsetHeight,u=i*r,f=o*r,d=n-u,p=a-f;return{wrapperWidth:n,wrapperHeight:a,newContentWidth:u,newDiffWidth:d,newContentHeight:f,newDiffHeight:p}}var zj=function(t,e,r,n,a,i,o){var u=t>e?r*(o?1:.5):0,f=n>a?i*(o?1:.5):0,d=t-e-u,p=u,x=n-a-f,y=f;return{minPositionX:d,maxPositionX:p,minPositionY:x,maxPositionY:y}},my=function(t,e){var r=t.wrapperComponent,n=t.contentComponent,a=t.setup.centerZoomedOut;if(!r||!n)throw new Error("Components are not mounted");var i=Uj(r,n,e),o=i.wrapperWidth,u=i.wrapperHeight,f=i.newContentWidth,d=i.newDiffWidth,p=i.newContentHeight,x=i.newDiffHeight,y=zj(o,f,d,u,p,x,!!a);return y},Hx=function(t,e,r,n){return n?t<e?Ja(e,2):t>r?Ja(r,2):Ja(t,2):Ja(t,2)},Lo=function(t,e){var r=my(t,e);return t.bounds=r,r};function eh(t,e,r,n,a,i,o){var u=r.minPositionX,f=r.minPositionY,d=r.maxPositionX,p=r.maxPositionY,x=0,y=0;o&&(x=a,y=i);var w=Hx(t,u-x,d+x,n),b=Hx(e,f-y,p+y,n);return{x:w,y:b}}function wp(t,e,r,n,a,i){var o=t.transformState,u=o.scale,f=o.positionX,d=o.positionY,p=n-u;if(typeof e!="number"||typeof r!="number")return console.error("Mouse X and Y position were not provided!"),{x:f,y:d};var x=f-e*p,y=d-r*p,w=eh(x,y,a,i,0,0,null);return w}function th(t,e,r,n,a){var i=a?n:0,o=e-i;return!Number.isNaN(r)&&t>=r?r:!Number.isNaN(e)&&t<=o?o:t}var bT=function(t,e){var r=t.setup.panning.excluded,n=t.isInitialized,a=t.wrapperComponent,i=e.target,o="shadowRoot"in i&&"composedPath"in e,u=o?e.composedPath().some(function(p){return p instanceof Element?a?.contains(p):!1}):a?.contains(i),f=n&&i&&u;if(!f)return!1;var d=bp(i,r);return!d},ET=function(t){var e=t.isInitialized,r=t.isPanning,n=t.setup,a=n.panning.disabled,i=e&&r&&!a;return!!i},Hj=function(t,e){var r=t.transformState,n=r.positionX,a=r.positionY;t.isPanning=!0;var i=e.clientX,o=e.clientY;t.startCoords={x:i-n,y:o-a}},Gj=function(t,e){var r=e.touches,n=t.transformState,a=n.positionX,i=n.positionY;t.isPanning=!0;var o=r.length===1;if(o){var u=r[0].clientX,f=r[0].clientY;t.startCoords={x:u-a,y:f-i}}};function qj(t){var e=t.transformState,r=e.positionX,n=e.positionY,a=e.scale,i=t.setup,o=i.disabled,u=i.limitToBounds,f=i.centerZoomedOut,d=t.wrapperComponent;if(!(o||!d||!t.bounds)){var p=t.bounds,x=p.maxPositionX,y=p.minPositionX,w=p.maxPositionY,b=p.minPositionY,E=r>x||r<y,T=n>w||n<b,I=r>x?d.offsetWidth:t.setup.minPositionX||0,R=n>w?d.offsetHeight:t.setup.minPositionY||0,C=wp(t,I,R,a,t.bounds,u||f),z=C.x,H=C.y;return{scale:a,positionX:E?z:r,positionY:T?H:n}}}function Gk(t,e,r,n,a){var i=t.setup.limitToBounds,o=t.wrapperComponent,u=t.bounds,f=t.transformState,d=f.scale,p=f.positionX,x=f.positionY;if(!(o===null||u===null||e===p&&r===x)){var y=eh(e,r,u,i,n,a,o),w=y.x,b=y.y;t.setTransformState(d,w,b)}}var Wj=function(t,e,r){var n=t.startCoords,a=t.transformState,i=t.setup.panning,o=i.lockAxisX,u=i.lockAxisY,f=a.positionX,d=a.positionY;if(!n)return{x:f,y:d};var p=e-n.x,x=r-n.y,y=o?f:p,w=u?d:x;return{x:y,y:w}},Wl=function(t,e){var r=t.setup,n=t.transformState,a=n.scale,i=r.minScale,o=r.disablePadding;return e>0&&a>=i&&!o?e:0},Xj=function(t){var e=t.mounted,r=t.setup,n=r.disabled,a=r.velocityAnimation,i=t.transformState.scale,o=a.disabled,u=!o||i>1||!n||e;return!!u},Yj=function(t){var e=t.mounted,r=t.velocity,n=t.bounds,a=t.setup,i=a.disabled,o=a.velocityAnimation,u=t.transformState.scale,f=o.disabled,d=!f||u>1||!i||e;return!(!d||!r||!n)};function $j(t,e){var r=t.setup.velocityAnimation,n=r.equalToMove,a=r.animationTime,i=r.sensitivity;return n?a*e*i:a}function TT(t,e,r,n,a,i,o,u,f,d){if(a){if(e>o&&r>o){var p=o+(t-o)*d;return p>f?f:p<o?o:p}if(e<i&&r<i){var p=i+(t-i)*d;return p<u?u:p>i?i:p}}return n?e:Hx(t,i,o,a)}function Kj(t,e){var r=1;return e?Math.min(r,t.offsetWidth/window.innerWidth):r}function Qj(t,e){var r=Xj(t);if(r){var n=t.lastMousePosition,a=t.velocityTime,i=t.setup,o=t.wrapperComponent,u=i.velocityAnimation.equalToMove,f=Date.now();if(n&&a&&o){var d=Kj(o,u),p=e.x-n.x,x=e.y-n.y,y=p/d,w=x/d,b=f-a,E=p*p+x*x,T=Math.sqrt(E)/b;t.velocity={velocityX:y,velocityY:w,total:T}}t.lastMousePosition=e,t.velocityTime=f}}function Jj(t){var e=t.velocity,r=t.bounds,n=t.setup,a=t.wrapperComponent,i=Yj(t);if(!(!i||!e||!r||!a)){var o=e.velocityX,u=e.velocityY,f=e.total,d=r.maxPositionX,p=r.minPositionX,x=r.maxPositionY,y=r.minPositionY,w=n.limitToBounds,b=n.alignmentAnimation,E=n.zoomAnimation,T=n.panning,I=T.lockAxisY,R=T.lockAxisX,C=E.animationType,z=b.sizeX,H=b.sizeY,X=b.velocityAlignmentTime,A=X,F=$j(t,f),N=Math.max(F,A),P=Wl(t,z),M=Wl(t,H),j=P*a.offsetWidth/100,B=M*a.offsetHeight/100,Se=d+j,we=p-j,se=x+B,oe=y-B,le=t.transformState,ne=new Date().getTime();Hk(t,C,N,function(ye){var Q=t.transformState,O=Q.scale,Y=Q.positionX,q=Q.positionY,te=new Date().getTime()-ne,ce=te/A,Te=Uk[b.animationType],Re=1-Te(Math.min(1,ce)),_e=1-ye,ke=Y+o*_e,rt=q+u*_e,L=TT(ke,le.positionX,Y,R,w,p,d,we,Se,Re),Xe=TT(rt,le.positionY,q,I,w,y,x,oe,se,Re);(Y!==ke||q!==rt)&&t.setTransformState(O,L,Xe)})}}function ST(t,e){var r=t.transformState.scale;gs(t),Lo(t,r),window.TouchEvent!==void 0&&e instanceof TouchEvent?Gj(t,e):Hj(t,e)}function py(t,e){var r=t.transformState.scale,n=t.setup,a=n.minScale,i=n.alignmentAnimation,o=i.disabled,u=i.sizeX,f=i.sizeY,d=i.animationTime,p=i.animationType,x=o||r<a||!u&&!f;if(!x){var y=qj(t);y&&to(t,y,e??d,p)}}function AT(t,e,r){var n=t.startCoords,a=t.setup,i=a.alignmentAnimation,o=i.sizeX,u=i.sizeY;if(n){var f=Wj(t,e,r),d=f.x,p=f.y,x=Wl(t,o),y=Wl(t,u);Qj(t,{x:d,y:p}),Gk(t,d,p,x,y)}}function Zj(t){if(t.isPanning){var e=t.setup.panning.velocityDisabled,r=t.velocity,n=t.wrapperComponent,a=t.contentComponent;t.isPanning=!1,t.animate=!1,t.animation=null;var i=n?.getBoundingClientRect(),o=a?.getBoundingClientRect(),u=i?.width||0,f=i?.height||0,d=o?.width||0,p=o?.height||0,x=u<d||f<p,y=!e&&r&&r?.total>.1&&x;y?Jj(t):py(t)}}function gy(t,e,r,n){var a=t.setup,i=a.minScale,o=a.maxScale,u=a.limitToBounds,f=th(Ja(e,2),i,o,0,!1),d=Lo(t,f),p=wp(t,r,n,f,d,u),x=p.x,y=p.y;return{scale:f,positionX:x,positionY:y}}function qk(t,e,r){var n=t.transformState.scale,a=t.wrapperComponent,i=t.setup,o=i.minScale,u=i.limitToBounds,f=i.zoomAnimation,d=f.disabled,p=f.animationTime,x=f.animationType,y=d||n>=o;if((n>=1||u)&&py(t),!(y||!a||!t.mounted)){var w=e||a.offsetWidth/2,b=r||a.offsetHeight/2,E=gy(t,o,w,b);E&&to(t,E,p,x)}}var jl=function(){return jl=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},jl.apply(this,arguments)};function kT(t,e,r){for(var n=0,a=e.length,i;n<a;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}var Pd={scale:1,positionX:0,positionY:0},Lf={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},Gx={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},Wk=function(t){var e,r,n,a;return{previousScale:(e=t.initialScale)!==null&&e!==void 0?e:Pd.scale,scale:(r=t.initialScale)!==null&&r!==void 0?r:Pd.scale,positionX:(n=t.initialPositionX)!==null&&n!==void 0?n:Pd.positionX,positionY:(a=t.initialPositionY)!==null&&a!==void 0?a:Pd.positionY}},CT=function(t){var e=jl({},Lf);return Object.keys(t).forEach(function(r){var n=typeof t[r]<"u",a=typeof Lf[r]<"u";if(a&&n){var i=Object.prototype.toString.call(Lf[r]),o=i==="[object Object]",u=i==="[object Array]";o?e[r]=jl(jl({},Lf[r]),t[r]):u?e[r]=kT(kT([],Lf[r],!0),t[r]):e[r]=t[r]}}),e},Xk=function(t,e,r){var n=t.transformState.scale,a=t.wrapperComponent,i=t.setup,o=i.maxScale,u=i.minScale,f=i.zoomAnimation,d=i.smooth,p=f.size;if(!a)throw new Error("Wrapper is not mounted");var x=d?n*Math.exp(e*r):n+e*r,y=th(Ja(x,3),u,o,p,!1);return y};function Yk(t,e,r,n,a){var i=t.wrapperComponent,o=t.transformState,u=o.scale,f=o.positionX,d=o.positionY;if(!i)return console.error("No WrapperComponent found");var p=i.offsetWidth,x=i.offsetHeight,y=(p/2-f)/u,w=(x/2-d)/u,b=Xk(t,e,r),E=gy(t,b,y,w);if(!E)return console.error("Error during zoom event. New transformation state was not calculated.");to(t,E,n,a)}function $k(t,e,r,n){var a=t.setup,i=t.wrapperComponent,o=a.limitToBounds,u=Wk(t.props),f=t.transformState,d=f.scale,p=f.positionX,x=f.positionY;if(i){var y=my(t,u.scale),w=eh(u.positionX,u.positionY,y,o,0,0,i),b={scale:u.scale,positionX:w.x,positionY:w.y};d===u.scale&&p===u.positionX&&x===u.positionY||(n?.(),to(t,b,e,r))}}function eL(t,e,r,n){var a=t.getBoundingClientRect(),i=e.getBoundingClientRect(),o=r.getBoundingClientRect(),u=i.x*n.scale,f=i.y*n.scale;return{x:(a.x-o.x+u)/n.scale,y:(a.y-o.y+f)/n.scale}}function tL(t,e,r){var n=t.wrapperComponent,a=t.contentComponent,i=t.transformState,o=t.setup,u=o.limitToBounds,f=o.minScale,d=o.maxScale;if(!n||!a)return i;var p=n.getBoundingClientRect(),x=e.getBoundingClientRect(),y=eL(e,n,a,i),w=y.x,b=y.y,E=x.width/i.scale,T=x.height/i.scale,I=n.offsetWidth/E,R=n.offsetHeight/T,C=th(r||Math.min(I,R),f,d,0,!1),z=(p.width-E*C)/2,H=(p.height-T*C)/2,X=(p.left-w)*C+z,A=(p.top-b)*C+H,F=my(t,C),N=eh(X,A,F,u,0,0,n),P=N.x,M=N.y;return{positionX:P,positionY:M,scale:C}}var rL=function(t){return function(e,r,n){e===void 0&&(e=.5),r===void 0&&(r=300),n===void 0&&(n="easeOut"),Yk(t,1,e,r,n)}},nL=function(t){return function(e,r,n){e===void 0&&(e=.5),r===void 0&&(r=300),n===void 0&&(n="easeOut"),Yk(t,-1,e,r,n)}},aL=function(t){return function(e,r,n,a,i){a===void 0&&(a=300),i===void 0&&(i="easeOut");var o=t.transformState,u=o.positionX,f=o.positionY,d=o.scale,p=t.wrapperComponent,x=t.contentComponent,y=t.setup.disabled;if(!(y||!p||!x)){var w={positionX:Number.isNaN(e)?u:e,positionY:Number.isNaN(r)?f:r,scale:Number.isNaN(n)?d:n};to(t,w,a,i)}}},sL=function(t){return function(e,r){e===void 0&&(e=200),r===void 0&&(r="easeOut"),$k(t,e,r)}},iL=function(t){return function(e,r,n){r===void 0&&(r=200),n===void 0&&(n="easeOut");var a=t.transformState,i=t.wrapperComponent,o=t.contentComponent;if(i&&o){var u=Kk(e||a.scale,i,o);to(t,u,r,n)}}},lL=function(t){return function(e,r,n,a){n===void 0&&(n=600),a===void 0&&(a="easeOut"),gs(t);var i=t.wrapperComponent,o=typeof e=="string"?document.getElementById(e):e;if(i&&o&&i.contains(o)){var u=tL(t,o,r);to(t,u,n,a)}}},qx=function(t){return{instance:t,zoomIn:rL(t),zoomOut:nL(t),setTransform:aL(t),resetTransform:sL(t),centerView:iL(t),zoomToElement:lL(t)}},oL=function(t){return{instance:t,state:t.transformState}},fr=function(t){var e={};return Object.assign(e,oL(t)),Object.assign(e,qx(t)),e},Y1=!1;function $1(){try{var t={get passive(){return Y1=!0,!1}};return t}catch{return Y1=!1,Y1}}var jd=".".concat(Gx.wrapperClass),bp=function(t,e){return e.some(function(r){return t.matches("".concat(jd," ").concat(r,", ").concat(jd," .").concat(r,", ").concat(jd," ").concat(r," *, ").concat(jd," .").concat(r," *"))})},Wx=function(t){t&&clearTimeout(t)},cL=function(t,e,r){return"translate(".concat(t,"px, ").concat(e,"px) scale(").concat(r,")")},Kk=function(t,e,r){var n=r.offsetWidth*t,a=r.offsetHeight*t,i=(e.offsetWidth-n)/2,o=(e.offsetHeight-a)/2;return{scale:t,positionX:i,positionY:o}};function uL(t){return function(e){t.forEach(function(r){typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var fL=function(t,e){var r=t.setup.wheel,n=r.disabled,a=r.wheelDisabled,i=r.touchPadDisabled,o=r.excluded,u=t.isInitialized,f=t.isPanning,d=e.target,p=u&&!f&&!n&&d;if(!p||a&&!e.ctrlKey||i&&e.ctrlKey)return!1;var x=bp(d,o);return!x},hL=function(t){return t?t.deltaY<0?1:-1:0};function dL(t,e){var r=hL(t),n=Sj(e,r);return n}function Qk(t,e,r){var n=e.getBoundingClientRect(),a=0,i=0;if("clientX"in t)a=(t.clientX-n.left)/r,i=(t.clientY-n.top)/r;else{var o=t.touches[0];a=(o.clientX-n.left)/r,i=(o.clientY-n.top)/r}return(Number.isNaN(a)||Number.isNaN(i))&&console.error("No mouse or touch offset found"),{x:a,y:i}}var mL=function(t,e,r,n,a){var i=t.transformState.scale,o=t.wrapperComponent,u=t.setup,f=u.maxScale,d=u.minScale,p=u.zoomAnimation,x=u.disablePadding,y=p.size,w=p.disabled;if(!o)throw new Error("Wrapper is not mounted");var b=i+e*r,E=n?!1:!w,T=th(Ja(b,3),d,f,y,E&&!x);return T},pL=function(t,e){var r=t.previousWheelEvent,n=t.transformState.scale,a=t.setup,i=a.maxScale,o=a.minScale;return r?n<i||n>o||Math.sign(r.deltaY)!==Math.sign(e.deltaY)||r.deltaY>0&&r.deltaY<e.deltaY||r.deltaY<0&&r.deltaY>e.deltaY||Math.sign(r.deltaY)!==Math.sign(e.deltaY):!1},gL=function(t,e){var r=t.setup.pinch,n=r.disabled,a=r.excluded,i=t.isInitialized,o=e.target,u=i&&!n&&o;if(!u)return!1;var f=bp(o,a);return!f},xL=function(t){var e=t.setup.pinch.disabled,r=t.isInitialized,n=t.pinchStartDistance,a=r&&!e&&n;return!!a},vL=function(t,e,r){var n=r.getBoundingClientRect(),a=t.touches,i=Ja(a[0].clientX-n.left,5),o=Ja(a[0].clientY-n.top,5),u=Ja(a[1].clientX-n.left,5),f=Ja(a[1].clientY-n.top,5);return{x:(i+u)/2/e,y:(o+f)/2/e}},Jk=function(t){return Math.sqrt(Math.pow(t.touches[0].pageX-t.touches[1].pageX,2)+Math.pow(t.touches[0].pageY-t.touches[1].pageY,2))},yL=function(t,e){var r=t.pinchStartScale,n=t.pinchStartDistance,a=t.setup,i=a.maxScale,o=a.minScale,u=a.zoomAnimation,f=a.disablePadding,d=u.size,p=u.disabled;if(!r||n===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return t.transformState.scale;var x=e/n,y=x*r;return th(Ja(y,2),o,i,d,!p&&!f)},_L=160,wL=100,bL=function(t,e){var r=t.props,n=r.onWheelStart,a=r.onZoomStart;t.wheelStopEventTimer||(gs(t),br(fr(t),e,n),br(fr(t),e,a))},EL=function(t,e){var r=t.props,n=r.onWheel,a=r.onZoom,i=t.contentComponent,o=t.setup,u=t.transformState,f=u.scale,d=o.limitToBounds,p=o.centerZoomedOut,x=o.zoomAnimation,y=o.wheel,w=o.disablePadding,b=o.smooth,E=x.size,T=x.disabled,I=y.step,R=y.smoothStep;if(!i)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var C=dL(e,null),z=b?R*Math.abs(e.deltaY):I,H=mL(t,C,z,!e.ctrlKey);if(f!==H){var X=Lo(t,H),A=Qk(e,i,f),F=T||E===0||p||w,N=d&&F,P=wp(t,A.x,A.y,H,X,N),M=P.x,j=P.y;t.previousWheelEvent=e,t.setTransformState(H,M,j),br(fr(t),e,n),br(fr(t),e,a)}},TL=function(t,e){var r=t.props,n=r.onWheelStop,a=r.onZoomStop;Wx(t.wheelAnimationTimer),t.wheelAnimationTimer=setTimeout(function(){t.mounted&&(qk(t,e.x,e.y),t.wheelAnimationTimer=null)},wL);var i=pL(t,e);i&&(Wx(t.wheelStopEventTimer),t.wheelStopEventTimer=setTimeout(function(){t.mounted&&(t.wheelStopEventTimer=null,br(fr(t),e,n),br(fr(t),e,a))},_L))},Zk=function(t){for(var e=0,r=0,n=0;n<2;n+=1)e+=t.touches[n].clientX,r+=t.touches[n].clientY;var a=e/2,i=r/2;return{x:a,y:i}},SL=function(t,e){var r=Jk(e);t.pinchStartDistance=r,t.lastDistance=r,t.pinchStartScale=t.transformState.scale,t.isPanning=!1;var n=Zk(e);t.pinchLastCenterX=n.x,t.pinchLastCenterY=n.y,gs(t)},AL=function(t,e){var r=t.contentComponent,n=t.pinchStartDistance,a=t.wrapperComponent,i=t.transformState.scale,o=t.setup,u=o.limitToBounds,f=o.centerZoomedOut,d=o.zoomAnimation,p=o.alignmentAnimation,x=d.disabled,y=d.size;if(!(n===null||!r)){var w=vL(e,i,r);if(!(!Number.isFinite(w.x)||!Number.isFinite(w.y))){var b=Jk(e),E=yL(t,b),T=Zk(e),I=T.x-(t.pinchLastCenterX||0),R=T.y-(t.pinchLastCenterY||0);if(!(E===i&&I===0&&R===0)){t.pinchLastCenterX=T.x,t.pinchLastCenterY=T.y;var C=Lo(t,E),z=x||y===0||f,H=u&&z,X=wp(t,w.x,w.y,E,C,H),A=X.x,F=X.y;t.pinchMidpoint=w,t.lastDistance=b;var N=p.sizeX,P=p.sizeY,M=Wl(t,N),j=Wl(t,P),B=A+I,Se=F+R,we=eh(B,Se,C,u,M,j,a),se=we.x,oe=we.y;t.setTransformState(E,se,oe)}}}},kL=function(t){var e=t.pinchMidpoint;t.velocity=null,t.lastDistance=null,t.pinchMidpoint=null,t.pinchStartScale=null,t.pinchStartDistance=null,qk(t,e?.x,e?.y)},eC=function(t,e){var r=t.props.onZoomStop,n=t.setup.doubleClick.animationTime;Wx(t.doubleClickStopEventTimer),t.doubleClickStopEventTimer=setTimeout(function(){t.doubleClickStopEventTimer=null,br(fr(t),e,r)},n)},CL=function(t,e){var r=t.props,n=r.onZoomStart,a=r.onZoom,i=t.setup.doubleClick,o=i.animationTime,u=i.animationType;br(fr(t),e,n),$k(t,o,u,function(){return br(fr(t),e,a)}),eC(t,e)};function NL(t,e){return t==="toggle"?e===1?1:-1:t==="zoomOut"?-1:1}function RL(t,e){var r=t.setup,n=t.doubleClickStopEventTimer,a=t.transformState,i=t.contentComponent,o=a.scale,u=t.props,f=u.onZoomStart,d=u.onZoom,p=r.doubleClick,x=p.disabled,y=p.mode,w=p.step,b=p.animationTime,E=p.animationType;if(!x&&!n){if(y==="reset")return CL(t,e);if(!i)return console.error("No ContentComponent found");var T=NL(y,t.transformState.scale),I=Xk(t,T,w);if(o!==I){br(fr(t),e,f);var R=Qk(e,i,o),C=gy(t,I,R.x,R.y);if(!C)return console.error("Error during zoom event. New transformation state was not calculated.");br(fr(t),e,d),to(t,C,b,E),eC(t,e)}}}var IL=function(t,e){var r=t.isInitialized,n=t.setup,a=t.wrapperComponent,i=n.doubleClick,o=i.disabled,u=i.excluded,f=e.target,d=a?.contains(f),p=r&&f&&d&&!o;if(!p)return!1;var x=bp(f,u);return!x},DL=(function(){function t(e){var r=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){r.initializeWindowEvents()},this.unmount=function(){r.cleanupWindowEvents()},this.update=function(n){r.props=n,Lo(r,r.transformState.scale),r.setup=CT(n)},this.initializeWindowEvents=function(){var n,a,i=$1(),o=(n=r.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,u=o?.defaultView;(a=r.wrapperComponent)===null||a===void 0||a.addEventListener("wheel",r.onWheelPanning,i),u?.addEventListener("mousedown",r.onPanningStart,i),u?.addEventListener("mousemove",r.onPanning,i),u?.addEventListener("mouseup",r.onPanningStop,i),o?.addEventListener("mouseleave",r.clearPanning,i),u?.addEventListener("keyup",r.setKeyUnPressed,i),u?.addEventListener("keydown",r.setKeyPressed,i)},this.cleanupWindowEvents=function(){var n,a,i=$1(),o=(n=r.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,u=o?.defaultView;u?.removeEventListener("mousedown",r.onPanningStart,i),u?.removeEventListener("mousemove",r.onPanning,i),u?.removeEventListener("mouseup",r.onPanningStop,i),o?.removeEventListener("mouseleave",r.clearPanning,i),u?.removeEventListener("keyup",r.setKeyUnPressed,i),u?.removeEventListener("keydown",r.setKeyPressed,i),document.removeEventListener("mouseleave",r.clearPanning,i),gs(r),(a=r.observer)===null||a===void 0||a.disconnect()},this.handleInitializeWrapperEvents=function(n){var a=$1();n.addEventListener("wheel",r.onWheelZoom,a),n.addEventListener("dblclick",r.onDoubleClick,a),n.addEventListener("touchstart",r.onTouchPanningStart,a),n.addEventListener("touchmove",r.onTouchPanning,a),n.addEventListener("touchend",r.onTouchPanningStop,a)},this.handleInitialize=function(n,a){var i=!1,o=r.setup.centerOnInit,u=function(f,d){for(var p=0,x=f;p<x.length;p++){var y=x[p];if(y.target===d)return!0}return!1};r.applyTransformation(),r.onInitCallbacks.forEach(function(f){f(fr(r))}),r.observer=new ResizeObserver(function(f){if(u(f,n)||u(f,a))if(o&&!i){var d=a.offsetWidth,p=a.offsetHeight;(d>0||p>0)&&(i=!0,r.setCenter())}else gs(r),Lo(r,r.transformState.scale),py(r,0)}),r.observer.observe(n),r.observer.observe(a)},this.onWheelZoom=function(n){var a=r.setup.disabled;if(!a){var i=fL(r,n);if(i){var o=r.isPressingKeys(r.setup.wheel.activationKeys);o&&(bL(r,n),EL(r,n),TL(r,n))}}},this.onWheelPanning=function(n){var a=r.setup,i=a.disabled,o=a.wheel,u=a.panning;if(!(!r.wrapperComponent||!r.contentComponent||i||!o.wheelDisabled||u.disabled||!u.wheelPanning||n.ctrlKey)){n.preventDefault(),n.stopPropagation();var f=r.transformState,d=f.positionX,p=f.positionY,x=d-n.deltaX,y=p-n.deltaY,w=u.lockAxisX?d:x,b=u.lockAxisY?p:y,E=r.setup.alignmentAnimation,T=E.sizeX,I=E.sizeY,R=Wl(r,T),C=Wl(r,I);w===d&&b===p||Gk(r,w,b,R,C)}},this.onPanningStart=function(n){var a=r.setup.disabled,i=r.props.onPanningStart;if(!a){var o=bT(r,n);if(o){var u=r.isPressingKeys(r.setup.panning.activationKeys);u&&(n.button===0&&!r.setup.panning.allowLeftClickPan||n.button===1&&!r.setup.panning.allowMiddleClickPan||n.button===2&&!r.setup.panning.allowRightClickPan||(n.preventDefault(),n.stopPropagation(),gs(r),ST(r,n),br(fr(r),n,i)))}}},this.onPanning=function(n){var a=r.setup.disabled,i=r.props.onPanning;if(!a){var o=ET(r);if(o){var u=r.isPressingKeys(r.setup.panning.activationKeys);u&&(n.preventDefault(),n.stopPropagation(),AT(r,n.clientX,n.clientY),br(fr(r),n,i))}}},this.onPanningStop=function(n){var a=r.props.onPanningStop;r.isPanning&&(Zj(r),br(fr(r),n,a))},this.onPinchStart=function(n){var a=r.setup.disabled,i=r.props,o=i.onPinchingStart,u=i.onZoomStart;if(!a){var f=gL(r,n);f&&(SL(r,n),gs(r),br(fr(r),n,o),br(fr(r),n,u))}},this.onPinch=function(n){var a=r.setup.disabled,i=r.props,o=i.onPinching,u=i.onZoom;if(!a){var f=xL(r);f&&(n.preventDefault(),n.stopPropagation(),AL(r,n),br(fr(r),n,o),br(fr(r),n,u))}},this.onPinchStop=function(n){var a=r.props,i=a.onPinchingStop,o=a.onZoomStop;r.pinchStartScale&&(kL(r),br(fr(r),n,i),br(fr(r),n,o))},this.onTouchPanningStart=function(n){var a=r.setup.disabled,i=r.props.onPanningStart;if(!a){var o=bT(r,n);if(o){var u=r.lastTouch&&+new Date-r.lastTouch<200&&n.touches.length===1;if(!u){r.lastTouch=+new Date,gs(r);var f=n.touches,d=f.length===1,p=f.length===2;d&&(gs(r),ST(r,n),br(fr(r),n,i)),p&&r.onPinchStart(n)}}}},this.onTouchPanning=function(n){var a=r.setup.disabled,i=r.props.onPanning;if(r.isPanning&&n.touches.length===1){if(a)return;var o=ET(r);if(!o)return;n.preventDefault(),n.stopPropagation();var u=n.touches[0];AT(r,u.clientX,u.clientY),br(fr(r),n,i)}else n.touches.length>1&&r.onPinch(n)},this.onTouchPanningStop=function(n){r.onPanningStop(n),r.onPinchStop(n)},this.onDoubleClick=function(n){var a=r.setup.disabled;if(!a){var i=IL(r,n);i&&RL(r,n)}},this.clearPanning=function(n){r.isPanning&&r.onPanningStop(n)},this.setKeyPressed=function(n){r.pressedKeys[n.key]=!0},this.setKeyUnPressed=function(n){r.pressedKeys[n.key]=!1},this.isPressingKeys=function(n){return n.length?!!n.find(function(a){return r.pressedKeys[a]}):!0},this.setTransformState=function(n,a,i){var o=r.props.onTransformed;if(!Number.isNaN(n)&&!Number.isNaN(a)&&!Number.isNaN(i)){n!==r.transformState.scale&&(r.transformState.previousScale=r.transformState.scale,r.transformState.scale=n),r.transformState.positionX=a,r.transformState.positionY=i,r.applyTransformation();var u=fr(r);r.onChangeCallbacks.forEach(function(f){return f(u)}),br(u,{scale:n,positionX:a,positionY:i},o)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(r.wrapperComponent&&r.contentComponent){var n=Kk(r.transformState.scale,r.wrapperComponent,r.contentComponent);r.setTransformState(n.scale,n.positionX,n.positionY)}},this.handleTransformStyles=function(n,a,i){return r.props.customTransform?r.props.customTransform(n,a,i):cL(n,a,i)},this.applyTransformation=function(){if(!(!r.mounted||!r.contentComponent)){var n=r.transformState,a=n.scale,i=n.positionX,o=n.positionY,u=r.handleTransformStyles(i,o,a);r.contentComponent.style.transform=u}},this.getContext=function(){return fr(r)},this.onChange=function(n){return r.onChangeCallbacks.has(n)||r.onChangeCallbacks.add(n),function(){r.onChangeCallbacks.delete(n)}},this.onInit=function(n){return r.onInitCallbacks.has(n)||r.onInitCallbacks.add(n),function(){r.onInitCallbacks.delete(n)}},this.init=function(n,a){r.cleanupWindowEvents(),r.wrapperComponent=n,r.contentComponent=a,Lo(r,r.transformState.scale),r.handleInitializeWrapperEvents(n),r.handleInitialize(n,a),r.initializeWindowEvents(),r.isInitialized=!0;var i=fr(r);br(i,void 0,r.props.onInit)},this.props=e,this.setup=CT(this.props),this.transformState=Wk(this.props)}return t})(),xy=Ws.createContext(null),OL=function(t,e){return typeof t=="function"?t(e):t},FL=Ws.forwardRef(function(t,e){var r=re.useRef(new DL(t)).current,n=OL(t.children,qx(r));return re.useImperativeHandle(e,function(){return qx(r)},[r]),re.useEffect(function(){r.update(t)},[r,t]),Ws.createElement(xy.Provider,{value:r},n)});Ws.forwardRef(function(t,e){var r=re.useRef(null),n=re.useContext(xy);return re.useEffect(function(){return n.onChange(function(a){if(r.current){var i=0,o=0;r.current.style.transform=n.handleTransformStyles(i,o,1/a.instance.transformState.scale)}})},[n]),Ws.createElement("div",jl({},t,{ref:uL([r,e])}))});function ML(t,e){e===void 0&&(e={});var r=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}var PL=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,NT={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};ML(PL);var jL=function(t){var e=t.children,r=t.wrapperClass,n=r===void 0?"":r,a=t.contentClass,i=a===void 0?"":a,o=t.wrapperStyle,u=t.contentStyle,f=t.wrapperProps,d=f===void 0?{}:f,p=t.contentProps,x=p===void 0?{}:p,y=re.useContext(xy),w=y.init,b=y.cleanupWindowEvents,E=re.useRef(null),T=re.useRef(null);return re.useEffect(function(){var I=E.current,R=T.current;return I!==null&&R!==null&&w&&w?.(I,R),function(){b?.()}},[]),Ws.createElement("div",jl({},d,{ref:E,className:"".concat(Gx.wrapperClass," ").concat(NT.wrapper," ").concat(n),style:o}),Ws.createElement("div",jl({},x,{ref:T,className:"".concat(Gx.contentClass," ").concat(NT.content," ").concat(i),style:u}),e))};const ca=({isOpen:t,onClose:e,title:r,children:n})=>(re.useEffect(()=>{const a=i=>{i.key==="Escape"&&e()};return t&&window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t,e]),t?m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/90 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:m.jsxs("div",{className:`\r
            bg-white w-full max-w-lg rounded-lg overflow-hidden relative \r
            border-4 border-slate-900 \r
            shadow-[8px_8px_0px_0px_#FACC15] \r
            animate-in zoom-in-95 duration-300\r
        `,onClick:a=>a.stopPropagation(),children:[m.jsxs("div",{className:"bg-slate-900 p-4 border-b-4 border-slate-900 flex justify-between items-center relative overflow-hidden",children:[m.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-slate-800 rotate-45 transform translate-x-10 -translate-y-10"}),m.jsxs("div",{className:"flex items-center gap-2 relative z-10",children:[m.jsx(Fm,{className:"text-yellow-400 fill-yellow-400",size:24}),m.jsx("h3",{className:"text-xl font-black italic tracking-wider text-yellow-400 uppercase transform -skew-x-6",children:r})]}),m.jsx("button",{onClick:e,className:`\r
                    relative z-10 \r
                    bg-red-600 hover:bg-red-700 text-white \r
                    p-1.5 rounded border-2 border-white \r
                    transition-transform hover:scale-110 active:scale-95\r
                    shadow-lg\r
                `,children:m.jsx(fa,{size:20,strokeWidth:3})})]}),m.jsx("div",{className:"p-6 max-h-[80vh] overflow-y-auto bg-white",children:n}),m.jsxs("div",{className:"h-2 bg-yellow-400 border-t-2 border-slate-900 flex",children:[m.jsx("div",{className:"w-1/3 bg-red-600 border-r-2 border-slate-900"}),m.jsx("div",{className:"w-1/3 bg-white border-r-2 border-slate-900"}),m.jsx("div",{className:"w-1/3 bg-blue-600"})]})]})}):null);function tC({currentUser:t,onSubmit:e,onCancel:r}){const[n,a]=re.useState(t?.name||""),i=o=>{if(o.preventDefault(),!n.trim())return alert("");if(n.trim()===t?.name)return alert("");e(n)};return m.jsxs("form",{onSubmit:i,className:"space-y-4 font-sans text-slate-800",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-black text-slate-700 mb-1",children:" (Nickname)"}),m.jsxs("div",{className:"relative",children:[m.jsx(bu,{size:16,className:"absolute left-3 top-3 text-slate-400"}),m.jsx("input",{type:"text",value:n,onChange:o=>a(o.target.value),className:"w-full border-2 border-slate-900 rounded p-2 pl-9 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 text-slate-900",placeholder:"",autoFocus:!0})]}),m.jsx("p",{className:"text-xs text-slate-400 mt-1 pl-1",children:"* "})]}),m.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-slate-100",children:[m.jsxs("button",{type:"button",onClick:r,className:"px-4 py-2 rounded border-2 border-slate-300 text-slate-600 font-bold hover:bg-slate-100 transition-all",children:[m.jsx(fa,{size:16,className:"inline mr-1"})," "]}),m.jsxs("button",{type:"submit",className:"px-4 py-2 bg-slate-900 text-yellow-400 rounded font-black border-2 border-slate-900 hover:bg-slate-800 shadow-[2px_2px_0px_0px_#FACC15] active:translate-y-0.5 active:shadow-none transition-all",children:[m.jsx(ql,{size:16,className:"inline mr-1"})," "]})]})]})}const LL=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=500,u=500;let f=a.width,d=a.height;f>d?f>o&&(d*=o/f,f=o):d>u&&(f*=u/d,d=u),i.width=f,i.height=d,i.getContext("2d").drawImage(a,0,0,f,d),e(i.toDataURL("image/jpeg",.7))}}});function rC({currentUser:t,onSubmit:e}){const[r,n]=re.useState(t?.avatar||""),[a,i]=re.useState(null),o=async f=>{f.target.files&&f.target.files[0]&&i(await LL(f.target.files[0]))},u=()=>{const f=a||r;f&&e(f)};return m.jsxs("div",{className:"space-y-6",children:[m.jsx("div",{className:"flex justify-center mb-4",children:m.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden border-4 border-orange-100 shadow-md",children:m.jsx("img",{src:a||r||t?.avatar,className:"w-full h-full object-cover",alt:"avatar",onError:f=>f.target.src=`https://api.dicebear.com/7.x/avataaars/svg?seed=${t?.name}&backgroundColor=ffdfbf`})})}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-stone-600 text-sm font-bold flex items-center gap-2",children:[m.jsx(J0,{size:16})," "]}),m.jsx("input",{type:"text",className:"border border-stone-200 rounded-lg px-3 py-2 text-sm",placeholder:"",value:r,onChange:f=>{n(f.target.value),i(null)}})]}),m.jsxs("div",{className:"relative",children:[m.jsx("div",{className:"absolute inset-0 flex items-center",children:m.jsx("span",{className:"w-full border-t border-stone-200"})}),m.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:m.jsx("span",{className:"bg-white px-2 text-stone-400",children:""})})]}),m.jsxs("div",{className:"flex flex-col gap-2",children:[m.jsxs("label",{className:"text-stone-600 text-sm font-bold flex items-center gap-2",children:[m.jsx(dy,{size:16})," "]}),m.jsx("input",{type:"file",accept:"image/*",onChange:o,className:"block w-full text-sm text-stone-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-bold file:bg-orange-50 file:text-orange-600 hover:file:bg-orange-100 cursor-pointer"})]})]}),m.jsx("button",{className:"w-full py-2 bg-orange-400 text-white rounded-lg font-bold hover:bg-orange-500",onClick:u,children:""})]})}function nC({onSubmit:t}){const[e,r]=re.useState("");return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsx("label",{className:"text-stone-600 text-sm font-bold tracking-wide",children:""}),m.jsx("input",{type:"password",className:"border border-stone-200 rounded-lg px-3 py-2",placeholder:"",value:e,onChange:n=>r(n.target.value)})]}),m.jsx("button",{className:"w-full py-2 bg-orange-400 text-white rounded-lg font-bold hover:bg-orange-500 disabled:opacity-50",onClick:()=>t(e),disabled:!e,children:""})]})}const BL=["https://pbs.twimg.com/media/G8MiWocaEAAYWbC?format=jpg&name=large","https://pbs.twimg.com/media/G8MiYLNbIAA_YJg?format=jpg&name=large","https://pbs.twimg.com/media/G8MiZktakAAvzHC?format=jpg&name=large","https://pbs.twimg.com/media/G8Mis25acAAqfys?format=jpg&name=large","https://pbs.twimg.com/media/G8MivlbakAA4A73?format=jpg&name=large","https://pbs.twimg.com/media/G8MixoiaAAAyEGE?format=jpg&name=large","https://pbs.twimg.com/media/G8Mi4L9b0AAPNmS?format=jpg&name=large","https://pbs.twimg.com/media/G8Mi6X_bwAAkrMd?format=jpg&name=large","https://pbs.twimg.com/media/G8MjC5vbgAE_hJg?format=jpg&name=large","https://pbs.twimg.com/media/G8MjIZ0bwAAEAhT?format=jpg&name=large"],Ld=250;function VL({currentUser:t,onImageClick:e}){const[r,n]=re.useState([]),[a,i]=re.useState({exchangeRate:.23,totalShippingJPY:0,status:"",secondPayment:{weights:{},boxWeight:0}}),[o,u]=re.useState(!0);re.useEffect(()=>{u(!0);const w=yt(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),b=Vr(w,E=>{if(E.exists()){const T=E.data(),R=(T.orders||[]).sort((C,z)=>{const H=C.buyer.localeCompare(z.buyer);return H!==0?H:C.id-z.id});n(R),i({exchangeRate:.24,totalShippingJPY:0,status:"",secondPayment:{weights:{},boxWeight:0},...T.settings})}u(!1)});return()=>b()},[]);const f=re.useMemo(()=>r.reduce((w,b)=>b.isBought?w+b.quantity:w,0),[r]),d=re.useMemo(()=>f>0?a.totalShippingJPY/f:0,[f,a.totalShippingJPY]),p=parseFloat(a.secondPayment?.boxWeight||0),x=f>0?p*Ld/f:0,y=re.useMemo(()=>{const w={};return r.forEach(b=>{if(w[b.buyer]||(w[b.buyer]={items:[],totalItemPriceJPY:0,totalShippingShareJPY:0,totalSecondPayTWD:0,count:0}),b.isBought){const E=b.price*b.quantity,T=d*b.quantity,I=parseFloat(a.secondPayment?.weights?.[b.name]||0),C=(I*Ld+x)*b.quantity;w[b.buyer].items.push({...b,weight:I,secondPaySubtotal:C}),w[b.buyer].totalItemPriceJPY+=E,w[b.buyer].totalShippingShareJPY+=T,w[b.buyer].totalSecondPayTWD+=C,w[b.buyer].count+=b.quantity}}),w},[r,d,a.secondPayment,x]);return o?m.jsx("div",{className:"p-10 text-center font-bold text-slate-500 uppercase tracking-widest italic animate-pulse",children:"Scanning Intel..."}):m.jsxs("div",{className:"space-y-8 pb-20",children:[m.jsx("div",{className:"bg-slate-900 text-yellow-400 p-6 rounded-xl border-4 border-slate-900 shadow-[8px_8px_0px_0px_#0f172a] relative overflow-hidden",children:m.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-3xl font-black italic mb-2",children:"JS ONLINE "}),m.jsxs("div",{className:"space-y-1 font-bold text-white text-sm",children:[m.jsxs("p",{className:"flex items-center gap-2",children:[m.jsx(WM,{size:16,className:"text-yellow-400"})," 12/17 11:00  12/21 16:00"]}),m.jsxs("a",{href:"https://jumpshop-online.com/collections/jf2026",target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 underline hover:text-yellow-300",children:[m.jsx(Cl,{size:16})," "]})]})]}),m.jsx("div",{className:"bg-white p-4 rounded-lg border-4 border-slate-700 text-slate-900 w-full md:w-auto shadow-lg",children:m.jsxs("div",{className:"flex flex-col gap-3",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"font-black text-xs uppercase bg-slate-200 px-1 rounded tracking-tighter",children:"Mission Status"}),m.jsx("span",{className:"font-black text-purple-600 italic uppercase",children:a.status})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] font-black text-slate-500 block uppercase tracking-tighter",children:"Exchange Rate"}),m.jsxs("div",{className:"flex items-center font-black",children:[m.jsx(Nk,{size:14,className:"text-slate-400"}),m.jsx("span",{children:a.exchangeRate})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] font-black text-slate-500 block uppercase tracking-tighter",children:"Total PCS"}),m.jsxs("div",{className:"flex items-center font-black text-slate-900",children:[m.jsx(_p,{size:14,className:"text-slate-400 mr-1"}),m.jsx("span",{children:f})]})]})]})]})})]})}),m.jsxs("div",{className:"bg-white p-4 rounded-xl border-2 border-slate-200",children:[m.jsxs("h4",{className:"font-black text-sm text-slate-500 mb-3 flex items-center gap-2",children:[m.jsx(oy,{size:16}),"  ()"]}),m.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:BL.map((w,b)=>m.jsx("div",{onClick:()=>e(w),className:"w-20 h-20 shrink-0 bg-white rounded border border-slate-300 overflow-hidden hover:scale-105 transition-transform cursor-pointer relative group shadow-sm",children:m.jsx("img",{src:w,alt:`Item ${b}`,className:"w-full h-full object-cover"})},b))})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(y).map(([w,b])=>{const E=b.totalItemPriceJPY+b.totalShippingShareJPY,T=Math.ceil(E*a.exchangeRate),I=T+Math.round(b.totalSecondPayTWD);return m.jsxs("div",{className:"bg-white rounded-xl border-4 border-slate-900 p-5 shadow-[4px_4px_0px_0px_#6b21a8] relative overflow-hidden group hover:-translate-y-1 transition-transform",children:[m.jsxs("div",{className:"flex justify-between items-start mb-4 border-b-2 border-slate-100 pb-2",children:[m.jsx("h3",{className:"text-2xl font-black italic text-slate-900 tracking-tighter",children:w}),m.jsxs("div",{className:"text-right",children:[m.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Grand Total"}),m.jsxs("span",{className:"text-3xl font-black text-purple-600",children:["NT$ ",I.toLocaleString()]})]})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-1 text-sm font-bold text-slate-600",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsxs("span",{children:[" (",b.count,")"]}),m.jsxs("span",{children:["",b.totalItemPriceJPY.toLocaleString()]})]}),m.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[m.jsx("span",{children:""}),m.jsxs("span",{children:["",b.totalShippingShareJPY.toFixed(0)]})]}),m.jsxs("div",{className:"flex justify-between text-slate-900 border-t border-slate-100 pt-1",children:[m.jsx("span",{children:""}),m.jsxs("span",{className:"font-black",children:["NT$ ",T.toLocaleString()]})]})]}),m.jsxs("div",{className:"bg-blue-50/50 p-2 rounded-lg border border-blue-100 space-y-1",children:[m.jsxs("div",{className:"flex justify-between text-sm font-black text-blue-800",children:[m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(Mk,{size:14})," "]}),m.jsxs("span",{children:["NT$ ",Math.round(b.totalSecondPayTWD).toLocaleString()]})]}),m.jsx("p",{className:"text-[9px] text-blue-400 leading-tight",children:" + "})]})]}),m.jsxs("div",{className:"mt-4 space-y-2",children:[m.jsxs("details",{className:"group/detail border-t border-slate-100 pt-2",children:[m.jsxs("summary",{className:"text-[11px] font-black text-slate-500 cursor-pointer hover:text-slate-900 list-none flex justify-between items-center uppercase tracking-tighter",children:[m.jsx("span",{children:" ()"}),m.jsx(Sk,{size:12,className:"group-open/detail:rotate-180 transition-transform"})]}),m.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-y-auto pr-1",children:b.items.map((R,C)=>m.jsxs("div",{className:"flex justify-between text-[11px] font-bold text-slate-600 bg-slate-50 p-1.5 rounded border border-slate-100",children:[m.jsxs("span",{className:"truncate w-2/3",children:[R.ip," ",R.name," x",R.quantity]}),m.jsxs("span",{className:"font-mono",children:["",R.price*R.quantity]})]},C))})]}),m.jsxs("details",{className:"group/weight border-t border-slate-100 pt-2",children:[m.jsxs("summary",{className:"text-[11px] font-black text-blue-500 cursor-pointer hover:text-blue-700 list-none flex justify-between items-center uppercase tracking-tighter",children:[m.jsx("span",{children:" ()"}),m.jsx(fy,{size:12,className:"group-open/weight:rotate-180 transition-transform"})]}),m.jsxs("div",{className:"mt-2 space-y-1 bg-blue-50/30 p-2 rounded-lg border border-blue-100",children:[b.items.map((R,C)=>m.jsxs("div",{className:"flex justify-between text-[10px] font-bold text-blue-600/80",children:[m.jsxs("span",{className:"truncate w-2/3",children:[R.name," (",R.weight,"kg)"]}),m.jsxs("span",{className:"font-mono",children:["NT$ ",Math.round(R.secondPaySubtotal)]})]},C)),m.jsxs("div",{className:"flex justify-between text-[10px] font-black text-blue-400 border-t border-blue-100 mt-1 pt-1 italic",children:[m.jsx("span",{children:" ()"}),m.jsxs("span",{children:["NT$ ",x.toFixed(1)]})]})]})]})]})]},w)})}),m.jsxs("div",{className:"max-w-xl mx-auto bg-slate-100 p-4 rounded-xl border-2 border-dashed border-slate-300 flex items-start gap-3",children:[m.jsx(Z0,{size:20,className:"text-slate-400 shrink-0 mt-1"}),m.jsxs("div",{className:"text-[12px] font-bold text-slate-500 leading-relaxed",children:[m.jsx("p",{className:"text-slate-900 uppercase tracking-widest mb-1",children:"Calculation Protocol:"}),m.jsx("p",{children:"1.  = ( + )   ()"}),m.jsxs("p",{children:["2.  = [(  ",Ld,") + (  ",Ld," / )]  "]}),m.jsx("p",{children:"3.  =  + "})]})]})]})}const UL={titi:"",xiaomei:"",heng:"",baobao:"",yeye:"",Sjie:"S",qiaoyu:"",teacher:"",ann:"",Aurora:"Aurora"};function zL({currentUser:t}){const[e,r]=re.useState("vendors"),[n,a]=re.useState(!1),[i,o]=re.useState(null),[u,f]=re.useState(null),[d,p]=re.useState(0),x=t?.id==="yeye",y=t?.isMember;re.useEffect(()=>{if(!t?.id)return;const R=UL[t.id]||t.name,C=250;let z=0,H=0;const X=Vr(yt(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),F=>{if(F.exists()){const N=F.data(),P=N.orders||[],M=N.settings||{},j=M.secondPayment||{weights:{},boxWeight:0},B=P.reduce((oe,le)=>le.isBought?oe+le.quantity:oe,0),Se=B>0?M.totalShippingJPY/B:0,we=B>0?parseFloat(j.boxWeight||0)*C/B:0;z=P.filter(oe=>oe.buyer===R&&oe.isBought).reduce((oe,le)=>{let ne=0;if(le.paymentStatus!==""){const ye=Number(le.price)*Number(le.quantity)+Se*le.quantity;ne+=Math.ceil(ye*(M.exchangeRate||.24))}if(le.shippingPaymentStatus!==""){const ye=parseFloat(j.weights[le.name]||0);ne+=Math.ceil(ye*C*le.quantity+we*le.quantity)}return oe+ne},0)}p(z+H)}),A=Vr(qt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders"),async F=>{const N=await p9(yt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_settings","main")),P=N.exists()&&N.data().totalDomesticShipping||0,M=F.docs.map(we=>we.data());let j=0;M.forEach(we=>we.items?.forEach(se=>{se.status==="WON"&&(j+=Number(se.qty))}));const B=j>0?P/j:0;let Se=0;M.forEach(we=>we.items?.forEach(se=>{if(se.status==="WON"&&se.assignedTo===R){const oe=Number(se.qty);Se+=Number(se.price)*oe+B*oe}})),H=Math.ceil(Se*.24),p(z+H)});return()=>{X(),A()}},[t]);const w=()=>{localStorage.removeItem("app_user_id"),window.location.reload()},b=async R=>{await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{name:R}),o(null)},E=async R=>{await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{avatar:R}),o(null)},T=async R=>{await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{password:R}),o(null)},I=async()=>{if(t)if(t.isMember){if(t.memberValidUntil)confirm("")&&await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{memberValidUntil:null,memberCancelledAt:null});else if(confirm("")){const R=new Date;R.setDate(R.getDate()+30),await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberValidUntil:R.toISOString(),memberCancelledAt:new Date().toISOString()})}}else confirm(" PLUS ULTRA ")&&await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberSince:new Date().toISOString(),memberValidUntil:null,memberCancelledAt:null})};return m.jsxs("div",{className:"min-h-screen bg-slate-50 font-sans pb-20 selection:bg-yellow-400 selection:text-black",children:[m.jsx("header",{className:"sticky top-0 z-30 bg-slate-900 border-b-4 border-yellow-400 px-4 py-3 shadow-md",children:m.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-0",children:[m.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[m.jsxs(du,{to:"/home",className:"flex items-center gap-2 bg-yellow-400 px-4 py-1.5 rounded transform -skew-x-12 border-2 border-yellow-600 hover:scale-105 transition-transform group",children:[m.jsx(Ak,{size:20,className:"text-slate-900 transform skew-x-12 group-hover:-translate-x-1 transition-transform",strokeWidth:3}),m.jsx("span",{className:"text-slate-900 font-black text-sm transform skew-x-12 hidden",children:""})]}),m.jsx("h1",{className:"text-2xl font-black italic tracking-tight text-white",children:"JF26 "})]}),m.jsxs("div",{className:"flex items-center justify-end gap-2 sm:gap-4 w-full sm:w-auto",children:[t&&m.jsx(HL,{amount:d}),m.jsxs("div",{className:"text-right hidden sm:block",children:[m.jsx("p",{className:"text-xs text-slate-400",children:"HERO NAME"}),m.jsx("p",{className:"font-bold text-white tracking-wide",children:t?.name})]}),m.jsxs("div",{className:"relative",children:[m.jsxs("button",{onClick:()=>a(!n),className:`w-10 h-10 rounded-full bg-slate-800 border-2 ${y?"border-purple-500":"border-yellow-400"} shadow-lg overflow-hidden hover:scale-105 transition-all relative`,children:[m.jsx("img",{src:t?.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${t?.name}`,alt:"avatar",className:"w-full h-full object-cover"}),y&&m.jsx("div",{className:"absolute -top-1 -right-1 bg-purple-600 rounded-full p-0.5 border border-white",children:m.jsx(Im,{size:8,className:"text-white fill-white"})})]}),n&&m.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-xl border-2 border-slate-900 py-1 z-50 animate-in fade-in slide-in-from-top-2 text-slate-700",children:[m.jsxs("div",{className:"px-3 py-2 border-b-2 border-slate-100 bg-slate-50",children:[m.jsxs("div",{className:"flex justify-between items-center mb-1",children:[m.jsxs("span",{className:"text-xs font-black flex items-center gap-1",children:[m.jsx(Im,{size:12,className:y?"text-purple-600 fill-purple-600":"text-slate-300"})," PLUS "]}),y&&m.jsx("span",{className:"text-[10px] bg-purple-100 text-purple-700 px-1.5 rounded font-bold",children:"SUBSCRIBED"})]}),m.jsx("button",{onClick:I,className:`w-full text-xs font-bold py-1.5 rounded border-2 transition-all ${y&&t.memberValidUntil?"bg-green-100 text-green-700 border-green-300 hover:bg-green-200":y?"bg-white border-slate-300 text-slate-500 hover:bg-red-50 hover:text-red-500 hover:border-red-300":"bg-purple-600 border-purple-800 text-white hover:bg-purple-700"}`,children:y?t.memberValidUntil?"":"":""})]}),m.jsxs("button",{onClick:()=>{a(!1),o("changeName")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 font-bold",children:[m.jsx(bu,{size:16})," "]}),m.jsxs("button",{onClick:()=>{a(!1),o("changeAvatar")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 font-bold",children:[m.jsx(oy,{size:16})," "]}),m.jsxs("button",{onClick:()=>{a(!1),o("changePwd")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 font-bold",children:[m.jsx(Dk,{size:16})," "]}),x&&m.jsx("div",{className:"border-t border-slate-100 mt-1",children:m.jsxs(du,{to:"/admin/dashboard",className:"block px-4 py-2 text-sm text-blue-700 font-black hover:bg-blue-50 flex items-center gap-2",onClick:()=>a(!1),children:[m.jsx(jk,{size:16})," "]})}),m.jsx("div",{className:"border-t-2 border-slate-100 my-1"}),m.jsxs("button",{onClick:w,className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2 font-black",children:[m.jsx(Ok,{size:16})," "]})]})]})]})]})}),m.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[m.jsxs("div",{className:"text-center mb-8 relative",children:[m.jsxs("div",{className:"inline-block relative",children:[m.jsx("h2",{className:"text-5xl font-black text-slate-900 italic transform -skew-x-6 z-10 relative",children:"JUMP FESTA 2026"}),m.jsx("div",{className:"absolute -bottom-2 -right-4 w-[110%] h-6 bg-yellow-400 -z-0 transform -skew-x-6"})]}),m.jsxs("p",{className:"text-slate-500 font-bold mt-4 flex items-center justify-center gap-2",children:[m.jsx(_T,{size:18,className:"text-slate-900"})," ..."]}),m.jsxs("div",{className:"flex justify-center gap-3 text-sm font-black mt-6 flex-wrap",children:[m.jsxs("a",{href:"https://www.jumpfesta.com/maker/",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JF26  ",m.jsx(Cl,{size:14})]}),m.jsxs("a",{href:"https://jumpcs.shueisha.co.jp/shop/pages/jumpfesta.aspx",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JCS ",m.jsx(Cl,{size:14})]}),m.jsxs("a",{href:"https://docs.google.com/spreadsheets/d/1zfT-MMN-DwIRamibiAQUyp4lJLGBoxS3Rpeb1aVJLK8/edit?usp=sharing",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JF26  ",m.jsx(Cl,{size:14})]}),m.jsxs("a",{href:"https://forms.gle/VsHvAvraVQp4dHaK8",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-yellow-400 border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JF26  ",m.jsx(Cl,{size:14})]})]})]}),m.jsx("nav",{className:"max-w-md mx-auto mb-8 px-4",children:m.jsx("div",{className:"bg-white p-1 rounded-lg shadow-sm border-2 border-slate-200 flex justify-around gap-1",children:[{id:"vendors",label:"",icon:_T},{id:"js_pre",label:"JS ",icon:yp},{id:"jcs_lottery",label:"JCS ",icon:e0}].map(R=>{const C=R.icon,z=e===R.id;return m.jsxs("button",{onClick:()=>r(R.id),className:`flex-1 flex flex-col items-center justify-center gap-1 py-2 px-0.5 sm:px-4 rounded font-black transition-all border-2 ${z?"bg-slate-900 border-slate-900 text-yellow-400 shadow-md transform -translate-y-1":"bg-transparent border-transparent text-slate-500 hover:bg-slate-100"}`,children:[m.jsx(C,{size:20,className:z?"animate-pulse":""}),m.jsx("span",{className:"text-[11px] sm:text-sm whitespace-nowrap",children:R.label})]},R.id)})})}),m.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e==="vendors"&&m.jsx(qL,{currentUser:t}),e==="js_pre"&&m.jsx(VL,{currentUser:t,isAdmin:x,onImageClick:f}),e==="jcs_lottery"&&m.jsx(GL,{})]})]}),m.jsx(ca,{isOpen:i==="changeName",onClose:()=>o(null),title:"",children:m.jsx(tC,{currentUser:t,onSubmit:b,onCancel:()=>o(null)})}),m.jsx(ca,{isOpen:i==="changePwd",onClose:()=>o(null),title:"",children:m.jsx(nC,{onSubmit:T})}),m.jsx(ca,{isOpen:i==="changeAvatar",onClose:()=>o(null),title:"",children:m.jsx(rC,{currentUser:t,onSubmit:E})}),u&&m.jsx("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-0 animate-in fade-in duration-200",children:m.jsx(FL,{initialScale:1,minScale:.5,maxScale:4,centerOnInit:!0,children:({zoomIn:R,zoomOut:C,resetTransform:z})=>m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"absolute top-4 right-4 z-[110] flex items-center gap-2 bg-slate-900/80 p-2 rounded-full border border-slate-700 shadow-xl",children:[m.jsx("button",{onClick:()=>R(),className:"p-2 text-white hover:text-yellow-400",children:m.jsx(vj,{size:20})}),m.jsx("button",{onClick:()=>C(),className:"p-2 text-white hover:text-yellow-400",children:m.jsx(_j,{size:20})}),m.jsx("button",{onClick:()=>z(),className:"p-2 text-white hover:text-yellow-400",children:m.jsx(MP,{size:20})}),m.jsx("div",{className:"w-px h-6 bg-slate-600 mx-1"}),m.jsx("button",{onClick:()=>f(null),className:"p-2 text-white hover:text-red-400",children:m.jsx(fa,{size:20})})]}),m.jsx(jL,{wrapperClass:"!w-screen !h-screen",contentClass:"!w-screen !h-screen flex items-center justify-center",children:m.jsx("img",{src:u,alt:"Full Preview",className:"max-w-full max-h-full object-contain"})})]})})})]})}function HL({amount:t}){return m.jsxs("div",{className:"relative group border-r border-slate-700 mr-1 pr-2 sm:mr-2 sm:pr-4 flex w-full items-center justify-end gap-3 sm:w-auto sm:flex-col sm:items-end sm:gap-0",children:[m.jsxs("button",{className:"focus:outline-none group/btn flex items-center gap-2 sm:mb-1 sm:gap-1.5",onClick:()=>alert(" JS JCS "),children:[m.jsx("span",{className:"text-[16px] sm:text-base text-slate-400 font-bold whitespace-nowrap pt-0.5",children:""}),m.jsx(Ux,{className:"text-yellow-500",size:14})]}),m.jsxs("div",{className:"text-yellow-400 font-black drop-shadow-sm text-right flex items-center",children:[m.jsx("span",{className:"text-xs mr-1 text-yellow-200 mt-1",children:"NT$"}),m.jsx("span",{className:"text-xl font-mono",children:t.toLocaleString()})]})]})}function GL(){const[t,e]=re.useState([]),[r,n]=re.useState({totalDomesticShipping:0,exchangeRate:.24});re.useEffect(()=>{const i=Vr(qt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders"),u=>{const f={};u.docs.forEach(p=>{f[p.id]=p.data()});const d=Array.from({length:10},(p,x)=>{const y=`order_${x+1}`;return{id:y,index:x+1,...f[y]||{items:[]}}});e(d)}),o=Vr(yt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_settings","main"),u=>{u.exists()&&n(u.data())});return()=>{i(),o()}},[]);const a=i=>i==="WON"?"bg-green-100 text-green-700 border-green-200":i==="LOST"?"bg-slate-100 text-slate-400 border-slate-200 grayscale opacity-70":"bg-white text-slate-900 border-slate-200";return m.jsxs("div",{children:[m.jsx("div",{className:"bg-slate-900 text-yellow-400 p-6 rounded-xl border-4 border-yellow-400 shadow-[8px_8px_0px_0px_#0f172a] mb-10",children:m.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-3xl font-black italic mb-2",children:"JCS "}),m.jsxs("div",{className:"flex gap-4 text-sm font-bold text-white/80",children:[m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(Z0,{size:14})," :",r.exchangeRate||.24]}),m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(_p,{size:14})," : ",Number(r.totalDomesticShipping).toLocaleString()]})]})]}),m.jsx("div",{className:"bg-yellow-400 text-slate-900 px-4 py-2 rounded font-black border-2 border-yellow-600 rotate-2 text-xs sm:text-sm",children:" 12/23 "})]})}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map(i=>m.jsxs("div",{className:"bg-white rounded-xl border-4 border-slate-900 overflow-hidden shadow-[4px_4px_0px_0px_#6b21a8]",children:[m.jsx("div",{className:"bg-slate-900 text-white px-4 py-3 flex justify-between items-center",children:m.jsxs("h4",{className:"font-black italic text-lg flex items-center gap-2",children:[m.jsx(e0,{size:20,className:"text-purple-400"})," ORDER #",i.index]})}),m.jsx("div",{className:"p-4 min-h-[120px]",children:!i.items||i.items.length===0?m.jsx("div",{className:"text-slate-300 font-bold text-center py-6",children:"..."}):m.jsx("div",{className:"space-y-3 text-slate-700",children:i.items.map((o,u)=>m.jsx("div",{className:`p-2 rounded border-2 ${a(o.status)}`,children:m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsxs("div",{children:[m.jsx("div",{className:"font-bold text-sm",children:o.name}),m.jsxs("div",{className:"text-[10px] opacity-75",children:["",o.price," x ",o.qty]})]}),m.jsxs("div",{className:"text-right",children:[m.jsxs("div",{className:"font-black",children:["",o.price*o.qty]}),o.assignedTo?m.jsxs("div",{className:"text-[10px] font-black bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded border border-blue-200 mt-1",children:[": ",o.assignedTo]}):m.jsx("div",{className:"text-[10px] font-black bg-slate-100 text-slate-400 px-1.5 py-0.5 rounded border border-slate-200 mt-1",children:""})]})]})},u))})})]},i.id))})]})}function qL({currentUser:t}){const[e,r]=re.useState([]),[n,a]=re.useState(""),[i,o]=re.useState(null);re.useEffect(()=>{const x=Vr(qt(Ke,"artifacts","default-app-id","public","data","jf26_vendors"),y=>{const w=y.docs.map(b=>({id:b.id,...b.data()}));r(w.sort((b,E)=>(b.order||0)-(E.order||0)))});return()=>x()},[]);const u=x=>{try{const y=x.updatedAt||x.createdAt;if(!y)return!1;const w=`vendor_${x.id}`,b=t?.readHistory?.[w]||localStorage.getItem(`read_${t?.id}_${w}`);return!b||new Date(y)>new Date(b)}catch{return!1}},f=async x=>{if(!t?.id)return;const y=new Date().toISOString(),w=`vendor_${x.id}`;localStorage.setItem(`read_${t.id}_${w}`,y),await su(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{readHistory:{[w]:y}},{merge:!0})},d=e.filter(x=>(x.name||"").toLowerCase().includes(n.toLowerCase())||(Array.isArray(x.products)?x.products.some(y=>y.toLowerCase().includes(n.toLowerCase())):!1)),p=x=>{switch(x){case"":return"bg-yellow-400 text-slate-900 border-slate-900";case"":return"bg-blue-500 text-white border-slate-900";case"":return"bg-red-600 text-white border-slate-900";default:return"bg-white text-slate-800 border-slate-900"}};return m.jsxs("div",{children:[m.jsxs("div",{className:"mb-10 w-full h-12 rounded-xl border-4 border-slate-900 bg-white shadow-[4px_4px_0px_0px_#0f172a] flex items-center overflow-hidden",children:[m.jsx("div",{className:"pl-4 pr-2 text-slate-900",children:m.jsx(Pk,{size:24,strokeWidth:3})}),m.jsx("input",{type:"text",placeholder:"  IP...",className:"w-full h-full border-none outline-none font-bold text-lg",value:n,onChange:x=>a(x.target.value)})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(x=>m.jsxs("div",{onClick:()=>f(x),className:"bg-white rounded-xl border-4 border-slate-900 p-5 shadow-[8px_8px_0px_0px_#FACC15] hover:-translate-y-1 hover:shadow-[10px_10px_0px_0px_#FACC15] transition-all relative cursor-pointer group",children:[u(x)&&m.jsx("div",{className:"absolute -top-3 -left-3 bg-red-600 text-white text-xs font-black px-2 py-1 shadow-md transform -rotate-12 z-20 border-2 border-white animate-bounce",children:"NEW!"}),m.jsx("div",{className:"absolute top-3 right-3 w-3 h-3 rounded-full bg-slate-200 border-2 border-slate-900 z-10"}),m.jsx("div",{className:"flex justify-between items-start mb-4 pr-4 border-b-2 border-slate-100 pb-2",children:m.jsx("h3",{className:"font-black text-2xl text-slate-900 leading-tight italic",children:x.name})}),x.tags&&m.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:x.tags.map(y=>m.jsx("span",{className:`text-[11px] font-black px-2 py-0.5 border-2 shadow-[2px_2px_0px_0px_rgba(0,0,0,0.1)] ${p(y)}`,children:y},y))}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsxs("p",{className:"text-xs font-black text-slate-400 mb-2 flex items-center gap-1 uppercase tracking-wider",children:[m.jsx(bu,{size:12}),"  (IPs)"]}),m.jsxs("div",{className:"flex flex-wrap gap-2",children:[(x.products||[]).slice(0,10).map((y,w)=>m.jsx("span",{className:"bg-yellow-50 text-slate-900 text-xs font-bold px-2 py-1 border-2 border-slate-200 transition-transform hover:scale-105 hover:border-slate-900 hover:bg-yellow-200",children:y},w)),(x.products||[]).length>10&&m.jsxs("button",{onClick:y=>{y.stopPropagation(),o(x)},className:"bg-slate-800 text-white text-xs font-bold px-2 py-1 border-2 border-slate-900 hover:bg-slate-700 transition-colors cursor-pointer flex items-center gap-1",children:[m.jsx(pP,{size:12})," MORE..."]})]})]}),m.jsxs("div",{className:"space-y-2 bg-slate-50 p-3 rounded border-2 border-slate-200 relative",children:[x.preOrder?.period&&m.jsxs("div",{className:"text-sm",children:[m.jsx("span",{className:"text-[10px] font-black bg-yellow-400 text-slate-900 px-1 border border-slate-900 mr-2",children:""}),m.jsx("span",{className:"font-bold text-slate-700",children:x.preOrder.period})]}),x.postOrder?.period&&m.jsxs("div",{className:"text-sm",children:[m.jsx("span",{className:"text-[10px] font-black bg-blue-500 text-white px-1 border border-slate-900 mr-2",children:""}),m.jsx("span",{className:"font-bold text-slate-700",children:x.postOrder.period})]}),x.tags?.includes("")&&m.jsxs("div",{className:"text-sm flex items-center gap-2 text-red-600 font-black",children:[m.jsx(_P,{size:14}),"  JUMP FESTA "]})]}),x.notes&&m.jsxs("div",{className:"flex items-start gap-2 bg-red-50 p-2 rounded border-2 border-red-100",children:[m.jsx(zM,{size:14,className:"text-red-500 mt-0.5 shrink-0"}),m.jsx("p",{className:"text-xs font-bold text-red-600 leading-relaxed",children:x.notes})]})]}),m.jsxs("div",{className:"mt-6 space-y-3 pt-4 border-t-2 border-slate-100",children:[m.jsxs("div",{className:"flex gap-2",children:[x.preOrder?.url&&m.jsxs("a",{href:x.preOrder.url,target:"_blank",rel:"noreferrer",onClick:y=>y.stopPropagation(),className:"flex-1 py-2 bg-yellow-400 text-slate-900 text-center font-black rounded border-2 border-slate-900 hover:bg-yellow-300 transition-colors flex items-center justify-center gap-1 text-xs shadow-[3px_3px_0px_0px_#0f172a] active:translate-y-0.5 active:shadow-none",children:[m.jsx(yp,{size:14,strokeWidth:3})," "]}),x.postOrder?.url&&m.jsxs("a",{href:x.postOrder.url,target:"_blank",rel:"noreferrer",onClick:y=>y.stopPropagation(),className:"flex-1 py-2 bg-blue-500 text-white text-center font-black rounded border-2 border-slate-900 hover:bg-blue-400 transition-colors flex items-center justify-center gap-1 text-xs shadow-[3px_3px_0px_0px_#0f172a] active:translate-y-0.5 active:shadow-none",children:[m.jsx(_p,{size:14,strokeWidth:3})," "]})]}),x.mainUrl&&m.jsxs("a",{href:x.mainUrl,target:"_blank",rel:"noreferrer",onClick:y=>y.stopPropagation(),className:"block w-full py-2 bg-slate-100 text-slate-700 text-center font-black rounded border-2 border-slate-900 hover:bg-slate-200 transition-colors flex items-center justify-center gap-2 text-sm",children:[m.jsx(Cl,{size:16})," /"]})]})]},x.id))}),i&&m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:()=>o(null),children:m.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-2xl border-4 border-slate-900 overflow-hidden",onClick:x=>x.stopPropagation(),children:[m.jsxs("div",{className:"bg-slate-900 px-4 py-3 border-b-4 border-yellow-400 flex justify-between items-center",children:[m.jsxs("h3",{className:"font-black text-lg text-white flex items-center gap-2 truncate italic",children:[m.jsx(bu,{size:20,className:"text-yellow-400"})," ",i.name]}),m.jsx("button",{onClick:()=>o(null),className:"text-slate-400 hover:text-white transition-colors",children:m.jsx(fa,{size:24})})]}),m.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto bg-slate-50",children:m.jsx("div",{className:"flex flex-wrap gap-2",children:(i.products||[]).map((x,y)=>m.jsx("span",{className:"bg-white text-slate-900 text-sm font-bold px-3 py-2 border-2 border-slate-900 shadow-[2px_2px_0px_0px_#ccc]",children:x},y))})})]})})]})}function WL(){const[t,e]=re.useState(!1),[r,n]=re.useState(!0),a=re.useRef(null),i="4sNrzUoSLQY",o=`https://www.youtube.com/embed/${i}?autoplay=1&mute=1&loop=1&playlist=${i}&controls=1&enablejsapi=1`,u=()=>{if(!a.current)return;const f=r?"unMute":"mute";a.current.contentWindow.postMessage(JSON.stringify({event:"command",func:f,args:[]}),"*"),n(!r)};return m.jsx("div",{className:`
                fixed bottom-4 z-[9999] transition-all duration-300
                ${t?"left-4":"left-1/2 -translate-x-1/2 md:left-4 md:translate-x-0"}
                ${t?"w-12 h-12":"w-80"}
            `,children:m.jsxs("div",{className:"bg-slate-900 border-4 border-yellow-400 rounded-xl shadow-[4px_4px_0px_0px_#000] overflow-hidden flex flex-col h-full",children:[m.jsx("div",{style:{display:t?"none":"block",height:"180px"},children:m.jsx("iframe",{ref:a,width:"100%",height:"100%",src:o,title:"YouTube music player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})}),t?m.jsx("button",{onClick:()=>e(!1),className:"w-full h-full flex items-center justify-center text-yellow-400 hover:bg-slate-800 bg-slate-900",children:m.jsx(yT,{size:20,className:"animate-pulse"})}):m.jsxs("div",{className:"p-3 bg-slate-900",children:[m.jsxs("div",{className:"flex justify-between items-center mb-1",children:[m.jsxs("span",{className:"text-[10px] font-black text-yellow-400 flex items-center gap-1",children:[m.jsx(yT,{size:12})," BGM PLAYER"]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("button",{onClick:u,className:`hover:text-yellow-400 transition-colors ${r?"text-slate-400":"text-yellow-400"}`,title:r?"":"",children:r?m.jsx(mj,{size:16}):m.jsx(hj,{size:16})}),m.jsx("button",{onClick:()=>e(!0),className:"text-slate-400 hover:text-white",children:m.jsx(cy,{size:16})})]})]}),m.jsx("div",{className:"text-[10px] text-slate-400 text-center truncate px-1",children:r?" ":":   | "})]})]})})}const XL=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=800,u=800;let f=a.width,d=a.height;f>d?f>o&&(d*=o/f,f=o):d>u&&(f*=u/d,d=u),i.width=f,i.height=d,i.getContext("2d").drawImage(a,0,0,f,d),e(i.toDataURL("image/jpeg",.7))}}});function YL({onSubmit:t,onCancel:e,initialData:r=null}){const[n,a]=re.useState(r?.title||""),[i,o]=re.useState(()=>r?.images?.filter(R=>R.startsWith("http"))?.join(", ")||""),[u,f]=re.useState(r?.url||""),[d,p]=re.useState(r?.note||""),[x,y]=re.useState(()=>r?.images?.filter(R=>R.startsWith("data:"))||[]),w=async R=>{if(R.target.files){const X=5-(i.split(",").map(N=>N.trim()).filter(N=>N).length+x.length);if(X<=0){alert(" 5 "),R.target.value=null;return}const A=Array.from(R.target.files).slice(0,X),F=await Promise.all(A.map(N=>XL(N)));y(N=>[...N,...F]),R.target.value=null}},b=R=>{y(C=>C.filter((z,H)=>H!==R))},E=()=>{if(!n)return alert("");const C=[...i.split(",").map(z=>z.trim()).filter(z=>z),...x];t({title:n,images:C,url:u,note:d})},T=x.length+i.split(",").map(R=>R.trim()).filter(R=>R).length,I=!!r;return m.jsxs("form",{onSubmit:R=>{R.preventDefault(),E()},className:"flex flex-col gap-4 text-slate-800",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(vT,{size:16}),"  ()"]}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",placeholder:" ",value:n,onChange:R=>a(R.target.value),required:!0})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(J0,{size:16}),"  ()"]}),m.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 text-sm h-16 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",placeholder:"",value:i,onChange:R=>o(R.target.value)})]}),m.jsxs("div",{className:"flex flex-col gap-2 p-3 border-2 border-dashed border-slate-300 rounded-lg bg-slate-100",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 flex items-center justify-between",children:[m.jsxs("span",{children:[m.jsx(dy,{size:16,className:"inline mr-1"}),"  ( ",T," / 5)"]}),T>=5&&m.jsx("span",{className:"text-red-600 font-bold",children:""})]}),m.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:w,disabled:T>=5,className:"block w-full text-sm text-slate-700 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-2 file:border-red-800 file:text-xs file:font-black file:bg-red-600 file:text-white hover:file:bg-red-700 cursor-pointer disabled:opacity-50"}),x.length>0&&m.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 pb-4",children:x.map((R,C)=>m.jsxs("div",{className:"relative shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 border-slate-900 shadow",children:[m.jsx("img",{src:R,className:"w-full h-full object-cover",alt:"preview"}),m.jsx("button",{type:"button",onClick:()=>b(C),className:"absolute top-0 right-0 bg-red-600 text-white rounded-full p-1 transform translate-x-1/3 -translate-y-1/3 border-2 border-white hover:bg-red-700 transition-all",children:m.jsx(fa,{size:12})})]},C))})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(Cl,{size:16}),"  ()"]}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:u,onChange:R=>f(R.target.value),placeholder:"https://www.amazon.co.jp/..."})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(vT,{size:16})," / ()"]}),m.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 h-24 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",maxLength:500,value:d,onChange:R=>p(R.target.value),placeholder:" M  8000"})]}),m.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[m.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[m.jsx(fa,{size:16,className:"inline mr-1"})," "]}),m.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-red-600 text-white border-2 border-red-800 hover:bg-red-700 font-black italic shadow-[2px_2px_0px_0px_rgba(153,27,27,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[m.jsx(ql,{size:16,className:"inline mr-1"})," ",I?"":""]})]})]})}function $L({onSubmit:t,onCancel:e}){const[r,n]=re.useState(""),[a,i]=re.useState(""),[o,u]=re.useState(""),[f,d]=re.useState(""),[p,x]=re.useState([{id:Date.now(),name:"",price:"",quantity:1,url:""}]),y=()=>{x([...p,{id:Date.now(),name:"",price:"",quantity:1,url:""}])},w=T=>{p.length>1&&x(p.filter(I=>I.id!==T))},b=(T,I,R)=>{x(p.map(C=>C.id===T?{...C,[I]:R}:C))},E=T=>{if(T.preventDefault(),!r.trim())return alert(" IP ");if(!o.trim())return alert("");const I=p.filter(R=>R.name.trim()&&R.price);if(I.length===0)return alert("");t({ipName:r,type:a,sourceUrl:o,note:f,items:I})};return m.jsxs("form",{onSubmit:E,className:"space-y-5 font-sans text-slate-800",children:[m.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200",children:[m.jsxs("h4",{className:"font-black italic text-lg text-slate-900 border-b-2 border-slate-300 pb-2 mb-3 flex items-center gap-2",children:[m.jsx(Z0,{size:20,className:"text-blue-600"}),"  (INFO)"]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" IP /  ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:" ...",value:r,onChange:T=>n(T.target.value)})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsxs("div",{className:"flex gap-3",children:[m.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg p-2 text-center font-black transition-all ${a===""?"bg-slate-900 text-yellow-400 border-slate-900 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[m.jsx("input",{type:"radio",className:"hidden",value:"",checked:a==="",onChange:()=>i("")})," "]}),m.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg p-2 text-center font-black transition-all ${a===""?"bg-green-600 text-white border-green-800 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[m.jsx("input",{type:"radio",className:"hidden",value:"",checked:a==="",onChange:()=>i("")})," "]})]})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" /  ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsxs("div",{className:"relative",children:[m.jsx(Dm,{size:16,className:"absolute left-3 top-3 text-slate-400"}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 pl-9 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:"...",value:o,onChange:T=>u(T.target.value)})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-black text-slate-700 mb-1",children:" ()"}),m.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-medium placeholder:font-normal h-20",placeholder:"...",value:f,onChange:T=>d(T.target.value)})]})]})]}),m.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border-2 border-slate-300",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsxs("h4",{className:"font-black italic text-lg text-slate-900 transform -skew-x-3 flex items-center gap-2",children:[m.jsx(yp,{size:20,className:"text-red-600"}),"  (ITEMS)"]}),m.jsx("button",{type:"button",onClick:y,className:"text-xs font-black px-3 py-1.5 bg-yellow-400 text-slate-900 rounded border-2 border-slate-900 hover:bg-yellow-500 transition-all shadow-sm",children:"+ "})]}),m.jsx("div",{className:"space-y-3",children:p.map((T,I)=>m.jsxs("div",{className:"bg-white p-3 rounded-lg border-2 border-slate-900 relative shadow-[2px_2px_0px_0px_rgba(15,23,42,1)] animate-in fade-in slide-in-from-bottom-1",children:[m.jsxs("div",{className:"flex justify-between items-center mb-2 border-b border-dashed border-slate-200 pb-1",children:[m.jsxs("span",{className:"text-xs font-black text-slate-400 italic",children:["ITEM #",I+1]}),p.length>1&&m.jsx("button",{type:"button",onClick:()=>w(T.id),className:"text-red-400 hover:text-red-600",children:m.jsx(fa,{size:16})})]}),m.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[m.jsxs("div",{className:"col-span-8",children:[m.jsxs("label",{className:"text-[10px] font-bold text-slate-500",children:[" ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsx("input",{className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm font-bold focus:border-slate-900 focus:ring-0",placeholder:" S",value:T.name,onChange:R=>b(T.id,"name",R.target.value)})]}),m.jsxs("div",{className:"col-span-4",children:[m.jsxs("label",{className:"text-[10px] font-bold text-slate-500",children:[" ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsx("input",{type:"number",className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm font-black text-red-600 focus:border-slate-900 focus:ring-0",placeholder:"",value:T.price,onChange:R=>b(T.id,"price",R.target.value)})]}),m.jsxs("div",{className:"col-span-4 sm:col-span-3",children:[m.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),m.jsxs("div",{className:"flex items-center",children:[m.jsx("button",{type:"button",onClick:()=>b(T.id,"quantity",Math.max(1,T.quantity-1)),className:"bg-slate-200 p-1 rounded-l border-y-2 border-l-2 border-slate-200 hover:bg-slate-300",children:m.jsx(cy,{size:12})}),m.jsx("input",{type:"number",className:"w-full text-center border-y-2 border-slate-200 p-1 text-sm font-bold h-[30px]",value:T.quantity,onChange:R=>b(T.id,"quantity",Math.max(1,parseInt(R.target.value)||1))}),m.jsx("button",{type:"button",onClick:()=>b(T.id,"quantity",T.quantity+1),className:"bg-slate-200 p-1 rounded-r border-y-2 border-r-2 border-slate-200 hover:bg-slate-300",children:m.jsx(wu,{size:12})})]})]}),m.jsxs("div",{className:"col-span-8 sm:col-span-9",children:[m.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:" ()"}),m.jsx("input",{className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm text-slate-500 focus:border-slate-900 focus:ring-0",placeholder:"http://...",value:T.url,onChange:R=>b(T.id,"url",R.target.value)})]})]})]},T.id))})]}),m.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:[m.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[m.jsx(fa,{size:16,className:"inline mr-1"})," "]}),m.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-purple-600 text-white border-2 border-purple-800 hover:bg-purple-700 font-black italic shadow-[4px_4px_0px_0px_rgba(76,29,149,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[m.jsx(ql,{size:16,className:"inline mr-1"})," "]})]})]})}function KL({group:t,currentOrder:e,onSubmit:r}){const[n,a]=re.useState(()=>{const p={};return t.items.forEach(x=>{const y=e?.items?.find(w=>w.itemId==x.id||w.name?.trim()===x.name?.trim()&&(w.spec?.trim()||"")===(x.spec?.trim()||""));p[x.id]=y?y.quantity:0}),p}),i=(p,x)=>{const y=parseInt(x)||0,w=t.items.find(E=>E.id===p);let b=Math.max(0,y);w?.limit&&b>w.limit&&(b=w.limit),a(E=>({...E,[p]:b}))},o=()=>{const p=t.items.map(x=>({itemId:x.id||x.name,name:x.name,spec:x.spec,price:x.price,image:x.image,quantity:n[x.id]||0})).filter(x=>x.quantity>0);if(p.length===0){e?confirm(" 0()")&&r([]):alert("");return}r(p)},u=t.items.reduce((p,x)=>{const y=Number(x.price)||0,w=n[x.id]||0;return p+y*w},0),f=Number(t.shippingFee||0),d=Math.round((u+f)*t.exchangeRate);return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg border-2 border-yellow-400 text-sm font-bold text-slate-800",children:[m.jsxs("p",{className:"flex items-center gap-2",children:[m.jsx(Fm,{size:16,className:"text-red-600"}),""]}),m.jsxs("ul",{className:"mt-1 ml-1 list-disc list-inside text-xs font-medium text-slate-600 space-y-0.5",children:[m.jsxs("li",{children:["",t.exchangeRate]}),m.jsxs("li",{children:[" ",f.toLocaleString()]}),m.jsxs("li",{children:["",t.deadline]})]})]}),m.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border-2 border-slate-200",children:[m.jsx("h4",{className:"font-black italic text-lg text-slate-900 border-b border-slate-300 pb-3 mb-3",children:""}),m.jsx("div",{className:"space-y-4",children:t.items.map(p=>{const x=n[p.id]||0,y=p.limit&&x>=p.limit;return m.jsxs("div",{className:"flex items-center justify-between border-b-2 border-slate-100 pb-4 last:border-0 bg-white p-3 rounded-lg shadow-sm",children:[m.jsxs("div",{className:"flex items-start gap-3 flex-1 overflow-hidden",children:[m.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-100 border-2 border-slate-900 shrink-0 overflow-hidden flex items-center justify-center shadow-md",children:p.image?m.jsx("img",{src:p.image,alt:p.spec,className:"w-full h-full object-cover"}):m.jsx(J0,{size:20,className:"text-slate-400"})}),m.jsxs("div",{className:"min-w-0 pt-1",children:[m.jsx("div",{className:"font-black italic text-slate-900 truncate",children:p.name}),m.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 mt-1 flex-wrap",children:[p.spec&&m.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full font-bold",children:p.spec}),m.jsxs("span",{className:"text-red-600 font-black flex items-center gap-0.5",children:["",p.price]}),p.limit&&m.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:[" (: ",p.limit,")"]}),y&&m.jsx("span",{className:"text-red-600 font-black text-xs",children:" (MAX!)"})]})]})]}),m.jsxs("div",{className:"flex items-center gap-1 pl-2 shrink-0",children:[m.jsx("button",{type:"button",className:"w-8 h-8 rounded-full bg-slate-100 hover:bg-slate-200 font-bold text-slate-900 flex items-center justify-center border-2 border-slate-900 transition-colors shadow-[1px_1px_0px_0px_rgba(15,23,42,1)] active:shadow-none active:translate-y-0.5 active:translate-x-0.5",onClick:()=>i(p.id,x-1),children:m.jsx(cy,{size:16})}),m.jsx("input",{type:"number",className:"w-10 text-center font-black italic text-lg border-none focus:ring-2 focus:ring-yellow-400 p-0 bg-transparent text-slate-900",value:x,onChange:w=>i(p.id,w.target.value),min:"0",max:p.limit||999}),m.jsx("button",{type:"button",className:`w-8 h-8 rounded-full font-bold flex items-center justify-center border-2 border-slate-900 transition-colors shadow-[1px_1px_0px_0px_rgba(15,23,42,1)] active:shadow-none active:translate-y-0.5 active:translate-x-0.5 ${y?"bg-slate-300 text-slate-600 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,onClick:()=>i(p.id,x+1),disabled:y,children:m.jsx(wu,{size:16})})]})]},p.id)})})]}),m.jsxs("div",{className:"bg-slate-800 text-white p-4 rounded-lg border-2 border-yellow-400 shadow-md",children:[m.jsx("h4",{className:"text-xl font-black italic text-yellow-400 mb-2",children:" (Summary)"}),m.jsxs("p",{className:"flex justify-between font-bold text-white border-b border-slate-600 pb-1 text-base",children:[m.jsx("span",{children:" (Goods JPY)"}),m.jsxs("span",{className:"font-mono text-xl text-red-400",children:[" ",u.toLocaleString()]})]}),f>0&&m.jsxs("p",{className:"flex justify-between text-sm pt-1 text-slate-300",children:[m.jsx("span",{children:" (Shipping JPY)"}),m.jsxs("span",{className:"font-mono",children:[" ",f.toLocaleString()]})]}),m.jsxs("p",{className:"flex justify-between pt-2 border-t border-slate-600 mt-2 font-black text-xl italic",children:[m.jsx("span",{children:" (NT$)"}),m.jsxs("span",{className:"font-mono text-2xl text-yellow-400",children:["NT$ ",d.toLocaleString()]})]})]}),m.jsx("div",{className:"pt-4 sticky bottom-0 bg-white/90 backdrop-blur-sm pb-2 border-t-2 border-yellow-400 mt-4",children:m.jsxs("button",{type:"button",className:"w-full py-3 bg-red-600 text-white rounded-lg font-black italic text-xl hover:bg-red-700 transition-all shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] active:translate-y-1 active:shadow-none active:translate-x-1 border-2 border-slate-900",onClick:o,children:[m.jsx(Ck,{size:20,className:"inline mr-2"}),u===0&&e?"":e?"":" (PLUS ULTRA!)"]})})]})}var Mm={};Mm.version="0.18.5";var aC=1252,QL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],vy={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},yy=function(t){QL.indexOf(t)!=-1&&(aC=vy[0]=t)};function JL(){yy(1252)}var ys=function(t){yy(t)};function _y(){ys(1200),JL()}function RT(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function ZL(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function sC(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var qf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?ZL(t.slice(2)):e==254&&r==255?sC(t.slice(2)):e==65279?t.slice(1):t},Bd=function(e){return String.fromCharCode(e)},IT=function(e){return String.fromCharCode(e)},_0,Nl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function w0(t){for(var e="",r=0,n=0,a=0,i=0,o=0,u=0,f=0,d=0;d<t.length;)r=t.charCodeAt(d++),i=r>>2,n=t.charCodeAt(d++),o=(r&3)<<4|n>>4,a=t.charCodeAt(d++),u=(n&15)<<2|a>>6,f=a&63,isNaN(n)?u=f=64:isNaN(a)&&(f=64),e+=Nl.charAt(i)+Nl.charAt(o)+Nl.charAt(u)+Nl.charAt(f);return e}function Ia(t){var e="",r=0,n=0,a=0,i=0,o=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)i=Nl.indexOf(t.charAt(d++)),o=Nl.indexOf(t.charAt(d++)),r=i<<2|o>>4,e+=String.fromCharCode(r),u=Nl.indexOf(t.charAt(d++)),n=(o&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),f=Nl.indexOf(t.charAt(d++)),a=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(a));return e}var Tt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Bi=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Xl(t){return Tt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function DT(t){return Tt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ka=function(e){return Tt?Bi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Ep(t){if(typeof ArrayBuffer>"u")return ka(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function ro(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function e7(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function wy(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return wy(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var gn=Tt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Bi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function t7(t){for(var e=[],r=0,n=t.length+250,a=Xl(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=t.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|u>>6&15|(o&3)<<4,a[r++]=128|u&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Xl(65535),n=65530)}return e.push(a.slice(0,r)),gn(e)}var Zn=/\u0000/g,Wf=/[\u0001-\u0006]/g;function cu(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function _s(t,e){var r=""+t;return r.length>=e?r:Rr("0",e-r.length)+r}function by(t,e){var r=""+t;return r.length>=e?r:Rr(" ",e-r.length)+r}function Pm(t,e){var r=""+t;return r.length>=e?r:r+Rr(" ",e-r.length)}function r7(t,e){var r=""+Math.round(t);return r.length>=e?r:Rr("0",e-r.length)+r}function n7(t,e){var r=""+t;return r.length>=e?r:Rr("0",e-r.length)+r}var OT=Math.pow(2,32);function Yc(t,e){if(t>OT||t<-OT)return r7(t,e);var r=Math.round(t);return n7(r,e)}function jm(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var FT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],K1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function a7(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},MT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},s7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Lm(t,e,r){for(var n=t<0?-1:1,a=t*n,i=0,o=1,u=0,f=1,d=0,p=0,x=Math.floor(a);d<e&&(x=Math.floor(a),u=x*o+i,p=x*d+f,!(a-x<5e-8));)a=1/(a-x),i=o,o=u,f=d,d=p;if(p>e&&(d>e?(p=f,u=i):(p=d,u=o)),!r)return[0,n*u,p];var y=Math.floor(n*u/p);return[y,n*u-y*p,p]}function Mo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),i=0,o=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=f7(f,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=i,u}var iC=new Date(1899,11,31,0,0,0),i7=iC.getTime(),l7=new Date(1900,2,1,0,0,0);function lC(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=l7&&(r+=1440*60*1e3),(r-(i7+(t.getTimezoneOffset()-iC.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Ey(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function o7(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function c7(t){var e=t<0?12:11,r=Ey(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function u7(t){var e=Ey(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function b0(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=c7(t):e===10?r=t.toFixed(10).substr(0,12):r=u7(t),Ey(o7(r.toUpperCase()))}function Yo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):b0(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return es(14,lC(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function f7(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function h7(t,e,r,n){var a="",i=0,o=0,u=r.y,f,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,d=2;break;default:f=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:f=r.m,d=e.length;break;case 3:return K1[r.m-1][1];case 5:return K1[r.m-1][0];default:return K1[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,d=e.length;break;case 3:return FT[r.q][0];default:return FT[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?_s(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(a=_s(i,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:f=u,d=1;break}var p=d>0?_s(f,d):"";return p}function Rl(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var oC=/%/g;function d7(t,e,r){var n=e.replace(oC,""),a=e.length-n.length;return Ci(t,n,r*Math.pow(10,2*a))+Rr("%",a)}function m7(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ci(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function cC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+cC(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,p){return f+d+p.substr(0,(a+i)%a)+"."+p.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var uC=/# (\?+)( ?)\/( ?)(\d+)/;function p7(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),i=Math.floor(a/n),o=a-i*n,u=n;return r+(i===0?"":""+i)+" "+(o===0?Rr(" ",t[1].length+1+t[4].length):by(o,t[1].length)+t[2]+"/"+t[3]+_s(u,t[4].length))}function g7(t,e,r){return r+(e===0?"":""+e)+Rr(" ",t[1].length+2+t[4].length)}var fC=/^#*0*\.([0#]+)/,hC=/\).*[0#]/,dC=/\(###\) ###\\?-####/;function $n(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function PT(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function jT(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function x7(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function v7(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Wa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(hC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wa("n",n,r):"("+Wa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return m7(t,e,r);if(e.indexOf("%")!==-1)return d7(t,e,r);if(e.indexOf("E")!==-1)return cC(e,r);if(e.charCodeAt(0)===36)return"$"+Wa(t,e.substr(e.charAt(1)==" "?2:1),r);var a,i,o,u,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Yc(f,e.length);if(e.match(/^[#?]+$/))return a=Yc(r,0),a==="0"&&(a=""),a.length>e.length?a:$n(e.substr(0,e.length-a.length))+a;if(i=e.match(uC))return p7(i,f,d);if(e.match(/^#+0+$/))return d+Yc(f,e.length-e.indexOf("0"));if(i=e.match(fC))return a=PT(r,i[1].length).replace(/^([^\.]+)$/,"$1."+$n(i[1])).replace(/\.$/,"."+$n(i[1])).replace(/\.(\d*)$/,function(b,E){return"."+E+Rr("0",$n(i[1]).length-E.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+PT(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+Rl(Yc(f,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wa(t,e,-r):Rl(""+(Math.floor(r)+x7(r,i[1].length)))+"."+_s(jT(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Wa(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=cu(Wa(t,e.replace(/[\\-]/g,""),r)),o=0,cu(cu(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<a.length?a.charAt(o++):b==="0"?"0":""}));if(e.match(dC))return a=Wa(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=Lm(f,Math.pow(10,o)-1,!1),a=""+d,p=Ci("n",i[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+i[2]+"/"+i[3],p=Pm(u[2],o),p.length<i[4].length&&(p=$n(i[4].substr(i[4].length-p.length))+p),a+=p,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=Lm(f,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?by(u[1],o)+i[2]+"/"+i[3]+Pm(u[2],o):Rr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=Yc(r,0),e.length<=a.length?a:$n(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var x=e.indexOf(".")-o,y=e.length-a.length-x;return $n(e.substr(0,x)+a+e.substr(e.length-y))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=jT(r,i[1].length),r<0?"-"+Wa(t,e,-r):Rl(v7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?_s(0,3-b.length):"")+b})+"."+_s(o,i[1].length);switch(e){case"###,##0.00":return Wa(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var w=Rl(Yc(f,0));return w!=="0"?d+w:"";case"###,###.00":return Wa(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Wa(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function y7(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ci(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function _7(t,e,r){var n=e.replace(oC,""),a=e.length-n.length;return Ci(t,n,r*Math.pow(10,2*a))+Rr("%",a)}function mC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+mC(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,p){return f+d+p.substr(0,(a+i)%a)+"."+p.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ps(t,e,r){if(t.charCodeAt(0)===40&&!e.match(hC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ps("n",n,r):"("+Ps("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return y7(t,e,r);if(e.indexOf("%")!==-1)return _7(t,e,r);if(e.indexOf("E")!==-1)return mC(e,r);if(e.charCodeAt(0)===36)return"$"+Ps(t,e.substr(e.charAt(1)==" "?2:1),r);var a,i,o,u,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+_s(f,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:$n(e.substr(0,e.length-a.length))+a;if(i=e.match(uC))return g7(i,f,d);if(e.match(/^#+0+$/))return d+_s(f,e.length-e.indexOf("0"));if(i=e.match(fC))return a=(""+r).replace(/^([^\.]+)$/,"$1."+$n(i[1])).replace(/\.$/,"."+$n(i[1])),a=a.replace(/\.(\d*)$/,function(b,E){return"."+E+Rr("0",$n(i[1]).length-E.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+Rl(""+f);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ps(t,e,-r):Rl(""+r)+"."+Rr("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Ps(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=cu(Ps(t,e.replace(/[\\-]/g,""),r)),o=0,cu(cu(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<a.length?a.charAt(o++):b==="0"?"0":""}));if(e.match(dC))return a=Ps(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=Lm(f,Math.pow(10,o)-1,!1),a=""+d,p=Ci("n",i[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+i[2]+"/"+i[3],p=Pm(u[2],o),p.length<i[4].length&&(p=$n(i[4].substr(i[4].length-p.length))+p),a+=p,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=Lm(f,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?by(u[1],o)+i[2]+"/"+i[3]+Pm(u[2],o):Rr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:$n(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var x=e.indexOf(".")-o,y=e.length-a.length-x;return $n(e.substr(0,x)+a+e.substr(e.length-y))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ps(t,e,-r):Rl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?_s(0,3-b.length):"")+b})+"."+_s(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var w=Rl(""+f);return w!=="0"?d+w:"";default:if(e.match(/\.[0#?]*$/))return Ps(t,e.slice(0,e.lastIndexOf(".")),r)+$n(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ci(t,e,r){return(r|0)===r?Ps(t,e,r):Wa(t,e,r)}function w7(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var pC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":jm(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(pC))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function b7(t,e,r,n){for(var a=[],i="",o=0,u="",f="t",d,p,x,y="H";o<t.length;)switch(u=t.charAt(o)){case"G":if(!jm(t,o))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(x=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(x);a[a.length]={t:"t",v:i},++o;break;case"\\":var w=t.charAt(++o),b=w==="("||w===")"?w:"t";a[a.length]={t:b,v:w},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=Mo(e,r,t.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},f=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Mo(e,r),d==null))return"";for(i=u;++o<t.length&&t.charAt(o).toLowerCase()===u;)i+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),a[a.length]={t:u,v:i},f=u;break;case"A":case"a":case"":var E={t:u,v:u};if(d==null&&(d=Mo(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(E.v=d.H>=12?"P":"A"),E.t="T",y="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(E.v=d.H>=12?"PM":"AM"),E.t="T",o+=5,y="h"):t.substr(o,5).toUpperCase()==="/"?(d!=null&&(E.v=d.H>=12?"":""),E.t="T",o+=5,y="h"):(E.t="t",++o),d==null&&E.t==="T")return"";a[a.length]=E,f=u;break;case"[":for(i=u;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(pC)){if(d==null&&(d=Mo(e,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pu(t)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=u;++o<t.length&&(u=t.charAt(o))==="0";)i+=u;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=u;++o<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(o))>-1;)i+=u;a[a.length]={t:"n",v:i};break;case"?":for(i=u;t.charAt(++o)===u;)i+=u;a[a.length]={t:u,v:i},f=u;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=u;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:u,v:u},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++o;break}var T=0,I=0,R;for(o=a.length-1,f="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=y,f="h",T<1&&(T=1);break;case"s":(R=a[o].v.match(/\.0+$/))&&(I=Math.max(I,R[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":f=a[o].t;break;case"m":f==="s"&&(a[o].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&a[o].v.match(/[Hh]/)&&(T=1),T<2&&a[o].v.match(/[Mm]/)&&(T=2),T<3&&a[o].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var C="",z;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=h7(a[o].t.charCodeAt(0),a[o].v,d,I),a[o].t="t";break;case"n":case"?":for(z=o+1;a[z]!=null&&((u=a[z].t)==="?"||u==="D"||(u===" "||u==="t")&&a[z+1]!=null&&(a[z+1].t==="?"||a[z+1].t==="t"&&a[z+1].v==="/")||a[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[z].v==="/"||a[z].v===" "&&a[z+1]!=null&&a[z+1].t=="?"));)a[o].v+=a[z].v,a[z]={v:"",t:";"},++z;C+=a[o].v,o=z-1;break;case"G":a[o].t="t",a[o].v=Yo(e,r);break}var H="",X,A;if(C.length>0){C.charCodeAt(0)==40?(X=e<0&&C.charCodeAt(0)===45?-e:e,A=Ci("n",C,X)):(X=e<0&&n>1?-e:e,A=Ci("n",C,X),X<0&&a[0]&&a[0].t=="t"&&(A=A.substr(1),a[0].v="-"+a[0].v)),z=A.length-1;var F=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){F=o;break}var N=a.length;if(F===a.length&&A.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(z>=a[o].v.length-1?(z-=a[o].v.length,a[o].v=A.substr(z+1,a[o].v.length)):z<0?a[o].v="":(a[o].v=A.substr(0,z+1),z=-1),a[o].t="t",N=o);z>=0&&N<a.length&&(a[N].v=A.substr(0,z+1)+a[N].v)}else if(F!==a.length&&A.indexOf("E")===-1){for(z=A.indexOf(".")-1,o=F;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(p=a[o].v.indexOf(".")>-1&&o===F?a[o].v.indexOf(".")-1:a[o].v.length-1,H=a[o].v.substr(p+1);p>=0;--p)z>=0&&(a[o].v.charAt(p)==="0"||a[o].v.charAt(p)==="#")&&(H=A.charAt(z--)+H);a[o].v=H,a[o].t="t",N=o}for(z>=0&&N<a.length&&(a[N].v=A.substr(0,z+1)+a[N].v),z=A.indexOf(".")+1,o=F;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==F)){for(p=a[o].v.indexOf(".")>-1&&o===F?a[o].v.indexOf(".")+1:0,H=a[o].v.substr(0,p);p<a[o].v.length;++p)z<A.length&&(H+=A.charAt(z++));a[o].v=H,a[o].t="t",N=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(X=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=Ci(a[o].t,a[o].v,X),a[o].t="t");var P="";for(o=0;o!==a.length;++o)a[o]!=null&&(P+=a[o].v);return P}var LT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function BT(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function E7(t,e){var r=w7(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(LT),u=r[1].match(LT);return BT(e,o)?[n,r[0]]:BT(e,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,i]}function es(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:lt)[t],n==null&&(n=r.table&&r.table[MT[t]]||lt[MT[t]]),n==null&&(n=s7[t]||"General");break}if(jm(n,0))return Yo(e,r);e instanceof Date&&(e=lC(e,r.date1904));var a=E7(n,e);if(jm(a[1]))return Yo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return b7(a[1],e,r,a[0])}function Ni(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(lt[r]==null){e<0&&(e=r);continue}if(lt[r]==t){e=r;break}}e<0&&(e=391)}return lt[e]=t,e}function Tp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ni(t[e],e)}function ju(){lt=a7()}var T7={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},gC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function S7(t){var e=typeof t=="number"?lt[t]:t;return e=e.replace(gC,"(\\d+)"),new RegExp("^"+e+"$")}function A7(t,e,r){var n=-1,a=-1,i=-1,o=-1,u=-1,f=-1;(e.match(gC)||[]).forEach(function(x,y){var w=parseInt(r[y+1],10);switch(x.toLowerCase().charAt(0)){case"y":n=w;break;case"d":i=w;break;case"h":o=w;break;case"s":f=w;break;case"m":o>=0?u=w:a=w;break}}),f>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&u==-1&&f==-1?d:n==-1&&a==-1&&i==-1?p:d+"T"+p}var k7=(function(){var t={};t.version="1.2.0";function e(){for(var A=0,F=new Array(256),N=0;N!=256;++N)A=N,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,F[N]=A;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(A){var F=0,N=0,P=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)M[P]=A[P];for(P=0;P!=256;++P)for(N=A[P],F=256+P;F<4096;F+=256)N=M[F]=N>>>8^A[N&255];var j=[];for(P=1;P!=16;++P)j[P-1]=typeof Int32Array<"u"?M.subarray(P*256,P*256+256):M.slice(P*256,P*256+256);return j}var a=n(r),i=a[0],o=a[1],u=a[2],f=a[3],d=a[4],p=a[5],x=a[6],y=a[7],w=a[8],b=a[9],E=a[10],T=a[11],I=a[12],R=a[13],C=a[14];function z(A,F){for(var N=F^-1,P=0,M=A.length;P<M;)N=N>>>8^r[(N^A.charCodeAt(P++))&255];return~N}function H(A,F){for(var N=F^-1,P=A.length-15,M=0;M<P;)N=C[A[M++]^N&255]^R[A[M++]^N>>8&255]^I[A[M++]^N>>16&255]^T[A[M++]^N>>>24]^E[A[M++]]^b[A[M++]]^w[A[M++]]^y[A[M++]]^x[A[M++]]^p[A[M++]]^d[A[M++]]^f[A[M++]]^u[A[M++]]^o[A[M++]]^i[A[M++]]^r[A[M++]];for(P+=15;M<P;)N=N>>>8^r[(N^A[M++])&255];return~N}function X(A,F){for(var N=F^-1,P=0,M=A.length,j=0,B=0;P<M;)j=A.charCodeAt(P++),j<128?N=N>>>8^r[(N^j)&255]:j<2048?(N=N>>>8^r[(N^(192|j>>6&31))&255],N=N>>>8^r[(N^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,B=A.charCodeAt(P++)&1023,N=N>>>8^r[(N^(240|j>>8&7))&255],N=N>>>8^r[(N^(128|j>>2&63))&255],N=N>>>8^r[(N^(128|B>>6&15|(j&3)<<4))&255],N=N>>>8^r[(N^(128|B&63))&255]):(N=N>>>8^r[(N^(224|j>>12&15))&255],N=N>>>8^r[(N^(128|j>>6&63))&255],N=N>>>8^r[(N^(128|j&63))&255]);return~N}return t.table=r,t.bstr=z,t.buf=H,t.str=X,t})(),at=(function(){var e={};e.version="1.2.1";function r(V,Z){for(var G=V.split("/"),K=Z.split("/"),J=0,ee=0,de=Math.min(G.length,K.length);J<de;++J){if(ee=G[J].length-K[J].length)return ee;if(G[J]!=K[J])return G[J]<K[J]?-1:1}return G.length-K.length}function n(V){if(V.charAt(V.length-1)=="/")return V.slice(0,-1).indexOf("/")===-1?V:n(V.slice(0,-1));var Z=V.lastIndexOf("/");return Z===-1?V:V.slice(0,Z+1)}function a(V){if(V.charAt(V.length-1)=="/")return a(V.slice(0,-1));var Z=V.lastIndexOf("/");return Z===-1?V:V.slice(Z+1)}function i(V,Z){typeof Z=="string"&&(Z=new Date(Z));var G=Z.getHours();G=G<<6|Z.getMinutes(),G=G<<5|Z.getSeconds()>>>1,V.write_shift(2,G);var K=Z.getFullYear()-1980;K=K<<4|Z.getMonth()+1,K=K<<5|Z.getDate(),V.write_shift(2,K)}function o(V){var Z=V.read_shift(2)&65535,G=V.read_shift(2)&65535,K=new Date,J=G&31;G>>>=5;var ee=G&15;G>>>=4,K.setMilliseconds(0),K.setFullYear(G+1980),K.setMonth(ee-1),K.setDate(J);var de=Z&31;Z>>>=5;var Ce=Z&63;return Z>>>=6,K.setHours(Z),K.setMinutes(Ce),K.setSeconds(de<<1),K}function u(V){Sn(V,0);for(var Z={},G=0;V.l<=V.length-4;){var K=V.read_shift(2),J=V.read_shift(2),ee=V.l+J,de={};switch(K){case 21589:G=V.read_shift(1),G&1&&(de.mtime=V.read_shift(4)),J>5&&(G&2&&(de.atime=V.read_shift(4)),G&4&&(de.ctime=V.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}V.l=ee,Z[K]=de}return Z}var f;function d(){return f||(f={})}function p(V,Z){if(V[0]==80&&V[1]==75)return ma(V,Z);if((V[0]|32)==109&&(V[1]|32)==105)return ei(V,Z);if(V.length<512)throw new Error("CFB file size "+V.length+" < 512");var G=3,K=512,J=0,ee=0,de=0,Ce=0,me=0,xe=[],ge=V.slice(0,512);Sn(ge,0);var Be=x(ge);switch(G=Be[0],G){case 3:K=512;break;case 4:K=4096;break;case 0:if(Be[1]==0)return ma(V,Z);default:throw new Error("Major Version: Expected 3 or 4 saw "+G)}K!==512&&(ge=V.slice(0,K),Sn(ge,28));var Ve=V.slice(0,K);y(ge,G);var qe=ge.read_shift(4,"i");if(G===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);ge.l+=4,de=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),Ce=ge.read_shift(4,"i"),J=ge.read_shift(4,"i"),me=ge.read_shift(4,"i"),ee=ge.read_shift(4,"i");for(var Le=-1,Ge=0;Ge<109&&(Le=ge.read_shift(4,"i"),!(Le<0));++Ge)xe[Ge]=Le;var Ze=w(V,K);T(me,ee,Ze,K,xe);var Yt=R(Ze,de,xe,K);Yt[de].name="!Directory",J>0&&Ce!==B&&(Yt[Ce].name="!MiniFAT"),Yt[xe[0]].name="!FAT",Yt.fat_addrs=xe,Yt.ssz=K;var $t={},cr=[],Nn=[],ss=[];C(de,Yt,Ze,cr,J,$t,Nn,Ce),b(Nn,ss,cr),cr.shift();var is={FileIndex:Nn,FullPaths:ss};return Z&&Z.raw&&(is.raw={header:Ve,sectors:Ze}),is}function x(V){if(V[V.l]==80&&V[V.l+1]==75)return[0,0];V.chk(Se,"Header Signature: "),V.l+=16;var Z=V.read_shift(2,"u");return[V.read_shift(2,"u"),Z]}function y(V,Z){var G=9;switch(V.l+=2,G=V.read_shift(2)){case 9:if(Z!=3)throw new Error("Sector Shift: Expected 9 saw "+G);break;case 12:if(Z!=4)throw new Error("Sector Shift: Expected 12 saw "+G);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+G)}V.chk("0600","Mini Sector Shift: "),V.chk("000000000000","Reserved: ")}function w(V,Z){for(var G=Math.ceil(V.length/Z)-1,K=[],J=1;J<G;++J)K[J-1]=V.slice(J*Z,(J+1)*Z);return K[G-1]=V.slice(G*Z),K}function b(V,Z,G){for(var K=0,J=0,ee=0,de=0,Ce=0,me=G.length,xe=[],ge=[];K<me;++K)xe[K]=ge[K]=K,Z[K]=G[K];for(;Ce<ge.length;++Ce)K=ge[Ce],J=V[K].L,ee=V[K].R,de=V[K].C,xe[K]===K&&(J!==-1&&xe[J]!==J&&(xe[K]=xe[J]),ee!==-1&&xe[ee]!==ee&&(xe[K]=xe[ee])),de!==-1&&(xe[de]=K),J!==-1&&K!=xe[K]&&(xe[J]=xe[K],ge.lastIndexOf(J)<Ce&&ge.push(J)),ee!==-1&&K!=xe[K]&&(xe[ee]=xe[K],ge.lastIndexOf(ee)<Ce&&ge.push(ee));for(K=1;K<me;++K)xe[K]===K&&(ee!==-1&&xe[ee]!==ee?xe[K]=xe[ee]:J!==-1&&xe[J]!==J&&(xe[K]=xe[J]));for(K=1;K<me;++K)if(V[K].type!==0){if(Ce=K,Ce!=xe[Ce])do Ce=xe[Ce],Z[K]=Z[Ce]+"/"+Z[K];while(Ce!==0&&xe[Ce]!==-1&&Ce!=xe[Ce]);xe[K]=-1}for(Z[0]+="/",K=1;K<me;++K)V[K].type!==2&&(Z[K]+="/")}function E(V,Z,G){for(var K=V.start,J=V.size,ee=[],de=K;G&&J>0&&de>=0;)ee.push(Z.slice(de*j,de*j+j)),J-=j,de=Oo(G,de*4);return ee.length===0?Ae(0):gn(ee).slice(0,V.size)}function T(V,Z,G,K,J){var ee=B;if(V===B){if(Z!==0)throw new Error("DIFAT chain shorter than expected")}else if(V!==-1){var de=G[V],Ce=(K>>>2)-1;if(!de)return;for(var me=0;me<Ce&&(ee=Oo(de,me*4))!==B;++me)J.push(ee);T(Oo(de,K-4),Z-1,G,K,J)}}function I(V,Z,G,K,J){var ee=[],de=[];J||(J=[]);var Ce=K-1,me=0,xe=0;for(me=Z;me>=0;){J[me]=!0,ee[ee.length]=me,de.push(V[me]);var ge=G[Math.floor(me*4/K)];if(xe=me*4&Ce,K<4+xe)throw new Error("FAT boundary crossed: "+me+" 4 "+K);if(!V[ge])break;me=Oo(V[ge],xe)}return{nodes:ee,data:QT([de])}}function R(V,Z,G,K){var J=V.length,ee=[],de=[],Ce=[],me=[],xe=K-1,ge=0,Be=0,Ve=0,qe=0;for(ge=0;ge<J;++ge)if(Ce=[],Ve=ge+Z,Ve>=J&&(Ve-=J),!de[Ve]){me=[];var Le=[];for(Be=Ve;Be>=0;){Le[Be]=!0,de[Be]=!0,Ce[Ce.length]=Be,me.push(V[Be]);var Ge=G[Math.floor(Be*4/K)];if(qe=Be*4&xe,K<4+qe)throw new Error("FAT boundary crossed: "+Be+" 4 "+K);if(!V[Ge]||(Be=Oo(V[Ge],qe),Le[Be]))break}ee[Ve]={nodes:Ce,data:QT([me])}}return ee}function C(V,Z,G,K,J,ee,de,Ce){for(var me=0,xe=K.length?2:0,ge=Z[V].data,Be=0,Ve=0,qe;Be<ge.length;Be+=128){var Le=ge.slice(Be,Be+128);Sn(Le,64),Ve=Le.read_shift(2),qe=Ry(Le,0,Ve-xe),K.push(qe);var Ge={name:qe,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},Ze=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);Ze!==0&&(Ge.ct=z(Le,Le.l-8));var Yt=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);Yt!==0&&(Ge.mt=z(Le,Le.l-8)),Ge.start=Le.read_shift(4,"i"),Ge.size=Le.read_shift(4,"i"),Ge.size<0&&Ge.start<0&&(Ge.size=Ge.type=0,Ge.start=B,Ge.name=""),Ge.type===5?(me=Ge.start,J>0&&me!==B&&(Z[me].name="!StreamData")):Ge.size>=4096?(Ge.storage="fat",Z[Ge.start]===void 0&&(Z[Ge.start]=I(G,Ge.start,Z.fat_addrs,Z.ssz)),Z[Ge.start].name=Ge.name,Ge.content=Z[Ge.start].data.slice(0,Ge.size)):(Ge.storage="minifat",Ge.size<0?Ge.size=0:me!==B&&Ge.start!==B&&Z[me]&&(Ge.content=E(Ge,Z[me].data,(Z[Ce]||{}).data))),Ge.content&&Sn(Ge.content,0),ee[qe]=Ge,de.push(Ge)}}function z(V,Z){return new Date((Aa(V,Z+4)/1e7*Math.pow(2,32)+Aa(V,Z)/1e7-11644473600)*1e3)}function H(V,Z){return d(),p(f.readFileSync(V),Z)}function X(V,Z){var G=Z&&Z.type;switch(G||Tt&&Buffer.isBuffer(V)&&(G="buffer"),G||"base64"){case"file":return H(V,Z);case"base64":return p(ka(Ia(V)),Z);case"binary":return p(ka(V),Z)}return p(V,Z)}function A(V,Z){var G=Z||{},K=G.root||"Root Entry";if(V.FullPaths||(V.FullPaths=[]),V.FileIndex||(V.FileIndex=[]),V.FullPaths.length!==V.FileIndex.length)throw new Error("inconsistent CFB structure");V.FullPaths.length===0&&(V.FullPaths[0]=K+"/",V.FileIndex[0]={name:K,type:5}),G.CLSID&&(V.FileIndex[0].clsid=G.CLSID),F(V)}function F(V){var Z="Sh33tJ5";if(!at.find(V,"/"+Z)){var G=Ae(4);G[0]=55,G[1]=G[3]=50,G[2]=54,V.FileIndex.push({name:Z,type:2,content:G,size:4,L:69,R:69,C:69}),V.FullPaths.push(V.FullPaths[0]+Z),N(V)}}function N(V,Z){A(V);for(var G=!1,K=!1,J=V.FullPaths.length-1;J>=0;--J){var ee=V.FileIndex[J];switch(ee.type){case 0:K?G=!0:(V.FileIndex.pop(),V.FullPaths.pop());break;case 1:case 2:case 5:K=!0,isNaN(ee.R*ee.L*ee.C)&&(G=!0),ee.R>-1&&ee.L>-1&&ee.R==ee.L&&(G=!0);break;default:G=!0;break}}if(!(!G&&!Z)){var de=new Date(1987,1,19),Ce=0,me=Object.create?Object.create(null):{},xe=[];for(J=0;J<V.FullPaths.length;++J)me[V.FullPaths[J]]=!0,V.FileIndex[J].type!==0&&xe.push([V.FullPaths[J],V.FileIndex[J]]);for(J=0;J<xe.length;++J){var ge=n(xe[J][0]);K=me[ge],K||(xe.push([ge,{name:a(ge).replace("/",""),type:1,clsid:se,ct:de,mt:de,content:null}]),me[ge]=!0)}for(xe.sort(function(qe,Le){return r(qe[0],Le[0])}),V.FullPaths=[],V.FileIndex=[],J=0;J<xe.length;++J)V.FullPaths[J]=xe[J][0],V.FileIndex[J]=xe[J][1];for(J=0;J<xe.length;++J){var Be=V.FileIndex[J],Ve=V.FullPaths[J];if(Be.name=a(Ve).replace("/",""),Be.L=Be.R=Be.C=-(Be.color=1),Be.size=Be.content?Be.content.length:0,Be.start=0,Be.clsid=Be.clsid||se,J===0)Be.C=xe.length>1?1:-1,Be.size=0,Be.type=5;else if(Ve.slice(-1)=="/"){for(Ce=J+1;Ce<xe.length&&n(V.FullPaths[Ce])!=Ve;++Ce);for(Be.C=Ce>=xe.length?-1:Ce,Ce=J+1;Ce<xe.length&&n(V.FullPaths[Ce])!=n(Ve);++Ce);Be.R=Ce>=xe.length?-1:Ce,Be.type=1}else n(V.FullPaths[J+1]||"")==n(Ve)&&(Be.R=J+1),Be.type=2}}}function P(V,Z){var G=Z||{};if(G.fileType=="mad")return Uu(V,G);switch(N(V),G.fileType){case"zip":return kr(V,G)}var K=(function(qe){for(var Le=0,Ge=0,Ze=0;Ze<qe.FileIndex.length;++Ze){var Yt=qe.FileIndex[Ze];if(Yt.content){var $t=Yt.content.length;$t>0&&($t<4096?Le+=$t+63>>6:Ge+=$t+511>>9)}}for(var cr=qe.FullPaths.length+3>>2,Nn=Le+7>>3,ss=Le+127>>7,is=Nn+Ge+cr+ss,ga=is+127>>7,zi=ga<=109?0:Math.ceil((ga-109)/127);is+ga+zi+127>>7>ga;)zi=++ga<=109?0:Math.ceil((ga-109)/127);var Rn=[1,zi,ga,ss,cr,Ge,Le,0];return qe.FileIndex[0].size=Le<<6,Rn[7]=(qe.FileIndex[0].start=Rn[0]+Rn[1]+Rn[2]+Rn[3]+Rn[4]+Rn[5])+(Rn[6]+7>>3),Rn})(V),J=Ae(K[7]<<9),ee=0,de=0;{for(ee=0;ee<8;++ee)J.write_shift(1,we[ee]);for(ee=0;ee<8;++ee)J.write_shift(2,0);for(J.write_shift(2,62),J.write_shift(2,3),J.write_shift(2,65534),J.write_shift(2,9),J.write_shift(2,6),ee=0;ee<3;++ee)J.write_shift(2,0);for(J.write_shift(4,0),J.write_shift(4,K[2]),J.write_shift(4,K[0]+K[1]+K[2]+K[3]-1),J.write_shift(4,0),J.write_shift(4,4096),J.write_shift(4,K[3]?K[0]+K[1]+K[2]-1:B),J.write_shift(4,K[3]),J.write_shift(-4,K[1]?K[0]-1:B),J.write_shift(4,K[1]),ee=0;ee<109;++ee)J.write_shift(-4,ee<K[2]?K[1]+ee:-1)}if(K[1])for(de=0;de<K[1];++de){for(;ee<236+de*127;++ee)J.write_shift(-4,ee<K[2]?K[1]+ee:-1);J.write_shift(-4,de===K[1]-1?B:de+1)}var Ce=function(qe){for(de+=qe;ee<de-1;++ee)J.write_shift(-4,ee+1);qe&&(++ee,J.write_shift(-4,B))};for(de=ee=0,de+=K[1];ee<de;++ee)J.write_shift(-4,oe.DIFSECT);for(de+=K[2];ee<de;++ee)J.write_shift(-4,oe.FATSECT);Ce(K[3]),Ce(K[4]);for(var me=0,xe=0,ge=V.FileIndex[0];me<V.FileIndex.length;++me)ge=V.FileIndex[me],ge.content&&(xe=ge.content.length,!(xe<4096)&&(ge.start=de,Ce(xe+511>>9)));for(Ce(K[6]+7>>3);J.l&511;)J.write_shift(-4,oe.ENDOFCHAIN);for(de=ee=0,me=0;me<V.FileIndex.length;++me)ge=V.FileIndex[me],ge.content&&(xe=ge.content.length,!(!xe||xe>=4096)&&(ge.start=de,Ce(xe+63>>6)));for(;J.l&511;)J.write_shift(-4,oe.ENDOFCHAIN);for(ee=0;ee<K[4]<<2;++ee){var Be=V.FullPaths[ee];if(!Be||Be.length===0){for(me=0;me<17;++me)J.write_shift(4,0);for(me=0;me<3;++me)J.write_shift(4,-1);for(me=0;me<12;++me)J.write_shift(4,0);continue}ge=V.FileIndex[ee],ee===0&&(ge.start=ge.size?ge.start-1:B);var Ve=ee===0&&G.root||ge.name;if(xe=2*(Ve.length+1),J.write_shift(64,Ve,"utf16le"),J.write_shift(2,xe),J.write_shift(1,ge.type),J.write_shift(1,ge.color),J.write_shift(-4,ge.L),J.write_shift(-4,ge.R),J.write_shift(-4,ge.C),ge.clsid)J.write_shift(16,ge.clsid,"hex");else for(me=0;me<4;++me)J.write_shift(4,0);J.write_shift(4,ge.state||0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,ge.start),J.write_shift(4,ge.size),J.write_shift(4,0)}for(ee=1;ee<V.FileIndex.length;++ee)if(ge=V.FileIndex[ee],ge.size>=4096)if(J.l=ge.start+1<<9,Tt&&Buffer.isBuffer(ge.content))ge.content.copy(J,J.l,0,ge.size),J.l+=ge.size+511&-512;else{for(me=0;me<ge.size;++me)J.write_shift(1,ge.content[me]);for(;me&511;++me)J.write_shift(1,0)}for(ee=1;ee<V.FileIndex.length;++ee)if(ge=V.FileIndex[ee],ge.size>0&&ge.size<4096)if(Tt&&Buffer.isBuffer(ge.content))ge.content.copy(J,J.l,0,ge.size),J.l+=ge.size+63&-64;else{for(me=0;me<ge.size;++me)J.write_shift(1,ge.content[me]);for(;me&63;++me)J.write_shift(1,0)}if(Tt)J.l=J.length;else for(;J.l<J.length;)J.write_shift(1,0);return J}function M(V,Z){var G=V.FullPaths.map(function(me){return me.toUpperCase()}),K=G.map(function(me){var xe=me.split("/");return xe[xe.length-(me.slice(-1)=="/"?2:1)]}),J=!1;Z.charCodeAt(0)===47?(J=!0,Z=G[0].slice(0,-1)+Z):J=Z.indexOf("/")!==-1;var ee=Z.toUpperCase(),de=J===!0?G.indexOf(ee):K.indexOf(ee);if(de!==-1)return V.FileIndex[de];var Ce=!ee.match(Wf);for(ee=ee.replace(Zn,""),Ce&&(ee=ee.replace(Wf,"!")),de=0;de<G.length;++de)if((Ce?G[de].replace(Wf,"!"):G[de]).replace(Zn,"")==ee||(Ce?K[de].replace(Wf,"!"):K[de]).replace(Zn,"")==ee)return V.FileIndex[de];return null}var j=64,B=-2,Se="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:Se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(V,Z,G){d();var K=P(V,G);f.writeFileSync(Z,K)}function ne(V){for(var Z=new Array(V.length),G=0;G<V.length;++G)Z[G]=String.fromCharCode(V[G]);return Z.join("")}function ye(V,Z){var G=P(V,Z);switch(Z&&Z.type||"buffer"){case"file":return d(),f.writeFileSync(Z.filename,G),G;case"binary":return typeof G=="string"?G:ne(G);case"base64":return w0(typeof G=="string"?G:ne(G));case"buffer":if(Tt)return Buffer.isBuffer(G)?G:Bi(G);case"array":return typeof G=="string"?ka(G):G}return G}var Q;function O(V){try{var Z=V.InflateRaw,G=new Z;if(G._processChunk(new Uint8Array([3,0]),G._finishFlushFlag),G.bytesRead)Q=V;else throw new Error("zlib does not expose bytesRead")}catch(K){console.error("cannot use native zlib: "+(K.message||K))}}function Y(V,Z){if(!Q)return Js(V,Z);var G=Q.InflateRaw,K=new G,J=K._processChunk(V.slice(V.l),K._finishFlushFlag);return V.l+=K.bytesRead,J}function q(V){return Q?Q.deflateRawSync(V):dt(V)}var te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Re(V){var Z=(V<<1|V<<11)&139536|(V<<5|V<<15)&558144;return(Z>>16|Z>>8|Z)&255}for(var _e=typeof Uint8Array<"u",ke=_e?new Uint8Array(256):[],rt=0;rt<256;++rt)ke[rt]=Re(rt);function L(V,Z){var G=ke[V&255];return Z<=8?G>>>8-Z:(G=G<<8|ke[V>>8&255],Z<=16?G>>>16-Z:(G=G<<8|ke[V>>16&255],G>>>24-Z))}function Xe(V,Z){var G=Z&7,K=Z>>>3;return(V[K]|(G<=6?0:V[K+1]<<8))>>>G&3}function Pe(V,Z){var G=Z&7,K=Z>>>3;return(V[K]|(G<=5?0:V[K+1]<<8))>>>G&7}function et(V,Z){var G=Z&7,K=Z>>>3;return(V[K]|(G<=4?0:V[K+1]<<8))>>>G&15}function We(V,Z){var G=Z&7,K=Z>>>3;return(V[K]|(G<=3?0:V[K+1]<<8))>>>G&31}function je(V,Z){var G=Z&7,K=Z>>>3;return(V[K]|(G<=1?0:V[K+1]<<8))>>>G&127}function ht(V,Z,G){var K=Z&7,J=Z>>>3,ee=(1<<G)-1,de=V[J]>>>K;return G<8-K||(de|=V[J+1]<<8-K,G<16-K)||(de|=V[J+2]<<16-K,G<24-K)||(de|=V[J+3]<<24-K),de&ee}function wt(V,Z,G){var K=Z&7,J=Z>>>3;return K<=5?V[J]|=(G&7)<<K:(V[J]|=G<<K&255,V[J+1]=(G&7)>>8-K),Z+3}function Ft(V,Z,G){var K=Z&7,J=Z>>>3;return G=(G&1)<<K,V[J]|=G,Z+1}function Hr(V,Z,G){var K=Z&7,J=Z>>>3;return G<<=K,V[J]|=G&255,G>>>=8,V[J+1]=G,Z+8}function ns(V,Z,G){var K=Z&7,J=Z>>>3;return G<<=K,V[J]|=G&255,G>>>=8,V[J+1]=G&255,V[J+2]=G>>>8,Z+16}function Gn(V,Z){var G=V.length,K=2*G>Z?2*G:Z+5,J=0;if(G>=Z)return V;if(Tt){var ee=DT(K);if(V.copy)V.copy(ee);else for(;J<V.length;++J)ee[J]=V[J];return ee}else if(_e){var de=new Uint8Array(K);if(de.set)de.set(V);else for(;J<G;++J)de[J]=V[J];return de}return V.length=K,V}function zt(V){for(var Z=new Array(V),G=0;G<V;++G)Z[G]=0;return Z}function Gr(V,Z,G){var K=1,J=0,ee=0,de=0,Ce=0,me=V.length,xe=_e?new Uint16Array(32):zt(32);for(ee=0;ee<32;++ee)xe[ee]=0;for(ee=me;ee<G;++ee)V[ee]=0;me=V.length;var ge=_e?new Uint16Array(me):zt(me);for(ee=0;ee<me;++ee)xe[J=V[ee]]++,K<J&&(K=J),ge[ee]=0;for(xe[0]=0,ee=1;ee<=K;++ee)xe[ee+16]=Ce=Ce+xe[ee-1]<<1;for(ee=0;ee<me;++ee)Ce=V[ee],Ce!=0&&(ge[ee]=xe[Ce+16]++);var Be=0;for(ee=0;ee<me;++ee)if(Be=V[ee],Be!=0)for(Ce=L(ge[ee],K)>>K-Be,de=(1<<K+4-Be)-1;de>=0;--de)Z[Ce|de<<Be]=Be&15|ee<<4;return K}var an=_e?new Uint16Array(512):zt(512),qn=_e?new Uint16Array(32):zt(32);if(!_e){for(var Xt=0;Xt<512;++Xt)an[Xt]=0;for(Xt=0;Xt<32;++Xt)qn[Xt]=0}(function(){for(var V=[],Z=0;Z<32;Z++)V.push(5);Gr(V,qn,32);var G=[];for(Z=0;Z<=143;Z++)G.push(8);for(;Z<=255;Z++)G.push(9);for(;Z<=279;Z++)G.push(7);for(;Z<=287;Z++)G.push(8);Gr(G,an,288)})();var Fr=(function(){for(var Z=_e?new Uint8Array(32768):[],G=0,K=0;G<Te.length-1;++G)for(;K<Te[G+1];++K)Z[K]=G;for(;K<32768;++K)Z[K]=29;var J=_e?new Uint8Array(259):[];for(G=0,K=0;G<ce.length-1;++G)for(;K<ce[G+1];++K)J[K]=G;function ee(Ce,me){for(var xe=0;xe<Ce.length;){var ge=Math.min(65535,Ce.length-xe),Be=xe+ge==Ce.length;for(me.write_shift(1,+Be),me.write_shift(2,ge),me.write_shift(2,~ge&65535);ge-- >0;)me[me.l++]=Ce[xe++]}return me.l}function de(Ce,me){for(var xe=0,ge=0,Be=_e?new Uint16Array(32768):[];ge<Ce.length;){var Ve=Math.min(65535,Ce.length-ge);if(Ve<10){for(xe=wt(me,xe,+(ge+Ve==Ce.length)),xe&7&&(xe+=8-(xe&7)),me.l=xe/8|0,me.write_shift(2,Ve),me.write_shift(2,~Ve&65535);Ve-- >0;)me[me.l++]=Ce[ge++];xe=me.l*8;continue}xe=wt(me,xe,+(ge+Ve==Ce.length)+2);for(var qe=0;Ve-- >0;){var Le=Ce[ge];qe=(qe<<5^Le)&32767;var Ge=-1,Ze=0;if((Ge=Be[qe])&&(Ge|=ge&-32768,Ge>ge&&(Ge-=32768),Ge<ge))for(;Ce[Ge+Ze]==Ce[ge+Ze]&&Ze<250;)++Ze;if(Ze>2){Le=J[Ze],Le<=22?xe=Hr(me,xe,ke[Le+1]>>1)-1:(Hr(me,xe,3),xe+=5,Hr(me,xe,ke[Le-23]>>5),xe+=3);var Yt=Le<8?0:Le-4>>2;Yt>0&&(ns(me,xe,Ze-ce[Le]),xe+=Yt),Le=Z[ge-Ge],xe=Hr(me,xe,ke[Le]>>3),xe-=3;var $t=Le<4?0:Le-2>>1;$t>0&&(ns(me,xe,ge-Ge-Te[Le]),xe+=$t);for(var cr=0;cr<Ze;++cr)Be[qe]=ge&32767,qe=(qe<<5^Ce[ge])&32767,++ge;Ve-=Ze-1}else Le<=143?Le=Le+48:xe=Ft(me,xe,1),xe=Hr(me,xe,ke[Le]),Be[qe]=ge&32767,++ge}xe=Hr(me,xe,0)-1}return me.l=(xe+7)/8|0,me.l}return function(me,xe){return me.length<8?ee(me,xe):de(me,xe)}})();function dt(V){var Z=Ae(50+Math.floor(V.length*1.1)),G=Fr(V,Z);return Z.slice(0,G)}var rr=_e?new Uint16Array(32768):zt(32768),sn=_e?new Uint16Array(32768):zt(32768),Mt=_e?new Uint16Array(128):zt(128),or=1,qr=1;function dr(V,Z){var G=We(V,Z)+257;Z+=5;var K=We(V,Z)+1;Z+=5;var J=et(V,Z)+4;Z+=4;for(var ee=0,de=_e?new Uint8Array(19):zt(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],me=1,xe=_e?new Uint8Array(8):zt(8),ge=_e?new Uint8Array(8):zt(8),Be=de.length,Ve=0;Ve<J;++Ve)de[te[Ve]]=ee=Pe(V,Z),me<ee&&(me=ee),xe[ee]++,Z+=3;var qe=0;for(xe[0]=0,Ve=1;Ve<=me;++Ve)ge[Ve]=qe=qe+xe[Ve-1]<<1;for(Ve=0;Ve<Be;++Ve)(qe=de[Ve])!=0&&(Ce[Ve]=ge[qe]++);var Le=0;for(Ve=0;Ve<Be;++Ve)if(Le=de[Ve],Le!=0){qe=ke[Ce[Ve]]>>8-Le;for(var Ge=(1<<7-Le)-1;Ge>=0;--Ge)Mt[qe|Ge<<Le]=Le&7|Ve<<3}var Ze=[];for(me=1;Ze.length<G+K;)switch(qe=Mt[je(V,Z)],Z+=qe&7,qe>>>=3){case 16:for(ee=3+Xe(V,Z),Z+=2,qe=Ze[Ze.length-1];ee-- >0;)Ze.push(qe);break;case 17:for(ee=3+Pe(V,Z),Z+=3;ee-- >0;)Ze.push(0);break;case 18:for(ee=11+je(V,Z),Z+=7;ee-- >0;)Ze.push(0);break;default:Ze.push(qe),me<qe&&(me=qe);break}var Yt=Ze.slice(0,G),$t=Ze.slice(G);for(Ve=G;Ve<286;++Ve)Yt[Ve]=0;for(Ve=K;Ve<30;++Ve)$t[Ve]=0;return or=Gr(Yt,rr,286),qr=Gr($t,sn,30),Z}function cc(V,Z){if(V[0]==3&&!(V[1]&3))return[Xl(Z),2];for(var G=0,K=0,J=DT(Z||1<<18),ee=0,de=J.length>>>0,Ce=0,me=0;(K&1)==0;){if(K=Pe(V,G),G+=3,K>>>1)K>>1==1?(Ce=9,me=5):(G=dr(V,G),Ce=or,me=qr);else{G&7&&(G+=8-(G&7));var xe=V[G>>>3]|V[(G>>>3)+1]<<8;if(G+=32,xe>0)for(!Z&&de<ee+xe&&(J=Gn(J,ee+xe),de=J.length);xe-- >0;)J[ee++]=V[G>>>3],G+=8;continue}for(;;){!Z&&de<ee+32767&&(J=Gn(J,ee+32767),de=J.length);var ge=ht(V,G,Ce),Be=K>>>1==1?an[ge]:rr[ge];if(G+=Be&15,Be>>>=4,(Be>>>8&255)===0)J[ee++]=Be;else{if(Be==256)break;Be-=257;var Ve=Be<8?0:Be-4>>2;Ve>5&&(Ve=0);var qe=ee+ce[Be];Ve>0&&(qe+=ht(V,G,Ve),G+=Ve),ge=ht(V,G,me),Be=K>>>1==1?qn[ge]:sn[ge],G+=Be&15,Be>>>=4;var Le=Be<4?0:Be-2>>1,Ge=Te[Be];for(Le>0&&(Ge+=ht(V,G,Le),G+=Le),!Z&&de<qe&&(J=Gn(J,qe+100),de=J.length);ee<qe;)J[ee]=J[ee-Ge],++ee}}}return Z?[J,G+7>>>3]:[J.slice(0,ee),G+7>>>3]}function Js(V,Z){var G=V.slice(V.l||0),K=cc(G,Z);return V.l+=K[1],K[0]}function so(V,Z){if(V)typeof console<"u"&&console.error(Z);else throw new Error(Z)}function ma(V,Z){var G=V;Sn(G,0);var K=[],J=[],ee={FileIndex:K,FullPaths:J};A(ee,{root:Z.root});for(var de=G.length-4;(G[de]!=80||G[de+1]!=75||G[de+2]!=5||G[de+3]!=6)&&de>=0;)--de;G.l=de+4,G.l+=4;var Ce=G.read_shift(2);G.l+=6;var me=G.read_shift(4);for(G.l=me,de=0;de<Ce;++de){G.l+=20;var xe=G.read_shift(4),ge=G.read_shift(4),Be=G.read_shift(2),Ve=G.read_shift(2),qe=G.read_shift(2);G.l+=8;var Le=G.read_shift(4),Ge=u(G.slice(G.l+Be,G.l+Be+Ve));G.l+=Be+Ve+qe;var Ze=G.l;G.l=Le+4,Zs(G,xe,ge,ee,Ge),G.l=Ze}return ee}function Zs(V,Z,G,K,J){V.l+=2;var ee=V.read_shift(2),de=V.read_shift(2),Ce=o(V);if(ee&8257)throw new Error("Unsupported ZIP encryption");for(var me=V.read_shift(4),xe=V.read_shift(4),ge=V.read_shift(4),Be=V.read_shift(2),Ve=V.read_shift(2),qe="",Le=0;Le<Be;++Le)qe+=String.fromCharCode(V[V.l++]);if(Ve){var Ge=u(V.slice(V.l,V.l+Ve));(Ge[21589]||{}).mt&&(Ce=Ge[21589].mt),((J||{})[21589]||{}).mt&&(Ce=J[21589].mt)}V.l+=Ve;var Ze=V.slice(V.l,V.l+xe);switch(de){case 8:Ze=Y(V,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Yt=!1;ee&8&&(me=V.read_shift(4),me==134695760&&(me=V.read_shift(4),Yt=!0),xe=V.read_shift(4),ge=V.read_shift(4)),xe!=Z&&so(Yt,"Bad compressed size: "+Z+" != "+xe),ge!=G&&so(Yt,"Bad uncompressed size: "+G+" != "+ge),ri(K,qe,Ze,{unsafe:!0,mt:Ce})}function kr(V,Z){var G=Z||{},K=[],J=[],ee=Ae(1),de=G.compression?8:0,Ce=0,me=0,xe=0,ge=0,Be=0,Ve=V.FullPaths[0],qe=Ve,Le=V.FileIndex[0],Ge=[],Ze=0;for(me=1;me<V.FullPaths.length;++me)if(qe=V.FullPaths[me].slice(Ve.length),Le=V.FileIndex[me],!(!Le.size||!Le.content||qe=="Sh33tJ5")){var Yt=ge,$t=Ae(qe.length);for(xe=0;xe<qe.length;++xe)$t.write_shift(1,qe.charCodeAt(xe)&127);$t=$t.slice(0,$t.l),Ge[Be]=k7.buf(Le.content,0);var cr=Le.content;de==8&&(cr=q(cr)),ee=Ae(30),ee.write_shift(4,67324752),ee.write_shift(2,20),ee.write_shift(2,Ce),ee.write_shift(2,de),Le.mt?i(ee,Le.mt):ee.write_shift(4,0),ee.write_shift(-4,Ge[Be]),ee.write_shift(4,cr.length),ee.write_shift(4,Le.content.length),ee.write_shift(2,$t.length),ee.write_shift(2,0),ge+=ee.length,K.push(ee),ge+=$t.length,K.push($t),ge+=cr.length,K.push(cr),ee=Ae(46),ee.write_shift(4,33639248),ee.write_shift(2,0),ee.write_shift(2,20),ee.write_shift(2,Ce),ee.write_shift(2,de),ee.write_shift(4,0),ee.write_shift(-4,Ge[Be]),ee.write_shift(4,cr.length),ee.write_shift(4,Le.content.length),ee.write_shift(2,$t.length),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(4,0),ee.write_shift(4,Yt),Ze+=ee.l,J.push(ee),Ze+=$t.length,J.push($t),++Be}return ee=Ae(22),ee.write_shift(4,101010256),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,Be),ee.write_shift(2,Be),ee.write_shift(4,Ze),ee.write_shift(4,ge),ee.write_shift(2,0),gn([gn(K),gn(J),ee])}var Wn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Da(V,Z){if(V.ctype)return V.ctype;var G=V.name||"",K=G.match(/\.([^\.]+)$/);return K&&Wn[K[1]]||Z&&(K=(G=Z).match(/[\.\\]([^\.\\])+$/),K&&Wn[K[1]])?Wn[K[1]]:"application/octet-stream"}function pa(V){for(var Z=w0(V),G=[],K=0;K<Z.length;K+=76)G.push(Z.slice(K,K+76));return G.join(`\r
`)+`\r
`}function Vu(V){var Z=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var ge=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});Z=Z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Z.charAt(0)==`
`&&(Z="=0D"+Z.slice(1)),Z=Z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var G=[],K=Z.split(`\r
`),J=0;J<K.length;++J){var ee=K[J];if(ee.length==0){G.push("");continue}for(var de=0;de<ee.length;){var Ce=76,me=ee.slice(de,de+Ce);me.charAt(Ce-1)=="="?Ce--:me.charAt(Ce-2)=="="?Ce-=2:me.charAt(Ce-3)=="="&&(Ce-=3),me=ee.slice(de,de+Ce),de+=Ce,de<ee.length&&(me+="="),G.push(me)}}return G.join(`\r
`)}function uc(V){for(var Z=[],G=0;G<V.length;++G){for(var K=V[G];G<=V.length&&K.charAt(K.length-1)=="=";)K=K.slice(0,K.length-1)+V[++G];Z.push(K)}for(var J=0;J<Z.length;++J)Z[J]=Z[J].replace(/[=][0-9A-Fa-f]{2}/g,function(ee){return String.fromCharCode(parseInt(ee.slice(1),16))});return ka(Z.join(`\r
`))}function Oa(V,Z,G){for(var K="",J="",ee="",de,Ce=0;Ce<10;++Ce){var me=Z[Ce];if(!me||me.match(/^\s*$/))break;var xe=me.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":K=xe[2].trim();break;case"content-type":ee=xe[2].trim();break;case"content-transfer-encoding":J=xe[2].trim();break}}switch(++Ce,J.toLowerCase()){case"base64":de=ka(Ia(Z.slice(Ce).join("")));break;case"quoted-printable":de=uc(Z.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+J)}var ge=ri(V,K.slice(G.length),de,{unsafe:!0});ee&&(ge.ctype=ee)}function ei(V,Z){if(ne(V.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var G=Z&&Z.root||"",K=(Tt&&Buffer.isBuffer(V)?V.toString("binary"):ne(V)).split(`\r
`),J=0,ee="";for(J=0;J<K.length;++J)if(ee=K[J],!!/^Content-Location:/i.test(ee)&&(ee=ee.slice(ee.indexOf("file")),G||(G=ee.slice(0,ee.lastIndexOf("/")+1)),ee.slice(0,G.length)!=G))for(;G.length>0&&(G=G.slice(0,G.length-1),G=G.slice(0,G.lastIndexOf("/")+1),ee.slice(0,G.length)!=G););var de=(K[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var Ce="--"+(de[1]||""),me=[],xe=[],ge={FileIndex:me,FullPaths:xe};A(ge);var Be,Ve=0;for(J=0;J<K.length;++J){var qe=K[J];qe!==Ce&&qe!==Ce+"--"||(Ve++&&Oa(ge,K.slice(Be,J),G),Be=J)}return ge}function Uu(V,Z){var G=Z||{},K=G.boundary||"SheetJS";K="------="+K;for(var J=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+K.slice(2)+'"',"","",""],ee=V.FullPaths[0],de=ee,Ce=V.FileIndex[0],me=1;me<V.FullPaths.length;++me)if(de=V.FullPaths[me].slice(ee.length),Ce=V.FileIndex[me],!(!Ce.size||!Ce.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ze){return"_x"+Ze.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ze){return"_u"+Ze.charCodeAt(0).toString(16)+"_"});for(var xe=Ce.content,ge=Tt&&Buffer.isBuffer(xe)?xe.toString("binary"):ne(xe),Be=0,Ve=Math.min(1024,ge.length),qe=0,Le=0;Le<=Ve;++Le)(qe=ge.charCodeAt(Le))>=32&&qe<128&&++Be;var Ge=Be>=Ve*4/5;J.push(K),J.push("Content-Location: "+(G.root||"file:///C:/SheetJS/")+de),J.push("Content-Transfer-Encoding: "+(Ge?"quoted-printable":"base64")),J.push("Content-Type: "+Da(Ce,de)),J.push(""),J.push(Ge?Vu(ge):pa(ge))}return J.push(K+`--\r
`),J.join(`\r
`)}function ti(V){var Z={};return A(Z,V),Z}function ri(V,Z,G,K){var J=K&&K.unsafe;J||A(V);var ee=!J&&at.find(V,Z);if(!ee){var de=V.FullPaths[0];Z.slice(0,de.length)==de?de=Z:(de.slice(-1)!="/"&&(de+="/"),de=(de+Z).replace("//","/")),ee={name:a(Z),type:2},V.FileIndex.push(ee),V.FullPaths.push(de),J||at.utils.cfb_gc(V)}return ee.content=G,ee.size=G?G.length:0,K&&(K.CLSID&&(ee.clsid=K.CLSID),K.mt&&(ee.mt=K.mt),K.ct&&(ee.ct=K.ct)),ee}function io(V,Z){A(V);var G=at.find(V,Z);if(G){for(var K=0;K<V.FileIndex.length;++K)if(V.FileIndex[K]==G)return V.FileIndex.splice(K,1),V.FullPaths.splice(K,1),!0}return!1}function ni(V,Z,G){A(V);var K=at.find(V,Z);if(K){for(var J=0;J<V.FileIndex.length;++J)if(V.FileIndex[J]==K)return V.FileIndex[J].name=a(G),V.FullPaths[J]=G,!0}return!1}function as(V){N(V,!0)}return e.find=M,e.read=X,e.parse=p,e.write=ye,e.writeFile=le,e.utils={cfb_new:ti,cfb_add:ri,cfb_del:io,cfb_mov:ni,cfb_gc:as,ReadShift:t0,CheckField:LC,prep_blob:Sn,bconcat:gn,use_zlib:O,_deflateRaw:dt,_inflateRaw:Js,consts:oe},e})();function C7(t){return typeof t=="string"?Ep(t):Array.isArray(t)?e7(t):t}function rh(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Ep(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Bs(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([C7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=ro(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function N7(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Or(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function VT(t,e){for(var r=[],n=Or(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function Sp(t){for(var e=[],r=Or(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Ap(t){for(var e=[],r=Or(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function R7(t){for(var e=[],r=Or(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Bm=new Date(1899,11,30,0,0,0);function fn(t,e){var r=t.getTime(),n=Bm.getTime()+(t.getTimezoneOffset()-Bm.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var xC=new Date,I7=Bm.getTime()+(xC.getTimezoneOffset()-Bm.getTimezoneOffset())*6e4,UT=xC.getTimezoneOffset();function kp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+I7),e.getTimezoneOffset()!==UT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-UT)*6e4),e}function D7(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[i],10)}return e}var zT=new Date("2017-02-19T19:06:09.000Z"),vC=isNaN(zT.getFullYear())?new Date("2/19/17"):zT,O7=vC.getFullYear()==2017;function vr(t,e){var r=new Date(t);if(O7)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(vC.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function $o(t,e){if(Tt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Bs(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Bs(sC(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Bs(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Bs(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function yr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=yr(t[r]));return e}function Rr(t,e){for(var r="";r.length<e;)r+=t;return r}function ws(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var F7=["january","february","march","april","may","june","july","august","september","october","november","december"];function Eu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&F7.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var M7=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],u=1;u<i.length;++u)o.push(a),o.push(i[u]);return o}})();function yC(t){return t?t.content&&t.type?$o(t.content,!0):t.data?qf(t.data):t.asNodeBuffer&&Tt?qf(t.asNodeBuffer().toString("binary")):t.asBinary?qf(t.asBinary()):t._data&&t._data.getContent?qf($o(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function _C(t){if(!t)return null;if(t.data)return RT(t.data);if(t.asNodeBuffer&&Tt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?RT(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function P7(t){return t&&t.name.slice(-4)===".bin"?_C(t):yC(t)}function $a(t,e){for(var r=t.FullPaths||Or(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function Ty(t,e){var r=$a(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Zr(t,e,r){if(!r)return P7(Ty(t,e));if(!e)return null;try{return Zr(t,e)}catch{return null}}function Ca(t,e,r){if(!r)return yC(Ty(t,e));if(!e)return null;try{return Ca(t,e)}catch{return null}}function j7(t,e,r){return _C(Ty(t,e))}function HT(t){for(var e=t.FullPaths||Or(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Et(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Tt?n=Bi(r):n=t7(r),at.utils.cfb_add(t,e,n)}at.utils.cfb_add(t,e,r)}else t.file(e,r)}function Sy(){return at.utils.cfb_new()}function wC(t,e){switch(e.type){case"base64":return at.read(t,{type:"base64"});case"binary":return at.read(t,{type:"binary"});case"buffer":case"array":return at.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Xf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var zr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,L7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,GT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,B7=/<[^>]*>/g,Hn=zr.match(GT)?GT:B7,V7=/<\w*:/,U7=/<(\/?)\w+:/;function ut(t,e,r){for(var n={},a=0,i=0;a!==t.length&&!((i=t.charCodeAt(a))===32||i===10||i===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var o=t.match(L7),u=0,f="",d=0,p="",x="",y=1;if(o)for(d=0;d!=o.length;++d){for(x=o[d],i=0;i!=x.length&&x.charCodeAt(i)!==61;++i);for(p=x.slice(0,i).trim();x.charCodeAt(i+1)==32;)++i;for(y=(a=x.charCodeAt(i+1))==34||a==39?1:0,f=x.slice(i+1+y,x.length-y),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=f,n[p.toLowerCase()]=f;else{var w=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[w]&&p.slice(u-3,u)=="ext")continue;n[w]=f,n[w.toLowerCase()]=f}}return n}function Ks(t){return t.replace(U7,"<$1")}var bC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ay=Sp(bC),jt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(t,function(u,f){return bC[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,f){return String.fromCharCode(parseInt(f,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}})(),ky=/[&<>'"]/g,z7=/[\u0000-\u0008\u000b-\u001f]/g;function tr(t){var e=t+"";return e.replace(ky,function(r){return Ay[r]}).replace(z7,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function qT(t){return tr(t).replace(/ /g,"_x0020_")}var EC=/[\u0000-\u001f]/g;function Cy(t){var e=t+"";return e.replace(ky,function(r){return Ay[r]}).replace(/\n/g,"<br/>").replace(EC,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function H7(t){var e=t+"";return e.replace(ky,function(r){return Ay[r]}).replace(EC,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var WT=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function G7(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function gr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Q1(t){for(var e="",r=0,n=0,a=0,i=0,o=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function XT(t){var e=Xl(2*t.length),r,n,a=1,i=0,o=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function YT(t){return Bi(t,"binary").toString("utf8")}var Vd="foo bar baz",lr=Tt&&(YT(Vd)==Q1(Vd)&&YT||XT(Vd)==Q1(Vd)&&XT)||Q1,Bs=Tt?function(t){return Bi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},E0=(function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),TC=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}})(),q7=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),W7=/<\/?(?:vt:)?variant>/g,X7=/<(?:vt:)([^>]*)>([\s\S]*)</;function $T(t,e){var r=ut(t),n=t.match(q7(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace(W7,"").match(X7);o&&a.push({v:lr(o[2]),t:o[1]})}),a}var SC=/(^\s|\s$|\n)/;function kn(t,e){return"<"+t+(e.match(SC)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function T0(t){return Or(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ue(t,e,r){return"<"+t+(r!=null?T0(r):"")+(e!=null?(e.match(SC)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Xx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Y7(t,e){switch(typeof t){case"string":var r=Ue("vt:lpwstr",tr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ue((t|0)==t?"vt:i4":"vt:r8",tr(String(t)));case"boolean":return Ue("vt:bool",t?"true":"false")}if(t instanceof Date)return Ue("vt:filetime",Xx(t));throw new Error("Unable to serialize "+t)}function Ny(t){if(Tt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return lr(ro(wy(t)));throw new Error("Bad input format: expected Buffer or string")}var S0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,on={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},nc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Sa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function $7(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,i=5;i>=0;--i)a=a*256+t[e+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function K7(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,i=0,o=n?-e:e;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(e)?26985:0);for(var u=0;u<=5;++u,i/=256)t[r+u]=i&255;t[r+6]=(a&15)<<4|i&15,t[r+7]=a>>4|n}var KT=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,i=t[0][n].length;a<i;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},QT=Tt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Bi(e)})):KT(t)}:KT,JT=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(Si(t,a)));return n.join("").replace(Zn,"")},Ry=Tt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Zn,""):JT(t,e,r)}:JT,ZT=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},AC=Tt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):ZT(t,e,r)}:ZT,eS=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(tu(t,a)));return n.join("")},nh=Tt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):eS(e,r,n)}:eS,kC=function(t,e){var r=Aa(t,e);return r>0?nh(t,e+4,e+4+r-1):""},CC=kC,NC=function(t,e){var r=Aa(t,e);return r>0?nh(t,e+4,e+4+r-1):""},RC=NC,IC=function(t,e){var r=2*Aa(t,e);return r>0?nh(t,e+4,e+4+r-1):""},DC=IC,OC=function(e,r){var n=Aa(e,r);return n>0?Ry(e,r+4,r+4+n):""},FC=OC,MC=function(t,e){var r=Aa(t,e);return r>0?nh(t,e+4,e+4+r):""},PC=MC,jC=function(t,e){return $7(t,e)},Vm=jC,Iy=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Tt&&(CC=function(e,r){if(!Buffer.isBuffer(e))return kC(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},RC=function(e,r){if(!Buffer.isBuffer(e))return NC(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},DC=function(e,r){if(!Buffer.isBuffer(e))return IC(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},FC=function(e,r){if(!Buffer.isBuffer(e))return OC(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},PC=function(e,r){if(!Buffer.isBuffer(e))return MC(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Vm=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):jC(e,r)},Iy=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var tu=function(t,e){return t[e]},Si=function(t,e){return t[e+1]*256+t[e]},Q7=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Aa=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Oo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},J7=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function t0(t,e){var r="",n,a,i=[],o,u,f,d;switch(e){case"dbcs":if(d=this.l,Tt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(Si(this,d)),d+=2;t*=2;break;case"utf8":r=nh(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Ry(this,this.l,this.l+t);break;case"wstr":return t0.call(this,t,"dbcs");case"lpstr-ansi":r=CC(this,this.l),t=4+Aa(this,this.l);break;case"lpstr-cp":r=RC(this,this.l),t=4+Aa(this,this.l);break;case"lpwstr":r=DC(this,this.l),t=4+2*Aa(this,this.l);break;case"lpp4":t=4+Aa(this,this.l),r=FC(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Aa(this,this.l),r=PC(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=tu(this,this.l+t++))!==0;)i.push(Bd(o));r=i.join("");break;case"_wstr":for(t=0,r="";(o=Si(this,this.l+t))!==0;)i.push(Bd(o)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=tu(this,d),this.l=d+1,u=t0.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Bd(Si(this,d))),d+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=tu(this,d),this.l=d+1,u=t0.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Bd(tu(this,d))),d+=1}r=i.join("");break;default:switch(t){case 1:return n=tu(this,this.l),this.l++,n;case 2:return n=(e==="i"?Q7:Si)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Oo:J7)(this,this.l),this.l+=4,n):(a=Aa(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=Vm(this,this.l):a=Vm([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=AC(this,this.l,t);break}}return this.l+=t,r}var Z7=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},eB=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},tB=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function rB(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)tB(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Z7(this,e,this.l);break;case 8:if(n=8,r==="f"){K7(this,e,this.l);break}case 16:break;case-4:n=4,eB(this,e,this.l);break}return this.l+=n,this}function LC(t,e){var r=AC(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Sn(t,e){t.l=e,t.read_shift=t0,t.chk=LC,t.write_shift=rB}function zn(t,e){t.l+=e}function Ae(t){var e=Xl(t);return Sn(e,0),e}function Vi(t,e,r){if(t){var n,a,i;Sn(t,t.l||0);for(var o=t.length,u=0,f=0;t.l<o;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=I0[u]||I0[65535];for(n=t.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=t.read_shift(1))&127)<<7*a;f=t.l+i;var p=d.f&&d.f(t,i,r);if(t.l=f,e(p,d,u))return}}}function ha(){var t=[],e=Tt?256:2048,r=function(d){var p=Ae(d);return Sn(p,0),p},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,e)))},o=function(){return a(),gn(t)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:u,end:o,_bufs:t}}function Me(t,e,r,n){var a=+e,i;if(!isNaN(a)){n||(n=I0[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=t.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Iy(r)&&t.push(r)}}function r0(t,e,r){var n=yr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function tS(t,e,r){var n=yr(t);return n.s=r0(n.s,e.s,r),n.e=r0(n.e,e.s,r),n}function n0(t,e){if(t.cRel&&t.c<0)for(t=yr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=yr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ot(t);return!t.cRel&&t.cRel!=null&&(r=sB(r)),!t.rRel&&t.rRel!=null&&(r=nB(r)),r}function J1(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Tr(t.s.c)+":"+(t.e.cRel?"":"$")+Tr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ur(t.s.r)+":"+(t.e.rRel?"":"$")+Ur(t.e.r):n0(t.s,e.biff)+":"+n0(t.e,e.biff)}function Dy(t){return parseInt(aB(t),10)-1}function Ur(t){return""+(t+1)}function nB(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function aB(t){return t.replace(/\$(\d+)$/,"$1")}function Oy(t){for(var e=iB(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Tr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function sB(t){return t.replace(/^([A-Z])/,"$$$1")}function iB(t){return t.replace(/^\$([A-Z])/,"$1")}function lB(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sr(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function ot(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function da(t){var e=t.indexOf(":");return e==-1?{s:Sr(t),e:Sr(t)}:{s:Sr(t.slice(0,e)),e:Sr(t.slice(e+1))}}function _t(t,e){return typeof e>"u"||typeof e=="number"?_t(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function Lt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=t.length;for(r=0;n<i&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<i&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===i||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=i&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function rS(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=es(t.z,r?fn(e):e)}catch{}try{return t.w=es((t.XF||{}).numFmtId||(r?14:0),r?fn(e):e)}catch{return""+e}}function ji(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ui[t.v]||t.v:e==null?rS(t,t.v):rS(t,e))}function no(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function BC(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,i=t||(a?[]:{}),o=0,u=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?Sr(n.origin):n.origin;o=f.r,u=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var p=Lt(i["!ref"]);d.s.c=p.s.c,d.s.r=p.s.r,d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),o==-1&&(d.e.r=o=p.e.r+1)}for(var x=0;x!=e.length;++x)if(e[x]){if(!Array.isArray(e[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=e[x].length;++y)if(!(typeof e[x][y]>"u")){var w={v:e[x][y]},b=o+x,E=u+y;if(d.s.r>b&&(d.s.r=b),d.s.c>E&&(d.s.c=E),d.e.r<b&&(d.e.r=b),d.e.c<E&&(d.e.c=E),e[x][y]&&typeof e[x][y]=="object"&&!Array.isArray(e[x][y])&&!(e[x][y]instanceof Date))w=e[x][y];else if(Array.isArray(w.v)&&(w.f=e[x][y][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(n.nullError)w.t="e",w.v=0;else if(n.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=n.dateNF||lt[14],n.cellDates?(w.t="d",w.w=es(w.z,fn(w.v))):(w.t="n",w.v=fn(w.v),w.w=es(w.z,w.v))):w.t="s";if(a)i[b]||(i[b]=[]),i[b][E]&&i[b][E].z&&(w.z=i[b][E].z),i[b][E]=w;else{var T=ot({c:E,r:b});i[T]&&i[T].z&&(w.z=i[T].z),i[T]=w}}}return d.s.c<1e7&&(i["!ref"]=_t(d)),i}function Lu(t,e){return BC(null,t,e)}function oB(t){return t.read_shift(4,"i")}function bs(t,e){return e||(e=Ae(4)),e.write_shift(4,t),e}function Vn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function xn(t,e){var r=!1;return e==null&&(r=!0,e=Ae(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function cB(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function uB(t,e){return e||(e=Ae(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Fy(t,e){var r=t.l,n=t.read_shift(1),a=Vn(t),i=[],o={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)i.push(cB(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function fB(t,e){var r=!1;return e==null&&(r=!0,e=Ae(15+4*t.t.length)),e.write_shift(1,0),xn(t.t,e),r?e.slice(0,e.l):e}var hB=Fy;function dB(t,e){var r=!1;return e==null&&(r=!0,e=Ae(23+4*t.t.length)),e.write_shift(1,1),xn(t.t,e),e.write_shift(4,1),uB({},e),r?e.slice(0,e.l):e}function rs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function ac(t,e){return e==null&&(e=Ae(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function sc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function ic(t,e){return e==null&&(e=Ae(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var mB=Vn,VC=xn;function My(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Um(t,e){var r=!1;return e==null&&(r=!0,e=Ae(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var pB=Vn,Yx=My,Py=Um;function jy(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?Vm([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Oo(e,0)>>2;return r?a/100:a}function UC(t,e){e==null&&(e=Ae(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function zC(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function gB(t,e){return e||(e=Ae(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var lc=zC,Bu=gB;function Bn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ko(t,e){return(e||Ae(8)).write_shift(8,t,"f")}function xB(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=Bo[a];d&&(e.rgb=k0(d));break;case 2:e.rgb=k0([o,u,f]);break;case 3:e.theme=a;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function zm(t,e){if(e||(e=Ae(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function vB(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function yB(t,e){e||(e=Ae(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function HC(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function _B(t){return HC(t,1)}function wB(t){return HC(t,2)}var Ly=2,la=3,Ud=11,nS=12,Hm=19,zd=64,bB=65,EB=71,TB=4108,SB=4126,pn=80,GC=81,AB=[pn,GC],$x={1:{n:"CodePage",t:Ly},2:{n:"Category",t:pn},3:{n:"PresentationFormat",t:pn},4:{n:"ByteCount",t:la},5:{n:"LineCount",t:la},6:{n:"ParagraphCount",t:la},7:{n:"SlideCount",t:la},8:{n:"NoteCount",t:la},9:{n:"HiddenCount",t:la},10:{n:"MultimediaClipCount",t:la},11:{n:"ScaleCrop",t:Ud},12:{n:"HeadingPairs",t:TB},13:{n:"TitlesOfParts",t:SB},14:{n:"Manager",t:pn},15:{n:"Company",t:pn},16:{n:"LinksUpToDate",t:Ud},17:{n:"CharacterCount",t:la},19:{n:"SharedDoc",t:Ud},22:{n:"HyperlinksChanged",t:Ud},23:{n:"AppVersion",t:la,p:"version"},24:{n:"DigSig",t:bB},26:{n:"ContentType",t:pn},27:{n:"ContentStatus",t:pn},28:{n:"Language",t:pn},29:{n:"Version",t:pn},255:{},2147483648:{n:"Locale",t:Hm},2147483651:{n:"Behavior",t:Hm},1919054434:{}},Kx={1:{n:"CodePage",t:Ly},2:{n:"Title",t:pn},3:{n:"Subject",t:pn},4:{n:"Author",t:pn},5:{n:"Keywords",t:pn},6:{n:"Comments",t:pn},7:{n:"Template",t:pn},8:{n:"LastAuthor",t:pn},9:{n:"RevNumber",t:pn},10:{n:"EditTime",t:zd},11:{n:"LastPrinted",t:zd},12:{n:"CreatedDate",t:zd},13:{n:"ModifiedDate",t:zd},14:{n:"PageCount",t:la},15:{n:"WordCount",t:la},16:{n:"CharCount",t:la},17:{n:"Thumbnail",t:EB},18:{n:"Application",t:pn},19:{n:"DocSecurity",t:la},255:{},2147483648:{n:"Locale",t:Hm},2147483651:{n:"Behavior",t:Hm},1919054434:{}},aS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},kB=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function CB(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var NB=CB([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Bo=yr(NB),Ui={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Qx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Hd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function By(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function RB(t){var e=By();if(!t||!t.match)return e;var r={};if((t.match(Hn)||[]).forEach(function(n){var a=ut(n);switch(a[0].replace(V7,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[Qx[a.ContentType]]!==void 0&&e[Qx[a.ContentType]].push(a.PartName);break}}),e.xmlns!==on.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function WC(t,e){var r=R7(Qx),n=[],a;n[n.length]=zr,n[n.length]=Ue("Types",null,{xmlns:on.CT,"xmlns:xsd":on.xsd,"xmlns:xsi":on.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Ue("Default",null,{Extension:f[0],ContentType:f[1]})}));var i=function(f){t[f]&&t[f].length>0&&(a=t[f][0],n[n.length]=Ue("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Hd[f][e.bookType]||Hd[f].xlsx}))},o=function(f){(t[f]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Hd[f][e.bookType]||Hd[f].xlsx})})},u=function(f){(t[f]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return i("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var St={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function A0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function a0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Hn)||[]).forEach(function(a){var i=ut(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var u=i.TargetMode==="External"?i.Target:Xf(i.Target,e);r[u]=o,n[i.Id]=o}}),r["!id"]=n,r}function uu(t){var e=[zr,Ue("Relationships",null,{xmlns:on.RELS})];return Or(t["!id"]).forEach(function(r){e[e.length]=Ue("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function er(t,e,r,n,a,i){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[St.HLINK,St.XPATH,St.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var IB="application/vnd.oasis.opendocument.spreadsheet";function DB(t,e){for(var r=Ny(t),n,a;n=S0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ut(n[0],!1),a.path=="/"&&a.type!==IB)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function OB(t){var e=[zr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function sS(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function FB(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function MB(t){var e=[zr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(sS(t[r][0],t[r][1])),e.push(FB("",t[r][0]));return e.push(sS("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function XC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Mm.version+"</meta:generator></office:meta></office:document-meta>"}var Za=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],PB=(function(){for(var t=new Array(Za.length),e=0;e<Za.length;++e){var r=Za[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function YC(t){var e={};t=lr(t);for(var r=0;r<Za.length;++r){var n=Za[r],a=t.match(PB[r]);a!=null&&a.length>0&&(e[n[1]]=jt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=vr(e[n[1]]))}return e}function Z1(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=tr(e),n[n.length]=r?Ue(t,e,r):kn(t,e))}function $C(t,e){var r=e||{},n=[zr,Ue("cp:coreProperties",null,{"xmlns:cp":on.CORE_PROPS,"xmlns:dc":on.dc,"xmlns:dcterms":on.dcterms,"xmlns:dcmitype":on.dcmitype,"xmlns:xsi":on.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Z1("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Xx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&Z1("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Xx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Za.length;++i){var o=Za[i],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Z1(o[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Vo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],KC=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function QC(t,e,r,n){var a=[];if(typeof t=="string")a=$T(t,n);else for(var i=0;i<t.length;++i)a=a.concat(t[i].map(function(p){return{v:p}}));var o=typeof e=="string"?$T(e,n).map(function(p){return p.v}):e,u=0,f=0;if(o.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=o.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=o.slice(u,u+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=o.slice(u,u+f);break}u+=f}}function jB(t,e,r){var n={};return e||(e={}),t=lr(t),Vo.forEach(function(a){var i=(t.match(E0(a[0]))||[])[1];switch(a[2]){case"string":i&&(e[a[1]]=jt(i));break;case"bool":e[a[1]]=i==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&QC(n.HeadingPairs,n.TitlesOfParts,e,r),e}function JC(t){var e=[],r=Ue;return t||(t={}),t.Application="SheetJS",e[e.length]=zr,e[e.length]=Ue("Properties",null,{xmlns:on.EXT_PROPS,"xmlns:vt":on.vt}),Vo.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=tr(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+tr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var LB=/<[^>]+>[^<]*/g;function BB(t,e){var r={},n="",a=t.match(LB);if(a)for(var i=0;i!=a.length;++i){var o=a[i],u=ut(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=jt(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var f=o.split(">"),d=f[0].slice(4),p=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=jt(p);break;case"bool":r[n]=gr(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=vr(p);break;case"cy":case"error":r[n]=jt(p);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,f)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function ZC(t){var e=[zr,Ue("Properties",null,{xmlns:on.CUST_PROPS,"xmlns:vt":on.vt})];if(!t)return e.join("");var r=1;return Or(t).forEach(function(a){++r,e[e.length]=Ue("property",Y7(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:tr(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Jx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ex;function VB(t,e,r){ex||(ex=Sp(Jx)),e=ex[e]||e,t[e]=r}function UB(t,e){var r=[];return Or(Jx).map(function(n){for(var a=0;a<Za.length;++a)if(Za[a][1]==n)return Za[a];for(a=0;a<Vo.length;++a)if(Vo[a][1]==n)return Vo[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(kn(Jx[n[1]]||n[1],a))}}),Ue("DocumentProperties",r.join(""),{xmlns:Sa.o})}function zB(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Or(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<Za.length;++o)if(i==Za[o][1])return;for(o=0;o<Vo.length;++o)if(i==Vo[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var u=t[i],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),a.push(Ue(qT(i),u,{"dt:dt":f}))}}),e&&Or(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=e[i],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Ue(qT(i),o,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Sa.o+'">'+a.join("")+"</"+n+">"}function Vy(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function HB(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var o=Ae(8);return o.write_shift(4,n),o.write_shift(4,a),o}function eN(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function tN(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function rN(t,e,r){return e===31?tN(t):eN(t,e,r)}function Zx(t,e,r){return rN(t,e,r===!1?0:4)}function GB(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return rN(t,e,0)}function qB(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Zn,""),t.l-a&2&&(t.l+=2)}return r}function WB(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Zn,"");return r}function XB(t){var e=t.l,r=Gm(t,GC);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Gm(t,la);return[r,n]}function YB(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(XB(t));return r}function iS(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var i=t.read_shift(4),o=t.read_shift(4);n[i]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Zn,"").replace(Wf,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function nN(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function $B(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Gm(t,e,r){var n=t.read_shift(2),a,i=r||{};if(t.l+=2,e!==nS&&n!==e&&AB.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===nS?n:e){case 2:return a=t.read_shift(2,"i"),i.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return eN(t,n,4).replace(Zn,"");case 31:return tN(t);case 64:return Vy(t);case 65:return nN(t);case 71:return $B(t);case 80:return Zx(t,n,!i.raw).replace(Zn,"");case 81:return GB(t,n).replace(Zn,"");case 4108:return YB(t);case 4126:case 4127:return n==4127?qB(t):WB(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function lS(t,e){var r=Ae(4),n=Ae(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Ae(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=HB(e);break;case 31:case 80:for(n=Ae(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return gn([r,n])}function oS(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),i=[],o=0,u=0,f=-1,d={};for(o=0;o!=a;++o){var p=t.read_shift(4),x=t.read_shift(4);i[o]=[p,x+r]}i.sort(function(R,C){return R[1]-C[1]});var y={};for(o=0;o!=a;++o){if(t.l!==i[o][1]){var w=!0;if(o>0&&e)switch(e[i[o-1][0]].t){case 2:t.l+2===i[o][1]&&(t.l+=2,w=!1);break;case 80:t.l<=i[o][1]&&(t.l=i[o][1],w=!1);break;case 4108:t.l<=i[o][1]&&(t.l=i[o][1],w=!1);break}if((!e||o==0)&&t.l<=i[o][1]&&(w=!1,t.l=i[o][1]),w)throw new Error("Read Error: Expected address "+i[o][1]+" at "+t.l+" :"+o)}if(e){var b=e[i[o][0]];if(y[b.n]=Gm(t,b.t,{raw:!0}),b.p==="version"&&(y[b.n]=String(y[b.n]>>16)+"."+("0000"+String(y[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(y[b.n]){case 0:y[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ys(u=y[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[b.n])}}else if(i[o][0]===1){if(u=y.CodePage=Gm(t,Ly),ys(u),f!==-1){var E=t.l;t.l=i[f][1],d=iS(t,u),t.l=E}}else if(i[o][0]===0){if(u===0){f=o,t.l=i[o+1][1];continue}d=iS(t,u)}else{var T=d[i[o][0]],I;switch(t[t.l]){case 65:t.l+=4,I=nN(t);break;case 30:t.l+=4,I=Zx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,I=Zx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,I=t.read_shift(4,"i");break;case 19:t.l+=4,I=t.read_shift(4);break;case 5:t.l+=4,I=t.read_shift(8,"f");break;case 11:t.l+=4,I=Lr(t,4);break;case 64:t.l+=4,I=vr(Vy(t));break;default:throw new Error("unparsed value: "+t[t.l])}y[T]=I}}return t.l=r+n,y}var aN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function KB(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function cS(t,e,r){var n=Ae(8),a=[],i=[],o=8,u=0,f=Ae(8),d=Ae(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),i.push(f),a.push(d),o+=8+f.length,!e){d=Ae(8),d.write_shift(4,0),a.unshift(d);var p=[Ae(4)];for(p[0].write_shift(4,t.length),u=0;u<t.length;++u){var x=t[u][0];for(f=Ae(8+2*(x.length+1)+(x.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,x.length+1),f.write_shift(0,x,"dbcs");f.l!=f.length;)f.write_shift(1,0);p.push(f)}f=gn(p),i.unshift(f),o+=8+f.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(aN.indexOf(t[u][0])>-1||KC.indexOf(t[u][0])>-1)&&t[u][1]!=null){var y=t[u][1],w=0;if(e){w=+e[t[u][0]];var b=r[w];if(b.p=="version"&&typeof y=="string"){var E=y.split(".");y=(+E[0]<<16)+(+E[1]||0)}f=lS(b.t,y)}else{var T=KB(y);T==-1&&(T=31,y=String(y)),f=lS(T,y)}i.push(f),d=Ae(8),d.write_shift(4,e?w:2+u),a.push(d),o+=8+f.length}var I=8*(i.length+1);for(u=0;u<i.length;++u)a[u].write_shift(4,I),I+=i[u].length;return n.write_shift(4,o),n.write_shift(4,i.length),gn([n].concat(a).concat(i))}function uS(t,e,r){var n=t.content;if(!n)return{};Sn(n,0);var a,i,o,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),p=n.read_shift(16);if(p!==at.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(o=n.read_shift(16),f=n.read_shift(4));var x=oS(n,e),y={SystemIdentifier:d};for(var w in x)y[w]=x[w];if(y.FMTID=i,a===1)return y;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var b;try{b=oS(n,null)}catch{}for(w in b)y[w]=b[w];return y.FMTID=[i,o],y}function fS(t,e,r,n,a,i){var o=Ae(a?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,at.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,a?68:48);var f=cS(t,r,n);if(u.push(f),a){var d=cS(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+f.length),u.push(d)}return gn(u)}function wl(t,e){return t.read_shift(e),null}function QB(t,e){e||(e=Ae(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function JB(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Lr(t,e){return t.read_shift(e)===1}function Kn(t,e){return e||(e=Ae(2)),e.write_shift(2,+!!t),e}function en(t){return t.read_shift(2,"u")}function Ka(t,e){return e||(e=Ae(2)),e.write_shift(2,t),e}function sN(t,e){return JB(t,e,en)}function ZB(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function iN(t,e,r){return r||(r=Ae(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function ah(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?t.read_shift(n,a):"";return o}function eV(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,i=1+(r&1),o=0,u,f={};a&&(o=t.read_shift(2)),n&&(u=t.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",p=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*o),n&&(t.l+=u),f.t=p,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function tV(t){var e=t.t||"",r=Ae(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Ae(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return gn(a)}function Qo(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function sh(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Qo(t,n,r)}function oc(t,e,r){if(r.biff>5)return sh(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function lN(t,e,r){return r||(r=Ae(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function rV(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function nV(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Zn,"");return n&&(t.l+=24),a}function aV(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(i>>1,"utf16le").replace(Zn,"");return r+o}function sV(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return nV(t);case"0303000000000000c000000000000046":return aV(t);default:throw new Error("Unsupported Moniker "+r)}}function Gd(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Zn,""):"";return r}function hS(t,e){e||(e=Ae(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function iV(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var i,o,u,f,d="",p,x;a&16&&(i=Gd(t,r-t.l)),a&128&&(o=Gd(t,r-t.l)),(a&257)===257&&(u=Gd(t,r-t.l)),(a&257)===1&&(f=sV(t,r-t.l)),a&8&&(d=Gd(t,r-t.l)),a&32&&(p=t.read_shift(16)),a&64&&(x=Vy(t)),t.l=r;var y=o||u||f||"";y&&d&&(y+="#"+d),y||(y="#"+d),a&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var w={Target:y};return p&&(w.guid=p),x&&(w.time=x),i&&(w.Tooltip=i),w}function lV(t){var e=Ae(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(i==28)n=n.slice(1),hS(n,e);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),i&8&&hS(a>-1?n.slice(a+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)e.write_shift(1,n.charCodeAt(r+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function oN(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function cN(t,e){var r=oN(t);return r[3]=0,r}function Qs(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Jo(t,e,r,n){return n||(n=Ae(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function oV(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function cV(t,e,r){return e===0?"":oc(t,e,r)}function uV(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),i=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[a,i,o]}function uN(t){var e=t.read_shift(2),r=jy(t);return[e,r]}function fV(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=ah(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,a}function Cp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function fN(t,e){return e||(e=Ae(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function hN(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var hV=hN;function dN(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function dV(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function mV(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function On(t){t.l+=2,t.l+=t.read_shift(2)}var pV={0:On,4:On,5:On,6:On,7:mV,8:On,9:On,10:On,11:On,12:On,13:dV,14:On,15:On,16:On,17:On,18:On,19:On,20:On,21:dN};function gV(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(pV[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function qd(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Uy(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ae(a);return i.write_shift(2,n),i.write_shift(2,e),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function xV(t,e){return e===0||t.read_shift(2),1200}function vV(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=oc(t,0,r);return t.read_shift(e+n-t.l),a}function yV(t,e){var r=!e||e.biff==8,n=Ae(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function _V(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function wV(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=ah(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function bV(t,e){var r=!e||e.biff>=8?2:1,n=Ae(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function EV(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),i=[],o=0;o!=a&&t.l<r;++o)i.push(eV(t));return i.Count=n,i.Unique=a,i}function TV(t,e){var r=Ae(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=tV(t[a]);var i=gn([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function SV(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function AV(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function kV(t){var e=oV(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function CV(t){return t.read_shift(2),t.read_shift(4)}function dS(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function NV(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),u=t.read_shift(2),f=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:u,Selected:f,TabRatio:d}}function RV(){var t=Ae(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function IV(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function DV(t){var e=Ae(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function OV(){}function FV(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=ah(t,0,r),n}function MV(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,i=Ae(a);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function PV(t){var e=Qs(t);return e.isst=t.read_shift(4),e}function jV(t,e,r,n){var a=Ae(10);return Jo(t,e,n,a),a.write_shift(4,r),a}function LV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=Qs(t);r.biff==2&&t.l++;var i=sh(t,n-t.l,r);return a.val=i,a}function BV(t,e,r,n,a){var i=!a||a.biff==8,o=Ae(8+ +i+(1+i)*r.length);return Jo(t,e,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function VV(t,e,r){var n=t.read_shift(2),a=oc(t,0,r);return[n,a]}function UV(t,e,r,n){var a=r&&r.biff==5;n||(n=Ae(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var zV=oc;function mS(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,i=t.read_shift(a),o=t.read_shift(a),u=t.read_shift(2),f=t.read_shift(2);return t.l=n,{s:{r:i,c:u},e:{r:o,c:f}}}function HV(t,e){var r=e.biff==8||!e.biff?4:2,n=Ae(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function GV(t){var e=t.read_shift(2),r=t.read_shift(2),n=uN(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function qV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),i=[];t.l<r;)i.push(uN(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function WV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function XV(t,e,r,n){var a={},i=t.read_shift(4),o=t.read_shift(4),u=t.read_shift(4),f=t.read_shift(2);return a.patternType=kB[u>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function YV(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=XV(t,e,n.fStyle,r),n}function pS(t,e,r,n){var a=r&&r.biff==5;n||(n=Ae(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function $V(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function KV(t){var e=Ae(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function gS(t,e,r){var n=Qs(t);(r.biff==2||e==9)&&++t.l;var a=ZB(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function QV(t,e,r,n,a,i){var o=Ae(8);return Jo(t,e,n,o),iN(r,i,o),o}function JV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Qs(t),a=Bn(t);return n.val=a,n}function ZV(t,e,r,n){var a=Ae(14);return Jo(t,e,n,a),Ko(r,a),a}var xS=cV;function eU(t,e,r){var n=t.l+e,a=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Qo(t,i),u=[];n>t.l;)u.push(sh(t));return[i,a,o,u]}function vS(t,e,r){var n=t.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=fV(t,e-2,r)),i.body=a||t.read_shift(e-2),typeof a=="string"&&(i.Name=a),i}var tU=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function yS(t,e,r){var n=t.l+e,a=t.read_shift(2),i=t.read_shift(1),o=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),f=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=Qo(t,o,r);a&32&&(d=tU[d.charCodeAt(0)]);var p=n-t.l;r&&r.biff==2&&--p;var x=n==t.l||u===0||!(p>0)?[]:gq(t,p,r,u);return{chKey:i,Name:d,itab:f,rgce:x}}function mN(t,e,r){if(r.biff<8)return rU(t,e,r);for(var n=[],a=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(uV(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function rU(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=ah(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function nU(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),i=Qo(t,n,r),o=Qo(t,a,r);return[i,o]}function aU(t,e,r){var n=hN(t);t.l++;var a=t.read_shift(1);return e-=8,[xq(t,e,r),a,n]}function _S(t,e,r){var n=hV(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,mq(t,e,r)]}function sU(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function iU(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),u=oc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,o,i]}}function lU(t,e,r){return iU(t,e,r)}function oU(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Cp(t));return r}function cU(t){var e=Ae(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)fN(t[r],e);return e}function uU(t,e,r){if(r&&r.biff<8)return hU(t,e,r);var n=dN(t),a=gV(t,e-22,n[1]);return{cmo:n,ft:a}}var fU={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function hU(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((fU[n]||zn)(t,e,r)),{cmo:[a,n,i],ft:o}}function dU(t,e,r){var n=t.l,a="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:o=rV(t,6,r);var u=t.read_shift(2);t.read_shift(2),en(t,2);var f=t.read_shift(2);t.l+=f;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var p=t[t.l],x=Qo(t,t.lens[d+1]-t.lens[d]-1);if(a+=x,a.length>=(p?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function mU(t,e){var r=Cp(t);t.l+=16;var n=iV(t,e-24);return[r,n]}function pU(t){var e=Ae(24),r=Sr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return gn([e,lV(t[1])])}function gU(t,e){t.read_shift(2);var r=Cp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Zn,""),[r,n]}function xU(t){var e=t[1].Tooltip,r=Ae(10+2*(e.length+1));r.write_shift(2,2048);var n=Sr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function vU(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=aS[r]||r,r=t.read_shift(2),e[1]=aS[r]||r,e}function yU(t){return t||(t=Ae(4)),t.write_shift(2,1),t.write_shift(2,1),t}function _U(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(cN(t));return r}function wU(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(cN(t));return r}function bU(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function pN(t,e,r){if(!r.cellStyles)return zn(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),u=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var d={s:a,e:i,w:o,ixfe:u,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function EU(t,e){var r=Ae(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function TU(t,e){var r={};return e<32||(t.l+=16,r.header=Bn(t),r.footer=Bn(t),t.l+=2),r}function SU(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function AU(t){for(var e=Ae(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var kU=Qs,CU=sN,NU=sh;function RU(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function IU(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Qs(t);++t.l;var a=oc(t,e-7,r);return n.t="str",n.val=a,n}function DU(t){var e=Qs(t);++t.l;var r=Bn(t);return e.t="n",e.val=r,e}function OU(t,e,r){var n=Ae(15);return ch(n,t,e),n.write_shift(8,r,"f"),n}function FU(t){var e=Qs(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function MU(t,e,r){var n=Ae(9);return ch(n,t,e),n.write_shift(2,r),n}function PU(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function jU(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function LU(t,e,r){var n=t.l+e,a=Qs(t),i=t.read_shift(2),o=Qo(t,i,r);return t.l=n,a.t="str",a.val=o,a}var BU=[2,3,48,49,131,139,140,245],ev=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Sp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,f){var d=[],p=Xl(1);switch(f.type){case"base64":p=ka(Ia(u));break;case"binary":p=ka(u);break;case"buffer":case"array":p=u;break}Sn(p,0);var x=p.read_shift(1),y=!!(x&136),w=!1,b=!1;switch(x){case 2:break;case 3:break;case 48:w=!0,y=!0;break;case 49:w=!0,y=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var E=0,T=521;x==2&&(E=p.read_shift(2)),p.l+=3,x!=2&&(E=p.read_shift(4)),E>1048576&&(E=1e6),x!=2&&(T=p.read_shift(2));var I=p.read_shift(2),R=f.codepage||1252;x!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(R=t[p[p.l]]),p.l+=1,p.l+=2),b&&(p.l+=36);for(var C=[],z={},H=Math.min(p.length,x==2?521:T-10-(w?264:0)),X=b?32:11;p.l<H&&p[p.l]!=13;)switch(z={},z.name=_0.utils.decode(R,p.slice(p.l,p.l+X)).replace(/[\u0000\r\n].*$/g,""),p.l+=X,z.type=String.fromCharCode(p.read_shift(1)),x!=2&&!b&&(z.offset=p.read_shift(4)),z.len=p.read_shift(1),x==2&&(z.offset=p.read_shift(2)),z.dec=p.read_shift(1),z.name.length&&C.push(z),x!=2&&(p.l+=b?13:14),z.type){case"B":(!w||z.len!=8)&&f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(p[p.l]!==13&&(p.l=T-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=T;var A=0,F=0;for(d[0]=[],F=0;F!=C.length;++F)d[0][F]=C[F].name;for(;E-- >0;){if(p[p.l]===42){p.l+=I;continue}for(++p.l,d[++A]=[],F=0,F=0;F!=C.length;++F){var N=p.slice(p.l,p.l+C[F].len);p.l+=C[F].len,Sn(N,0);var P=_0.utils.decode(R,N);switch(C[F].type){case"C":P.trim().length&&(d[A][F]=P.replace(/\s+$/,""));break;case"D":P.length===8?d[A][F]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):d[A][F]=P;break;case"F":d[A][F]=parseFloat(P.trim());break;case"+":case"I":d[A][F]=b?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":d[A][F]=!0;break;case"N":case"F":d[A][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));d[A][F]="##MEMO##"+(b?parseInt(P.trim(),10):N.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(d[A][F]=+P||0);break;case"@":d[A][F]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":d[A][F]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":d[A][F]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[A][F]=-N.read_shift(-8,"f");break;case"B":if(w&&C[F].len==8){d[A][F]=N.read_shift(8,"f");break}case"G":case"P":N.l+=C[F].len;break;case"0":if(C[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[F].type)}}}if(x!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=C,d}function n(u,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var p=Lu(r(u,d),d);return p["!cols"]=d.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete d.DBF,p}function a(u,f){try{return no(n(u,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,f){var d=f||{};if(+d.codepage>=0&&ys(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var p=ha(),x=Xm(u,{header:1,raw:!0,cellDates:!0}),y=x[0],w=x.slice(1),b=u["!cols"]||[],E=0,T=0,I=0,R=1;for(E=0;E<y.length;++E){if(((b[E]||{}).DBF||{}).name){y[E]=b[E].DBF.name,++I;continue}if(y[E]!=null){if(++I,typeof y[E]=="number"&&(y[E]=y[E].toString(10)),typeof y[E]!="string")throw new Error("DBF Invalid column name "+y[E]+" |"+typeof y[E]+"|");if(y.indexOf(y[E])!==E){for(T=0;T<1024;++T)if(y.indexOf(y[E]+"_"+T)==-1){y[E]+="_"+T;break}}}}var C=Lt(u["!ref"]),z=[],H=[],X=[];for(E=0;E<=C.e.c-C.s.c;++E){var A="",F="",N=0,P=[];for(T=0;T<w.length;++T)w[T][E]!=null&&P.push(w[T][E]);if(P.length==0||y[E]==null){z[E]="?";continue}for(T=0;T<P.length;++T){switch(typeof P[T]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=P[T]instanceof Date?"D":"C";break;default:F="C"}N=Math.max(N,String(P[T]).length),A=A&&A!=F?"C":F}N>250&&(N=250),F=((b[E]||{}).DBF||{}).type,F=="C"&&b[E].DBF.len>N&&(N=b[E].DBF.len),A=="B"&&F=="N"&&(A="N",X[E]=b[E].DBF.dec,N=b[E].DBF.len),H[E]=A=="C"||F=="N"?N:i[A]||0,R+=H[E],z[E]=A}var M=p.next(32);for(M.write_shift(4,318902576),M.write_shift(4,w.length),M.write_shift(2,296+32*I),M.write_shift(2,R),E=0;E<4;++E)M.write_shift(4,0);for(M.write_shift(4,0|(+e[aC]||3)<<8),E=0,T=0;E<y.length;++E)if(y[E]!=null){var j=p.next(32),B=(y[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,B,"sbcs"),j.write_shift(1,z[E]=="?"?"C":z[E],"sbcs"),j.write_shift(4,T),j.write_shift(1,H[E]||i[z[E]]||0),j.write_shift(1,X[E]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),T+=H[E]||i[z[E]]||0}var Se=p.next(264);for(Se.write_shift(4,13),E=0;E<65;++E)Se.write_shift(4,0);for(E=0;E<w.length;++E){var we=p.next(R);for(we.write_shift(1,0),T=0;T<y.length;++T)if(y[T]!=null)switch(z[T]){case"L":we.write_shift(1,w[E][T]==null?63:w[E][T]?84:70);break;case"B":we.write_shift(8,w[E][T]||0,"f");break;case"N":var se="0";for(typeof w[E][T]=="number"&&(se=w[E][T].toFixed(X[T]||0)),I=0;I<H[T]-se.length;++I)we.write_shift(1,32);we.write_shift(1,se,"sbcs");break;case"D":w[E][T]?(we.write_shift(4,("0000"+w[E][T].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(w[E][T].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+w[E][T].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(w[E][T]!=null?w[E][T]:"").slice(0,H[T]);for(we.write_shift(1,oe,"sbcs"),I=0;I<H[T]-oe.length;++I)we.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}})(),gN=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Or(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,w){var b=t[w];return typeof b=="number"?IT(b):b},n=function(y,w,b){var E=w.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return E==59?y:IT(E)};t["|"]=254;function a(y,w){switch(w.type){case"base64":return i(Ia(y),w);case"binary":return i(y,w);case"buffer":return i(Tt&&Buffer.isBuffer(y)?y.toString("binary"):ro(y),w);case"array":return i($o(y),w)}throw new Error("Unrecognized type "+w.type)}function i(y,w){var b=y.split(/[\n\r]+/),E=-1,T=-1,I=0,R=0,C=[],z=[],H=null,X={},A=[],F=[],N=[],P=0,M;for(+w.codepage>=0&&ys(+w.codepage);I!==b.length;++I){P=0;var j=b[I].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),B=j.replace(/;;/g,"\0").split(";").map(function(te){return te.replace(/\u0000/g,";")}),Se=B[0],we;if(j.length>0)switch(Se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&z.push(j.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,oe=!1,le=!1,ne=!1,ye=-1,Q=-1;for(R=1;R<B.length;++R)switch(B[R].charAt(0)){case"A":break;case"X":T=parseInt(B[R].slice(1))-1,oe=!0;break;case"Y":for(E=parseInt(B[R].slice(1))-1,oe||(T=0),M=C.length;M<=E;++M)C[M]=[];break;case"K":we=B[R].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(ws(we))?isNaN(Eu(we).getDate())||(we=vr(we)):(we=ws(we),H!==null&&Pu(H)&&(we=kp(we))),se=!0;break;case"E":ne=!0;var O=fu(B[R].slice(1),{r:E,c:T});C[E][T]=[C[E][T],O];break;case"S":le=!0,C[E][T]=[C[E][T],"S5S"];break;case"G":break;case"R":ye=parseInt(B[R].slice(1))-1;break;case"C":Q=parseInt(B[R].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+j)}if(se&&(C[E][T]&&C[E][T].length==2?C[E][T][0]=we:C[E][T]=we,H=null),le){if(ne)throw new Error("SYLK shared formula cannot have own formula");var Y=ye>-1&&C[ye][Q];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");C[E][T][1]=FN(Y[1],{r:E-ye,c:T-Q})}break;case"F":var q=0;for(R=1;R<B.length;++R)switch(B[R].charAt(0)){case"X":T=parseInt(B[R].slice(1))-1,++q;break;case"Y":for(E=parseInt(B[R].slice(1))-1,M=C.length;M<=E;++M)C[M]=[];break;case"M":P=parseInt(B[R].slice(1))/20;break;case"F":break;case"G":break;case"P":H=z[parseInt(B[R].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=B[R].slice(1).split(" "),M=parseInt(N[0],10);M<=parseInt(N[1],10);++M)P=parseInt(N[2],10),F[M-1]=P===0?{hidden:!0}:{wch:P},Yl(F[M-1]);break;case"C":T=parseInt(B[R].slice(1))-1,F[T]||(F[T]={});break;case"R":E=parseInt(B[R].slice(1))-1,A[E]||(A[E]={}),P>0?(A[E].hpt=P,A[E].hpx=Su(P)):P===0&&(A[E].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+j)}q<1&&(H=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+j)}}return A.length>0&&(X["!rows"]=A),F.length>0&&(X["!cols"]=F),w&&w.sheetRows&&(C=C.slice(0,w.sheetRows)),[C,X]}function o(y,w){var b=a(y,w),E=b[0],T=b[1],I=Lu(E,w);return Or(T).forEach(function(R){I[R]=T[R]}),I}function u(y,w){return no(o(y,w),w)}function f(y,w,b,E){var T="C;Y"+(b+1)+";X"+(E+1)+";K";switch(y.t){case"n":T+=y.v||0,y.f&&!y.F&&(T+=";E"+Xy(y.f,{r:b,c:E}));break;case"b":T+=y.v?"TRUE":"FALSE";break;case"e":T+=y.w||y.v;break;case"d":T+='"'+(y.w||y.v)+'"';break;case"s":T+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function d(y,w){w.forEach(function(b,E){var T="F;W"+(E+1)+" "+(E+1)+" ";b.hidden?T+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=C0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=N0(b.wpx)),typeof b.wch=="number"&&(T+=Math.round(b.wch))),T.charAt(T.length-1)!=" "&&y.push(T)})}function p(y,w){w.forEach(function(b,E){var T="F;";b.hidden?T+="M0;":b.hpt?T+="M"+20*b.hpt+";":b.hpx&&(T+="M"+20*R0(b.hpx)+";"),T.length>2&&y.push(T+"R"+(E+1))})}function x(y,w){var b=["ID;PWXL;N;E"],E=[],T=Lt(y["!ref"]),I,R=Array.isArray(y),C=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),y["!cols"]&&d(b,y["!cols"]),y["!rows"]&&p(b,y["!rows"]),b.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var z=T.s.r;z<=T.e.r;++z)for(var H=T.s.c;H<=T.e.c;++H){var X=ot({r:z,c:H});I=R?(y[z]||[])[H]:y[X],!(!I||I.v==null&&(!I.f||I.F))&&E.push(f(I,y,z,H))}return b.join(C)+C+E.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:o,from_sheet:x}})(),xN=(function(){function t(i,o){switch(o.type){case"base64":return e(Ia(i),o);case"binary":return e(i,o);case"buffer":return e(Tt&&Buffer.isBuffer(i)?i.toString("binary"):ro(i),o);case"array":return e($o(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var u=i.split(`
`),f=-1,d=-1,p=0,x=[];p!==u.length;++p){if(u[p].trim()==="BOT"){x[++f]=[],d=0;continue}if(!(f<0)){var y=u[p].trim().split(","),w=y[0],b=y[1];++p;for(var E=u[p]||"";(E.match(/["]/g)||[]).length&1&&p<u.length-1;)E+=`
`+u[++p];switch(E=E.trim(),+w){case-1:if(E==="BOT"){x[++f]=[],d=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?x[f][d]=!0:E==="FALSE"?x[f][d]=!1:isNaN(ws(b))?isNaN(Eu(b).getDate())?x[f][d]=b:x[f][d]=vr(b):x[f][d]=ws(b),++d;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),x[f][d++]=E!==""?E:null;break}if(E==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function r(i,o){return Lu(t(i,o),o)}function n(i,o){return no(r(i,o),o)}var a=(function(){var i=function(f,d,p,x,y){f.push(d),f.push(p+","+x),f.push('"'+y.replace(/"/g,'""')+'"')},o=function(f,d,p,x){f.push(d+","+p),f.push(d==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(f){var d=[],p=Lt(f["!ref"]),x,y=Array.isArray(f);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,p.e.r-p.s.r+1,""),i(d,"TUPLES",0,p.e.c-p.s.c+1,""),i(d,"DATA",0,0,"");for(var w=p.s.r;w<=p.e.r;++w){o(d,-1,0,"BOT");for(var b=p.s.c;b<=p.e.c;++b){var E=ot({r:w,c:b});if(x=y?(f[w]||[])[b]:f[E],!x){o(d,1,0,"");continue}switch(x.t){case"n":var T=x.w;!T&&x.v!=null&&(T=x.v),T==null?x.f&&!x.F?o(d,1,0,"="+x.f):o(d,1,0,""):o(d,0,T,"V");break;case"b":o(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=es(x.z||lt[14],fn(vr(x.v)))),o(d,0,x.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var I=`\r
`,R=d.join(I);return R}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),vN=(function(){function t(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,y){for(var w=x.split(`
`),b=-1,E=-1,T=0,I=[];T!==w.length;++T){var R=w[T].trim().split(":");if(R[0]==="cell"){var C=Sr(R[1]);if(I.length<=C.r)for(b=I.length;b<=C.r;++b)I[b]||(I[b]=[]);switch(b=C.r,E=C.c,R[2]){case"t":I[b][E]=t(R[3]);break;case"v":I[b][E]=+R[3];break;case"vtf":var z=R[R.length-1];case"vtc":switch(R[3]){case"nl":I[b][E]=!!+R[4];break;default:I[b][E]=+R[4];break}R[2]=="vtf"&&(I[b][E]=[I[b][E],z])}}}return y&&y.sheetRows&&(I=I.slice(0,y.sheetRows)),I}function n(x,y){return Lu(r(x,y),y)}function a(x,y){return no(n(x,y),y)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(x){if(!x||!x["!ref"])return"";for(var y=[],w=[],b,E="",T=da(x["!ref"]),I=Array.isArray(x),R=T.s.r;R<=T.e.r;++R)for(var C=T.s.c;C<=T.e.c;++C)if(E=ot({r:R,c:C}),b=I?(x[R]||[])[C]:x[E],!(!b||b.v==null||b.t==="z")){switch(w=["cell",E,"t"],b.t){case"s":case"str":w.push(e(b.v));break;case"n":b.f?(w[2]="vtf",w[3]="n",w[4]=b.v,w[5]=e(b.f)):(w[2]="v",w[3]=b.v);break;case"b":w[2]="vt"+(b.f?"f":"c"),w[3]="nl",w[4]=b.v?"1":"0",w[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var z=fn(vr(b.v));w[2]="vtc",w[3]="nd",w[4]=""+z,w[5]=b.w||es(b.z||lt[14],z);break;case"e":continue}y.push(w.join(":"))}return y.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function p(x){return[i,o,u,o,d(x),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:p}})(),Tu=(function(){function t(p,x,y,w,b){b.raw?x[y][w]=p:p===""||(p==="TRUE"?x[y][w]=!0:p==="FALSE"?x[y][w]=!1:isNaN(ws(p))?isNaN(Eu(p).getDate())?x[y][w]=p:x[y][w]=vr(p):x[y][w]=ws(p))}function e(p,x){var y=x||{},w=[];if(!p||p.length===0)return w;for(var b=p.split(/[\r\n]/),E=b.length-1;E>=0&&b[E].length===0;)--E;for(var T=10,I=0,R=0;R<=E;++R)I=b[R].indexOf(" "),I==-1?I=b[R].length:I++,T=Math.max(T,I);for(R=0;R<=E;++R){w[R]=[];var C=0;for(t(b[R].slice(0,T).trim(),w,R,C,y),C=1;C<=(b[R].length-T)/10+1;++C)t(b[R].slice(T+(C-1)*10,T+C*10).trim(),w,R,C,y)}return y.sheetRows&&(w=w.slice(0,y.sheetRows)),w}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(p){for(var x={},y=!1,w=0,b=0;w<p.length;++w)(b=p.charCodeAt(w))==34?y=!y:!y&&b in r&&(x[b]=(x[b]||0)+1);b=[];for(w in x)Object.prototype.hasOwnProperty.call(x,w)&&b.push([x[w],w]);if(!b.length){x=n;for(w in x)Object.prototype.hasOwnProperty.call(x,w)&&b.push([x[w],w])}return b.sort(function(E,T){return E[0]-T[0]||n[E[1]]-n[T[1]]}),r[b.pop()[1]]||44}function i(p,x){var y=x||{},w="",b=y.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(w=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(w=p.charAt(4),p=p.slice(6)):w=a(p.slice(0,1024)):y&&y.FS?w=y.FS:w=a(p.slice(0,1024));var T=0,I=0,R=0,C=0,z=0,H=w.charCodeAt(0),X=!1,A=0,F=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var N=y.dateNF!=null?S7(y.dateNF):null;function P(){var M=p.slice(C,z),j={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)j.t="z";else if(y.raw)j.t="s",j.v=M;else if(M.trim().length===0)j.t="s",j.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(j.t="s",j.v=M.slice(2,-1).replace(/""/g,'"')):eG(M)?(j.t="n",j.f=M.slice(1)):(j.t="s",j.v=M);else if(M=="TRUE")j.t="b",j.v=!0;else if(M=="FALSE")j.t="b",j.v=!1;else if(!isNaN(R=ws(M)))j.t="n",y.cellText!==!1&&(j.w=M),j.v=R;else if(!isNaN(Eu(M).getDate())||N&&M.match(N)){j.z=y.dateNF||lt[14];var B=0;N&&M.match(N)&&(M=A7(M,y.dateNF,M.match(N)||[]),B=1),y.cellDates?(j.t="d",j.v=vr(M,B)):(j.t="n",j.v=fn(vr(M,B))),y.cellText!==!1&&(j.w=es(j.z,j.v instanceof Date?fn(j.v):j.v)),y.cellNF||delete j.z}else j.t="s",j.v=M;if(j.t=="z"||(y.dense?(b[T]||(b[T]=[]),b[T][I]=j):b[ot({c:I,r:T})]=j),C=z+1,F=p.charCodeAt(C),E.e.c<I&&(E.e.c=I),E.e.r<T&&(E.e.r=T),A==H)++I;else if(I=0,++T,y.sheetRows&&y.sheetRows<=T)return!0}e:for(;z<p.length;++z)switch(A=p.charCodeAt(z)){case 34:F===34&&(X=!X);break;case H:case 10:case 13:if(!X&&P())break e;break}return z-C>0&&P(),b["!ref"]=_t(E),b}function o(p,x){return!(x&&x.PRN)||x.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?i(p,x):Lu(e(p,x),x)}function u(p,x){var y="",w=x.type=="string"?[0,0,0,0]:t_(p,x);switch(x.type){case"base64":y=Ia(p);break;case"binary":y=p;break;case"buffer":x.codepage==65001?y=p.toString("utf8"):x.codepage&&typeof _0<"u"||(y=Tt&&Buffer.isBuffer(p)?p.toString("binary"):ro(p));break;case"array":y=$o(p);break;case"string":y=p;break;default:throw new Error("Unrecognized type "+x.type)}return w[0]==239&&w[1]==187&&w[2]==191?y=lr(y.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?y=lr(y):x.type=="binary"&&typeof _0<"u",y.slice(0,19)=="socialcalc:version:"?vN.to_sheet(x.type=="string"?y:lr(y),x):o(y,x)}function f(p,x){return no(u(p,x),x)}function d(p){for(var x=[],y=Lt(p["!ref"]),w,b=Array.isArray(p),E=y.s.r;E<=y.e.r;++E){for(var T=[],I=y.s.c;I<=y.e.c;++I){var R=ot({r:E,c:I});if(w=b?(p[E]||[])[I]:p[R],!w||w.v==null){T.push("          ");continue}for(var C=(w.w||(ji(w),w.w)||"").slice(0,10);C.length<10;)C+=" ";T.push(C+(I===0?" ":""))}x.push(T.join(""))}return x.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:d}})();function VU(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=gN.to_workbook(t,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Tu.to_workbook(t,e)}}var Uo=(function(){function t(O,Y,q){if(O){Sn(O,O.l||0);for(var te=q.Enum||ye;O.l<O.length;){var ce=O.read_shift(2),Te=te[ce]||te[65535],Re=O.read_shift(2),_e=O.l+Re,ke=Te.f&&Te.f(O,Re,q);if(O.l=_e,Y(ke,Te,ce))return}}}function e(O,Y){switch(Y.type){case"base64":return r(ka(Ia(O)),Y);case"binary":return r(ka(O),Y);case"buffer":case"array":return r(O,Y)}throw"Unsupported type "+Y.type}function r(O,Y){if(!O)return O;var q=Y||{},te=q.dense?[]:{},ce="Sheet1",Te="",Re=0,_e={},ke=[],rt=[],L={s:{r:0,c:0},e:{r:0,c:0}},Xe=q.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)q.Enum=ye,t(O,function(je,ht,wt){switch(wt){case 0:q.vers=je,je>=4096&&(q.qpro=!0);break;case 6:L=je;break;case 204:je&&(Te=je);break;case 222:Te=je;break;case 15:case 51:q.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:wt==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=q.dateNF||lt[14],q.cellDates&&(je[1].t="d",je[1].v=kp(je[1].v))),q.qpro&&je[3]>Re&&(te["!ref"]=_t(L),_e[ce]=te,ke.push(ce),te=q.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},Re=je[3],ce=Te||"Sheet"+(Re+1),Te="");var Ft=q.dense?(te[je[0].r]||[])[je[0].c]:te[ot(je[0])];if(Ft){Ft.t=je[1].t,Ft.v=je[1].v,je[1].z!=null&&(Ft.z=je[1].z),je[1].f!=null&&(Ft.f=je[1].f);break}q.dense?(te[je[0].r]||(te[je[0].r]=[]),te[je[0].r][je[0].c]=je[1]):te[ot(je[0])]=je[1];break}},q);else if(O[2]==26||O[2]==14)q.Enum=Q,O[2]==14&&(q.qpro=!0,O.l=0),t(O,function(je,ht,wt){switch(wt){case 204:ce=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>Re&&(te["!ref"]=_t(L),_e[ce]=te,ke.push(ce),te=q.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},Re=je[3],ce="Sheet"+(Re+1)),Xe>0&&je[0].r>=Xe)break;q.dense?(te[je[0].r]||(te[je[0].r]=[]),te[je[0].r][je[0].c]=je[1]):te[ot(je[0])]=je[1],L.e.c<je[0].c&&(L.e.c=je[0].c),L.e.r<je[0].r&&(L.e.r=je[0].r);break;case 27:je[14e3]&&(rt[je[14e3][0]]=je[14e3][1]);break;case 1537:rt[je[0]]=je[1],je[0]==Re&&(ce=je[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(te["!ref"]=_t(L),_e[Te||ce]=te,ke.push(Te||ce),!rt.length)return{SheetNames:ke,Sheets:_e};for(var Pe={},et=[],We=0;We<rt.length;++We)_e[ke[We]]?(et.push(rt[We]||ke[We]),Pe[rt[We]]=_e[rt[We]]||_e[ke[We]]):(et.push(rt[We]),Pe[rt[We]]={"!ref":"A1"});return{SheetNames:et,Sheets:Pe}}function n(O,Y){var q=Y||{};if(+q.codepage>=0&&ys(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var te=ha(),ce=Lt(O["!ref"]),Te=Array.isArray(O),Re=[];ze(te,0,i(1030)),ze(te,6,f(ce));for(var _e=Math.min(ce.e.r,8191),ke=ce.s.r;ke<=_e;++ke)for(var rt=Ur(ke),L=ce.s.c;L<=ce.e.c;++L){ke===ce.s.r&&(Re[L]=Tr(L));var Xe=Re[L]+rt,Pe=Te?(O[ke]||[])[L]:O[Xe];if(!(!Pe||Pe.t=="z"))if(Pe.t=="n")(Pe.v|0)==Pe.v&&Pe.v>=-32768&&Pe.v<=32767?ze(te,13,w(ke,L,Pe.v)):ze(te,14,E(ke,L,Pe.v));else{var et=ji(Pe);ze(te,15,x(ke,L,et.slice(0,239)))}}return ze(te,1),te.end()}function a(O,Y){var q=Y||{};if(+q.codepage>=0&&ys(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var te=ha();ze(te,0,o(O));for(var ce=0,Te=0;ce<O.SheetNames.length;++ce)(O.Sheets[O.SheetNames[ce]]||{})["!ref"]&&ze(te,27,ne(O.SheetNames[ce],Te++));var Re=0;for(ce=0;ce<O.SheetNames.length;++ce){var _e=O.Sheets[O.SheetNames[ce]];if(!(!_e||!_e["!ref"])){for(var ke=Lt(_e["!ref"]),rt=Array.isArray(_e),L=[],Xe=Math.min(ke.e.r,8191),Pe=ke.s.r;Pe<=Xe;++Pe)for(var et=Ur(Pe),We=ke.s.c;We<=ke.e.c;++We){Pe===ke.s.r&&(L[We]=Tr(We));var je=L[We]+et,ht=rt?(_e[Pe]||[])[We]:_e[je];if(!(!ht||ht.t=="z"))if(ht.t=="n")ze(te,23,P(Pe,We,Re,ht.v));else{var wt=ji(ht);ze(te,22,A(Pe,We,Re,wt.slice(0,239)))}}++Re}}return ze(te,1),te.end()}function i(O){var Y=Ae(2);return Y.write_shift(2,O),Y}function o(O){var Y=Ae(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var q=0,te=0,ce=0,Te=0;Te<O.SheetNames.length;++Te){var Re=O.SheetNames[Te],_e=O.Sheets[Re];if(!(!_e||!_e["!ref"])){++ce;var ke=da(_e["!ref"]);q<ke.e.r&&(q=ke.e.r),te<ke.e.c&&(te=ke.e.c)}}return q>8191&&(q=8191),Y.write_shift(2,q),Y.write_shift(1,ce),Y.write_shift(1,te),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function u(O,Y,q){var te={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&q.qpro?(te.s.c=O.read_shift(1),O.l++,te.s.r=O.read_shift(2),te.e.c=O.read_shift(1),O.l++,te.e.r=O.read_shift(2),te):(te.s.c=O.read_shift(2),te.s.r=O.read_shift(2),Y==12&&q.qpro&&(O.l+=2),te.e.c=O.read_shift(2),te.e.r=O.read_shift(2),Y==12&&q.qpro&&(O.l+=2),te.s.c==65535&&(te.s.c=te.e.c=te.s.r=te.e.r=0),te)}function f(O){var Y=Ae(8);return Y.write_shift(2,O.s.c),Y.write_shift(2,O.s.r),Y.write_shift(2,O.e.c),Y.write_shift(2,O.e.r),Y}function d(O,Y,q){var te=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(te[0].c=O.read_shift(1),te[3]=O.read_shift(1),te[0].r=O.read_shift(2),O.l+=2):(te[2]=O.read_shift(1),te[0].c=O.read_shift(2),te[0].r=O.read_shift(2)),te}function p(O,Y,q){var te=O.l+Y,ce=d(O,Y,q);if(ce[1].t="s",q.vers==20768){O.l++;var Te=O.read_shift(1);return ce[1].v=O.read_shift(Te,"utf8"),ce}return q.qpro&&O.l++,ce[1].v=O.read_shift(te-O.l,"cstr"),ce}function x(O,Y,q){var te=Ae(7+q.length);te.write_shift(1,255),te.write_shift(2,Y),te.write_shift(2,O),te.write_shift(1,39);for(var ce=0;ce<te.length;++ce){var Te=q.charCodeAt(ce);te.write_shift(1,Te>=128?95:Te)}return te.write_shift(1,0),te}function y(O,Y,q){var te=d(O,Y,q);return te[1].v=O.read_shift(2,"i"),te}function w(O,Y,q){var te=Ae(7);return te.write_shift(1,255),te.write_shift(2,Y),te.write_shift(2,O),te.write_shift(2,q,"i"),te}function b(O,Y,q){var te=d(O,Y,q);return te[1].v=O.read_shift(8,"f"),te}function E(O,Y,q){var te=Ae(13);return te.write_shift(1,255),te.write_shift(2,Y),te.write_shift(2,O),te.write_shift(8,q,"f"),te}function T(O,Y,q){var te=O.l+Y,ce=d(O,Y,q);if(ce[1].v=O.read_shift(8,"f"),q.qpro)O.l=te;else{var Te=O.read_shift(2);z(O.slice(O.l,O.l+Te),ce),O.l+=Te}return ce}function I(O,Y,q){var te=Y&32768;return Y&=-32769,Y=(te?O:0)+(Y>=8192?Y-16384:Y),(te?"":"$")+(q?Tr(Y):Ur(Y))}var R={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(O,Y){Sn(O,0);for(var q=[],te=0,ce="",Te="",Re="",_e="";O.l<O.length;){var ke=O[O.l++];switch(ke){case 0:q.push(O.read_shift(8,"f"));break;case 1:Te=I(Y[0].c,O.read_shift(2),!0),ce=I(Y[0].r,O.read_shift(2),!1),q.push(Te+ce);break;case 2:{var rt=I(Y[0].c,O.read_shift(2),!0),L=I(Y[0].r,O.read_shift(2),!1);Te=I(Y[0].c,O.read_shift(2),!0),ce=I(Y[0].r,O.read_shift(2),!1),q.push(rt+L+":"+Te+ce)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(O.read_shift(2));break;case 6:{for(var Xe="";ke=O[O.l++];)Xe+=String.fromCharCode(ke);q.push('"'+Xe.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:_e=q.pop(),Re=q.pop(),q.push(["AND","OR"][ke-20]+"("+Re+","+_e+")");break;default:if(ke<32&&C[ke])_e=q.pop(),Re=q.pop(),q.push(Re+C[ke]+_e);else if(R[ke]){if(te=R[ke][1],te==69&&(te=O[O.l++]),te>q.length){console.error("WK1 bad formula parse 0x"+ke.toString(16)+":|"+q.join("|")+"|");return}var Pe=q.slice(-te);q.length-=te,q.push(R[ke][0]+"("+Pe.join(",")+")")}else return ke<=7?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=24?console.error("WK1 unsupported op "+ke.toString(16)):ke<=30?console.error("WK1 invalid opcode "+ke.toString(16)):ke<=115?console.error("WK1 unsupported function opcode "+ke.toString(16)):console.error("WK1 unrecognized opcode "+ke.toString(16))}}q.length==1?Y[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function H(O){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=O.read_shift(2),Y[3]=O[O.l++],Y[0].c=O[O.l++],Y}function X(O,Y){var q=H(O);return q[1].t="s",q[1].v=O.read_shift(Y-4,"cstr"),q}function A(O,Y,q,te){var ce=Ae(6+te.length);ce.write_shift(2,O),ce.write_shift(1,q),ce.write_shift(1,Y),ce.write_shift(1,39);for(var Te=0;Te<te.length;++Te){var Re=te.charCodeAt(Te);ce.write_shift(1,Re>=128?95:Re)}return ce.write_shift(1,0),ce}function F(O,Y){var q=H(O);q[1].v=O.read_shift(2);var te=q[1].v>>1;if(q[1].v&1)switch(te&7){case 0:te=(te>>3)*5e3;break;case 1:te=(te>>3)*500;break;case 2:te=(te>>3)/20;break;case 3:te=(te>>3)/200;break;case 4:te=(te>>3)/2e3;break;case 5:te=(te>>3)/2e4;break;case 6:te=(te>>3)/16;break;case 7:te=(te>>3)/64;break}return q[1].v=te,q}function N(O,Y){var q=H(O),te=O.read_shift(4),ce=O.read_shift(4),Te=O.read_shift(2);if(Te==65535)return te===0&&ce===3221225472?(q[1].t="e",q[1].v=15):te===0&&ce===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Re=Te&32768;return Te=(Te&32767)-16446,q[1].v=(1-Re*2)*(ce*Math.pow(2,Te+32)+te*Math.pow(2,Te)),q}function P(O,Y,q,te){var ce=Ae(14);if(ce.write_shift(2,O),ce.write_shift(1,q),ce.write_shift(1,Y),te==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var Te=0,Re=0,_e=0,ke=0;return te<0&&(Te=1,te=-te),Re=Math.log2(te)|0,te/=Math.pow(2,Re-31),ke=te>>>0,(ke&2147483648)==0&&(te/=2,++Re,ke=te>>>0),te-=ke,ke|=2147483648,ke>>>=0,te*=Math.pow(2,32),_e=te>>>0,ce.write_shift(4,_e),ce.write_shift(4,ke),Re+=16383+(Te?32768:0),ce.write_shift(2,Re),ce}function M(O,Y){var q=N(O);return O.l+=Y-14,q}function j(O,Y){var q=H(O),te=O.read_shift(4);return q[1].v=te>>6,q}function B(O,Y){var q=H(O),te=O.read_shift(8,"f");return q[1].v=te,q}function Se(O,Y){var q=B(O);return O.l+=Y-10,q}function we(O,Y){return O[O.l+Y-1]==0?O.read_shift(Y,"cstr"):""}function se(O,Y){var q=O[O.l++];q>Y-1&&(q=Y-1);for(var te="";te.length<q;)te+=String.fromCharCode(O[O.l++]);return te}function oe(O,Y,q){if(!(!q.qpro||Y<21)){var te=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var ce=O.read_shift(Y-21,"cstr");return[te,ce]}}function le(O,Y){for(var q={},te=O.l+Y;O.l<te;){var ce=O.read_shift(2);if(ce==14e3){for(q[ce]=[0,""],q[ce][0]=O.read_shift(2);O[O.l];)q[ce][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return q}function ne(O,Y){var q=Ae(5+O.length);q.write_shift(2,14e3),q.write_shift(2,Y);for(var te=0;te<O.length;++te){var ce=O.charCodeAt(te);q[q.l++]=ce>127?95:ce}return q[q.l++]=0,q}var ye={0:{n:"BOF",f:en},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:X},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:Se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}})();function UU(t){var e={},r=t.match(Hn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=ut(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=vy[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return e}var zU=(function(){var t=E0("t"),e=E0("rPr");function r(i){var o=i.match(t);if(!o)return{t:"s",v:""};var u={t:"s",v:jt(o[1])},f=i.match(e);return f&&(u.s=UU(f[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(u){return u.v})}})(),HU=(function(){var e=/(\r\n|\n)/g;function r(a,i,o){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),i.push('<span style="'+u.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),o.push("</"+f+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),GU=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,qU=/<(?:\w+:)?r>/,WU=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function zy(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=jt(lr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=lr(t),r&&(n.h=Cy(n.t))):t.match(qU)&&(n.r=lr(t),n.t=jt(lr((t.replace(WU,"").match(GU)||[]).join("").replace(Hn,""))),r&&(n.h=HU(zU(n.r)))),n):{t:""}}var XU=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,YU=/<(?:\w+:)?(?:si|sstItem)>/g,$U=/<\/(?:\w+:)?(?:si|sstItem)>/;function KU(t,e){var r=[],n="";if(!t)return r;var a=t.match(XU);if(a){n=a[2].replace(YU,"").split($U);for(var i=0;i!=n.length;++i){var o=zy(n[i].trim(),e);o!=null&&(r[r.length]=o)}a=ut(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var QU=/^\s|\s$|[\t\n\r]/;function yN(t,e){if(!e.bookSST)return"";var r=[zr];r[r.length]=Ue("sst",null,{xmlns:nc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(QU)&&(i+=' xml:space="preserve"'),i+=">"+tr(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function JU(t){return[t.read_shift(4),t.read_shift(4)]}function ZU(t,e){var r=[],n=!1;return Vi(t,function(i,o,u){switch(u){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function ez(t,e){return e||(e=Ae(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var tz=fB;function rz(t){var e=ha();Me(e,159,ez(t));for(var r=0;r<t.length;++r)Me(e,19,tz(t[r]));return Me(e,160),e.end()}function _N(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ri(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function nz(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ri(t,4),e.U=Ri(t,4),e.W=Ri(t,4),e}function az(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),i=[];a-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function sz(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(az(t));return e}function iz(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function lz(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ri(t,4),e.U=Ri(t,4),e.W=Ri(t,4),e}function oz(t){var e=lz(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function wN(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function bN(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function cz(t){var e=Ri(t);switch(e.Minor){case 2:return[e.Minor,uz(t)];case 3:return[e.Minor,fz()];case 4:return[e.Minor,hz(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function uz(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=wN(t,r),a=bN(t,t.length-t.l);return{t:"Std",h:n,v:a}}function fz(){throw new Error("File is password-protected: ECMA-376 Extensible")}function hz(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Hn,function(i){var o=ut(i);switch(Ks(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function dz(t,e){var r={},n=r.EncryptionVersionInfo=Ri(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=wN(t,a),e-=a,r.EncryptionVerifier=bN(t,e),r}function mz(t){var e={},r=e.EncryptionVersionInfo=Ri(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Hy(t){var e=0,r,n=_N(t),a=n.length+1,i,o,u,f,d;for(r=Xl(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],u=(e&16384)===0?0:1,f=e<<1&32767,d=u|f,e=d^o;return e^52811}var EN=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,u){return n(o^u)},i=function(o){for(var u=e[o.length-1],f=104,d=o.length-1;d>=0;--d)for(var p=o[d],x=0;x!=7;++x)p&64&&(u^=r[f]),p*=2,--f;return u};return function(o){for(var u=_N(o),f=i(u),d=u.length,p=Xl(16),x=0;x!=16;++x)p[x]=0;var y,w,b;for((d&1)===1&&(y=f>>8,p[d]=a(t[0],y),--d,y=f&255,w=u[u.length-1],p[d]=a(w,y));d>0;)--d,y=f>>8,p[d]=a(u[d],y),--d,y=f&255,p[d]=a(u[d],y);for(d=15,b=15-u.length;b>0;)y=f>>8,p[d]=a(t[b],y),--d,--b,y=f&255,p[d]=a(u[d],y),--d,--b;return p}})(),pz=function(t,e,r,n,a){a||(a=e),n||(n=EN(t));var i,o;for(i=0;i!=e.length;++i)o=e[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},gz=function(t){var e=0,r=EN(t);return function(n){var a=pz("",n,e,r);return e=a[1],a[0]}};function xz(t,e,r,n){var a={key:en(t),verificationBytes:en(t)};return r.password&&(a.verifier=Hy(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=gz(r.password)),a}function vz(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=mz(t):n.Data=dz(t,e),n}function yz(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?vz(t,e-2,n):xz(t,r.biff>=8?e:e-2,r,n),n}var TN=(function(){function t(a,i){switch(i.type){case"base64":return e(Ia(a),i);case"binary":return e(a,i);case"buffer":return e(Tt&&Buffer.isBuffer(a)?a.toString("binary"):ro(a),i);case"array":return e($o(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){var o=i||{},u=o.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,x){Array.isArray(u)&&(u[x]=[]);for(var y=/\\\w+\b/g,w=0,b,E=-1;b=y.exec(p);){switch(b[0]){case"\\cell":var T=p.slice(w,y.lastIndex-b[0].length);if(T[0]==" "&&(T=T.slice(1)),++E,T.length){var I={v:T,t:"s"};Array.isArray(u)?u[x][E]=I:u[ot({r:x,c:E})]=I}break}w=y.lastIndex}E>d.e.c&&(d.e.c=E)}),u["!ref"]=_t(d),u}function r(a,i){return no(t(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=Lt(a["!ref"]),u,f=Array.isArray(a),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)i.push("\\cellx"+(p+1));for(i.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var x=ot({r:d,c:p});u=f?(a[d]||[])[p]:a[x],!(!u||u.v==null&&(!u.f||u.F))&&(i.push(" "+(u.w||(ji(u),u.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function _z(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function k0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function wz(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),i=Math.min(e,r,n),o=a-i;if(o===0)return[0,0,e];var u=0,f=0,d=a+i;switch(f=o/(d>1?2-d:d),a){case e:u=((r-n)/o+6)%6;break;case r:u=(n-e)/o+2;break;case n:u=(e-r)/o+4;break}return[u/6,f,d/2]}function bz(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],u=6*e,f;if(r!==0)switch(u|0){case 0:case 6:f=a*u,o[0]+=a,o[1]+=f;break;case 1:f=a*(2-u),o[0]+=f,o[1]+=a;break;case 2:f=a*(u-2),o[1]+=a,o[2]+=f;break;case 3:f=a*(4-u),o[1]+=f,o[2]+=a;break;case 4:f=a*(u-4),o[2]+=a,o[0]+=f;break;case 5:f=a*(6-u),o[2]+=f,o[0]+=a;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function qm(t,e){if(e===0)return t;var r=wz(_z(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),k0(bz(r))}var SN=6,Ez=15,Tz=1,Ln=SN;function C0(t){return Math.floor((t+Math.round(128/Ln)/256)*Ln)}function N0(t){return Math.floor((t-5)/Ln*100+.5)/100}function Wm(t){return Math.round((t*Ln+5)/Ln*256)/256}function tx(t){return Wm(N0(C0(t)))}function Gy(t){var e=Math.abs(t-tx(t)),r=Ln;if(e>.005)for(Ln=Tz;Ln<Ez;++Ln)Math.abs(t-tx(t))<=e&&(e=Math.abs(t-tx(t)),r=Ln);Ln=r}function Yl(t){t.width?(t.wpx=C0(t.width),t.wch=N0(t.wpx),t.MDW=Ln):t.wpx?(t.wch=N0(t.wpx),t.width=Wm(t.wch),t.MDW=Ln):typeof t.wch=="number"&&(t.width=Wm(t.wch),t.wpx=C0(t.width),t.MDW=Ln),t.customWidth&&delete t.customWidth}var Sz=96,AN=Sz;function R0(t){return t*96/AN}function Su(t){return t*AN/96}var Az={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function kz(t,e,r,n){e.Borders=[];var a={},i=!1;(t[0].match(Hn)||[]).forEach(function(o){var u=ut(o);switch(Ks(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=gr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=gr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in borders")}})}function Cz(t,e,r,n){e.Fills=[];var a={},i=!1;(t[0].match(Hn)||[]).forEach(function(o){var u=ut(o);switch(Ks(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fills")}})}function Nz(t,e,r,n){e.Fonts=[];var a={},i=!1;(t[0].match(Hn)||[]).forEach(function(o){var u=ut(o);switch(Ks(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=lr(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?gr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?gr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?gr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?gr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?gr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?gr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?gr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=vy[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=gr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var f=Bo[a.color.index];a.color.index==81&&(f=Bo[1]),f||(f=Bo[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=qm(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fonts")}})}function Rz(t,e,r){e.NumberFmt=[];for(var n=Or(lt),a=0;a<n.length;++a)e.NumberFmt[n[a]]=lt[n[a]];var i=t[0].match(Hn);if(i)for(a=0;a<i.length;++a){var o=ut(i[a]);switch(Ks(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=jt(lr(o.formatCode)),f=parseInt(o.numFmtId,10);if(e.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=u}Ni(u,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Iz(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ue("numFmt",null,{numFmtId:n,formatCode:tr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ue("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Wd=["numFmtId","fillId","fontId","borderId","xfId"],Xd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Dz(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(Hn)||[]).forEach(function(i){var o=ut(i),u=0;switch(Ks(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<Wd.length;++u)n[Wd[u]]&&(n[Wd[u]]=parseInt(n[Wd[u]],10));for(u=0;u<Xd.length;++u)n[Xd[u]]&&(n[Xd[u]]=gr(n[Xd[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};o.vertical&&(f.vertical=o.vertical),o.horizontal&&(f.horizontal=o.horizontal),o.textRotation!=null&&(f.textRotation=o.textRotation),o.indent&&(f.indent=o.indent),o.wrapText&&(f.wrapText=gr(o.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Oz(t){var e=[];return e[e.length]=Ue("cellXfs",null),t.forEach(function(r){e[e.length]=Ue("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ue("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Fz=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,d){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(e))&&Rz(x,p,d),(x=u.match(a))&&Nz(x,p,f,d),(x=u.match(n))&&Cz(x,p,f,d),(x=u.match(i))&&kz(x,p,f,d),(x=u.match(r))&&Dz(x,p,d),p}})();function kN(t,e){var r=[zr,Ue("styleSheet",null,{xmlns:nc[0],"xmlns:vt":on.vt})],n;return t.SSF&&(n=Iz(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Oz(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Mz(t,e){var r=t.read_shift(2),n=Vn(t);return[r,n]}function Pz(t,e,r){r||(r=Ae(6+4*e.length)),r.write_shift(2,t),xn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function jz(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=vB(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var u=t.read_shift(1);u>0&&(n.family=u);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=xB(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Vn(t),n}function Lz(t,e){e||(e=Ae(153)),e.write_shift(2,t.sz*20),yB(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),zm(t.color,e);var n=0;return n=2,e.write_shift(1,n),xn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Bz=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rx,Vz=zn;function wS(t,e){e||(e=Ae(84)),rx||(rx=Sp(Bz));var r=rx[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(zm({auto:1},e),zm({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Uz(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function CN(t,e,r){r||(r=Ae(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Bf(t,e){return e||(e=Ae(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var zz=zn;function Hz(t,e){return e||(e=Ae(51)),e.write_shift(1,0),Bf(null,e),Bf(null,e),Bf(null,e),Bf(null,e),Bf(null,e),e.length>e.l?e.slice(0,e.l):e}function Gz(t,e){return e||(e=Ae(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Um(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function qz(t,e,r){var n=Ae(2052);return n.write_shift(4,t),Um(e,n),Um(r,n),n.length>n.l?n.slice(0,n.l):n}function Wz(t,e,r){var n={};n.NumberFmt=[];for(var a in lt)n.NumberFmt[a]=lt[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Vi(t,function(f,d,p){switch(p){case 44:n.NumberFmt[f[0]]=f[1],Ni(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=qm(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(p),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(p);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}function Xz(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Me(t,615,bs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Me(t,44,Pz(a,e[a]))}),Me(t,616))}}function Yz(t){var e=1;Me(t,611,bs(e)),Me(t,43,Lz({sz:12,color:{theme:1},name:"Calibri",family:2})),Me(t,612)}function $z(t){var e=2;Me(t,603,bs(e)),Me(t,45,wS({patternType:"none"})),Me(t,45,wS({patternType:"gray125"})),Me(t,604)}function Kz(t){var e=1;Me(t,613,bs(e)),Me(t,46,Hz()),Me(t,614)}function Qz(t){var e=1;Me(t,626,bs(e)),Me(t,47,CN({numFmtId:0},65535)),Me(t,627)}function Jz(t,e){Me(t,617,bs(e.length)),e.forEach(function(r){Me(t,47,CN(r,0))}),Me(t,618)}function Zz(t){var e=1;Me(t,619,bs(e)),Me(t,48,Gz({xfId:0,name:"Normal"})),Me(t,620)}function eH(t){var e=0;Me(t,505,bs(e)),Me(t,506)}function tH(t){var e=0;Me(t,508,qz(e,"TableStyleMedium9","PivotStyleMedium4")),Me(t,509)}function rH(t,e){var r=ha();return Me(r,278),Xz(r,t.SSF),Yz(r),$z(r),Kz(r),Qz(r),Jz(r,e.cellXfs),Zz(r),eH(r),tH(r),Me(r,279),r.end()}var nH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function aH(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Hn)||[]).forEach(function(a){var i=ut(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[nH.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function sH(){}function iH(){}var lH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,oH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,cH=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function uH(t,e,r){e.themeElements={};var n;[["clrScheme",lH,aH],["fontScheme",oH,sH],["fmtScheme",cH,iH]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var fH=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function NN(t,e){(!t||t.length===0)&&(t=qy());var r,n={};if(!(r=t.match(fH)))throw new Error("themeElements not found in theme");return uH(r[0],n,e),n.raw=t,n}function qy(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[zr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function hH(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var o;try{o=wC(i,{type:"array"})}catch{return}var u=Ca(o,"theme/theme/theme1.xml",!0);if(u)return NN(u,r)}}function dH(t){return t.read_shift(4)}function mH(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=pH(t,4);break;case 2:e.xclrValue=oN(t);break;case 3:e.xclrValue=dH(t);break;case 4:t.l+=4;break}return t.l+=8,e}function pH(t,e){return zn(t,e)}function gH(t,e){return zn(t,e)}function xH(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=mH(t);break;case 6:n[1]=gH(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function vH(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),i=[];a-- >0;)i.push(xH(t,r-t.l));return{ixfe:n,ext:i}}function yH(t,e){e.forEach(function(r){r[0]})}function _H(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Vn(t)}}function wH(t){var e=Ae(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),xn(t.name,e),e.slice(0,e.l)}function bH(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function EH(t){var e=Ae(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function TH(t,e){var r=Ae(8+2*e.length);return r.write_shift(4,t),xn(e,r),r.slice(0,r.l)}function SH(t){return t.l+=4,t.read_shift(4)!=0}function AH(t,e){var r=Ae(8);return r.write_shift(4,t),r.write_shift(4,1),r}function kH(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,u=2;return Vi(t,function(f,d,p){switch(p){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(x){u==1?n.Cell.push({type:n.Types[x[0]-1].name,index:x[1]}):u==0&&n.Value.push({type:n.Types[x[0]-1].name,index:x[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:i.push(p),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function CH(){var t=ha();return Me(t,332),Me(t,334,bs(1)),Me(t,335,wH({name:"XLDAPR",version:12e4,flags:3496657072})),Me(t,336),Me(t,339,TH(1,"XLDAPR")),Me(t,52),Me(t,35,bs(514)),Me(t,4096,bs(0)),Me(t,4097,Ka(1)),Me(t,36),Me(t,53),Me(t,340),Me(t,337,AH(1)),Me(t,51,EH([[1,0]])),Me(t,338),Me(t,333),t.end()}function NH(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,i=2,o;return t.replace(Hn,function(u){var f=ut(u);switch(Ks(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):i==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function RN(){var t=[zr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function RH(t){var e=[];if(!t)return e;var r=1;return(t.match(Hn)||[]).forEach(function(n){var a=ut(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function IH(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ot(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function DH(t,e,r){var n=[];return Vi(t,function(i,o,u){switch(u){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function OH(t,e,r,n){if(!t)return t;var a=n||{},i=!1;Vi(t,function(u,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function FH(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var nu=1024;function IN(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ue("xml",null,{"xmlns:v":Sa.v,"xmlns:o":Sa.o,"xmlns:x":Sa.x,"xmlns:mv":Sa.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];nu<t*1e3;)nu+=1e3;return e.forEach(function(i){var o=Sr(i[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Ue("v:fill",f,u),p={on:"t",obscured:"t"};++nu,a=a.concat(["<v:shape"+T0({id:"_x0000_s"+nu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Ue("v:shadow",null,p),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",kn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),kn("x:AutoFill","False"),kn("x:Row",String(o.r)),kn("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function bS(t,e,r,n){var a=Array.isArray(t),i;e.forEach(function(o){var u=Sr(o.ref);if(a?(t[u.r]||(t[u.r]=[]),i=t[u.r][u.c]):i=t[o.ref],!i){i={t:"z"},a?t[u.r][u.c]=i:t[o.ref]=i;var f=Lt(t["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var d=_t(f);d!==t["!ref"]&&(t["!ref"]=d)}i.c||(i.c=[]);var p={a:o.author,t:o.t,r:o.r,T:r};o.h&&(p.h=o.h);for(var x=i.c.length-1;x>=0;--x){if(!r&&i.c[x].T)return;r&&!i.c[x].T&&i.c.splice(x,1)}if(r&&n){for(x=0;x<n.length;++x)if(p.a==n[x].id){p.a=n[x].name||p.a;break}}i.c.push(p)})}function MH(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=ut(u[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},p=Sr(f.ref);if(!(e.sheetRows&&e.sheetRows<=p.r)){var x=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!x&&!!x[1]&&zy(x[1])||{r:"",t:"",h:""};d.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),d.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=y.h),n.push(d)}}}}),n}function DN(t){var e=[zr,Ue("comments",null,{xmlns:nc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var i=tr(a.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(tr(f.a))),i.push(f.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)e.push(kn("t",tr(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,u=1;u<i.length;++u)o+=`Reply:
    `+i[u]+`
`;e.push(kn("t",tr(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function PH(t,e){var r=[],n=!1,a={},i=0;return t.replace(Hn,function(u,f){var d=ut(u);switch(Ks(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=f+u.length;break;case"</text>":a.t=t.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function jH(t,e,r){var n=[zr,Ue("ThreadedComments",null,{xmlns:on.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?i=f.id:f.parentId=i,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Ue("threadedComment",kn("text",o.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function LH(t,e){var r=[],n=!1;return t.replace(Hn,function(i){var o=ut(i);switch(Ks(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function BH(t){var e=[zr,Ue("personList",null,{xmlns:on.TCMNT,"xmlns:x":nc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ue("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function VH(t){var e={};e.iauthor=t.read_shift(4);var r=lc(t);return e.rfx=r.s,e.ref=ot(r.s),t.l+=16,e}function UH(t,e){return e==null&&(e=Ae(36)),e.write_shift(4,t[1].iauthor),Bu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var zH=Vn;function HH(t){return xn(t.slice(0,54))}function GH(t,e){var r=[],n=[],a={},i=!1;return Vi(t,function(u,f,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function qH(t){var e=ha(),r=[];return Me(e,628),Me(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Me(e,632,HH(a.a)))})}),Me(e,631),Me(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Sr(n[0]),e:Sr(n[0])};Me(e,635,UH([i,a])),a.t&&a.t.length>0&&Me(e,637,dB(a)),Me(e,636),delete a.iauthor})}),Me(e,634),Me(e,629),e.end()}var WH="application/vnd.ms-office.vbaProject";function XH(t){var e=at.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");at.utils.cfb_add(e,a,t.FileIndex[n].content)}}),at.write(e)}function YH(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&at.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var ON=["xlsb","xlsm","xlam","biff8","xla"];function $H(){return{"!type":"dialog"}}function KH(){return{"!type":"dialog"}}function QH(){return{"!type":"macro"}}function JH(){return{"!type":"macro"}}var fu=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,i,o){var u=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return u?p+=e.c:--p,f?d+=e.r:--d,a+(u?"":"$")+Tr(p)+(f?"":"$")+Ur(d)}return function(a,i){return e=i,a.replace(t,r)}})(),Wy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Xy=(function(){return function(e,r){return e.replace(Wy,function(n,a,i,o,u,f){var d=Oy(o)-(i?0:r.c),p=Dy(f)-(u?0:r.r),x=p==0?"":u?p+1:"["+p+"]",y=d==0?"":i?d+1:"["+d+"]";return a+"R"+x+"C"+y})}})();function FN(t,e){return t.replace(Wy,function(r,n,a,i,o,u){return n+(a=="$"?a+i:Tr(Oy(i)+e.c))+(o=="$"?o+u:Ur(Dy(u)+e.r))})}function ZH(t,e,r){var n=da(e),a=n.s,i=Sr(r),o={r:i.r-a.r,c:i.c-a.c};return FN(t,o)}function eG(t){return t.length!=1}function ES(t){return t.replace(/_xlfn\./g,"")}function Qr(t){t.l+=1}function $l(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function MN(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return PN(t);r.biff==12&&(n=4)}var a=t.read_shift(n),i=t.read_shift(n),o=$l(t),u=$l(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function PN(t){var e=$l(t),r=$l(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function tG(t,e,r){if(r.biff<8)return PN(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),i=$l(t),o=$l(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function jN(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return rG(t);var n=t.read_shift(r&&r.biff==12?4:2),a=$l(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function rG(t){var e=$l(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function nG(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function aG(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return sG(t);var a=t.read_shift(n>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,u=(i&32768)>>15;if(i&=16383,u==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:u}}function sG(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function iG(t,e,r){var n=(t[t.l++]&96)>>5,a=MN(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function lG(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=MN(t,i,r);return[n,a,o]}function oG(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function cG(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,a]}function uG(t,e,r){var n=(t[t.l++]&96)>>5,a=tG(t,e-1,r);return[n,a]}function fG(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function TS(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function hG(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function dG(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function mG(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function pG(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function gG(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function LN(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function xG(t){return t.read_shift(2),LN(t)}function vG(t){return t.read_shift(2),LN(t)}function yG(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=jN(t,0,r);return[n,a]}function _G(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=aG(t,0,r);return[n,a]}function wG(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=jN(t,0,r);return[n,a,i]}function bG(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[Sq[a],UN[a],n]}function EG(t,e,r){var n=t[t.l++],a=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:TG(t);return[a,(i[0]===0?UN:Tq)[i[1]]]}function TG(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function SG(t,e,r){t.l+=r&&r.biff==2?3:4}function AG(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function kG(t){return t.l++,Ui[t.read_shift(1)]}function CG(t){return t.l++,t.read_shift(2)}function NG(t){return t.l++,t.read_shift(1)!==0}function RG(t){return t.l++,Bn(t)}function IG(t,e,r){return t.l++,ah(t,e-1,r)}function DG(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Lr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ui[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Bn(t);break;case 2:r[1]=oc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function OG(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?lc:Cp)(t));return a}function FG(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var u=0;u!=a;++u)o[i][u]=DG(t,r.biff);return o}function MG(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function PG(t,e,r){if(r.biff==5)return jG(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[n,a,i]}function jG(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function LG(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function BG(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function VG(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function UG(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,a]}var zG=zn,HG=zn,GG=zn;function ih(t,e,r){return t.l+=2,[nG(t)]}function Yy(t){return t.l+=6,[]}var qG=ih,WG=Yy,XG=Yy,YG=ih;function BN(t){return t.l+=2,[en(t),t.read_shift(2)&1]}var $G=ih,KG=BN,QG=Yy,JG=ih,ZG=ih,eq=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function tq(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),o=eq[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:a,C:i}}function rq(t){return t.l+=2,[t.read_shift(4)]}function nq(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function aq(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function sq(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function iq(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function lq(t){return t.l+=4,[0,0]}var SS={1:{n:"PtgExp",f:AG},2:{n:"PtgTbl",f:GG},3:{n:"PtgAdd",f:Qr},4:{n:"PtgSub",f:Qr},5:{n:"PtgMul",f:Qr},6:{n:"PtgDiv",f:Qr},7:{n:"PtgPower",f:Qr},8:{n:"PtgConcat",f:Qr},9:{n:"PtgLt",f:Qr},10:{n:"PtgLe",f:Qr},11:{n:"PtgEq",f:Qr},12:{n:"PtgGe",f:Qr},13:{n:"PtgGt",f:Qr},14:{n:"PtgNe",f:Qr},15:{n:"PtgIsect",f:Qr},16:{n:"PtgUnion",f:Qr},17:{n:"PtgRange",f:Qr},18:{n:"PtgUplus",f:Qr},19:{n:"PtgUminus",f:Qr},20:{n:"PtgPercent",f:Qr},21:{n:"PtgParen",f:Qr},22:{n:"PtgMissArg",f:Qr},23:{n:"PtgStr",f:IG},26:{n:"PtgSheet",f:nq},27:{n:"PtgEndSheet",f:aq},28:{n:"PtgErr",f:kG},29:{n:"PtgBool",f:NG},30:{n:"PtgInt",f:CG},31:{n:"PtgNum",f:RG},32:{n:"PtgArray",f:fG},33:{n:"PtgFunc",f:bG},34:{n:"PtgFuncVar",f:EG},35:{n:"PtgName",f:MG},36:{n:"PtgRef",f:yG},37:{n:"PtgArea",f:iG},38:{n:"PtgMemArea",f:LG},39:{n:"PtgMemErr",f:zG},40:{n:"PtgMemNoMem",f:HG},41:{n:"PtgMemFunc",f:BG},42:{n:"PtgRefErr",f:VG},43:{n:"PtgAreaErr",f:oG},44:{n:"PtgRefN",f:_G},45:{n:"PtgAreaN",f:uG},46:{n:"PtgMemAreaN",f:sq},47:{n:"PtgMemNoMemN",f:iq},57:{n:"PtgNameX",f:PG},58:{n:"PtgRef3d",f:wG},59:{n:"PtgArea3d",f:lG},60:{n:"PtgRefErr3d",f:UG},61:{n:"PtgAreaErr3d",f:cG},255:{}},oq={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},cq={1:{n:"PtgElfLel",f:BN},2:{n:"PtgElfRw",f:JG},3:{n:"PtgElfCol",f:qG},6:{n:"PtgElfRwV",f:ZG},7:{n:"PtgElfColV",f:YG},10:{n:"PtgElfRadical",f:$G},11:{n:"PtgElfRadicalS",f:QG},13:{n:"PtgElfColS",f:WG},15:{n:"PtgElfColSV",f:XG},16:{n:"PtgElfRadicalLel",f:KG},25:{n:"PtgList",f:tq},29:{n:"PtgSxName",f:rq},255:{}},uq={0:{n:"PtgAttrNoop",f:lq},1:{n:"PtgAttrSemi",f:gG},2:{n:"PtgAttrIf",f:mG},4:{n:"PtgAttrChoose",f:hG},8:{n:"PtgAttrGoto",f:dG},16:{n:"PtgAttrSum",f:SG},32:{n:"PtgAttrBaxcel",f:TS},33:{n:"PtgAttrBaxcel",f:TS},64:{n:"PtgAttrSpace",f:xG},65:{n:"PtgAttrSpaceSemi",f:vG},128:{n:"PtgAttrIfError",f:pG},255:{}};function lh(t,e,r,n){if(n.biff<8)return zn(t,e);for(var a=t.l+e,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=FG(t,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=OG(t,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=a-t.l,e!==0&&i.push(zn(t,e)),i}function oh(t,e,r){for(var n=t.l+e,a,i,o=[];n!=t.l;)e=n-t.l,i=t[t.l],a=SS[i]||SS[oq[i]],(i===24||i===25)&&(a=(i===24?cq:uq)[t[t.l+1]]),!a||!a.f?zn(t,e):o.push([a.n,a.f(t,e,r)]);return o}function fq(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var hq={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dq(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function VN(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function AS(t,e,r){var n=VN(t,e,r);return n=="#REF"?n:dq(n,r)}function Pn(t,e,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},u=[],f,d,p,x=0,y=0,w,b="";if(!t[0]||!t[0][0])return"";for(var E=-1,T="",I=0,R=t[0].length;I<R;++I){var C=t[0][I];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),d=u.pop(),E>=0){switch(t[0][E][1][0]){case 0:T=Rr(" ",t[0][E][1][1]);break;case 1:T=Rr("\r",t[0][E][1][1]);break;default:if(T="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}d=d+T,E=-1}u.push(d+hq[C[0]]+f);break;case"PtgIsect":f=u.pop(),d=u.pop(),u.push(d+" "+f);break;case"PtgUnion":f=u.pop(),d=u.pop(),u.push(d+","+f);break;case"PtgRange":f=u.pop(),d=u.pop(),u.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=r0(C[1][1],o,a),u.push(n0(p,i));break;case"PtgRefN":p=r?r0(C[1][1],r,a):C[1][1],u.push(n0(p,i));break;case"PtgRef3d":x=C[1][1],p=r0(C[1][2],o,a),b=AS(n,x,a),u.push(b+"!"+n0(p,i));break;case"PtgFunc":case"PtgFuncVar":var z=C[1][0],H=C[1][1];z||(z=0),z&=127;var X=z==0?[]:u.slice(-z);u.length-=z,H==="User"&&(H=X.shift()),u.push(H+"("+X.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":w=tS(C[1][1],r?{s:r}:o,a),u.push(J1(w,a));break;case"PtgArea":w=tS(C[1][1],o,a),u.push(J1(w,a));break;case"PtgArea3d":x=C[1][1],w=C[1][2],b=AS(n,x,a),u.push(b+"!"+J1(w,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=C[1][2];var A=(n.names||[])[y-1]||(n[0]||[])[y],F=A?A.Name:"SH33TJSNAME"+String(y);F&&F.slice(0,6)=="_xlfn."&&!a.xlfn&&(F=F.slice(6)),u.push(F);break;case"PtgNameX":var N=C[1][1];y=C[1][2];var P;if(a.biff<=5)N<0&&(N=-N),n[N]&&(P=n[N][y]);else{var M="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][y]&&n[N][y].itab>0&&(M=n.SheetNames[n[N][y].itab-1]+"!"):M=n.SheetNames[y-1]+"!"),n[N]&&n[N][y])M+=n[N][y].Name;else if(n[0]&&n[0][y])M+=n[0][y].Name;else{var j=(VN(n,N,a)||"").split(";;");j[y-1]?M=j[y-1]:M+="SH33TJSERRX"}u.push(M);break}P||(P={Name:"SH33TJSERRY"}),u.push(P.Name);break;case"PtgParen":var B="(",Se=")";if(E>=0){switch(T="",t[0][E][1][0]){case 2:B=Rr(" ",t[0][E][1][1])+B;break;case 3:B=Rr("\r",t[0][E][1][1])+B;break;case 4:Se=Rr(" ",t[0][E][1][1])+Se;break;case 5:Se=Rr("\r",t[0][E][1][1])+Se;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}E=-1}u.push(B+u.pop()+Se);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var we={c:r.c,r:r.r};if(n.sharedf[ot(p)]){var se=n.sharedf[ot(p)];u.push(Pn(se,o,we,n,a))}else{var oe=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(p.c<d[0].s.c||p.c>d[0].e.c)&&!(p.r<d[0].s.r||p.r>d[0].e.r)){u.push(Pn(d[1],o,we,n,a)),oe=!0;break}oe||u.push(C[1])}break;case"PtgArray":u.push("{"+fq(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=I;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&E>=0&&le.indexOf(t[0][I][0])==-1){C=t[0][E];var ne=!0;switch(C[1][0]){case 4:ne=!1;case 0:T=Rr(" ",C[1][1]);break;case 5:ne=!1;case 1:T=Rr("\r",C[1][1]);break;default:if(T="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((ne?T:"")+u.pop()+(ne?"":T)),E=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function mq(t,e,r){var n=t.l+e,a=r.biff==2?1:2,i,o=t.read_shift(a);if(o==65535)return[[],zn(t,e-2)];var u=oh(t,o,r);return e!==o+a&&(i=lh(t,e-o-a,u,r)),t.l=n,[u,i]}function pq(t,e,r){var n=t.l+e,a=r.biff==2?1:2,i,o=t.read_shift(a);if(o==65535)return[[],zn(t,e-2)];var u=oh(t,o,r);return e!==o+a&&(i=lh(t,e-o-a,u,r)),t.l=n,[u,i]}function gq(t,e,r,n){var a=t.l+e,i=oh(t,n,r),o;return a!==t.l&&(o=lh(t,a-t.l,i,r)),[i,o]}function xq(t,e,r){var n=t.l+e,a,i=t.read_shift(2),o=oh(t,i,r);return i==65535?[[],zn(t,e-2)]:(e!==i+2&&(a=lh(t,n-i-2,o,r)),[o,a])}function vq(t){var e;if(Si(t,t.l+6)!==65535)return[Bn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function yq(t){if(t==null){var e=Ae(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ko(t);return Ko(0)}function nx(t,e,r){var n=t.l+e,a=Qs(t);r.biff==2&&++t.l;var i=vq(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=pq(t,n-t.l,r);return{cell:a,val:i[0],formula:u,shared:o>>3&1,tt:i[1]}}function _q(t,e,r,n,a){var i=Jo(e,r,a),o=yq(t.v),u=Ae(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var d=Ae(t.bf.length),p=0;p<t.bf.length;++p)d[p]=t.bf[p];var x=gn([i,o,u,d]);return x}function Np(t,e,r){var n=t.read_shift(4),a=oh(t,n,r),i=t.read_shift(4),o=i>0?lh(t,i,a,r):null;return[a,o]}var wq=Np,Rp=Np,bq=Np,Eq=Np,Tq={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},UN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Sq={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function kS(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Aq(t){var e="of:="+t.replace(Wy,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function ax(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function kq(t){return t.replace(/\./,"!")}var s0={},hu={},i0=typeof Map<"u";function $y(t,e,r){var n=0,a=t.length;if(r){if(i0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=i0?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(i0?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function Ip(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Ln=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=N0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Wm(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function zo(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ao(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,i=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Ni(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=i;++a)if(t[a].numFmtId===n)return a;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function zN(t,e,r,n,a,i){try{n.cellNF&&(t.z=lt[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=vr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(lt[e]==null&&Ni(T7[e]||"General",e),t.t==="e")t.w=t.w||Ui[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=b0(t.v);else if(t.t==="d"){var o=fn(t.v);(o|0)===o?t.w=o.toString(10):t.w=b0(o)}else{if(t.v===void 0)return"";t.w=Yo(t.v,hu)}else t.t==="d"?t.w=es(e,fn(t.v),hu):t.w=es(e,t.v,hu)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=qm(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=qm(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&i.Fills)throw u}}}function Cq(t,e,r){if(t&&t["!ref"]){var n=Lt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function Nq(t,e){var r=Lt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=_t(r))}var Rq=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Iq=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Dq=/<(?:\w:)?hyperlink [^>]*>/mg,Oq=/"(\w*:\w*)"/,Fq=/<(?:\w:)?col\b[^>]*[\/]?>/g,Mq=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Pq=/<(?:\w:)?pageMargins[^>]*\/>/g,HN=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,jq=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Lq=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Bq(t,e,r,n,a,i,o){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",p="",x=t.match(Iq);x?(d=t.slice(0,x.index),p=t.slice(x.index+x[0].length)):d=p=t;var y=d.match(HN);y?Ky(y[0],u,a,r):(y=d.match(jq))&&Uq(y[0],y[1]||"",u,a,r);var w=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(w>0){var b=d.slice(w,w+50).match(Oq);b&&Nq(u,b[1])}var E=d.match(Lq);E&&E[1]&&eW(E[1],a);var T=[];if(e.cellStyles){var I=d.match(Fq);I&&$q(T,I)}x&&nW(x[1],u,e,f,i,o);var R=p.match(Mq);R&&(u["!autofilter"]=Qq(R[0]));var C=[],z=p.match(Rq);if(z)for(w=0;w!=z.length;++w)C[w]=Lt(z[w].slice(z[w].indexOf('"')+1));var H=p.match(Dq);H&&Wq(u,H,n);var X=p.match(Pq);if(X&&(u["!margins"]=Xq(ut(X[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=_t(f)),e.sheetRows>0&&u["!ref"]){var A=Lt(u["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>f.e.r&&(A.e.r=f.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>f.e.c&&(A.e.c=f.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),u["!fullref"]=u["!ref"],u["!ref"]=_t(A))}return T.length>0&&(u["!cols"]=T),C.length>0&&(u["!merges"]=C),u}function Vq(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+_t(t[r])+'"/>';return e+"</mergeCells>"}function Ky(t,e,r,n){var a=ut(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=jt(lr(a.codeName)))}function Uq(t,e,r,n,a){Ky(t.slice(0,t.indexOf(">")),r,n,a)}function zq(t,e,r,n,a){var i=!1,o={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[r];try{e.Workbook&&(f=e.Workbook.Sheets[r].CodeName||f)}catch{}i=!0,o.codeName=Bs(tr(f))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),u=(u||"")+Ue("outlinePr",null,d)}!i&&!u||(a[a.length]=Ue("sheetPr",u,o))}var Hq=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Gq=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function qq(t){var e={sheet:1};return Hq.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Gq.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Hy(t.password).toString(16).toUpperCase()),Ue("sheetProtection",null,e)}function Wq(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var i=ut(lr(e[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+jt(i.location))):(i.Target="#"+jt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var u=Lt(i.ref),f=u.s.r;f<=u.e.r;++f)for(var d=u.s.c;d<=u.e.c;++d){var p=ot({c:d,r:f});n?(t[f]||(t[f]=[]),t[f][d]||(t[f][d]={t:"z",v:void 0}),t[f][d].l=i):(t[p]||(t[p]={t:"z",v:void 0}),t[p].l=i)}}}function Xq(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Yq(t){return zo(t),Ue("pageMargins",null,t)}function $q(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=ut(e[n],!0);a.hidden&&(a.hidden=gr(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Gy(a.width)),Yl(a);i<=o;)t[i++]=yr(a)}}function Kq(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=Ue("col",null,Ip(a,n)));return r[r.length]="</cols>",r.join("")}function Qq(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function Jq(t,e,r,n){var a=typeof t.ref=="string"?t.ref:_t(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=da(a);o.s.r==o.e.r&&(o.e.r=da(e["!ref"]).e.r,a=_t(o));for(var u=0;u<i.length;++u){var f=i[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ue("autoFilter",null,{ref:a})}var Zq=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function eW(t,e){e.Views||(e.Views=[{}]),(t.match(Zq)||[]).forEach(function(r,n){var a=ut(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),gr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function tW(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,a),{})}function rW(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Ui[t.v];break;case"d":n&&n.cellDates?a=vr(t.v,-1).toISOString():(t=yr(t),t.t="n",a=""+(t.v=fn(vr(t.v)))),typeof t.z>"u"&&(t.z=lt[14]);break;default:a=t.v;break}var u=kn("v",tr(a)),f={r:e},d=ao(n.cellXfs,t,n);switch(d!==0&&(f.s=d),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=kn("v",""+$y(n.Strings,t.v,n.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var p=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=Ue("f",tr(t.f),p)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(f.cm=1),Ue("c",u,f)}var nW=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=E0("v"),o=E0("f");return function(f,d,p,x,y,w){for(var b=0,E="",T=[],I=[],R=0,C=0,z=0,H="",X,A,F=0,N=0,P,M,j=0,B=0,Se=Array.isArray(w.CellXf),we,se=[],oe=[],le=Array.isArray(d),ne=[],ye={},Q=!1,O=!!p.sheetStubs,Y=f.split(e),q=0,te=Y.length;q!=te;++q){E=Y[q].trim();var ce=E.length;if(ce!==0){var Te=0;e:for(b=0;b<ce;++b)switch(E[b]){case">":if(E[b-1]!="/"){++b;break e}if(p&&p.cellStyles){if(A=ut(E.slice(Te,b),!0),F=A.r!=null?parseInt(A.r,10):F+1,N=-1,p.sheetRows&&p.sheetRows<F)continue;ye={},Q=!1,A.ht&&(Q=!0,ye.hpt=parseFloat(A.ht),ye.hpx=Su(ye.hpt)),A.hidden=="1"&&(Q=!0,ye.hidden=!0),A.outlineLevel!=null&&(Q=!0,ye.level=+A.outlineLevel),Q&&(ne[F-1]=ye)}break;case"<":Te=b;break}if(Te>=b)break;if(A=ut(E.slice(Te,b),!0),F=A.r!=null?parseInt(A.r,10):F+1,N=-1,!(p.sheetRows&&p.sheetRows<F)){x.s.r>F-1&&(x.s.r=F-1),x.e.r<F-1&&(x.e.r=F-1),p&&p.cellStyles&&(ye={},Q=!1,A.ht&&(Q=!0,ye.hpt=parseFloat(A.ht),ye.hpx=Su(ye.hpt)),A.hidden=="1"&&(Q=!0,ye.hidden=!0),A.outlineLevel!=null&&(Q=!0,ye.level=+A.outlineLevel),Q&&(ne[F-1]=ye)),T=E.slice(b).split(t);for(var Re=0;Re!=T.length&&T[Re].trim().charAt(0)=="<";++Re);for(T=T.slice(Re),b=0;b!=T.length;++b)if(E=T[b].trim(),E.length!==0){if(I=E.match(r),R=b,C=0,z=0,E="<c "+(E.slice(0,1)=="<"?">":"")+E,I!=null&&I.length===2){for(R=0,H=I[1],C=0;C!=H.length&&!((z=H.charCodeAt(C)-64)<1||z>26);++C)R=26*R+z;--R,N=R}else++N;for(C=0;C!=E.length&&E.charCodeAt(C)!==62;++C);if(++C,A=ut(E.slice(0,C),!0),A.r||(A.r=ot({r:F-1,c:N})),H=E.slice(C),X={t:""},(I=H.match(i))!=null&&I[1]!==""&&(X.v=jt(I[1])),p.cellFormula){if((I=H.match(o))!=null&&I[1]!==""){if(X.f=jt(lr(I[1])).replace(/\r\n/g,`
`),p.xlfn||(X.f=ES(X.f)),I[0].indexOf('t="array"')>-1)X.F=(H.match(a)||[])[1],X.F.indexOf(":")>-1&&se.push([Lt(X.F),X.F]);else if(I[0].indexOf('t="shared"')>-1){M=ut(I[0]);var _e=jt(lr(I[1]));p.xlfn||(_e=ES(_e)),oe[parseInt(M.si,10)]=[M,_e,A.r]}}else(I=H.match(/<f[^>]*\/>/))&&(M=ut(I[0]),oe[M.si]&&(X.f=ZH(oe[M.si][1],oe[M.si][2],A.r)));var ke=Sr(A.r);for(C=0;C<se.length;++C)ke.r>=se[C][0].s.r&&ke.r<=se[C][0].e.r&&ke.c>=se[C][0].s.c&&ke.c<=se[C][0].e.c&&(X.F=se[C][1])}if(A.t==null&&X.v===void 0)if(X.f||X.F)X.v=0,X.t="n";else if(O)X.t="z";else continue;else X.t=A.t||"n";switch(x.s.c>N&&(x.s.c=N),x.e.c<N&&(x.e.c=N),X.t){case"n":if(X.v==""||X.v==null){if(!O)continue;X.t="z"}else X.v=parseFloat(X.v);break;case"s":if(typeof X.v>"u"){if(!O)continue;X.t="z"}else P=s0[parseInt(X.v,10)],X.v=P.t,X.r=P.r,p.cellHTML&&(X.h=P.h);break;case"str":X.t="s",X.v=X.v!=null?lr(X.v):"",p.cellHTML&&(X.h=Cy(X.v));break;case"inlineStr":I=H.match(n),X.t="s",I!=null&&(P=zy(I[1]))?(X.v=P.t,p.cellHTML&&(X.h=P.h)):X.v="";break;case"b":X.v=gr(X.v);break;case"d":p.cellDates?X.v=vr(X.v,1):(X.v=fn(vr(X.v,1)),X.t="n");break;case"e":(!p||p.cellText!==!1)&&(X.w=X.v),X.v=qC[X.v];break}if(j=B=0,we=null,Se&&A.s!==void 0&&(we=w.CellXf[A.s],we!=null&&(we.numFmtId!=null&&(j=we.numFmtId),p.cellStyles&&we.fillId!=null&&(B=we.fillId))),zN(X,j,B,p,y,w),p.cellDates&&Se&&X.t=="n"&&Pu(lt[j])&&(X.t="d",X.v=kp(X.v)),A.cm&&p.xlmeta){var rt=(p.xlmeta.Cell||[])[+A.cm-1];rt&&rt.type=="XLDAPR"&&(X.D=!0)}if(le){var L=Sr(A.r);d[L.r]||(d[L.r]=[]),d[L.r][L.c]=X}else d[A.r]=X}}}}ne.length>0&&(d["!rows"]=ne)}})();function aW(t,e,r,n){var a=[],i=[],o=Lt(t["!ref"]),u="",f,d="",p=[],x=0,y=0,w=t["!rows"],b=Array.isArray(t),E={r:d},T,I=-1;for(y=o.s.c;y<=o.e.c;++y)p[y]=Tr(y);for(x=o.s.r;x<=o.e.r;++x){for(i=[],d=Ur(x),y=o.s.c;y<=o.e.c;++y){f=p[y]+d;var R=b?(t[x]||[])[y]:t[f];R!==void 0&&(u=rW(R,f,t,e))!=null&&i.push(u)}(i.length>0||w&&w[x])&&(E={r:d},w&&w[x]&&(T=w[x],T.hidden&&(E.hidden=1),I=-1,T.hpx?I=R0(T.hpx):T.hpt&&(I=T.hpt),I>-1&&(E.ht=I,E.customHeight=1),T.level&&(E.outlineLevel=T.level)),a[a.length]=Ue("row",i.join(""),E))}if(w)for(;x<w.length;++x)w&&w[x]&&(E={r:x+1},T=w[x],T.hidden&&(E.hidden=1),I=-1,T.hpx?I=R0(T.hpx):T.hpt&&(I=T.hpt),I>-1&&(E.ht=I,E.customHeight=1),T.level&&(E.outlineLevel=T.level),a[a.length]=Ue("row","",E));return a.join("")}function GN(t,e,r,n){var a=[zr,Ue("worksheet",null,{xmlns:nc[0],"xmlns:r":on.r})],i=r.SheetNames[t],o=0,u="",f=r.Sheets[i];f==null&&(f={});var d=f["!ref"]||"A1",p=Lt(d);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),d=_t(p)}n||(n={}),f["!comments"]=[];var x=[];zq(f,r,t,e,a),a[a.length]=Ue("dimension",null,{ref:d}),a[a.length]=tW(f,e,t,r),e.sheetFormat&&(a[a.length]=Ue("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=Kq(f,f["!cols"])),a[o=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=aW(f,e),u.length>0&&(a[a.length]=u)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),f["!protect"]&&(a[a.length]=qq(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=Jq(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=Vq(f["!merges"]));var y=-1,w,b=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(E){E[1].Target&&(w={ref:E[0]},E[1].Target.charAt(0)!="#"&&(b=er(n,-1,tr(E[1].Target).replace(/#.*$/,""),St.HLINK),w["r:id"]="rId"+b),(y=E[1].Target.indexOf("#"))>-1&&(w.location=tr(E[1].Target.slice(y+1))),E[1].Tooltip&&(w.tooltip=tr(E[1].Tooltip)),a[a.length]=Ue("hyperlink",null,w))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=Yq(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=kn("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:d}))),x.length>0&&(b=er(n,-1,"../drawings/drawing"+(t+1)+".xml",St.DRAW),a[a.length]=Ue("drawing",null,{"r:id":"rId"+b}),f["!drawing"]=x),f["!comments"].length>0&&(b=er(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",St.VML),a[a.length]=Ue("legacyDrawing",null,{"r:id":"rId"+b}),f["!legacy"]=b),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function sW(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function iW(t,e,r){var n=Ae(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;a.hpx?i=R0(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var d={r:t,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var x=-1,y=-1,w=p<<10;w<p+1<<10;++w){d.c=w;var b=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ot(d)];b&&(x<0&&(x=w),y=w)}x<0||(++u,n.write_shift(4,x),n.write_shift(4,y))}var E=n.l;return n.l=f,n.write_shift(4,u),n.l=E,n.length>n.l?n.slice(0,n.l):n}function lW(t,e,r,n){var a=iW(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Me(t,0,a)}var oW=lc,cW=Bu;function uW(){}function fW(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=mB(t),r}function hW(t,e,r){r==null&&(r=Ae(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return zm({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),VC(t,r),r.slice(0,r.l)}function dW(t){var e=rs(t);return[e]}function mW(t,e,r){return r==null&&(r=Ae(8)),ac(e,r)}function pW(t){var e=sc(t);return[e]}function gW(t,e,r){return r==null&&(r=Ae(4)),ic(e,r)}function xW(t){var e=rs(t),r=t.read_shift(1);return[e,r,"b"]}function vW(t,e,r){return r==null&&(r=Ae(9)),ac(e,r),r.write_shift(1,t.v?1:0),r}function yW(t){var e=sc(t),r=t.read_shift(1);return[e,r,"b"]}function _W(t,e,r){return r==null&&(r=Ae(5)),ic(e,r),r.write_shift(1,t.v?1:0),r}function wW(t){var e=rs(t),r=t.read_shift(1);return[e,r,"e"]}function bW(t,e,r){return r==null&&(r=Ae(9)),ac(e,r),r.write_shift(1,t.v),r}function EW(t){var e=sc(t),r=t.read_shift(1);return[e,r,"e"]}function TW(t,e,r){return r==null&&(r=Ae(8)),ic(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function SW(t){var e=rs(t),r=t.read_shift(4);return[e,r,"s"]}function AW(t,e,r){return r==null&&(r=Ae(12)),ac(e,r),r.write_shift(4,e.v),r}function kW(t){var e=sc(t),r=t.read_shift(4);return[e,r,"s"]}function CW(t,e,r){return r==null&&(r=Ae(8)),ic(e,r),r.write_shift(4,e.v),r}function NW(t){var e=rs(t),r=Bn(t);return[e,r,"n"]}function RW(t,e,r){return r==null&&(r=Ae(16)),ac(e,r),Ko(t.v,r),r}function qN(t){var e=sc(t),r=Bn(t);return[e,r,"n"]}function IW(t,e,r){return r==null&&(r=Ae(12)),ic(e,r),Ko(t.v,r),r}function DW(t){var e=rs(t),r=jy(t);return[e,r,"n"]}function OW(t,e,r){return r==null&&(r=Ae(12)),ac(e,r),UC(t.v,r),r}function FW(t){var e=sc(t),r=jy(t);return[e,r,"n"]}function MW(t,e,r){return r==null&&(r=Ae(8)),ic(e,r),UC(t.v,r),r}function PW(t){var e=rs(t),r=Fy(t);return[e,r,"is"]}function jW(t){var e=rs(t),r=Vn(t);return[e,r,"str"]}function LW(t,e,r){return r==null&&(r=Ae(12+4*t.v.length)),ac(e,r),xn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function BW(t){var e=sc(t),r=Vn(t);return[e,r,"str"]}function VW(t,e,r){return r==null&&(r=Ae(8+4*t.v.length)),ic(e,r),xn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function UW(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=t.read_shift(1),o=[a,i,"b"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return o}function zW(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=t.read_shift(1),o=[a,i,"e"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return o}function HW(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=Bn(t),o=[a,i,"n"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return o}function GW(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=Vn(t),o=[a,i,"str"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return o}var qW=lc,WW=Bu;function XW(t,e){return e==null&&(e=Ae(4)),e.write_shift(4,t),e}function YW(t,e){var r=t.l+e,n=lc(t),a=My(t),i=Vn(t),o=Vn(t),u=Vn(t);t.l=r;var f={rfx:n,relId:a,loc:i,display:u};return o&&(f.Tooltip=o),f}function $W(t,e){var r=Ae(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Bu({s:Sr(t[0]),e:Sr(t[0])},r),Py("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return xn(a||"",r),xn(t[1].Tooltip||"",r),xn("",r),r.slice(0,r.l)}function KW(){}function QW(t,e,r){var n=t.l+e,a=zC(t),i=t.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var u=wq(t,n-t.l,r);o[1]=u}else t.l=n;return o}function JW(t,e,r){var n=t.l+e,a=lc(t),i=[a];if(r.cellFormula){var o=Eq(t,n-t.l,r);i[1]=o,t.l=n}else t.l=n;return i}function ZW(t,e,r){r==null&&(r=Ae(18));var n=Ip(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var WN=["left","right","top","bottom","header","footer"];function eX(t){var e={};return WN.forEach(function(r){e[r]=Bn(t)}),e}function tX(t,e){return e==null&&(e=Ae(48)),zo(t),WN.forEach(function(r){Ko(t[r],e)}),e}function rX(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function nX(t,e,r){r==null&&(r=Ae(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function aX(t){var e=Ae(24);return e.write_shift(4,4),e.write_shift(4,1),Bu(t,e),e}function sX(t,e){return e==null&&(e=Ae(66)),e.write_shift(2,t.password?Hy(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function iX(){}function lX(){}function oX(t,e,r,n,a,i,o){if(!t)return t;var u=e||{};n||(n={"!id":{}});var f=u.dense?[]:{},d,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,y=!1,w,b,E,T,I,R,C,z,H,X=[];u.biff=12,u["!row"]=0;var A=0,F=!1,N=[],P={},M=u.supbooks||a.supbooks||[[]];if(M.sharedf=P,M.arrayf=N,M.SheetNames=a.SheetNames||a.Sheets.map(function(le){return le.name}),!u.supbooks&&(u.supbooks=M,a.Names))for(var j=0;j<a.Names.length;++j)M[0][j+1]=a.Names[j];var B=[],Se=[],we=!1;I0[16]={n:"BrtShortReal",f:qN};var se;if(Vi(t,function(ne,ye,Q){if(!y)switch(Q){case 148:d=ne;break;case 0:w=ne,u.sheetRows&&u.sheetRows<=w.r&&(y=!0),z=Ur(T=w.r),u["!row"]=w.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=Su(ne.hpt)),Se[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:ne[2]},ne[2]){case"n":b.v=ne[1];break;case"s":C=s0[ne[1]],b.v=C.t,b.r=C.r;break;case"b":b.v=!!ne[1];break;case"e":b.v=ne[1],u.cellText!==!1&&(b.w=Ui[b.v]);break;case"str":b.t="s",b.v=ne[1];break;case"is":b.t="s",b.v=ne[1].t;break}if((E=o.CellXf[ne[0].iStyleRef])&&zN(b,E.numFmtId,null,u,i,o),I=ne[0].c==-1?I+1:ne[0].c,u.dense?(f[T]||(f[T]=[]),f[T][I]=b):f[Tr(I)+z]=b,u.cellFormula){for(F=!1,A=0;A<N.length;++A){var O=N[A];w.r>=O[0].s.r&&w.r<=O[0].e.r&&I>=O[0].s.c&&I<=O[0].e.c&&(b.F=_t(O[0]),F=!0)}!F&&ne.length>3&&(b.f=ne[3])}if(p.s.r>w.r&&(p.s.r=w.r),p.s.c>I&&(p.s.c=I),p.e.r<w.r&&(p.e.r=w.r),p.e.c<I&&(p.e.c=I),u.cellDates&&E&&b.t=="n"&&Pu(lt[E.numFmtId])){var Y=Mo(b.v);Y&&(b.t="d",b.v=new Date(Y.y,Y.m-1,Y.d,Y.H,Y.M,Y.S,Y.u))}se&&(se.type=="XLDAPR"&&(b.D=!0),se=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;b={t:"z",v:void 0},I=ne[0].c==-1?I+1:ne[0].c,u.dense?(f[T]||(f[T]=[]),f[T][I]=b):f[Tr(I)+z]=b,p.s.r>w.r&&(p.s.r=w.r),p.s.c>I&&(p.s.c=I),p.e.r<w.r&&(p.e.r=w.r),p.e.c<I&&(p.e.c=I),se&&(se.type=="XLDAPR"&&(b.D=!0),se=void 0);break;case 176:X.push(ne);break;case 49:se=((u.xlmeta||{}).Cell||[])[ne-1];break;case 494:var q=n["!id"][ne.relId];for(q?(ne.Target=q.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=q):ne.relId==""&&(ne.Target="#"+ne.loc),T=ne.rfx.s.r;T<=ne.rfx.e.r;++T)for(I=ne.rfx.s.c;I<=ne.rfx.e.c;++I)u.dense?(f[T]||(f[T]=[]),f[T][I]||(f[T][I]={t:"z",v:void 0}),f[T][I].l=ne):(R=ot({c:I,r:T}),f[R]||(f[R]={t:"z",v:void 0}),f[R].l=ne);break;case 426:if(!u.cellFormula)break;N.push(ne),H=u.dense?f[T][I]:f[Tr(I)+z],H.f=Pn(ne[1],p,{r:w.r,c:I},M,u),H.F=_t(ne[0]);break;case 427:if(!u.cellFormula)break;P[ot(ne[0].s)]=ne[1],H=u.dense?f[T][I]:f[Tr(I)+z],H.f=Pn(ne[1],p,{r:w.r,c:I},M,u);break;case 60:if(!u.cellStyles)break;for(;ne.e>=ne.s;)B[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},we||(we=!0,Gy(ne.w/256)),Yl(B[ne.e+1]);break;case 161:f["!autofilter"]={ref:_t(ne)};break;case 476:f["!margins"]=ne;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ne.name&&(a.Sheets[r].CodeName=ne.name),(ne.above||ne.left)&&(f["!outline"]={above:ne.above,left:ne.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ne.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!ye.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+Q.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(p.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=_t(d||p)),u.sheetRows&&f["!ref"]){var oe=Lt(f["!ref"]);u.sheetRows<=+oe.e.r&&(oe.e.r=u.sheetRows-1,oe.e.r>p.e.r&&(oe.e.r=p.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>p.e.c&&(oe.e.c=p.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),f["!fullref"]=f["!ref"],f["!ref"]=_t(oe))}return X.length>0&&(f["!merges"]=X),B.length>0&&(f["!cols"]=B),Se.length>0&&(f["!rows"]=Se),f}function cX(t,e,r,n,a,i,o){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=yr(e),e.z=e.z||lt[14],e.v=fn(vr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r,c:n};switch(f.s=ao(a.cellXfs,e,a),e.l&&i["!links"].push([ot(f),e.l]),e.c&&i["!comments"].push([ot(f),e.c]),e.t){case"s":case"str":return a.bookSST?(u=$y(a.Strings,e.v,a.revStrings),f.t="s",f.v=u,o?Me(t,18,CW(e,f)):Me(t,7,AW(e,f))):(f.t="str",o?Me(t,17,VW(e,f)):Me(t,6,LW(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Me(t,13,MW(e,f)):Me(t,2,OW(e,f)):o?Me(t,16,IW(e,f)):Me(t,5,RW(e,f)),!0;case"b":return f.t="b",o?Me(t,15,_W(e,f)):Me(t,4,vW(e,f)),!0;case"e":return f.t="e",o?Me(t,14,TW(e,f)):Me(t,3,bW(e,f)),!0}return o?Me(t,12,gW(e,f)):Me(t,1,mW(e,f)),!0}function uX(t,e,r,n){var a=Lt(e["!ref"]||"A1"),i,o="",u=[];Me(t,145);var f=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var p=a.s.r;p<=d;++p){o=Ur(p),lW(t,e,a,p);var x=!1;if(p<=a.e.r)for(var y=a.s.c;y<=a.e.c;++y){p===a.s.r&&(u[y]=Tr(y)),i=u[y]+o;var w=f?(e[p]||[])[y]:e[i];if(!w){x=!1;continue}x=cX(t,w,p,y,n,e,x)}}Me(t,146)}function fX(t,e){!e||!e["!merges"]||(Me(t,177,XW(e["!merges"].length)),e["!merges"].forEach(function(r){Me(t,176,WW(r))}),Me(t,178))}function hX(t,e){!e||!e["!cols"]||(Me(t,390),e["!cols"].forEach(function(r,n){r&&Me(t,60,ZW(n,r))}),Me(t,391))}function dX(t,e){!e||!e["!ref"]||(Me(t,648),Me(t,649,aX(Lt(e["!ref"]))),Me(t,650))}function mX(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=er(r,-1,n[1].Target.replace(/#.*$/,""),St.HLINK);Me(t,494,$W(n,a))}}),delete e["!links"]}function pX(t,e,r,n){if(e["!comments"].length>0){var a=er(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",St.VML);Me(t,551,Py("rId"+a)),e["!legacy"]=a}}function gX(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],i=typeof a.ref=="string"?a.ref:_t(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=da(i);u.s.r==u.e.r&&(u.e.r=da(e["!ref"]).e.r,i=_t(u));for(var f=0;f<o.length;++f){var d=o[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Me(t,161,Bu(Lt(i))),Me(t,162)}}function xX(t,e,r){Me(t,133),Me(t,137,nX(e,r)),Me(t,138),Me(t,134)}function vX(t,e){e["!protect"]&&Me(t,535,sX(e["!protect"]))}function yX(t,e,r,n){var a=ha(),i=r.SheetNames[t],o=r.Sheets[i]||{},u=i;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var f=Lt(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Me(a,129),(r.vbaraw||o["!outline"])&&Me(a,147,hW(u,o["!outline"])),Me(a,148,cW(f)),xX(a,o,r.Workbook),hX(a,o),uX(a,o,t,e),vX(a,o),gX(a,o,r,t),fX(a,o),mX(a,o,n),o["!margins"]&&Me(a,476,tX(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&dX(a,o),pX(a,o,t,n),Me(a,130),a.end()}function _X(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var a=jt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,a,n]}function wX(t,e,r,n,a,i){var o=i||{"!type":"chart"};if(!t)return i;var u=0,f=0,d="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var y=_X(x);p.s.r=p.s.c=0,p.e.c=u,d=Tr(u),y[0].forEach(function(w,b){o[d+Ur(b)]={t:"n",v:w,z:y[1]},f=b}),p.e.r<f&&(p.e.r=f),++u}),u>0&&(o["!ref"]=_t(p)),o}function bX(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,u=t.match(HN);return u&&Ky(u[0],i,a,r),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function EX(t,e){t.l+=10;var r=Vn(t);return{name:r}}function TX(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Vi(t,function(f,d,p){switch(p){case 550:i["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Qy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],SX=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],AX=[],kX=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function CS(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var i=e[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=gr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function NS(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=gr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function XN(t){NS(t.WBProps,Qy),NS(t.CalcPr,kX),CS(t.WBView,SX),CS(t.Sheets,AX),hu.date1904=gr(t.WBProps.date1904)}function CX(t){return!t.Workbook||!t.Workbook.WBProps?"false":gr(t.Workbook.WBProps.date1904)?"true":"false"}var NX="][*?/\\".split("");function YN(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return NX.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function RX(t,e,r){t.forEach(function(n,a){YN(n);for(var i=0;i<a;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[a]&&e[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function IX(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];RX(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)Cq(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var DX=/<\w+:workbook/;function OX(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(t.replace(Hn,function(f,d){var p=ut(f);switch(Ks(p[0])){case"<?xml":break;case"<workbook":f.match(DX)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Qy.forEach(function(x){if(p[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=gr(p[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(p[x[0]],10);break;default:r.WBProps[x[0]]=p[x[0]]}}),p.codeName&&(r.WBProps.CodeName=lr(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=jt(lr(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=lr(p.name),p.comment&&(i.Comment=p.comment),p.localSheetId&&(i.Sheet=+p.localSheetId),gr(p.hidden||"0")&&(i.Hidden=!0),o=d+f.length;break;case"</definedName>":i.Ref=jt(lr(t.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return f}),nc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return XN(r),r}function $N(t){var e=[zr];e[e.length]=Ue("workbook",null,{xmlns:nc[0],"xmlns:r":on.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Qy.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ue("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:tr(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Ue("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=Ue("definedName",tr(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function FX(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Yx(t),r.name=Vn(t),r}function MX(t,e){return e||(e=Ae(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Py(t.strRelID,e),xn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function PX(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?Vn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function jX(t,e){e||(e=Ae(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),VC(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function LX(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function BX(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),i=pB(t),o=bq(t,0,r),u=My(t);t.l=n;var f={Name:i,Ptg:o};return a<268435455&&(f.Sheet=a),u&&(f.Comment=u),f}function VX(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],I0[16]={n:"BrtFRTArchID$",f:LX},Vi(t,function(f,d,p){switch(p){case 156:o.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Pn(f.Ptg,null,null,o,e),delete e.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([p,f]):o[0]=[p,f],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(f),o.XTI=o.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(p),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},e),XN(r),r.Names=i,r.supbooks=o,r}function UX(t,e){Me(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Me(t,156,MX(a))}Me(t,144)}function zX(t,e){e||(e=Ae(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return xn("SheetJS",e),xn(Mm.version,e),xn(Mm.version,e),xn("7262",e),e.length>e.l?e.slice(0,e.l):e}function HX(t,e){e||(e=Ae(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function GX(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Me(t,135),Me(t,158,HX(a)),Me(t,136))}}function qX(t,e){var r=ha();return Me(r,131),Me(r,128,zX()),Me(r,153,jX(t.Workbook&&t.Workbook.WBProps||null)),GX(r,t),UX(r,t),Me(r,132),r.end()}function WX(t,e,r){return e.slice(-4)===".bin"?VX(t,r):OX(t,r)}function XX(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?oX(t,n,r,a,i,o,u):Bq(t,n,r,a,i,o,u)}function YX(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?TX(t,n,r,a,i):bX(t,n,r,a,i)}function $X(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?QH():JH()}function KX(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?$H():KH()}function QX(t,e,r,n){return e.slice(-4)===".bin"?Wz(t,r,n):Fz(t,r,n)}function JX(t,e,r){return NN(t,r)}function ZX(t,e,r){return e.slice(-4)===".bin"?ZU(t,r):KU(t,r)}function eY(t,e,r){return e.slice(-4)===".bin"?GH(t,r):MH(t,r)}function tY(t,e,r){return e.slice(-4)===".bin"?DH(t):RH(t)}function rY(t,e,r,n){return r.slice(-4)===".bin"?OH(t,e,r,n):void 0}function nY(t,e,r){return e.slice(-4)===".bin"?kH(t,e,r):NH(t,e,r)}function aY(t,e,r){return(e.slice(-4)===".bin"?qX:$N)(t)}function sY(t,e,r,n,a){return(e.slice(-4)===".bin"?yX:GN)(t,r,n,a)}function iY(t,e,r){return(e.slice(-4)===".bin"?rH:kN)(t,r)}function lY(t,e,r){return(e.slice(-4)===".bin"?rz:yN)(t,r)}function oY(t,e,r){return(e.slice(-4)===".bin"?qH:DN)(t)}function cY(t){return(t.slice(-4)===".bin"?CH:RN)()}var KN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,QN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ps(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(KN),i,o,u,f;if(a)for(f=0;f!=a.length;++f)i=a[f].match(QN),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?u="xmlns"+i[1].slice(6):u=i[1].slice(o+1),n[u]=i[2].slice(1,i[2].length-1));return n}function uY(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(KN),a,i,o,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(QN),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var l0;function fY(t,e){var r=l0[t]||jt(t);return r==="General"?Yo(e):es(r,e)}function hY(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=gr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=vr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[jt(e)]=a}function dY(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ui[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=b0(t.v):t.w=Yo(t.v):t.w=fY(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=l0[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Pu(n)){var a=Mo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function mY(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=Az[n.Pattern]||n.Pattern)}t[e.ID]=e}function pY(t,e,r,n,a,i,o,u,f,d){var p="General",x=n.StyleID,y={};d=d||{};var w=[],b=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&o&&(x=o.StyleID);i[x]!==void 0&&(i[x].nf&&(p=i[x].nf),i[x].Interior&&w.push(i[x].Interior),!!i[x].Parent);)x=i[x].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=gr(t);break;case"String":n.t="s",n.r=WT(jt(t)),n.v=t.indexOf("<")>-1?jt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(vr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=jt(t):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=qC[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=WT(e||t));break}if(dY(n,p,d),d.cellFormula!==!1)if(n.Formula){var E=jt(n.Formula);E.charCodeAt(0)==61&&(E=E.slice(1)),n.f=fu(E,a),delete n.Formula,n.ArrayRange=="RC"?n.F=fu("RC:RC",a):n.ArrayRange&&(n.F=fu(n.ArrayRange,a),f.push([Lt(n.F),n.F]))}else for(b=0;b<f.length;++b)a.r>=f[b][0].s.r&&a.r<=f[b][0].e.r&&a.c>=f[b][0].s.c&&a.c<=f[b][0].e.c&&(n.F=f[b][1]);d.cellStyles&&(w.forEach(function(T){!y.patternType&&T.patternType&&(y.patternType=T.patternType)}),n.s=y),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function gY(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function sx(t,e){var r=e||{};ju();var n=qf(Ny(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=lr(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=yr(r);return o.type="string",Tu.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ht){a.indexOf("<"+ht)>=0&&(i=!0)}),i)return t$(n,r);l0={"General Number":"General","General Date":lt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":lt[15],"Short Date":lt[14],"Long Time":lt[19],"Medium Time":lt[18],"Short Time":lt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:lt[2],Standard:lt[4],Percent:lt[10],Scientific:lt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],d,p={},x=[],y=r.dense?[]:{},w="",b={},E={},T=ps('<Data ss:Type="String">'),I=0,R=0,C=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},H={},X={},A="",F=0,N=[],P={},M={},j=0,B=[],Se=[],we={},se=[],oe,le=!1,ne=[],ye=[],Q={},O=0,Y=0,q={Sheets:[],WBProps:{date1904:!1}},te={};S0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";u=S0.exec(n);)switch(u[3]=(ce=u[3]).toLowerCase()){case"data":if(ce=="data"){if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?pY(n.slice(I,u.index),A,T,f[f.length-1][0]=="comment"?we:b,{c:R,r:C},H,se[R],E,ne,r):(A="",T=ps(u[0]),I=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Se.length>0&&(b.c=Se),(!r.sheetRows||r.sheetRows>C)&&b.v!==void 0&&(r.dense?(y[C]||(y[C]=[]),y[C][R]=b):y[Tr(R)+Ur(C)]=b),b.HRef&&(b.l={Target:jt(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(O=R+(parseInt(b.MergeAcross,10)|0),Y=C+(parseInt(b.MergeDown,10)|0),N.push({s:{c:R,r:C},e:{c:O,r:Y}})),!r.sheetStubs)b.MergeAcross?R=O+1:++R;else if(b.MergeAcross||b.MergeDown){for(var Te=R;Te<=O;++Te)for(var Re=C;Re<=Y;++Re)(Te>R||Re>C)&&(r.dense?(y[Re]||(y[Re]=[]),y[Re][Te]={t:"z"}):y[Tr(Te)+Ur(Re)]={t:"z"});R=O+1}else++R;else b=uY(u[0]),b.Index&&(R=+b.Index-1),R<z.s.c&&(z.s.c=R),R>z.e.c&&(z.e.c=R),u[0].slice(-2)==="/>"&&++R,Se=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(C<z.s.r&&(z.s.r=C),C>z.e.r&&(z.e.r=C),u[0].slice(-2)==="/>"&&(E=ps(u[0]),E.Index&&(C=+E.Index-1)),R=0,++C):(E=ps(u[0]),E.Index&&(C=+E.Index-1),Q={},(E.AutoFitHeight=="0"||E.Height)&&(Q.hpx=parseInt(E.Height,10),Q.hpt=R0(Q.hpx),ye[C]=Q),E.Hidden=="1"&&(Q.hidden=!0,ye[C]=Q));break;case"worksheet":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));x.push(w),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(y["!ref"]=_t(z),r.sheetRows&&r.sheetRows<=z.e.r&&(y["!fullref"]=y["!ref"],z.e.r=r.sheetRows-1,y["!ref"]=_t(z))),N.length&&(y["!merges"]=N),se.length>0&&(y["!cols"]=se),ye.length>0&&(y["!rows"]=ye),p[w]=y}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=R=0,f.push([u[3],!1]),d=ps(u[0]),w=jt(d.Name),y=r.dense?[]:{},N=[],ne=[],ye=[],te={name:w,Hidden:0},q.Sheets.push(te);break;case"table":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),se=[],le=!1}break;case"style":u[1]==="/"?mY(H,X,r):X=ps(u[0]);break;case"numberformat":X.nf=jt(ps(u[0]).Format||"General"),l0[X.nf]&&(X.nf=l0[X.nf]);for(var _e=0;_e!=392&&lt[_e]!=X.nf;++_e);if(_e==392){for(_e=57;_e!=392;++_e)if(lt[_e]==null){Ni(X.nf,_e);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(oe=ps(u[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!le&&oe.wpx>10){le=!0,Ln=SN;for(var ke=0;ke<se.length;++ke)se[ke]&&Yl(se[ke])}le&&Yl(oe),se[oe.Index-1||se.length]=oe;for(var rt=0;rt<+oe.Span;++rt)se[se.length]=yr(oe);break;case"namedrange":if(u[1]==="/")break;q.Names||(q.Names=[]);var L=ut(u[0]),Xe={Name:L.Name,Ref:fu(L.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(Xe.Sheet=q.Sheets.length-1),q.Names.push(Xe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?A+=n.slice(F,u.index):F=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;X.Interior=ps(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?VB(P,ce,n.slice(j,u.index)):j=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));gY(we),Se.push(we)}else f.push([u[3],!1]),d=ps(u[0]),we={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Pe=ps(u[0]);y["!autofilter"]={ref:fu(Pe.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return FS(n,r);var et=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:et=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:et=!1}break;case"excelworkbook":switch(u[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:et=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:et=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(j,u.index)){case"SheetHidden":te.Hidden=1;break;case"SheetVeryHidden":te.Hidden=2;break}else j=u.index+u[0].length;break;case"header":y["!margins"]||zo(y["!margins"]={},"xlml"),isNaN(+ut(u[0]).Margin)||(y["!margins"].header=+ut(u[0]).Margin);break;case"footer":y["!margins"]||zo(y["!margins"]={},"xlml"),isNaN(+ut(u[0]).Margin)||(y["!margins"].footer=+ut(u[0]).Margin);break;case"pagemargins":var We=ut(u[0]);y["!margins"]||zo(y["!margins"]={},"xlml"),isNaN(+We.Top)||(y["!margins"].top=+We.Top),isNaN(+We.Left)||(y["!margins"].left=+We.Left),isNaN(+We.Right)||(y["!margins"].right=+We.Right),isNaN(+We.Bottom)||(y["!margins"].bottom=+We.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:et=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:et=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:et=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:et=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:et=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:et=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:et=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:et=!1}break;case"smarttags":break;default:et=!1;break}if(et||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?hY(M,ce,B,n.slice(j,u.index)):(B=u,j=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var je={};return!r.bookSheets&&!r.bookProps&&(je.Sheets=p),je.SheetNames=x,je.Workbook=q,je.SSF=yr(lt),je.Props=P,je.Custprops=M,je}function tv(t,e){switch(Zy(e=e||{}),e.type||"base64"){case"base64":return sx(Ia(t),e);case"binary":case"buffer":case"file":return sx(t,e);case"array":return sx(ro(t),e)}}function xY(t,e){var r=[];return t.Props&&r.push(UB(t.Props,e)),t.Custprops&&r.push(zB(t.Props,t.Custprops)),r.join("")}function vY(){return""}function yY(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var i=[];i.push(Ue("NumberFormat",null,{"ss:Format":tr(lt[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Ue("Style",i.join(""),o))}),Ue("Styles",r.join(""))}function JN(t){return Ue("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Xy(t.Ref,{r:0,c:0})})}function _Y(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(JN(a)))}return Ue("Names",r.join(""))}function wY(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],o=0;o<a.length;++o){var u=a[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||i.push(JN(u)))}return i.join("")}function bY(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Ue("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Ue("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Ue("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ue("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(kn("ProtectContents","True")),t["!protect"].objects&&a.push(kn("ProtectObjects","True")),t["!protect"].scenarios&&a.push(kn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(kn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(kn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Ue("WorksheetOptions",a.join(""),{xmlns:Sa.x})}function EY(t){return t.map(function(e){var r=G7(e.t||""),n=Ue("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",n,{"ss:Author":e.a})}).join("")}function TY(t,e,r,n,a,i,o){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+tr(Xy(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var f=Sr(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=tr(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=tr(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],p=0;p!=d.length;++p)d[p].s.c!=o.c||d[p].s.r!=o.r||(d[p].e.c>d[p].s.c&&(u["ss:MergeAcross"]=d[p].e.c-d[p].s.c),d[p].e.r>d[p].s.r&&(u["ss:MergeDown"]=d[p].e.r-d[p].s.r));var x="",y="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":x="Number",y=String(t.v);break;case"b":x="Boolean",y=t.v?"1":"0";break;case"e":x="Error",y=Ui[t.v];break;case"d":x="DateTime",y=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||lt[14]);break;case"s":x="String",y=H7(t.v||"");break}var w=ao(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+w),u["ss:Index"]=o.c+1;var b=t.v!=null?y:"",E=t.t=="z"?"":'<Data ss:Type="'+x+'">'+b+"</Data>";return(t.c||[]).length>0&&(E+=EY(t.c)),Ue("Cell",E,u)}function SY(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Su(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function AY(t,e,r,n){if(!t["!ref"])return"";var a=Lt(t["!ref"]),i=t["!merges"]||[],o=0,u=[];t["!cols"]&&t["!cols"].forEach(function(T,I){Yl(T);var R=!!T.width,C=Ip(I,T),z={"ss:Index":I+1};R&&(z["ss:Width"]=C0(C.width)),T.hidden&&(z["ss:Hidden"]="1"),u.push(Ue("Column",null,z))});for(var f=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var p=[SY(d,(t["!rows"]||[])[d])],x=a.s.c;x<=a.e.c;++x){var y=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>x)&&!(i[o].s.r>d)&&!(i[o].e.c<x)&&!(i[o].e.r<d)){(i[o].s.c!=x||i[o].s.r!=d)&&(y=!0);break}if(!y){var w={r:d,c:x},b=ot(w),E=f?(t[d]||[])[x]:t[b];p.push(TY(E,b,t,e,r,n,w))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function kY(t,e,r){var n=[],a=r.SheetNames[t],i=r.Sheets[a],o=i?wY(i,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?AY(i,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(bY(i,e,t,r)),n.join("")}function CY(t,e){e||(e={}),t.SSF||(t.SSF=yr(lt)),t.SSF&&(ju(),Tp(t.SSF),e.revssf=Ap(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],ao(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(xY(t,e)),r.push(vY()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ue("Worksheet",kY(n,e,t),{"ss:Name":tr(t.SheetNames[n])}));return r[2]=yY(t,e),r[3]=_Y(t),zr+Ue("Workbook",r.join(""),{xmlns:Sa.ss,"xmlns:o":Sa.o,"xmlns:x":Sa.x,"xmlns:ss":Sa.ss,"xmlns:dt":Sa.dt,"xmlns:html":Sa.html})}function NY(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=_B(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=wB(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var RY=[60,1084,2066,2165,2175];function IY(t,e,r,n,a){var i=n,o=[],u=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}o.push(u),r.l+=i;for(var f=Si(r,r.l),d=rv[f],p=0;d!=null&&RY.indexOf(f)>-1;)i=Si(r,r.l+2),p=r.l+4,f==2066?p+=4:(f==2165||f==2175)&&(p+=12),u=r.slice(p,r.l+4+i),o.push(u),r.l+=4+i,d=rv[f=Si(r,r.l)];var x=gn(o);Sn(x,0);var y=0;x.lens=[];for(var w=0;w<o.length;++w)x.lens.push(y),y+=o[w].length;if(x.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+x.length+" < "+n;return e.f(x,x.length,a)}function Ms(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=lt[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ui[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=b0(t.v):t.w=Yo(t.v):t.w=es(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Pu(lt[n]||String(n))){var a=Mo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Yd(t,e,r){return{v:t,ixfe:e,t:r}}function DY(t,e){var r={opts:{}},n={},a=e.dense?[]:{},i={},o={},u=null,f=[],d="",p={},x,y="",w,b,E,T,I={},R=[],C,z,H=[],X=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},N=function(dt){return dt<8?Bo[dt]:dt<64&&X[dt-8]||Bo[dt]},P=function(dt,rr,sn){var Mt=rr.XF.data;if(!(!Mt||!Mt.patternType||!sn||!sn.cellStyles)){rr.s={},rr.s.patternType=Mt.patternType;var or;(or=k0(N(Mt.icvFore)))&&(rr.s.fgColor={rgb:or}),(or=k0(N(Mt.icvBack)))&&(rr.s.bgColor={rgb:or})}},M=function(dt,rr,sn){if(!(Q>1)&&!(sn.sheetRows&&dt.r>=sn.sheetRows)){if(sn.cellStyles&&rr.XF&&rr.XF.data&&P(dt,rr,sn),delete rr.ixfe,delete rr.XF,x=dt,y=ot(dt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<o.s.r&&(o.s.r=dt.r),dt.c<o.s.c&&(o.s.c=dt.c),dt.r+1>o.e.r&&(o.e.r=dt.r+1),dt.c+1>o.e.c&&(o.e.c=dt.c+1),sn.cellFormula&&rr.f){for(var Mt=0;Mt<R.length;++Mt)if(!(R[Mt][0].s.c>dt.c||R[Mt][0].s.r>dt.r)&&!(R[Mt][0].e.c<dt.c||R[Mt][0].e.r<dt.r)){rr.F=_t(R[Mt][0]),(R[Mt][0].s.c!=dt.c||R[Mt][0].s.r!=dt.r)&&delete rr.f,rr.f&&(rr.f=""+Pn(R[Mt][1],o,dt,ne,j));break}}sn.dense?(a[dt.r]||(a[dt.r]=[]),a[dt.r][dt.c]=rr):a[y]=rr}},j={enc:!1,sbcch:0,snames:[],sharedf:I,arrayf:R,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(j.password=e.password);var B,Se=[],we=[],se=[],oe=[],le=!1,ne=[];ne.SheetNames=j.snames,ne.sharedf=j.sharedf,ne.arrayf=j.arrayf,ne.names=[],ne.XTI=[];var ye=0,Q=0,O=0,Y=[],q=[],te;j.codepage=1200,ys(1200);for(var ce=!1;t.l<t.length-1;){var Te=t.l,Re=t.read_shift(2);if(Re===0&&ye===10)break;var _e=t.l===t.length?0:t.read_shift(2),ke=rv[Re];if(ke&&ke.f){if(e.bookSheets&&ye===133&&Re!==133)break;if(ye=Re,ke.r===2||ke.r==12){var rt=t.read_shift(2);if(_e-=2,!j.enc&&rt!==Re&&((rt&255)<<8|rt>>8)!==Re)throw new Error("rt mismatch: "+rt+"!="+Re);ke.r==12&&(t.l+=10,_e-=10)}var L={};if(Re===10?L=ke.f(t,_e,j):L=IY(Re,ke,t,_e,j),Q==0&&[9,521,1033,2057].indexOf(ye)===-1)continue;switch(Re){case 34:r.opts.Date1904=A.WBProps.date1904=L;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(j.enc||(t.l=0),j.enc=L,!e.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=L;break;case 66:var Xe=Number(L);switch(Xe){case 21010:Xe=1200;break;case 32768:Xe=1e4;break;case 32769:Xe=1252;break}ys(j.codepage=Xe),ce=!0;break;case 317:j.rrtabid=L;break;case 25:j.winlocked=L;break;case 439:r.opts.RefreshAll=L;break;case 12:r.opts.CalcCount=L;break;case 16:r.opts.CalcDelta=L;break;case 17:r.opts.CalcIter=L;break;case 13:r.opts.CalcMode=L;break;case 14:r.opts.CalcPrecision=L;break;case 95:r.opts.CalcSaveRecalc=L;break;case 15:j.CalcRefMode=L;break;case 2211:r.opts.FullCalc=L;break;case 129:L.fDialog&&(a["!type"]="dialog"),L.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),L.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:H.push(L);break;case 430:ne.push([L]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(L);break;case 24:case 536:te={Name:L.Name,Ref:Pn(L.rgce,o,null,ne,j)},L.itab>0&&(te.Sheet=L.itab-1),ne.names.push(te),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(q[L.itab-1]={ref:_t(L.rgce[0][0][1][2])});break;case 22:j.ExternCount=L;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(L),ne.XTI=ne.XTI.concat(L);break;case 2196:if(j.biff<8)break;te!=null&&(te.Comment=L[1]);break;case 18:a["!protect"]=L;break;case 19:L!==0&&j.WTF&&console.error("Password verifier: "+L);break;case 133:i[L.pos]=L,j.snames.push(L.name);break;case 10:{if(--Q)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=_t(o),e.sheetRows&&e.sheetRows<=o.e.r){var Pe=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=_t(o),o.e.r=Pe}o.e.r++,o.e.c++}Se.length>0&&(a["!merges"]=Se),we.length>0&&(a["!objects"]=we),se.length>0&&(a["!cols"]=se),oe.length>0&&(a["!rows"]=oe),A.Sheets.push(F)}d===""?p=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[Re]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),j.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(j.biff=5,ce=!0,ys(j.codepage=28591)),j.biff==8&&L.BIFFVer==0&&L.dt==16&&(j.biff=2),Q++)break;if(a=e.dense?[]:{},j.biff<8&&!ce&&(ce=!0,ys(j.codepage=e.codepage||1252)),j.biff<5||L.BIFFVer==0&&L.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var et={pos:t.l-_e,name:d};i[et.pos]=et,j.snames.push(d)}else d=(i[Te]||{name:""}).name;L.dt==32&&(a["!type"]="chart"),L.dt==64&&(a["!type"]="macro"),Se=[],we=[],j.arrayf=R=[],se=[],oe=[],le=!1,F={Hidden:(i[Te]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[L.r]||[])[L.c]:a[ot({c:L.c,r:L.r})])&&++L.c,C={ixfe:L.ixfe,XF:H[L.ixfe]||{},v:L.val,t:"n"},O>0&&(C.z=Y[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),M({c:L.c,r:L.r},C,e);break;case 5:case 517:C={ixfe:L.ixfe,XF:H[L.ixfe],v:L.val,t:L.t},O>0&&(C.z=Y[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),M({c:L.c,r:L.r},C,e);break;case 638:C={ixfe:L.ixfe,XF:H[L.ixfe],v:L.rknum,t:"n"},O>0&&(C.z=Y[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),M({c:L.c,r:L.r},C,e);break;case 189:for(var We=L.c;We<=L.C;++We){var je=L.rkrec[We-L.c][0];C={ixfe:je,XF:H[je],v:L.rkrec[We-L.c][1],t:"n"},O>0&&(C.z=Y[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),M({c:We,r:L.r},C,e)}break;case 6:case 518:case 1030:{if(L.val=="String"){u=L;break}if(C=Yd(L.val,L.cell.ixfe,L.tt),C.XF=H[C.ixfe],e.cellFormula){var ht=L.formula;if(ht&&ht[0]&&ht[0][0]&&ht[0][0][0]=="PtgExp"){var wt=ht[0][0][1][0],Ft=ht[0][0][1][1],Hr=ot({r:wt,c:Ft});I[Hr]?C.f=""+Pn(L.formula,o,L.cell,ne,j):C.F=((e.dense?(a[wt]||[])[Ft]:a[Hr])||{}).F}else C.f=""+Pn(L.formula,o,L.cell,ne,j)}O>0&&(C.z=Y[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),M(L.cell,C,e),u=L}break;case 7:case 519:if(u)u.val=L,C=Yd(L,u.cell.ixfe,"s"),C.XF=H[C.ixfe],e.cellFormula&&(C.f=""+Pn(u.formula,o,u.cell,ne,j)),O>0&&(C.z=Y[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),M(u.cell,C,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{R.push(L);var ns=ot(L[0].s);if(w=e.dense?(a[L[0].s.r]||[])[L[0].s.c]:a[ns],e.cellFormula&&w){if(!u||!ns||!w)break;w.f=""+Pn(L[1],o,L[0],ne,j),w.F=_t(L[0])}}break;case 1212:{if(!e.cellFormula)break;if(y){if(!u)break;I[ot(u.cell)]=L[0],w=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[ot(u.cell)],(w||{}).f=""+Pn(L[0],o,x,ne,j)}}break;case 253:C=Yd(f[L.isst].t,L.ixfe,"s"),f[L.isst].h&&(C.h=f[L.isst].h),C.XF=H[C.ixfe],O>0&&(C.z=Y[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),M({c:L.c,r:L.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:L.ixfe,XF:H[L.ixfe],t:"z"},O>0&&(C.z=Y[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),M({c:L.c,r:L.r},C,e));break;case 190:if(e.sheetStubs)for(var Gn=L.c;Gn<=L.C;++Gn){var zt=L.ixfe[Gn-L.c];C={ixfe:zt,XF:H[zt],t:"z"},O>0&&(C.z=Y[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),M({c:Gn,r:L.r},C,e)}break;case 214:case 516:case 4:C=Yd(L.val,L.ixfe,"s"),C.XF=H[C.ixfe],O>0&&(C.z=Y[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),M({c:L.c,r:L.r},C,e);break;case 0:case 512:Q===1&&(o=L);break;case 252:f=L;break;case 1054:if(j.biff==4){Y[O++]=L[1];for(var Gr=0;Gr<O+163&&lt[Gr]!=L[1];++Gr);Gr>=163&&Ni(L[1],O+163)}else Ni(L[1],L[0]);break;case 30:{Y[O++]=L;for(var an=0;an<O+163&&lt[an]!=L;++an);an>=163&&Ni(L,O+163)}break;case 229:Se=Se.concat(L);break;case 93:we[L.cmo[0]]=j.lastobj=L;break;case 438:j.lastobj.TxO=L;break;case 127:j.lastobj.ImData=L;break;case 440:for(T=L[0].s.r;T<=L[0].e.r;++T)for(E=L[0].s.c;E<=L[0].e.c;++E)w=e.dense?(a[T]||[])[E]:a[ot({c:E,r:T})],w&&(w.l=L[1]);break;case 2048:for(T=L[0].s.r;T<=L[0].e.r;++T)for(E=L[0].s.c;E<=L[0].e.c;++E)w=e.dense?(a[T]||[])[E]:a[ot({c:E,r:T})],w&&w.l&&(w.l.Tooltip=L[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;w=e.dense?(a[L[0].r]||[])[L[0].c]:a[ot(L[0])];var qn=we[L[2]];w||(e.dense?(a[L[0].r]||(a[L[0].r]=[]),w=a[L[0].r][L[0].c]={t:"z"}):w=a[ot(L[0])]={t:"z"},o.e.r=Math.max(o.e.r,L[0].r),o.s.r=Math.min(o.s.r,L[0].r),o.e.c=Math.max(o.e.c,L[0].c),o.s.c=Math.min(o.s.c,L[0].c)),w.c||(w.c=[]),b={a:L[1],t:qn.TxO.t},w.c.push(b)}break;case 2173:yH(H[L.ixfe],L.ext);break;case 125:{if(!j.cellStyles)break;for(;L.e>=L.s;)se[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},le||(le=!0,Gy(L.w/256)),Yl(se[L.e+1])}break;case 520:{var Xt={};L.level!=null&&(oe[L.r]=Xt,Xt.level=L.level),L.hidden&&(oe[L.r]=Xt,Xt.hidden=!0),L.hpt&&(oe[L.r]=Xt,Xt.hpt=L.hpt,Xt.hpx=Su(L.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||zo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Re]]=L;break;case 161:a["!margins"]||zo(a["!margins"]={}),a["!margins"].header=L.header,a["!margins"].footer=L.footer;break;case 574:L.RTL&&(A.Views[0].RTL=!0);break;case 146:X=L;break;case 2198:B=L;break;case 140:z=L;break;case 442:d?F.CodeName=L||F.name:A.WBProps.CodeName=L||"ThisWorkbook";break}}else ke||console.error("Missing Info for XLS Record 0x"+Re.toString(16)),t.l+=_e}return r.SheetNames=Or(i).sort(function(Fr,dt){return Number(Fr)-Number(dt)}).map(function(Fr){return i[Fr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&q.forEach(function(Fr,dt){r.Sheets[r.SheetNames[dt]]["!autofilter"]=Fr}),r.Strings=f,r.SSF=yr(lt),j.enc&&(r.Encryption=j.enc),B&&(r.Themes=B),r.Metadata={},z!==void 0&&(r.Metadata.Country=z),ne.names.length>0&&(A.Names=ne.names),r.Workbook=A,r}var o0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function OY(t,e,r){var n=at.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=uS(n,$x,o0.DSI);for(var i in a)e[i]=a[i]}catch(d){if(r.WTF)throw d}var o=at.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var u=uS(o,Kx,o0.SI);for(var f in u)e[f]==null&&(e[f]=u[f])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(QC(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function FY(t,e){var r=[],n=[],a=[],i=0,o,u=VT($x,"n"),f=VT(Kx,"n");if(t.Props)for(o=Or(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(u,o[i])?r:Object.prototype.hasOwnProperty.call(f,o[i])?n:a).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=Or(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(u,o[i])?r:Object.prototype.hasOwnProperty.call(f,o[i])?n:a).push([o[i],t.Custprops[o[i]]]);var d=[];for(i=0;i<a.length;++i)aN.indexOf(a[i][0])>-1||KC.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);n.length&&at.utils.cfb_add(e,"/SummaryInformation",fS(n,o0.SI,f,Kx)),(r.length||d.length)&&at.utils.cfb_add(e,"/DocumentSummaryInformation",fS(r,o0.DSI,u,$x,d.length?d:null,o0.UDI))}function ZN(t,e){e||(e={}),Zy(e),_y(),e.codepage&&yy(e.codepage);var r,n;if(t.FullPaths){if(at.find(t,"/encryption"))throw new Error("File is password-protected");r=at.find(t,"!CompObj"),n=at.find(t,"/Workbook")||at.find(t,"/Book")}else{switch(e.type){case"base64":t=ka(Ia(t));break;case"binary":t=ka(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Sn(t,0),n={content:t}}var a,i;if(r&&NY(r),e.bookProps&&!e.bookSheets)a={};else{var o=Tt?"buffer":"array";if(n&&n.content)a=DY(n.content,e);else if((i=at.find(t,"PerfectOffice_MAIN"))&&i.content)a=Uo.to_workbook(i.content,(e.type=o,e));else if((i=at.find(t,"NativeContent_MAIN"))&&i.content)a=Uo.to_workbook(i.content,(e.type=o,e));else throw(i=at.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&at.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=XH(t))}var u={};return t.FullPaths&&OY(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}function MY(t,e){var r=e||{},n=at.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return at.utils.cfb_add(n,a,e3(t,r)),r.biff==8&&(t.Props||t.Custprops)&&FY(t,n),r.biff==8&&t.vbaraw&&YH(n,at.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var I0={0:{f:sW},1:{f:dW},2:{f:DW},3:{f:wW},4:{f:xW},5:{f:NW},6:{f:jW},7:{f:SW},8:{f:GW},9:{f:HW},10:{f:UW},11:{f:zW},12:{f:pW},13:{f:FW},14:{f:EW},15:{f:yW},16:{f:qN},17:{f:BW},18:{f:kW},19:{f:Fy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:BX},40:{},42:{},43:{f:jz},44:{f:Mz},45:{f:Vz},46:{f:zz},47:{f:Uz},48:{},49:{f:oB},50:{},51:{f:bH},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:pN},62:{f:PW},63:{f:IH},64:{f:iX},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:zn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:rX},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:fW},148:{f:oW,p:16},151:{f:KW},152:{},153:{f:PX},154:{},155:{},156:{f:FX},157:{},158:{},159:{T:1,f:JU},160:{T:-1},161:{T:1,f:lc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_H},336:{T:-1},337:{f:SH,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Yx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:mN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:QW},427:{f:JW},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:eX},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:uW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:YW},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Yx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zH},633:{T:1},634:{T:-1},635:{T:1,f:VH},636:{T:-1},637:{f:hB},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:EX},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:lX},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},rv={6:{f:nx},10:{f:wl},12:{f:en},13:{f:en},14:{f:Lr},15:{f:Lr},16:{f:Bn},17:{f:Lr},18:{f:Lr},19:{f:en},20:{f:xS},21:{f:xS},23:{f:mN},24:{f:yS},25:{f:Lr},26:{},27:{},28:{f:lU},29:{},34:{f:Lr},35:{f:vS},38:{f:Bn},39:{f:Bn},40:{f:Bn},41:{f:Bn},42:{f:Lr},43:{f:Lr},47:{f:yz},49:{f:FV},51:{f:en},60:{},61:{f:NV},64:{f:Lr},65:{f:OV},66:{f:en},77:{},80:{},81:{},82:{},85:{f:en},89:{},90:{},91:{},92:{f:vV},93:{f:uU},94:{},95:{f:Lr},96:{},97:{},99:{f:Lr},125:{f:pN},128:{f:$V},129:{f:_V},130:{f:en},131:{f:Lr},132:{f:Lr},133:{f:wV},134:{},140:{f:vU},141:{f:en},144:{},146:{f:wU},151:{},152:{},153:{},154:{},155:{},156:{f:en},157:{},158:{},160:{f:CU},161:{f:TU},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:qV},190:{f:WV},193:{f:wl},197:{},198:{},199:{},200:{},201:{},202:{f:Lr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:en},220:{},221:{f:Lr},222:{},224:{f:YV},225:{f:xV},226:{f:wl},227:{},229:{f:oU},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:EV},253:{f:PV},255:{f:SV},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:sN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Lr},353:{f:wl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:eU},431:{f:Lr},432:{},433:{},434:{},437:{},438:{f:dU},439:{f:Lr},440:{f:mU},441:{},442:{f:sh},443:{},444:{f:en},445:{},446:{},448:{f:wl},449:{f:CV,r:2},450:{f:wl},512:{f:mS},513:{f:kU},515:{f:JV},516:{f:LV},517:{f:gS},519:{f:NU},520:{f:AV},523:{},545:{f:_S},549:{f:dS},566:{},574:{f:IV},638:{f:GV},659:{},1048:{},1054:{f:VV},1084:{},1212:{f:aU},2048:{f:gU},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:qd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:wl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:bU,r:12},2173:{f:vH,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Lr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:nU,r:12},2197:{},2198:{f:hH,r:12},2199:{},2200:{},2201:{},2202:{f:sU,r:12},2203:{f:wl},2204:{},2205:{},2206:{},2207:{},2211:{f:kV},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:en},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:SU},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_U},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:mS},1:{},2:{f:FU},3:{f:DU},4:{f:IU},5:{f:gS},7:{f:PU},8:{},9:{f:qd},11:{},22:{f:en},30:{f:zV},31:{},32:{},33:{f:_S},36:{},37:{f:dS},50:{f:jU},62:{},52:{},67:{},68:{f:en},69:{},86:{},126:{},127:{f:RU},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:LU},223:{},234:{},354:{},421:{},518:{f:nx},521:{f:qd},536:{f:yS},547:{f:vS},561:{},579:{},1030:{f:nx},1033:{f:qd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ze(t,e,r,n){var a=e;if(!isNaN(a)){var i=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&Iy(r)&&t.push(r)}}function PY(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return ze(t,e,r,a);var i=e;if(!isNaN(i)){for(var o=r.parts||[],u=0,f=0,d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;var p=t.next(4);for(p.write_shift(2,i),p.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d;f<a;){for(p=t.next(4),p.write_shift(2,60),d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;p.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d}}}function ch(t,e,r){return t||(t=Ae(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function jY(t,e,r,n){var a=Ae(9);return ch(a,t,e),iN(r,n||"b",a),a}function LY(t,e,r){var n=Ae(8+2*r.length);return ch(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function BY(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?fn(vr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?ze(t,2,MU(r,n,a)):ze(t,3,OU(r,n,a));return;case"b":case"e":ze(t,5,jY(r,n,e.v,e.t));return;case"s":case"str":ze(t,4,LY(r,n,(e.v||"").slice(0,255)));return}ze(t,1,ch(null,r,n))}function VY(t,e,r,n){var a=Array.isArray(e),i=Lt(e["!ref"]||"A1"),o,u="",f=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=_t(i)}for(var d=i.s.r;d<=i.e.r;++d){u=Ur(d);for(var p=i.s.c;p<=i.e.c;++p){d===i.s.r&&(f[p]=Tr(p)),o=f[p]+u;var x=a?(e[d]||[])[p]:e[o];x&&BY(t,x,d,p)}}}function UY(t,e){for(var r=e||{},n=ha(),a=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ze(n,r.biff==4?1033:r.biff==3?521:9,Uy(t,16,r)),VY(n,t.Sheets[t.SheetNames[a]],a,r),ze(n,10),n.end()}function zY(t,e,r){ze(t,49,MV({sz:12,name:"Arial"},r))}function HY(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&ze(t,1054,UV(a,e[a],r))})}function GY(t,e){var r=Ae(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ze(t,2151,r),r=Ae(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),fN(Lt(e["!ref"]||"A1"),r),r.write_shift(4,4),ze(t,2152,r)}function qY(t,e){for(var r=0;r<16;++r)ze(t,224,pS({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ze(t,224,pS(n,0,e))})}function WY(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];ze(t,440,pU(n)),n[1].Tooltip&&ze(t,2048,xU(n))}delete e["!links"]}function XY(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&ze(t,125,EU(Ip(a,n),a))})}}function YY(t,e,r,n,a){var i=16+ao(a.cellXfs,e,a);if(e.v==null&&!e.bf){ze(t,513,Jo(r,n,i));return}if(e.bf)ze(t,6,_q(e,r,n,a,i));else switch(e.t){case"d":case"n":var o=e.t=="d"?fn(vr(e.v)):e.v;ze(t,515,ZV(r,n,o,i));break;case"b":case"e":ze(t,517,QV(r,n,e.v,i,a,e.t));break;case"s":case"str":if(a.bookSST){var u=$y(a.Strings,e.v,a.revStrings);ze(t,253,jV(r,n,u,i))}else ze(t,516,BV(r,n,(e.v||"").slice(0,255),i,a));break;default:ze(t,513,Jo(r,n,i))}}function $Y(t,e,r){var n=ha(),a=r.SheetNames[t],i=r.Sheets[a]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[t]||{},f=Array.isArray(i),d=e.biff==8,p,x="",y=[],w=Lt(i["!ref"]||"A1"),b=d?65536:16384;if(w.e.c>255||w.e.r>=b){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");w.e.c=Math.min(w.e.c,255),w.e.r=Math.min(w.e.c,b-1)}ze(n,2057,Uy(r,16,e)),ze(n,13,Ka(1)),ze(n,12,Ka(100)),ze(n,15,Kn(!0)),ze(n,17,Kn(!1)),ze(n,16,Ko(.001)),ze(n,95,Kn(!0)),ze(n,42,Kn(!1)),ze(n,43,Kn(!1)),ze(n,130,Ka(1)),ze(n,128,KV()),ze(n,131,Kn(!1)),ze(n,132,Kn(!1)),d&&XY(n,i["!cols"]),ze(n,512,HV(w,e)),d&&(i["!links"]=[]);for(var E=w.s.r;E<=w.e.r;++E){x=Ur(E);for(var T=w.s.c;T<=w.e.c;++T){E===w.s.r&&(y[T]=Tr(T)),p=y[T]+x;var I=f?(i[E]||[])[T]:i[p];I&&(YY(n,I,E,T,e),d&&I.l&&i["!links"].push([p,I.l]))}}var R=u.CodeName||u.name||a;return d&&ze(n,574,DV((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&ze(n,229,cU(i["!merges"])),d&&WY(n,i),ze(n,442,lN(R)),d&&GY(n,i),ze(n,10),n.end()}function KY(t,e,r){var n=ha(),a=(t||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},u=r.biff==8,f=r.biff==5;if(ze(n,2057,Uy(t,5,r)),r.bookType=="xla"&&ze(n,135),ze(n,225,u?Ka(1200):null),ze(n,193,QB(2)),f&&ze(n,191),f&&ze(n,192),ze(n,226),ze(n,92,yV("SheetJS",r)),ze(n,66,Ka(u?1200:1252)),u&&ze(n,353,Ka(0)),u&&ze(n,448),ze(n,317,AU(t.SheetNames.length)),u&&t.vbaraw&&ze(n,211),u&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";ze(n,442,lN(d))}ze(n,156,Ka(17)),ze(n,25,Kn(!1)),ze(n,18,Kn(!1)),ze(n,19,Ka(0)),u&&ze(n,431,Kn(!1)),u&&ze(n,444,Ka(0)),ze(n,61,RV()),ze(n,64,Kn(!1)),ze(n,141,Ka(0)),ze(n,34,Kn(CX(t)=="true")),ze(n,14,Kn(!0)),u&&ze(n,439,Kn(!1)),ze(n,218,Ka(0)),zY(n,t,r),HY(n,t.SSF,r),qY(n,r),u&&ze(n,352,Kn(!1));var p=n.end(),x=ha();u&&ze(x,140,yU()),u&&r.Strings&&PY(x,252,TV(r.Strings)),ze(x,10);var y=x.end(),w=ha(),b=0,E=0;for(E=0;E<t.SheetNames.length;++E)b+=(u?12:11)+(u?2:1)*t.SheetNames[E].length;var T=p.length+b+y.length;for(E=0;E<t.SheetNames.length;++E){var I=i[E]||{};ze(w,133,bV({pos:T,hs:I.Hidden||0,dt:0,name:t.SheetNames[E]},r)),T+=e[E].length}var R=w.end();if(b!=R.length)throw new Error("BS8 "+b+" != "+R.length);var C=[];return p.length&&C.push(p),R.length&&C.push(R),y.length&&C.push(y),gn(C)}function QY(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=yr(lt)),t&&t.SSF&&(ju(),Tp(t.SSF),r.revssf=Ap(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,e_(r),r.cellXfs=[],ao(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=$Y(a,r,t);return n.unshift(KY(t,n,r)),gn(n)}function e3(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=da(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return QY(t,e);case 4:case 3:case 2:return UY(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function RS(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),o=a.index,u=i&&i.index||t.length,f=M7(t.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,p=0,x=0,y=0,w={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(o=0;o<f.length;++o){var E=f[o].trim(),T=E.slice(0,3).toLowerCase();if(T=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}p=0;continue}if(!(T!="<td"&&T!="<th")){var I=E.split(/<\/t[dh]>/i);for(u=0;u<I.length;++u){var R=I[u].trim();if(R.match(/<t[dh]/i)){for(var C=R,z=0;C.charAt(0)=="<"&&(z=C.indexOf(">"))>-1;)C=C.slice(z+1);for(var H=0;H<b.length;++H){var X=b[H];X.s.c==p&&X.s.r<d&&d<=X.e.r&&(p=X.e.c+1,H=-1)}var A=ut(R.slice(0,R.indexOf(">")));y=A.colspan?+A.colspan:1,((x=+A.rowspan)>1||y>1)&&b.push({s:{r:d,c:p},e:{r:d+(x||1)-1,c:p+y-1}});var F=A.t||A["data-t"]||"";if(!C.length){p+=y;continue}if(C=TC(C),w.s.r>d&&(w.s.r=d),w.e.r<d&&(w.e.r=d),w.s.c>p&&(w.s.c=p),w.e.c<p&&(w.e.c=p),!C.length){p+=y;continue}var N={t:"s",v:C};r.raw||!C.trim().length||F=="s"||(C==="TRUE"?N={t:"b",v:!0}:C==="FALSE"?N={t:"b",v:!1}:isNaN(ws(C))?isNaN(Eu(C).getDate())||(N={t:"d",v:vr(C)},r.cellDates||(N={t:"n",v:fn(N.v)}),N.z=r.dateNF||lt[14]):N={t:"n",v:ws(C)}),r.dense?(n[d]||(n[d]=[]),n[d][p]=N):n[ot({r:d,c:p})]=N,p+=y}}}}return n["!ref"]=_t(w),b.length&&(n["!merges"]=b),n}function JY(t,e,r,n){for(var a=t["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var u=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>o)&&!(a[d].e.r<r||a[d].e.c<o)){if(a[d].s.r<r||a[d].s.c<o){u=-1;break}u=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(u<0)){var p=ot({r,c:o}),x=n.dense?(t[r]||[])[o]:t[p],y=x&&x.v!=null&&(x.h||Cy(x.w||(ji(x),x.w)||""))||"",w={};u>1&&(w.rowspan=u),f>1&&(w.colspan=f),n.editable?y='<span contenteditable="true">'+y+"</span>":x&&(w["data-t"]=x&&x.t||"z",x.v!=null&&(w["data-v"]=x.v),x.z!=null&&(w["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+x.l.Target+'">'+y+"</a>")),w.id=(n.id||"sjs")+"-"+p,i.push(Ue("td",y,w))}}var b="<tr>";return b+i.join("")+"</tr>"}var ZY='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',e$="</body></html>";function t$(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return no(RS(r[0],e),e);var n=n_();return r.forEach(function(a,i){a_(n,RS(a,e),"Sheet"+(i+1))}),n}function r$(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function t3(t,e){var r=e||{},n=r.header!=null?r.header:ZY,a=r.footer!=null?r.footer:e$,i=[n],o=da(t["!ref"]);r.dense=Array.isArray(t),i.push(r$(t,o,r));for(var u=o.s.r;u<=o.e.r;++u)i.push(JY(t,o,u,r));return i.push("</table>"+a),i.join("")}function r3(t,e,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Sr(n.origin):n.origin;a=o.r,i=o.c}var u=e.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var p=da(t["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),a==-1&&(d.e.r=a=p.e.r+1)}var x=[],y=0,w=t["!rows"]||(t["!rows"]=[]),b=0,E=0,T=0,I=0,R=0,C=0;for(t["!cols"]||(t["!cols"]=[]);b<u.length&&E<f;++b){var z=u[b];if(IS(z)){if(n.display)continue;w[E]={hidden:!0}}var H=z.children;for(T=I=0;T<H.length;++T){var X=H[T];if(!(n.display&&IS(X))){var A=X.hasAttribute("data-v")?X.getAttribute("data-v"):X.hasAttribute("v")?X.getAttribute("v"):TC(X.innerHTML),F=X.getAttribute("data-z")||X.getAttribute("z");for(y=0;y<x.length;++y){var N=x[y];N.s.c==I+i&&N.s.r<E+a&&E+a<=N.e.r&&(I=N.e.c+1-i,y=-1)}C=+X.getAttribute("colspan")||1,((R=+X.getAttribute("rowspan")||1)>1||C>1)&&x.push({s:{r:E+a,c:I+i},e:{r:E+a+(R||1)-1,c:I+i+(C||1)-1}});var P={t:"s",v:A},M=X.getAttribute("data-t")||X.getAttribute("t")||"";A!=null&&(A.length==0?P.t=M||"z":n.raw||A.trim().length==0||M=="s"||(A==="TRUE"?P={t:"b",v:!0}:A==="FALSE"?P={t:"b",v:!1}:isNaN(ws(A))?isNaN(Eu(A).getDate())||(P={t:"d",v:vr(A)},n.cellDates||(P={t:"n",v:fn(P.v)}),P.z=n.dateNF||lt[14]):P={t:"n",v:ws(A)})),P.z===void 0&&F!=null&&(P.z=F);var j="",B=X.getElementsByTagName("A");if(B&&B.length)for(var Se=0;Se<B.length&&!(B[Se].hasAttribute("href")&&(j=B[Se].getAttribute("href"),j.charAt(0)!="#"));++Se);j&&j.charAt(0)!="#"&&(P.l={Target:j}),n.dense?(t[E+a]||(t[E+a]=[]),t[E+a][I+i]=P):t[ot({c:I+i,r:E+a})]=P,d.e.c<I+i&&(d.e.c=I+i),I+=C}}++E}return x.length&&(t["!merges"]=(t["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,E-1+a),t["!ref"]=_t(d),E>=f&&(t["!fullref"]=_t((d.e.r=u.length-b+E-1+a,d))),t}function n3(t,e){var r=e||{},n=r.dense?[]:{};return r3(n,t,e)}function n$(t,e){return no(n3(t,e),e)}function IS(t){var e="",r=a$(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function a$(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function s$(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=jt(e.replace(/<[^>]*>/g,""));return[r]}var DS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function a3(t,e){var r=e||{},n=Ny(t),a=[],i,o,u={name:""},f="",d=0,p,x,y={},w=[],b=r.dense?[]:{},E,T,I={value:""},R="",C=0,z=[],H=-1,X=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,N={},P=[],M={},j=0,B=0,Se=[],we=1,se=1,oe=[],le={Names:[]},ne={},ye=["",""],Q=[],O={},Y="",q=0,te=!1,ce=!1,Te=0;for(S0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");E=S0.exec(n);)switch(E[3]=E[3].replace(/_.*$/,"")){case"table":case"":E[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?b["!ref"]=_t(A):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(b["!fullref"]=b["!ref"],A.e.r=r.sheetRows-1,b["!ref"]=_t(A)),P.length&&(b["!merges"]=P),Se.length&&(b["!rows"]=Se),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),w.push(p.name),y[p.name]=b,ce=!1):E[0].charAt(E[0].length-2)!=="/"&&(p=ut(E[0],!1),H=X=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,b=r.dense?[]:{},P=[],Se=[],ce=!0);break;case"table-row-group":E[1]==="/"?--F:++F;break;case"table-row":case"":if(E[1]==="/"){H+=we,we=1;break}if(x=ut(E[0],!1),x.?H=x.-1:H==-1&&(H=0),we=+x["number-rows-repeated"]||1,we<10)for(Te=0;Te<we;++Te)F>0&&(Se[H+Te]={level:F});X=-1;break;case"covered-table-cell":E[1]!=="/"&&++X,r.sheetStubs&&(r.dense?(b[H]||(b[H]=[]),b[H][X]={t:"z"}):b[ot({r:H,c:X})]={t:"z"}),R="",z=[];break;case"table-cell":case"":if(E[0].charAt(E[0].length-2)==="/")++X,I=ut(E[0],!1),se=parseInt(I["number-columns-repeated"]||"1",10),T={t:"z",v:null},I.formula&&r.cellFormula!=!1&&(T.f=kS(jt(I.formula))),(I.||I["value-type"])=="string"&&(T.t="s",T.v=jt(I["string-value"]||""),r.dense?(b[H]||(b[H]=[]),b[H][X]=T):b[ot({r:H,c:X})]=T),X+=se-1;else if(E[1]!=="/"){++X,R="",C=0,z=[],se=1;var Re=we?H+we-1:H;if(X>A.e.c&&(A.e.c=X),X<A.s.c&&(A.s.c=X),H<A.s.r&&(A.s.r=H),Re>A.e.r&&(A.e.r=Re),I=ut(E[0],!1),Q=[],O={},T={t:I.||I["value-type"],v:null},r.cellFormula)if(I.formula&&(I.formula=jt(I.formula)),I["number-matrix-columns-spanned"]&&I["number-matrix-rows-spanned"]&&(j=parseInt(I["number-matrix-rows-spanned"],10)||0,B=parseInt(I["number-matrix-columns-spanned"],10)||0,M={s:{r:H,c:X},e:{r:H+j-1,c:X+B-1}},T.F=_t(M),oe.push([M,T.F])),I.formula)T.f=kS(I.formula);else for(Te=0;Te<oe.length;++Te)H>=oe[Te][0].s.r&&H<=oe[Te][0].e.r&&X>=oe[Te][0].s.c&&X<=oe[Te][0].e.c&&(T.F=oe[Te][1]);switch((I["number-columns-spanned"]||I["number-rows-spanned"])&&(j=parseInt(I["number-rows-spanned"],10)||0,B=parseInt(I["number-columns-spanned"],10)||0,M={s:{r:H,c:X},e:{r:H+j-1,c:X+B-1}},P.push(M)),I["number-columns-repeated"]&&(se=parseInt(I["number-columns-repeated"],10)),T.t){case"boolean":T.t="b",T.v=gr(I["boolean-value"]);break;case"float":T.t="n",T.v=parseFloat(I.value);break;case"percentage":T.t="n",T.v=parseFloat(I.value);break;case"currency":T.t="n",T.v=parseFloat(I.value);break;case"date":T.t="d",T.v=vr(I["date-value"]),r.cellDates||(T.t="n",T.v=fn(T.v)),T.z="m/d/yy";break;case"time":T.t="n",T.v=D7(I["time-value"])/86400,r.cellDates&&(T.t="d",T.v=kp(T.v)),T.z="HH:MM:SS";break;case"number":T.t="n",T.v=parseFloat(I.);break;default:if(T.t==="string"||T.t==="text"||!T.t)T.t="s",I["string-value"]!=null&&(R=jt(I["string-value"]),z=[]);else throw new Error("Unsupported value type "+T.t)}}else{if(te=!1,T.t==="s"&&(T.v=R||"",z.length&&(T.R=z),te=C==0),ne.Target&&(T.l=ne),Q.length>0&&(T.c=Q,Q=[]),R&&r.cellText!==!1&&(T.w=R),te&&(T.t="z",delete T.v),(!te||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=H))for(var _e=0;_e<we;++_e){if(se=parseInt(I["number-columns-repeated"]||"1",10),r.dense)for(b[H+_e]||(b[H+_e]=[]),b[H+_e][X]=_e==0?T:yr(T);--se>0;)b[H+_e][X+se]=yr(T);else for(b[ot({r:H+_e,c:X})]=T;--se>0;)b[ot({r:H+_e,c:X+se})]=yr(T);A.e.c<=X&&(A.e.c=X)}se=parseInt(I["number-columns-repeated"]||"1",10),X+=se-1,se=0,T={},R="",z=[]}ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((i=a.pop())[0]!==E[3])throw"Bad state: "+i}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((i=a.pop())[0]!==E[3])throw"Bad state: "+i;O.t=R,z.length&&(O.R=z),O.a=Y,Q.push(O)}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!1]);Y="",q=0,R="",C=0,z=[];break;case"creator":E[1]==="/"?Y=n.slice(q,E.index):q=E.index+E[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((i=a.pop())[0]!==E[3])throw"Bad state: "+i}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!1]);R="",C=0,z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){if(N[u.name]=f,(i=a.pop())[0]!==E[3])throw"Bad state: "+i}else E[0].charAt(E[0].length-2)!=="/"&&(f="",u=ut(E[0],!1),a.push([E[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=ut(E[0],!1),f+=DS[E[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=ut(E[0],!1),f+=DS[E[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,E.index);break}else d=E.index+E[0].length;break;case"named-range":o=ut(E[0],!1),ye=ax(o["cell-range-address"]);var ke={Name:o.name,Ref:ye[0]+"!"+ye[1]};ce&&(ke.Sheet=w.length),le.Names.push(ke);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(E[1]==="/"&&(!I||!I["string-value"])){var rt=s$(n.slice(C,E.index));R=(R.length>0?R+`
`:"")+rt[0]}else ut(E[0],!1),C=E.index+E[0].length;break;case"s":break;case"database-range":if(E[1]==="/")break;try{ye=ax(ut(E[0])["target-range-address"]),y[ye[0]]["!autofilter"]={ref:ye[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(ne=ut(E[0],!1),!ne.href)break;ne.Target=jt(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(ye=ax(ne.Target.slice(1)),ne.Target="#"+ye[0]+"!"+ye[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(E)}}var L={Sheets:y,SheetNames:w,Workbook:le};return r.bookSheets&&delete L.Sheets,L}function OS(t,e){e=e||{},$a(t,"META-INF/manifest.xml")&&DB(Zr(t,"META-INF/manifest.xml"),e);var r=Ca(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=a3(lr(r),e);return $a(t,"meta.xml")&&(n.Props=YC(Zr(t,"meta.xml"))),n}function FS(t,e){return a3(t,e)}var i$=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+T0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return zr+e}})(),MS=(function(){var t=function(i){return tr(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,u){var f=[];f.push('      <table:table table:name="'+tr(o.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,p=0,x=da(i["!ref"]||"A1"),y=i["!merges"]||[],w=0,b=Array.isArray(i);if(i["!cols"])for(p=0;p<=x.e.c;++p)f.push("        <table:table-column"+(i["!cols"][p]?' table:style-name="co'+i["!cols"][p].ods+'"':"")+`></table:table-column>
`);var E="",T=i["!rows"]||[];for(d=0;d<x.s.r;++d)E=T[d]?' table:style-name="ro'+T[d].ods+'"':"",f.push("        <table:table-row"+E+`></table:table-row>
`);for(;d<=x.e.r;++d){for(E=T[d]?' table:style-name="ro'+T[d].ods+'"':"",f.push("        <table:table-row"+E+`>
`),p=0;p<x.s.c;++p)f.push(e);for(;p<=x.e.c;++p){var I=!1,R={},C="";for(w=0;w!=y.length;++w)if(!(y[w].s.c>p)&&!(y[w].s.r>d)&&!(y[w].e.c<p)&&!(y[w].e.r<d)){(y[w].s.c!=p||y[w].s.r!=d)&&(I=!0),R["table:number-columns-spanned"]=y[w].e.c-y[w].s.c+1,R["table:number-rows-spanned"]=y[w].e.r-y[w].s.r+1;break}if(I){f.push(r);continue}var z=ot({r:d,c:p}),H=b?(i[d]||[])[p]:i[z];if(H&&H.f&&(R["table:formula"]=tr(Aq(H.f)),H.F&&H.F.slice(0,z.length)==z)){var X=da(H.F);R["table:number-matrix-columns-spanned"]=X.e.c-X.s.c+1,R["table:number-matrix-rows-spanned"]=X.e.r-X.s.r+1}if(!H){f.push(e);continue}switch(H.t){case"b":C=H.v?"TRUE":"FALSE",R["office:value-type"]="boolean",R["office:boolean-value"]=H.v?"true":"false";break;case"n":C=H.w||String(H.v||0),R["office:value-type"]="float",R["office:value"]=H.v||0;break;case"s":case"str":C=H.v==null?"":H.v,R["office:value-type"]="string";break;case"d":C=H.w||vr(H.v).toISOString(),R["office:value-type"]="date",R["office:date-value"]=vr(H.v).toISOString(),R["table:style-name"]="ce1";break;default:f.push(e);continue}var A=t(C);if(H.l&&H.l.Target){var F=H.l.Target;F=F.charAt(0)=="#"?"#"+kq(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),A=Ue("text:a",A,{"xlink:href":F.replace(/&/g,"&amp;")})}f.push("          "+Ue("table:table-cell",Ue("text:p",A,{}),R)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var x=d["!cols"][p];if(x.width==null&&x.wpx==null&&x.wch==null)continue;Yl(x),x.ods=u;var y=d["!cols"][p].wpx+"px";i.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),i.push(`  </style:style>
`),++u}}});var f=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=f;var x=d["!rows"][p].hpx+"px";i.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),i.push(`  </style:style>
`),++f}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,u){var f=[zr],d=T0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=T0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+d+p+`>
`),f.push(XC().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,o),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)f.push(n(o.Sheets[o.SheetNames[x]],o,x));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function s3(t,e){if(e.bookType=="fods")return MS(t,e);var r=Sy(),n="",a=[],i=[];return n="mimetype",Et(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Et(r,n,MS(t,e)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Et(r,n,i$(t,e)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Et(r,n,zr+XC()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Et(r,n,MB(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Et(r,n,OB(a)),r}function Zo(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function nv(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):lr(ro(t))}function l$(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):ka(Bs(t))}function o$(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Kl(t){var e=t.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function PS(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function c$(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function u$(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)t[e+i]=a&255;t[e+15]|=r>=0?0:128}function D0(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Zt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Dr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ut(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=D0(t,r),i=a&7;a=Math.floor(a/8);var o=0,u;if(a==0)break;switch(i){case 0:{for(var f=r[0];t[r[0]++]>=128;);u=t.slice(f,r[0])}break;case 5:o=4,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=D0(t,r),u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:i};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function En(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(Zt(n*8+a.type)),a.type==2&&e.push(Zt(a.data.length)),e.push(a.data))})}),Kl(e)}function Jy(t,e){return t?.map(function(r){return e(r.data)})||[]}function Xa(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=D0(t,n),i=Ut(t.slice(n[0],n[0]+a));n[0]+=a;var o={id:Dr(i[1][0].data),messages:[]};i[2].forEach(function(u){var f=Ut(u.data),d=Dr(f[3][0].data);o.messages.push({meta:f,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=i[3])!=null&&e[0]&&(o.merge=Dr(i[3][0].data)>>>0>0),r.push(o)}return r}function $c(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Zt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Zt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Zt(o.data.length)}],n[2].push({data:En(o.meta),type:2})});var i=En(n);e.push(Zt(i.length)),e.push(i),a.forEach(function(o){return e.push(o)})}),Kl(e)}function f$(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=D0(e,r),a=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=e[r[0]],u>1&&(o|=e[r[0]+1]<<8),u>2&&(o|=e[r[0]+2]<<16),u>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}a.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var f=0,d=0;if(i==1?(d=(e[r[0]]>>2&7)+4,f=(e[r[0]++]&224)<<3,f|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,i==2?(f=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(f=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Kl(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var p=Kl(a);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function Ya(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(f$(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Kl(e)}function Kc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var i=Zt(n),o=i.length;e.push(i),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Kl(e)}function h$(t,e,r,n){var a=Zo(t),i=a.getUint32(4,!0),o=(n>1?12:8)+PS(i&(n>1?3470:398))*4,u=-1,f=-1,d=NaN,p=new Date(2001,0,1);i&512&&(u=a.getUint32(o,!0),o+=4),o+=PS(i&(n>1?12288:4096))*4,i&16&&(f=a.getUint32(o,!0),o+=4),i&32&&(d=a.getFloat64(o,!0),o+=8),i&64&&(p.setTime(p.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var x;switch(t[2]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:e[f]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(f>-1)x={t:"s",v:e[f]};else if(!isNaN(d))x={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return x}function d$(t,e,r){var n=Zo(t),a=n.getUint32(8,!0),i=12,o=-1,u=-1,f=NaN,d=NaN,p=new Date(2001,0,1);a&1&&(f=c$(t,i),i+=16),a&2&&(d=n.getFloat64(i,!0),i+=8),a&4&&(p.setTime(p.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(u=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var x;switch(t[1]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:e[u]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(o>-1)x={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:x={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return x}function ix(t,e){var r=new Uint8Array(32),n=Zo(r),a=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,u$(r,a,t.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),i|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,a)}function lx(t,e){var r=new Uint8Array(32),n=Zo(r),a=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),i|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,a)}function m$(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return h$(t,e,r,t[0]);case 5:return d$(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Mn(t){var e=Ut(t);return D0(e[1][0].data)}function jS(t,e){var r=Ut(e.data),n=Dr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var u=Ut(o.data),f=Dr(u[1][0].data)>>>0;switch(n){case 1:i[f]=nv(u[3][0].data);break;case 8:{var d=t[Mn(u[9][0].data)][0],p=Ut(d.data),x=t[Mn(p[1][0].data)][0],y=Dr(x.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var w=Ut(x.data);i[f]=w[3].map(function(b){return nv(b.data)}).join("")}break}}),i}function p$(t,e){var r,n,a,i,o,u,f,d,p,x,y,w,b,E,T=Ut(t),I=Dr(T[1][0].data)>>>0,R=Dr(T[2][0].data)>>>0,C=((n=(r=T[8])==null?void 0:r[0])==null?void 0:n.data)&&Dr(T[8][0].data)>0||!1,z,H;if((i=(a=T[7])==null?void 0:a[0])!=null&&i.data&&e!=0)z=(u=(o=T[7])==null?void 0:o[0])==null?void 0:u.data,H=(d=(f=T[6])==null?void 0:f[0])==null?void 0:d.data;else if((x=(p=T[4])==null?void 0:p[0])!=null&&x.data&&e!=1)z=(w=(y=T[4])==null?void 0:y[0])==null?void 0:w.data,H=(E=(b=T[3])==null?void 0:b[0])==null?void 0:E.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var X=C?4:1,A=Zo(z),F=[],N=0;N<z.length/2;++N){var P=A.getUint16(N*2,!0);P<65535&&F.push([N,P])}if(F.length!=R)throw"Expected ".concat(R," cells, found ").concat(F.length);var M=[];for(N=0;N<F.length-1;++N)M[F[N][0]]=H.subarray(F[N][1]*X,F[N+1][1]*X);return F.length>=1&&(M[F[F.length-1][0]]=H.subarray(F[F.length-1][1]*X)),{R:I,cells:M}}function g$(t,e){var r,n=Ut(e.data),a=(r=n?.[7])!=null&&r[0]?Dr(n[7][0].data)>>>0>0?1:0:-1,i=Jy(n[5],function(o){return p$(o,a)});return{nrows:Dr(n[4][0].data)>>>0,data:i.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(f,d){if(o[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));o[u.R][d]=f}),o},[])}}function x$(t,e,r){var n,a=Ut(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Dr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Dr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=_t(i);var o=Ut(a[4][0].data),u=jS(t,t[Mn(o[4][0].data)][0]),f=(n=o[17])!=null&&n[0]?jS(t,t[Mn(o[17][0].data)][0]):[],d=Ut(o[3][0].data),p=0;d[1].forEach(function(x){var y=Ut(x.data),w=t[Mn(y[2][0].data)][0],b=Dr(w.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var E=g$(t,w);E.data.forEach(function(T,I){T.forEach(function(R,C){var z=ot({r:p+I,c:C}),H=m$(R,u,f);H&&(r[z]=H)})}),p+=E.nrows})}function v$(t,e){var r=Ut(e.data),n={"!ref":"A1"},a=t[Mn(r[2][0].data)],i=Dr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return x$(t,a[0],n),n}function y$(t,e){var r,n=Ut(e.data),a={name:(r=n[1])!=null&&r[0]?nv(n[1][0].data):"",sheets:[]},i=Jy(n[2],Mn);return i.forEach(function(o){t[o].forEach(function(u){var f=Dr(u.meta[1][0].data);f==6e3&&a.sheets.push(v$(t,u))})}),a}function _$(t,e){var r=n_(),n=Ut(e.data),a=Jy(n[1],Mn);if(a.forEach(function(i){t[i].forEach(function(o){var u=Dr(o.meta[1][0].data);if(u==2){var f=y$(t,o);f.sheets.forEach(function(d,p){a_(r,d,p==0?f.name:f.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ox(t){var e,r,n,a,i={},o=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=Ya(f.content)}catch(x){return console.log("?? "+f.content.length+" "+(x.message||x))}var p;try{p=Xa(d)}catch(x){return console.log("## "+(x.message||x))}p.forEach(function(x){i[x.id]=x.messages,o.push(x.id)})}}),!o.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=i?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Dr(i[1][0].meta[1][0].data)==1&&i[1][0];if(u||o.forEach(function(f){i[f].forEach(function(d){var p=Dr(d.meta[1][0].data)>>>0;if(p==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return _$(i,u)}function w$(t,e,r){var n,a,i,o;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&Dr(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,d=Zo(t[7][0].data),p=0,x=[],y=Zo(t[4][0].data),w=0,b=[],E=0;E<e.length;++E){if(e[E]==null){d.setUint16(E*2,65535,!0),y.setUint16(E*2,65535);continue}d.setUint16(E*2,p,!0),y.setUint16(E*2,w,!0);var T,I;switch(typeof e[E]){case"string":T=ix({t:"s",v:e[E]},r),I=lx({t:"s",v:e[E]},r);break;case"number":T=ix({t:"n",v:e[E]},r),I=lx({t:"n",v:e[E]},r);break;case"boolean":T=ix({t:"b",v:e[E]},r),I=lx({t:"b",v:e[E]},r);break;default:throw new Error("Unsupported value "+e[E])}x.push(T),p+=T.length,b.push(I),w+=I.length,++f}for(t[2][0].data=Zt(f);E<t[7][0].data.length/2;++E)d.setUint16(E*2,65535,!0),y.setUint16(E*2,65535,!0);return t[6][0].data=Kl(x),t[3][0].data=Kl(b),f}function b$(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=da(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(_t(n)));var i=Xm(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(Y){return Y.forEach(function(q){typeof q=="string"&&o.push(q)})});var u={},f=[],d=at.read(e.numbers,{type:"base64"});d.FileIndex.map(function(Y,q){return[Y,d.FullPaths[q]]}).forEach(function(Y){var q=Y[0],te=Y[1];if(q.type==2&&q.name.match(/\.iwa/)){var ce=q.content,Te=Ya(ce),Re=Xa(Te);Re.forEach(function(_e){f.push(_e.id),u[_e.id]={deps:[],location:te,type:Dr(_e.messages[0].meta[1][0].data)}})}}),f.sort(function(Y,q){return Y-q});var p=f.filter(function(Y){return Y>1}).map(function(Y){return[Y,Zt(Y)]});d.FileIndex.map(function(Y,q){return[Y,d.FullPaths[q]]}).forEach(function(Y){var q=Y[0];if(Y[1],!!q.name.match(/\.iwa/)){var te=Xa(Ya(q.content));te.forEach(function(ce){ce.messages.forEach(function(Te){p.forEach(function(Re){ce.messages.some(function(_e){return Dr(_e.meta[1][0].data)!=11006&&o$(_e.data,Re[1])})&&u[Re[0]].deps.push(ce.id)})})})}});for(var x=at.find(d,u[1].location),y=Xa(Ya(x.content)),w,b=0;b<y.length;++b){var E=y[b];E.id==1&&(w=E)}var T=Mn(Ut(w.messages[0].data)[1][0].data);for(x=at.find(d,u[T].location),y=Xa(Ya(x.content)),b=0;b<y.length;++b)E=y[b],E.id==T&&(w=E);for(T=Mn(Ut(w.messages[0].data)[2][0].data),x=at.find(d,u[T].location),y=Xa(Ya(x.content)),b=0;b<y.length;++b)E=y[b],E.id==T&&(w=E);for(T=Mn(Ut(w.messages[0].data)[2][0].data),x=at.find(d,u[T].location),y=Xa(Ya(x.content)),b=0;b<y.length;++b)E=y[b],E.id==T&&(w=E);var I=Ut(w.messages[0].data);{I[6][0].data=Zt(n.e.r+1),I[7][0].data=Zt(n.e.c+1);var R=Mn(I[46][0].data),C=at.find(d,u[R].location),z=Xa(Ya(C.content));{for(var H=0;H<z.length&&z[H].id!=R;++H);if(z[H].id!=R)throw"Bad ColumnRowUIDMapArchive";var X=Ut(z[H].messages[0].data);X[1]=[],X[2]=[],X[3]=[];for(var A=0;A<=n.e.c;++A){var F=[];F[1]=F[2]=[{type:0,data:Zt(A+420690)}],X[1].push({type:2,data:En(F)}),X[2].push({type:0,data:Zt(A)}),X[3].push({type:0,data:Zt(A)})}X[4]=[],X[5]=[],X[6]=[];for(var N=0;N<=n.e.r;++N)F=[],F[1]=F[2]=[{type:0,data:Zt(N+726270)}],X[4].push({type:2,data:En(F)}),X[5].push({type:0,data:Zt(N)}),X[6].push({type:0,data:Zt(N)});z[H].messages[0].data=En(X)}C.content=Kc($c(z)),C.size=C.content.length,delete I[46];var P=Ut(I[4][0].data);{P[7][0].data=Zt(n.e.r+1);var M=Ut(P[1][0].data),j=Mn(M[2][0].data);C=at.find(d,u[j].location),z=Xa(Ya(C.content));{if(z[0].id!=j)throw"Bad HeaderStorageBucket";var B=Ut(z[0].messages[0].data);for(N=0;N<i.length;++N){var Se=Ut(B[2][0].data);Se[1][0].data=Zt(N),Se[4][0].data=Zt(i[N].length),B[2][N]={type:B[2][0].type,data:En(Se)}}z[0].messages[0].data=En(B)}C.content=Kc($c(z)),C.size=C.content.length;var we=Mn(P[2][0].data);C=at.find(d,u[we].location),z=Xa(Ya(C.content));{if(z[0].id!=we)throw"Bad HeaderStorageBucket";for(B=Ut(z[0].messages[0].data),A=0;A<=n.e.c;++A)Se=Ut(B[2][0].data),Se[1][0].data=Zt(A),Se[4][0].data=Zt(n.e.r+1),B[2][A]={type:B[2][0].type,data:En(Se)};z[0].messages[0].data=En(B)}C.content=Kc($c(z)),C.size=C.content.length;var se=Mn(P[4][0].data);(function(){for(var Y=at.find(d,u[se].location),q=Xa(Ya(Y.content)),te,ce=0;ce<q.length;++ce){var Te=q[ce];Te.id==se&&(te=Te)}var Re=Ut(te.messages[0].data);{Re[3]=[];var _e=[];o.forEach(function(L,Xe){_e[1]=[{type:0,data:Zt(Xe)}],_e[2]=[{type:0,data:Zt(1)}],_e[3]=[{type:2,data:l$(L)}],Re[3].push({type:2,data:En(_e)})})}te.messages[0].data=En(Re);var ke=$c(q),rt=Kc(ke);Y.content=rt,Y.size=Y.content.length})();var oe=Ut(P[3][0].data);{var le=oe[1][0];delete oe[2];var ne=Ut(le.data);{var ye=Mn(ne[2][0].data);(function(){for(var Y=at.find(d,u[ye].location),q=Xa(Ya(Y.content)),te,ce=0;ce<q.length;++ce){var Te=q[ce];Te.id==ye&&(te=Te)}var Re=Ut(te.messages[0].data);{delete Re[6],delete oe[7];var _e=new Uint8Array(Re[5][0].data);Re[5]=[];for(var ke=0,rt=0;rt<=n.e.r;++rt){var L=Ut(_e);ke+=w$(L,i[rt],o),L[1][0].data=Zt(rt),Re[5].push({data:En(L),type:2})}Re[1]=[{type:0,data:Zt(n.e.c+1)}],Re[2]=[{type:0,data:Zt(n.e.r+1)}],Re[3]=[{type:0,data:Zt(ke)}],Re[4]=[{type:0,data:Zt(n.e.r+1)}]}te.messages[0].data=En(Re);var Xe=$c(q),Pe=Kc(Xe);Y.content=Pe,Y.size=Y.content.length})()}le.data=En(ne)}P[3][0].data=En(oe)}I[4][0].data=En(P)}w.messages[0].data=En(I);var Q=$c(y),O=Kc(Q);return x.content=O,x.size=x.content.length,d}function i3(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Zy(t){i3([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function e_(t){i3([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function E$(t){return St.WS.indexOf(t)>-1?"sheet":t==St.CS?"chart":t==St.DS?"dialog":t==St.MS?"macro":t&&t.length?t:"sheet"}function T$(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,E$(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function S$(t,e,r,n,a,i,o,u,f,d,p,x){try{i[n]=a0(Ca(t,r,!0),e);var y=Zr(t,e),w;switch(u){case"sheet":w=XX(y,e,a,f,i[n],d,p,x);break;case"chart":if(w=YX(y,e,a,f,i[n],d,p,x),!w||!w["!drawel"])break;var b=Xf(w["!drawel"].Target,e),E=A0(b),T=FH(Ca(t,b,!0),a0(Ca(t,E,!0),b)),I=Xf(T,b),R=A0(I);w=wX(Ca(t,I,!0),I,f,a0(Ca(t,R,!0),I),d,w);break;case"macro":w=$X(y,e,a,f,i[n],d,p,x);break;case"dialog":w=KX(y,e,a,f,i[n],d,p,x);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=w;var C=[];i&&i[n]&&Or(i[n]).forEach(function(z){var H="";if(i[n][z].Type==St.CMNT){H=Xf(i[n][z].Target,e);var X=eY(Zr(t,H,!0),H,f);if(!X||!X.length)return;bS(w,X,!1)}i[n][z].Type==St.TCMNT&&(H=Xf(i[n][z].Target,e),C=C.concat(PH(Zr(t,H,!0),f)))}),C&&C.length&&bS(w,C,!0,f.people||[])}catch(z){if(f.WTF)throw z}}function qa(t){return t.charAt(0)=="/"?t.slice(1):t}function A$(t,e){if(ju(),e=e||{},Zy(e),$a(t,"META-INF/manifest.xml")||$a(t,"objectdata.xml"))return OS(t,e);if($a(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ox<"u"){if(t.FileIndex)return ox(t);var r=at.utils.cfb_new();return HT(t).forEach(function(Se){Et(r,Se,j7(t,Se))}),ox(r)}throw new Error("Unsupported NUMBERS file")}if(!$a(t,"[Content_Types].xml"))throw $a(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):$a(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=HT(t),a=RB(Ca(t,"[Content_Types].xml")),i=!1,o,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Zr(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Zr(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},d={};if(!e.bookSheets&&!e.bookProps){if(s0=[],a.sst)try{s0=ZX(Zr(t,qa(a.sst)),a.sst,e)}catch(Se){if(e.WTF)throw Se}e.cellStyles&&a.themes.length&&(f=JX(Ca(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=QX(Zr(t,qa(a.style)),a.style,f,e))}a.links.map(function(Se){try{var we=a0(Ca(t,A0(qa(Se))),Se);return rY(Zr(t,qa(Se)),we,Se,e)}catch{}});var p=WX(Zr(t,qa(a.workbooks[0])),a.workbooks[0],e),x={},y="";a.coreprops.length&&(y=Zr(t,qa(a.coreprops[0]),!0),y&&(x=YC(y)),a.extprops.length!==0&&(y=Zr(t,qa(a.extprops[0]),!0),y&&jB(y,x,e)));var w={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(y=Ca(t,qa(a.custprops[0]),!0),y&&(w=BB(y,e)));var b={};if((e.bookSheets||e.bookProps)&&(p.Sheets?o=p.Sheets.map(function(we){return we.name}):x.Worksheets&&x.SheetNames.length>0&&(o=x.SheetNames),e.bookProps&&(b.Props=x,b.Custprops=w),e.bookSheets&&typeof o<"u"&&(b.SheetNames=o),e.bookSheets?b.SheetNames:e.bookProps))return b;o={};var E={};e.bookDeps&&a.calcchain&&(E=tY(Zr(t,qa(a.calcchain)),a.calcchain));var T=0,I={},R,C;{var z=p.Sheets;x.Worksheets=z.length,x.SheetNames=[];for(var H=0;H!=z.length;++H)x.SheetNames[H]=z[H].name}var X=i?"bin":"xml",A=a.workbooks[0].lastIndexOf("/"),F=(a.workbooks[0].slice(0,A+1)+"_rels/"+a.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");$a(t,F)||(F="xl/_rels/workbook."+X+".rels");var N=a0(Ca(t,F,!0),F.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=nY(Zr(t,qa(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=LH(Zr(t,qa(a.people[0])),e)),N&&(N=T$(N,p.Sheets));var P=Zr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=x.Worksheets;++T){var M="sheet";if(N&&N[T]?(R="xl/"+N[T][1].replace(/[\/]?xl\//,""),$a(t,R)||(R=N[T][1]),$a(t,R)||(R=F.replace(/_rels\/.*$/,"")+N[T][1]),M=N[T][2]):(R="xl/worksheets/sheet"+(T+1-P)+"."+X,R=R.replace(/sheet0\./,"sheet.")),C=R.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(T!=e.sheets)continue e;break;case"string":if(x.SheetNames[T].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var j=!1,B=0;B!=e.sheets.length;++B)typeof e.sheets[B]=="number"&&e.sheets[B]==T&&(j=1),typeof e.sheets[B]=="string"&&e.sheets[B].toLowerCase()==x.SheetNames[T].toLowerCase()&&(j=1);if(!j)continue e}}S$(t,R,C,x.SheetNames[T],T,I,o,M,e,p,f,d)}return b={Directory:a,Workbook:p,Props:x,Custprops:w,Deps:E,Sheets:o,SheetNames:x.SheetNames,Strings:s0,Styles:d,Themes:f,SSF:yr(lt)},e&&e.bookFiles&&(t.files?(b.keys=n,b.files=t.files):(b.keys=[],b.files={},t.FullPaths.forEach(function(Se,we){Se=Se.replace(/^Root Entry[\/]/,""),b.keys.push(Se),b.files[Se]=t.FileIndex[we]}))),e&&e.bookVBA&&(a.vba.length>0?b.vbaraw=Zr(t,qa(a.vba[0]),!0):a.defaults&&a.defaults.bin===WH&&(b.vbaraw=Zr(t,"xl/vbaProject.bin",!0))),b}function k$(t,e){var r=e||{},n="Workbook",a=at.find(t,n);try{if(n="/!DataSpaces/Version",a=at.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(nz(a.content),n="/!DataSpaces/DataSpaceMap",a=at.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=sz(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=at.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=iz(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=at.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);oz(a.content)}catch{}if(n="/EncryptionInfo",a=at.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=cz(a.content);if(n="/EncryptedPackage",a=at.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function C$(t,e){return e.bookType=="ods"?s3(t,e):e.bookType=="numbers"?b$(t,e):e.bookType=="xlsb"?N$(t,e):R$(t,e)}function N$(t,e){nu=1024,t&&!t.SSF&&(t.SSF=yr(lt)),t&&t.SSF&&(ju(),Tp(t.SSF),e.revssf=Ap(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,i0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=ON.indexOf(e.bookType)>-1,a=By();e_(e=e||{});var i=Sy(),o="",u=0;if(e.cellXfs=[],ao(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Et(i,o,$C(t.Props,e)),a.coreprops.push(o),er(e.rels,2,o,St.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,Et(i,o,JC(t.Props)),a.extprops.push(o),er(e.rels,3,o,St.EXT_PROPS),t.Custprops!==t.Props&&Or(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Et(i,o,ZC(t.Custprops)),a.custprops.push(o),er(e.rels,4,o,St.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var p={"!id":{}},x=t.Sheets[t.SheetNames[u-1]],y=(x||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,Et(i,o,sY(u-1,o,e,t,p)),a.sheets.push(o),er(e.wbrels,-1,"worksheets/sheet"+u+"."+r,St.WS[0])}if(x){var w=x["!comments"],b=!1,E="";w&&w.length>0&&(E="xl/comments"+u+"."+r,Et(i,E,oY(w,E)),a.comments.push(E),er(p,-1,"../comments"+u+"."+r,St.CMNT),b=!0),x["!legacy"]&&b&&Et(i,"xl/drawings/vmlDrawing"+u+".vml",IN(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&Et(i,A0(o),uu(p))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Et(i,o,lY(e.Strings,o,e)),a.strs.push(o),er(e.wbrels,-1,"sharedStrings."+r,St.SST)),o="xl/workbook."+r,Et(i,o,aY(t,o)),a.workbooks.push(o),er(e.rels,1,o,St.WB),o="xl/theme/theme1.xml",Et(i,o,qy(t.Themes,e)),a.themes.push(o),er(e.wbrels,-1,"theme/theme1.xml",St.THEME),o="xl/styles."+r,Et(i,o,iY(t,o,e)),a.styles.push(o),er(e.wbrels,-1,"styles."+r,St.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Et(i,o,t.vbaraw),a.vba.push(o),er(e.wbrels,-1,"vbaProject.bin",St.VBA)),o="xl/metadata."+r,Et(i,o,cY(o)),a.metadata.push(o),er(e.wbrels,-1,"metadata."+r,St.XLMETA),Et(i,"[Content_Types].xml",WC(a,e)),Et(i,"_rels/.rels",uu(e.rels)),Et(i,"xl/_rels/workbook."+r+".rels",uu(e.wbrels)),delete e.revssf,delete e.ssf,i}function R$(t,e){nu=1024,t&&!t.SSF&&(t.SSF=yr(lt)),t&&t.SSF&&(ju(),Tp(t.SSF),e.revssf=Ap(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,i0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=ON.indexOf(e.bookType)>-1,a=By();e_(e=e||{});var i=Sy(),o="",u=0;if(e.cellXfs=[],ao(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Et(i,o,$C(t.Props,e)),a.coreprops.push(o),er(e.rels,2,o,St.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,Et(i,o,JC(t.Props)),a.extprops.push(o),er(e.rels,3,o,St.EXT_PROPS),t.Custprops!==t.Props&&Or(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Et(i,o,ZC(t.Custprops)),a.custprops.push(o),er(e.rels,4,o,St.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var x={"!id":{}},y=t.Sheets[t.SheetNames[u-1]],w=(y||{})["!type"]||"sheet";switch(w){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,Et(i,o,GN(u-1,e,t,x)),a.sheets.push(o),er(e.wbrels,-1,"worksheets/sheet"+u+"."+r,St.WS[0])}if(y){var b=y["!comments"],E=!1,T="";if(b&&b.length>0){var I=!1;b.forEach(function(R){R[1].forEach(function(C){C.T==!0&&(I=!0)})}),I&&(T="xl/threadedComments/threadedComment"+u+"."+r,Et(i,T,jH(b,p,e)),a.threadedcomments.push(T),er(x,-1,"../threadedComments/threadedComment"+u+"."+r,St.TCMNT)),T="xl/comments"+u+"."+r,Et(i,T,DN(b)),a.comments.push(T),er(x,-1,"../comments"+u+"."+r,St.CMNT),E=!0}y["!legacy"]&&E&&Et(i,"xl/drawings/vmlDrawing"+u+".vml",IN(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}x["!id"].rId1&&Et(i,A0(o),uu(x))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Et(i,o,yN(e.Strings,e)),a.strs.push(o),er(e.wbrels,-1,"sharedStrings."+r,St.SST)),o="xl/workbook."+r,Et(i,o,$N(t)),a.workbooks.push(o),er(e.rels,1,o,St.WB),o="xl/theme/theme1.xml",Et(i,o,qy(t.Themes,e)),a.themes.push(o),er(e.wbrels,-1,"theme/theme1.xml",St.THEME),o="xl/styles."+r,Et(i,o,kN(t,e)),a.styles.push(o),er(e.wbrels,-1,"styles."+r,St.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Et(i,o,t.vbaraw),a.vba.push(o),er(e.wbrels,-1,"vbaProject.bin",St.VBA)),o="xl/metadata."+r,Et(i,o,RN()),a.metadata.push(o),er(e.wbrels,-1,"metadata."+r,St.XLMETA),p.length>1&&(o="xl/persons/person.xml",Et(i,o,BH(p)),a.people.push(o),er(e.wbrels,-1,"persons/person.xml",St.PEOPLE)),Et(i,"[Content_Types].xml",WC(a,e)),Et(i,"_rels/.rels",uu(e.rels)),Et(i,"xl/_rels/workbook."+r+".rels",uu(e.wbrels)),delete e.revssf,delete e.ssf,i}function t_(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ia(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function I$(t,e){return at.find(t,"EncryptedPackage")?k$(t,e):ZN(t,e)}function D$(t,e){var r,n=t,a=e||{};return a.type||(a.type=Tt&&Buffer.isBuffer(t)?"buffer":"base64"),r=wC(n,a),A$(r,a)}function l3(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return tv(t.slice(r),e);default:break e}return Tu.to_workbook(t,e)}function O$(t,e){var r="",n=t_(t,e);switch(e.type){case"base64":r=Ia(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=$o(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=lr(r)),e.type="binary",l3(r,e)}function F$(t,e){var r=t;return e.type=="base64"&&(r=Ia(r)),r=_0.utils.decode(1200,r.slice(2),"str"),e.type="binary",l3(r,e)}function M$(t){return t.match(/[^\x00-\x7F]/)?Bs(t):t}function cx(t,e,r,n){return n?(r.type="string",Tu.to_workbook(t,r)):Tu.to_workbook(e,r)}function av(t,e){_y();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return av(new Uint8Array(t),(r=yr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),hu={},r.dateNF&&(hu.dateNF=r.dateNF),r.type||(r.type=Tt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Tt?"buffer":"binary",n=N7(t),typeof Uint8Array<"u"&&!Tt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=M$(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=yr(r),r.type="array",av(wy(n),r)}switch((a=t_(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return I$(at.read(n,r),r);break;case 9:if(a[1]<=8)return ZN(n,r);break;case 60:return tv(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return VU(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return xN.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?D$(n,r):cx(t,n,r,i);case 239:return a[3]===60?tv(n,r):cx(t,n,r,i);case 255:if(a[1]===254)return F$(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Uo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Uo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ev.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return TN.to_workbook(n,r);break;case 10:case 13:case 32:return O$(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return BU.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?ev.to_workbook(n,r):cx(t,n,r,i)}function o3(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return rh(e.file,at.write(t,{type:Tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return at.write(t,e)}function P$(t,e){var r=yr(e||{}),n=C$(t,r);return j$(n,r)}function j$(t,e){var r={},n=Tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?at.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(Ep(a))}return e.password&&typeof encrypt_agile<"u"?o3(encrypt_agile(a,e.password),e):e.type==="file"?rh(e.file,a):e.type=="string"?lr(a):a}function L$(t,e){var r=e||{},n=MY(t,r);return o3(n,r)}function js(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return w0(Bs(n));case"binary":return Bs(n);case"string":return t;case"file":return rh(e.file,n,"utf8");case"buffer":return Tt?Bi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):js(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function B$(t,e){switch(e.type){case"base64":return w0(t);case"binary":return t;case"string":return t;case"file":return rh(e.file,t,"binary");case"buffer":return Tt?Bi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function $d(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?w0(r):e.type=="string"?lr(r):r;case"file":return rh(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function c3(t,e){_y(),IX(t);var r=yr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=c3(t,r);return r.type="array",Ep(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return js(CY(t,r),r);case"slk":case"sylk":return js(gN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return js(t3(t.Sheets[t.SheetNames[a]],r),r);case"txt":return B$(u3(t.Sheets[t.SheetNames[a]],r),r);case"csv":return js(r_(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return js(xN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return $d(ev.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return js(Tu.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return js(TN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return js(vN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return js(s3(t,r),r);case"wk1":return $d(Uo.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return $d(Uo.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),$d(e3(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),L$(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return P$(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function V$(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function U$(t,e,r){var n={};return n.type="file",n.file=e,V$(n),c3(t,n)}function z$(t,e,r,n,a,i,o,u){var f=Ur(r),d=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,y=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!o||t[r])for(var w=e.s.c;w<=e.e.c;++w){var b=o?t[r][w]:t[n[w]+f];if(b===void 0||b.t===void 0){if(d===void 0)continue;i[w]!=null&&(y[i[w]]=d);continue}var E=b.v;switch(b.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(i[w]!=null){if(E==null)if(b.t=="e"&&E===null)y[i[w]]=null;else if(d!==void 0)y[i[w]]=d;else if(p&&E===null)y[i[w]]=null;else continue;else y[i[w]]=p&&(b.t!=="n"||b.t==="n"&&u.rawNumbers!==!1)?E:ji(b,E,u);E!=null&&(x=!1)}}return{row:y,isempty:x}}function Xm(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},p=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof p){case"string":f=Lt(p);break;case"number":f=Lt(t["!ref"]),f.s.r=p;break;default:f=p}n>0&&(a=0);var x=Ur(f.s.r),y=[],w=[],b=0,E=0,T=Array.isArray(t),I=f.s.r,R=0,C={};T&&!t[I]&&(t[I]=[]);var z=d.skipHidden&&t["!cols"]||[],H=d.skipHidden&&t["!rows"]||[];for(R=f.s.c;R<=f.e.c;++R)if(!(z[R]||{}).hidden)switch(y[R]=Tr(R),r=T?t[I][R]:t[y[R]+x],n){case 1:i[R]=R-f.s.c;break;case 2:i[R]=y[R];break;case 3:i[R]=d.header[R-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=ji(r,null,d),E=C[o]||0,!E)C[o]=1;else{do u=o+"_"+E++;while(C[u]);C[o]=E,C[u]=1}i[R]=u}for(I=f.s.r+a;I<=f.e.r;++I)if(!(H[I]||{}).hidden){var X=z$(t,f,I,y,n,i,T,d);(X.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(w[b++]=X.row)}return w.length=b,w}var LS=/"/g;function H$(t,e,r,n,a,i,o,u){for(var f=!0,d=[],p="",x=Ur(r),y=e.s.c;y<=e.e.c;++y)if(n[y]){var w=u.dense?(t[r]||[])[y]:t[n[y]+x];if(w==null)p="";else if(w.v!=null){f=!1,p=""+(u.rawNumbers&&w.t=="n"?w.v:ji(w,null,u));for(var b=0,E=0;b!==p.length;++b)if((E=p.charCodeAt(b))===a||E===i||E===34||u.forceQuotes){p='"'+p.replace(LS,'""')+'"';break}p=="ID"&&(p='"ID"')}else w.f!=null&&!w.F?(f=!1,p="="+w.f,p.indexOf(",")>=0&&(p='"'+p.replace(LS,'""')+'"')):p="";d.push(p)}return u.blankrows===!1&&f?null:d.join(o)}function r_(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Lt(t["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),p="",x=[];n.dense=Array.isArray(t);for(var y=n.skipHidden&&t["!cols"]||[],w=n.skipHidden&&t["!rows"]||[],b=a.s.c;b<=a.e.c;++b)(y[b]||{}).hidden||(x[b]=Tr(b));for(var E=0,T=a.s.r;T<=a.e.r;++T)(w[T]||{}).hidden||(p=H$(t,a,T,x,o,f,i,n),p!=null&&(n.strip&&(p=p.replace(d,"")),(p||n.blankrows!==!1)&&r.push((E++?u:"")+p)));return delete n.dense,r.join("")}function u3(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=r_(t,e);return r}function G$(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Lt(t["!ref"]),i="",o=[],u,f=[],d=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)o[u]=Tr(u);for(var p=a.s.r;p<=a.e.r;++p)for(i=Ur(p),u=a.s.c;u<=a.e.c;++u)if(e=o[u]+i,r=d?(t[p]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=e+"="+n}return f}function f3(t,e,r){var n=r||{},a=+!n.skipHeader,i=t||{},o=0,u=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?Sr(n.origin):n.origin;o=f.r,u=f.c}var d,p={s:{c:0,r:0},e:{c:u,r:o+e.length-1+a}};if(i["!ref"]){var x=Lt(i["!ref"]);p.e.c=Math.max(p.e.c,x.e.c),p.e.r=Math.max(p.e.r,x.e.r),o==-1&&(o=x.e.r+1,p.e.r=o+e.length-1+a)}else o==-1&&(o=0,p.e.r=e.length-1+a);var y=n.header||[],w=0;e.forEach(function(E,T){Or(E).forEach(function(I){(w=y.indexOf(I))==-1&&(y[w=y.length]=I);var R=E[I],C="z",z="",H=ot({c:u+w,r:o+T+a});d=O0(i,H),R&&typeof R=="object"&&!(R instanceof Date)?i[H]=R:(typeof R=="number"?C="n":typeof R=="boolean"?C="b":typeof R=="string"?C="s":R instanceof Date?(C="d",n.cellDates||(C="n",R=fn(R)),z=n.dateNF||lt[14]):R===null&&n.nullError&&(C="e",R=0),d?(d.t=C,d.v=R,delete d.w,delete d.R,z&&(d.z=z)):i[H]=d={t:C,v:R},z&&(d.z=z))})}),p.e.c=Math.max(p.e.c,u+y.length-1);var b=Ur(o);if(a)for(w=0;w<y.length;++w)i[Tr(w+u)+b]={t:"s",v:y[w]};return i["!ref"]=_t(p),i}function q$(t,e){return f3(null,t,e)}function O0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Sr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?O0(t,ot(e)):O0(t,ot({r:e,c:r||0}))}function W$(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function n_(){return{SheetNames:[],Sheets:{}}}function a_(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=o+a)!=-1;++a);}if(YN(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function X$(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=W$(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Y$(t,e){return t.z=e,t}function h3(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function $$(t,e,r){return h3(t,"#"+e,r)}function K$(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Q$(t,e,r,n){for(var a=typeof e!="string"?e:Lt(e),i=typeof e=="string"?e:_t(e),o=a.s.r;o<=a.e.r;++o)for(var u=a.s.c;u<=a.e.c;++u){var f=O0(t,o,u);f.t="n",f.F=i,delete f.v,o==a.s.r&&u==a.s.c&&(f.f=r,n&&(f.D=!0))}return t}var cm={encode_col:Tr,encode_row:Ur,encode_cell:ot,encode_range:_t,decode_col:Oy,decode_row:Dy,split_cell:lB,decode_cell:Sr,decode_range:da,format_cell:ji,sheet_add_aoa:BC,sheet_add_json:f3,sheet_add_dom:r3,aoa_to_sheet:Lu,json_to_sheet:q$,table_to_sheet:n3,table_to_book:n$,sheet_to_csv:r_,sheet_to_txt:u3,sheet_to_json:Xm,sheet_to_html:t3,sheet_to_formulae:G$,sheet_to_row_object_array:Xm,sheet_get_cell:O0,book_new:n_,book_append_sheet:a_,book_set_sheet_visibility:X$,cell_set_number_format:Y$,cell_set_hyperlink:h3,cell_set_internal_link:$$,cell_add_comment:K$,sheet_set_array_formula:Q$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const J$="";function Z$({group:t,orders:e,currentUser:r,onEdit:n}){const a=r?.name===J$,[i,o]=re.useState(t.exchangeRate||.21),[u,f]=re.useState(t.shippingFee||0);re.useEffect(()=>{t.exchangeRate!==void 0&&o(t.exchangeRate),t.shippingFee!==void 0&&f(t.shippingFee)},[t]);const d=async()=>{if(a)try{await tn(yt(Ke,"artifacts","default-app-id","public","data","groups",t.id),{exchangeRate:Number(i),shippingFee:Number(u)}),console.log("")}catch(E){console.error("",E),alert("")}},p=re.useMemo(()=>e.map(E=>{const T=E.items.reduce((R,C)=>R+C.quantity,0),I=E.items.reduce((R,C)=>R+C.price*C.quantity,0);return{userId:E.userId,userName:E.userName,totalQty:T,totalAmount:I}}).sort((E,T)=>T.totalAmount-E.totalAmount),[e]),x=p.reduce((E,T)=>E+T.totalAmount,0),y=p.reduce((E,T)=>E+T.totalQty,0),w=y>0?u/y:0,b=()=>{const E=[];e.forEach(R=>{R.items.forEach(C=>{const z=C.price*C.quantity,H=w*C.quantity,X=z+H;E.push({:R.userName,:C.name,:C.spec||"-"," ()":C.price,:C.quantity," ()":z," ()":Math.round(H)," () ()":Math.round(X)," (NT$)":Math.round(X*i),:new Date(R.updatedAt).toLocaleString()})})});const T=cm.json_to_sheet(E),I=cm.book_new();cm.book_append_sheet(I,T,""),U$(I,`_${t.title}_${i}.xlsx`)};return m.jsxs("div",{className:"space-y-6 text-slate-800 font-sans",children:[m.jsxs("div",{className:"bg-slate-900 p-4 rounded-lg border-2 border-yellow-400 shadow-lg text-white",children:[m.jsxs("h4",{className:"font-black italic text-xl text-yellow-400 mb-3 transform -skew-x-3",children:[m.jsx(ly,{size:20,className:"inline mr-2 fill-yellow-400 text-slate-900"})," "]}),m.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-bold text-slate-400 flex items-center gap-1",children:[m.jsx(Nk,{size:14,className:"text-red-500"}),"  (JPY  TWD)"]}),a?m.jsx("input",{type:"number",step:"0.001",value:i,onChange:E=>o(E.target.value),onBlur:d,className:"w-full px-3 py-1.5 rounded border-2 border-yellow-400 text-center font-black text-slate-900 focus:outline-none focus:ring-4 focus:ring-red-600 bg-yellow-100 shadow-md transition-all"}):m.jsx("span",{className:"font-mono text-2xl font-black text-yellow-400 bg-slate-800 px-3 py-1 rounded border border-yellow-400",children:i})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-bold text-slate-400 flex items-center gap-1",children:[m.jsx(_p,{size:14,className:"text-red-500"}),"  (JPY)"]}),a?m.jsx("input",{type:"number",value:u,onChange:E=>f(E.target.value),onBlur:d,className:"w-full px-3 py-1.5 rounded border-2 border-yellow-400 text-center font-black text-slate-900 focus:outline-none focus:ring-4 focus:ring-red-600 bg-yellow-100 shadow-md transition-all"}):m.jsx("span",{className:"font-mono text-2xl font-black text-yellow-400 bg-slate-800 px-3 py-1 rounded border border-yellow-400",children:u})]})]})]}),m.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center bg-white p-4 rounded-lg border-2 border-slate-900 shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] gap-4 sm:gap-0",children:[m.jsxs("div",{className:"flex gap-6 text-sm font-bold",children:[m.jsxs("div",{children:[m.jsx("span",{className:"text-slate-500 block text-xs",children:""}),m.jsx("span",{className:"font-black text-3xl text-red-600 italic",children:y})]}),m.jsxs("div",{className:"border-l border-slate-200 pl-4",children:[m.jsx("span",{className:"text-slate-500 block text-xs",children:" ()"}),m.jsxs("div",{className:"flex flex-col leading-snug",children:[m.jsxs("span",{className:"font-black text-xl text-slate-900",children:["",(x+Number(u)).toLocaleString()]}),m.jsxs("span",{className:"text-sm text-yellow-600 font-black tracking-wider",children:[" NT$",Math.round((x+Number(u))*i).toLocaleString()]})]})]})]}),a&&m.jsxs("button",{onClick:b,className:"w-full sm:w-auto flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded border-2 border-green-800 text-sm font-black italic shadow-[2px_2px_0px_0px_rgba(20,83,45,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[m.jsx(Rk,{size:18})," EXCEL "]})]}),m.jsxs("div",{className:"border-2 border-slate-900 rounded-lg overflow-hidden shadow-lg bg-white",children:[m.jsxs("div",{className:"bg-slate-900 px-4 py-3 text-xs font-black text-yellow-400 flex justify-between uppercase",children:[m.jsx("span",{children:" ()"}),m.jsx("span",{className:"text-right",children:" (TWD)"})]}),m.jsxs("div",{className:"divide-y divide-slate-200 max-h-60 overflow-y-auto bg-white",children:[p.map(E=>{const T=Math.round(w*E.totalQty),I=E.totalAmount+T,R=Math.round(I*i);return m.jsxs("div",{className:"flex justify-between items-center px-4 py-3 text-sm hover:bg-slate-50 transition-colors",children:[m.jsxs("div",{className:"flex flex-col",children:[m.jsxs("span",{className:"font-black text-slate-900 flex items-center gap-1",children:[m.jsx(Om,{size:14,className:"text-red-600"})," ",E.userName]}),m.jsxs("span",{className:"text-slate-500 text-xs italic",children:[E.totalQty," "]})]}),m.jsxs("div",{className:"text-right",children:[m.jsxs("div",{className:"font-black text-lg text-slate-900 font-mono",children:["",I.toLocaleString()]}),m.jsxs("div",{className:"text-xs font-bold bg-yellow-400/30 text-slate-900 px-1.5 py-0.5 rounded inline-block mt-1 border border-yellow-400",children:[" NT$",R.toLocaleString()]}),Number(u)>0&&m.jsxs("span",{className:"text-[10px] text-slate-400 font-medium ml-1 block",children:["(",E.totalAmount," + ",T,")"]})]})]},E.userId)}),p.length===0&&m.jsx("div",{className:"p-4 text-center text-slate-300 text-sm italic",children:""})]})]}),m.jsx("div",{className:"h-2 bg-yellow-400 border-t-2 border-slate-900 mt-5"}),m.jsxs("div",{className:"space-y-6",children:[m.jsxs("h4",{className:"font-black italic text-lg text-slate-900 flex items-center gap-2 transform -skew-x-3",children:[m.jsx(eP,{size:20,className:"text-red-600"})," "]}),e.map(E=>{const T=r&&E.userId===r.id,I=E.items.reduce((X,A)=>X+A.price*A.quantity,0),R=E.items.reduce((X,A)=>X+A.quantity,0),C=Math.round(w*R),z=I+C,H=Math.round(z*i);return m.jsxs("div",{className:`bg-white rounded-lg border-4 ${T?"border-red-600 shadow-[4px_4px_0px_0px_#FACC15]":"border-slate-900 shadow-md"} transition-all`,children:[m.jsxs("div",{className:`px-5 py-3 border-b-2 flex justify-between items-center ${T?"bg-red-50 border-red-200":"bg-slate-50 border-slate-100"}`,children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-black ${T?"bg-red-600 text-white":"bg-slate-900 text-yellow-400"}`,children:E.userName.charAt(0)}),m.jsxs("div",{className:"flex flex-col",children:[m.jsxs("span",{className:`font-black italic text-sm ${T?"text-red-700":"text-slate-900"}`,children:[E.userName," ",T&&"(YOU)"]}),m.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:new Date(E.updatedAt).toLocaleDateString()})]})]}),T&&n&&m.jsxs("button",{onClick:n,className:"flex items-center gap-1 bg-white text-blue-600 text-xs font-black px-3 py-1.5 rounded border-2 border-slate-900 shadow-sm hover:bg-blue-50 transition-all italic",children:[m.jsx(uy,{size:14})," "]})]}),m.jsxs("div",{className:"p-5 bg-white",children:[m.jsx("ul",{className:"space-y-3",children:E.items.map((X,A)=>m.jsxs("li",{className:"flex justify-between items-start text-sm border-b border-dashed border-slate-200 last:border-0 pb-2 last:pb-0",children:[m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{className:"text-slate-900 font-black text-base",children:X.name}),X.spec&&m.jsxs("span",{className:"text-slate-500 text-xs italic",children:[": ",X.spec]})]}),m.jsxs("div",{className:"flex flex-col items-end",children:[m.jsxs("span",{className:"font-black font-mono text-xl text-red-600 italic",children:["x ",X.quantity]}),m.jsx("div",{className:"text-right",children:m.jsxs("span",{className:"text-xs text-slate-500",children:["",X.price]})})]})]},A))}),m.jsxs("div",{className:"mt-4 pt-3 border-t-2 border-slate-200 flex flex-col items-end",children:[m.jsxs("div",{className:"flex gap-4 text-xs text-slate-400 mb-1 font-bold",children:[m.jsxs("span",{children:[" ",I.toLocaleString()]}),m.jsx("span",{children:"+"}),m.jsxs("span",{children:[" ",C]})]}),m.jsxs("div",{className:"flex items-baseline gap-2",children:[m.jsx("span",{className:"text-slate-500 text-sm",children:"TOTAL JPY"}),m.jsxs("span",{className:"font-black text-slate-900 font-mono text-2xl",children:["",z.toLocaleString()]})]}),m.jsxs("div",{className:"text-lg font-black bg-yellow-400 text-slate-900 px-3 py-0.5 rounded mt-1 italic border-2 border-slate-900",children:[" NT$",H.toLocaleString()]})]})]})]},E.userId)})]})]})}const Kd=250;function d3({group:t,orders:e,currentUser:r,onUpdate:n,isReadOnly:a=!1}){const i=!a&&(r?.name===""||r?.id==="yeye"),[o,u]=re.useState(t.secondPayment?.weights||{}),[f,d]=re.useState(t.secondPayment?.boxWeight||0),[p,x]=re.useState(t.secondPayment?.minChargeDiff||0),y=eK(()=>{const z=new Set;return e.forEach(H=>H.items?.forEach(X=>z.add(X.itemId))),t.items?.filter(H=>z.has(H.id))||[]},[t.items,e]),w=e.filter(z=>z.groupId===t.id);let b=0;w.forEach(z=>z.items.forEach(H=>b+=Number(H.quantity)||0));const E=new Set(w.map(z=>z.userId)).size,T=b>0?f*Kd/b:0,I=E>0?p/E:0,R=w.reduce((z,H)=>{let X=0,A=[];return H.items?.forEach(F=>{const N=parseFloat(o[F.itemId]||0),M=(N*Kd+T)*F.quantity;X+=M,A.push({name:F.name,qty:F.quantity,weight:N,subtotal:M})}),X+=I,z[H.userId]?(z[H.userId].details.push(...A),z[H.userId].total+=X):z[H.userId]={name:H.userName,details:A,total:X},z},{}),C=()=>{n({weights:o,boxWeight:f,minChargeDiff:p}),alert("")};return m.jsxs("div",{className:"space-y-6 max-h-[80vh] overflow-y-auto pr-2",children:[i&&m.jsxs("div",{className:"bg-white p-5 rounded-xl border-4 border-slate-900 shadow-[4px_4px_0px_0px_#000]",children:[m.jsxs("h3",{className:"font-black text-slate-900 mb-4 flex items-center gap-2 uppercase italic border-b-2 pb-2",children:[m.jsx(fy,{size:20,className:"text-blue-600"})," Weight Control Panel"]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[m.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border-2 border-slate-200",children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1 uppercase",children:"/ (kg)"}),m.jsx("input",{type:"number",step:"0.01",className:"w-full bg-transparent font-mono font-bold text-lg outline-none",value:f,onChange:z=>d(z.target.value)})]}),m.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border-2 border-slate-200",children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1 uppercase",children:" (TWD)"}),m.jsx("input",{type:"number",className:"w-full bg-transparent font-mono font-bold text-lg outline-none",value:p,onChange:z=>x(z.target.value)})]})]}),m.jsx("p",{className:"text-[10px] font-black text-slate-400 mb-3 uppercase tracking-widest",children:"Individual Item Weights"}),m.jsx("div",{className:"space-y-3",children:y.map(z=>m.jsxs("div",{className:"flex items-center gap-3 bg-slate-50 p-2 rounded-lg border border-slate-200",children:[m.jsx("span",{className:"flex-1 text-xs font-bold text-slate-700 truncate",children:z.name}),m.jsxs("div",{className:"flex items-center gap-1 bg-white px-2 py-1 rounded border border-slate-300",children:[m.jsx("input",{type:"number",step:"0.001",placeholder:"0.000",className:"w-20 text-right font-mono font-black text-blue-600 outline-none",value:o[z.id]||"",onChange:H=>u({...o,[z.id]:H.target.value})}),m.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:"kg"})]})]},z.id))}),m.jsxs("button",{onClick:C,className:"w-full mt-6 py-3 bg-slate-900 text-yellow-400 rounded-xl font-black flex items-center justify-center gap-2 hover:bg-slate-800 shadow-[4px_4px_0px_0px_#ccc] transition-all active:translate-y-1 active:shadow-none",children:[m.jsx(ql,{size:18})," SAVE SETTINGS"]})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-end",children:[m.jsxs("h3",{className:"font-black text-slate-900 flex items-center gap-2 italic",children:[m.jsx(ly,{size:20,className:"text-red-600"})," "]}),a&&m.jsx("span",{className:"text-[10px] font-black text-blue-600 border-b-2 border-blue-600 pb-0.5",children:"READ ONLY MODE"})]}),Object.values(R).map((z,H)=>m.jsxs("div",{className:"bg-white border-2 border-slate-900 rounded-xl overflow-hidden shadow-sm",children:[m.jsxs("div",{className:"bg-slate-900 text-white px-4 py-2 flex justify-between items-center",children:[m.jsx("span",{className:"font-black italic uppercase tracking-tighter",children:z.name}),m.jsxs("span",{className:"font-mono font-black text-yellow-400",children:["Total: $",Math.round(z.total)]})]}),m.jsx("div",{className:"p-0",children:m.jsxs("table",{className:"w-full text-[11px] text-left",children:[m.jsx("thead",{className:"bg-slate-50 text-slate-400 font-bold uppercase border-b",children:m.jsxs("tr",{children:[m.jsx("th",{className:"p-2",children:"Item"}),m.jsx("th",{className:"p-2 text-center",children:"Qty"}),m.jsx("th",{className:"p-2 text-center",children:"Weight"}),m.jsx("th",{className:"p-2 text-right",children:"Subtotal"})]})}),m.jsxs("tbody",{className:"divide-y divide-slate-100",children:[z.details.map((X,A)=>m.jsxs("tr",{children:[m.jsx("td",{className:"p-2 font-bold text-slate-700",children:X.name}),m.jsx("td",{className:"p-2 text-center text-slate-500",children:X.qty}),m.jsxs("td",{className:"p-2 text-center font-mono text-slate-400",children:[X.weight,"kg"]}),m.jsxs("td",{className:"p-2 text-right font-mono font-bold",children:["$",Math.round(X.subtotal)]})]},A)),p>0&&m.jsxs("tr",{className:"bg-yellow-50/50",children:[m.jsx("td",{colSpan:3,className:"p-2 text-slate-500 italic",children:" (Person Share)"}),m.jsxs("td",{className:"p-2 text-right font-mono font-bold",children:["$",Math.round(I)]})]})]})]})})]},H))]}),a&&m.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border-2 border-dashed border-slate-300 flex items-start gap-3",children:[m.jsx(Z0,{size:18,className:"text-slate-400 shrink-0 mt-0.5"}),m.jsxs("p",{className:"text-[10px] font-bold text-slate-500 leading-relaxed",children:["[(  ",Kd,") + (  ",Kd," / )]   + ( / ) "]})]})]})}function eK(t,e){const[r,n]=Ws.useState(t);return Ws.useEffect(()=>n(t()),e),r}function BS({images:t}){const[e,r]=re.useState(0),n=Array.isArray(t)&&t.length>0?t:[];if(n.length===0)return m.jsx("div",{className:"w-full h-full flex items-center justify-center bg-stone-100 text-stone-300",children:m.jsx(J0,{size:24,className:"opacity-20"})});const a=o=>{o.stopPropagation(),r(u=>(u+1)%n.length)},i=o=>{o.stopPropagation(),r(u=>(u-1+n.length)%n.length)};return m.jsxs("div",{className:"relative w-full h-full bg-stone-100 group",children:[m.jsx("img",{src:n[e],alt:"product",className:"w-full h-full object-cover transition-transform duration-500 hover:scale-105"}),n.length>1&&m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:i,className:"absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white text-stone-600",children:m.jsx(BM,{size:16})}),m.jsx("button",{onClick:a,className:"absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white text-stone-600",children:m.jsx(kk,{size:16})}),m.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1",children:n.map((o,u)=>m.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${u===e?"bg-orange-500":"bg-white/70"}`},u))})]})]})}function tK({currentUser:t,onLogout:e,onOpenModal:r}){const[n,a]=re.useState(!1),i=t?.isMember,o=async()=>{if(t)if(t.isMember){if(t.memberValidUntil)window.confirm(`
`)&&(await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{memberValidUntil:null,memberCancelledAt:null}),alert(""));else if(window.confirm(`
 30 `)){const u=new Date;u.setDate(u.getDate()+30),await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberValidUntil:u.toISOString(),memberCancelledAt:new Date().toISOString()}),alert(`
 ${u.toLocaleDateString()}`)}}else window.confirm(` PLUS ULTRA 
`)&&(await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberSince:new Date().toISOString(),memberValidUntil:null,memberCancelledAt:null}),alert(""))};return m.jsxs("div",{className:"relative z-50",children:[m.jsxs("button",{onClick:()=>a(!n),className:`w-10 h-10 rounded-full bg-slate-800 border-2 ${i?"border-purple-500":"border-yellow-400"} shadow-lg overflow-hidden hover:scale-105 transition-all relative`,children:[m.jsx("img",{src:t?.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${t?.name}`,alt:"avatar",className:"w-full h-full object-cover"}),i&&m.jsx("div",{className:"absolute -top-1 -right-1 bg-purple-600 rounded-full p-0.5 border border-white",children:m.jsx(Im,{size:8,className:"text-white fill-white"})})]}),n&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"fixed inset-0 z-[-1]",onClick:()=>a(!1)}),m.jsxs("div",{className:"absolute right-0 mt-2 w-60 bg-white rounded-lg shadow-xl border-2 border-slate-900 py-1 z-50 animate-in fade-in slide-in-from-top-2",children:[m.jsxs("div",{className:"px-3 py-2 border-b-2 border-slate-100 bg-slate-50",children:[m.jsxs("div",{className:"flex justify-between items-center mb-1",children:[m.jsxs("span",{className:"text-xs font-black text-slate-500 flex items-center gap-1",children:[m.jsx(Im,{size:12,className:i?"text-purple-600 fill-purple-600":"text-slate-300"}),"PLUS "]}),i&&m.jsx("span",{className:"text-[10px] bg-purple-100 text-purple-700 px-1.5 rounded font-bold",children:"SUBSCRIBED"})]}),m.jsx("button",{onClick:o,className:`w-full text-xs font-bold py-1.5 rounded border-2 transition-all ${i&&t.memberValidUntil?"bg-green-100 text-green-700 border-green-300 hover:bg-green-200":i?"bg-white border-slate-300 text-slate-500 hover:bg-red-50 hover:text-red-500 hover:border-red-300":"bg-purple-600 border-purple-800 text-white hover:bg-purple-700"}`,children:i?t.memberValidUntil?"":"":" (NT$90/)"})]}),m.jsxs("button",{onClick:()=>{a(!1),r("changeName")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[m.jsx(bu,{size:16})," "]}),m.jsxs("button",{onClick:()=>{a(!1),r("changeAvatar")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[m.jsx(oy,{size:16})," "]}),m.jsxs("button",{onClick:()=>{a(!1),r("changePwd")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[m.jsx(Dk,{size:16})," "]}),t?.name===""&&m.jsx("div",{className:"border-t border-slate-100 mt-1",children:m.jsxs(du,{to:"/admin/dashboard",className:"block px-4 py-2 text-sm text-blue-700 font-black hover:bg-blue-50 transition-colors flex items-center gap-2",onClick:()=>a(!1),children:[m.jsx(jk,{size:16})," "]})}),m.jsx("div",{className:"border-t-2 border-slate-100 my-1"}),m.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2 font-black",children:[m.jsx(Ok,{size:16})," "]})]})]})]})}function rK({title:t="",user:e,children:r,onLogout:n,onOpenModal:a}){return m.jsx("header",{className:"sticky top-0 z-30 bg-slate-900 border-b-4 border-yellow-400 px-4 py-3 shadow-md",children:m.jsxs("div",{className:"max-w-5xl mx-auto flex flex-wrap items-center justify-between gap-y-3",children:[m.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto justify-center md:justify-start",children:[m.jsx("div",{className:"bg-yellow-400 p-2 rounded transform -skew-x-12 border-2 border-yellow-800",children:m.jsx(Lk,{size:24,className:"text-slate-900 transform skew-x-12"})}),m.jsx("h1",{className:"text-3xl md:text-2xl font-black italic tracking-tight text-white drop-shadow-md",children:t})]}),m.jsxs("div",{className:"flex items-center w-full md:w-auto md:flex-1 md:justify-end gap-2",children:[m.jsx("div",{className:"flex-1 min-w-0 md:flex-none",children:r}),m.jsxs("div",{className:"text-right hidden md:block shrink-0",children:[m.jsx("p",{className:"text-xs text-slate-400",children:"HERO NAME"}),m.jsx("p",{className:"font-bold text-white tracking-wide",children:e?.name})]}),m.jsx("div",{className:"shrink-0 ml-1",children:m.jsx(tK,{currentUser:e,onLogout:n,onOpenModal:a})})]})]})})}function nK({isMember:t,fee:e,amount:r,description:n}){const i=n||`

  ()
 `;return m.jsxs("div",{className:`\r
            relative group border-r border-slate-700 mr-1 pr-2 sm:mr-2 sm:pr-4\r
            flex w-full items-center justify-end gap-3   /*  */\r
            sm:w-auto sm:flex-col sm:items-end sm:gap-0  /*  */\r
        `,children:[m.jsxs("button",{type:"button",onClick:()=>alert(i),className:`\r
                    focus:outline-none group/btn\r
                    flex items-center gap-2              /*  */\r
                    sm:mb-1 sm:gap-1.5\r
                `,children:[m.jsx("span",{className:"text-[16px] sm:text-base text-slate-400 font-bold whitespace-nowrap pt-0.5",children:""}),m.jsxs("span",{className:"text-[10px] text-yellow-500 group-hover/btn:text-yellow-400 border-b border-dashed border-yellow-500/50 flex items-center gap-0.5 transition-colors",children:[m.jsx("span",{className:"hidden sm:inline",children:"?"}),m.jsx(Ux,{className:"block sm:hidden",size:14}),m.jsx(Ux,{className:"hidden sm:block",size:10})]})]}),m.jsxs("div",{className:"text-yellow-400 font-black drop-shadow-sm text-right flex items-center",children:[m.jsx("span",{className:"text-xs mr-1 text-yellow-200 mt-1",children:"NT$"}),m.jsx("span",{className:"text-xl sm:text-xl font-mono",children:t?`${e} + ${r.toLocaleString()}`:r.toLocaleString()})]}),m.jsx("div",{className:"absolute top-12 right-0 w-max bg-slate-800 text-white text-xs p-2 rounded border border-yellow-400 shadow-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 hidden sm:block whitespace-pre-wrap text-left",children:i})]})}const ux=["","","","","","","",""],aK=90;function sK({appUser:t,usersData:e,handleLogout:r}){const[n,a]=re.useState([]),[i,o]=re.useState([]),[u,f]=re.useState([]),[d,p]=re.useState([]),[x,y]=re.useState(null),[w,b]=re.useState(null),[E,T]=re.useState(null),[I,R]=re.useState("wishing"),[C,z]=re.useState(""),[H,X]=re.useState(""),[A,F]=re.useState("<div>Loading...</div>"),N=15,[P,M]=re.useState(1),[j,B]=re.useState(0),Se=i.find(L=>L.id===w)||null;re.useEffect(()=>{const L=Vr(qt(Ke,"artifacts","default-app-id","public","data","wishes"),je=>a(je.docs.map(ht=>({id:ht.id,...ht.data()})))),Xe=Vr(qt(Ke,"artifacts","default-app-id","public","data","groups"),je=>o(je.docs.map(ht=>({id:ht.id,...ht.data()})))),Pe=Vr(qt(Ke,"artifacts","default-app-id","public","data","orders"),je=>f(je.docs.map(ht=>({id:ht.id,...ht.data()})))),et=Vr(qt(Ke,"artifacts","default-app-id","public","data","miscCharges"),je=>p(je.docs.map(ht=>({id:ht.id,...ht.data()})))),We=Vr(yt(Ke,"artifacts","default-app-id","public","data","system","bulletin"),je=>{je.exists()&&F(je.data().content)});return()=>{L(),Xe(),Pe(),et(),We()}},[]),re.useEffect(()=>{M(1)},[I,C,H]);const we=(L,Xe)=>{const Pe=L.updatedAt||L.createdAt;if(!Pe)return!1;const et=`${Xe}_${L.id}`;let We=t?.readHistory?.[et];if(!We){const je=`read_${t?.id}_${Xe}_${L.id}`;We=localStorage.getItem(je)}return We?new Date(Pe)>new Date(We):!0},se=async(L,Xe)=>{const Pe=new Date().toISOString(),et=`${Xe}_${L.id}`,We=`read_${t?.id}_${Xe}_${L.id}`;if(localStorage.setItem(We,Pe),B(je=>je+1),t&&t.id)try{const je=yt(Ke,"artifacts","default-app-id","public","data","users",t.id);await su(je,{readHistory:{[et]:Pe}},{merge:!0})}catch(je){console.error("",je)}},oe=async L=>{t&&(await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{password:L}),alert(""),y(null))},le=async L=>{if(t)try{await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{name:L}),alert(""),y(null)}catch{alert("")}},ne=async L=>{t&&(await tn(yt(Ke,"artifacts","default-app-id","public","data","users",t.id),{avatar:L}),alert(""),y(null))},ye=async L=>{try{E?await tn(yt(Ke,"artifacts","default-app-id","public","data","wishes",E.id),{...L,updatedAt:new Date().toISOString()}):await bi(qt(Ke,"artifacts","default-app-id","public","data","wishes"),{...L,authorName:t.name,authorId:t.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),plusOnes:[]}),y(null),T(null)}catch{alert("")}},Q=async L=>{if(confirm(`${L.title}`))try{await v0(yt(Ke,"artifacts","default-app-id","public","data","wishes",L.id))}catch(Xe){console.error(Xe)}},O=async L=>{if(!t)return;se(L,"wish");const Xe=L.plusOnes||[],et=Xe.includes(t.name)?Xe.filter(We=>We!==t.name):[...Xe,t.name];await tn(yt(Ke,"artifacts","default-app-id","public","data","wishes",L.id),{plusOnes:et})},Y=async L=>{const Xe={title:`[] ${L.ipName}`,type:"",infoUrl:L.sourceUrl,status:"",createdBy:t.name,createdById:t.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),exchangeRate:.21,shippingFee:0,deadline:"",items:L.items.map(Pe=>({id:Pe.id,name:Pe.name,price:Pe.price,limit:Pe.quantity,image:"",spec:""})),note:L.note,requestType:L.type,secondPayment:{},paymentStatus:""};try{const Pe=await bi(qt(Ke,"artifacts","default-app-id","public","data","groups"),Xe),et=L.items.map(We=>({itemId:We.id,name:We.name,price:We.price,quantity:We.quantity,image:""}));await bi(qt(Ke,"artifacts","default-app-id","public","data","orders"),{groupId:Pe.id,userId:t.id,userName:t.name,items:et,updatedAt:new Date().toISOString()}),y(null),alert("")}catch{alert("")}},q=async(L,Xe)=>{const Pe=u.find(We=>We.groupId===Xe&&We.userId===t.id);if(L.length===0){if(Pe)try{await v0(yt(Ke,"artifacts","default-app-id","public","data","orders",Pe.id)),alert("")}catch{alert("")}y("viewOrders");return}const et={groupId:Xe,userId:t.id,userName:t.name,items:L,updatedAt:new Date().toISOString()};Pe?await tn(yt(Ke,"artifacts","default-app-id","public","data","orders",Pe.id),et):await bi(qt(Ke,"artifacts","default-app-id","public","data","orders"),et),y("viewOrders")},te=re.useMemo(()=>{if(!u||!i||u.length===0||!t)return 0;const L=u.reduce((Pe,et)=>{if(et.userId!==t.id)return Pe;const We=i.find(wt=>wt.id===et.groupId);if(!We)return Pe;const je=u.filter(wt=>wt.groupId===We.id);let ht=0;if(je.forEach(wt=>wt.items.forEach(Ft=>ht+=Number(Ft.quantity)||0)),["","",""].includes(We.status)){const wt=Number(We.exchangeRate||0),Ft=Number(We.shippingFee||0),Hr=ht>0?Ft/ht:0,ns=(et.items||[]).reduce((Xt,Fr)=>Xt+(Number(Fr.quantity)||0),0),Gn=(et.items||[]).reduce((Xt,Fr)=>Xt+(Number(Fr.price)||0)*(Number(Fr.quantity)||0),0),zt=Hr*ns,Gr=Math.round((Gn+zt)*wt);let an=0;if(We.secondPayment){const Fr=We.secondPayment.weights||{},dt=parseFloat(We.secondPayment.boxWeight||0),rr=parseFloat(We.secondPayment.minChargeDiff||0),sn=ht>0?dt*250/ht:0,Mt=new Set(je.map(qr=>qr.userId)),or=Mt.size>0?rr/Mt.size:0;et.items.forEach(qr=>{const dr=parseFloat(Fr[qr.itemId]||0);an+=(dr*250+sn)*qr.quantity}),an+=or}const qn=We.paymentStatus||"";if(qn==="")return Pe+Gr;if(qn==="")return Pe+Math.round(an);if(qn==="+")return Pe+Gr+Math.round(an)}return Pe},0),Xe=d.filter(Pe=>Pe.targetUserId===t.id&&(Pe.paymentStatus||"")==="").reduce((Pe,et)=>Pe+Number(et.amount||0),0);return L+Xe},[u,i,t,d]),{memberFeeSplit:ce,isMember:Te}=re.useMemo(()=>{if(!t||!e.length)return{memberFeeSplit:0,isMember:!1};const L=e.filter(Pe=>Pe.isMember).length;return{memberFeeSplit:L>0?Math.ceil(aK/L):0,isMember:t.isMember}},[t,e]),Re=L=>{let Xe=i.filter(Pe=>L.includes(Pe.status));return(C||H)&&(Xe=Xe.filter(Pe=>{if(!Pe.deadline||Pe.deadline==="")return!1;const et=new Date(Pe.deadline).getTime(),We=C?new Date(C).getTime():0,je=H?new Date(H).getTime()+864e5:1/0;return et>=We&&et<je})),Xe.sort((Pe,et)=>(Pe.releaseDate||"9999-12-31").localeCompare(et.releaseDate||"9999-12-31"))},_e=I==="active"?Re([""]):I==="completed"?Re([""]):I==="shipping"?Re([""]):I==="closed"?Re([""]):[],ke=Math.ceil(_e.length/N),rt=_e.slice((P-1)*N,P*N);return m.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-800 font-sans pb-20 selection:bg-yellow-400 selection:text-black",children:[m.jsx(rK,{user:t,onLogout:r,onOpenModal:L=>y(L),children:m.jsx(nK,{isMember:Te,fee:ce,amount:te})}),m.jsx("section",{className:"max-w-5xl mx-auto mt-6 px-4",children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[m.jsxs("div",{className:"md:col-span-3 bg-white rounded-lg shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] border-2 border-slate-900 overflow-hidden flex flex-col",children:[m.jsxs("div",{className:"bg-yellow-400 border-b-2 border-slate-900 p-3 flex items-center gap-2 text-slate-900 font-black italic transform -skew-x-6",children:[m.jsx(zx,{size:24,className:"fill-slate-900"}),m.jsx("h2",{children:"ACADEMY NEWS"})]}),m.jsx("div",{className:"p-6 flex-1 prose prose-slate prose-sm max-w-none text-slate-700 font-medium",dangerouslySetInnerHTML:{__html:A}})]}),m.jsx("div",{className:"md:col-span-1",children:m.jsx(du,{to:"/jf26",className:"block w-full h-full group hover:-translate-y-1 transition-all",children:m.jsxs("div",{className:"h-full bg-white p-2 rounded-xl border-4 border-slate-900 shadow-[4px_4px_0px_0px_#FACC15] overflow-hidden relative flex flex-col",children:[m.jsx("div",{className:"bg-slate-900 text-yellow-400 font-black text-center text-sm py-1 mb-1 italic",children:"JF26 "}),m.jsx("img",{src:"https://www.jumpfesta.com/assets/images/top_jumpfesta_pc@2x.webp",alt:"JF26",className:"w-full h-full object-cover rounded-lg border-2 border-slate-100"}),m.jsx("div",{className:"absolute top-2 right-2 bg-red-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full animate-pulse border border-white shadow-sm rotate-12",children:"HOT!"})]})})})]})}),m.jsx("nav",{className:"max-w-5xl mx-auto mt-8 px-4",children:m.jsx("div",{className:"bg-white p-1 rounded-lg shadow-sm border-2 border-slate-200 flex justify-around gap-1",children:[{id:"wishing",label:"",icon:xT},{id:"active",label:"",icon:Fm},{id:"completed",label:"",icon:Ck},{id:"shipping",label:"",icon:Mk},{id:"misc",label:"",icon:Ik},{id:"closed",label:"",icon:EM}].map(L=>m.jsxs("button",{onClick:()=>R(L.id),className:`flex-1 flex flex-col items-center justify-center gap-1 py-2 rounded font-black transition-all border-2 ${I===L.id?"bg-slate-900 border-slate-900 text-yellow-400 shadow-md transform -translate-y-1":"bg-transparent border-transparent text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:[m.jsx(L.icon,{size:20,className:I===L.id?"animate-pulse":""}),m.jsx("span",{className:"text-[11px] sm:text-sm whitespace-nowrap",children:L.label})]},L.id))})}),m.jsxs("main",{className:"max-w-5xl mx-auto px-4 py-8",children:[I==="wishing"&&m.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:[m.jsx("div",{className:"flex justify-end mb-6",children:m.jsxs("button",{onClick:()=>{T(null),y("wish")},className:"px-6 py-2 bg-red-600 text-white border-2 border-red-800 rounded font-black hover:bg-red-700 flex items-center gap-2 shadow-[2px_2px_0px_0px_rgba(153,27,27,1)] italic",children:[m.jsx(wu,{size:20})," MAKE A WISH"]})}),m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(L=>m.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 border-slate-200 hover:border-slate-900 hover:shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] transition-all flex flex-col relative",onClick:()=>se(L,"wish"),children:[we(L,"wish")&&m.jsx("div",{className:"absolute -top-3 -left-3 bg-red-600 text-white text-xs font-black px-2 py-1 shadow-md -rotate-12 z-10 border-2 border-white animate-bounce",children:"NEW!"}),m.jsx("div",{className:"mb-3 aspect-video bg-slate-100 rounded overflow-hidden",children:m.jsx(BS,{images:L.images})}),m.jsx("h3",{className:"font-bold text-lg text-slate-900 line-clamp-2 mb-2",children:L.title}),m.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[m.jsxs("span",{className:"bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded font-bold",children:["BY: ",L.authorName]}),L.url&&m.jsxs("a",{href:L.url,target:"_blank",rel:"noreferrer",onClick:Xe=>Xe.stopPropagation(),className:"text-blue-600 font-bold text-xs hover:underline flex items-center gap-1",children:[m.jsx(Cl,{size:10})," Link"]})]}),m.jsx("p",{className:"text-slate-600 text-sm mb-4 line-clamp-3 bg-slate-50 p-2 rounded",children:L.note||""}),m.jsxs("div",{className:"pt-4 border-t border-slate-100 flex justify-between items-end mt-auto",children:[m.jsx("div",{className:"text-xs font-bold text-red-600",children:L.plusOnes?.length>0&&m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(xT,{size:10,className:"fill-red-600"})," ",L.plusOnes.length," "]})}),m.jsxs("div",{className:"flex gap-2",children:[t?.id===L.authorId&&m.jsx("button",{onClick:Xe=>{Xe.stopPropagation(),Q(L)},className:"text-slate-400 hover:text-red-600 p-1",children:m.jsx(hy,{size:16})}),m.jsx("button",{onClick:Xe=>{Xe.stopPropagation(),O(L)},className:`px-3 py-1.5 rounded-full text-sm font-black border-2 transition-all ${L.plusOnes?.includes(t?.name)?"bg-red-100 border-red-500 text-red-600":"bg-white text-slate-400 hover:border-slate-400"}`,children:"+1"})]})]})]},L.id))})]}),I==="misc"&&m.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:m.jsx("div",{className:"bg-white rounded-lg shadow-sm border-2 border-slate-200 overflow-hidden",children:m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"w-full text-sm text-left font-bold min-w-[500px]",children:[m.jsx("thead",{className:"bg-slate-100 text-slate-700 border-b-2 border-slate-200",children:m.jsxs("tr",{children:[m.jsx("th",{className:"px-4 py-3 whitespace-nowrap",children:""}),m.jsx("th",{className:"px-4 py-3 whitespace-nowrap",children:""}),m.jsx("th",{className:"px-4 py-3 whitespace-nowrap",children:""}),m.jsx("th",{className:"px-4 py-3 text-right whitespace-nowrap",children:""}),m.jsx("th",{className:"px-4 py-3 text-center whitespace-nowrap",children:""})]})}),m.jsx("tbody",{children:d.filter(L=>L.targetUserId===t?.id||t?.name==="").sort((L,Xe)=>new Date(Xe.createdAt)-new Date(L.createdAt)).map(L=>m.jsxs("tr",{className:`border-b ${(L.paymentStatus||"")===""?"bg-green-50/50":"hover:bg-slate-50"}`,children:[m.jsx("td",{className:"px-4 py-3 text-slate-500 font-mono text-xs",children:new Date(L.createdAt).toLocaleDateString()}),m.jsx("td",{className:"px-4 py-3",children:L.title}),m.jsx("td",{className:"px-4 py-3 text-slate-400 text-xs truncate max-w-[120px]",children:L.note||"-"}),m.jsxs("td",{className:`px-4 py-3 text-right ${(L.paymentStatus||"")===""?"text-slate-400 line-through":""}`,children:["$",L.amount]}),m.jsx("td",{className:"px-4 py-3 text-center",children:m.jsx("span",{className:`px-2 py-1 rounded text-[10px] ${(L.paymentStatus||"")===""?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:L.paymentStatus||""})})]},L.id))})]})})})}),["active","completed","shipping","closed"].includes(I)&&m.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:[m.jsxs("div",{className:"mb-6 bg-slate-200 p-3 rounded-lg flex flex-col sm:flex-row items-center gap-4 border-2 border-slate-300",children:[m.jsx(Pk,{size:18,className:"text-slate-500"}),m.jsxs("div",{className:"flex items-center gap-2 flex-1 w-full font-bold",children:[m.jsx("input",{type:"date",className:"border-2 border-slate-300 rounded px-2 py-1 text-sm flex-1",value:C,onChange:L=>z(L.target.value)}),m.jsx("span",{className:"text-slate-400",children:"~"}),m.jsx("input",{type:"date",className:"border-2 border-slate-300 rounded px-2 py-1 text-sm flex-1",value:H,onChange:L=>X(L.target.value)}),(C||H)&&m.jsx("button",{onClick:()=>{z(""),X("")},className:"text-xs bg-slate-400 text-white px-3 py-1.5 rounded",children:""})]})]}),I==="active"&&t?.name!==""&&m.jsx("div",{className:"flex justify-end mb-6",children:m.jsxs("button",{onClick:()=>y("createPersonalRequest"),className:"px-6 py-2 bg-purple-600 text-white rounded border-2 border-purple-800 font-black hover:bg-purple-700 flex items-center gap-2 shadow-[4px_4px_0px_0px_#4c1d95] italic",children:[m.jsx(Fm,{size:18})," "]})}),m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:rt.map(L=>{const Xe=!!u.find(Pe=>Pe.groupId===L.id&&Pe.userId===t?.id);return m.jsxs("div",{className:`bg-white rounded-lg p-5 border-2 border-slate-900 flex flex-col relative ${I==="closed"?"opacity-75 grayscale-[0.5]":""}`,onClick:()=>I==="active"&&se(L,"group"),children:[I==="active"&&we(L,"group")&&m.jsx("div",{className:"absolute -top-3 -left-3 bg-red-600 text-white text-xs font-black px-2 py-1 shadow-md -rotate-12 z-10 border-2 border-white animate-bounce",children:"NEW!"}),m.jsxs("div",{className:"flex flex-col gap-1 mb-2",children:[m.jsx("span",{className:`self-start px-2 py-0.5 text-[10px] font-black rounded border ${L.type===""?"bg-green-600 text-white border-green-800":L.type===""?"bg-purple-600 text-white border-purple-800":"bg-yellow-400 text-slate-900 border-slate-900"}`,children:L.type===""?" ":L.type===""?" ":" "}),m.jsx("h3",{className:"font-black text-xl italic",children:L.title})]}),m.jsx("div",{className:"mb-4 aspect-video bg-slate-100 rounded overflow-hidden",children:m.jsx(BS,{images:L.images||[]})}),m.jsxs("div",{className:"space-y-2 text-sm text-slate-600 mb-6 flex-1 font-bold",children:[m.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1",children:[m.jsx("span",{children:""}),m.jsx("span",{className:"text-red-600",children:L.deadline})]}),L.releaseDate&&m.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1",children:[m.jsx("span",{children:""}),m.jsx("span",{className:"text-blue-600",children:L.releaseDate})]}),L.infoUrl&&m.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1",children:[m.jsx("span",{children:""}),m.jsx("a",{href:L.infoUrl,target:"_blank",rel:"noreferrer",onClick:Pe=>Pe.stopPropagation(),className:"text-blue-600 hover:underline",children:"Link"})]}),Xe&&I==="active"&&m.jsx("div",{className:"mt-2 bg-green-100 text-green-700 border border-green-300 px-2 py-1 rounded text-center text-xs font-black",children:" (ORDERED)"})]}),L.status!==""&&m.jsxs("div",{className:"mb-4",children:[m.jsx("div",{className:"flex justify-between text-[10px] text-slate-400 mb-1 font-bold",children:ux.map(Pe=>m.jsx("span",{className:L.trackingStatus===Pe?"text-blue-600":"",children:Pe},Pe))}),m.jsx("div",{className:"h-3 bg-slate-200 rounded-full flex border border-slate-300 overflow-hidden",children:ux.map((Pe,et)=>m.jsx("div",{className:`flex-1 border-r border-white last:border-0 ${et<=ux.indexOf(L.trackingStatus||"")?"bg-blue-600":""}`},Pe))})]}),m.jsxs("div",{className:"flex gap-2 mt-auto",children:[I==="active"&&m.jsx("button",{className:`flex-1 px-4 py-2 rounded font-black text-white border-2 transition-all ${Xe?"bg-green-600 border-green-800":"bg-red-600 border-red-800"}`,onClick:Pe=>{Pe.stopPropagation(),b(L.id),y("joinGroup")},children:Xe?"":""}),m.jsx("button",{className:`px-3 py-2 rounded font-bold border-2 flex-1 ${I==="active"?"bg-white border-slate-300 text-slate-600":"bg-slate-100 border-slate-300 text-slate-700"}`,onClick:Pe=>{Pe.stopPropagation(),b(L.id),y("viewOrders")},children:""}),["shipping","closed"].includes(I)&&m.jsx("button",{className:"px-3 py-2 rounded font-bold border-2 bg-yellow-400 border-slate-900 text-slate-900 flex-1",onClick:Pe=>{Pe.stopPropagation(),b(L.id),y("secondPayment")},children:""})]})]},L.id)})}),ke>1&&m.jsxs("div",{className:"flex justify-center items-center gap-2 mt-8",children:[m.jsx("button",{onClick:()=>M(L=>Math.max(1,L-1)),className:"px-3 py-1 rounded font-black border-2 border-slate-900 bg-white",children:"PREV"}),Array.from({length:ke},(L,Xe)=>Xe+1).map(L=>m.jsx("button",{onClick:()=>M(L),className:`w-8 h-8 rounded border-2 border-slate-900 font-black ${P===L?"bg-slate-900 text-yellow-400":"bg-white"}`,children:L},L)),m.jsx("button",{onClick:()=>M(L=>Math.min(ke,L+1)),className:"px-3 py-1 rounded font-black border-2 border-slate-900 bg-white",children:"NEXT"})]})]})]}),m.jsx(ca,{isOpen:x==="wish",onClose:()=>{y(null),T(null)},title:E?"":"",children:m.jsx(YL,{onSubmit:ye,onCancel:()=>{y(null),T(null)},initialData:E})}),m.jsx(ca,{isOpen:x==="createPersonalRequest",onClose:()=>y(null),title:"",children:m.jsx($L,{onSubmit:Y,onCancel:()=>y(null)})}),m.jsx(ca,{isOpen:x==="secondPayment",onClose:()=>y(null),title:"",children:Se&&m.jsx(d3,{group:Se,orders:u.filter(L=>L.groupId===Se?.id),currentUser:t,onUpdate:null,isReadOnly:!0})}),m.jsx(ca,{isOpen:x==="changeName",onClose:()=>y(null),title:"",children:m.jsx(tC,{currentUser:t,onSubmit:le,onCancel:()=>y(null)})}),m.jsx(ca,{isOpen:x==="changePwd",onClose:()=>y(null),title:"",children:m.jsx(nC,{onSubmit:oe})}),m.jsx(ca,{isOpen:x==="changeAvatar",onClose:()=>y(null),title:"",children:m.jsx(rC,{currentUser:t,onSubmit:ne})}),m.jsx(ca,{isOpen:x==="joinGroup",onClose:()=>y(null),title:`${Se?.title}`,children:Se&&m.jsx(KL,{group:Se,currentOrder:u.find(L=>L.groupId===Se?.id&&L.userId===t?.id),onSubmit:L=>q(L,Se.id)})}),m.jsx(ca,{isOpen:x==="viewOrders",onClose:()=>y(null),title:`${Se?.title}`,children:Se&&m.jsx(Z$,{group:Se,orders:u.filter(L=>L.groupId===Se?.id),currentUser:t,onEdit:Se?.status===""?()=>y("joinGroup"):null})})]})}const iK=()=>{const[t,e]=re.useState(!1),[r,n]=re.useState([]),[a,i]=re.useState([]),[o,u]=re.useState(null),[f,d]=re.useState(0),p=M0(),x=["artifacts","default-app-id","public","data","backorders"],y=["artifacts","default-app-id","public","data","groups"],w=H=>n(X=>[...X,H]),b=async()=>{try{const H=qt(Ke,...x),X=await bl(H),A=new Set;X.forEach(F=>{const N=F.data();N.sheetCategory&&A.add(N.sheetCategory)}),i(Array.from(A).sort())}catch(H){console.error("",H)}},E=async()=>{try{const H=qt(Ke,...y),X=await bl(H);d(X.size)}catch(H){console.error(H)}};re.useEffect(()=>{b(),E()},[]);const T=async H=>{if(window.confirm(` ${H}`)){e(!0),w(`  [${H}]...`);try{const X=qt(Ke,...x),A=Px(X,HA("sheetCategory","==",H)),F=await bl(A),N=jx(Ke);F.forEach(P=>N.delete(P.ref)),await N.commit(),w(" "),b()}catch(X){w(` : ${X.message}`)}finally{e(!1)}}},I=H=>{const X=H.target.files[0];X&&(u(X),n([` ${X.name}`," "]))},R=async()=>{if(!o)return;e(!0),n(X=>[...X," ..."]);const H=new FileReader;H.onload=async X=>{try{const A=X.target.result,F=av(A,{type:"binary"});let N=F.SheetNames.filter(M=>M.includes(""));N.length===0&&(N=F.SheetNames),w(` : ${N.join(", ")}`);const P=[];if(N.forEach(M=>{const j=F.Sheets[M],B=cm.sheet_to_json(j,{header:1});let Se=-1,we={};for(let se=0;se<B.length;se++)if(JSON.stringify(B[se]).includes("")){Se=se,B[se].forEach((oe,le)=>{if(typeof oe!="string")return;const ne=oe.trim();ne.includes("")?we.title=le:ne.includes("")?we.type=le:ne.includes("")||ne.includes("")?we.orderDate=le:ne.includes("")?we.rate=le:ne.includes("")?we.status=le:ne.includes("")?we.payProgress=le:ne.includes("")?we.payStatus=le:ne.includes("")&&(we.link=le)});break}if(Se!==-1)for(let se=Se+1;se<B.length;se++){const oe=B[se];if(!we.title||!oe[we.title])continue;let le="";oe[we.status]&&String(oe[we.status]).includes("")&&(le="");let ne=oe[we.orderDate],ye=oe[we.rate];const Q={title:oe[we.title],type:oe[we.type]||"",orderDate:ne||"",rate:parseFloat(ye)||0,status:le,paymentStatus:`${oe[we.payProgress]||""} ${oe[we.payStatus]||""}`.trim(),link:oe[we.link]||"",sheetCategory:M,createdAt:new Date().toISOString(),isArchived:le===""};Object.keys(Q).forEach(O=>Q[O]===void 0&&delete Q[O]),P.push(Q)}}),P.length===0)w(" ");else{const M=qt(Ke,...x),j=500;let B=0;for(let Se=0;Se<P.length;Se+=j){const we=P.slice(Se,Se+j);await Promise.all(we.map(async se=>{await bi(M,se),B++}))}w(`  ${B}  backorders`),b(),u(null),document.getElementById("file_input").value=""}}catch(A){w(` : ${A.message}`)}finally{e(!1)}},H.readAsBinaryString(o)},C=async()=>{if(window.confirm(`backordersgroups
 Groups

`)){e(!0),w("  Groups...");try{const H=qt(Ke,...x),X=await bl(H);if(X.empty){w(" backorders "),e(!1);return}const A=qt(Ke,...y);let F=0;const N=X.docs.map(async P=>{const M=P.data();let j=M.rate,B=M.orderDate;(j===0||!j)&&typeof M.orderDate=="number"&&M.orderDate<1&&(j=M.orderDate,B="");let Se="2025-12-31T23:59";typeof B=="string"&&B.includes(".")&&(Se=B.replace(/\./g,"-")+"T23:59");const we={title:M.title,exchangeRate:Number(j)||0,deadline:Se,status:"",trackingStatus:M.status||"",paymentStatus:M.paymentStatus||"",type:M.type||"",infoUrl:M.link||"",createdBy:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),sheetCategory:M.sheetCategory,images:[],items:[{id:1,name:M.title,spec:"",price:"0",image:""}]};await bi(A,we),F++});await Promise.all(N),w(`  ${F} `),E()}catch(H){console.error(H),w(` : ${H.message}`)}finally{e(!1)}}},z=async()=>{const H=prompt(`  (Groups)


 'DELETE' `);if(H!=="DELETE"){H!==null&&alert("");return}e(!0),w("  Groups ...");try{const X=qt(Ke,...y),A=await bl(X);if(A.empty){w(" Groups "),e(!1);return}const F=jx(Ke);let N=0;A.forEach(P=>{F.delete(P.ref),N++}),await F.commit(),w(`  Groups ${N} `),E()}catch(X){w(` : ${X.message}`)}finally{e(!1)}};return m.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:m.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:""}),m.jsx("button",{onClick:()=>p("/"),className:"px-4 py-2 bg-white border rounded shadow-sm hover:bg-gray-50",children:" "})]}),m.jsxs("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-blue-500",children:[m.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-2 flex items-center gap-2",children:[m.jsx(YM,{}),"  1 Excel  (Backorders)"]}),m.jsxs("div",{className:"flex gap-4 items-end",children:[m.jsx("input",{id:"file_input",type:"file",accept:".xlsx, .xls",onChange:I,disabled:t,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),m.jsx("button",{onClick:R,disabled:!o||t,className:`px-6 py-2 rounded-lg font-bold text-white ${o?"bg-blue-600 hover:bg-blue-700":"bg-gray-400"}`,children:""})]})]}),m.jsxs("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-yellow-500",children:[m.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:" 2"}),m.jsx("div",{className:"bg-gray-50 rounded-md p-4 max-h-40 overflow-y-auto mb-4",children:a.length===0?m.jsx("p",{className:"text-sm text-gray-400",children:""}):m.jsx("ul",{className:"space-y-2",children:a.map(H=>m.jsxs("li",{className:"flex justify-between items-center text-sm",children:[m.jsx("span",{children:H}),m.jsxs("button",{onClick:()=>T(H),className:"text-red-600 hover:underline flex items-center gap-1",children:[m.jsx(hy,{size:14})," "]})]},H))})})]}),m.jsx("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-green-500",children:m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("div",{children:[m.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[m.jsx(DP,{}),"  3 (Sync to Groups)"]}),m.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[" Groups  ",m.jsx("span",{className:"font-bold text-green-600",children:f})," "]})]}),m.jsx("button",{onClick:C,disabled:t||a.length===0,className:`px-6 py-3 rounded-lg font-bold text-white shadow-lg transition-transform transform active:scale-95 ${t||a.length===0?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:" "})]})}),m.jsx("div",{className:"bg-red-50 shadow rounded-lg p-6 border-2 border-red-200",children:m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("div",{children:[m.jsxs("h3",{className:"text-lg font-bold text-red-700 flex items-center gap-2",children:[m.jsx(Bk,{})," "]}),m.jsx("p",{className:"text-sm text-red-600 mt-1",children:" Groups "})]}),m.jsxs("button",{onClick:z,disabled:t||f===0,className:`px-4 py-2 rounded-lg font-bold text-white shadow transition-colors ${t||f===0?"bg-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700"}`,children:["  Groups (",f,")"]})]})}),m.jsx("div",{className:"bg-black text-green-400 p-4 rounded-lg shadow h-64 overflow-y-auto font-mono text-xs leading-5",children:r.length===0?"...":r.map((H,X)=>m.jsx("div",{className:"border-b border-gray-800 pb-1 mb-1 break-all",children:H},X))})]})})},lK=({onOpenSecondPay:t})=>{const[e,r]=re.useState([]),[n,a]=re.useState([]),[i,o]=re.useState(null),[u,f]=re.useState([]),[d,p]=re.useState(!0),[x,y]=re.useState(!1),[w,b]=re.useState({});M0();const E=["artifacts","default-app-id","public","data","groups"],T=["artifacts","default-app-id","public","data","users"],I=["artifacts","default-app-id","public","data","orders"],R=async()=>{p(!0);try{const le=qt(Ke,...E),ne=Px(le,h9("createdAt","desc")),Q=(await bl(ne)).docs.map(q=>({id:q.id,...q.data()}));if(r(Q),Q.length>0){const q=Q[0].sheetCategory||"";b({[q]:!0})}const O=qt(Ke,...T),Y=await bl(O);a(Y.docs.map(q=>({id:q.id,...q.data()})))}catch(le){console.error("",le)}finally{p(!1)}};re.useEffect(()=>{R()},[]);const C=re.useMemo(()=>{const le={};return e.forEach(ne=>{const ye=ne.sheetCategory||"";le[ye]||(le[ye]=[]),le[ye].push(ne)}),Object.keys(le).sort().reduce((ne,ye)=>(ne[ye]=le[ye],ne),{})},[e]),z=le=>{b(ne=>({...ne,[le]:!ne[le]}))},H=async le=>{o(le),f([]);try{const ne=qt(Ke,...I),ye=Px(ne,HA("groupId","==",le.id)),Q=await bl(ye);f(Q.docs.map(O=>({id:O.id,...O.data()})))}catch(ne){console.error("",ne)}},X=async()=>{if(i){y(!0);try{const le=yt(Ke,...E,i.id),{id:ne,...ye}=i;ye.updatedAt=new Date().toISOString(),ye.trackingStatus===""?(ye.isArchived=!0,ye.status=""):ye.trackingStatus===""?ye.status="":(ye.isArchived=!1,ye.status=""),await tn(le,ye);const Q=qt(Ke,...I),O=u.map(async Y=>{const q=Y.items?.reduce((Te,Re)=>Te+Number(Re.price)*Number(Re.quantity),0)||0,te=Math.ceil(q*(i.exchangeRate||0)),ce={groupId:i.id,userId:Y.userId,userName:Y.userName,items:Y.items,totalJpy:q,totalTwd:te,updatedAt:new Date().toISOString()};if(Y.isNew){const{isNew:Te,id:Re,..._e}=ce;return _e.createdAt=new Date().toISOString(),bi(Q,_e)}else{const Te=yt(Ke,...I,Y.id);return tn(Te,ce)}});await Promise.all(O),r(Y=>Y.map(q=>q.id===i.id?{...q,...ye}:q)),alert(" ")}catch{alert(" ")}finally{y(!1)}}},A=async le=>{if(window.confirm(" "))try{await v0(yt(Ke,...E,le)),o(null),R()}catch{alert("")}},F=(le,ne,ye)=>{const Q=[...i.items];Q[le][ne]=ye,o({...i,items:Q})},N=()=>o({...i,items:[...i.items||[],{id:Date.now(),name:"",spec:"",price:"",image:""}]}),P=le=>o({...i,items:i.items.filter((ne,ye)=>ye!==le)}),M=()=>f([...u,{id:`temp-${Date.now()}`,isNew:!0,userId:"",userName:"",items:[]}]),j=async le=>{window.confirm("")&&(u[le].isNew||await v0(yt(Ke,...I,u[le].id)),f(u.filter((ne,ye)=>ye!==le)))},B=(le,ne)=>{const ye=n.find(O=>O.id===ne),Q=[...u];Q[le].userId=ne,Q[le].userName=ye?ye.name:"",f(Q)},Se=le=>{const ne=[...u];ne[le].items.push({itemId:"",name:"",quantity:1,price:0,spec:""}),f(ne)},we=(le,ne,ye,Q)=>{const O=[...u];if(ye==="itemId"){const Y=i.items.find(q=>String(q.id)===String(Q));Y&&(O[le].items[ne]={...O[le].items[ne],itemId:Y.id,name:Y.name,price:Y.price,spec:Y.spec||""})}else O[le].items[ne][ye]=Q;f(O)},se=(le,ne)=>{const ye=[...u];ye[le].items=ye[le].items.filter((Q,O)=>O!==ne),f(ye)},oe=le=>le.items?.reduce((ne,ye)=>ne+Number(ye.price)*Number(ye.quantity),0)||0;return d?m.jsx("div",{className:"p-10 text-center font-bold text-slate-400 animate-pulse uppercase tracking-widest italic",children:"Syncing Base..."}):m.jsxs("div",{className:"flex h-[calc(100vh-160px)] bg-gray-100 overflow-hidden text-sm rounded-2xl border-4 border-slate-900 shadow-[8px_8px_0px_0px_#0f172a]",children:[m.jsxs("div",{className:"w-1/3 md:w-1/4 bg-white border-r-4 border-slate-900 flex flex-col",children:[m.jsx("div",{className:"p-4 border-b-4 border-slate-900 bg-slate-900 flex justify-between items-center text-white",children:m.jsxs("h2",{className:"font-black italic tracking-tighter uppercase flex items-center gap-2",children:[m.jsx(gT,{size:18,className:"text-yellow-400"})," Mission List"]})}),m.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 bg-slate-50",children:Object.entries(C).map(([le,ne])=>m.jsxs("div",{className:"mb-1",children:[m.jsxs("button",{onClick:()=>z(le),className:"w-full flex items-center gap-2 p-2 hover:bg-white text-left font-black text-slate-700 transition-colors uppercase tracking-tight",children:[w[le]?m.jsx(jM,{size:16}):m.jsx(kk,{size:16}),m.jsx(gT,{size:16,className:`transition-colors ${w[le]?"text-yellow-500 fill-yellow-500":"text-slate-400"}`}),m.jsx("span",{className:"truncate flex-1 text-[10px]",children:le}),m.jsx("span",{className:"text-[10px] bg-slate-900 text-white px-1.5 rounded font-mono",children:ne.length})]}),w[le]&&m.jsx("div",{className:"space-y-0.5 mt-0.5",children:ne.map(ye=>m.jsxs("div",{onClick:()=>H(ye),className:`group ml-4 pl-4 pr-2 py-2.5 cursor-pointer border-l-4 transition-all flex justify-between items-center rounded-r-lg ${i?.id===ye.id?"bg-blue-600 border-yellow-400 text-white shadow-md":"border-slate-200 text-slate-500 hover:bg-slate-200/50 hover:border-slate-400"}`,children:[m.jsxs("div",{className:"truncate flex-1",children:[m.jsx("div",{className:"truncate font-bold leading-tight",children:ye.title}),m.jsx("div",{className:`text-[9px] font-black uppercase mt-0.5 ${i?.id===ye.id?"text-blue-100":"text-slate-400"}`,children:ye.trackingStatus})]}),m.jsx("button",{onClick:Q=>{Q.stopPropagation(),t(ye.id)},className:`p-1.5 rounded transition-all transform hover:scale-110 active:scale-95 ${i?.id===ye.id?"text-yellow-400 hover:bg-blue-700":"text-slate-400 hover:bg-white hover:text-blue-600 shadow-sm border border-transparent hover:border-slate-200"}`,title:"",children:m.jsx(ly,{size:16,strokeWidth:2.5})})]},ye.id))})]},le))})]}),m.jsx("div",{className:"flex-1 flex flex-col h-full overflow-hidden bg-white",children:i?m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"p-4 bg-white border-b-4 border-slate-900 flex flex-col md:flex-row justify-between items-start md:items-center gap-3 z-10",children:[m.jsxs("div",{children:[m.jsxs("h2",{className:"text-xl font-black flex items-center gap-2 text-slate-900 italic uppercase tracking-tighter",children:[m.jsx(uy,{size:20,className:"text-blue-600"})," ",i.title]}),m.jsx("div",{className:"flex items-center gap-2 mt-1",children:m.jsxs("span",{className:"text-[10px] font-black bg-slate-100 px-1.5 py-0.5 rounded text-slate-500 border border-slate-200 uppercase tracking-widest",children:["Folder: ",i.sheetCategory||"Unclassified"]})})]}),m.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[m.jsx("button",{onClick:()=>A(i.id),className:"flex-1 md:flex-none px-4 py-2 text-red-600 hover:bg-red-50 border-2 border-transparent hover:border-red-200 rounded font-black text-xs uppercase transition-all",children:"Delete"}),m.jsx("button",{onClick:X,disabled:x,className:"flex-1 md:flex-none px-6 py-2 bg-slate-900 text-yellow-400 rounded-lg hover:bg-slate-800 flex items-center justify-center gap-2 shadow-[4px_4px_0px_0px_#000] font-black text-xs uppercase tracking-widest active:translate-y-0.5 active:shadow-none transition-all",children:x?"Saving...":"Save Mission"})]})]}),m.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 bg-slate-50/50",children:m.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[m.jsxs("div",{className:"bg-white p-6 rounded-xl border-2 border-slate-900 shadow-sm",children:[m.jsxs("h3",{className:"text-sm font-black mb-4 text-slate-900 border-b-2 border-slate-100 pb-2 flex items-center gap-2 uppercase italic tracking-tighter",children:[m.jsx(Z0,{size:16,className:"text-blue-600"})," Basic Intel"]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[m.jsxs("div",{className:"md:col-span-2",children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest",children:"Mission Title"}),m.jsx("input",{type:"text",value:i.title,onChange:le=>o({...i,title:le.target.value}),className:"w-full border-2 border-slate-200 p-2 rounded-lg font-bold focus:border-slate-900 outline-none transition-colors"})]}),m.jsxs("div",{className:"md:col-span-2",children:[m.jsx("label",{className:"block text-[10px] font-black text-blue-600 mb-1 uppercase tracking-widest",children:"Folder Name (Sorting)"}),m.jsx("input",{list:"category-list",type:"text",value:i.sheetCategory||"",onChange:le=>o({...i,sheetCategory:le.target.value}),className:"w-full border-2 border-blue-200 p-2 rounded-lg font-bold bg-blue-50/50 focus:border-blue-600 outline-none transition-colors",placeholder:"e.g. 2025.12 Jump Festa"}),m.jsx("datalist",{id:"category-list",children:Object.keys(C).map(le=>m.jsx("option",{value:le},le))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest",children:"Group Type"}),m.jsx("select",{value:i.type||"",onChange:le=>o({...i,type:le.target.value}),className:"w-full border-2 border-slate-200 p-2 rounded-lg font-bold bg-white",children:["","",""].map(le=>m.jsx("option",{value:le,children:le},le))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest",children:"Tracking Status"}),m.jsx("select",{value:i.trackingStatus||"",onChange:le=>o({...i,trackingStatus:le.target.value}),className:"w-full border-2 border-slate-200 p-2 rounded-lg font-bold bg-white",children:["","","","","","","",""].map(le=>m.jsx("option",{value:le,children:le},le))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest",children:"Exchange Rate"}),m.jsx("input",{type:"number",step:"0.001",value:i.exchangeRate,onChange:le=>o({...i,exchangeRate:Number(le.target.value)}),className:"w-full border-2 border-slate-200 p-2 rounded-lg font-mono font-bold"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-blue-600 mb-1 uppercase tracking-widest",children:"Domestic Ship ()"}),m.jsx("input",{type:"number",value:i.shippingFee||0,onChange:le=>o({...i,shippingFee:Number(le.target.value)}),className:"w-full border-2 border-blue-100 p-2 rounded-lg font-mono font-bold bg-blue-50/30"})]})]})]}),m.jsxs("div",{className:"bg-white p-6 rounded-xl border-2 border-slate-900 shadow-sm",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4 border-b-2 border-slate-100 pb-2",children:[m.jsxs("h3",{className:"text-sm font-black text-slate-900 flex items-center gap-2 uppercase italic tracking-tighter",children:[m.jsx(Fk,{size:16,className:"text-blue-600"})," Items List"]}),m.jsx("button",{onClick:N,className:"px-3 py-1 bg-slate-900 text-white rounded-full text-[10px] font-black uppercase tracking-widest hover:bg-slate-700 transition-colors",children:"+ Add Item"})]}),m.jsx("div",{className:"space-y-2",children:i.items?.map((le,ne)=>m.jsxs("div",{className:"flex gap-2 items-center bg-slate-50 p-2 rounded-lg border border-slate-100 group",children:[m.jsx("input",{type:"text",placeholder:"Name",value:le.name,onChange:ye=>F(ne,"name",ye.target.value),className:"flex-1 p-1.5 border-2 border-transparent bg-transparent focus:bg-white focus:border-slate-200 rounded text-sm font-bold"}),m.jsx("input",{type:"text",placeholder:"Spec",value:le.spec,onChange:ye=>F(ne,"spec",ye.target.value),className:"w-24 p-1.5 border-2 border-transparent bg-transparent focus:bg-white focus:border-slate-200 rounded text-sm font-bold"}),m.jsxs("div",{className:"flex items-center gap-1 bg-white px-2 py-1 rounded border border-slate-200",children:[m.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:""}),m.jsx("input",{type:"number",value:le.price,onChange:ye=>F(ne,"price",ye.target.value),className:"w-16 text-sm font-black text-blue-600 outline-none text-right"})]}),m.jsx("button",{onClick:()=>P(ne),className:"text-slate-300 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100",children:m.jsx(fa,{size:18})})]},ne))})]}),m.jsxs("div",{className:"bg-white p-6 rounded-xl border-2 border-slate-900 shadow-sm relative overflow-hidden",children:[m.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5 pointer-events-none",children:m.jsx(Om,{size:120})}),m.jsxs("div",{className:"flex justify-between items-center mb-4 border-b-2 border-slate-100 pb-2",children:[m.jsxs("h3",{className:"text-sm font-black text-slate-900 flex items-center gap-2 uppercase italic tracking-tighter relative z-10",children:[m.jsx(Om,{size:16,className:"text-blue-600"})," Hero Orders"]}),m.jsx("button",{onClick:M,className:"px-3 py-1 bg-blue-600 text-white rounded-full text-[10px] font-black uppercase tracking-widest hover:bg-blue-700 transition-colors shadow-sm relative z-10",children:"+ New Order"})]}),m.jsx("div",{className:"space-y-4 relative z-10",children:u.map((le,ne)=>{const ye=oe(le),Q=Math.ceil(ye*(i.exchangeRate||0));return m.jsxs("div",{className:"border-2 border-slate-200 rounded-xl p-4 bg-slate-50/50 hover:border-blue-200 transition-colors",children:[m.jsxs("div",{className:"flex justify-between items-center mb-3",children:[m.jsxs("select",{value:le.userId,onChange:O=>B(ne,O.target.value),className:"p-1.5 border-2 border-slate-200 rounded-lg font-black text-blue-600 bg-white text-sm outline-none focus:border-blue-400",children:[m.jsx("option",{value:"",children:"-- Select Member --"}),n.map(O=>m.jsx("option",{value:O.id,children:O.name},O.id))]}),m.jsxs("div",{className:"text-right flex flex-col items-end",children:[m.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-tighter",children:"Est. Subtotal"}),m.jsxs("div",{className:"font-black text-red-600 italic text-lg",children:["NT$ ",Q.toLocaleString()]})]})]}),m.jsxs("div",{className:"pl-4 border-l-4 border-slate-200 space-y-2",children:[le.items?.map((O,Y)=>m.jsxs("div",{className:"flex gap-2 items-center",children:[m.jsxs("select",{value:O.itemId,onChange:q=>we(ne,Y,"itemId",q.target.value),className:"flex-1 p-1.5 border border-slate-200 rounded bg-white text-xs font-bold",children:[m.jsx("option",{value:"",children:"-- Choose Item --"}),i.items?.map(q=>m.jsxs("option",{value:q.id,children:[q.name," (",q.price,")"]},q.id))]}),m.jsxs("div",{className:"flex items-center gap-1 bg-slate-200 px-2 rounded",children:[m.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"x"}),m.jsx("input",{type:"number",value:O.quantity,onChange:q=>we(ne,Y,"quantity",q.target.value),className:"w-10 p-1 bg-transparent text-center font-black text-slate-700 outline-none text-xs"})]}),m.jsx("button",{onClick:()=>se(ne,Y),className:"text-slate-300 hover:text-red-500 transition-colors",children:m.jsx(fa,{size:16})})]},Y)),m.jsxs("button",{onClick:()=>Se(ne),className:"text-[10px] font-black text-blue-500 hover:text-blue-700 transition-colors uppercase tracking-widest flex items-center gap-1 mt-2",children:[m.jsx(wu,{size:12})," Append Item"]})]}),m.jsx("div",{className:"text-right mt-3 pt-2 border-t border-slate-200",children:m.jsx("button",{onClick:()=>j(ne),className:"text-[10px] font-bold text-slate-300 hover:text-red-400 transition-colors uppercase italic tracking-tighter",children:"Remove Order Record"})})]},le.id)})})]})]})})]}):m.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-200 bg-slate-50/30 uppercase tracking-[0.2em]",children:[m.jsx(yp,{size:100,strokeWidth:1,className:"mb-4 opacity-20 text-slate-400"}),m.jsx("p",{className:"text-xl font-black italic text-slate-300",children:"Select Mission"})]})})]})},oK=({initialContent:t,onChange:e})=>{const r=re.useRef(null);re.useEffect(()=>{r.current&&r.current.innerHTML!==t&&(r.current.innerHTML=t)},[t]);const n=(o,u=null)=>{document.execCommand(o,!1,u),r.current&&e(r.current.innerHTML)},a=[{name:"Black",value:"#000000"},{name:"Red",value:"#EF4444"},{name:"Orange",value:"#F97316"},{name:"Blue",value:"#3B82F6"}],i=({onClick:o,title:u,children:f})=>m.jsx("button",{type:"button",onClick:o,title:u,className:"p-1.5 hover:bg-slate-200 rounded text-slate-600 transition-colors",children:f});return m.jsxs("div",{className:"border-2 border-slate-900 rounded-lg overflow-hidden flex flex-col h-64 bg-white shadow-sm",children:[m.jsxs("div",{className:"bg-slate-50 border-b-2 border-slate-900 p-2 flex flex-wrap gap-1 items-center",children:[m.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[m.jsx(i,{onClick:()=>n("bold"),title:"",children:m.jsx(IM,{size:14})}),m.jsx(i,{onClick:()=>n("italic"),title:"",children:m.jsx(cP,{size:14})}),m.jsx(i,{onClick:()=>n("underline"),title:"",children:m.jsx(lj,{size:14})})]}),m.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[m.jsx(i,{onClick:()=>n("justifyLeft"),title:"",children:m.jsx(ej,{size:14})}),m.jsx(i,{onClick:()=>n("justifyCenter"),title:"",children:m.jsx(JP,{size:14})}),m.jsx(i,{onClick:()=>n("justifyRight"),title:"",children:m.jsx(KP,{size:14})})]}),m.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[m.jsx(i,{onClick:()=>n("fontSize","5"),title:"",children:m.jsx(W1,{size:16})}),m.jsx(i,{onClick:()=>n("fontSize","3"),title:"",children:m.jsx(W1,{size:12})}),m.jsx(i,{onClick:()=>n("fontSize","1"),title:"",children:m.jsx(W1,{size:10})})]}),m.jsx("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:a.map(o=>m.jsx("button",{type:"button",onClick:()=>n("foreColor",o.value),className:"w-5 h-5 rounded border border-slate-300 hover:scale-110 transition-transform",style:{backgroundColor:o.value},title:o.name},o.value))}),m.jsx(i,{onClick:()=>{const o=prompt(":","http://");o&&n("createLink",o)},title:"",children:m.jsx(Dm,{size:14})})]}),m.jsx("div",{className:"flex-1 p-4 focus:outline-none overflow-y-auto prose prose-slate prose-sm max-w-none",contentEditable:!0,suppressContentEditableWarning:!0,ref:r,onInput:o=>e(o.currentTarget.innerHTML)})]})},cK=["","","","","","","",""],uK=250;function fK({currentUser:t}){const[e,r]=re.useState([]),[n,a]=re.useState({exchangeRate:.24,totalShippingJPY:0,status:"",intlShippingTWD:0,secondPayment:{weights:{},boxWeight:0,minChargeDiff:0}}),[i,o]=re.useState(!0),[u,f]=re.useState(!1);re.useEffect(()=>{const b=yt(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),E=Vr(b,T=>{if(T.exists()){const I=T.data(),C=(I.orders||[]).sort((z,H)=>z.buyer.localeCompare(H.buyer)||z.id-H.id);r(C),a({exchangeRate:.24,totalShippingJPY:0,status:"",intlShippingTWD:0,secondPayment:{weights:{},boxWeight:0,minChargeDiff:0},...I.settings})}o(!1)});return()=>E()},[]);const d=(b,E,T)=>{r(I=>I.map(R=>R.id===b?{...R,[E]:T}:R)),f(!0)},p=async()=>{try{await su(yt(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),{orders:e,settings:n,updatedAt:new Date().toISOString(),updatedBy:t?.name||""}),f(!1),alert("JF26 ")}catch(b){alert(""+b.message)}},x=(b,E,T)=>{confirm(` ${b} ${T}`)&&(r(I=>I.map(R=>R.buyer===b?{...R,[E]:T}:R)),f(!0))},y=re.useMemo(()=>{const b=new Set;return e.filter(E=>E.isBought&&!b.has(E.name)?(b.add(E.name),!0):!1)},[e]),w=re.useMemo(()=>e.reduce((b,E)=>E.isBought?b+E.quantity:b,0),[e]);return i?m.jsx("div",{className:"p-10 text-center font-black text-slate-400 animate-pulse",children:" JF26 ..."}):m.jsxs("div",{className:"space-y-6 p-4",children:[m.jsxs("div",{className:"bg-white p-6 rounded-2xl border-4 border-slate-900 shadow-[6px_6px_0px_0px_#0f172a]",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase",children:""}),m.jsx("select",{value:n.status,onChange:b=>{a({...n,status:b.target.value}),f(!0)},className:"w-full font-bold border-2 border-slate-200 rounded-lg px-2 py-1.5 focus:border-yellow-400 outline-none bg-white",children:cK.map(b=>m.jsx("option",{value:b,children:b},b))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase",children:""}),m.jsx("input",{type:"number",step:"0.001",value:n.exchangeRate,onChange:b=>{a({...n,exchangeRate:parseFloat(b.target.value)||0}),f(!0)},className:"w-full font-mono font-bold border-2 border-slate-200 rounded-lg py-1.5 px-3"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase",children:" (JPY)"}),m.jsx("input",{type:"number",value:n.totalShippingJPY,onChange:b=>{a({...n,totalShippingJPY:parseFloat(b.target.value)||0}),f(!0)},className:"w-full font-mono font-bold border-2 border-slate-200 rounded-lg py-1.5 px-3"})]}),m.jsx("div",{className:"flex items-end",children:m.jsxs("button",{onClick:p,disabled:!u,className:`w-full flex items-center justify-center gap-2 py-2.5 rounded-xl font-black transition-all ${u?"bg-red-500 text-white shadow-[4px_4px_0px_0px_#7f1d1d] hover:-translate-y-1":"bg-slate-100 text-slate-300 cursor-not-allowed border-2 border-slate-200"}`,children:[m.jsx(ql,{size:18})," "]})})]}),m.jsxs("div",{className:"border-t-2 border-slate-100 pt-6",children:[m.jsxs("h3",{className:"text-sm font-black mb-4 flex items-center gap-2 uppercase italic text-blue-600",children:[m.jsx(fy,{size:18})," JF26  (1kg = ",uK,")"]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[m.jsx("div",{className:"space-y-4",children:m.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200",children:[m.jsx("label",{className:"block text-xs font-black text-slate-500 mb-2 uppercase",children:" (kg)"}),m.jsx("input",{type:"number",step:"0.01",value:n.secondPayment.boxWeight,onChange:b=>{a({...n,secondPayment:{...n.secondPayment,boxWeight:b.target.value}}),f(!0)},className:"w-full bg-white border-2 border-slate-200 rounded-lg p-2 font-mono font-black text-blue-600"}),m.jsxs("p",{className:"text-[9px] text-slate-400 mt-2 italic",children:["*  ",w," "]})]})}),m.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200 max-h-60 overflow-y-auto",children:[m.jsx("label",{className:"block text-xs font-black text-slate-500 mb-3 uppercase tracking-tighter",children:""}),m.jsx("div",{className:"space-y-2",children:y.map(b=>m.jsxs("div",{className:"flex items-center gap-2 bg-white p-2 rounded-lg border border-slate-200 group",children:[m.jsx("span",{className:"flex-1 text-[11px] font-bold truncate text-slate-600",title:b.name,children:b.name}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("input",{type:"number",step:"0.001",placeholder:"0.000",value:n.secondPayment.weights[b.name]||"",onChange:E=>{const T={...n.secondPayment.weights,[b.name]:E.target.value};a({...n,secondPayment:{...n.secondPayment,weights:T}}),f(!0)},className:"w-20 text-right font-mono font-black text-blue-600 border-b border-slate-200 outline-none text-xs"}),m.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"kg"})]})]},b.id))})]})]})]})]}),m.jsxs("div",{className:"bg-slate-50 p-4 border-x-4 border-t-4 border-slate-900 flex flex-wrap gap-4 items-center",children:[m.jsxs("span",{className:"text-xs font-black text-slate-500 uppercase tracking-widest flex items-center gap-1",children:[m.jsx(XP,{size:16})," "]}),Array.from(new Set(e.map(b=>b.buyer))).map(b=>m.jsxs("div",{className:"flex items-center gap-1 bg-white border-2 border-slate-200 rounded-lg p-1 px-2 shadow-sm",children:[m.jsx("span",{className:"text-sm font-black mr-2 text-blue-600",children:b}),m.jsx("button",{onClick:()=>x(b,"paymentStatus",""),className:"text-[10px] bg-green-500 text-white px-2 py-1 rounded font-bold hover:bg-green-600 transition-colors",children:""}),m.jsx("button",{onClick:()=>x(b,"shippingPaymentStatus",""),className:"text-[10px] bg-purple-500 text-white px-2 py-1 rounded font-bold hover:bg-purple-600 transition-colors",children:""})]},b))]}),m.jsx("div",{className:"bg-white border-4 border-slate-900 rounded-2xl overflow-hidden shadow-[8px_8px_0px_0px_#0f172a]",children:m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"w-full text-left border-collapse",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-slate-900 text-white text-[10px] uppercase font-black tracking-widest",children:[m.jsx("th",{className:"p-4 w-24",children:""}),m.jsx("th",{className:"p-4",children:""}),m.jsx("th",{className:"p-4 text-center w-20",children:""}),m.jsx("th",{className:"p-4 text-right w-28",children:"()"}),m.jsx("th",{className:"p-4 text-center w-20",children:""}),m.jsx("th",{className:"p-4 text-center w-32",children:""}),m.jsx("th",{className:"p-4 text-center w-32",children:""}),m.jsx("th",{className:"p-4 text-center w-16",children:""})]})}),m.jsx("tbody",{className:"divide-y-2 divide-slate-100 font-bold text-sm",children:e.map(b=>m.jsxs("tr",{className:`hover:bg-slate-50 transition-colors ${!b.isBought&&"bg-red-50/50 opacity-60"}`,children:[m.jsx("td",{className:"p-4 font-black text-blue-600 italic",children:b.buyer}),m.jsx("td",{className:"p-4",children:m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{className:"text-[10px] text-slate-400 uppercase",children:b.ip}),m.jsx("span",{className:"truncate max-w-[220px]",children:b.name})]})}),m.jsx("td",{className:"p-4 text-center font-mono",children:b.quantity}),m.jsx("td",{className:"p-4",children:m.jsx("input",{type:"number",value:b.price,onChange:E=>d(b.id,"price",E.target.value),className:"w-full text-right font-mono bg-transparent border-b border-dashed border-slate-300 focus:border-slate-900 outline-none"})}),m.jsx("td",{className:"p-4 text-center",children:m.jsx("input",{type:"checkbox",checked:b.isBought,onChange:E=>d(b.id,"isBought",E.target.checked),className:"w-5 h-5 accent-slate-900"})}),m.jsx("td",{className:"p-4 text-center",children:m.jsxs("select",{value:b.paymentStatus||"",onChange:E=>d(b.id,"paymentStatus",E.target.value),className:`text-[10px] font-black border-2 rounded px-2 py-1 outline-none ${b.paymentStatus===""?"bg-green-100 border-green-500 text-green-700":"bg-white border-red-300 text-red-500"}`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"",children:""})]})}),m.jsx("td",{className:"p-4 text-center",children:m.jsxs("select",{value:b.shippingPaymentStatus||"",onChange:E=>d(b.id,"shippingPaymentStatus",E.target.value),className:`text-[10px] font-black border-2 rounded px-2 py-1 outline-none ${b.shippingPaymentStatus===""?"bg-purple-100 border-purple-500 text-purple-700":"bg-slate-50 border-slate-300 text-slate-400"}`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"",children:""})]})}),m.jsx("td",{className:"p-4 text-center",children:m.jsx("button",{onClick:()=>batchUpdatePrice(b.ip,b.name,b.price),className:"p-1.5 text-slate-400 hover:text-slate-900 hover:bg-slate-200 rounded",title:"",children:m.jsx(RP,{size:14})})})]},b.id))})]})})}),u&&m.jsxs("div",{className:"fixed bottom-6 right-6 flex items-center gap-3 bg-red-600 text-white px-6 py-4 rounded-2xl shadow-2xl border-4 border-white animate-bounce z-50",children:[m.jsx(Bk,{size:24}),m.jsx("span",{className:"font-black uppercase tracking-widest",children:"Unsaved Changes!"})]})]})}const hK=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=800,u=800;let f=a.width,d=a.height;f>d?f>o&&(d*=o/f,f=o):d>u&&(f*=u/d,d=u),i.width=f,i.height=d,i.getContext("2d").drawImage(a,0,0,f,d),e(i.toDataURL("image/jpeg",.7))}}});function dK({onSubmit:t,onCancel:e,initialData:r=null,submitLabel:n=""}){const[a,i]=re.useState(r?.title||""),[o,u]=re.useState(r?.type||""),[f,d]=re.useState(()=>r?.images?.filter(P=>P.startsWith("http"))?.join(", ")||""),[p,x]=re.useState(()=>r?.images?.filter(P=>P.startsWith("data:"))||[]),[y,w]=re.useState(r?.infoUrl||""),[b,E]=re.useState(()=>r?.deadline?r.deadline.slice(0,16):""),[T,I]=re.useState(r?.releaseDate||""),[R,C]=re.useState(r?.items||[{id:1,name:"",spec:"",price:"",limit:"",image:""}]),z=()=>C([...R,{id:Date.now(),name:"",spec:"",price:"",limit:"",image:""}]),H=(P,M,j)=>C(R.map(B=>B.id===P?{...B,[M]:j}:B)),X=P=>R.length>1?C(R.filter(M=>M.id!==P)):C([{id:Date.now(),name:"",spec:"",price:"",limit:"",image:""}]),A=(P,M)=>{const j=[...R];M==="up"&&P>0&&([j[P-1],j[P]]=[j[P],j[P-1]]),M==="down"&&P<j.length-1&&([j[P+1],j[P]]=[j[P],j[P+1]]),C(j)},F=async P=>{if(P.target.files){const M=Array.from(P.target.files),j=await Promise.all(M.map(B=>hK(B)));x(B=>[...B,...j]),P.target.value=null}},N=()=>{if(!a||!b)return alert("");const P=R.filter(j=>j.name&&j.price);if(P.length===0)return alert("/");const M=f.split(",").map(j=>j.trim()).filter(j=>j);t({title:a,type:o,images:[...M,...p],infoUrl:y,deadline:b,releaseDate:T,items:P})};return m.jsxs("form",{onSubmit:P=>{P.preventDefault(),N()},className:"space-y-4",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(Fk,{size:16}),"  ()"]}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:a,onChange:P=>i(P.target.value),placeholder:" 6  BD ",required:!0})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(bu,{size:16})," "]}),m.jsxs("div",{className:"flex gap-2 text-xs sm:text-sm",children:[m.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg py-2 px-1 text-center font-black transition-all ${o===""?"bg-slate-900 text-yellow-400 border-slate-900 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[m.jsx("input",{type:"radio",className:"hidden",name:"groupType",value:"",checked:o==="",onChange:()=>u("")})," "]}),m.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg py-2 px-1 text-center font-black transition-all ${o===""?"bg-green-600 text-white border-green-800 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[m.jsx("input",{type:"radio",className:"hidden",name:"groupType",value:"",checked:o==="",onChange:()=>u("")})," "]})]})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(J0,{size:16}),"  ()"]}),m.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 text-sm h-16 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:f,onChange:P=>d(P.target.value),placeholder:" ()"})]}),m.jsxs("div",{className:"flex flex-col gap-2 p-3 border-2 border-dashed border-slate-300 rounded-lg bg-slate-100",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 flex items-center gap-2",children:[m.jsx(dy,{size:16})," "]}),m.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:F,className:"block w-full text-sm text-slate-700 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-2 file:border-red-800 file:text-xs file:font-black file:bg-red-600 file:text-white hover:file:bg-red-700 cursor-pointer"}),p.length>0&&m.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 pb-4",children:p.map((P,M)=>m.jsxs("div",{className:"relative shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 border-slate-900 shadow",children:[m.jsx("img",{src:P,className:"w-full h-full object-cover",alt:"preview"}),m.jsx("button",{type:"button",onClick:()=>x(j=>j.filter((B,Se)=>Se!==M)),className:"absolute top-0 right-0 bg-red-600 text-white rounded-full p-1 transform translate-x-1/3 -translate-y-1/3 border-2 border-white hover:bg-red-700 transition-all",children:m.jsx(fa,{size:12})})]},M))})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(Dm,{size:16})," / ()"]}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:y,onChange:P=>w(P.target.value),placeholder:"https://shueisha.co.jp/..."})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(FM,{size:16})," / ()"]}),m.jsx("input",{type:"datetime-local",className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:b,onChange:P=>E(P.target.value),required:!0})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsx("label",{className:"text-sm font-black italic text-slate-900 mb-1",children:" ()"}),m.jsx("input",{type:"date",className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:T,onChange:P=>I(P.target.value)})]})]}),m.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border-2 border-slate-300",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4 flex-wrap gap-2",children:[m.jsx("h4",{className:"font-black italic text-lg text-slate-900 transform -skew-x-3",children:o===""?" (ITEMS)":" (ITEMS)"}),m.jsx("button",{type:"button",onClick:z,className:"text-sm font-black px-3 py-1 bg-yellow-400 text-slate-900 rounded border-2 border-slate-900 hover:bg-yellow-500 transition-all",children:"+ "})]}),m.jsx("div",{className:"space-y-4",children:R.map((P,M)=>m.jsxs("div",{className:"bg-white p-3 rounded-lg border-2 border-slate-900 relative flex gap-3 items-start shadow-[2px_2px_0px_0px_rgba(15,23,42,1)]",children:[m.jsxs("div",{className:"flex flex-col gap-1 justify-center pt-1",children:[m.jsxs("span",{className:"text-xl font-black text-red-600 italic leading-none",children:[M+1,"."]}),m.jsx("button",{type:"button",onClick:()=>A(M,"up"),disabled:M===0,className:"text-slate-400 hover:text-blue-600 disabled:opacity-30 p-0.5",children:m.jsx(NM,{size:16})}),m.jsx("button",{type:"button",onClick:()=>A(M,"down"),disabled:M===R.length-1,className:"text-slate-400 hover:text-blue-600 disabled:opacity-30 p-0.5",children:m.jsx(Sk,{size:16})})]}),m.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-2",children:[m.jsx("div",{className:"col-span-12 sm:col-span-7",children:m.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm bg-slate-50 focus:bg-white focus:ring-2 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:"",value:P.name,onChange:j=>H(P.id,"name",j.target.value),required:!0})}),m.jsxs("div",{className:"col-span-12 sm:col-span-5 relative",children:[m.jsx("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-slate-400",children:m.jsx(Dm,{size:14})}),m.jsx("input",{className:"w-full border-2 border-slate-300 p-2 pl-7 rounded text-sm text-slate-700 focus:ring-2 focus:ring-yellow-400",placeholder:"",value:P.image||"",onChange:j=>H(P.id,"image",j.target.value)}),P.image&&m.jsx("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 w-6 h-6 rounded border-2 border-slate-900 bg-slate-100 overflow-hidden shadow",children:m.jsx("img",{src:P.image,className:"w-full h-full object-cover",onError:j=>j.target.style.display="none"})})]}),m.jsx("div",{className:"col-span-6 sm:col-span-5",children:m.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400",placeholder:"",value:P.spec,onChange:j=>H(P.id,"spec",j.target.value)})}),m.jsx("div",{className:"col-span-3 sm:col-span-4",children:m.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400 font-black text-red-600",type:"number",placeholder:"",value:P.price,onChange:j=>H(P.id,"price",j.target.value),required:!0})}),m.jsx("div",{className:"col-span-3 sm:col-span-3",children:m.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400",type:"number",placeholder:"",value:P.limit,onChange:j=>H(P.id,"limit",j.target.value)})})]}),m.jsx("button",{type:"button",onClick:()=>X(P.id),className:"text-red-600 hover:text-red-800 p-1 mt-1 shrink-0",children:m.jsx(fa,{size:18})})]},P.id))})]}),m.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[m.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[m.jsx(fa,{size:16,className:"inline mr-1"})," "]}),m.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-slate-900 text-yellow-400 border-2 border-slate-900 hover:bg-slate-700 font-black italic shadow-[4px_4px_0px_0px_#FACC15] active:translate-y-0.5 active:shadow-none transition-all",children:[m.jsx(ql,{size:16,className:"inline mr-1"})," ",n]})]})]})}const mK={titi:"",xiaomei:"",heng:"",baobao:"",yeye:"",Sjie:"S",qiaoyu:"",teacher:"",ann:"",Aurora:"Aurora"};function pK({currentUser:t}){const e=M0(),[r,n]=re.useState("groups"),[a,i]=re.useState(""),[o,u]=re.useState(""),[f,d]=re.useState([]),[p,x]=re.useState([]),[y,w]=re.useState([]),[b,E]=re.useState([]),[T,I]=re.useState(!1),[R,C]=re.useState({title:"",amount:"",targetUserId:"",note:"",paymentStatus:""}),[z,H]=re.useState(null),[X,A]=re.useState(Array.from({length:10},(O,Y)=>({id:`order_${Y+1}`,index:Y+1}))),[F,N]=re.useState({totalDomesticShipping:0}),[P,M]=re.useState(null),j=t?.name===""||t?.id==="yeye",B=y.find(O=>O.id===z);if(re.useEffect(()=>{if(!j)return;const O=Vr(yt(Ke,"artifacts","default-app-id","public","data","system","bulletin"),_e=>{_e.exists()&&(i(_e.data().content),u(_e.data().content))}),Y=Vr(qt(Ke,"artifacts","default-app-id","public","data","miscCharges"),_e=>d(_e.docs.map(ke=>({id:ke.id,...ke.data()})))),q=Vr(qt(Ke,"artifacts","default-app-id","public","data","users"),_e=>x(_e.docs.map(ke=>({id:ke.id,...ke.data()})))),te=Vr(qt(Ke,"artifacts","default-app-id","public","data","groups"),_e=>w(_e.docs.map(ke=>({id:ke.id,...ke.data()})))),ce=Vr(qt(Ke,"artifacts","default-app-id","public","data","orders"),_e=>E(_e.docs.map(ke=>({id:ke.id,...ke.data()})))),Te=Vr(qt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders"),_e=>{const ke={};_e.docs.forEach(rt=>{ke[rt.id]=rt.data()}),A(rt=>rt.map(L=>({...L,...ke[L.id]||{items:[]}})))}),Re=Vr(yt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_settings","main"),_e=>{_e.exists()&&N(_e.data())});return()=>{O(),Y(),q(),te(),ce(),Te(),Re()}},[j]),!j)return m.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-100",children:m.jsxs("div",{className:"bg-white p-10 rounded-2xl border-4 border-slate-900 shadow-[8px_8px_0px_0px_#ef4444] text-center",children:[m.jsx("h2",{className:"text-3xl font-black text-red-500 mb-4 italic",children:"ACCESS DENIED"}),m.jsx("p",{className:"font-bold text-slate-600",children:""}),m.jsx("button",{onClick:()=>e("/"),className:"mt-6 px-6 py-2 bg-slate-900 text-white font-bold rounded",children:""})]})});const Se=async()=>{try{await su(yt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_settings","main"),F),alert("JCS ")}catch{alert("")}},we=async()=>{const O=prompt(" JCS Excel  (ID >  >  >  > )");if(O)try{const Y=O.split(`
`).filter(ce=>ce.trim()!==""),q={};Y.forEach(ce=>{const[Te,Re,_e,ke,rt]=ce.split("	");!Te||!Re||(q[Te.trim()]||(q[Te.trim()]={items:[]}),q[Te.trim()].items.push({name:Re.trim(),qty:parseInt(_e)||1,price:parseInt(ke)||0,status:(rt||"PENDING").trim().toUpperCase()}))});const te=jx(Ke);Object.entries(q).forEach(([ce,Te])=>{const Re=yt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders",ce);te.set(Re,Te,{merge:!0})}),await te.commit(),alert("JCS ")}catch(Y){alert(""+Y.message)}},se=O=>O==="WON"?"bg-green-100 text-green-700 border-green-200":O==="LOST"?"bg-slate-100 text-slate-400 border-slate-200 grayscale opacity-70":"bg-white text-slate-900 border-slate-200",oe=async O=>{try{await bi(qt(Ke,"artifacts","default-app-id","public","data","groups"),{...O,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"",createdBy:"",exchangeRate:O.exchangeRate||.21,shippingFee:0,secondPayment:{},paymentStatus:""}),I(!1),alert("")}catch{alert("")}},le=async()=>{try{await su(yt(Ke,"artifacts","default-app-id","public","data","system","bulletin"),{content:o},{merge:!0}),i(o),alert("")}catch{alert("")}},ne=async()=>{if(!R.title||!R.amount||!R.targetUserId){alert("");return}try{const O=p.find(Y=>Y.id===R.targetUserId);await bi(qt(Ke,"artifacts","default-app-id","public","data","miscCharges"),{...R,amount:Number(R.amount),targetUserName:O?O.name:"Unknown",createdAt:new Date().toISOString()}),C({title:"",amount:"",targetUserId:"",note:"",paymentStatus:""}),alert("")}catch(O){console.error(O)}},ye=async(O,Y)=>{try{await tn(yt(Ke,"artifacts","default-app-id","public","data","miscCharges",O),{paymentStatus:Y})}catch(q){console.error(q)}},Q=async O=>{if(confirm(""))try{await v0(yt(Ke,"artifacts","default-app-id","public","data","miscCharges",O))}catch(Y){console.error(Y)}};return m.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col font-sans text-slate-800",children:[m.jsx("header",{className:"bg-slate-900 text-white shadow-md z-50 sticky top-0",children:m.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:m.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center py-4 gap-4",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("button",{onClick:()=>e("/"),className:"text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[m.jsx(Ak,{size:20}),m.jsx("span",{className:"hidden sm:inline",children:""})]}),m.jsx("h1",{className:"text-xl font-black italic tracking-wider border-l border-gray-700 pl-4 text-yellow-400",children:"HERO ADMIN"})]}),m.jsx("nav",{className:"flex flex-wrap justify-center gap-2 bg-slate-800 p-1 rounded-lg",children:[{id:"groups",label:"",icon:dP},{id:"misc",label:"",icon:Ik},{id:"js_orders",label:"JF26",icon:Lk},{id:"jcs_admin",label:"JCS",icon:e0},{id:"import",label:"Excel",icon:Rk},{id:"bulletin",label:"",icon:zx},{id:"users",label:"",icon:wT}].map(O=>m.jsxs("button",{onClick:()=>n(O.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-black transition-all ${r===O.id?"bg-yellow-400 text-slate-900 shadow-lg":"text-gray-400 hover:text-white hover:bg-slate-700"}`,children:[m.jsx(O.icon,{size:14}),O.label]},O.id))})]})})}),m.jsx("main",{className:"flex-1 overflow-auto p-4 sm:p-8",children:m.jsxs("div",{className:"max-w-7xl mx-auto",children:[r==="import"&&m.jsx(iK,{}),r==="groups"&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h2",{className:"text-2xl font-black italic text-slate-800",children:""}),m.jsxs("button",{onClick:()=>I(!0),className:"px-6 py-2 bg-slate-900 text-white rounded font-black hover:bg-slate-700 flex items-center gap-2 shadow-[4px_4px_0px_0px_#FACC15] transition-all italic",children:[m.jsx(wu,{size:18})," "]})]}),m.jsx(lK,{onOpenSecondPay:O=>H(O)})]}),r==="js_orders"&&m.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:m.jsx(fK,{currentUser:t})}),r==="jcs_admin"&&m.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4",children:[m.jsxs("div",{className:"bg-white p-6 rounded-2xl border-4 border-slate-900 shadow-[6px_6px_0px_0px_#0f172a] space-y-6",children:[m.jsxs("div",{className:"flex justify-between items-center border-b-2 pb-4",children:[m.jsxs("h2",{className:"text-2xl font-black italic text-slate-800 flex items-center gap-2",children:[m.jsx(e0,{className:"text-purple-600"})," JCS "]}),m.jsxs("button",{onClick:we,className:"px-4 py-2 bg-slate-900 text-yellow-400 rounded-xl font-black flex items-center gap-2 hover:bg-slate-800 transition-all border-2 border-slate-900 shadow-[3px_3px_0px_0px_#ccc]",children:[m.jsx(QM,{size:18}),"  Excel"]})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200",children:[m.jsx("label",{className:"block text-xs font-black text-slate-500 mb-2 uppercase",children:"JCS  (JPY)"}),m.jsx("div",{className:"flex gap-2",children:m.jsx("input",{type:"number",className:"flex-1 font-mono font-bold border-2 border-slate-200 rounded-lg py-2 px-3 focus:border-purple-500 outline-none",value:F.totalDomesticShipping,onChange:O=>N({...F,totalDomesticShipping:Number(O.target.value)})})}),m.jsx("p",{className:"text-[10px] text-slate-400 mt-2 italic",children:"* "})]}),m.jsxs("div",{className:"bg-yellow-50 p-4 rounded-xl border-2 border-yellow-200",children:[m.jsx("label",{className:"block text-xs font-black text-yellow-700 mb-2 uppercase",children:"JCS "}),m.jsx("div",{className:"flex gap-2",children:m.jsx("input",{type:"number",step:"0.001",className:"flex-1 font-mono font-bold border-2 border-yellow-200 rounded-lg py-2 px-3 focus:border-yellow-500 outline-none bg-white text-yellow-800",value:F.exchangeRate||.24,onChange:O=>N({...F,exchangeRate:parseFloat(O.target.value)})})}),m.jsx("p",{className:"text-[10px] text-yellow-600 mt-2 italic",children:"*  JCS "})]})]}),m.jsx("div",{className:"flex justify-end pt-4 border-t-2 border-slate-100",children:m.jsxs("button",{onClick:Se,className:"bg-purple-600 text-white px-8 py-3 rounded-xl font-black shadow-[4px_4px_0px_0px_#4c1d95] hover:-translate-y-1 hover:shadow-[6px_6px_0px_0px_#4c1d95] active:translate-y-0 active:shadow-none transition-all flex items-center gap-2",children:[m.jsx(ql,{size:18})," "]})})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:X.map(O=>m.jsxs("div",{className:"bg-white rounded-xl border-4 border-slate-900 overflow-hidden shadow-[4px_4px_0px_0px_#6b21a8]",children:[m.jsxs("div",{className:"bg-slate-900 text-white px-4 py-3 flex justify-between items-center",children:[m.jsxs("h4",{className:"font-black italic text-lg flex items-center gap-2",children:[m.jsx(e0,{size:20,className:"text-purple-400"})," ORDER #",O.index]}),m.jsxs("button",{onClick:()=>M(O),className:"text-xs bg-slate-700 px-2 py-1 rounded flex items-center gap-1 hover:bg-slate-600 transition-colors",children:[m.jsx(uy,{size:12})," /"]})]}),m.jsx("div",{className:"p-4 min-h-[120px]",children:!O.items||O.items.length===0?m.jsx("div",{className:"text-slate-300 font-bold text-center py-6",children:""}):m.jsx("div",{className:"space-y-3",children:O.items.map((Y,q)=>m.jsx("div",{className:`p-2 rounded border-2 ${se(Y.status)}`,children:m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsxs("div",{children:[m.jsx("div",{className:"font-bold text-sm",children:Y.name}),m.jsxs("div",{className:"text-[10px] opacity-75",children:["",Y.price," x ",Y.qty]})]}),m.jsxs("div",{className:"text-right",children:[m.jsxs("div",{className:"font-black",children:["",Y.price*Y.qty]}),Y.assignedTo&&m.jsxs("div",{className:"text-[10px] font-black bg-white/50 px-1 rounded",children:[": ",Y.assignedTo]})]})]})},q))})})]},O.id))})]}),r==="users"&&m.jsxs("div",{className:"bg-white p-10 rounded-2xl border-4 border-slate-900 text-center font-bold text-slate-400",children:[m.jsx(wT,{size:48,className:"mx-auto mb-4 opacity-20"}),"..."]}),r==="bulletin"&&m.jsxs("div",{className:"bg-white p-6 rounded-lg shadow border-4 border-slate-900",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4 pb-2 border-b-2",children:[m.jsxs("h2",{className:"text-xl font-black flex items-center gap-2 italic",children:[m.jsx(zx,{className:"text-yellow-500"})," "]}),m.jsxs("button",{onClick:le,className:"px-4 py-2 rounded bg-slate-900 text-yellow-400 font-black hover:bg-slate-800 flex items-center gap-2 shadow-[3px_3px_0px_0px_#ccc]",children:[m.jsx(ql,{size:18})," "]})]}),m.jsx(oK,{initialContent:o,onChange:u})]}),r==="misc"&&m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"bg-white p-6 rounded-lg shadow border-4 border-slate-900",children:[m.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2 text-slate-700 italic",children:[m.jsx(wu,{className:"text-green-600"})," "]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:""}),m.jsxs("select",{className:"w-full border-2 border-slate-200 p-2 rounded font-bold",value:R.targetUserId,onChange:O=>C({...R,targetUserId:O.target.value}),children:[m.jsx("option",{value:"",children:"--  --"}),p.map(O=>m.jsx("option",{value:O.id,children:O.name},O.id))]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:""}),m.jsx("input",{type:"text",className:"w-full border-2 border-slate-200 p-2 rounded font-bold",placeholder:"/",value:R.title,onChange:O=>C({...R,title:O.target.value})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:" (TWD)"}),m.jsx("input",{type:"number",className:"w-full border-2 border-slate-200 p-2 rounded font-bold",placeholder:"0",value:R.amount,onChange:O=>C({...R,amount:O.target.value})})]}),m.jsx("button",{onClick:ne,className:"bg-slate-900 text-yellow-400 p-2.5 rounded font-black hover:bg-slate-800 transition-colors",children:""})]})]}),m.jsx("div",{className:"bg-white rounded-lg shadow border-4 border-slate-900 overflow-hidden",children:m.jsxs("table",{className:"w-full text-sm text-left font-bold",children:[m.jsx("thead",{className:"bg-slate-900 text-white border-b",children:m.jsxs("tr",{children:[m.jsx("th",{className:"px-4 py-3 italic",children:"DATE"}),m.jsx("th",{className:"px-4 py-3",children:"HERO"}),m.jsx("th",{className:"px-4 py-3",children:"TITLE"}),m.jsx("th",{className:"px-4 py-3 text-right",children:"AMOUNT"}),m.jsx("th",{className:"px-4 py-3 text-center",children:"STATUS"}),m.jsx("th",{className:"px-4 py-3 text-center",children:"ACTION"})]})}),m.jsx("tbody",{children:f.sort((O,Y)=>new Date(Y.createdAt)-new Date(O.createdAt)).map(O=>m.jsxs("tr",{className:"border-b hover:bg-slate-50",children:[m.jsx("td",{className:"px-4 py-3 text-slate-400 font-mono text-xs",children:new Date(O.createdAt).toLocaleDateString()}),m.jsx("td",{className:"px-4 py-3 text-blue-700",children:O.targetUserName}),m.jsx("td",{className:"px-4 py-3",children:O.title}),m.jsxs("td",{className:"px-4 py-3 text-right font-mono",children:["$",O.amount]}),m.jsx("td",{className:"px-4 py-3 text-center",children:m.jsxs("select",{className:`text-[10px] font-black border-2 rounded px-1.5 py-0.5 ${O.paymentStatus===""?"bg-green-100 text-green-700 border-green-300":"bg-red-100 text-red-700 border-red-300"}`,value:O.paymentStatus||"",onChange:Y=>ye(O.id,Y.target.value),children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"",children:""})]})}),m.jsx("td",{className:"px-4 py-3 text-center",children:m.jsx("button",{onClick:()=>Q(O.id),className:"text-slate-300 hover:text-red-600 transition-colors",children:m.jsx(hy,{size:16})})})]},O.id))})]})})]})]})}),m.jsx(ca,{isOpen:T,onClose:()=>I(!1),title:"",children:m.jsx(dK,{onSubmit:oe,onCancel:()=>I(!1),submitLabel:""})}),m.jsx(ca,{isOpen:!!z,onClose:()=>H(null),title:"",children:B&&m.jsx(d3,{group:B,orders:b.filter(O=>O.groupId===B.id),currentUser:t,onUpdate:async O=>{await tn(yt(Ke,"artifacts","default-app-id","public","data","groups",B.id),{secondPayment:O}),alert(""),H(null)},isReadOnly:!1})}),m.jsx(ca,{isOpen:!!P,onClose:()=>M(null),title:` JCS  #${P?.index}`,children:P&&m.jsx(gK,{initialData:P,onSubmit:async O=>{await su(yt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders",P.id),O),M(null)},onCancel:()=>M(null)})})]})}function gK({initialData:t,onSubmit:e,onCancel:r}){const[n,a]=re.useState(t.items||[]),i=(o,u,f)=>{const d=[...n];d[o][u]=f,a(d)};return m.jsxs("form",{onSubmit:o=>{o.preventDefault(),e({items:n})},className:"space-y-4",children:[m.jsx("div",{className:"max-h-[50vh] overflow-y-auto space-y-4 p-1",children:n.map((o,u)=>m.jsxs("div",{className:"bg-slate-50 p-3 rounded border-2 border-slate-200 relative space-y-2",children:[m.jsx("button",{type:"button",onClick:()=>a(n.filter((f,d)=>d!==u)),className:"absolute top-1 right-1 text-slate-400 hover:text-red-500",children:m.jsx(fa,{size:16})}),m.jsx("input",{className:"w-full text-sm font-bold border border-slate-300 rounded p-1",value:o.name,onChange:f=>i(u,"name",f.target.value),placeholder:"",required:!0}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx("input",{type:"number",className:"w-20 text-sm border border-slate-300 rounded p-1",value:o.qty,onChange:f=>i(u,"qty",f.target.value),placeholder:""}),m.jsx("input",{type:"number",className:"flex-1 text-sm border border-slate-300 rounded p-1",value:o.price,onChange:f=>i(u,"price",f.target.value),placeholder:""})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"text-[10px] font-black text-slate-400",children:":"}),m.jsxs("select",{className:"flex-1 text-xs font-bold border rounded p-1 bg-white",value:o.assignedTo||"",onChange:f=>i(u,"assignedTo",f.target.value),children:[m.jsx("option",{value:"",children:""}),Object.values(mK).map(f=>m.jsx("option",{value:f,children:f},f))]})]}),m.jsx("div",{className:"flex gap-2",children:["PENDING","WON","LOST"].map(f=>m.jsx("button",{type:"button",onClick:()=>i(u,"status",f),className:`flex-1 py-1 rounded text-xs font-bold border transition-colors ${o.status===f?"bg-slate-900 text-white":"bg-white text-slate-500 border-slate-200"}`,children:f==="WON"?"":f==="LOST"?"":""},f))})]},u))}),m.jsx("button",{type:"button",onClick:()=>a([...n,{name:"",qty:1,price:0,status:"PENDING",assignedTo:""}]),className:"w-full py-2 bg-slate-100 border-2 border-dashed border-slate-300 rounded font-bold text-slate-500 hover:bg-slate-200 transition-colors",children:"+ "}),m.jsxs("div",{className:"flex justify-end gap-2 border-t pt-4",children:[m.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded font-bold text-slate-500 border border-slate-300",children:""}),m.jsx("button",{type:"submit",className:"px-6 py-2 bg-slate-900 text-white rounded font-bold hover:bg-slate-800",children:""})]})]})}function xK(){const[t,e]=re.useState(null),[r,n]=re.useState(null),[a,i]=re.useState(!0),[o,u]=re.useState([]),f=re.useCallback(()=>{n(null),localStorage.removeItem("app_user_id"),i(!1)},[]);re.useEffect(()=>((async()=>{try{X1.currentUser||await J9(X1)}catch(x){console.error("Firebase ",x)}})(),aF(X1,x=>{e(x)})),[]),re.useEffect(()=>{if(!t)return;const p=Vr(qt(Ke,"artifacts","default-app-id","public","data","users"),w=>{const b=w.docs.map(E=>({id:E.id,...E.data()}));u(b)}),x=localStorage.getItem("app_user_id");let y=()=>{};return x?y=Vr(yt(Ke,"artifacts","default-app-id","public","data","users",x),w=>{w.exists()?(n({id:w.id,...w.data()}),i(!1)):f()},()=>f()):i(!1),()=>{p(),y()}},[t,f]);const d=(p,x)=>{const y=typeof p=="object"&&p!==null?p.id:p,w=o.find(b=>b.id===y);w&&String(w.password).trim()===String(x).trim()?(localStorage.setItem("app_user_id",w.id),n(w),i(!1)):alert("")};return a?m.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-900 text-yellow-400",children:[m.jsx("div",{className:"flex items-center gap-2 mb-4 animate-bounce",children:m.jsx(BP,{size:80,className:"text-yellow-400 drop-shadow-[0_0_15px_rgba(250,204,21,0.5)]"})}),m.jsx("p",{className:"text-3xl font-black italic tracking-widest animate-pulse",children:"PLUS ULTRA..."})]}):m.jsx(p5,{children:m.jsxs("div",{className:"relative min-h-screen",children:[r&&m.jsx(WL,{}),m.jsxs(WR,{children:[m.jsx(Vf,{path:"/",element:r?m.jsx(Cd,{to:"/home",replace:!0}):m.jsx(wj,{users:o,onLogin:d})}),m.jsx(Vf,{path:"/home",element:r?m.jsx(sK,{appUser:r,usersData:o,handleLogout:f}):m.jsx(Cd,{to:"/",replace:!0})}),m.jsx(Vf,{path:"/jf26",element:r?m.jsx(zL,{currentUser:r}):m.jsx(Cd,{to:"/",replace:!0})}),m.jsx(Vf,{path:"/admin/dashboard",element:r?.name===""?m.jsx(pK,{currentUser:r}):m.jsx(Cd,{to:"/home",replace:!0})})]})]})})}eR.createRoot(document.getElementById("root")).render(m.jsx(Ws.StrictMode,{children:m.jsx(xK,{})}));
