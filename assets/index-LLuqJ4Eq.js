(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function jS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var S1={exports:{}},Mf={};var Eb;function H6(){if(Eb)return Mf;Eb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,i){var o=null;if(i!==void 0&&(o=""+i),a.key!==void 0&&(o=""+a.key),"key"in a){i={};for(var u in a)u!=="key"&&(i[u]=a[u])}else i=a;return a=i.ref,{$$typeof:t,type:n,key:o,ref:a!==void 0?a:null,props:i}}return Mf.Fragment=e,Mf.jsx=r,Mf.jsxs=r,Mf}var Tb;function G6(){return Tb||(Tb=1,S1.exports=H6()),S1.exports}var p=G6(),A1={exports:{}},gt={};var Sb;function q6(){if(Sb)return gt;Sb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),y=Symbol.iterator;function b(Y){return Y===null||typeof Y!="object"?null:(Y=y&&Y[y]||Y["@@iterator"],typeof Y=="function"?Y:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,T={};function R(Y,j,X){this.props=Y,this.context=j,this.refs=T,this.updater=X||E}R.prototype.isReactComponent={},R.prototype.setState=function(Y,j){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,j,"setState")},R.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function I(){}I.prototype=R.prototype;function C(Y,j,X){this.props=Y,this.context=j,this.refs=T,this.updater=X||E}var W=C.prototype=new I;W.constructor=C,w(W,R.prototype),W.isPureReactComponent=!0;var U=Array.isArray;function B(){}var A={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function N(Y,j,X){var J=X.ref;return{$$typeof:t,type:Y,key:j,ref:J!==void 0?J:null,props:X}}function M(Y,j){return N(Y.type,j,Y.props)}function F(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===t}function P(Y){var j={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(X){return j[X]})}var V=/\/+/g;function Ee(Y,j){return typeof Y=="object"&&Y!==null&&Y.key!=null?P(""+Y.key):j.toString(36)}function we(Y){switch(Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason;default:switch(typeof Y.status=="string"?Y.then(B,B):(Y.status="pending",Y.then(function(j){Y.status==="pending"&&(Y.status="fulfilled",Y.value=j)},function(j){Y.status==="pending"&&(Y.status="rejected",Y.reason=j)})),Y.status){case"fulfilled":return Y.value;case"rejected":throw Y.reason}}throw Y}function ie(Y,j,X,J,ne){var ue=typeof Y;(ue==="undefined"||ue==="boolean")&&(Y=null);var Te=!1;if(Y===null)Te=!0;else switch(ue){case"bigint":case"string":case"number":Te=!0;break;case"object":switch(Y.$$typeof){case t:case e:Te=!0;break;case m:return Te=Y._init,ie(Te(Y._payload),j,X,J,ne)}}if(Te)return ne=ne(Y),Te=J===""?"."+Ee(Y,0):J,U(ne)?(X="",Te!=null&&(X=Te.replace(V,"$&/")+"/"),ie(ne,j,X,"",function(Fe){return Fe})):ne!=null&&(F(ne)&&(ne=M(ne,X+(ne.key==null||Y&&Y.key===ne.key?"":(""+ne.key).replace(V,"$&/")+"/")+Te)),j.push(ne)),1;Te=0;var Re=J===""?".":J+":";if(U(Y))for(var Ce=0;Ce<Y.length;Ce++)J=Y[Ce],ue=Re+Ee(J,Ce),Te+=ie(J,j,X,ue,ne);else if(Ce=b(Y),typeof Ce=="function")for(Y=Ce.call(Y),Ce=0;!(J=Y.next()).done;)J=J.value,ue=Re+Ee(J,Ce++),Te+=ie(J,j,X,ue,ne);else if(ue==="object"){if(typeof Y.then=="function")return ie(we(Y),j,X,J,ne);throw j=String(Y),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.")}return Te}function ee(Y,j,X){if(Y==null)return Y;var J=[],ne=0;return ie(Y,J,"","",function(ue){return j.call(X,ue,ne++)}),J}function ye(Y){if(Y._status===-1){var j=Y._result;j=j(),j.then(function(X){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=X)},function(X){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=X)}),Y._status===-1&&(Y._status=0,Y._result=j)}if(Y._status===1)return Y._result.default;throw Y._result}var ae=typeof reportError=="function"?reportError:function(Y){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var j=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Y=="object"&&Y!==null&&typeof Y.message=="string"?String(Y.message):String(Y),error:Y});if(!window.dispatchEvent(j))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Y);return}console.error(Y)},Me={map:ee,forEach:function(Y,j,X){ee(Y,function(){j.apply(this,arguments)},X)},count:function(Y){var j=0;return ee(Y,function(){j++}),j},toArray:function(Y){return ee(Y,function(j){return j})||[]},only:function(Y){if(!F(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}};return gt.Activity=x,gt.Children=Me,gt.Component=R,gt.Fragment=r,gt.Profiler=a,gt.PureComponent=C,gt.StrictMode=n,gt.Suspense=f,gt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,gt.__COMPILER_RUNTIME={__proto__:null,c:function(Y){return A.H.useMemoCache(Y)}},gt.cache=function(Y){return function(){return Y.apply(null,arguments)}},gt.cacheSignal=function(){return null},gt.cloneElement=function(Y,j,X){if(Y==null)throw Error("The argument must be a React element, but you passed "+Y+".");var J=w({},Y.props),ne=Y.key;if(j!=null)for(ue in j.key!==void 0&&(ne=""+j.key),j)!D.call(j,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&j.ref===void 0||(J[ue]=j[ue]);var ue=arguments.length-2;if(ue===1)J.children=X;else if(1<ue){for(var Te=Array(ue),Re=0;Re<ue;Re++)Te[Re]=arguments[Re+2];J.children=Te}return N(Y.type,ne,J)},gt.createContext=function(Y){return Y={$$typeof:o,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null},Y.Provider=Y,Y.Consumer={$$typeof:i,_context:Y},Y},gt.createElement=function(Y,j,X){var J,ne={},ue=null;if(j!=null)for(J in j.key!==void 0&&(ue=""+j.key),j)D.call(j,J)&&J!=="key"&&J!=="__self"&&J!=="__source"&&(ne[J]=j[J]);var Te=arguments.length-2;if(Te===1)ne.children=X;else if(1<Te){for(var Re=Array(Te),Ce=0;Ce<Te;Ce++)Re[Ce]=arguments[Ce+2];ne.children=Re}if(Y&&Y.defaultProps)for(J in Te=Y.defaultProps,Te)ne[J]===void 0&&(ne[J]=Te[J]);return N(Y,ue,ne)},gt.createRef=function(){return{current:null}},gt.forwardRef=function(Y){return{$$typeof:u,render:Y}},gt.isValidElement=F,gt.lazy=function(Y){return{$$typeof:m,_payload:{_status:-1,_result:Y},_init:ye}},gt.memo=function(Y,j){return{$$typeof:d,type:Y,compare:j===void 0?null:j}},gt.startTransition=function(Y){var j=A.T,X={};A.T=X;try{var J=Y(),ne=A.S;ne!==null&&ne(X,J),typeof J=="object"&&J!==null&&typeof J.then=="function"&&J.then(B,ae)}catch(ue){ae(ue)}finally{j!==null&&X.types!==null&&(j.types=X.types),A.T=j}},gt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},gt.use=function(Y){return A.H.use(Y)},gt.useActionState=function(Y,j,X){return A.H.useActionState(Y,j,X)},gt.useCallback=function(Y,j){return A.H.useCallback(Y,j)},gt.useContext=function(Y){return A.H.useContext(Y)},gt.useDebugValue=function(){},gt.useDeferredValue=function(Y,j){return A.H.useDeferredValue(Y,j)},gt.useEffect=function(Y,j){return A.H.useEffect(Y,j)},gt.useEffectEvent=function(Y){return A.H.useEffectEvent(Y)},gt.useId=function(){return A.H.useId()},gt.useImperativeHandle=function(Y,j,X){return A.H.useImperativeHandle(Y,j,X)},gt.useInsertionEffect=function(Y,j){return A.H.useInsertionEffect(Y,j)},gt.useLayoutEffect=function(Y,j){return A.H.useLayoutEffect(Y,j)},gt.useMemo=function(Y,j){return A.H.useMemo(Y,j)},gt.useOptimistic=function(Y,j){return A.H.useOptimistic(Y,j)},gt.useReducer=function(Y,j,X){return A.H.useReducer(Y,j,X)},gt.useRef=function(Y){return A.H.useRef(Y)},gt.useState=function(Y){return A.H.useState(Y)},gt.useSyncExternalStore=function(Y,j,X){return A.H.useSyncExternalStore(Y,j,X)},gt.useTransition=function(){return A.H.useTransition()},gt.version="19.2.1",gt}var Ab;function sv(){return Ab||(Ab=1,A1.exports=q6()),A1.exports}var re=sv();const Bl=jS(re);var k1={exports:{}},Pf={},C1={exports:{}},N1={};var kb;function W6(){return kb||(kb=1,(function(t){function e(ie,ee){var ye=ie.length;ie.push(ee);e:for(;0<ye;){var ae=ye-1>>>1,Me=ie[ae];if(0<a(Me,ee))ie[ae]=ee,ie[ye]=Me,ye=ae;else break e}}function r(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var ee=ie[0],ye=ie.pop();if(ye!==ee){ie[0]=ye;e:for(var ae=0,Me=ie.length,Y=Me>>>1;ae<Y;){var j=2*(ae+1)-1,X=ie[j],J=j+1,ne=ie[J];if(0>a(X,ye))J<Me&&0>a(ne,X)?(ie[ae]=ne,ie[J]=ye,ae=J):(ie[ae]=X,ie[j]=ye,ae=j);else if(J<Me&&0>a(ne,ye))ie[ae]=ne,ie[J]=ye,ae=J;else break e}}return ee}function a(ie,ee){var ye=ie.sortIndex-ee.sortIndex;return ye!==0?ye:ie.id-ee.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var f=[],d=[],m=1,x=null,y=3,b=!1,E=!1,w=!1,T=!1,R=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function W(ie){for(var ee=r(d);ee!==null;){if(ee.callback===null)n(d);else if(ee.startTime<=ie)n(d),ee.sortIndex=ee.expirationTime,e(f,ee);else break;ee=r(d)}}function U(ie){if(w=!1,W(ie),!E)if(r(f)!==null)E=!0,B||(B=!0,P());else{var ee=r(d);ee!==null&&we(U,ee.startTime-ie)}}var B=!1,A=-1,D=5,N=-1;function M(){return T?!0:!(t.unstable_now()-N<D)}function F(){if(T=!1,B){var ie=t.unstable_now();N=ie;var ee=!0;try{e:{E=!1,w&&(w=!1,I(A),A=-1),b=!0;var ye=y;try{t:{for(W(ie),x=r(f);x!==null&&!(x.expirationTime>ie&&M());){var ae=x.callback;if(typeof ae=="function"){x.callback=null,y=x.priorityLevel;var Me=ae(x.expirationTime<=ie);if(ie=t.unstable_now(),typeof Me=="function"){x.callback=Me,W(ie),ee=!0;break t}x===r(f)&&n(f),W(ie)}else n(f);x=r(f)}if(x!==null)ee=!0;else{var Y=r(d);Y!==null&&we(U,Y.startTime-ie),ee=!1}}break e}finally{x=null,y=ye,b=!1}ee=void 0}}finally{ee?P():B=!1}}}var P;if(typeof C=="function")P=function(){C(F)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,Ee=V.port2;V.port1.onmessage=F,P=function(){Ee.postMessage(null)}}else P=function(){R(F,0)};function we(ie,ee){A=R(function(){ie(t.unstable_now())},ee)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(ie){switch(y){case 1:case 2:case 3:var ee=3;break;default:ee=y}var ye=y;y=ee;try{return ie()}finally{y=ye}},t.unstable_requestPaint=function(){T=!0},t.unstable_runWithPriority=function(ie,ee){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ye=y;y=ie;try{return ee()}finally{y=ye}},t.unstable_scheduleCallback=function(ie,ee,ye){var ae=t.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?ae+ye:ae):ye=ae,ie){case 1:var Me=-1;break;case 2:Me=250;break;case 5:Me=1073741823;break;case 4:Me=1e4;break;default:Me=5e3}return Me=ye+Me,ie={id:m++,callback:ee,priorityLevel:ie,startTime:ye,expirationTime:Me,sortIndex:-1},ye>ae?(ie.sortIndex=ye,e(d,ie),r(f)===null&&ie===r(d)&&(w?(I(A),A=-1):w=!0,we(U,ye-ae))):(ie.sortIndex=Me,e(f,ie),E||b||(E=!0,B||(B=!0,P()))),ie},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(ie){var ee=y;return function(){var ye=y;y=ee;try{return ie.apply(this,arguments)}finally{y=ye}}}})(N1)),N1}var Cb;function X6(){return Cb||(Cb=1,C1.exports=W6()),C1.exports}var R1={exports:{}},On={};var Nb;function Y6(){if(Nb)return On;Nb=1;var t=sv();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(f,d,m){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:f,containerInfo:d,implementation:m}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return On.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,On.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return i(f,d,null,m)},On.flushSync=function(f){var d=o.T,m=n.p;try{if(o.T=null,n.p=2,f)return f()}finally{o.T=d,n.p=m,n.d.f()}},On.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},On.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},On.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,x=u(m,d.crossOrigin),y=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:b}):m==="script"&&n.d.X(f,{crossOrigin:x,integrity:y,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},On.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=u(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},On.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,x=u(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},On.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=u(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},On.requestFormReset=function(f){n.d.r(f)},On.unstable_batchedUpdates=function(f,d){return f(d)},On.useFormState=function(f,d,m){return o.H.useFormState(f,d,m)},On.useFormStatus=function(){return o.H.useHostTransitionStatus()},On.version="19.2.1",On}var Rb;function $6(){if(Rb)return R1.exports;Rb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),R1.exports=Y6(),R1.exports}var Ib;function K6(){if(Ib)return Pf;Ib=1;var t=X6(),e=sv(),r=$6();function n(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)l+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var l=s,c=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(c=l.return),s=l.return;while(s)}return l.tag===3?c:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function f(s){if(i(s)!==s)throw Error(n(188))}function d(s){var l=s.alternate;if(!l){if(l=i(s),l===null)throw Error(n(188));return l!==s?null:s}for(var c=s,h=l;;){var v=c.return;if(v===null)break;var _=v.alternate;if(_===null){if(h=v.return,h!==null){c=h;continue}break}if(v.child===_.child){for(_=v.child;_;){if(_===c)return f(v),s;if(_===h)return f(v),l;_=_.sibling}throw Error(n(188))}if(c.return!==h.return)c=v,h=_;else{for(var k=!1,z=v.child;z;){if(z===c){k=!0,c=v,h=_;break}if(z===h){k=!0,h=v,c=_;break}z=z.sibling}if(!k){for(z=_.child;z;){if(z===c){k=!0,c=_,h=v;break}if(z===h){k=!0,h=_,c=v;break}z=z.sibling}if(!k)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:l}function m(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=m(s),l!==null)return l;s=s.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),C=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function P(s){return s===null||typeof s!="object"?null:(s=F&&s[F]||s["@@iterator"],typeof s=="function"?s:null)}var V=Symbol.for("react.client.reference");function Ee(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===V?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case w:return"Fragment";case R:return"Profiler";case T:return"StrictMode";case U:return"Suspense";case B:return"SuspenseList";case N:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case E:return"Portal";case C:return s.displayName||"Context";case I:return(s._context.displayName||"Context")+".Consumer";case W:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:Ee(s.type)||"Memo";case D:l=s._payload,s=s._init;try{return Ee(s(l))}catch{}}return null}var we=Array.isArray,ie=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye={pending:!1,data:null,method:null,action:null},ae=[],Me=-1;function Y(s){return{current:s}}function j(s){0>Me||(s.current=ae[Me],ae[Me]=null,Me--)}function X(s,l){Me++,ae[Me]=s.current,s.current=l}var J=Y(null),ne=Y(null),ue=Y(null),Te=Y(null);function Re(s,l){switch(X(ue,l),X(ne,s),X(J,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?Ww(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=Ww(l),s=Xw(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}j(J),X(J,s)}function Ce(){j(J),j(ne),j(ue)}function Fe(s){s.memoizedState!==null&&X(Te,s);var l=J.current,c=Xw(l,s.type);l!==c&&(X(ne,s),X(J,c))}function st(s){ne.current===s&&(j(J),j(ne)),Te.current===s&&(j(Te),If._currentValue=ye)}var te,Ct;function lt(s){if(te===void 0)try{throw Error()}catch(c){var l=c.stack.trim().match(/\n( *(at )?)/);te=l&&l[1]||"",Ct=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+te+s+Ct}var It=!1;function ht(s,l){if(!s||It)return"";It=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(l){var De=function(){throw Error()};if(Object.defineProperty(De.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(De,[])}catch(be){var ve=be}Reflect.construct(s,[],De)}else{try{De.call()}catch(be){ve=be}s.call(De.prototype)}}else{try{throw Error()}catch(be){ve=be}(De=s())&&typeof De.catch=="function"&&De.catch(function(){})}}catch(be){if(be&&ve&&typeof be.stack=="string")return[be.stack,ve.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=h.DetermineComponentFrameRoot(),k=_[0],z=_[1];if(k&&z){var se=k.split(`
`),pe=z.split(`
`);for(v=h=0;h<se.length&&!se[h].includes("DetermineComponentFrameRoot");)h++;for(;v<pe.length&&!pe[v].includes("DetermineComponentFrameRoot");)v++;if(h===se.length||v===pe.length)for(h=se.length-1,v=pe.length-1;1<=h&&0<=v&&se[h]!==pe[v];)v--;for(;1<=h&&0<=v;h--,v--)if(se[h]!==pe[v]){if(h!==1||v!==1)do if(h--,v--,0>v||se[h]!==pe[v]){var ke=`
`+se[h].replace(" at new "," at ");return s.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",s.displayName)),ke}while(1<=h&&0<=v);break}}}finally{It=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?lt(c):""}function le(s,l){switch(s.tag){case 26:case 27:case 5:return lt(s.type);case 16:return lt("Lazy");case 13:return s.child!==l&&l!==null?lt("Suspense Fallback"):lt("Suspense");case 19:return lt("SuspenseList");case 0:case 15:return ht(s.type,!1);case 11:return ht(s.type.render,!1);case 1:return ht(s.type,!0);case 31:return lt("Activity");default:return""}}function Qe(s){try{var l="",c=null;do l+=le(s,c),c=s,s=s.return;while(s);return l}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Be=Object.prototype.hasOwnProperty,Ye=t.unstable_scheduleCallback,et=t.unstable_cancelCallback,Et=t.unstable_shouldYield,zt=t.unstable_requestPaint,Bt=t.unstable_now,Br=t.unstable_getCurrentPriorityLevel,Nn=t.unstable_ImmediatePriority,pa=t.unstable_UserBlockingPriority,dr=t.unstable_NormalPriority,Rn=t.unstable_LowPriority,mt=t.unstable_IdlePriority,Kt=t.log,Ir=t.unstable_setDisableYieldValue,Tt=null,Yt=null;function Dr(s){if(typeof Kt=="function"&&Ir(s),Yt&&typeof Yt.setStrictMode=="function")try{Yt.setStrictMode(Tt,s)}catch{}}var gr=Math.clz32?Math.clz32:ei,zi=Math.log,ss=Math.LN2;function ei(s){return s>>>=0,s===0?32:31-(zi(s)/ss|0)|0}var ea=256,Fa=262144,Er=4194304;function Or(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ga(s,l,c){var h=s.pendingLanes;if(h===0)return 0;var v=0,_=s.suspendedLanes,k=s.pingedLanes;s=s.warmLanes;var z=h&134217727;return z!==0?(h=z&~_,h!==0?v=Or(h):(k&=z,k!==0?v=Or(k):c||(c=z&~s,c!==0&&(v=Or(c))))):(z=h&~_,z!==0?v=Or(z):k!==0?v=Or(k):c||(c=h&~s,c!==0&&(v=Or(c)))),v===0?0:l!==0&&l!==v&&(l&_)===0&&(_=v&-v,c=l&-l,_>=c||_===32&&(c&4194048)!==0)?l:v}function Xn(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function Vu(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dc(){var s=Er;return Er<<=1,(Er&62914560)===0&&(Er=4194304),s}function Ma(s){for(var l=[],c=0;31>c;c++)l.push(s);return l}function ti(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Uu(s,l,c,h,v,_){var k=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var z=s.entanglements,se=s.expirationTimes,pe=s.hiddenUpdates;for(c=k&~c;0<c;){var ke=31-gr(c),De=1<<ke;z[ke]=0,se[ke]=-1;var ve=pe[ke];if(ve!==null)for(pe[ke]=null,ke=0;ke<ve.length;ke++){var be=ve[ke];be!==null&&(be.lane&=-536870913)}c&=~De}h!==0&&ri(s,h,0),_!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=_&~(k&~l))}function ri(s,l,c){s.pendingLanes|=l,s.suspendedLanes&=~l;var h=31-gr(l);s.entangledLanes|=l,s.entanglements[h]=s.entanglements[h]|1073741824|c&261930}function ni(s,l){var c=s.entangledLanes|=l;for(s=s.entanglements;c;){var h=31-gr(c),v=1<<h;v&l|s[h]&l&&(s[h]|=l),c&=~v}}function io(s,l){var c=l&-l;return c=(c&42)!==0?1:ai(c),(c&(s.suspendedLanes|l))!==0?0:c}function ai(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function is(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function L(){var s=ee.p;return s!==0?s:(s=window.event,s===void 0?32:gb(s.type))}function Q(s,l){var c=ee.p;try{return ee.p=s,l()}finally{ee.p=c}}var H=Math.random().toString(36).slice(2),q="__reactFiber$"+H,K="__reactProps$"+H,Z="__reactContainer$"+H,de="__reactEvents$"+H,Ae="__reactListeners$"+H,me="__reactHandles$"+H,xe="__reactResources$"+H,ge="__reactMarker$"+H;function Le(s){delete s[q],delete s[K],delete s[de],delete s[Ae],delete s[me]}function Ve(s){var l=s[q];if(l)return l;for(var c=s.parentNode;c;){if(l=c[Z]||c[q]){if(c=l.alternate,l.child!==null||c!==null&&c.child!==null)for(s=eb(s);s!==null;){if(c=s[q])return c;s=eb(s)}return l}s=c,c=s.parentNode}return null}function qe(s){if(s=s[q]||s[Z]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function je(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(n(33))}function Ge(s){var l=s[xe];return l||(l=s[xe]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Ze(s){s[ge]=!0}var Qt=new Set,Jt={};function fr(s,l){In(s,l),In(s+"Capture",l)}function In(s,l){for(Jt[s]=l,s=0;s<l.length;s++)Qt.add(l[s])}var ls=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),os={},xa={};function Hi(s){return Be.call(xa,s)?!0:Be.call(os,s)?!1:ls.test(s)?xa[s]=!0:(os[s]=!0,!1)}function Dn(s,l,c){if(Hi(l))if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var h=l.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+c)}}function va(s,l,c){if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+c)}}function Yr(s,l,c,h){if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(l,c,""+h)}}function hn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Gi(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function zu(s,l,c){var h=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var v=h.get,_=h.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return v.call(this)},set:function(k){c=""+k,_.call(this,k)}}),Object.defineProperty(s,l,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(k){c=""+k},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Zt(s){if(!s._valueTracker){var l=Gi(s)?"checked":"value";s._valueTracker=zu(s,l,""+s[l])}}function lo(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var c=l.getValue(),h="";return s&&(h=Gi(s)?s.checked?"true":"false":s.value),s=h,s!==c?(l.setValue(s),!0):!1}function As(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var oo=/[\n"\\]/g;function ta(s){return s.replace(oo,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function mc(s,l,c,h,v,_,k,z){s.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.type=k:s.removeAttribute("type"),l!=null?k==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+hn(l)):s.value!==""+hn(l)&&(s.value=""+hn(l)):k!=="submit"&&k!=="reset"||s.removeAttribute("value"),l!=null?Hu(s,k,hn(l)):c!=null?Hu(s,k,hn(c)):h!=null&&s.removeAttribute("value"),v==null&&_!=null&&(s.defaultChecked=!!_),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?s.name=""+hn(z):s.removeAttribute("name")}function hh(s,l,c,h,v,_,k,z){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),l!=null||c!=null){if(!(_!=="submit"&&_!=="reset"||l!=null)){Zt(s);return}c=c!=null?""+hn(c):"",l=l!=null?""+hn(l):c,z||l===s.value||(s.value=l),s.defaultValue=l}h=h??v,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=z?s.checked:!!h,s.defaultChecked=!!h,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(s.name=k),Zt(s)}function Hu(s,l,c){l==="number"&&As(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function qi(s,l,c,h){if(s=s.options,l){l={};for(var v=0;v<c.length;v++)l["$"+c[v]]=!0;for(c=0;c<s.length;c++)v=l.hasOwnProperty("$"+s[c].value),s[c].selected!==v&&(s[c].selected=v),v&&h&&(s[c].defaultSelected=!0)}else{for(c=""+hn(c),l=null,v=0;v<s.length;v++){if(s[v].value===c){s[v].selected=!0,h&&(s[v].defaultSelected=!0);return}l!==null||s[v].disabled||(l=s[v])}l!==null&&(l.selected=!0)}}function dh(s,l,c){if(l!=null&&(l=""+hn(l),l!==s.value&&(s.value=l),c==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=c!=null?""+hn(c):""}function Wi(s,l,c,h){if(l==null){if(h!=null){if(c!=null)throw Error(n(92));if(we(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),l=c}c=hn(l),s.defaultValue=c,h=s.textContent,h===c&&h!==""&&h!==null&&(s.value=h),Zt(s)}function ra(s,l){if(l){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=l;return}}s.textContent=l}var mh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Gu(s,l,c){var h=l.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":h?s.setProperty(l,c):typeof c!="number"||c===0||mh.has(l)?l==="float"?s.cssFloat=c:s[l]=(""+c).trim():s[l]=c+"px"}function qu(s,l,c){if(l!=null&&typeof l!="object")throw Error(n(62));if(s=s.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||l!=null&&l.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var v in l)h=l[v],l.hasOwnProperty(v)&&c[v]!==h&&Gu(s,v,h)}else for(var _ in l)l.hasOwnProperty(_)&&Gu(s,_,l[_])}function pc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ph=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Xi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function gc(s){return Xi.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function cs(){}var Wu=null;function Pa(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Yi=null,ks=null;function co(s){var l=qe(s);if(l&&(s=l.stateNode)){var c=s[K]||null;e:switch(s=l.stateNode,l.type){case"input":if(mc(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),l=c.name,c.type==="radio"&&l!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ta(""+l)+'"][type="radio"]'),l=0;l<c.length;l++){var h=c[l];if(h!==s&&h.form===s.form){var v=h[K]||null;if(!v)throw Error(n(90));mc(h,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(l=0;l<c.length;l++)h=c[l],h.form===s.form&&lo(h)}break e;case"textarea":dh(s,c.value,c.defaultValue);break e;case"select":l=c.value,l!=null&&qi(s,!!c.multiple,l,!1)}}}var xc=!1;function $i(s,l,c){if(xc)return s(l,c);xc=!0;try{var h=s(l);return h}finally{if(xc=!1,(Yi!==null||ks!==null)&&(od(),Yi&&(l=Yi,s=ks,ks=Yi=null,co(l),s)))for(l=0;l<s.length;l++)co(s[l])}}function us(s,l){var c=s.stateNode;if(c===null)return null;var h=c[K]||null;if(h===null)return null;c=h[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,l,typeof c));return c}var ja=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uo=!1;if(ja)try{var ir={};Object.defineProperty(ir,"passive",{get:function(){uo=!0}}),window.addEventListener("test",ir,ir),window.removeEventListener("test",ir,ir)}catch{uo=!1}var Cs=null,Xu=null,fo=null;function Yu(){if(fo)return fo;var s,l=Xu,c=l.length,h,v="value"in Cs?Cs.value:Cs.textContent,_=v.length;for(s=0;s<c&&l[s]===v[s];s++);var k=c-s;for(h=1;h<=k&&l[c-h]===v[_-h];h++);return fo=v.slice(s,1<h?1-h:void 0)}function ho(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function si(){return!0}function fs(){return!1}function vn(s){function l(c,h,v,_,k){this._reactName=c,this._targetInst=v,this.type=h,this.nativeEvent=_,this.target=k,this.currentTarget=null;for(var z in s)s.hasOwnProperty(z)&&(c=s[z],this[z]=c?c(_):_[z]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?si:fs,this.isPropagationStopped=fs,this}return x(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=si)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=si)},persist:function(){},isPersistent:si}),l}var ii={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ns=vn(ii),Ki=x({},ii,{view:0,detail:0}),$u=vn(Ki),Qi,vc,Rs,yc=x({},Ki,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ji,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Rs&&(Rs&&s.type==="mousemove"?(Qi=s.screenX-Rs.screenX,vc=s.screenY-Rs.screenY):vc=Qi=0,Rs=s),Qi)},movementY:function(s){return"movementY"in s?s.movementY:vc}}),Ku=vn(yc),mo=x({},yc,{dataTransfer:0}),gh=vn(mo),xh=x({},Ki,{relatedTarget:0}),po=vn(xh),Qu=x({},ii,{animationName:0,elapsedTime:0,pseudoElement:0}),vh=vn(Qu),_c=x({},ii,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),yh=vn(_c),_h=x({},ii,{data:0}),Is=vn(_h),wh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Eh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Th(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=Eh[s])?!!l[s]:!1}function Ji(){return Th}var Yn=x({},Ki,{key:function(s){if(s.key){var l=wh[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=ho(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?bh[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ji,charCode:function(s){return s.type==="keypress"?ho(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ho(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Sh=vn(Yn),Ah=x({},yc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),li=vn(Ah),g=x({},Ki,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ji}),S=vn(g),O=x({},ii,{propertyName:0,elapsedTime:0,pseudoElement:0}),G=vn(O),fe=x({},yc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),_e=vn(fe),He=x({},ii,{newState:0,oldState:0}),vt=vn(He),Vr=[9,13,27,32],Wt=ja&&"CompositionEvent"in window,Tr=null;ja&&"documentMode"in document&&(Tr=document.documentMode);var La=ja&&"TextEvent"in window&&!Tr,Ds=ja&&(!Wt||Tr&&8<Tr&&11>=Tr),hs=" ",ds=!1;function go(s,l){switch(s){case"keyup":return Vr.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var bc=!1;function d3(s,l){switch(s){case"compositionend":return wc(l);case"keypress":return l.which!==32?null:(ds=!0,hs);case"textInput":return s=l.data,s===hs&&ds?null:s;default:return null}}function m3(s,l){if(bc)return s==="compositionend"||!Wt&&go(s,l)?(s=Yu(),fo=Xu=Cs=null,bc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Ds&&l.locale!=="ko"?null:l.data;default:return null}}var p3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n_(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!p3[s.type]:l==="textarea"}function a_(s,l,c,h){Yi?ks?ks.push(h):ks=[h]:Yi=h,l=pd(l,"onChange"),0<l.length&&(c=new Ns("onChange","change",null,c,h),s.push({event:c,listeners:l}))}var Ju=null,Zu=null;function g3(s){Vw(s,0)}function kh(s){var l=je(s);if(lo(l))return s}function s_(s,l){if(s==="change")return l}var i_=!1;if(ja){var Dp;if(ja){var Op="oninput"in document;if(!Op){var l_=document.createElement("div");l_.setAttribute("oninput","return;"),Op=typeof l_.oninput=="function"}Dp=Op}else Dp=!1;i_=Dp&&(!document.documentMode||9<document.documentMode)}function o_(){Ju&&(Ju.detachEvent("onpropertychange",c_),Zu=Ju=null)}function c_(s){if(s.propertyName==="value"&&kh(Zu)){var l=[];a_(l,Zu,s,Pa(s)),$i(g3,l)}}function x3(s,l,c){s==="focusin"?(o_(),Ju=l,Zu=c,Ju.attachEvent("onpropertychange",c_)):s==="focusout"&&o_()}function v3(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return kh(Zu)}function y3(s,l){if(s==="click")return kh(l)}function _3(s,l){if(s==="input"||s==="change")return kh(l)}function w3(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var ya=typeof Object.is=="function"?Object.is:w3;function ef(s,l){if(ya(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var c=Object.keys(s),h=Object.keys(l);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var v=c[h];if(!Be.call(l,v)||!ya(s[v],l[v]))return!1}return!0}function u_(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function f_(s,l){var c=u_(s);s=0;for(var h;c;){if(c.nodeType===3){if(h=s+c.textContent.length,s<=l&&h>=l)return{node:c,offset:l-s};s=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=u_(c)}}function h_(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?h_(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function d_(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=As(s.document);l instanceof s.HTMLIFrameElement;){try{var c=typeof l.contentWindow.location.href=="string"}catch{c=!1}if(c)s=l.contentWindow;else break;l=As(s.document)}return l}function Fp(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var b3=ja&&"documentMode"in document&&11>=document.documentMode,Ec=null,Mp=null,tf=null,Pp=!1;function m_(s,l,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Pp||Ec==null||Ec!==As(h)||(h=Ec,"selectionStart"in h&&Fp(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),tf&&ef(tf,h)||(tf=h,h=pd(Mp,"onSelect"),0<h.length&&(l=new Ns("onSelect","select",null,l,c),s.push({event:l,listeners:h}),l.target=Ec)))}function xo(s,l){var c={};return c[s.toLowerCase()]=l.toLowerCase(),c["Webkit"+s]="webkit"+l,c["Moz"+s]="moz"+l,c}var Tc={animationend:xo("Animation","AnimationEnd"),animationiteration:xo("Animation","AnimationIteration"),animationstart:xo("Animation","AnimationStart"),transitionrun:xo("Transition","TransitionRun"),transitionstart:xo("Transition","TransitionStart"),transitioncancel:xo("Transition","TransitionCancel"),transitionend:xo("Transition","TransitionEnd")},jp={},p_={};ja&&(p_=document.createElement("div").style,"AnimationEvent"in window||(delete Tc.animationend.animation,delete Tc.animationiteration.animation,delete Tc.animationstart.animation),"TransitionEvent"in window||delete Tc.transitionend.transition);function vo(s){if(jp[s])return jp[s];if(!Tc[s])return s;var l=Tc[s],c;for(c in l)if(l.hasOwnProperty(c)&&c in p_)return jp[s]=l[c];return s}var g_=vo("animationend"),x_=vo("animationiteration"),v_=vo("animationstart"),E3=vo("transitionrun"),T3=vo("transitionstart"),S3=vo("transitioncancel"),y_=vo("transitionend"),__=new Map,Lp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lp.push("scrollEnd");function ms(s,l){__.set(s,l),fr(l,[s])}var Ch=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ba=[],Sc=0,Bp=0;function Nh(){for(var s=Sc,l=Bp=Sc=0;l<s;){var c=Ba[l];Ba[l++]=null;var h=Ba[l];Ba[l++]=null;var v=Ba[l];Ba[l++]=null;var _=Ba[l];if(Ba[l++]=null,h!==null&&v!==null){var k=h.pending;k===null?v.next=v:(v.next=k.next,k.next=v),h.pending=v}_!==0&&w_(c,v,_)}}function Rh(s,l,c,h){Ba[Sc++]=s,Ba[Sc++]=l,Ba[Sc++]=c,Ba[Sc++]=h,Bp|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function Vp(s,l,c,h){return Rh(s,l,c,h),Ih(s)}function yo(s,l){return Rh(s,null,null,l),Ih(s)}function w_(s,l,c){s.lanes|=c;var h=s.alternate;h!==null&&(h.lanes|=c);for(var v=!1,_=s.return;_!==null;)_.childLanes|=c,h=_.alternate,h!==null&&(h.childLanes|=c),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(v=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,v&&l!==null&&(v=31-gr(c),s=_.hiddenUpdates,h=s[v],h===null?s[v]=[l]:h.push(l),l.lane=c|536870912),_):null}function Ih(s){if(50<Tf)throw Tf=0,$g=null,Error(n(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var Ac={};function A3(s,l,c,h){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _a(s,l,c,h){return new A3(s,l,c,h)}function Up(s){return s=s.prototype,!(!s||!s.isReactComponent)}function oi(s,l){var c=s.alternate;return c===null?(c=_a(s.tag,l,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=l,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,l=s.dependencies,c.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function b_(s,l){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,l=c.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Dh(s,l,c,h,v,_){var k=0;if(h=s,typeof s=="function")Up(s)&&(k=1);else if(typeof s=="string")k=I6(s,c,J.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case N:return s=_a(31,c,l,v),s.elementType=N,s.lanes=_,s;case w:return _o(c.children,v,_,l);case T:k=8,v|=24;break;case R:return s=_a(12,c,l,v|2),s.elementType=R,s.lanes=_,s;case U:return s=_a(13,c,l,v),s.elementType=U,s.lanes=_,s;case B:return s=_a(19,c,l,v),s.elementType=B,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case C:k=10;break e;case I:k=9;break e;case W:k=11;break e;case A:k=14;break e;case D:k=16,h=null;break e}k=29,c=Error(n(130,s===null?"null":typeof s,"")),h=null}return l=_a(k,c,l,v),l.elementType=s,l.type=h,l.lanes=_,l}function _o(s,l,c,h){return s=_a(7,s,h,l),s.lanes=c,s}function zp(s,l,c){return s=_a(6,s,null,l),s.lanes=c,s}function E_(s){var l=_a(18,null,null,0);return l.stateNode=s,l}function Hp(s,l,c){return l=_a(4,s.children!==null?s.children:[],s.key,l),l.lanes=c,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var T_=new WeakMap;function Va(s,l){if(typeof s=="object"&&s!==null){var c=T_.get(s);return c!==void 0?c:(l={value:s,source:l,stack:Qe(l)},T_.set(s,l),l)}return{value:s,source:l,stack:Qe(l)}}var kc=[],Cc=0,Oh=null,rf=0,Ua=[],za=0,Zi=null,Os=1,Fs="";function ci(s,l){kc[Cc++]=rf,kc[Cc++]=Oh,Oh=s,rf=l}function S_(s,l,c){Ua[za++]=Os,Ua[za++]=Fs,Ua[za++]=Zi,Zi=s;var h=Os;s=Fs;var v=32-gr(h)-1;h&=~(1<<v),c+=1;var _=32-gr(l)+v;if(30<_){var k=v-v%5;_=(h&(1<<k)-1).toString(32),h>>=k,v-=k,Os=1<<32-gr(l)+v|c<<v|h,Fs=_+s}else Os=1<<_|c<<v|h,Fs=s}function Gp(s){s.return!==null&&(ci(s,1),S_(s,1,0))}function qp(s){for(;s===Oh;)Oh=kc[--Cc],kc[Cc]=null,rf=kc[--Cc],kc[Cc]=null;for(;s===Zi;)Zi=Ua[--za],Ua[za]=null,Fs=Ua[--za],Ua[za]=null,Os=Ua[--za],Ua[za]=null}function A_(s,l){Ua[za++]=Os,Ua[za++]=Fs,Ua[za++]=Zi,Os=l.id,Fs=l.overflow,Zi=s}var yn=null,xr=null,jt=!1,el=null,Ha=!1,Wp=Error(n(519));function tl(s){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw nf(Va(l,s)),Wp}function k_(s){var l=s.stateNode,c=s.type,h=s.memoizedProps;switch(l[q]=s,l[K]=h,c){case"dialog":Rt("cancel",l),Rt("close",l);break;case"iframe":case"object":case"embed":Rt("load",l);break;case"video":case"audio":for(c=0;c<Af.length;c++)Rt(Af[c],l);break;case"source":Rt("error",l);break;case"img":case"image":case"link":Rt("error",l),Rt("load",l);break;case"details":Rt("toggle",l);break;case"input":Rt("invalid",l),hh(l,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":Rt("invalid",l);break;case"textarea":Rt("invalid",l),Wi(l,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||l.textContent===""+c||h.suppressHydrationWarning===!0||Gw(l.textContent,c)?(h.popover!=null&&(Rt("beforetoggle",l),Rt("toggle",l)),h.onScroll!=null&&Rt("scroll",l),h.onScrollEnd!=null&&Rt("scrollend",l),h.onClick!=null&&(l.onclick=cs),l=!0):l=!1,l||tl(s,!0)}function C_(s){for(yn=s.return;yn;)switch(yn.tag){case 5:case 31:case 13:Ha=!1;return;case 27:case 3:Ha=!0;return;default:yn=yn.return}}function Nc(s){if(s!==yn)return!1;if(!jt)return C_(s),jt=!0,!1;var l=s.tag,c;if((c=l!==3&&l!==27)&&((c=l===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||u1(s.type,s.memoizedProps)),c=!c),c&&xr&&tl(s),C_(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));xr=Zw(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));xr=Zw(s)}else l===27?(l=xr,pl(s.type)?(s=p1,p1=null,xr=s):xr=l):xr=yn?qa(s.stateNode.nextSibling):null;return!0}function wo(){xr=yn=null,jt=!1}function Xp(){var s=el;return s!==null&&(ia===null?ia=s:ia.push.apply(ia,s),el=null),s}function nf(s){el===null?el=[s]:el.push(s)}var Yp=Y(null),bo=null,ui=null;function rl(s,l,c){X(Yp,l._currentValue),l._currentValue=c}function fi(s){s._currentValue=Yp.current,j(Yp)}function $p(s,l,c){for(;s!==null;){var h=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,h!==null&&(h.childLanes|=l)):h!==null&&(h.childLanes&l)!==l&&(h.childLanes|=l),s===c)break;s=s.return}}function Kp(s,l,c,h){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var _=v.dependencies;if(_!==null){var k=v.child;_=_.firstContext;e:for(;_!==null;){var z=_;_=v;for(var se=0;se<l.length;se++)if(z.context===l[se]){_.lanes|=c,z=_.alternate,z!==null&&(z.lanes|=c),$p(_.return,c,s),h||(k=null);break e}_=z.next}}else if(v.tag===18){if(k=v.return,k===null)throw Error(n(341));k.lanes|=c,_=k.alternate,_!==null&&(_.lanes|=c),$p(k,c,s),k=null}else k=v.child;if(k!==null)k.return=v;else for(k=v;k!==null;){if(k===s){k=null;break}if(v=k.sibling,v!==null){v.return=k.return,k=v;break}k=k.return}v=k}}function Rc(s,l,c,h){s=null;for(var v=l,_=!1;v!==null;){if(!_){if((v.flags&524288)!==0)_=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var k=v.alternate;if(k===null)throw Error(n(387));if(k=k.memoizedProps,k!==null){var z=v.type;ya(v.pendingProps.value,k.value)||(s!==null?s.push(z):s=[z])}}else if(v===Te.current){if(k=v.alternate,k===null)throw Error(n(387));k.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(If):s=[If])}v=v.return}s!==null&&Kp(l,s,c,h),l.flags|=262144}function Fh(s){for(s=s.firstContext;s!==null;){if(!ya(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Eo(s){bo=s,ui=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function _n(s){return N_(bo,s)}function Mh(s,l){return bo===null&&Eo(s),N_(s,l)}function N_(s,l){var c=l._currentValue;if(l={context:l,memoizedValue:c,next:null},ui===null){if(s===null)throw Error(n(308));ui=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else ui=ui.next=l;return c}var k3=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(c,h){s.push(h)}};this.abort=function(){l.aborted=!0,s.forEach(function(c){return c()})}},C3=t.unstable_scheduleCallback,N3=t.unstable_NormalPriority,$r={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qp(){return{controller:new k3,data:new Map,refCount:0}}function af(s){s.refCount--,s.refCount===0&&C3(N3,function(){s.controller.abort()})}var sf=null,Jp=0,Ic=0,Dc=null;function R3(s,l){if(sf===null){var c=sf=[];Jp=0,Ic=t1(),Dc={status:"pending",value:void 0,then:function(h){c.push(h)}}}return Jp++,l.then(R_,R_),l}function R_(){if(--Jp===0&&sf!==null){Dc!==null&&(Dc.status="fulfilled");var s=sf;sf=null,Ic=0,Dc=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function I3(s,l){var c=[],h={status:"pending",value:null,reason:null,then:function(v){c.push(v)}};return s.then(function(){h.status="fulfilled",h.value=l;for(var v=0;v<c.length;v++)(0,c[v])(l)},function(v){for(h.status="rejected",h.reason=v,v=0;v<c.length;v++)(0,c[v])(void 0)}),h}var I_=ie.S;ie.S=function(s,l){mw=Bt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&R3(s,l),I_!==null&&I_(s,l)};var To=Y(null);function Zp(){var s=To.current;return s!==null?s:hr.pooledCache}function Ph(s,l){l===null?X(To,To.current):X(To,l.pool)}function D_(){var s=Zp();return s===null?null:{parent:$r._currentValue,pool:s}}var Oc=Error(n(460)),eg=Error(n(474)),jh=Error(n(542)),Lh={then:function(){}};function O_(s){return s=s.status,s==="fulfilled"||s==="rejected"}function F_(s,l,c){switch(c=s[c],c===void 0?s.push(l):c!==l&&(l.then(cs,cs),l=c),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,P_(s),s;default:if(typeof l.status=="string")l.then(cs,cs);else{if(s=hr,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=l,s.status="pending",s.then(function(h){if(l.status==="pending"){var v=l;v.status="fulfilled",v.value=h}},function(h){if(l.status==="pending"){var v=l;v.status="rejected",v.reason=h}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,P_(s),s}throw Ao=l,Oc}}function So(s){try{var l=s._init;return l(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Ao=c,Oc):c}}var Ao=null;function M_(){if(Ao===null)throw Error(n(459));var s=Ao;return Ao=null,s}function P_(s){if(s===Oc||s===jh)throw Error(n(483))}var Fc=null,lf=0;function Bh(s){var l=lf;return lf+=1,Fc===null&&(Fc=[]),F_(Fc,s,l)}function of(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Vh(s,l){throw l.$$typeof===y?Error(n(525)):(s=Object.prototype.toString.call(l),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function j_(s){function l(ce,oe){if(s){var he=ce.deletions;he===null?(ce.deletions=[oe],ce.flags|=16):he.push(oe)}}function c(ce,oe){if(!s)return null;for(;oe!==null;)l(ce,oe),oe=oe.sibling;return null}function h(ce){for(var oe=new Map;ce!==null;)ce.key!==null?oe.set(ce.key,ce):oe.set(ce.index,ce),ce=ce.sibling;return oe}function v(ce,oe){return ce=oi(ce,oe),ce.index=0,ce.sibling=null,ce}function _(ce,oe,he){return ce.index=he,s?(he=ce.alternate,he!==null?(he=he.index,he<oe?(ce.flags|=67108866,oe):he):(ce.flags|=67108866,oe)):(ce.flags|=1048576,oe)}function k(ce){return s&&ce.alternate===null&&(ce.flags|=67108866),ce}function z(ce,oe,he,Ne){return oe===null||oe.tag!==6?(oe=zp(he,ce.mode,Ne),oe.return=ce,oe):(oe=v(oe,he),oe.return=ce,oe)}function se(ce,oe,he,Ne){var rt=he.type;return rt===w?ke(ce,oe,he.props.children,Ne,he.key):oe!==null&&(oe.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===D&&So(rt)===oe.type)?(oe=v(oe,he.props),of(oe,he),oe.return=ce,oe):(oe=Dh(he.type,he.key,he.props,null,ce.mode,Ne),of(oe,he),oe.return=ce,oe)}function pe(ce,oe,he,Ne){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==he.containerInfo||oe.stateNode.implementation!==he.implementation?(oe=Hp(he,ce.mode,Ne),oe.return=ce,oe):(oe=v(oe,he.children||[]),oe.return=ce,oe)}function ke(ce,oe,he,Ne,rt){return oe===null||oe.tag!==7?(oe=_o(he,ce.mode,Ne,rt),oe.return=ce,oe):(oe=v(oe,he),oe.return=ce,oe)}function De(ce,oe,he){if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return oe=zp(""+oe,ce.mode,he),oe.return=ce,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case b:return he=Dh(oe.type,oe.key,oe.props,null,ce.mode,he),of(he,oe),he.return=ce,he;case E:return oe=Hp(oe,ce.mode,he),oe.return=ce,oe;case D:return oe=So(oe),De(ce,oe,he)}if(we(oe)||P(oe))return oe=_o(oe,ce.mode,he,null),oe.return=ce,oe;if(typeof oe.then=="function")return De(ce,Bh(oe),he);if(oe.$$typeof===C)return De(ce,Mh(ce,oe),he);Vh(ce,oe)}return null}function ve(ce,oe,he,Ne){var rt=oe!==null?oe.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return rt!==null?null:z(ce,oe,""+he,Ne);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case b:return he.key===rt?se(ce,oe,he,Ne):null;case E:return he.key===rt?pe(ce,oe,he,Ne):null;case D:return he=So(he),ve(ce,oe,he,Ne)}if(we(he)||P(he))return rt!==null?null:ke(ce,oe,he,Ne,null);if(typeof he.then=="function")return ve(ce,oe,Bh(he),Ne);if(he.$$typeof===C)return ve(ce,oe,Mh(ce,he),Ne);Vh(ce,he)}return null}function be(ce,oe,he,Ne,rt){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return ce=ce.get(he)||null,z(oe,ce,""+Ne,rt);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case b:return ce=ce.get(Ne.key===null?he:Ne.key)||null,se(oe,ce,Ne,rt);case E:return ce=ce.get(Ne.key===null?he:Ne.key)||null,pe(oe,ce,Ne,rt);case D:return Ne=So(Ne),be(ce,oe,he,Ne,rt)}if(we(Ne)||P(Ne))return ce=ce.get(he)||null,ke(oe,ce,Ne,rt,null);if(typeof Ne.then=="function")return be(ce,oe,he,Bh(Ne),rt);if(Ne.$$typeof===C)return be(ce,oe,he,Mh(oe,Ne),rt);Vh(oe,Ne)}return null}function Je(ce,oe,he,Ne){for(var rt=null,Ht=null,tt=oe,wt=oe=0,Ot=null;tt!==null&&wt<he.length;wt++){tt.index>wt?(Ot=tt,tt=null):Ot=tt.sibling;var Gt=ve(ce,tt,he[wt],Ne);if(Gt===null){tt===null&&(tt=Ot);break}s&&tt&&Gt.alternate===null&&l(ce,tt),oe=_(Gt,oe,wt),Ht===null?rt=Gt:Ht.sibling=Gt,Ht=Gt,tt=Ot}if(wt===he.length)return c(ce,tt),jt&&ci(ce,wt),rt;if(tt===null){for(;wt<he.length;wt++)tt=De(ce,he[wt],Ne),tt!==null&&(oe=_(tt,oe,wt),Ht===null?rt=tt:Ht.sibling=tt,Ht=tt);return jt&&ci(ce,wt),rt}for(tt=h(tt);wt<he.length;wt++)Ot=be(tt,ce,wt,he[wt],Ne),Ot!==null&&(s&&Ot.alternate!==null&&tt.delete(Ot.key===null?wt:Ot.key),oe=_(Ot,oe,wt),Ht===null?rt=Ot:Ht.sibling=Ot,Ht=Ot);return s&&tt.forEach(function(_l){return l(ce,_l)}),jt&&ci(ce,wt),rt}function it(ce,oe,he,Ne){if(he==null)throw Error(n(151));for(var rt=null,Ht=null,tt=oe,wt=oe=0,Ot=null,Gt=he.next();tt!==null&&!Gt.done;wt++,Gt=he.next()){tt.index>wt?(Ot=tt,tt=null):Ot=tt.sibling;var _l=ve(ce,tt,Gt.value,Ne);if(_l===null){tt===null&&(tt=Ot);break}s&&tt&&_l.alternate===null&&l(ce,tt),oe=_(_l,oe,wt),Ht===null?rt=_l:Ht.sibling=_l,Ht=_l,tt=Ot}if(Gt.done)return c(ce,tt),jt&&ci(ce,wt),rt;if(tt===null){for(;!Gt.done;wt++,Gt=he.next())Gt=De(ce,Gt.value,Ne),Gt!==null&&(oe=_(Gt,oe,wt),Ht===null?rt=Gt:Ht.sibling=Gt,Ht=Gt);return jt&&ci(ce,wt),rt}for(tt=h(tt);!Gt.done;wt++,Gt=he.next())Gt=be(tt,ce,wt,Gt.value,Ne),Gt!==null&&(s&&Gt.alternate!==null&&tt.delete(Gt.key===null?wt:Gt.key),oe=_(Gt,oe,wt),Ht===null?rt=Gt:Ht.sibling=Gt,Ht=Gt);return s&&tt.forEach(function(z6){return l(ce,z6)}),jt&&ci(ce,wt),rt}function cr(ce,oe,he,Ne){if(typeof he=="object"&&he!==null&&he.type===w&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case b:e:{for(var rt=he.key;oe!==null;){if(oe.key===rt){if(rt=he.type,rt===w){if(oe.tag===7){c(ce,oe.sibling),Ne=v(oe,he.props.children),Ne.return=ce,ce=Ne;break e}}else if(oe.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===D&&So(rt)===oe.type){c(ce,oe.sibling),Ne=v(oe,he.props),of(Ne,he),Ne.return=ce,ce=Ne;break e}c(ce,oe);break}else l(ce,oe);oe=oe.sibling}he.type===w?(Ne=_o(he.props.children,ce.mode,Ne,he.key),Ne.return=ce,ce=Ne):(Ne=Dh(he.type,he.key,he.props,null,ce.mode,Ne),of(Ne,he),Ne.return=ce,ce=Ne)}return k(ce);case E:e:{for(rt=he.key;oe!==null;){if(oe.key===rt)if(oe.tag===4&&oe.stateNode.containerInfo===he.containerInfo&&oe.stateNode.implementation===he.implementation){c(ce,oe.sibling),Ne=v(oe,he.children||[]),Ne.return=ce,ce=Ne;break e}else{c(ce,oe);break}else l(ce,oe);oe=oe.sibling}Ne=Hp(he,ce.mode,Ne),Ne.return=ce,ce=Ne}return k(ce);case D:return he=So(he),cr(ce,oe,he,Ne)}if(we(he))return Je(ce,oe,he,Ne);if(P(he)){if(rt=P(he),typeof rt!="function")throw Error(n(150));return he=rt.call(he),it(ce,oe,he,Ne)}if(typeof he.then=="function")return cr(ce,oe,Bh(he),Ne);if(he.$$typeof===C)return cr(ce,oe,Mh(ce,he),Ne);Vh(ce,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,oe!==null&&oe.tag===6?(c(ce,oe.sibling),Ne=v(oe,he),Ne.return=ce,ce=Ne):(c(ce,oe),Ne=zp(he,ce.mode,Ne),Ne.return=ce,ce=Ne),k(ce)):c(ce,oe)}return function(ce,oe,he,Ne){try{lf=0;var rt=cr(ce,oe,he,Ne);return Fc=null,rt}catch(tt){if(tt===Oc||tt===jh)throw tt;var Ht=_a(29,tt,null,ce.mode);return Ht.lanes=Ne,Ht.return=ce,Ht}finally{}}}var ko=j_(!0),L_=j_(!1),nl=!1;function tg(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rg(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function al(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function sl(s,l,c){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(Xt&2)!==0){var v=h.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),h.pending=l,l=Ih(s),w_(s,null,c),l}return Rh(s,h,l,c),Ih(s)}function cf(s,l,c){if(l=l.updateQueue,l!==null&&(l=l.shared,(c&4194048)!==0)){var h=l.lanes;h&=s.pendingLanes,c|=h,l.lanes=c,ni(s,c)}}function ng(s,l){var c=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var v=null,_=null;if(c=c.firstBaseUpdate,c!==null){do{var k={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};_===null?v=_=k:_=_.next=k,c=c.next}while(c!==null);_===null?v=_=l:_=_.next=l}else v=_=l;c={baseState:h.baseState,firstBaseUpdate:v,lastBaseUpdate:_,shared:h.shared,callbacks:h.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=l}var ag=!1;function uf(){if(ag){var s=Dc;if(s!==null)throw s}}function ff(s,l,c,h){ag=!1;var v=s.updateQueue;nl=!1;var _=v.firstBaseUpdate,k=v.lastBaseUpdate,z=v.shared.pending;if(z!==null){v.shared.pending=null;var se=z,pe=se.next;se.next=null,k===null?_=pe:k.next=pe,k=se;var ke=s.alternate;ke!==null&&(ke=ke.updateQueue,z=ke.lastBaseUpdate,z!==k&&(z===null?ke.firstBaseUpdate=pe:z.next=pe,ke.lastBaseUpdate=se))}if(_!==null){var De=v.baseState;k=0,ke=pe=se=null,z=_;do{var ve=z.lane&-536870913,be=ve!==z.lane;if(be?(Dt&ve)===ve:(h&ve)===ve){ve!==0&&ve===Ic&&(ag=!0),ke!==null&&(ke=ke.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var Je=s,it=z;ve=l;var cr=c;switch(it.tag){case 1:if(Je=it.payload,typeof Je=="function"){De=Je.call(cr,De,ve);break e}De=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=it.payload,ve=typeof Je=="function"?Je.call(cr,De,ve):Je,ve==null)break e;De=x({},De,ve);break e;case 2:nl=!0}}ve=z.callback,ve!==null&&(s.flags|=64,be&&(s.flags|=8192),be=v.callbacks,be===null?v.callbacks=[ve]:be.push(ve))}else be={lane:ve,tag:z.tag,payload:z.payload,callback:z.callback,next:null},ke===null?(pe=ke=be,se=De):ke=ke.next=be,k|=ve;if(z=z.next,z===null){if(z=v.shared.pending,z===null)break;be=z,z=be.next,be.next=null,v.lastBaseUpdate=be,v.shared.pending=null}}while(!0);ke===null&&(se=De),v.baseState=se,v.firstBaseUpdate=pe,v.lastBaseUpdate=ke,_===null&&(v.shared.lanes=0),ul|=k,s.lanes=k,s.memoizedState=De}}function B_(s,l){if(typeof s!="function")throw Error(n(191,s));s.call(l)}function V_(s,l){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)B_(c[s],l)}var Mc=Y(null),Uh=Y(0);function U_(s,l){s=_i,X(Uh,s),X(Mc,l),_i=s|l.baseLanes}function sg(){X(Uh,_i),X(Mc,Mc.current)}function ig(){_i=Uh.current,j(Mc),j(Uh)}var wa=Y(null),Ga=null;function il(s){var l=s.alternate;X(Ur,Ur.current&1),X(wa,s),Ga===null&&(l===null||Mc.current!==null||l.memoizedState!==null)&&(Ga=s)}function lg(s){X(Ur,Ur.current),X(wa,s),Ga===null&&(Ga=s)}function z_(s){s.tag===22?(X(Ur,Ur.current),X(wa,s),Ga===null&&(Ga=s)):ll()}function ll(){X(Ur,Ur.current),X(wa,wa.current)}function ba(s){j(wa),Ga===s&&(Ga=null),j(Ur)}var Ur=Y(0);function zh(s){for(var l=s;l!==null;){if(l.tag===13){var c=l.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||d1(c)||m1(c)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var hi=0,yt=null,lr=null,Kr=null,Hh=!1,Pc=!1,Co=!1,Gh=0,hf=0,jc=null,D3=0;function Fr(){throw Error(n(321))}function og(s,l){if(l===null)return!1;for(var c=0;c<l.length&&c<s.length;c++)if(!ya(s[c],l[c]))return!1;return!0}function cg(s,l,c,h,v,_){return hi=_,yt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,ie.H=s===null||s.memoizedState===null?S2:Tg,Co=!1,_=c(h,v),Co=!1,Pc&&(_=G_(l,c,h,v)),H_(s),_}function H_(s){ie.H=pf;var l=lr!==null&&lr.next!==null;if(hi=0,Kr=lr=yt=null,Hh=!1,hf=0,jc=null,l)throw Error(n(300));s===null||Qr||(s=s.dependencies,s!==null&&Fh(s)&&(Qr=!0))}function G_(s,l,c,h){yt=s;var v=0;do{if(Pc&&(jc=null),hf=0,Pc=!1,25<=v)throw Error(n(301));if(v+=1,Kr=lr=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}ie.H=A2,_=l(c,h)}while(Pc);return _}function O3(){var s=ie.H,l=s.useState()[0];return l=typeof l.then=="function"?df(l):l,s=s.useState()[0],(lr!==null?lr.memoizedState:null)!==s&&(yt.flags|=1024),l}function ug(){var s=Gh!==0;return Gh=0,s}function fg(s,l,c){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~c}function hg(s){if(Hh){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Hh=!1}hi=0,Kr=lr=yt=null,Pc=!1,hf=Gh=0,jc=null}function $n(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?yt.memoizedState=Kr=s:Kr=Kr.next=s,Kr}function zr(){if(lr===null){var s=yt.alternate;s=s!==null?s.memoizedState:null}else s=lr.next;var l=Kr===null?yt.memoizedState:Kr.next;if(l!==null)Kr=l,lr=s;else{if(s===null)throw yt.alternate===null?Error(n(467)):Error(n(310));lr=s,s={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},Kr===null?yt.memoizedState=Kr=s:Kr=Kr.next=s}return Kr}function qh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function df(s){var l=hf;return hf+=1,jc===null&&(jc=[]),s=F_(jc,s,l),l=yt,(Kr===null?l.memoizedState:Kr.next)===null&&(l=l.alternate,ie.H=l===null||l.memoizedState===null?S2:Tg),s}function Wh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return df(s);if(s.$$typeof===C)return _n(s)}throw Error(n(438,String(s)))}function dg(s){var l=null,c=yt.updateQueue;if(c!==null&&(l=c.memoCache),l==null){var h=yt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(l={data:h.data.map(function(v){return v.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),c===null&&(c=qh(),yt.updateQueue=c),c.memoCache=l,c=l.data[l.index],c===void 0)for(c=l.data[l.index]=Array(s),h=0;h<s;h++)c[h]=M;return l.index++,c}function di(s,l){return typeof l=="function"?l(s):l}function Xh(s){var l=zr();return mg(l,lr,s)}function mg(s,l,c){var h=s.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=c;var v=s.baseQueue,_=h.pending;if(_!==null){if(v!==null){var k=v.next;v.next=_.next,_.next=k}l.baseQueue=v=_,h.pending=null}if(_=s.baseState,v===null)s.memoizedState=_;else{l=v.next;var z=k=null,se=null,pe=l,ke=!1;do{var De=pe.lane&-536870913;if(De!==pe.lane?(Dt&De)===De:(hi&De)===De){var ve=pe.revertLane;if(ve===0)se!==null&&(se=se.next={lane:0,revertLane:0,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),De===Ic&&(ke=!0);else if((hi&ve)===ve){pe=pe.next,ve===Ic&&(ke=!0);continue}else De={lane:0,revertLane:pe.revertLane,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},se===null?(z=se=De,k=_):se=se.next=De,yt.lanes|=ve,ul|=ve;De=pe.action,Co&&c(_,De),_=pe.hasEagerState?pe.eagerState:c(_,De)}else ve={lane:De,revertLane:pe.revertLane,gesture:pe.gesture,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},se===null?(z=se=ve,k=_):se=se.next=ve,yt.lanes|=De,ul|=De;pe=pe.next}while(pe!==null&&pe!==l);if(se===null?k=_:se.next=z,!ya(_,s.memoizedState)&&(Qr=!0,ke&&(c=Dc,c!==null)))throw c;s.memoizedState=_,s.baseState=k,s.baseQueue=se,h.lastRenderedState=_}return v===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function pg(s){var l=zr(),c=l.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var h=c.dispatch,v=c.pending,_=l.memoizedState;if(v!==null){c.pending=null;var k=v=v.next;do _=s(_,k.action),k=k.next;while(k!==v);ya(_,l.memoizedState)||(Qr=!0),l.memoizedState=_,l.baseQueue===null&&(l.baseState=_),c.lastRenderedState=_}return[_,h]}function q_(s,l,c){var h=yt,v=zr(),_=jt;if(_){if(c===void 0)throw Error(n(407));c=c()}else c=l();var k=!ya((lr||v).memoizedState,c);if(k&&(v.memoizedState=c,Qr=!0),v=v.queue,vg(Y_.bind(null,h,v,s),[s]),v.getSnapshot!==l||k||Kr!==null&&Kr.memoizedState.tag&1){if(h.flags|=2048,Lc(9,{destroy:void 0},X_.bind(null,h,v,c,l),null),hr===null)throw Error(n(349));_||(hi&127)!==0||W_(h,l,c)}return c}function W_(s,l,c){s.flags|=16384,s={getSnapshot:l,value:c},l=yt.updateQueue,l===null?(l=qh(),yt.updateQueue=l,l.stores=[s]):(c=l.stores,c===null?l.stores=[s]:c.push(s))}function X_(s,l,c,h){l.value=c,l.getSnapshot=h,$_(l)&&K_(s)}function Y_(s,l,c){return c(function(){$_(l)&&K_(s)})}function $_(s){var l=s.getSnapshot;s=s.value;try{var c=l();return!ya(s,c)}catch{return!0}}function K_(s){var l=yo(s,2);l!==null&&la(l,s,2)}function gg(s){var l=$n();if(typeof s=="function"){var c=s;if(s=c(),Co){Dr(!0);try{c()}finally{Dr(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:di,lastRenderedState:s},l}function Q_(s,l,c,h){return s.baseState=c,mg(s,lr,typeof h=="function"?h:di)}function F3(s,l,c,h,v){if(Kh(s))throw Error(n(485));if(s=l.action,s!==null){var _={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){_.listeners.push(k)}};ie.T!==null?c(!0):_.isTransition=!1,h(_),c=l.pending,c===null?(_.next=l.pending=_,J_(l,_)):(_.next=c.next,l.pending=c.next=_)}}function J_(s,l){var c=l.action,h=l.payload,v=s.state;if(l.isTransition){var _=ie.T,k={};ie.T=k;try{var z=c(v,h),se=ie.S;se!==null&&se(k,z),Z_(s,l,z)}catch(pe){xg(s,l,pe)}finally{_!==null&&k.types!==null&&(_.types=k.types),ie.T=_}}else try{_=c(v,h),Z_(s,l,_)}catch(pe){xg(s,l,pe)}}function Z_(s,l,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){e2(s,l,h)},function(h){return xg(s,l,h)}):e2(s,l,c)}function e2(s,l,c){l.status="fulfilled",l.value=c,t2(l),s.state=c,l=s.pending,l!==null&&(c=l.next,c===l?s.pending=null:(c=c.next,l.next=c,J_(s,c)))}function xg(s,l,c){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do l.status="rejected",l.reason=c,t2(l),l=l.next;while(l!==h)}s.action=null}function t2(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function r2(s,l){return l}function n2(s,l){if(jt){var c=hr.formState;if(c!==null){e:{var h=yt;if(jt){if(xr){t:{for(var v=xr,_=Ha;v.nodeType!==8;){if(!_){v=null;break t}if(v=qa(v.nextSibling),v===null){v=null;break t}}_=v.data,v=_==="F!"||_==="F"?v:null}if(v){xr=qa(v.nextSibling),h=v.data==="F!";break e}}tl(h)}h=!1}h&&(l=c[0])}}return c=$n(),c.memoizedState=c.baseState=l,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r2,lastRenderedState:l},c.queue=h,c=b2.bind(null,yt,h),h.dispatch=c,h=gg(!1),_=Eg.bind(null,yt,!1,h.queue),h=$n(),v={state:l,dispatch:null,action:s,pending:null},h.queue=v,c=F3.bind(null,yt,v,_,c),v.dispatch=c,h.memoizedState=s,[l,c,!1]}function a2(s){var l=zr();return s2(l,lr,s)}function s2(s,l,c){if(l=mg(s,l,r2)[0],s=Xh(di)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var h=df(l)}catch(k){throw k===Oc?jh:k}else h=l;l=zr();var v=l.queue,_=v.dispatch;return c!==l.memoizedState&&(yt.flags|=2048,Lc(9,{destroy:void 0},M3.bind(null,v,c),null)),[h,_,s]}function M3(s,l){s.action=l}function i2(s){var l=zr(),c=lr;if(c!==null)return s2(l,c,s);zr(),l=l.memoizedState,c=zr();var h=c.queue.dispatch;return c.memoizedState=s,[l,h,!1]}function Lc(s,l,c,h){return s={tag:s,create:c,deps:h,inst:l,next:null},l=yt.updateQueue,l===null&&(l=qh(),yt.updateQueue=l),c=l.lastEffect,c===null?l.lastEffect=s.next=s:(h=c.next,c.next=s,s.next=h,l.lastEffect=s),s}function l2(){return zr().memoizedState}function Yh(s,l,c,h){var v=$n();yt.flags|=s,v.memoizedState=Lc(1|l,{destroy:void 0},c,h===void 0?null:h)}function $h(s,l,c,h){var v=zr();h=h===void 0?null:h;var _=v.memoizedState.inst;lr!==null&&h!==null&&og(h,lr.memoizedState.deps)?v.memoizedState=Lc(l,_,c,h):(yt.flags|=s,v.memoizedState=Lc(1|l,_,c,h))}function o2(s,l){Yh(8390656,8,s,l)}function vg(s,l){$h(2048,8,s,l)}function P3(s){yt.flags|=4;var l=yt.updateQueue;if(l===null)l=qh(),yt.updateQueue=l,l.events=[s];else{var c=l.events;c===null?l.events=[s]:c.push(s)}}function c2(s){var l=zr().memoizedState;return P3({ref:l,nextImpl:s}),function(){if((Xt&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function u2(s,l){return $h(4,2,s,l)}function f2(s,l){return $h(4,4,s,l)}function h2(s,l){if(typeof l=="function"){s=s();var c=l(s);return function(){typeof c=="function"?c():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function d2(s,l,c){c=c!=null?c.concat([s]):null,$h(4,4,h2.bind(null,l,s),c)}function yg(){}function m2(s,l){var c=zr();l=l===void 0?null:l;var h=c.memoizedState;return l!==null&&og(l,h[1])?h[0]:(c.memoizedState=[s,l],s)}function p2(s,l){var c=zr();l=l===void 0?null:l;var h=c.memoizedState;if(l!==null&&og(l,h[1]))return h[0];if(h=s(),Co){Dr(!0);try{s()}finally{Dr(!1)}}return c.memoizedState=[h,l],h}function _g(s,l,c){return c===void 0||(hi&1073741824)!==0&&(Dt&261930)===0?s.memoizedState=l:(s.memoizedState=c,s=gw(),yt.lanes|=s,ul|=s,c)}function g2(s,l,c,h){return ya(c,l)?c:Mc.current!==null?(s=_g(s,c,h),ya(s,l)||(Qr=!0),s):(hi&42)===0||(hi&1073741824)!==0&&(Dt&261930)===0?(Qr=!0,s.memoizedState=c):(s=gw(),yt.lanes|=s,ul|=s,l)}function x2(s,l,c,h,v){var _=ee.p;ee.p=_!==0&&8>_?_:8;var k=ie.T,z={};ie.T=z,Eg(s,!1,l,c);try{var se=v(),pe=ie.S;if(pe!==null&&pe(z,se),se!==null&&typeof se=="object"&&typeof se.then=="function"){var ke=I3(se,h);mf(s,l,ke,Sa(s))}else mf(s,l,h,Sa(s))}catch(De){mf(s,l,{then:function(){},status:"rejected",reason:De},Sa())}finally{ee.p=_,k!==null&&z.types!==null&&(k.types=z.types),ie.T=k}}function j3(){}function wg(s,l,c,h){if(s.tag!==5)throw Error(n(476));var v=v2(s).queue;x2(s,v,l,ye,c===null?j3:function(){return y2(s),c(h)})}function v2(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:ye,baseState:ye,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:di,lastRenderedState:ye},next:null};var c={};return l.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:di,lastRenderedState:c},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function y2(s){var l=v2(s);l.next===null&&(l=s.alternate.memoizedState),mf(s,l.next.queue,{},Sa())}function bg(){return _n(If)}function _2(){return zr().memoizedState}function w2(){return zr().memoizedState}function L3(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var c=Sa();s=al(c);var h=sl(l,s,c);h!==null&&(la(h,l,c),cf(h,l,c)),l={cache:Qp()},s.payload=l;return}l=l.return}}function B3(s,l,c){var h=Sa();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Kh(s)?E2(l,c):(c=Vp(s,l,c,h),c!==null&&(la(c,s,h),T2(c,l,h)))}function b2(s,l,c){var h=Sa();mf(s,l,c,h)}function mf(s,l,c,h){var v={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Kh(s))E2(l,v);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=l.lastRenderedReducer,_!==null))try{var k=l.lastRenderedState,z=_(k,c);if(v.hasEagerState=!0,v.eagerState=z,ya(z,k))return Rh(s,l,v,0),hr===null&&Nh(),!1}catch{}finally{}if(c=Vp(s,l,v,h),c!==null)return la(c,s,h),T2(c,l,h),!0}return!1}function Eg(s,l,c,h){if(h={lane:2,revertLane:t1(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Kh(s)){if(l)throw Error(n(479))}else l=Vp(s,c,h,2),l!==null&&la(l,s,2)}function Kh(s){var l=s.alternate;return s===yt||l!==null&&l===yt}function E2(s,l){Pc=Hh=!0;var c=s.pending;c===null?l.next=l:(l.next=c.next,c.next=l),s.pending=l}function T2(s,l,c){if((c&4194048)!==0){var h=l.lanes;h&=s.pendingLanes,c|=h,l.lanes=c,ni(s,c)}}var pf={readContext:_n,use:Wh,useCallback:Fr,useContext:Fr,useEffect:Fr,useImperativeHandle:Fr,useLayoutEffect:Fr,useInsertionEffect:Fr,useMemo:Fr,useReducer:Fr,useRef:Fr,useState:Fr,useDebugValue:Fr,useDeferredValue:Fr,useTransition:Fr,useSyncExternalStore:Fr,useId:Fr,useHostTransitionStatus:Fr,useFormState:Fr,useActionState:Fr,useOptimistic:Fr,useMemoCache:Fr,useCacheRefresh:Fr};pf.useEffectEvent=Fr;var S2={readContext:_n,use:Wh,useCallback:function(s,l){return $n().memoizedState=[s,l===void 0?null:l],s},useContext:_n,useEffect:o2,useImperativeHandle:function(s,l,c){c=c!=null?c.concat([s]):null,Yh(4194308,4,h2.bind(null,l,s),c)},useLayoutEffect:function(s,l){return Yh(4194308,4,s,l)},useInsertionEffect:function(s,l){Yh(4,2,s,l)},useMemo:function(s,l){var c=$n();l=l===void 0?null:l;var h=s();if(Co){Dr(!0);try{s()}finally{Dr(!1)}}return c.memoizedState=[h,l],h},useReducer:function(s,l,c){var h=$n();if(c!==void 0){var v=c(l);if(Co){Dr(!0);try{c(l)}finally{Dr(!1)}}}else v=l;return h.memoizedState=h.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},h.queue=s,s=s.dispatch=B3.bind(null,yt,s),[h.memoizedState,s]},useRef:function(s){var l=$n();return s={current:s},l.memoizedState=s},useState:function(s){s=gg(s);var l=s.queue,c=b2.bind(null,yt,l);return l.dispatch=c,[s.memoizedState,c]},useDebugValue:yg,useDeferredValue:function(s,l){var c=$n();return _g(c,s,l)},useTransition:function(){var s=gg(!1);return s=x2.bind(null,yt,s.queue,!0,!1),$n().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,c){var h=yt,v=$n();if(jt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=l(),hr===null)throw Error(n(349));(Dt&127)!==0||W_(h,l,c)}v.memoizedState=c;var _={value:c,getSnapshot:l};return v.queue=_,o2(Y_.bind(null,h,_,s),[s]),h.flags|=2048,Lc(9,{destroy:void 0},X_.bind(null,h,_,c,l),null),c},useId:function(){var s=$n(),l=hr.identifierPrefix;if(jt){var c=Fs,h=Os;c=(h&~(1<<32-gr(h)-1)).toString(32)+c,l="_"+l+"R_"+c,c=Gh++,0<c&&(l+="H"+c.toString(32)),l+="_"}else c=D3++,l="_"+l+"r_"+c.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:bg,useFormState:n2,useActionState:n2,useOptimistic:function(s){var l=$n();l.memoizedState=l.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=c,l=Eg.bind(null,yt,!0,c),c.dispatch=l,[s,l]},useMemoCache:dg,useCacheRefresh:function(){return $n().memoizedState=L3.bind(null,yt)},useEffectEvent:function(s){var l=$n(),c={impl:s};return l.memoizedState=c,function(){if((Xt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},Tg={readContext:_n,use:Wh,useCallback:m2,useContext:_n,useEffect:vg,useImperativeHandle:d2,useInsertionEffect:u2,useLayoutEffect:f2,useMemo:p2,useReducer:Xh,useRef:l2,useState:function(){return Xh(di)},useDebugValue:yg,useDeferredValue:function(s,l){var c=zr();return g2(c,lr.memoizedState,s,l)},useTransition:function(){var s=Xh(di)[0],l=zr().memoizedState;return[typeof s=="boolean"?s:df(s),l]},useSyncExternalStore:q_,useId:_2,useHostTransitionStatus:bg,useFormState:a2,useActionState:a2,useOptimistic:function(s,l){var c=zr();return Q_(c,lr,s,l)},useMemoCache:dg,useCacheRefresh:w2};Tg.useEffectEvent=c2;var A2={readContext:_n,use:Wh,useCallback:m2,useContext:_n,useEffect:vg,useImperativeHandle:d2,useInsertionEffect:u2,useLayoutEffect:f2,useMemo:p2,useReducer:pg,useRef:l2,useState:function(){return pg(di)},useDebugValue:yg,useDeferredValue:function(s,l){var c=zr();return lr===null?_g(c,s,l):g2(c,lr.memoizedState,s,l)},useTransition:function(){var s=pg(di)[0],l=zr().memoizedState;return[typeof s=="boolean"?s:df(s),l]},useSyncExternalStore:q_,useId:_2,useHostTransitionStatus:bg,useFormState:i2,useActionState:i2,useOptimistic:function(s,l){var c=zr();return lr!==null?Q_(c,lr,s,l):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:dg,useCacheRefresh:w2};A2.useEffectEvent=c2;function Sg(s,l,c,h){l=s.memoizedState,c=c(h,l),c=c==null?l:x({},l,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Ag={enqueueSetState:function(s,l,c){s=s._reactInternals;var h=Sa(),v=al(h);v.payload=l,c!=null&&(v.callback=c),l=sl(s,v,h),l!==null&&(la(l,s,h),cf(l,s,h))},enqueueReplaceState:function(s,l,c){s=s._reactInternals;var h=Sa(),v=al(h);v.tag=1,v.payload=l,c!=null&&(v.callback=c),l=sl(s,v,h),l!==null&&(la(l,s,h),cf(l,s,h))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var c=Sa(),h=al(c);h.tag=2,l!=null&&(h.callback=l),l=sl(s,h,c),l!==null&&(la(l,s,c),cf(l,s,c))}};function k2(s,l,c,h,v,_,k){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,_,k):l.prototype&&l.prototype.isPureReactComponent?!ef(c,h)||!ef(v,_):!0}function C2(s,l,c,h){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(c,h),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(c,h),l.state!==s&&Ag.enqueueReplaceState(l,l.state,null)}function No(s,l){var c=l;if("ref"in l){c={};for(var h in l)h!=="ref"&&(c[h]=l[h])}if(s=s.defaultProps){c===l&&(c=x({},c));for(var v in s)c[v]===void 0&&(c[v]=s[v])}return c}function N2(s){Ch(s)}function R2(s){console.error(s)}function I2(s){Ch(s)}function Qh(s,l){try{var c=s.onUncaughtError;c(l.value,{componentStack:l.stack})}catch(h){setTimeout(function(){throw h})}}function D2(s,l,c){try{var h=s.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function kg(s,l,c){return c=al(c),c.tag=3,c.payload={element:null},c.callback=function(){Qh(s,l)},c}function O2(s){return s=al(s),s.tag=3,s}function F2(s,l,c,h){var v=c.type.getDerivedStateFromError;if(typeof v=="function"){var _=h.value;s.payload=function(){return v(_)},s.callback=function(){D2(l,c,h)}}var k=c.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(s.callback=function(){D2(l,c,h),typeof v!="function"&&(fl===null?fl=new Set([this]):fl.add(this));var z=h.stack;this.componentDidCatch(h.value,{componentStack:z!==null?z:""})})}function V3(s,l,c,h,v){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(l=c.alternate,l!==null&&Rc(l,c,v,!0),c=wa.current,c!==null){switch(c.tag){case 31:case 13:return Ga===null?cd():c.alternate===null&&Mr===0&&(Mr=3),c.flags&=-257,c.flags|=65536,c.lanes=v,h===Lh?c.flags|=16384:(l=c.updateQueue,l===null?c.updateQueue=new Set([h]):l.add(h),Jg(s,h,v)),!1;case 22:return c.flags|=65536,h===Lh?c.flags|=16384:(l=c.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=l):(c=l.retryQueue,c===null?l.retryQueue=new Set([h]):c.add(h)),Jg(s,h,v)),!1}throw Error(n(435,c.tag))}return Jg(s,h,v),cd(),!1}if(jt)return l=wa.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=v,h!==Wp&&(s=Error(n(422),{cause:h}),nf(Va(s,c)))):(h!==Wp&&(l=Error(n(423),{cause:h}),nf(Va(l,c))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,h=Va(h,c),v=kg(s.stateNode,h,v),ng(s,v),Mr!==4&&(Mr=2)),!1;var _=Error(n(520),{cause:h});if(_=Va(_,c),Ef===null?Ef=[_]:Ef.push(_),Mr!==4&&(Mr=2),l===null)return!0;h=Va(h,c),c=l;do{switch(c.tag){case 3:return c.flags|=65536,s=v&-v,c.lanes|=s,s=kg(c.stateNode,h,s),ng(c,s),!1;case 1:if(l=c.type,_=c.stateNode,(c.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(fl===null||!fl.has(_))))return c.flags|=65536,v&=-v,c.lanes|=v,v=O2(v),F2(v,s,c,h),ng(c,v),!1}c=c.return}while(c!==null);return!1}var Cg=Error(n(461)),Qr=!1;function wn(s,l,c,h){l.child=s===null?L_(l,null,c,h):ko(l,s.child,c,h)}function M2(s,l,c,h,v){c=c.render;var _=l.ref;if("ref"in h){var k={};for(var z in h)z!=="ref"&&(k[z]=h[z])}else k=h;return Eo(l),h=cg(s,l,c,k,_,v),z=ug(),s!==null&&!Qr?(fg(s,l,v),mi(s,l,v)):(jt&&z&&Gp(l),l.flags|=1,wn(s,l,h,v),l.child)}function P2(s,l,c,h,v){if(s===null){var _=c.type;return typeof _=="function"&&!Up(_)&&_.defaultProps===void 0&&c.compare===null?(l.tag=15,l.type=_,j2(s,l,_,h,v)):(s=Dh(c.type,null,h,l,l.mode,v),s.ref=l.ref,s.return=l,l.child=s)}if(_=s.child,!Pg(s,v)){var k=_.memoizedProps;if(c=c.compare,c=c!==null?c:ef,c(k,h)&&s.ref===l.ref)return mi(s,l,v)}return l.flags|=1,s=oi(_,h),s.ref=l.ref,s.return=l,l.child=s}function j2(s,l,c,h,v){if(s!==null){var _=s.memoizedProps;if(ef(_,h)&&s.ref===l.ref)if(Qr=!1,l.pendingProps=h=_,Pg(s,v))(s.flags&131072)!==0&&(Qr=!0);else return l.lanes=s.lanes,mi(s,l,v)}return Ng(s,l,c,h,v)}function L2(s,l,c,h){var v=h.children,_=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((l.flags&128)!==0){if(_=_!==null?_.baseLanes|c:c,s!==null){for(h=l.child=s.child,v=0;h!==null;)v=v|h.lanes|h.childLanes,h=h.sibling;h=v&~_}else h=0,l.child=null;return B2(s,l,_,c,h)}if((c&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Ph(l,_!==null?_.cachePool:null),_!==null?U_(l,_):sg(),z_(l);else return h=l.lanes=536870912,B2(s,l,_!==null?_.baseLanes|c:c,c,h)}else _!==null?(Ph(l,_.cachePool),U_(l,_),ll(),l.memoizedState=null):(s!==null&&Ph(l,null),sg(),ll());return wn(s,l,v,c),l.child}function gf(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function B2(s,l,c,h,v){var _=Zp();return _=_===null?null:{parent:$r._currentValue,pool:_},l.memoizedState={baseLanes:c,cachePool:_},s!==null&&Ph(l,null),sg(),z_(l),s!==null&&Rc(s,l,h,!0),l.childLanes=v,null}function Jh(s,l){return l=ed({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function V2(s,l,c){return ko(l,s.child,null,c),s=Jh(l,l.pendingProps),s.flags|=2,ba(l),l.memoizedState=null,s}function U3(s,l,c){var h=l.pendingProps,v=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(jt){if(h.mode==="hidden")return s=Jh(l,h),l.lanes=536870912,gf(null,s);if(lg(l),(s=xr)?(s=Jw(s,Ha),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:Zi!==null?{id:Os,overflow:Fs}:null,retryLane:536870912,hydrationErrors:null},c=E_(s),c.return=l,l.child=c,yn=l,xr=null)):s=null,s===null)throw tl(l);return l.lanes=536870912,null}return Jh(l,h)}var _=s.memoizedState;if(_!==null){var k=_.dehydrated;if(lg(l),v)if(l.flags&256)l.flags&=-257,l=V2(s,l,c);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(n(558));else if(Qr||Rc(s,l,c,!1),v=(c&s.childLanes)!==0,Qr||v){if(h=hr,h!==null&&(k=io(h,c),k!==0&&k!==_.retryLane))throw _.retryLane=k,yo(s,k),la(h,s,k),Cg;cd(),l=V2(s,l,c)}else s=_.treeContext,xr=qa(k.nextSibling),yn=l,jt=!0,el=null,Ha=!1,s!==null&&A_(l,s),l=Jh(l,h),l.flags|=4096;return l}return s=oi(s.child,{mode:h.mode,children:h.children}),s.ref=l.ref,l.child=s,s.return=l,s}function Zh(s,l){var c=l.ref;if(c===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(s===null||s.ref!==c)&&(l.flags|=4194816)}}function Ng(s,l,c,h,v){return Eo(l),c=cg(s,l,c,h,void 0,v),h=ug(),s!==null&&!Qr?(fg(s,l,v),mi(s,l,v)):(jt&&h&&Gp(l),l.flags|=1,wn(s,l,c,v),l.child)}function U2(s,l,c,h,v,_){return Eo(l),l.updateQueue=null,c=G_(l,h,c,v),H_(s),h=ug(),s!==null&&!Qr?(fg(s,l,_),mi(s,l,_)):(jt&&h&&Gp(l),l.flags|=1,wn(s,l,c,_),l.child)}function z2(s,l,c,h,v){if(Eo(l),l.stateNode===null){var _=Ac,k=c.contextType;typeof k=="object"&&k!==null&&(_=_n(k)),_=new c(h,_),l.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Ag,l.stateNode=_,_._reactInternals=l,_=l.stateNode,_.props=h,_.state=l.memoizedState,_.refs={},tg(l),k=c.contextType,_.context=typeof k=="object"&&k!==null?_n(k):Ac,_.state=l.memoizedState,k=c.getDerivedStateFromProps,typeof k=="function"&&(Sg(l,c,k,h),_.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(k=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),k!==_.state&&Ag.enqueueReplaceState(_,_.state,null),ff(l,h,_,v),uf(),_.state=l.memoizedState),typeof _.componentDidMount=="function"&&(l.flags|=4194308),h=!0}else if(s===null){_=l.stateNode;var z=l.memoizedProps,se=No(c,z);_.props=se;var pe=_.context,ke=c.contextType;k=Ac,typeof ke=="object"&&ke!==null&&(k=_n(ke));var De=c.getDerivedStateFromProps;ke=typeof De=="function"||typeof _.getSnapshotBeforeUpdate=="function",z=l.pendingProps!==z,ke||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(z||pe!==k)&&C2(l,_,h,k),nl=!1;var ve=l.memoizedState;_.state=ve,ff(l,h,_,v),uf(),pe=l.memoizedState,z||ve!==pe||nl?(typeof De=="function"&&(Sg(l,c,De,h),pe=l.memoizedState),(se=nl||k2(l,c,se,h,ve,pe,k))?(ke||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(l.flags|=4194308)):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=h,l.memoizedState=pe),_.props=h,_.state=pe,_.context=k,h=se):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),h=!1)}else{_=l.stateNode,rg(s,l),k=l.memoizedProps,ke=No(c,k),_.props=ke,De=l.pendingProps,ve=_.context,pe=c.contextType,se=Ac,typeof pe=="object"&&pe!==null&&(se=_n(pe)),z=c.getDerivedStateFromProps,(pe=typeof z=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(k!==De||ve!==se)&&C2(l,_,h,se),nl=!1,ve=l.memoizedState,_.state=ve,ff(l,h,_,v),uf();var be=l.memoizedState;k!==De||ve!==be||nl||s!==null&&s.dependencies!==null&&Fh(s.dependencies)?(typeof z=="function"&&(Sg(l,c,z,h),be=l.memoizedState),(ke=nl||k2(l,c,ke,h,ve,be,se)||s!==null&&s.dependencies!==null&&Fh(s.dependencies))?(pe||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(h,be,se),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(h,be,se)),typeof _.componentDidUpdate=="function"&&(l.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof _.componentDidUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=1024),l.memoizedProps=h,l.memoizedState=be),_.props=h,_.state=be,_.context=se,h=ke):(typeof _.componentDidUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=1024),h=!1)}return _=h,Zh(s,l),h=(l.flags&128)!==0,_||h?(_=l.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:_.render(),l.flags|=1,s!==null&&h?(l.child=ko(l,s.child,null,v),l.child=ko(l,null,c,v)):wn(s,l,c,v),l.memoizedState=_.state,s=l.child):s=mi(s,l,v),s}function H2(s,l,c,h){return wo(),l.flags|=256,wn(s,l,c,h),l.child}var Rg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ig(s){return{baseLanes:s,cachePool:D_()}}function Dg(s,l,c){return s=s!==null?s.childLanes&~c:0,l&&(s|=Ta),s}function G2(s,l,c){var h=l.pendingProps,v=!1,_=(l.flags&128)!==0,k;if((k=_)||(k=s!==null&&s.memoizedState===null?!1:(Ur.current&2)!==0),k&&(v=!0,l.flags&=-129),k=(l.flags&32)!==0,l.flags&=-33,s===null){if(jt){if(v?il(l):ll(),(s=xr)?(s=Jw(s,Ha),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:Zi!==null?{id:Os,overflow:Fs}:null,retryLane:536870912,hydrationErrors:null},c=E_(s),c.return=l,l.child=c,yn=l,xr=null)):s=null,s===null)throw tl(l);return m1(s)?l.lanes=32:l.lanes=536870912,null}var z=h.children;return h=h.fallback,v?(ll(),v=l.mode,z=ed({mode:"hidden",children:z},v),h=_o(h,v,c,null),z.return=l,h.return=l,z.sibling=h,l.child=z,h=l.child,h.memoizedState=Ig(c),h.childLanes=Dg(s,k,c),l.memoizedState=Rg,gf(null,h)):(il(l),Og(l,z))}var se=s.memoizedState;if(se!==null&&(z=se.dehydrated,z!==null)){if(_)l.flags&256?(il(l),l.flags&=-257,l=Fg(s,l,c)):l.memoizedState!==null?(ll(),l.child=s.child,l.flags|=128,l=null):(ll(),z=h.fallback,v=l.mode,h=ed({mode:"visible",children:h.children},v),z=_o(z,v,c,null),z.flags|=2,h.return=l,z.return=l,h.sibling=z,l.child=h,ko(l,s.child,null,c),h=l.child,h.memoizedState=Ig(c),h.childLanes=Dg(s,k,c),l.memoizedState=Rg,l=gf(null,h));else if(il(l),m1(z)){if(k=z.nextSibling&&z.nextSibling.dataset,k)var pe=k.dgst;k=pe,h=Error(n(419)),h.stack="",h.digest=k,nf({value:h,source:null,stack:null}),l=Fg(s,l,c)}else if(Qr||Rc(s,l,c,!1),k=(c&s.childLanes)!==0,Qr||k){if(k=hr,k!==null&&(h=io(k,c),h!==0&&h!==se.retryLane))throw se.retryLane=h,yo(s,h),la(k,s,h),Cg;d1(z)||cd(),l=Fg(s,l,c)}else d1(z)?(l.flags|=192,l.child=s.child,l=null):(s=se.treeContext,xr=qa(z.nextSibling),yn=l,jt=!0,el=null,Ha=!1,s!==null&&A_(l,s),l=Og(l,h.children),l.flags|=4096);return l}return v?(ll(),z=h.fallback,v=l.mode,se=s.child,pe=se.sibling,h=oi(se,{mode:"hidden",children:h.children}),h.subtreeFlags=se.subtreeFlags&65011712,pe!==null?z=oi(pe,z):(z=_o(z,v,c,null),z.flags|=2),z.return=l,h.return=l,h.sibling=z,l.child=h,gf(null,h),h=l.child,z=s.child.memoizedState,z===null?z=Ig(c):(v=z.cachePool,v!==null?(se=$r._currentValue,v=v.parent!==se?{parent:se,pool:se}:v):v=D_(),z={baseLanes:z.baseLanes|c,cachePool:v}),h.memoizedState=z,h.childLanes=Dg(s,k,c),l.memoizedState=Rg,gf(s.child,h)):(il(l),c=s.child,s=c.sibling,c=oi(c,{mode:"visible",children:h.children}),c.return=l,c.sibling=null,s!==null&&(k=l.deletions,k===null?(l.deletions=[s],l.flags|=16):k.push(s)),l.child=c,l.memoizedState=null,c)}function Og(s,l){return l=ed({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function ed(s,l){return s=_a(22,s,null,l),s.lanes=0,s}function Fg(s,l,c){return ko(l,s.child,null,c),s=Og(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function q2(s,l,c){s.lanes|=l;var h=s.alternate;h!==null&&(h.lanes|=l),$p(s.return,l,c)}function Mg(s,l,c,h,v,_){var k=s.memoizedState;k===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:v,treeForkCount:_}:(k.isBackwards=l,k.rendering=null,k.renderingStartTime=0,k.last=h,k.tail=c,k.tailMode=v,k.treeForkCount=_)}function W2(s,l,c){var h=l.pendingProps,v=h.revealOrder,_=h.tail;h=h.children;var k=Ur.current,z=(k&2)!==0;if(z?(k=k&1|2,l.flags|=128):k&=1,X(Ur,k),wn(s,l,h,c),h=jt?rf:0,!z&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&q2(s,c,l);else if(s.tag===19)q2(s,c,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(c=l.child,v=null;c!==null;)s=c.alternate,s!==null&&zh(s)===null&&(v=c),c=c.sibling;c=v,c===null?(v=l.child,l.child=null):(v=c.sibling,c.sibling=null),Mg(l,!1,v,c,_,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,v=l.child,l.child=null;v!==null;){if(s=v.alternate,s!==null&&zh(s)===null){l.child=v;break}s=v.sibling,v.sibling=c,c=v,v=s}Mg(l,!0,c,null,_,h);break;case"together":Mg(l,!1,null,null,void 0,h);break;default:l.memoizedState=null}return l.child}function mi(s,l,c){if(s!==null&&(l.dependencies=s.dependencies),ul|=l.lanes,(c&l.childLanes)===0)if(s!==null){if(Rc(s,l,c,!1),(c&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(n(153));if(l.child!==null){for(s=l.child,c=oi(s,s.pendingProps),l.child=c,c.return=l;s.sibling!==null;)s=s.sibling,c=c.sibling=oi(s,s.pendingProps),c.return=l;c.sibling=null}return l.child}function Pg(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Fh(s)))}function z3(s,l,c){switch(l.tag){case 3:Re(l,l.stateNode.containerInfo),rl(l,$r,s.memoizedState.cache),wo();break;case 27:case 5:Fe(l);break;case 4:Re(l,l.stateNode.containerInfo);break;case 10:rl(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,lg(l),null;break;case 13:var h=l.memoizedState;if(h!==null)return h.dehydrated!==null?(il(l),l.flags|=128,null):(c&l.child.childLanes)!==0?G2(s,l,c):(il(l),s=mi(s,l,c),s!==null?s.sibling:null);il(l);break;case 19:var v=(s.flags&128)!==0;if(h=(c&l.childLanes)!==0,h||(Rc(s,l,c,!1),h=(c&l.childLanes)!==0),v){if(h)return W2(s,l,c);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),X(Ur,Ur.current),h)break;return null;case 22:return l.lanes=0,L2(s,l,c,l.pendingProps);case 24:rl(l,$r,s.memoizedState.cache)}return mi(s,l,c)}function X2(s,l,c){if(s!==null)if(s.memoizedProps!==l.pendingProps)Qr=!0;else{if(!Pg(s,c)&&(l.flags&128)===0)return Qr=!1,z3(s,l,c);Qr=(s.flags&131072)!==0}else Qr=!1,jt&&(l.flags&1048576)!==0&&S_(l,rf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var h=l.pendingProps;if(s=So(l.elementType),l.type=s,typeof s=="function")Up(s)?(h=No(s,h),l.tag=1,l=z2(null,l,s,h,c)):(l.tag=0,l=Ng(null,l,s,h,c));else{if(s!=null){var v=s.$$typeof;if(v===W){l.tag=11,l=M2(null,l,s,h,c);break e}else if(v===A){l.tag=14,l=P2(null,l,s,h,c);break e}}throw l=Ee(s)||s,Error(n(306,l,""))}}return l;case 0:return Ng(s,l,l.type,l.pendingProps,c);case 1:return h=l.type,v=No(h,l.pendingProps),z2(s,l,h,v,c);case 3:e:{if(Re(l,l.stateNode.containerInfo),s===null)throw Error(n(387));h=l.pendingProps;var _=l.memoizedState;v=_.element,rg(s,l),ff(l,h,null,c);var k=l.memoizedState;if(h=k.cache,rl(l,$r,h),h!==_.cache&&Kp(l,[$r],c,!0),uf(),h=k.element,_.isDehydrated)if(_={element:h,isDehydrated:!1,cache:k.cache},l.updateQueue.baseState=_,l.memoizedState=_,l.flags&256){l=H2(s,l,h,c);break e}else if(h!==v){v=Va(Error(n(424)),l),nf(v),l=H2(s,l,h,c);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(xr=qa(s.firstChild),yn=l,jt=!0,el=null,Ha=!0,c=L_(l,null,h,c),l.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(wo(),h===v){l=mi(s,l,c);break e}wn(s,l,h,c)}l=l.child}return l;case 26:return Zh(s,l),s===null?(c=ab(l.type,null,l.pendingProps,null))?l.memoizedState=c:jt||(c=l.type,s=l.pendingProps,h=gd(ue.current).createElement(c),h[q]=l,h[K]=s,bn(h,c,s),Ze(h),l.stateNode=h):l.memoizedState=ab(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Fe(l),s===null&&jt&&(h=l.stateNode=tb(l.type,l.pendingProps,ue.current),yn=l,Ha=!0,v=xr,pl(l.type)?(p1=v,xr=qa(h.firstChild)):xr=v),wn(s,l,l.pendingProps.children,c),Zh(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&jt&&((v=h=xr)&&(h=v6(h,l.type,l.pendingProps,Ha),h!==null?(l.stateNode=h,yn=l,xr=qa(h.firstChild),Ha=!1,v=!0):v=!1),v||tl(l)),Fe(l),v=l.type,_=l.pendingProps,k=s!==null?s.memoizedProps:null,h=_.children,u1(v,_)?h=null:k!==null&&u1(v,k)&&(l.flags|=32),l.memoizedState!==null&&(v=cg(s,l,O3,null,null,c),If._currentValue=v),Zh(s,l),wn(s,l,h,c),l.child;case 6:return s===null&&jt&&((s=c=xr)&&(c=y6(c,l.pendingProps,Ha),c!==null?(l.stateNode=c,yn=l,xr=null,s=!0):s=!1),s||tl(l)),null;case 13:return G2(s,l,c);case 4:return Re(l,l.stateNode.containerInfo),h=l.pendingProps,s===null?l.child=ko(l,null,h,c):wn(s,l,h,c),l.child;case 11:return M2(s,l,l.type,l.pendingProps,c);case 7:return wn(s,l,l.pendingProps,c),l.child;case 8:return wn(s,l,l.pendingProps.children,c),l.child;case 12:return wn(s,l,l.pendingProps.children,c),l.child;case 10:return h=l.pendingProps,rl(l,l.type,h.value),wn(s,l,h.children,c),l.child;case 9:return v=l.type._context,h=l.pendingProps.children,Eo(l),v=_n(v),h=h(v),l.flags|=1,wn(s,l,h,c),l.child;case 14:return P2(s,l,l.type,l.pendingProps,c);case 15:return j2(s,l,l.type,l.pendingProps,c);case 19:return W2(s,l,c);case 31:return U3(s,l,c);case 22:return L2(s,l,c,l.pendingProps);case 24:return Eo(l),h=_n($r),s===null?(v=Zp(),v===null&&(v=hr,_=Qp(),v.pooledCache=_,_.refCount++,_!==null&&(v.pooledCacheLanes|=c),v=_),l.memoizedState={parent:h,cache:v},tg(l),rl(l,$r,v)):((s.lanes&c)!==0&&(rg(s,l),ff(l,null,null,c),uf()),v=s.memoizedState,_=l.memoizedState,v.parent!==h?(v={parent:h,cache:h},l.memoizedState=v,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=v),rl(l,$r,h)):(h=_.cache,rl(l,$r,h),h!==v.cache&&Kp(l,[$r],c,!0))),wn(s,l,l.pendingProps.children,c),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function pi(s){s.flags|=4}function jg(s,l,c,h,v){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(_w())s.flags|=8192;else throw Ao=Lh,eg}else s.flags&=-16777217}function Y2(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!cb(l))if(_w())s.flags|=8192;else throw Ao=Lh,eg}function td(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?dc():536870912,s.lanes|=l,zc|=l)}function xf(s,l){if(!jt)switch(s.tailMode){case"hidden":l=s.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function vr(s){var l=s.alternate!==null&&s.alternate.child===s.child,c=0,h=0;if(l)for(var v=s.child;v!==null;)c|=v.lanes|v.childLanes,h|=v.subtreeFlags&65011712,h|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)c|=v.lanes|v.childLanes,h|=v.subtreeFlags,h|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=h,s.childLanes=c,l}function H3(s,l,c){var h=l.pendingProps;switch(qp(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return vr(l),null;case 1:return vr(l),null;case 3:return c=l.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),l.memoizedState.cache!==h&&(l.flags|=2048),fi($r),Ce(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(Nc(l)?pi(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Xp())),vr(l),null;case 26:var v=l.type,_=l.memoizedState;return s===null?(pi(l),_!==null?(vr(l),Y2(l,_)):(vr(l),jg(l,v,null,h,c))):_?_!==s.memoizedState?(pi(l),vr(l),Y2(l,_)):(vr(l),l.flags&=-16777217):(s=s.memoizedProps,s!==h&&pi(l),vr(l),jg(l,v,s,h,c)),null;case 27:if(st(l),c=ue.current,v=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==h&&pi(l);else{if(!h){if(l.stateNode===null)throw Error(n(166));return vr(l),null}s=J.current,Nc(l)?k_(l):(s=tb(v,h,c),l.stateNode=s,pi(l))}return vr(l),null;case 5:if(st(l),v=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==h&&pi(l);else{if(!h){if(l.stateNode===null)throw Error(n(166));return vr(l),null}if(_=J.current,Nc(l))k_(l);else{var k=gd(ue.current);switch(_){case 1:_=k.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:_=k.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":_=k.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":_=k.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":_=k.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof h.is=="string"?k.createElement("select",{is:h.is}):k.createElement("select"),h.multiple?_.multiple=!0:h.size&&(_.size=h.size);break;default:_=typeof h.is=="string"?k.createElement(v,{is:h.is}):k.createElement(v)}}_[q]=l,_[K]=h;e:for(k=l.child;k!==null;){if(k.tag===5||k.tag===6)_.appendChild(k.stateNode);else if(k.tag!==4&&k.tag!==27&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===l)break e;for(;k.sibling===null;){if(k.return===null||k.return===l)break e;k=k.return}k.sibling.return=k.return,k=k.sibling}l.stateNode=_;e:switch(bn(_,v,h),v){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&pi(l)}}return vr(l),jg(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,c),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==h&&pi(l);else{if(typeof h!="string"&&l.stateNode===null)throw Error(n(166));if(s=ue.current,Nc(l)){if(s=l.stateNode,c=l.memoizedProps,h=null,v=yn,v!==null)switch(v.tag){case 27:case 5:h=v.memoizedProps}s[q]=l,s=!!(s.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||Gw(s.nodeValue,c)),s||tl(l,!0)}else s=gd(s).createTextNode(h),s[q]=l,l.stateNode=s}return vr(l),null;case 31:if(c=l.memoizedState,s===null||s.memoizedState!==null){if(h=Nc(l),c!==null){if(s===null){if(!h)throw Error(n(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[q]=l}else wo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;vr(l),s=!1}else c=Xp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return l.flags&256?(ba(l),l):(ba(l),null);if((l.flags&128)!==0)throw Error(n(558))}return vr(l),null;case 13:if(h=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=Nc(l),h!==null&&h.dehydrated!==null){if(s===null){if(!v)throw Error(n(318));if(v=l.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[q]=l}else wo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;vr(l),v=!1}else v=Xp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return l.flags&256?(ba(l),l):(ba(l),null)}return ba(l),(l.flags&128)!==0?(l.lanes=c,l):(c=h!==null,s=s!==null&&s.memoizedState!==null,c&&(h=l.child,v=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(v=h.alternate.memoizedState.cachePool.pool),_=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(_=h.memoizedState.cachePool.pool),_!==v&&(h.flags|=2048)),c!==s&&c&&(l.child.flags|=8192),td(l,l.updateQueue),vr(l),null);case 4:return Ce(),s===null&&s1(l.stateNode.containerInfo),vr(l),null;case 10:return fi(l.type),vr(l),null;case 19:if(j(Ur),h=l.memoizedState,h===null)return vr(l),null;if(v=(l.flags&128)!==0,_=h.rendering,_===null)if(v)xf(h,!1);else{if(Mr!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(_=zh(s),_!==null){for(l.flags|=128,xf(h,!1),s=_.updateQueue,l.updateQueue=s,td(l,s),l.subtreeFlags=0,s=c,c=l.child;c!==null;)b_(c,s),c=c.sibling;return X(Ur,Ur.current&1|2),jt&&ci(l,h.treeForkCount),l.child}s=s.sibling}h.tail!==null&&Bt()>id&&(l.flags|=128,v=!0,xf(h,!1),l.lanes=4194304)}else{if(!v)if(s=zh(_),s!==null){if(l.flags|=128,v=!0,s=s.updateQueue,l.updateQueue=s,td(l,s),xf(h,!0),h.tail===null&&h.tailMode==="hidden"&&!_.alternate&&!jt)return vr(l),null}else 2*Bt()-h.renderingStartTime>id&&c!==536870912&&(l.flags|=128,v=!0,xf(h,!1),l.lanes=4194304);h.isBackwards?(_.sibling=l.child,l.child=_):(s=h.last,s!==null?s.sibling=_:l.child=_,h.last=_)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=Bt(),s.sibling=null,c=Ur.current,X(Ur,v?c&1|2:c&1),jt&&ci(l,h.treeForkCount),s):(vr(l),null);case 22:case 23:return ba(l),ig(),h=l.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(l.flags|=8192):h&&(l.flags|=8192),h?(c&536870912)!==0&&(l.flags&128)===0&&(vr(l),l.subtreeFlags&6&&(l.flags|=8192)):vr(l),c=l.updateQueue,c!==null&&td(l,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),h=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(h=l.memoizedState.cachePool.pool),h!==c&&(l.flags|=2048),s!==null&&j(To),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),l.memoizedState.cache!==c&&(l.flags|=2048),fi($r),vr(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function G3(s,l){switch(qp(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return fi($r),Ce(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return st(l),null;case 31:if(l.memoizedState!==null){if(ba(l),l.alternate===null)throw Error(n(340));wo()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(ba(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(n(340));wo()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return j(Ur),null;case 4:return Ce(),null;case 10:return fi(l.type),null;case 22:case 23:return ba(l),ig(),s!==null&&j(To),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return fi($r),null;case 25:return null;default:return null}}function $2(s,l){switch(qp(l),l.tag){case 3:fi($r),Ce();break;case 26:case 27:case 5:st(l);break;case 4:Ce();break;case 31:l.memoizedState!==null&&ba(l);break;case 13:ba(l);break;case 19:j(Ur);break;case 10:fi(l.type);break;case 22:case 23:ba(l),ig(),s!==null&&j(To);break;case 24:fi($r)}}function vf(s,l){try{var c=l.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var v=h.next;c=v;do{if((c.tag&s)===s){h=void 0;var _=c.create,k=c.inst;h=_(),k.destroy=h}c=c.next}while(c!==v)}}catch(z){tr(l,l.return,z)}}function ol(s,l,c){try{var h=l.updateQueue,v=h!==null?h.lastEffect:null;if(v!==null){var _=v.next;h=_;do{if((h.tag&s)===s){var k=h.inst,z=k.destroy;if(z!==void 0){k.destroy=void 0,v=l;var se=c,pe=z;try{pe()}catch(ke){tr(v,se,ke)}}}h=h.next}while(h!==_)}}catch(ke){tr(l,l.return,ke)}}function K2(s){var l=s.updateQueue;if(l!==null){var c=s.stateNode;try{V_(l,c)}catch(h){tr(s,s.return,h)}}}function Q2(s,l,c){c.props=No(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(h){tr(s,l,h)}}function yf(s,l){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof c=="function"?s.refCleanup=c(h):c.current=h}}catch(v){tr(s,l,v)}}function Ms(s,l){var c=s.ref,h=s.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(v){tr(s,l,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(v){tr(s,l,v)}else c.current=null}function J2(s){var l=s.type,c=s.memoizedProps,h=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(v){tr(s,s.return,v)}}function Lg(s,l,c){try{var h=s.stateNode;h6(h,s.type,c,l),h[K]=l}catch(v){tr(s,s.return,v)}}function Z2(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&pl(s.type)||s.tag===4}function Bg(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Z2(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&pl(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vg(s,l,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,l?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,l):(l=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,l.appendChild(s),c=c._reactRootContainer,c!=null||l.onclick!==null||(l.onclick=cs));else if(h!==4&&(h===27&&pl(s.type)&&(c=s.stateNode,l=null),s=s.child,s!==null))for(Vg(s,l,c),s=s.sibling;s!==null;)Vg(s,l,c),s=s.sibling}function rd(s,l,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,l?c.insertBefore(s,l):c.appendChild(s);else if(h!==4&&(h===27&&pl(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(rd(s,l,c),s=s.sibling;s!==null;)rd(s,l,c),s=s.sibling}function ew(s){var l=s.stateNode,c=s.memoizedProps;try{for(var h=s.type,v=l.attributes;v.length;)l.removeAttributeNode(v[0]);bn(l,h,c),l[q]=s,l[K]=c}catch(_){tr(s,s.return,_)}}var gi=!1,Jr=!1,Ug=!1,tw=typeof WeakSet=="function"?WeakSet:Set,dn=null;function q3(s,l){if(s=s.containerInfo,o1=Ed,s=d_(s),Fp(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var v=h.anchorOffset,_=h.focusNode;h=h.focusOffset;try{c.nodeType,_.nodeType}catch{c=null;break e}var k=0,z=-1,se=-1,pe=0,ke=0,De=s,ve=null;t:for(;;){for(var be;De!==c||v!==0&&De.nodeType!==3||(z=k+v),De!==_||h!==0&&De.nodeType!==3||(se=k+h),De.nodeType===3&&(k+=De.nodeValue.length),(be=De.firstChild)!==null;)ve=De,De=be;for(;;){if(De===s)break t;if(ve===c&&++pe===v&&(z=k),ve===_&&++ke===h&&(se=k),(be=De.nextSibling)!==null)break;De=ve,ve=De.parentNode}De=be}c=z===-1||se===-1?null:{start:z,end:se}}else c=null}c=c||{start:0,end:0}}else c=null;for(c1={focusedElem:s,selectionRange:c},Ed=!1,dn=l;dn!==null;)if(l=dn,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,dn=s;else for(;dn!==null;){switch(l=dn,_=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)v=s[c],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,c=l,v=_.memoizedProps,_=_.memoizedState,h=c.stateNode;try{var Je=No(c.type,v);s=h.getSnapshotBeforeUpdate(Je,_),h.__reactInternalSnapshotBeforeUpdate=s}catch(it){tr(c,c.return,it)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,c=s.nodeType,c===9)h1(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":h1(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=l.sibling,s!==null){s.return=l.return,dn=s;break}dn=l.return}}function rw(s,l,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:vi(s,c),h&4&&vf(5,c);break;case 1:if(vi(s,c),h&4)if(s=c.stateNode,l===null)try{s.componentDidMount()}catch(k){tr(c,c.return,k)}else{var v=No(c.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(v,l,s.__reactInternalSnapshotBeforeUpdate)}catch(k){tr(c,c.return,k)}}h&64&&K2(c),h&512&&yf(c,c.return);break;case 3:if(vi(s,c),h&64&&(s=c.updateQueue,s!==null)){if(l=null,c.child!==null)switch(c.child.tag){case 27:case 5:l=c.child.stateNode;break;case 1:l=c.child.stateNode}try{V_(s,l)}catch(k){tr(c,c.return,k)}}break;case 27:l===null&&h&4&&ew(c);case 26:case 5:vi(s,c),l===null&&h&4&&J2(c),h&512&&yf(c,c.return);break;case 12:vi(s,c);break;case 31:vi(s,c),h&4&&sw(s,c);break;case 13:vi(s,c),h&4&&iw(s,c),h&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=e6.bind(null,c),_6(s,c))));break;case 22:if(h=c.memoizedState!==null||gi,!h){l=l!==null&&l.memoizedState!==null||Jr,v=gi;var _=Jr;gi=h,(Jr=l)&&!_?yi(s,c,(c.subtreeFlags&8772)!==0):vi(s,c),gi=v,Jr=_}break;case 30:break;default:vi(s,c)}}function nw(s){var l=s.alternate;l!==null&&(s.alternate=null,nw(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Le(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Sr=null,na=!1;function xi(s,l,c){for(c=c.child;c!==null;)aw(s,l,c),c=c.sibling}function aw(s,l,c){if(Yt&&typeof Yt.onCommitFiberUnmount=="function")try{Yt.onCommitFiberUnmount(Tt,c)}catch{}switch(c.tag){case 26:Jr||Ms(c,l),xi(s,l,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Jr||Ms(c,l);var h=Sr,v=na;pl(c.type)&&(Sr=c.stateNode,na=!1),xi(s,l,c),Cf(c.stateNode),Sr=h,na=v;break;case 5:Jr||Ms(c,l);case 6:if(h=Sr,v=na,Sr=null,xi(s,l,c),Sr=h,na=v,Sr!==null)if(na)try{(Sr.nodeType===9?Sr.body:Sr.nodeName==="HTML"?Sr.ownerDocument.body:Sr).removeChild(c.stateNode)}catch(_){tr(c,l,_)}else try{Sr.removeChild(c.stateNode)}catch(_){tr(c,l,_)}break;case 18:Sr!==null&&(na?(s=Sr,Kw(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Kc(s)):Kw(Sr,c.stateNode));break;case 4:h=Sr,v=na,Sr=c.stateNode.containerInfo,na=!0,xi(s,l,c),Sr=h,na=v;break;case 0:case 11:case 14:case 15:ol(2,c,l),Jr||ol(4,c,l),xi(s,l,c);break;case 1:Jr||(Ms(c,l),h=c.stateNode,typeof h.componentWillUnmount=="function"&&Q2(c,l,h)),xi(s,l,c);break;case 21:xi(s,l,c);break;case 22:Jr=(h=Jr)||c.memoizedState!==null,xi(s,l,c),Jr=h;break;default:xi(s,l,c)}}function sw(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Kc(s)}catch(c){tr(l,l.return,c)}}}function iw(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Kc(s)}catch(c){tr(l,l.return,c)}}function W3(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new tw),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new tw),l;default:throw Error(n(435,s.tag))}}function nd(s,l){var c=W3(s);l.forEach(function(h){if(!c.has(h)){c.add(h);var v=t6.bind(null,s,h);h.then(v,v)}})}function aa(s,l){var c=l.deletions;if(c!==null)for(var h=0;h<c.length;h++){var v=c[h],_=s,k=l,z=k;e:for(;z!==null;){switch(z.tag){case 27:if(pl(z.type)){Sr=z.stateNode,na=!1;break e}break;case 5:Sr=z.stateNode,na=!1;break e;case 3:case 4:Sr=z.stateNode.containerInfo,na=!0;break e}z=z.return}if(Sr===null)throw Error(n(160));aw(_,k,v),Sr=null,na=!1,_=v.alternate,_!==null&&(_.return=null),v.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)lw(l,s),l=l.sibling}var ps=null;function lw(s,l){var c=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:aa(l,s),sa(s),h&4&&(ol(3,s,s.return),vf(3,s),ol(5,s,s.return));break;case 1:aa(l,s),sa(s),h&512&&(Jr||c===null||Ms(c,c.return)),h&64&&gi&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var v=ps;if(aa(l,s),sa(s),h&512&&(Jr||c===null||Ms(c,c.return)),h&4){var _=c!==null?c.memoizedState:null;if(h=s.memoizedState,c===null)if(h===null)if(s.stateNode===null){e:{h=s.type,c=s.memoizedProps,v=v.ownerDocument||v;t:switch(h){case"title":_=v.getElementsByTagName("title")[0],(!_||_[ge]||_[q]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=v.createElement(h),v.head.insertBefore(_,v.querySelector("head > title"))),bn(_,h,c),_[q]=s,Ze(_),h=_;break e;case"link":var k=lb("link","href",v).get(h+(c.href||""));if(k){for(var z=0;z<k.length;z++)if(_=k[z],_.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&_.getAttribute("rel")===(c.rel==null?null:c.rel)&&_.getAttribute("title")===(c.title==null?null:c.title)&&_.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){k.splice(z,1);break t}}_=v.createElement(h),bn(_,h,c),v.head.appendChild(_);break;case"meta":if(k=lb("meta","content",v).get(h+(c.content||""))){for(z=0;z<k.length;z++)if(_=k[z],_.getAttribute("content")===(c.content==null?null:""+c.content)&&_.getAttribute("name")===(c.name==null?null:c.name)&&_.getAttribute("property")===(c.property==null?null:c.property)&&_.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&_.getAttribute("charset")===(c.charSet==null?null:c.charSet)){k.splice(z,1);break t}}_=v.createElement(h),bn(_,h,c),v.head.appendChild(_);break;default:throw Error(n(468,h))}_[q]=s,Ze(_),h=_}s.stateNode=h}else ob(v,s.type,s.stateNode);else s.stateNode=ib(v,h,s.memoizedProps);else _!==h?(_===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):_.count--,h===null?ob(v,s.type,s.stateNode):ib(v,h,s.memoizedProps)):h===null&&s.stateNode!==null&&Lg(s,s.memoizedProps,c.memoizedProps)}break;case 27:aa(l,s),sa(s),h&512&&(Jr||c===null||Ms(c,c.return)),c!==null&&h&4&&Lg(s,s.memoizedProps,c.memoizedProps);break;case 5:if(aa(l,s),sa(s),h&512&&(Jr||c===null||Ms(c,c.return)),s.flags&32){v=s.stateNode;try{ra(v,"")}catch(Je){tr(s,s.return,Je)}}h&4&&s.stateNode!=null&&(v=s.memoizedProps,Lg(s,v,c!==null?c.memoizedProps:v)),h&1024&&(Ug=!0);break;case 6:if(aa(l,s),sa(s),h&4){if(s.stateNode===null)throw Error(n(162));h=s.memoizedProps,c=s.stateNode;try{c.nodeValue=h}catch(Je){tr(s,s.return,Je)}}break;case 3:if(yd=null,v=ps,ps=xd(l.containerInfo),aa(l,s),ps=v,sa(s),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Kc(l.containerInfo)}catch(Je){tr(s,s.return,Je)}Ug&&(Ug=!1,ow(s));break;case 4:h=ps,ps=xd(s.stateNode.containerInfo),aa(l,s),sa(s),ps=h;break;case 12:aa(l,s),sa(s);break;case 31:aa(l,s),sa(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,nd(s,h)));break;case 13:aa(l,s),sa(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(sd=Bt()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,nd(s,h)));break;case 22:v=s.memoizedState!==null;var se=c!==null&&c.memoizedState!==null,pe=gi,ke=Jr;if(gi=pe||v,Jr=ke||se,aa(l,s),Jr=ke,gi=pe,sa(s),h&8192)e:for(l=s.stateNode,l._visibility=v?l._visibility&-2:l._visibility|1,v&&(c===null||se||gi||Jr||Ro(s)),c=null,l=s;;){if(l.tag===5||l.tag===26){if(c===null){se=c=l;try{if(_=se.stateNode,v)k=_.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{z=se.stateNode;var De=se.memoizedProps.style,ve=De!=null&&De.hasOwnProperty("display")?De.display:null;z.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(Je){tr(se,se.return,Je)}}}else if(l.tag===6){if(c===null){se=l;try{se.stateNode.nodeValue=v?"":se.memoizedProps}catch(Je){tr(se,se.return,Je)}}}else if(l.tag===18){if(c===null){se=l;try{var be=se.stateNode;v?Qw(be,!0):Qw(se.stateNode,!1)}catch(Je){tr(se,se.return,Je)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;c===l&&(c=null),l=l.return}c===l&&(c=null),l.sibling.return=l.return,l=l.sibling}h&4&&(h=s.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,nd(s,c))));break;case 19:aa(l,s),sa(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,nd(s,h)));break;case 30:break;case 21:break;default:aa(l,s),sa(s)}}function sa(s){var l=s.flags;if(l&2){try{for(var c,h=s.return;h!==null;){if(Z2(h)){c=h;break}h=h.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var v=c.stateNode,_=Bg(s);rd(s,_,v);break;case 5:var k=c.stateNode;c.flags&32&&(ra(k,""),c.flags&=-33);var z=Bg(s);rd(s,z,k);break;case 3:case 4:var se=c.stateNode.containerInfo,pe=Bg(s);Vg(s,pe,se);break;default:throw Error(n(161))}}catch(ke){tr(s,s.return,ke)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function ow(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;ow(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function vi(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)rw(s,l.alternate,l),l=l.sibling}function Ro(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:ol(4,l,l.return),Ro(l);break;case 1:Ms(l,l.return);var c=l.stateNode;typeof c.componentWillUnmount=="function"&&Q2(l,l.return,c),Ro(l);break;case 27:Cf(l.stateNode);case 26:case 5:Ms(l,l.return),Ro(l);break;case 22:l.memoizedState===null&&Ro(l);break;case 30:Ro(l);break;default:Ro(l)}s=s.sibling}}function yi(s,l,c){for(c=c&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var h=l.alternate,v=s,_=l,k=_.flags;switch(_.tag){case 0:case 11:case 15:yi(v,_,c),vf(4,_);break;case 1:if(yi(v,_,c),h=_,v=h.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(pe){tr(h,h.return,pe)}if(h=_,v=h.updateQueue,v!==null){var z=h.stateNode;try{var se=v.shared.hiddenCallbacks;if(se!==null)for(v.shared.hiddenCallbacks=null,v=0;v<se.length;v++)B_(se[v],z)}catch(pe){tr(h,h.return,pe)}}c&&k&64&&K2(_),yf(_,_.return);break;case 27:ew(_);case 26:case 5:yi(v,_,c),c&&h===null&&k&4&&J2(_),yf(_,_.return);break;case 12:yi(v,_,c);break;case 31:yi(v,_,c),c&&k&4&&sw(v,_);break;case 13:yi(v,_,c),c&&k&4&&iw(v,_);break;case 22:_.memoizedState===null&&yi(v,_,c),yf(_,_.return);break;case 30:break;default:yi(v,_,c)}l=l.sibling}}function zg(s,l){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&af(c))}function Hg(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&af(s))}function gs(s,l,c,h){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)cw(s,l,c,h),l=l.sibling}function cw(s,l,c,h){var v=l.flags;switch(l.tag){case 0:case 11:case 15:gs(s,l,c,h),v&2048&&vf(9,l);break;case 1:gs(s,l,c,h);break;case 3:gs(s,l,c,h),v&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&af(s)));break;case 12:if(v&2048){gs(s,l,c,h),s=l.stateNode;try{var _=l.memoizedProps,k=_.id,z=_.onPostCommit;typeof z=="function"&&z(k,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(se){tr(l,l.return,se)}}else gs(s,l,c,h);break;case 31:gs(s,l,c,h);break;case 13:gs(s,l,c,h);break;case 23:break;case 22:_=l.stateNode,k=l.alternate,l.memoizedState!==null?_._visibility&2?gs(s,l,c,h):_f(s,l):_._visibility&2?gs(s,l,c,h):(_._visibility|=2,Bc(s,l,c,h,(l.subtreeFlags&10256)!==0||!1)),v&2048&&zg(k,l);break;case 24:gs(s,l,c,h),v&2048&&Hg(l.alternate,l);break;default:gs(s,l,c,h)}}function Bc(s,l,c,h,v){for(v=v&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var _=s,k=l,z=c,se=h,pe=k.flags;switch(k.tag){case 0:case 11:case 15:Bc(_,k,z,se,v),vf(8,k);break;case 23:break;case 22:var ke=k.stateNode;k.memoizedState!==null?ke._visibility&2?Bc(_,k,z,se,v):_f(_,k):(ke._visibility|=2,Bc(_,k,z,se,v)),v&&pe&2048&&zg(k.alternate,k);break;case 24:Bc(_,k,z,se,v),v&&pe&2048&&Hg(k.alternate,k);break;default:Bc(_,k,z,se,v)}l=l.sibling}}function _f(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var c=s,h=l,v=h.flags;switch(h.tag){case 22:_f(c,h),v&2048&&zg(h.alternate,h);break;case 24:_f(c,h),v&2048&&Hg(h.alternate,h);break;default:_f(c,h)}l=l.sibling}}var wf=8192;function Vc(s,l,c){if(s.subtreeFlags&wf)for(s=s.child;s!==null;)uw(s,l,c),s=s.sibling}function uw(s,l,c){switch(s.tag){case 26:Vc(s,l,c),s.flags&wf&&s.memoizedState!==null&&D6(c,ps,s.memoizedState,s.memoizedProps);break;case 5:Vc(s,l,c);break;case 3:case 4:var h=ps;ps=xd(s.stateNode.containerInfo),Vc(s,l,c),ps=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=wf,wf=16777216,Vc(s,l,c),wf=h):Vc(s,l,c));break;default:Vc(s,l,c)}}function fw(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function bf(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var h=l[c];dn=h,dw(h,s)}fw(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)hw(s),s=s.sibling}function hw(s){switch(s.tag){case 0:case 11:case 15:bf(s),s.flags&2048&&ol(9,s,s.return);break;case 3:bf(s);break;case 12:bf(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,ad(s)):bf(s);break;default:bf(s)}}function ad(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var h=l[c];dn=h,dw(h,s)}fw(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:ol(8,l,l.return),ad(l);break;case 22:c=l.stateNode,c._visibility&2&&(c._visibility&=-3,ad(l));break;default:ad(l)}s=s.sibling}}function dw(s,l){for(;dn!==null;){var c=dn;switch(c.tag){case 0:case 11:case 15:ol(8,c,l);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:af(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,dn=h;else e:for(c=s;dn!==null;){h=dn;var v=h.sibling,_=h.return;if(nw(h),h===c){dn=null;break e}if(v!==null){v.return=_,dn=v;break e}dn=_}}}var X3={getCacheForType:function(s){var l=_n($r),c=l.data.get(s);return c===void 0&&(c=s(),l.data.set(s,c)),c},cacheSignal:function(){return _n($r).controller.signal}},Y3=typeof WeakMap=="function"?WeakMap:Map,Xt=0,hr=null,Nt=null,Dt=0,er=0,Ea=null,cl=!1,Uc=!1,Gg=!1,_i=0,Mr=0,ul=0,Io=0,qg=0,Ta=0,zc=0,Ef=null,ia=null,Wg=!1,sd=0,mw=0,id=1/0,ld=null,fl=null,ln=0,hl=null,Hc=null,wi=0,Xg=0,Yg=null,pw=null,Tf=0,$g=null;function Sa(){return(Xt&2)!==0&&Dt!==0?Dt&-Dt:ie.T!==null?t1():L()}function gw(){if(Ta===0)if((Dt&536870912)===0||jt){var s=Fa;Fa<<=1,(Fa&3932160)===0&&(Fa=262144),Ta=s}else Ta=536870912;return s=wa.current,s!==null&&(s.flags|=32),Ta}function la(s,l,c){(s===hr&&(er===2||er===9)||s.cancelPendingCommit!==null)&&(Gc(s,0),dl(s,Dt,Ta,!1)),ti(s,c),((Xt&2)===0||s!==hr)&&(s===hr&&((Xt&2)===0&&(Io|=c),Mr===4&&dl(s,Dt,Ta,!1)),Ps(s))}function xw(s,l,c){if((Xt&6)!==0)throw Error(n(327));var h=!c&&(l&127)===0&&(l&s.expiredLanes)===0||Xn(s,l),v=h?Q3(s,l):Qg(s,l,!0),_=h;do{if(v===0){Uc&&!h&&dl(s,l,0,!1);break}else{if(c=s.current.alternate,_&&!$3(c)){v=Qg(s,l,!1),_=!1;continue}if(v===2){if(_=l,s.errorRecoveryDisabledLanes&_)var k=0;else k=s.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){l=k;e:{var z=s;v=Ef;var se=z.current.memoizedState.isDehydrated;if(se&&(Gc(z,k).flags|=256),k=Qg(z,k,!1),k!==2){if(Gg&&!se){z.errorRecoveryDisabledLanes|=_,Io|=_,v=4;break e}_=ia,ia=v,_!==null&&(ia===null?ia=_:ia.push.apply(ia,_))}v=k}if(_=!1,v!==2)continue}}if(v===1){Gc(s,0),dl(s,l,0,!0);break}e:{switch(h=s,_=v,_){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:dl(h,l,Ta,!cl);break e;case 2:ia=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(v=sd+300-Bt(),10<v)){if(dl(h,l,Ta,!cl),ga(h,0,!0)!==0)break e;wi=l,h.timeoutHandle=Yw(vw.bind(null,h,c,ia,ld,Wg,l,Ta,Io,zc,cl,_,"Throttled",-0,0),v);break e}vw(h,c,ia,ld,Wg,l,Ta,Io,zc,cl,_,null,-0,0)}}break}while(!0);Ps(s)}function vw(s,l,c,h,v,_,k,z,se,pe,ke,De,ve,be){if(s.timeoutHandle=-1,De=l.subtreeFlags,De&8192||(De&16785408)===16785408){De={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:cs},uw(l,_,De);var Je=(_&62914560)===_?sd-Bt():(_&4194048)===_?mw-Bt():0;if(Je=O6(De,Je),Je!==null){wi=_,s.cancelPendingCommit=Je(Aw.bind(null,s,l,_,c,h,v,k,z,se,ke,De,null,ve,be)),dl(s,_,k,!pe);return}}Aw(s,l,_,c,h,v,k,z,se)}function $3(s){for(var l=s;;){var c=l.tag;if((c===0||c===11||c===15)&&l.flags&16384&&(c=l.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var v=c[h],_=v.getSnapshot;v=v.value;try{if(!ya(_(),v))return!1}catch{return!1}}if(c=l.child,l.subtreeFlags&16384&&c!==null)c.return=l,l=c;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function dl(s,l,c,h){l&=~qg,l&=~Io,s.suspendedLanes|=l,s.pingedLanes&=~l,h&&(s.warmLanes|=l),h=s.expirationTimes;for(var v=l;0<v;){var _=31-gr(v),k=1<<_;h[_]=-1,v&=~k}c!==0&&ri(s,c,l)}function od(){return(Xt&6)===0?(Sf(0),!1):!0}function Kg(){if(Nt!==null){if(er===0)var s=Nt.return;else s=Nt,ui=bo=null,hg(s),Fc=null,lf=0,s=Nt;for(;s!==null;)$2(s.alternate,s),s=s.return;Nt=null}}function Gc(s,l){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,p6(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),wi=0,Kg(),hr=s,Nt=c=oi(s.current,null),Dt=l,er=0,Ea=null,cl=!1,Uc=Xn(s,l),Gg=!1,zc=Ta=qg=Io=ul=Mr=0,ia=Ef=null,Wg=!1,(l&8)!==0&&(l|=l&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=l;0<h;){var v=31-gr(h),_=1<<v;l|=s[v],h&=~_}return _i=l,Nh(),c}function yw(s,l){yt=null,ie.H=pf,l===Oc||l===jh?(l=M_(),er=3):l===eg?(l=M_(),er=4):er=l===Cg?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Ea=l,Nt===null&&(Mr=1,Qh(s,Va(l,s.current)))}function _w(){var s=wa.current;return s===null?!0:(Dt&4194048)===Dt?Ga===null:(Dt&62914560)===Dt||(Dt&536870912)!==0?s===Ga:!1}function ww(){var s=ie.H;return ie.H=pf,s===null?pf:s}function bw(){var s=ie.A;return ie.A=X3,s}function cd(){Mr=4,cl||(Dt&4194048)!==Dt&&wa.current!==null||(Uc=!0),(ul&134217727)===0&&(Io&134217727)===0||hr===null||dl(hr,Dt,Ta,!1)}function Qg(s,l,c){var h=Xt;Xt|=2;var v=ww(),_=bw();(hr!==s||Dt!==l)&&(ld=null,Gc(s,l)),l=!1;var k=Mr;e:do try{if(er!==0&&Nt!==null){var z=Nt,se=Ea;switch(er){case 8:Kg(),k=6;break e;case 3:case 2:case 9:case 6:wa.current===null&&(l=!0);var pe=er;if(er=0,Ea=null,qc(s,z,se,pe),c&&Uc){k=0;break e}break;default:pe=er,er=0,Ea=null,qc(s,z,se,pe)}}K3(),k=Mr;break}catch(ke){yw(s,ke)}while(!0);return l&&s.shellSuspendCounter++,ui=bo=null,Xt=h,ie.H=v,ie.A=_,Nt===null&&(hr=null,Dt=0,Nh()),k}function K3(){for(;Nt!==null;)Ew(Nt)}function Q3(s,l){var c=Xt;Xt|=2;var h=ww(),v=bw();hr!==s||Dt!==l?(ld=null,id=Bt()+500,Gc(s,l)):Uc=Xn(s,l);e:do try{if(er!==0&&Nt!==null){l=Nt;var _=Ea;t:switch(er){case 1:er=0,Ea=null,qc(s,l,_,1);break;case 2:case 9:if(O_(_)){er=0,Ea=null,Tw(l);break}l=function(){er!==2&&er!==9||hr!==s||(er=7),Ps(s)},_.then(l,l);break e;case 3:er=7;break e;case 4:er=5;break e;case 7:O_(_)?(er=0,Ea=null,Tw(l)):(er=0,Ea=null,qc(s,l,_,7));break;case 5:var k=null;switch(Nt.tag){case 26:k=Nt.memoizedState;case 5:case 27:var z=Nt;if(k?cb(k):z.stateNode.complete){er=0,Ea=null;var se=z.sibling;if(se!==null)Nt=se;else{var pe=z.return;pe!==null?(Nt=pe,ud(pe)):Nt=null}break t}}er=0,Ea=null,qc(s,l,_,5);break;case 6:er=0,Ea=null,qc(s,l,_,6);break;case 8:Kg(),Mr=6;break e;default:throw Error(n(462))}}J3();break}catch(ke){yw(s,ke)}while(!0);return ui=bo=null,ie.H=h,ie.A=v,Xt=c,Nt!==null?0:(hr=null,Dt=0,Nh(),Mr)}function J3(){for(;Nt!==null&&!Et();)Ew(Nt)}function Ew(s){var l=X2(s.alternate,s,_i);s.memoizedProps=s.pendingProps,l===null?ud(s):Nt=l}function Tw(s){var l=s,c=l.alternate;switch(l.tag){case 15:case 0:l=U2(c,l,l.pendingProps,l.type,void 0,Dt);break;case 11:l=U2(c,l,l.pendingProps,l.type.render,l.ref,Dt);break;case 5:hg(l);default:$2(c,l),l=Nt=b_(l,_i),l=X2(c,l,_i)}s.memoizedProps=s.pendingProps,l===null?ud(s):Nt=l}function qc(s,l,c,h){ui=bo=null,hg(l),Fc=null,lf=0;var v=l.return;try{if(V3(s,v,l,c,Dt)){Mr=1,Qh(s,Va(c,s.current)),Nt=null;return}}catch(_){if(v!==null)throw Nt=v,_;Mr=1,Qh(s,Va(c,s.current)),Nt=null;return}l.flags&32768?(jt||h===1?s=!0:Uc||(Dt&536870912)!==0?s=!1:(cl=s=!0,(h===2||h===9||h===3||h===6)&&(h=wa.current,h!==null&&h.tag===13&&(h.flags|=16384))),Sw(l,s)):ud(l)}function ud(s){var l=s;do{if((l.flags&32768)!==0){Sw(l,cl);return}s=l.return;var c=H3(l.alternate,l,_i);if(c!==null){Nt=c;return}if(l=l.sibling,l!==null){Nt=l;return}Nt=l=s}while(l!==null);Mr===0&&(Mr=5)}function Sw(s,l){do{var c=G3(s.alternate,s);if(c!==null){c.flags&=32767,Nt=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!l&&(s=s.sibling,s!==null)){Nt=s;return}Nt=s=c}while(s!==null);Mr=6,Nt=null}function Aw(s,l,c,h,v,_,k,z,se){s.cancelPendingCommit=null;do fd();while(ln!==0);if((Xt&6)!==0)throw Error(n(327));if(l!==null){if(l===s.current)throw Error(n(177));if(_=l.lanes|l.childLanes,_|=Bp,Uu(s,c,_,k,z,se),s===hr&&(Nt=hr=null,Dt=0),Hc=l,hl=s,wi=c,Xg=_,Yg=v,pw=h,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,r6(dr,function(){return Iw(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||h){h=ie.T,ie.T=null,v=ee.p,ee.p=2,k=Xt,Xt|=4;try{q3(s,l,c)}finally{Xt=k,ee.p=v,ie.T=h}}ln=1,kw(),Cw(),Nw()}}function kw(){if(ln===1){ln=0;var s=hl,l=Hc,c=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||c){c=ie.T,ie.T=null;var h=ee.p;ee.p=2;var v=Xt;Xt|=4;try{lw(l,s);var _=c1,k=d_(s.containerInfo),z=_.focusedElem,se=_.selectionRange;if(k!==z&&z&&z.ownerDocument&&h_(z.ownerDocument.documentElement,z)){if(se!==null&&Fp(z)){var pe=se.start,ke=se.end;if(ke===void 0&&(ke=pe),"selectionStart"in z)z.selectionStart=pe,z.selectionEnd=Math.min(ke,z.value.length);else{var De=z.ownerDocument||document,ve=De&&De.defaultView||window;if(ve.getSelection){var be=ve.getSelection(),Je=z.textContent.length,it=Math.min(se.start,Je),cr=se.end===void 0?it:Math.min(se.end,Je);!be.extend&&it>cr&&(k=cr,cr=it,it=k);var ce=f_(z,it),oe=f_(z,cr);if(ce&&oe&&(be.rangeCount!==1||be.anchorNode!==ce.node||be.anchorOffset!==ce.offset||be.focusNode!==oe.node||be.focusOffset!==oe.offset)){var he=De.createRange();he.setStart(ce.node,ce.offset),be.removeAllRanges(),it>cr?(be.addRange(he),be.extend(oe.node,oe.offset)):(he.setEnd(oe.node,oe.offset),be.addRange(he))}}}}for(De=[],be=z;be=be.parentNode;)be.nodeType===1&&De.push({element:be,left:be.scrollLeft,top:be.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<De.length;z++){var Ne=De[z];Ne.element.scrollLeft=Ne.left,Ne.element.scrollTop=Ne.top}}Ed=!!o1,c1=o1=null}finally{Xt=v,ee.p=h,ie.T=c}}s.current=l,ln=2}}function Cw(){if(ln===2){ln=0;var s=hl,l=Hc,c=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||c){c=ie.T,ie.T=null;var h=ee.p;ee.p=2;var v=Xt;Xt|=4;try{rw(s,l.alternate,l)}finally{Xt=v,ee.p=h,ie.T=c}}ln=3}}function Nw(){if(ln===4||ln===3){ln=0,zt();var s=hl,l=Hc,c=wi,h=pw;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?ln=5:(ln=0,Hc=hl=null,Rw(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(fl=null),is(c),l=l.stateNode,Yt&&typeof Yt.onCommitFiberRoot=="function")try{Yt.onCommitFiberRoot(Tt,l,void 0,(l.current.flags&128)===128)}catch{}if(h!==null){l=ie.T,v=ee.p,ee.p=2,ie.T=null;try{for(var _=s.onRecoverableError,k=0;k<h.length;k++){var z=h[k];_(z.value,{componentStack:z.stack})}}finally{ie.T=l,ee.p=v}}(wi&3)!==0&&fd(),Ps(s),v=s.pendingLanes,(c&261930)!==0&&(v&42)!==0?s===$g?Tf++:(Tf=0,$g=s):Tf=0,Sf(0)}}function Rw(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,af(l)))}function fd(){return kw(),Cw(),Nw(),Iw()}function Iw(){if(ln!==5)return!1;var s=hl,l=Xg;Xg=0;var c=is(wi),h=ie.T,v=ee.p;try{ee.p=32>c?32:c,ie.T=null,c=Yg,Yg=null;var _=hl,k=wi;if(ln=0,Hc=hl=null,wi=0,(Xt&6)!==0)throw Error(n(331));var z=Xt;if(Xt|=4,hw(_.current),cw(_,_.current,k,c),Xt=z,Sf(0,!1),Yt&&typeof Yt.onPostCommitFiberRoot=="function")try{Yt.onPostCommitFiberRoot(Tt,_)}catch{}return!0}finally{ee.p=v,ie.T=h,Rw(s,l)}}function Dw(s,l,c){l=Va(c,l),l=kg(s.stateNode,l,2),s=sl(s,l,2),s!==null&&(ti(s,2),Ps(s))}function tr(s,l,c){if(s.tag===3)Dw(s,s,c);else for(;l!==null;){if(l.tag===3){Dw(l,s,c);break}else if(l.tag===1){var h=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(fl===null||!fl.has(h))){s=Va(c,s),c=O2(2),h=sl(l,c,2),h!==null&&(F2(c,h,l,s),ti(h,2),Ps(h));break}}l=l.return}}function Jg(s,l,c){var h=s.pingCache;if(h===null){h=s.pingCache=new Y3;var v=new Set;h.set(l,v)}else v=h.get(l),v===void 0&&(v=new Set,h.set(l,v));v.has(c)||(Gg=!0,v.add(c),s=Z3.bind(null,s,l,c),l.then(s,s))}function Z3(s,l,c){var h=s.pingCache;h!==null&&h.delete(l),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,hr===s&&(Dt&c)===c&&(Mr===4||Mr===3&&(Dt&62914560)===Dt&&300>Bt()-sd?(Xt&2)===0&&Gc(s,0):qg|=c,zc===Dt&&(zc=0)),Ps(s)}function Ow(s,l){l===0&&(l=dc()),s=yo(s,l),s!==null&&(ti(s,l),Ps(s))}function e6(s){var l=s.memoizedState,c=0;l!==null&&(c=l.retryLane),Ow(s,c)}function t6(s,l){var c=0;switch(s.tag){case 31:case 13:var h=s.stateNode,v=s.memoizedState;v!==null&&(c=v.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(l),Ow(s,c)}function r6(s,l){return Ye(s,l)}var hd=null,Wc=null,Zg=!1,dd=!1,e1=!1,ml=0;function Ps(s){s!==Wc&&s.next===null&&(Wc===null?hd=Wc=s:Wc=Wc.next=s),dd=!0,Zg||(Zg=!0,a6())}function Sf(s,l){if(!e1&&dd){e1=!0;do for(var c=!1,h=hd;h!==null;){if(s!==0){var v=h.pendingLanes;if(v===0)var _=0;else{var k=h.suspendedLanes,z=h.pingedLanes;_=(1<<31-gr(42|s)+1)-1,_&=v&~(k&~z),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(c=!0,jw(h,_))}else _=Dt,_=ga(h,h===hr?_:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(_&3)===0||Xn(h,_)||(c=!0,jw(h,_));h=h.next}while(c);e1=!1}}function n6(){Fw()}function Fw(){dd=Zg=!1;var s=0;ml!==0&&m6()&&(s=ml);for(var l=Bt(),c=null,h=hd;h!==null;){var v=h.next,_=Mw(h,l);_===0?(h.next=null,c===null?hd=v:c.next=v,v===null&&(Wc=c)):(c=h,(s!==0||(_&3)!==0)&&(dd=!0)),h=v}ln!==0&&ln!==5||Sf(s),ml!==0&&(ml=0)}function Mw(s,l){for(var c=s.suspendedLanes,h=s.pingedLanes,v=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var k=31-gr(_),z=1<<k,se=v[k];se===-1?((z&c)===0||(z&h)!==0)&&(v[k]=Vu(z,l)):se<=l&&(s.expiredLanes|=z),_&=~z}if(l=hr,c=Dt,c=ga(s,s===l?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,c===0||s===l&&(er===2||er===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&et(h),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||Xn(s,c)){if(l=c&-c,l===s.callbackPriority)return l;switch(h!==null&&et(h),is(c)){case 2:case 8:c=pa;break;case 32:c=dr;break;case 268435456:c=mt;break;default:c=dr}return h=Pw.bind(null,s),c=Ye(c,h),s.callbackPriority=l,s.callbackNode=c,l}return h!==null&&h!==null&&et(h),s.callbackPriority=2,s.callbackNode=null,2}function Pw(s,l){if(ln!==0&&ln!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(fd()&&s.callbackNode!==c)return null;var h=Dt;return h=ga(s,s===hr?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(xw(s,h,l),Mw(s,Bt()),s.callbackNode!=null&&s.callbackNode===c?Pw.bind(null,s):null)}function jw(s,l){if(fd())return null;xw(s,l,!0)}function a6(){g6(function(){(Xt&6)!==0?Ye(Nn,n6):Fw()})}function t1(){if(ml===0){var s=Ic;s===0&&(s=ea,ea<<=1,(ea&261888)===0&&(ea=256)),ml=s}return ml}function Lw(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:gc(""+s)}function Bw(s,l){var c=l.ownerDocument.createElement("input");return c.name=l.name,c.value=l.value,s.id&&c.setAttribute("form",s.id),l.parentNode.insertBefore(c,l),s=new FormData(s),c.parentNode.removeChild(c),s}function s6(s,l,c,h,v){if(l==="submit"&&c&&c.stateNode===v){var _=Lw((v[K]||null).action),k=h.submitter;k&&(l=(l=k[K]||null)?Lw(l.formAction):k.getAttribute("formAction"),l!==null&&(_=l,k=null));var z=new Ns("action","action",null,h,v);s.push({event:z,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(ml!==0){var se=k?Bw(v,k):new FormData(v);wg(c,{pending:!0,data:se,method:v.method,action:_},null,se)}}else typeof _=="function"&&(z.preventDefault(),se=k?Bw(v,k):new FormData(v),wg(c,{pending:!0,data:se,method:v.method,action:_},_,se))},currentTarget:v}]})}}for(var r1=0;r1<Lp.length;r1++){var n1=Lp[r1],i6=n1.toLowerCase(),l6=n1[0].toUpperCase()+n1.slice(1);ms(i6,"on"+l6)}ms(g_,"onAnimationEnd"),ms(x_,"onAnimationIteration"),ms(v_,"onAnimationStart"),ms("dblclick","onDoubleClick"),ms("focusin","onFocus"),ms("focusout","onBlur"),ms(E3,"onTransitionRun"),ms(T3,"onTransitionStart"),ms(S3,"onTransitionCancel"),ms(y_,"onTransitionEnd"),In("onMouseEnter",["mouseout","mouseover"]),In("onMouseLeave",["mouseout","mouseover"]),In("onPointerEnter",["pointerout","pointerover"]),In("onPointerLeave",["pointerout","pointerover"]),fr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fr("onBeforeInput",["compositionend","keypress","textInput","paste"]),fr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Af="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),o6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Af));function Vw(s,l){l=(l&4)!==0;for(var c=0;c<s.length;c++){var h=s[c],v=h.event;h=h.listeners;e:{var _=void 0;if(l)for(var k=h.length-1;0<=k;k--){var z=h[k],se=z.instance,pe=z.currentTarget;if(z=z.listener,se!==_&&v.isPropagationStopped())break e;_=z,v.currentTarget=pe;try{_(v)}catch(ke){Ch(ke)}v.currentTarget=null,_=se}else for(k=0;k<h.length;k++){if(z=h[k],se=z.instance,pe=z.currentTarget,z=z.listener,se!==_&&v.isPropagationStopped())break e;_=z,v.currentTarget=pe;try{_(v)}catch(ke){Ch(ke)}v.currentTarget=null,_=se}}}}function Rt(s,l){var c=l[de];c===void 0&&(c=l[de]=new Set);var h=s+"__bubble";c.has(h)||(Uw(l,s,2,!1),c.add(h))}function a1(s,l,c){var h=0;l&&(h|=4),Uw(c,s,h,l)}var md="_reactListening"+Math.random().toString(36).slice(2);function s1(s){if(!s[md]){s[md]=!0,Qt.forEach(function(c){c!=="selectionchange"&&(o6.has(c)||a1(c,!1,s),a1(c,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[md]||(l[md]=!0,a1("selectionchange",!1,l))}}function Uw(s,l,c,h){switch(gb(l)){case 2:var v=P6;break;case 8:v=j6;break;default:v=_1}c=v.bind(null,l,c,s),v=void 0,!uo||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),h?v!==void 0?s.addEventListener(l,c,{capture:!0,passive:v}):s.addEventListener(l,c,!0):v!==void 0?s.addEventListener(l,c,{passive:v}):s.addEventListener(l,c,!1)}function i1(s,l,c,h,v){var _=h;if((l&1)===0&&(l&2)===0&&h!==null)e:for(;;){if(h===null)return;var k=h.tag;if(k===3||k===4){var z=h.stateNode.containerInfo;if(z===v)break;if(k===4)for(k=h.return;k!==null;){var se=k.tag;if((se===3||se===4)&&k.stateNode.containerInfo===v)return;k=k.return}for(;z!==null;){if(k=Ve(z),k===null)return;if(se=k.tag,se===5||se===6||se===26||se===27){h=_=k;continue e}z=z.parentNode}}h=h.return}$i(function(){var pe=_,ke=Pa(c),De=[];e:{var ve=__.get(s);if(ve!==void 0){var be=Ns,Je=s;switch(s){case"keypress":if(ho(c)===0)break e;case"keydown":case"keyup":be=Sh;break;case"focusin":Je="focus",be=po;break;case"focusout":Je="blur",be=po;break;case"beforeblur":case"afterblur":be=po;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":be=Ku;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":be=gh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":be=S;break;case g_:case x_:case v_:be=vh;break;case y_:be=G;break;case"scroll":case"scrollend":be=$u;break;case"wheel":be=_e;break;case"copy":case"cut":case"paste":be=yh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":be=li;break;case"toggle":case"beforetoggle":be=vt}var it=(l&4)!==0,cr=!it&&(s==="scroll"||s==="scrollend"),ce=it?ve!==null?ve+"Capture":null:ve;it=[];for(var oe=pe,he;oe!==null;){var Ne=oe;if(he=Ne.stateNode,Ne=Ne.tag,Ne!==5&&Ne!==26&&Ne!==27||he===null||ce===null||(Ne=us(oe,ce),Ne!=null&&it.push(kf(oe,Ne,he))),cr)break;oe=oe.return}0<it.length&&(ve=new be(ve,Je,null,c,ke),De.push({event:ve,listeners:it}))}}if((l&7)===0){e:{if(ve=s==="mouseover"||s==="pointerover",be=s==="mouseout"||s==="pointerout",ve&&c!==Wu&&(Je=c.relatedTarget||c.fromElement)&&(Ve(Je)||Je[Z]))break e;if((be||ve)&&(ve=ke.window===ke?ke:(ve=ke.ownerDocument)?ve.defaultView||ve.parentWindow:window,be?(Je=c.relatedTarget||c.toElement,be=pe,Je=Je?Ve(Je):null,Je!==null&&(cr=i(Je),it=Je.tag,Je!==cr||it!==5&&it!==27&&it!==6)&&(Je=null)):(be=null,Je=pe),be!==Je)){if(it=Ku,Ne="onMouseLeave",ce="onMouseEnter",oe="mouse",(s==="pointerout"||s==="pointerover")&&(it=li,Ne="onPointerLeave",ce="onPointerEnter",oe="pointer"),cr=be==null?ve:je(be),he=Je==null?ve:je(Je),ve=new it(Ne,oe+"leave",be,c,ke),ve.target=cr,ve.relatedTarget=he,Ne=null,Ve(ke)===pe&&(it=new it(ce,oe+"enter",Je,c,ke),it.target=he,it.relatedTarget=cr,Ne=it),cr=Ne,be&&Je)t:{for(it=c6,ce=be,oe=Je,he=0,Ne=ce;Ne;Ne=it(Ne))he++;Ne=0;for(var rt=oe;rt;rt=it(rt))Ne++;for(;0<he-Ne;)ce=it(ce),he--;for(;0<Ne-he;)oe=it(oe),Ne--;for(;he--;){if(ce===oe||oe!==null&&ce===oe.alternate){it=ce;break t}ce=it(ce),oe=it(oe)}it=null}else it=null;be!==null&&zw(De,ve,be,it,!1),Je!==null&&cr!==null&&zw(De,cr,Je,it,!0)}}e:{if(ve=pe?je(pe):window,be=ve.nodeName&&ve.nodeName.toLowerCase(),be==="select"||be==="input"&&ve.type==="file")var Ht=s_;else if(n_(ve))if(i_)Ht=_3;else{Ht=v3;var tt=x3}else be=ve.nodeName,!be||be.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?pe&&pc(pe.elementType)&&(Ht=s_):Ht=y3;if(Ht&&(Ht=Ht(s,pe))){a_(De,Ht,c,ke);break e}tt&&tt(s,ve,pe),s==="focusout"&&pe&&ve.type==="number"&&pe.memoizedProps.value!=null&&Hu(ve,"number",ve.value)}switch(tt=pe?je(pe):window,s){case"focusin":(n_(tt)||tt.contentEditable==="true")&&(Ec=tt,Mp=pe,tf=null);break;case"focusout":tf=Mp=Ec=null;break;case"mousedown":Pp=!0;break;case"contextmenu":case"mouseup":case"dragend":Pp=!1,m_(De,c,ke);break;case"selectionchange":if(b3)break;case"keydown":case"keyup":m_(De,c,ke)}var wt;if(Wt)e:{switch(s){case"compositionstart":var Ot="onCompositionStart";break e;case"compositionend":Ot="onCompositionEnd";break e;case"compositionupdate":Ot="onCompositionUpdate";break e}Ot=void 0}else bc?go(s,c)&&(Ot="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Ot="onCompositionStart");Ot&&(Ds&&c.locale!=="ko"&&(bc||Ot!=="onCompositionStart"?Ot==="onCompositionEnd"&&bc&&(wt=Yu()):(Cs=ke,Xu="value"in Cs?Cs.value:Cs.textContent,bc=!0)),tt=pd(pe,Ot),0<tt.length&&(Ot=new Is(Ot,s,null,c,ke),De.push({event:Ot,listeners:tt}),wt?Ot.data=wt:(wt=wc(c),wt!==null&&(Ot.data=wt)))),(wt=La?d3(s,c):m3(s,c))&&(Ot=pd(pe,"onBeforeInput"),0<Ot.length&&(tt=new Is("onBeforeInput","beforeinput",null,c,ke),De.push({event:tt,listeners:Ot}),tt.data=wt)),s6(De,s,pe,c,ke)}Vw(De,l)})}function kf(s,l,c){return{instance:s,listener:l,currentTarget:c}}function pd(s,l){for(var c=l+"Capture",h=[];s!==null;){var v=s,_=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||_===null||(v=us(s,c),v!=null&&h.unshift(kf(s,v,_)),v=us(s,l),v!=null&&h.push(kf(s,v,_))),s.tag===3)return h;s=s.return}return[]}function c6(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function zw(s,l,c,h,v){for(var _=l._reactName,k=[];c!==null&&c!==h;){var z=c,se=z.alternate,pe=z.stateNode;if(z=z.tag,se!==null&&se===h)break;z!==5&&z!==26&&z!==27||pe===null||(se=pe,v?(pe=us(c,_),pe!=null&&k.unshift(kf(c,pe,se))):v||(pe=us(c,_),pe!=null&&k.push(kf(c,pe,se)))),c=c.return}k.length!==0&&s.push({event:l,listeners:k})}var u6=/\r\n?/g,f6=/\u0000|\uFFFD/g;function Hw(s){return(typeof s=="string"?s:""+s).replace(u6,`
`).replace(f6,"")}function Gw(s,l){return l=Hw(l),Hw(s)===l}function or(s,l,c,h,v,_){switch(c){case"children":typeof h=="string"?l==="body"||l==="textarea"&&h===""||ra(s,h):(typeof h=="number"||typeof h=="bigint")&&l!=="body"&&ra(s,""+h);break;case"className":va(s,"class",h);break;case"tabIndex":va(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":va(s,c,h);break;case"style":qu(s,h,_);break;case"data":if(l!=="object"){va(s,"data",h);break}case"src":case"href":if(h===""&&(l!=="a"||c!=="href")){s.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=gc(""+h),s.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(c==="formAction"?(l!=="input"&&or(s,l,"name",v.name,v,null),or(s,l,"formEncType",v.formEncType,v,null),or(s,l,"formMethod",v.formMethod,v,null),or(s,l,"formTarget",v.formTarget,v,null)):(or(s,l,"encType",v.encType,v,null),or(s,l,"method",v.method,v,null),or(s,l,"target",v.target,v,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=gc(""+h),s.setAttribute(c,h);break;case"onClick":h!=null&&(s.onclick=cs);break;case"onScroll":h!=null&&Rt("scroll",s);break;case"onScrollEnd":h!=null&&Rt("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}c=gc(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""+h):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":h===!0?s.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,h):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(c,h):s.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(c):s.setAttribute(c,h);break;case"popover":Rt("beforetoggle",s),Rt("toggle",s),Dn(s,"popover",h);break;case"xlinkActuate":Yr(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Yr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Yr(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Yr(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Yr(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Yr(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Yr(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Yr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Yr(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Dn(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=ph.get(c)||c,Dn(s,c,h))}}function l1(s,l,c,h,v,_){switch(c){case"style":qu(s,h,_);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"children":typeof h=="string"?ra(s,h):(typeof h=="number"||typeof h=="bigint")&&ra(s,""+h);break;case"onScroll":h!=null&&Rt("scroll",s);break;case"onScrollEnd":h!=null&&Rt("scrollend",s);break;case"onClick":h!=null&&(s.onclick=cs);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Jt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(v=c.endsWith("Capture"),l=c.slice(2,v?c.length-7:void 0),_=s[K]||null,_=_!=null?_[c]:null,typeof _=="function"&&s.removeEventListener(l,_,v),typeof h=="function")){typeof _!="function"&&_!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(l,h,v);break e}c in s?s[c]=h:h===!0?s.setAttribute(c,""):Dn(s,c,h)}}}function bn(s,l,c){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Rt("error",s),Rt("load",s);var h=!1,v=!1,_;for(_ in c)if(c.hasOwnProperty(_)){var k=c[_];if(k!=null)switch(_){case"src":h=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:or(s,l,_,k,c,null)}}v&&or(s,l,"srcSet",c.srcSet,c,null),h&&or(s,l,"src",c.src,c,null);return;case"input":Rt("invalid",s);var z=_=k=v=null,se=null,pe=null;for(h in c)if(c.hasOwnProperty(h)){var ke=c[h];if(ke!=null)switch(h){case"name":v=ke;break;case"type":k=ke;break;case"checked":se=ke;break;case"defaultChecked":pe=ke;break;case"value":_=ke;break;case"defaultValue":z=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(n(137,l));break;default:or(s,l,h,ke,c,null)}}hh(s,_,z,se,pe,k,v,!1);return;case"select":Rt("invalid",s),h=k=_=null;for(v in c)if(c.hasOwnProperty(v)&&(z=c[v],z!=null))switch(v){case"value":_=z;break;case"defaultValue":k=z;break;case"multiple":h=z;default:or(s,l,v,z,c,null)}l=_,c=k,s.multiple=!!h,l!=null?qi(s,!!h,l,!1):c!=null&&qi(s,!!h,c,!0);return;case"textarea":Rt("invalid",s),_=v=h=null;for(k in c)if(c.hasOwnProperty(k)&&(z=c[k],z!=null))switch(k){case"value":h=z;break;case"defaultValue":v=z;break;case"children":_=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(n(91));break;default:or(s,l,k,z,c,null)}Wi(s,h,v,_);return;case"option":for(se in c)if(c.hasOwnProperty(se)&&(h=c[se],h!=null))switch(se){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:or(s,l,se,h,c,null)}return;case"dialog":Rt("beforetoggle",s),Rt("toggle",s),Rt("cancel",s),Rt("close",s);break;case"iframe":case"object":Rt("load",s);break;case"video":case"audio":for(h=0;h<Af.length;h++)Rt(Af[h],s);break;case"image":Rt("error",s),Rt("load",s);break;case"details":Rt("toggle",s);break;case"embed":case"source":case"link":Rt("error",s),Rt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in c)if(c.hasOwnProperty(pe)&&(h=c[pe],h!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:or(s,l,pe,h,c,null)}return;default:if(pc(l)){for(ke in c)c.hasOwnProperty(ke)&&(h=c[ke],h!==void 0&&l1(s,l,ke,h,c,void 0));return}}for(z in c)c.hasOwnProperty(z)&&(h=c[z],h!=null&&or(s,l,z,h,c,null))}function h6(s,l,c,h){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,_=null,k=null,z=null,se=null,pe=null,ke=null;for(be in c){var De=c[be];if(c.hasOwnProperty(be)&&De!=null)switch(be){case"checked":break;case"value":break;case"defaultValue":se=De;default:h.hasOwnProperty(be)||or(s,l,be,null,h,De)}}for(var ve in h){var be=h[ve];if(De=c[ve],h.hasOwnProperty(ve)&&(be!=null||De!=null))switch(ve){case"type":_=be;break;case"name":v=be;break;case"checked":pe=be;break;case"defaultChecked":ke=be;break;case"value":k=be;break;case"defaultValue":z=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(n(137,l));break;default:be!==De&&or(s,l,ve,be,h,De)}}mc(s,k,z,se,pe,ke,_,v);return;case"select":be=k=z=ve=null;for(_ in c)if(se=c[_],c.hasOwnProperty(_)&&se!=null)switch(_){case"value":break;case"multiple":be=se;default:h.hasOwnProperty(_)||or(s,l,_,null,h,se)}for(v in h)if(_=h[v],se=c[v],h.hasOwnProperty(v)&&(_!=null||se!=null))switch(v){case"value":ve=_;break;case"defaultValue":z=_;break;case"multiple":k=_;default:_!==se&&or(s,l,v,_,h,se)}l=z,c=k,h=be,ve!=null?qi(s,!!c,ve,!1):!!h!=!!c&&(l!=null?qi(s,!!c,l,!0):qi(s,!!c,c?[]:"",!1));return;case"textarea":be=ve=null;for(z in c)if(v=c[z],c.hasOwnProperty(z)&&v!=null&&!h.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:or(s,l,z,null,h,v)}for(k in h)if(v=h[k],_=c[k],h.hasOwnProperty(k)&&(v!=null||_!=null))switch(k){case"value":ve=v;break;case"defaultValue":be=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(n(91));break;default:v!==_&&or(s,l,k,v,h,_)}dh(s,ve,be);return;case"option":for(var Je in c)if(ve=c[Je],c.hasOwnProperty(Je)&&ve!=null&&!h.hasOwnProperty(Je))switch(Je){case"selected":s.selected=!1;break;default:or(s,l,Je,null,h,ve)}for(se in h)if(ve=h[se],be=c[se],h.hasOwnProperty(se)&&ve!==be&&(ve!=null||be!=null))switch(se){case"selected":s.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:or(s,l,se,ve,h,be)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var it in c)ve=c[it],c.hasOwnProperty(it)&&ve!=null&&!h.hasOwnProperty(it)&&or(s,l,it,null,h,ve);for(pe in h)if(ve=h[pe],be=c[pe],h.hasOwnProperty(pe)&&ve!==be&&(ve!=null||be!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,l));break;default:or(s,l,pe,ve,h,be)}return;default:if(pc(l)){for(var cr in c)ve=c[cr],c.hasOwnProperty(cr)&&ve!==void 0&&!h.hasOwnProperty(cr)&&l1(s,l,cr,void 0,h,ve);for(ke in h)ve=h[ke],be=c[ke],!h.hasOwnProperty(ke)||ve===be||ve===void 0&&be===void 0||l1(s,l,ke,ve,h,be);return}}for(var ce in c)ve=c[ce],c.hasOwnProperty(ce)&&ve!=null&&!h.hasOwnProperty(ce)&&or(s,l,ce,null,h,ve);for(De in h)ve=h[De],be=c[De],!h.hasOwnProperty(De)||ve===be||ve==null&&be==null||or(s,l,De,ve,h,be)}function qw(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function d6(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var v=c[h],_=v.transferSize,k=v.initiatorType,z=v.duration;if(_&&z&&qw(k)){for(k=0,z=v.responseEnd,h+=1;h<c.length;h++){var se=c[h],pe=se.startTime;if(pe>z)break;var ke=se.transferSize,De=se.initiatorType;ke&&qw(De)&&(se=se.responseEnd,k+=ke*(se<z?1:(z-pe)/(se-pe)))}if(--h,l+=8*(_+k)/(v.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var o1=null,c1=null;function gd(s){return s.nodeType===9?s:s.ownerDocument}function Ww(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Xw(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function u1(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var f1=null;function m6(){var s=window.event;return s&&s.type==="popstate"?s===f1?!1:(f1=s,!0):(f1=null,!1)}var Yw=typeof setTimeout=="function"?setTimeout:void 0,p6=typeof clearTimeout=="function"?clearTimeout:void 0,$w=typeof Promise=="function"?Promise:void 0,g6=typeof queueMicrotask=="function"?queueMicrotask:typeof $w<"u"?function(s){return $w.resolve(null).then(s).catch(x6)}:Yw;function x6(s){setTimeout(function(){throw s})}function pl(s){return s==="head"}function Kw(s,l){var c=l,h=0;do{var v=c.nextSibling;if(s.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"||c==="/&"){if(h===0){s.removeChild(v),Kc(l);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")Cf(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,Cf(c);for(var _=c.firstChild;_;){var k=_.nextSibling,z=_.nodeName;_[ge]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&_.rel.toLowerCase()==="stylesheet"||c.removeChild(_),_=k}}else c==="body"&&Cf(s.ownerDocument.body);c=v}while(c);Kc(l)}function Qw(s,l){var c=s;s=0;do{var h=c.nextSibling;if(c.nodeType===1?l?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(l?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=h}while(c)}function h1(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var c=l;switch(l=l.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":h1(c),Le(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function v6(s,l,c,h){for(;s.nodeType===1;){var v=c;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[ge])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var _=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=qa(s.nextSibling),s===null)break}return null}function y6(s,l,c){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=qa(s.nextSibling),s===null))return null;return s}function Jw(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=qa(s.nextSibling),s===null))return null;return s}function d1(s){return s.data==="$?"||s.data==="$~"}function m1(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function _6(s,l){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||c.readyState!=="loading")l();else{var h=function(){l(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function qa(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var p1=null;function Zw(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(l===0)return qa(s.nextSibling);l--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||l++}s=s.nextSibling}return null}function eb(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(l===0)return s;l--}else c!=="/$"&&c!=="/&"||l++}s=s.previousSibling}return null}function tb(s,l,c){switch(l=gd(c),s){case"html":if(s=l.documentElement,!s)throw Error(n(452));return s;case"head":if(s=l.head,!s)throw Error(n(453));return s;case"body":if(s=l.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Cf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Le(s)}var Wa=new Map,rb=new Set;function xd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var bi=ee.d;ee.d={f:w6,r:b6,D:E6,C:T6,L:S6,m:A6,X:C6,S:k6,M:N6};function w6(){var s=bi.f(),l=od();return s||l}function b6(s){var l=qe(s);l!==null&&l.tag===5&&l.type==="form"?y2(l):bi.r(s)}var Xc=typeof document>"u"?null:document;function nb(s,l,c){var h=Xc;if(h&&typeof l=="string"&&l){var v=ta(l);v='link[rel="'+s+'"][href="'+v+'"]',typeof c=="string"&&(v+='[crossorigin="'+c+'"]'),rb.has(v)||(rb.add(v),s={rel:s,crossOrigin:c,href:l},h.querySelector(v)===null&&(l=h.createElement("link"),bn(l,"link",s),Ze(l),h.head.appendChild(l)))}}function E6(s){bi.D(s),nb("dns-prefetch",s,null)}function T6(s,l){bi.C(s,l),nb("preconnect",s,l)}function S6(s,l,c){bi.L(s,l,c);var h=Xc;if(h&&s&&l){var v='link[rel="preload"][as="'+ta(l)+'"]';l==="image"&&c&&c.imageSrcSet?(v+='[imagesrcset="'+ta(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(v+='[imagesizes="'+ta(c.imageSizes)+'"]')):v+='[href="'+ta(s)+'"]';var _=v;switch(l){case"style":_=Yc(s);break;case"script":_=$c(s)}Wa.has(_)||(s=x({rel:"preload",href:l==="image"&&c&&c.imageSrcSet?void 0:s,as:l},c),Wa.set(_,s),h.querySelector(v)!==null||l==="style"&&h.querySelector(Nf(_))||l==="script"&&h.querySelector(Rf(_))||(l=h.createElement("link"),bn(l,"link",s),Ze(l),h.head.appendChild(l)))}}function A6(s,l){bi.m(s,l);var c=Xc;if(c&&s){var h=l&&typeof l.as=="string"?l.as:"script",v='link[rel="modulepreload"][as="'+ta(h)+'"][href="'+ta(s)+'"]',_=v;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=$c(s)}if(!Wa.has(_)&&(s=x({rel:"modulepreload",href:s},l),Wa.set(_,s),c.querySelector(v)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Rf(_)))return}h=c.createElement("link"),bn(h,"link",s),Ze(h),c.head.appendChild(h)}}}function k6(s,l,c){bi.S(s,l,c);var h=Xc;if(h&&s){var v=Ge(h).hoistableStyles,_=Yc(s);l=l||"default";var k=v.get(_);if(!k){var z={loading:0,preload:null};if(k=h.querySelector(Nf(_)))z.loading=5;else{s=x({rel:"stylesheet",href:s,"data-precedence":l},c),(c=Wa.get(_))&&g1(s,c);var se=k=h.createElement("link");Ze(se),bn(se,"link",s),se._p=new Promise(function(pe,ke){se.onload=pe,se.onerror=ke}),se.addEventListener("load",function(){z.loading|=1}),se.addEventListener("error",function(){z.loading|=2}),z.loading|=4,vd(k,l,h)}k={type:"stylesheet",instance:k,count:1,state:z},v.set(_,k)}}}function C6(s,l){bi.X(s,l);var c=Xc;if(c&&s){var h=Ge(c).hoistableScripts,v=$c(s),_=h.get(v);_||(_=c.querySelector(Rf(v)),_||(s=x({src:s,async:!0},l),(l=Wa.get(v))&&x1(s,l),_=c.createElement("script"),Ze(_),bn(_,"link",s),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},h.set(v,_))}}function N6(s,l){bi.M(s,l);var c=Xc;if(c&&s){var h=Ge(c).hoistableScripts,v=$c(s),_=h.get(v);_||(_=c.querySelector(Rf(v)),_||(s=x({src:s,async:!0,type:"module"},l),(l=Wa.get(v))&&x1(s,l),_=c.createElement("script"),Ze(_),bn(_,"link",s),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},h.set(v,_))}}function ab(s,l,c,h){var v=(v=ue.current)?xd(v):null;if(!v)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(l=Yc(c.href),c=Ge(v).hoistableStyles,h=c.get(l),h||(h={type:"style",instance:null,count:0,state:null},c.set(l,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=Yc(c.href);var _=Ge(v).hoistableStyles,k=_.get(s);if(k||(v=v.ownerDocument||v,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,k),(_=v.querySelector(Nf(s)))&&!_._p&&(k.instance=_,k.state.loading=5),Wa.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Wa.set(s,c),_||R6(v,s,c,k.state))),l&&h===null)throw Error(n(528,""));return k}if(l&&h!==null)throw Error(n(529,""));return null;case"script":return l=c.async,c=c.src,typeof c=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=$c(c),c=Ge(v).hoistableScripts,h=c.get(l),h||(h={type:"script",instance:null,count:0,state:null},c.set(l,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function Yc(s){return'href="'+ta(s)+'"'}function Nf(s){return'link[rel="stylesheet"]['+s+"]"}function sb(s){return x({},s,{"data-precedence":s.precedence,precedence:null})}function R6(s,l,c,h){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?h.loading=1:(l=s.createElement("link"),h.preload=l,l.addEventListener("load",function(){return h.loading|=1}),l.addEventListener("error",function(){return h.loading|=2}),bn(l,"link",c),Ze(l),s.head.appendChild(l))}function $c(s){return'[src="'+ta(s)+'"]'}function Rf(s){return"script[async]"+s}function ib(s,l,c){if(l.count++,l.instance===null)switch(l.type){case"style":var h=s.querySelector('style[data-href~="'+ta(c.href)+'"]');if(h)return l.instance=h,Ze(h),h;var v=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),Ze(h),bn(h,"style",v),vd(h,c.precedence,s),l.instance=h;case"stylesheet":v=Yc(c.href);var _=s.querySelector(Nf(v));if(_)return l.state.loading|=4,l.instance=_,Ze(_),_;h=sb(c),(v=Wa.get(v))&&g1(h,v),_=(s.ownerDocument||s).createElement("link"),Ze(_);var k=_;return k._p=new Promise(function(z,se){k.onload=z,k.onerror=se}),bn(_,"link",h),l.state.loading|=4,vd(_,c.precedence,s),l.instance=_;case"script":return _=$c(c.src),(v=s.querySelector(Rf(_)))?(l.instance=v,Ze(v),v):(h=c,(v=Wa.get(_))&&(h=x({},c),x1(h,v)),s=s.ownerDocument||s,v=s.createElement("script"),Ze(v),bn(v,"link",h),s.head.appendChild(v),l.instance=v);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(h=l.instance,l.state.loading|=4,vd(h,c.precedence,s));return l.instance}function vd(s,l,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=h.length?h[h.length-1]:null,_=v,k=0;k<h.length;k++){var z=h[k];if(z.dataset.precedence===l)_=z;else if(_!==v)break}_?_.parentNode.insertBefore(s,_.nextSibling):(l=c.nodeType===9?c.head:c,l.insertBefore(s,l.firstChild))}function g1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function x1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var yd=null;function lb(s,l,c){if(yd===null){var h=new Map,v=yd=new Map;v.set(c,h)}else v=yd,h=v.get(c),h||(h=new Map,v.set(c,h));if(h.has(s))return h;for(h.set(s,null),c=c.getElementsByTagName(s),v=0;v<c.length;v++){var _=c[v];if(!(_[ge]||_[q]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var k=_.getAttribute(l)||"";k=s+k;var z=h.get(k);z?z.push(_):h.set(k,[_])}}return h}function ob(s,l,c){s=s.ownerDocument||s,s.head.insertBefore(c,l==="title"?s.querySelector("head > title"):null)}function I6(s,l,c){if(c===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function cb(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function D6(s,l,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var v=Yc(h.href),_=l.querySelector(Nf(v));if(_){l=_._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=_d.bind(s),l.then(s,s)),c.state.loading|=4,c.instance=_,Ze(_);return}_=l.ownerDocument||l,h=sb(h),(v=Wa.get(v))&&g1(h,v),_=_.createElement("link"),Ze(_);var k=_;k._p=new Promise(function(z,se){k.onload=z,k.onerror=se}),bn(_,"link",h),c.instance=_}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,l),(l=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=_d.bind(s),l.addEventListener("load",c),l.addEventListener("error",c))}}var v1=0;function O6(s,l){return s.stylesheets&&s.count===0&&bd(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var h=setTimeout(function(){if(s.stylesheets&&bd(s,s.stylesheets),s.unsuspend){var _=s.unsuspend;s.unsuspend=null,_()}},6e4+l);0<s.imgBytes&&v1===0&&(v1=62500*d6());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&bd(s,s.stylesheets),s.unsuspend)){var _=s.unsuspend;s.unsuspend=null,_()}},(s.imgBytes>v1?50:800)+l);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(h),clearTimeout(v)}}:null}function _d(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)bd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var wd=null;function bd(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,wd=new Map,l.forEach(F6,s),wd=null,_d.call(s))}function F6(s,l){if(!(l.state.loading&4)){var c=wd.get(s);if(c)var h=c.get(null);else{c=new Map,wd.set(s,c);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<v.length;_++){var k=v[_];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(c.set(k.dataset.precedence,k),h=k)}h&&c.set(null,h)}v=l.instance,k=v.getAttribute("data-precedence"),_=c.get(k)||h,_===h&&c.set(null,v),c.set(k,v),this.count++,h=_d.bind(this),v.addEventListener("load",h),v.addEventListener("error",h),_?_.parentNode.insertBefore(v,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),l.state.loading|=4}}var If={$$typeof:C,Provider:null,Consumer:null,_currentValue:ye,_currentValue2:ye,_threadCount:0};function M6(s,l,c,h,v,_,k,z,se){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ma(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ma(0),this.hiddenUpdates=Ma(null),this.identifierPrefix=h,this.onUncaughtError=v,this.onCaughtError=_,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=se,this.incompleteTransitions=new Map}function ub(s,l,c,h,v,_,k,z,se,pe,ke,De){return s=new M6(s,l,c,k,se,pe,ke,De,z),l=1,_===!0&&(l|=24),_=_a(3,null,null,l),s.current=_,_.stateNode=s,l=Qp(),l.refCount++,s.pooledCache=l,l.refCount++,_.memoizedState={element:h,isDehydrated:c,cache:l},tg(_),s}function fb(s){return s?(s=Ac,s):Ac}function hb(s,l,c,h,v,_){v=fb(v),h.context===null?h.context=v:h.pendingContext=v,h=al(l),h.payload={element:c},_=_===void 0?null:_,_!==null&&(h.callback=_),c=sl(s,h,l),c!==null&&(la(c,s,l),cf(c,s,l))}function db(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<l?c:l}}function y1(s,l){db(s,l),(s=s.alternate)&&db(s,l)}function mb(s){if(s.tag===13||s.tag===31){var l=yo(s,67108864);l!==null&&la(l,s,67108864),y1(s,67108864)}}function pb(s){if(s.tag===13||s.tag===31){var l=Sa();l=ai(l);var c=yo(s,l);c!==null&&la(c,s,l),y1(s,l)}}var Ed=!0;function P6(s,l,c,h){var v=ie.T;ie.T=null;var _=ee.p;try{ee.p=2,_1(s,l,c,h)}finally{ee.p=_,ie.T=v}}function j6(s,l,c,h){var v=ie.T;ie.T=null;var _=ee.p;try{ee.p=8,_1(s,l,c,h)}finally{ee.p=_,ie.T=v}}function _1(s,l,c,h){if(Ed){var v=w1(h);if(v===null)i1(s,l,h,Td,c),xb(s,h);else if(B6(v,s,l,c,h))h.stopPropagation();else if(xb(s,h),l&4&&-1<L6.indexOf(s)){for(;v!==null;){var _=qe(v);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var k=Or(_.pendingLanes);if(k!==0){var z=_;for(z.pendingLanes|=2,z.entangledLanes|=2;k;){var se=1<<31-gr(k);z.entanglements[1]|=se,k&=~se}Ps(_),(Xt&6)===0&&(id=Bt()+500,Sf(0))}}break;case 31:case 13:z=yo(_,2),z!==null&&la(z,_,2),od(),y1(_,2)}if(_=w1(h),_===null&&i1(s,l,h,Td,c),_===v)break;v=_}v!==null&&h.stopPropagation()}else i1(s,l,h,null,c)}}function w1(s){return s=Pa(s),b1(s)}var Td=null;function b1(s){if(Td=null,s=Ve(s),s!==null){var l=i(s);if(l===null)s=null;else{var c=l.tag;if(c===13){if(s=o(l),s!==null)return s;s=null}else if(c===31){if(s=u(l),s!==null)return s;s=null}else if(c===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return Td=s,null}function gb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Br()){case Nn:return 2;case pa:return 8;case dr:case Rn:return 32;case mt:return 268435456;default:return 32}default:return 32}}var E1=!1,gl=null,xl=null,vl=null,Df=new Map,Of=new Map,yl=[],L6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xb(s,l){switch(s){case"focusin":case"focusout":gl=null;break;case"dragenter":case"dragleave":xl=null;break;case"mouseover":case"mouseout":vl=null;break;case"pointerover":case"pointerout":Df.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Of.delete(l.pointerId)}}function Ff(s,l,c,h,v,_){return s===null||s.nativeEvent!==_?(s={blockedOn:l,domEventName:c,eventSystemFlags:h,nativeEvent:_,targetContainers:[v]},l!==null&&(l=qe(l),l!==null&&mb(l)),s):(s.eventSystemFlags|=h,l=s.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),s)}function B6(s,l,c,h,v){switch(l){case"focusin":return gl=Ff(gl,s,l,c,h,v),!0;case"dragenter":return xl=Ff(xl,s,l,c,h,v),!0;case"mouseover":return vl=Ff(vl,s,l,c,h,v),!0;case"pointerover":var _=v.pointerId;return Df.set(_,Ff(Df.get(_)||null,s,l,c,h,v)),!0;case"gotpointercapture":return _=v.pointerId,Of.set(_,Ff(Of.get(_)||null,s,l,c,h,v)),!0}return!1}function vb(s){var l=Ve(s.target);if(l!==null){var c=i(l);if(c!==null){if(l=c.tag,l===13){if(l=o(c),l!==null){s.blockedOn=l,Q(s.priority,function(){pb(c)});return}}else if(l===31){if(l=u(c),l!==null){s.blockedOn=l,Q(s.priority,function(){pb(c)});return}}else if(l===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Sd(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var c=w1(s.nativeEvent);if(c===null){c=s.nativeEvent;var h=new c.constructor(c.type,c);Wu=h,c.target.dispatchEvent(h),Wu=null}else return l=qe(c),l!==null&&mb(l),s.blockedOn=c,!1;l.shift()}return!0}function yb(s,l,c){Sd(s)&&c.delete(l)}function V6(){E1=!1,gl!==null&&Sd(gl)&&(gl=null),xl!==null&&Sd(xl)&&(xl=null),vl!==null&&Sd(vl)&&(vl=null),Df.forEach(yb),Of.forEach(yb)}function Ad(s,l){s.blockedOn===l&&(s.blockedOn=null,E1||(E1=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,V6)))}var kd=null;function _b(s){kd!==s&&(kd=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){kd===s&&(kd=null);for(var l=0;l<s.length;l+=3){var c=s[l],h=s[l+1],v=s[l+2];if(typeof h!="function"){if(b1(h||c)===null)continue;break}var _=qe(c);_!==null&&(s.splice(l,3),l-=3,wg(_,{pending:!0,data:v,method:c.method,action:h},h,v))}}))}function Kc(s){function l(se){return Ad(se,s)}gl!==null&&Ad(gl,s),xl!==null&&Ad(xl,s),vl!==null&&Ad(vl,s),Df.forEach(l),Of.forEach(l);for(var c=0;c<yl.length;c++){var h=yl[c];h.blockedOn===s&&(h.blockedOn=null)}for(;0<yl.length&&(c=yl[0],c.blockedOn===null);)vb(c),c.blockedOn===null&&yl.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var v=c[h],_=c[h+1],k=v[K]||null;if(typeof _=="function")k||_b(c);else if(k){var z=null;if(_&&_.hasAttribute("formAction")){if(v=_,k=_[K]||null)z=k.formAction;else if(b1(v)!==null)continue}else z=k.action;typeof z=="function"?c[h+1]=z:(c.splice(h,3),h-=3),_b(c)}}}function wb(){function s(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(k){return v=k})},focusReset:"manual",scroll:"manual"})}function l(){v!==null&&(v(),v=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),v!==null&&(v(),v=null)}}}function T1(s){this._internalRoot=s}Cd.prototype.render=T1.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(n(409));var c=l.current,h=Sa();hb(c,h,s,l,null,null)},Cd.prototype.unmount=T1.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;hb(s.current,2,null,s,null,null),od(),l[Z]=null}};function Cd(s){this._internalRoot=s}Cd.prototype.unstable_scheduleHydration=function(s){if(s){var l=L();s={blockedOn:null,target:s,priority:l};for(var c=0;c<yl.length&&l!==0&&l<yl[c].priority;c++);yl.splice(c,0,s),c===0&&vb(s)}};var bb=e.version;if(bb!=="19.2.1")throw Error(n(527,bb,"19.2.1"));ee.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=d(l),s=s!==null?m(s):null,s=s===null?null:s.stateNode,s};var U6={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Nd.isDisabled&&Nd.supportsFiber)try{Tt=Nd.inject(U6),Yt=Nd}catch{}}return Pf.createRoot=function(s,l){if(!a(s))throw Error(n(299));var c=!1,h="",v=N2,_=R2,k=I2;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(h=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(_=l.onCaughtError),l.onRecoverableError!==void 0&&(k=l.onRecoverableError)),l=ub(s,1,!1,null,null,c,h,null,v,_,k,wb),s[Z]=l.current,s1(s),new T1(l)},Pf.hydrateRoot=function(s,l,c){if(!a(s))throw Error(n(299));var h=!1,v="",_=N2,k=R2,z=I2,se=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onUncaughtError!==void 0&&(_=c.onUncaughtError),c.onCaughtError!==void 0&&(k=c.onCaughtError),c.onRecoverableError!==void 0&&(z=c.onRecoverableError),c.formState!==void 0&&(se=c.formState)),l=ub(s,1,!0,l,c??null,h,v,se,_,k,z,wb),l.context=fb(null),c=l.current,h=Sa(),h=ai(h),v=al(h),v.callback=null,sl(c,v,h),c=h,l.current.lanes=c,ti(l,c),Ps(l),s[Z]=l.current,s1(s),new Cd(l)},Pf.version="19.2.1",Pf}var Db;function Q6(){if(Db)return k1.exports;Db=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),k1.exports=K6(),k1.exports}var J6=Q6();const Z6=jS(J6);var Ob="popstate";function eR(t={}){function e(a,i){let{pathname:o="/",search:u="",hash:f=""}=nc(a.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),fx("",{pathname:o,search:u,hash:f},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(a,i){let o=a.document.querySelector("base"),u="";if(o&&o.getAttribute("href")){let f=a.location.href,d=f.indexOf("#");u=d===-1?f:f.slice(0,d)}return u+"#"+(typeof i=="string"?i:c0(i))}function n(a,i){Da(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return rR(e,r,n,t)}function kr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Da(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tR(){return Math.random().toString(36).substring(2,10)}function Fb(t,e){return{usr:t.state,key:t.key,idx:e}}function fx(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?nc(e):e,state:r,key:e&&e.key||n||tR()}}function c0({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function nc(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function rR(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,u="POP",f=null,d=m();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function m(){return(o.state||{idx:null}).idx}function x(){u="POP";let T=m(),R=T==null?null:T-d;d=T,f&&f({action:u,location:w.location,delta:R})}function y(T,R){u="PUSH";let I=fx(w.location,T,R);r&&r(I,T),d=m()+1;let C=Fb(I,d),W=w.createHref(I);try{o.pushState(C,"",W)}catch(U){if(U instanceof DOMException&&U.name==="DataCloneError")throw U;a.location.assign(W)}i&&f&&f({action:u,location:w.location,delta:1})}function b(T,R){u="REPLACE";let I=fx(w.location,T,R);r&&r(I,T),d=m();let C=Fb(I,d),W=w.createHref(I);o.replaceState(C,"",W),i&&f&&f({action:u,location:w.location,delta:0})}function E(T){return nR(T)}let w={get action(){return u},get location(){return t(a,o)},listen(T){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Ob,x),f=T,()=>{a.removeEventListener(Ob,x),f=null}},createHref(T){return e(a,T)},createURL:E,encodeLocation(T){let R=E(T);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:y,replace:b,go(T){return o.go(T)}};return w}function nR(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),kr(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:c0(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function LS(t,e,r="/"){return aR(t,e,r,!1)}function aR(t,e,r,n){let a=typeof e=="string"?nc(e):e,i=Ri(a.pathname||"/",r);if(i==null)return null;let o=BS(t);sR(o);let u=null;for(let f=0;u==null&&f<o.length;++f){let d=gR(i);u=mR(o[f],d,n)}return u}function BS(t,e=[],r=[],n="",a=!1){let i=(o,u,f=a,d)=>{let m={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(n)&&f)return;kr(m.relativePath.startsWith(n),`Absolute route path "${m.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(n.length)}let x=Ai([n,m.relativePath]),y=r.concat(m);o.children&&o.children.length>0&&(kr(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),BS(o.children,e,y,x,f)),!(o.path==null&&!o.index)&&e.push({path:x,score:hR(x,o.index),routesMeta:y})};return t.forEach((o,u)=>{if(o.path===""||!o.path?.includes("?"))i(o,u);else for(let f of VS(o.path))i(o,u,!0,f)}),e}function VS(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=VS(n.join("/")),u=[];return u.push(...o.map(f=>f===""?i:[i,f].join("/"))),a&&u.push(...o),u.map(f=>t.startsWith("/")&&f===""?"/":f)}function sR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:dR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var iR=/^:[\w-]+$/,lR=3,oR=2,cR=1,uR=10,fR=-2,Mb=t=>t==="*";function hR(t,e){let r=t.split("/"),n=r.length;return r.some(Mb)&&(n+=fR),e&&(n+=oR),r.filter(a=>!Mb(a)).reduce((a,i)=>a+(iR.test(i)?lR:i===""?cR:uR),n)}function dR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function mR(t,e,r=!1){let{routesMeta:n}=t,a={},i="/",o=[];for(let u=0;u<n.length;++u){let f=n[u],d=u===n.length-1,m=i==="/"?e:e.slice(i.length)||"/",x=cm({path:f.relativePath,caseSensitive:f.caseSensitive,end:d},m),y=f.route;if(!x&&d&&r&&!n[n.length-1].route.index&&(x=cm({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},m)),!x)return null;Object.assign(a,x.params),o.push({params:a,pathname:Ai([i,x.pathname]),pathnameBase:wR(Ai([i,x.pathnameBase])),route:y}),x.pathnameBase!=="/"&&(i=Ai([i,x.pathnameBase]))}return o}function cm(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=pR(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((d,{paramName:m,isOptional:x},y)=>{if(m==="*"){let E=u[y]||"";o=i.slice(0,i.length-E.length).replace(/(.)\/+$/,"$1")}const b=u[y];return x&&!b?d[m]=void 0:d[m]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function pR(t,e=!1,r=!0){Da(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,f)=>(n.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function gR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Da(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ri(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}var xR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vR=t=>xR.test(t);function yR(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?nc(t):t,i;if(r)if(vR(r))i=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Da(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${r}`)}r.startsWith("/")?i=Pb(r.substring(1),"/"):i=Pb(r,e)}else i=e;return{pathname:i,search:bR(n),hash:ER(a)}}function Pb(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function I1(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function _R(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function iv(t){let e=_R(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function lv(t,e,r,n=!1){let a;typeof t=="string"?a=nc(t):(a={...t},kr(!a.pathname||!a.pathname.includes("?"),I1("?","pathname","search",a)),kr(!a.pathname||!a.pathname.includes("#"),I1("#","pathname","hash",a)),kr(!a.search||!a.search.includes("#"),I1("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,u;if(o==null)u=r;else{let x=e.length-1;if(!n&&o.startsWith("..")){let y=o.split("/");for(;y[0]==="..";)y.shift(),x-=1;a.pathname=y.join("/")}u=x>=0?e[x]:"/"}let f=yR(a,u),d=o&&o!=="/"&&o.endsWith("/"),m=(i||o===".")&&r.endsWith("/");return!f.pathname.endsWith("/")&&(d||m)&&(f.pathname+="/"),f}var Ai=t=>t.join("/").replace(/\/\/+/g,"/"),wR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),bR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,ER=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function TR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function SR(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var US=["POST","PUT","PATCH","DELETE"];new Set(US);var AR=["GET",...US];new Set(AR);var Au=re.createContext(null);Au.displayName="DataRouter";var Xm=re.createContext(null);Xm.displayName="DataRouterState";re.createContext(!1);var zS=re.createContext({isTransitioning:!1});zS.displayName="ViewTransition";var kR=re.createContext(new Map);kR.displayName="Fetchers";var CR=re.createContext(null);CR.displayName="Await";var ns=re.createContext(null);ns.displayName="Navigation";var O0=re.createContext(null);O0.displayName="Location";var Qs=re.createContext({outlet:null,matches:[],isDataRoute:!1});Qs.displayName="Route";var ov=re.createContext(null);ov.displayName="RouteError";function NR(t,{relative:e}={}){kr(ku(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=re.useContext(ns),{hash:a,pathname:i,search:o}=M0(t,{relative:e}),u=i;return r!=="/"&&(u=i==="/"?r:Ai([r,i])),n.createHref({pathname:u,search:o,hash:a})}function ku(){return re.useContext(O0)!=null}function Jl(){return kr(ku(),"useLocation() may be used only in the context of a <Router> component."),re.useContext(O0).location}var HS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function GS(t){re.useContext(ns).static||re.useLayoutEffect(t)}function F0(){let{isDataRoute:t}=re.useContext(Qs);return t?zR():RR()}function RR(){kr(ku(),"useNavigate() may be used only in the context of a <Router> component.");let t=re.useContext(Au),{basename:e,navigator:r}=re.useContext(ns),{matches:n}=re.useContext(Qs),{pathname:a}=Jl(),i=JSON.stringify(iv(n)),o=re.useRef(!1);return GS(()=>{o.current=!0}),re.useCallback((f,d={})=>{if(Da(o.current,HS),!o.current)return;if(typeof f=="number"){r.go(f);return}let m=lv(f,JSON.parse(i),a,d.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Ai([e,m.pathname])),(d.replace?r.replace:r.push)(m,d.state,d)},[e,r,i,a,t])}re.createContext(null);function M0(t,{relative:e}={}){let{matches:r}=re.useContext(Qs),{pathname:n}=Jl(),a=JSON.stringify(iv(r));return re.useMemo(()=>lv(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function IR(t,e){return qS(t,e)}function qS(t,e,r,n,a){kr(ku(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=re.useContext(ns),{matches:o}=re.useContext(Qs),u=o[o.length-1],f=u?u.params:{},d=u?u.pathname:"/",m=u?u.pathnameBase:"/",x=u&&u.route;{let I=x&&x.path||"";WS(d,!x||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let y=Jl(),b;if(e){let I=typeof e=="string"?nc(e):e;kr(m==="/"||I.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${I.pathname}" was given in the \`location\` prop.`),b=I}else b=y;let E=b.pathname||"/",w=E;if(m!=="/"){let I=m.replace(/^\//,"").split("/");w="/"+E.replace(/^\//,"").split("/").slice(I.length).join("/")}let T=LS(t,{pathname:w});Da(x||T!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Da(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let R=PR(T&&T.map(I=>Object.assign({},I,{params:Object.assign({},f,I.params),pathname:Ai([m,i.encodeLocation?i.encodeLocation(I.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?m:Ai([m,i.encodeLocation?i.encodeLocation(I.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathnameBase])})),o,r,n,a);return e&&R?re.createElement(O0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},R):R}function DR(){let t=UR(),e=TR(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=re.createElement(re.Fragment,null,re.createElement("p",null," Hey developer "),re.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",re.createElement("code",{style:i},"ErrorBoundary")," or"," ",re.createElement("code",{style:i},"errorElement")," prop on your route.")),re.createElement(re.Fragment,null,re.createElement("h2",null,"Unexpected Application Error!"),re.createElement("h3",{style:{fontStyle:"italic"}},e),r?re.createElement("pre",{style:a},r):null,o)}var OR=re.createElement(DR,null),FR=class extends re.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?re.createElement(Qs.Provider,{value:this.props.routeContext},re.createElement(ov.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function MR({routeContext:t,match:e,children:r}){let n=re.useContext(Au);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),re.createElement(Qs.Provider,{value:t},r)}function PR(t,e=[],r=null,n=null,a=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,o=r?.errors;if(o!=null){let m=i.findIndex(x=>x.route.id&&o?.[x.route.id]!==void 0);kr(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,m+1))}let u=!1,f=-1;if(r)for(let m=0;m<i.length;m++){let x=i[m];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(f=m),x.route.id){let{loaderData:y,errors:b}=r,E=x.route.loader&&!y.hasOwnProperty(x.route.id)&&(!b||b[x.route.id]===void 0);if(x.route.lazy||E){u=!0,f>=0?i=i.slice(0,f+1):i=[i[0]];break}}}let d=r&&n?(m,x)=>{n(m,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:SR(r.matches),errorInfo:x})}:void 0;return i.reduceRight((m,x,y)=>{let b,E=!1,w=null,T=null;r&&(b=o&&x.route.id?o[x.route.id]:void 0,w=x.route.errorElement||OR,u&&(f<0&&y===0?(WS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),E=!0,T=null):f===y&&(E=!0,T=x.route.hydrateFallbackElement||null)));let R=e.concat(i.slice(0,y+1)),I=()=>{let C;return b?C=w:E?C=T:x.route.Component?C=re.createElement(x.route.Component,null):x.route.element?C=x.route.element:C=m,re.createElement(MR,{match:x,routeContext:{outlet:m,matches:R,isDataRoute:r!=null},children:C})};return r&&(x.route.ErrorBoundary||x.route.errorElement||y===0)?re.createElement(FR,{location:r.location,revalidation:r.revalidation,component:w,error:b,children:I(),routeContext:{outlet:null,matches:R,isDataRoute:!0},onError:d}):I()},null)}function cv(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jR(t){let e=re.useContext(Au);return kr(e,cv(t)),e}function LR(t){let e=re.useContext(Xm);return kr(e,cv(t)),e}function BR(t){let e=re.useContext(Qs);return kr(e,cv(t)),e}function uv(t){let e=BR(t),r=e.matches[e.matches.length-1];return kr(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function VR(){return uv("useRouteId")}function UR(){let t=re.useContext(ov),e=LR("useRouteError"),r=uv("useRouteError");return t!==void 0?t:e.errors?.[r]}function zR(){let{router:t}=jR("useNavigate"),e=uv("useNavigate"),r=re.useRef(!1);return GS(()=>{r.current=!0}),re.useCallback(async(a,i={})=>{Da(r.current,HS),r.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...i}))},[t,e])}var jb={};function WS(t,e,r){!e&&!jb[t]&&(jb[t]=!0,Da(!1,r))}re.memo(HR);function HR({routes:t,future:e,state:r,unstable_onError:n}){return qS(t,void 0,r,n,e)}function Rd({to:t,replace:e,state:r,relative:n}){kr(ku(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=re.useContext(ns);Da(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=re.useContext(Qs),{pathname:o}=Jl(),u=F0(),f=lv(t,iv(i),o,n==="path"),d=JSON.stringify(f);return re.useEffect(()=>{u(JSON.parse(d),{replace:e,state:r,relative:n})},[u,d,n,e,r]),null}function Uf(t){kr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function GR({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:i=!1,unstable_useTransitions:o}){kr(!ku(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),f=re.useMemo(()=>({basename:u,navigator:a,static:i,unstable_useTransitions:o,future:{}}),[u,a,i,o]);typeof r=="string"&&(r=nc(r));let{pathname:d="/",search:m="",hash:x="",state:y=null,key:b="default"}=r,E=re.useMemo(()=>{let w=Ri(d,u);return w==null?null:{location:{pathname:w,search:m,hash:x,state:y,key:b},navigationType:n}},[u,d,m,x,y,b,n]);return Da(E!=null,`<Router basename="${u}"> is not able to match the URL "${d}${m}${x}" because it does not start with the basename, so the <Router> won't render anything.`),E==null?null:re.createElement(ns.Provider,{value:f},re.createElement(O0.Provider,{children:e,value:E}))}function qR({children:t,location:e}){return IR(hx(t),e)}function hx(t,e=[]){let r=[];return re.Children.forEach(t,(n,a)=>{if(!re.isValidElement(n))return;let i=[...e,a];if(n.type===re.Fragment){r.push.apply(r,hx(n.props.children,i));return}kr(n.type===Uf,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),kr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=hx(n.props.children,i)),r.push(o)}),r}var Qd="get",Jd="application/x-www-form-urlencoded";function Ym(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function WR(t){return Ym(t)&&t.tagName.toLowerCase()==="button"}function XR(t){return Ym(t)&&t.tagName.toLowerCase()==="form"}function YR(t){return Ym(t)&&t.tagName.toLowerCase()==="input"}function $R(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function KR(t,e){return t.button===0&&(!e||e==="_self")&&!$R(t)}var Id=null;function QR(){if(Id===null)try{new FormData(document.createElement("form"),0),Id=!1}catch{Id=!0}return Id}var JR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function D1(t){return t!=null&&!JR.has(t)?(Da(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Jd}"`),null):t}function ZR(t,e){let r,n,a,i,o;if(XR(t)){let u=t.getAttribute("action");n=u?Ri(u,e):null,r=t.getAttribute("method")||Qd,a=D1(t.getAttribute("enctype"))||Jd,i=new FormData(t)}else if(WR(t)||YR(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||u.getAttribute("action");if(n=f?Ri(f,e):null,r=t.getAttribute("formmethod")||u.getAttribute("method")||Qd,a=D1(t.getAttribute("formenctype"))||D1(u.getAttribute("enctype"))||Jd,i=new FormData(u,t),!QR()){let{name:d,type:m,value:x}=t;if(m==="image"){let y=d?`${d}.`:"";i.append(`${y}x`,"0"),i.append(`${y}y`,"0")}else d&&i.append(d,x)}}else{if(Ym(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Qd,n=null,a=Jd,o=t}return i&&a==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function fv(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function e5(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&Ri(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function t5(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function r5(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function n5(t,e,r){let n=await Promise.all(t.map(async a=>{let i=e.routes[a.route.id];if(i){let o=await t5(i,r);return o.links?o.links():[]}return[]}));return l5(n.flat(1).filter(r5).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Lb(t,e,r,n,a,i){let o=(f,d)=>r[d]?f.route.id!==r[d].route.id:!0,u=(f,d)=>r[d].pathname!==f.pathname||r[d].route.path?.endsWith("*")&&r[d].params["*"]!==f.params["*"];return i==="assets"?e.filter((f,d)=>o(f,d)||u(f,d)):i==="data"?e.filter((f,d)=>{let m=n.routes[f.route.id];if(!m||!m.hasLoader)return!1;if(o(f,d)||u(f,d))return!0;if(f.route.shouldRevalidate){let x=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function a5(t,e,{includeHydrateFallback:r}={}){return s5(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function s5(t){return[...new Set(t)]}function i5(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function l5(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let i=JSON.stringify(i5(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}function XS(){let t=re.useContext(Au);return fv(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function o5(){let t=re.useContext(Xm);return fv(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var hv=re.createContext(void 0);hv.displayName="FrameworkContext";function YS(){let t=re.useContext(hv);return fv(t,"You must render this element inside a <HydratedRouter> element"),t}function c5(t,e){let r=re.useContext(hv),[n,a]=re.useState(!1),[i,o]=re.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:d,onMouseLeave:m,onTouchStart:x}=e,y=re.useRef(null);re.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let w=R=>{R.forEach(I=>{o(I.isIntersecting)})},T=new IntersectionObserver(w,{threshold:.5});return y.current&&T.observe(y.current),()=>{T.disconnect()}}},[t]),re.useEffect(()=>{if(n){let w=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(w)}}},[n]);let b=()=>{a(!0)},E=()=>{a(!1),o(!1)};return r?t!=="intent"?[i,y,{}]:[i,y,{onFocus:jf(u,b),onBlur:jf(f,E),onMouseEnter:jf(d,b),onMouseLeave:jf(m,E),onTouchStart:jf(x,b)}]:[!1,y,{}]}function jf(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function u5({page:t,...e}){let{router:r}=XS(),n=re.useMemo(()=>LS(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?re.createElement(h5,{page:t,matches:n,...e}):null}function f5(t){let{manifest:e,routeModules:r}=YS(),[n,a]=re.useState([]);return re.useEffect(()=>{let i=!1;return n5(t,e,r).then(o=>{i||a(o)}),()=>{i=!0}},[t,e,r]),n}function h5({page:t,matches:e,...r}){let n=Jl(),{manifest:a,routeModules:i}=YS(),{basename:o}=XS(),{loaderData:u,matches:f}=o5(),d=re.useMemo(()=>Lb(t,e,f,a,n,"data"),[t,e,f,a,n]),m=re.useMemo(()=>Lb(t,e,f,a,n,"assets"),[t,e,f,a,n]),x=re.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let E=new Set,w=!1;if(e.forEach(R=>{let I=a.routes[R.route.id];!I||!I.hasLoader||(!d.some(C=>C.route.id===R.route.id)&&R.route.id in u&&i[R.route.id]?.shouldRevalidate||I.hasClientLoader?w=!0:E.add(R.route.id))}),E.size===0)return[];let T=e5(t,o,"data");return w&&E.size>0&&T.searchParams.set("_routes",e.filter(R=>E.has(R.route.id)).map(R=>R.route.id).join(",")),[T.pathname+T.search]},[o,u,n,a,d,e,t,i]),y=re.useMemo(()=>a5(m,a),[m,a]),b=f5(m);return re.createElement(re.Fragment,null,x.map(E=>re.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...r})),y.map(E=>re.createElement("link",{key:E,rel:"modulepreload",href:E,...r})),b.map(({key:E,link:w})=>re.createElement("link",{key:E,nonce:r.nonce,...w})))}function d5(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var $S=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{$S&&(window.__reactRouterVersion="7.10.1")}catch{}function m5({basename:t,children:e,unstable_useTransitions:r,window:n}){let a=re.useRef();a.current==null&&(a.current=eR({window:n,v5Compat:!0}));let i=a.current,[o,u]=re.useState({action:i.action,location:i.location}),f=re.useCallback(d=>{r===!1?u(d):re.startTransition(()=>u(d))},[r]);return re.useLayoutEffect(()=>i.listen(f),[i,f]),re.createElement(GR,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:r===!0})}var KS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,P0=re.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:o,state:u,target:f,to:d,preventScrollReset:m,viewTransition:x,...y},b){let{basename:E,unstable_useTransitions:w}=re.useContext(ns),T=typeof d=="string"&&KS.test(d),R,I=!1;if(typeof d=="string"&&T&&(R=d,$S))try{let M=new URL(window.location.href),F=d.startsWith("//")?new URL(M.protocol+d):new URL(d),P=Ri(F.pathname,E);F.origin===M.origin&&P!=null?d=P+F.search+F.hash:I=!0}catch{Da(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=NR(d,{relative:a}),[W,U,B]=c5(n,y),A=v5(d,{replace:o,state:u,target:f,preventScrollReset:m,relative:a,viewTransition:x,unstable_useTransitions:w});function D(M){e&&e(M),M.defaultPrevented||A(M)}let N=re.createElement("a",{...y,...B,href:R||C,onClick:I||i?e:D,ref:d5(b,U),target:f,"data-discover":!T&&r==="render"?"true":void 0});return W&&!T?re.createElement(re.Fragment,null,N,re.createElement(u5,{page:C})):N});P0.displayName="Link";var p5=re.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:o,viewTransition:u,children:f,...d},m){let x=M0(o,{relative:d.relative}),y=Jl(),b=re.useContext(Xm),{navigator:E,basename:w}=re.useContext(ns),T=b!=null&&E5(x)&&u===!0,R=E.encodeLocation?E.encodeLocation(x).pathname:x.pathname,I=y.pathname,C=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;r||(I=I.toLowerCase(),C=C?C.toLowerCase():null,R=R.toLowerCase()),C&&w&&(C=Ri(C,w)||C);const W=R!=="/"&&R.endsWith("/")?R.length-1:R.length;let U=I===R||!a&&I.startsWith(R)&&I.charAt(W)==="/",B=C!=null&&(C===R||!a&&C.startsWith(R)&&C.charAt(R.length)==="/"),A={isActive:U,isPending:B,isTransitioning:T},D=U?e:void 0,N;typeof n=="function"?N=n(A):N=[n,U?"active":null,B?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let M=typeof i=="function"?i(A):i;return re.createElement(P0,{...d,"aria-current":D,className:N,ref:m,style:M,to:o,viewTransition:u},typeof f=="function"?f(A):f)});p5.displayName="NavLink";var g5=re.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:i,method:o=Qd,action:u,onSubmit:f,relative:d,preventScrollReset:m,viewTransition:x,...y},b)=>{let{unstable_useTransitions:E}=re.useContext(ns),w=w5(),T=b5(u,{relative:d}),R=o.toLowerCase()==="get"?"get":"post",I=typeof u=="string"&&KS.test(u),C=W=>{if(f&&f(W),W.defaultPrevented)return;W.preventDefault();let U=W.nativeEvent.submitter,B=U?.getAttribute("formmethod")||o,A=()=>w(U||W.currentTarget,{fetcherKey:e,method:B,navigate:r,replace:a,state:i,relative:d,preventScrollReset:m,viewTransition:x});E&&r!==!1?re.startTransition(()=>A()):A()};return re.createElement("form",{ref:b,method:R,action:T,onSubmit:n?f:C,...y,"data-discover":!I&&t==="render"?"true":void 0})});g5.displayName="Form";function x5(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function QS(t){let e=re.useContext(Au);return kr(e,x5(t)),e}function v5(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:o,unstable_useTransitions:u}={}){let f=F0(),d=Jl(),m=M0(t,{relative:i});return re.useCallback(x=>{if(KR(x,e)){x.preventDefault();let y=r!==void 0?r:c0(d)===c0(m),b=()=>f(t,{replace:y,state:n,preventScrollReset:a,relative:i,viewTransition:o});u?re.startTransition(()=>b()):b()}},[d,f,m,r,n,e,t,a,i,o,u])}var y5=0,_5=()=>`__${String(++y5)}__`;function w5(){let{router:t}=QS("useSubmit"),{basename:e}=re.useContext(ns),r=VR(),n=t.fetch,a=t.navigate;return re.useCallback(async(i,o={})=>{let{action:u,method:f,encType:d,formData:m,body:x}=ZR(i,e);if(o.navigate===!1){let y=o.fetcherKey||_5();await n(y,r,o.action||u,{preventScrollReset:o.preventScrollReset,formData:m,body:x,formMethod:o.method||f,formEncType:o.encType||d,flushSync:o.flushSync})}else await a(o.action||u,{preventScrollReset:o.preventScrollReset,formData:m,body:x,formMethod:o.method||f,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[n,a,e,r])}function b5(t,{relative:e}={}){let{basename:r}=re.useContext(ns),n=re.useContext(Qs);kr(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...M0(t||".",{relative:e})},o=Jl();if(t==null){i.search=o.search;let u=new URLSearchParams(i.search),f=u.getAll("index");if(f.some(m=>m==="")){u.delete("index"),f.filter(x=>x).forEach(x=>u.append("index",x));let m=u.toString();i.search=m?`?${m}`:""}}return(!t||t===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:Ai([r,i.pathname])),c0(i)}function E5(t,{relative:e}={}){let r=re.useContext(zS);kr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=QS("useViewTransitionState"),a=M0(t,{relative:e});if(!r.isTransitioning)return!1;let i=Ri(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Ri(r.nextLocation.pathname,n)||r.nextLocation.pathname;return cm(a.pathname,o)!=null||cm(a.pathname,i)!=null}const T5=()=>{};var Bb={};const JS=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},S5=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const i=t[r++];e[n++]=String.fromCharCode((a&31)<<6|i&63)}else if(a>239&&a<365){const i=t[r++],o=t[r++],u=t[r++],f=((a&7)<<18|(i&63)<<12|(o&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(i&63)<<6|o&63)}}return e.join("")},ZS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const i=t[a],o=a+1<t.length,u=o?t[a+1]:0,f=a+2<t.length,d=f?t[a+2]:0,m=i>>2,x=(i&3)<<4|u>>4;let y=(u&15)<<2|d>>6,b=d&63;f||(b=64,o||(y=64)),n.push(r[m],r[x],r[y],r[b])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(JS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):S5(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const i=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const d=a<t.length?r[t.charAt(a)]:64;++a;const x=a<t.length?r[t.charAt(a)]:64;if(++a,i==null||u==null||d==null||x==null)throw new A5;const y=i<<2|u>>4;if(n.push(y),d!==64){const b=u<<4&240|d>>2;if(n.push(b),x!==64){const E=d<<6&192|x;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class A5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const k5=function(t){const e=JS(t);return ZS.encodeByteArray(e,!0)},um=function(t){return k5(t).replace(/\./g,"")},e4=function(t){try{return ZS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function C5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const N5=()=>C5().__FIREBASE_DEFAULTS__,R5=()=>{if(typeof process>"u"||typeof Bb>"u")return;const t=Bb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},I5=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&e4(t[1]);return e&&JSON.parse(e)},$m=()=>{try{return T5()||N5()||R5()||I5()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},t4=t=>$m()?.emulatorHosts?.[t],D5=t=>{const e=t4(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},r4=()=>$m()?.config,n4=t=>$m()?.[`_${t}`];class O5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function Cu(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function a4(t){return(await fetch(t,{credentials:"include"})).ok}function F5(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[um(JSON.stringify(r)),um(JSON.stringify(o)),""].join(".")}const $f={};function M5(){const t={prod:[],emulator:[]};for(const e of Object.keys($f))$f[e]?t.emulator.push(e):t.prod.push(e);return t}function P5(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Vb=!1;function s4(t,e){if(typeof window>"u"||typeof document>"u"||!Cu(window.location.host)||$f[t]===e||$f[t]||Vb)return;$f[t]=e;function r(y){return`__firebase__banner__${y}`}const n="__firebase__banner",i=M5().prod.length>0;function o(){const y=document.getElementById(n);y&&y.remove()}function u(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function f(y,b){y.setAttribute("width","24"),y.setAttribute("id",b),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function d(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{Vb=!0,o()},y}function m(y,b){y.setAttribute("id",b),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function x(){const y=P5(n),b=r("text"),E=document.getElementById(b)||document.createElement("span"),w=r("learnmore"),T=document.getElementById(w)||document.createElement("a"),R=r("preprendIcon"),I=document.getElementById(R)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const C=y.element;u(C),m(T,w);const W=d();f(I,R),C.append(I,E,T,W),document.body.appendChild(C)}i?(E.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}function Gn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function j5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Gn())}function L5(){const t=$m()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function B5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function V5(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function U5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function z5(){const t=Gn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function H5(){return!L5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function G5(){try{return typeof indexedDB=="object"}catch{return!1}}function q5(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(r){e(r)}})}const W5="FirebaseError";class Li extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=W5,Object.setPrototypeOf(this,Li.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,j0.prototype.create)}}class j0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,i=this.errors[e],o=i?X5(i,n):"Error",u=`${this.serviceName}: ${o} (${a}).`;return new Li(a,u,n)}}function X5(t,e){return t.replace(Y5,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const Y5=/\{\$([^}]+)}/g;function $5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Go(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const i=t[a],o=e[a];if(Ub(i)&&Ub(o)){if(!Go(i,o))return!1}else if(i!==o)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function Ub(t){return t!==null&&typeof t=="object"}function L0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function K5(t,e){const r=new Q5(t,e);return r.subscribe.bind(r)}class Q5{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");J5(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=O1),a.error===void 0&&(a.error=O1),a.complete===void 0&&(a.complete=O1);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function J5(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function O1(){}function un(t){return t&&t._delegate?t._delegate:t}class qo{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Do="[DEFAULT]";class Z5{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new O5;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(tI(e))try{this.getOrInitializeService({instanceIdentifier:Do})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:a});n.resolve(i)}catch{}}}}clearInstance(e=Do){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Do){return this.instances.has(e)}getOptions(e=Do){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(i);n===u&&o.resolve(a)}return a}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const i=this.instances.get(n);return i&&e(i,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:eI(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Do){return this.component?this.component.multipleInstances?e:Do:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function eI(t){return t===Do?void 0:t}function tI(t){return t.instantiationMode==="EAGER"}class rI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Z5(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var Ft;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ft||(Ft={}));const nI={debug:Ft.DEBUG,verbose:Ft.VERBOSE,info:Ft.INFO,warn:Ft.WARN,error:Ft.ERROR,silent:Ft.SILENT},aI=Ft.INFO,sI={[Ft.DEBUG]:"log",[Ft.VERBOSE]:"log",[Ft.INFO]:"info",[Ft.WARN]:"warn",[Ft.ERROR]:"error"},iI=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=sI[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dv{constructor(e){this.name=e,this._logLevel=aI,this._logHandler=iI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ft))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?nI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ft.DEBUG,...e),this._logHandler(this,Ft.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ft.VERBOSE,...e),this._logHandler(this,Ft.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ft.INFO,...e),this._logHandler(this,Ft.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ft.WARN,...e),this._logHandler(this,Ft.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ft.ERROR,...e),this._logHandler(this,Ft.ERROR,...e)}}const lI=(t,e)=>e.some(r=>t instanceof r);let zb,Hb;function oI(){return zb||(zb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function cI(){return Hb||(Hb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const i4=new WeakMap,dx=new WeakMap,l4=new WeakMap,F1=new WeakMap,mv=new WeakMap;function uI(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(Il(t.result)),a()},o=()=>{n(t.error),a()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&i4.set(r,t)}).catch(()=>{}),mv.set(e,t),e}function fI(t){if(dx.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),a()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});dx.set(t,e)}let mx={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return dx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||l4.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Il(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function hI(t){mx=t(mx)}function dI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(M1(this),e,...r);return l4.set(n,e.sort?e.sort():[e]),Il(n)}:cI().includes(t)?function(...e){return t.apply(M1(this),e),Il(i4.get(this))}:function(...e){return Il(t.apply(M1(this),e))}}function mI(t){return typeof t=="function"?dI(t):(t instanceof IDBTransaction&&fI(t),lI(t,oI())?new Proxy(t,mx):t)}function Il(t){if(t instanceof IDBRequest)return uI(t);if(F1.has(t))return F1.get(t);const e=mI(t);return e!==t&&(F1.set(t,e),mv.set(e,t)),e}const M1=t=>mv.get(t);function pI(t,e,{blocked:r,upgrade:n,blocking:a,terminated:i}={}){const o=indexedDB.open(t,e),u=Il(o);return n&&o.addEventListener("upgradeneeded",f=>{n(Il(o.result),f.oldVersion,f.newVersion,Il(o.transaction),f)}),r&&o.addEventListener("blocked",f=>r(f.oldVersion,f.newVersion,f)),u.then(f=>{i&&f.addEventListener("close",()=>i()),a&&f.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const gI=["get","getKey","getAll","getAllKeys","count"],xI=["put","add","delete","clear"],P1=new Map;function Gb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(P1.get(e))return P1.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=xI.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||gI.includes(r)))return;const i=async function(o,...u){const f=this.transaction(o,a?"readwrite":"readonly");let d=f.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),a&&f.done]))[0]};return P1.set(e,i),i}hI(t=>({...t,get:(e,r,n)=>Gb(e,r)||t.get(e,r,n),has:(e,r)=>!!Gb(e,r)||t.has(e,r)}));class vI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(yI(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function yI(t){return t.getComponent()?.type==="VERSION"}const px="@firebase/app",qb="0.14.6";const Ii=new dv("@firebase/app"),_I="@firebase/app-compat",wI="@firebase/analytics-compat",bI="@firebase/analytics",EI="@firebase/app-check-compat",TI="@firebase/app-check",SI="@firebase/auth",AI="@firebase/auth-compat",kI="@firebase/database",CI="@firebase/data-connect",NI="@firebase/database-compat",RI="@firebase/functions",II="@firebase/functions-compat",DI="@firebase/installations",OI="@firebase/installations-compat",FI="@firebase/messaging",MI="@firebase/messaging-compat",PI="@firebase/performance",jI="@firebase/performance-compat",LI="@firebase/remote-config",BI="@firebase/remote-config-compat",VI="@firebase/storage",UI="@firebase/storage-compat",zI="@firebase/firestore",HI="@firebase/ai",GI="@firebase/firestore-compat",qI="firebase",WI="12.6.0";const gx="[DEFAULT]",XI={[px]:"fire-core",[_I]:"fire-core-compat",[bI]:"fire-analytics",[wI]:"fire-analytics-compat",[TI]:"fire-app-check",[EI]:"fire-app-check-compat",[SI]:"fire-auth",[AI]:"fire-auth-compat",[kI]:"fire-rtdb",[CI]:"fire-data-connect",[NI]:"fire-rtdb-compat",[RI]:"fire-fn",[II]:"fire-fn-compat",[DI]:"fire-iid",[OI]:"fire-iid-compat",[FI]:"fire-fcm",[MI]:"fire-fcm-compat",[PI]:"fire-perf",[jI]:"fire-perf-compat",[LI]:"fire-rc",[BI]:"fire-rc-compat",[VI]:"fire-gcs",[UI]:"fire-gcs-compat",[zI]:"fire-fst",[GI]:"fire-fst-compat",[HI]:"fire-vertex","fire-js":"fire-js",[qI]:"fire-js-all"};const fm=new Map,YI=new Map,xx=new Map;function Wb(t,e){try{t.container.addComponent(e)}catch(r){Ii.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function pu(t){const e=t.name;if(xx.has(e))return Ii.debug(`There were multiple attempts to register component ${e}.`),!1;xx.set(e,t);for(const r of fm.values())Wb(r,t);for(const r of YI.values())Wb(r,t);return!0}function pv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ys(t){return t==null?!1:t.settings!==void 0}const $I={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Dl=new j0("app","Firebase",$I);class KI{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new qo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Dl.create("app-deleted",{appName:this._name})}}const Nu=WI;function o4(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:gx,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw Dl.create("bad-app-name",{appName:String(a)});if(r||(r=r4()),!r)throw Dl.create("no-options");const i=fm.get(a);if(i){if(Go(r,i.options)&&Go(n,i.config))return i;throw Dl.create("duplicate-app",{appName:a})}const o=new rI(a);for(const f of xx.values())o.addComponent(f);const u=new KI(r,n,o);return fm.set(a,u),u}function c4(t=gx){const e=fm.get(t);if(!e&&t===gx&&r4())return o4();if(!e)throw Dl.create("no-app",{appName:t});return e}function Ol(t,e,r){let n=XI[t]??t;r&&(n+=`-${r}`);const a=n.match(/\s|\//),i=e.match(/\s|\//);if(a||i){const o=[`Unable to register library "${n}" with version "${e}":`];a&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ii.warn(o.join(" "));return}pu(new qo(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const QI="firebase-heartbeat-database",JI=1,u0="firebase-heartbeat-store";let j1=null;function u4(){return j1||(j1=pI(QI,JI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(u0)}catch(r){console.warn(r)}}}}).catch(t=>{throw Dl.create("idb-open",{originalErrorMessage:t.message})})),j1}async function ZI(t){try{const r=(await u4()).transaction(u0),n=await r.objectStore(u0).get(f4(t));return await r.done,n}catch(e){if(e instanceof Li)Ii.warn(e.message);else{const r=Dl.create("idb-get",{originalErrorMessage:e?.message});Ii.warn(r.message)}}}async function Xb(t,e){try{const n=(await u4()).transaction(u0,"readwrite");await n.objectStore(u0).put(e,f4(t)),await n.done}catch(r){if(r instanceof Li)Ii.warn(r.message);else{const n=Dl.create("idb-set",{originalErrorMessage:r?.message});Ii.warn(n.message)}}}function f4(t){return`${t.name}!${t.options.appId}`}const eD=1024,tD=30;class rD{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new aD(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Yb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(a=>a.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>tD){const a=sD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ii.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Yb(),{heartbeatsToSend:r,unsentEntries:n}=nD(this._heartbeatsCache.heartbeats),a=um(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Ii.warn(e),""}}}function Yb(){return new Date().toISOString().substring(0,10)}function nD(t,e=eD){const r=[];let n=t.slice();for(const a of t){const i=r.find(o=>o.agent===a.agent);if(i){if(i.dates.push(a.date),$b(r)>e){i.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),$b(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class aD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return G5()?q5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await ZI(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Xb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Xb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function $b(t){return um(JSON.stringify({version:2,heartbeats:t})).length}function sD(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}function iD(t){pu(new qo("platform-logger",e=>new vI(e),"PRIVATE")),pu(new qo("heartbeat",e=>new rD(e),"PRIVATE")),Ol(px,qb,t),Ol(px,qb,"esm2020"),Ol("fire-js","")}iD("");var Kb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Fl,h4;(function(){var t;function e(A,D){function N(){}N.prototype=D.prototype,A.F=D.prototype,A.prototype=new N,A.prototype.constructor=A,A.D=function(M,F,P){for(var V=Array(arguments.length-2),Ee=2;Ee<arguments.length;Ee++)V[Ee-2]=arguments[Ee];return D.prototype[F].apply(M,V)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(A,D,N){N||(N=0);const M=Array(16);if(typeof D=="string")for(var F=0;F<16;++F)M[F]=D.charCodeAt(N++)|D.charCodeAt(N++)<<8|D.charCodeAt(N++)<<16|D.charCodeAt(N++)<<24;else for(F=0;F<16;++F)M[F]=D[N++]|D[N++]<<8|D[N++]<<16|D[N++]<<24;D=A.g[0],N=A.g[1],F=A.g[2];let P=A.g[3],V;V=D+(P^N&(F^P))+M[0]+3614090360&4294967295,D=N+(V<<7&4294967295|V>>>25),V=P+(F^D&(N^F))+M[1]+3905402710&4294967295,P=D+(V<<12&4294967295|V>>>20),V=F+(N^P&(D^N))+M[2]+606105819&4294967295,F=P+(V<<17&4294967295|V>>>15),V=N+(D^F&(P^D))+M[3]+3250441966&4294967295,N=F+(V<<22&4294967295|V>>>10),V=D+(P^N&(F^P))+M[4]+4118548399&4294967295,D=N+(V<<7&4294967295|V>>>25),V=P+(F^D&(N^F))+M[5]+1200080426&4294967295,P=D+(V<<12&4294967295|V>>>20),V=F+(N^P&(D^N))+M[6]+2821735955&4294967295,F=P+(V<<17&4294967295|V>>>15),V=N+(D^F&(P^D))+M[7]+4249261313&4294967295,N=F+(V<<22&4294967295|V>>>10),V=D+(P^N&(F^P))+M[8]+1770035416&4294967295,D=N+(V<<7&4294967295|V>>>25),V=P+(F^D&(N^F))+M[9]+2336552879&4294967295,P=D+(V<<12&4294967295|V>>>20),V=F+(N^P&(D^N))+M[10]+4294925233&4294967295,F=P+(V<<17&4294967295|V>>>15),V=N+(D^F&(P^D))+M[11]+2304563134&4294967295,N=F+(V<<22&4294967295|V>>>10),V=D+(P^N&(F^P))+M[12]+1804603682&4294967295,D=N+(V<<7&4294967295|V>>>25),V=P+(F^D&(N^F))+M[13]+4254626195&4294967295,P=D+(V<<12&4294967295|V>>>20),V=F+(N^P&(D^N))+M[14]+2792965006&4294967295,F=P+(V<<17&4294967295|V>>>15),V=N+(D^F&(P^D))+M[15]+1236535329&4294967295,N=F+(V<<22&4294967295|V>>>10),V=D+(F^P&(N^F))+M[1]+4129170786&4294967295,D=N+(V<<5&4294967295|V>>>27),V=P+(N^F&(D^N))+M[6]+3225465664&4294967295,P=D+(V<<9&4294967295|V>>>23),V=F+(D^N&(P^D))+M[11]+643717713&4294967295,F=P+(V<<14&4294967295|V>>>18),V=N+(P^D&(F^P))+M[0]+3921069994&4294967295,N=F+(V<<20&4294967295|V>>>12),V=D+(F^P&(N^F))+M[5]+3593408605&4294967295,D=N+(V<<5&4294967295|V>>>27),V=P+(N^F&(D^N))+M[10]+38016083&4294967295,P=D+(V<<9&4294967295|V>>>23),V=F+(D^N&(P^D))+M[15]+3634488961&4294967295,F=P+(V<<14&4294967295|V>>>18),V=N+(P^D&(F^P))+M[4]+3889429448&4294967295,N=F+(V<<20&4294967295|V>>>12),V=D+(F^P&(N^F))+M[9]+568446438&4294967295,D=N+(V<<5&4294967295|V>>>27),V=P+(N^F&(D^N))+M[14]+3275163606&4294967295,P=D+(V<<9&4294967295|V>>>23),V=F+(D^N&(P^D))+M[3]+4107603335&4294967295,F=P+(V<<14&4294967295|V>>>18),V=N+(P^D&(F^P))+M[8]+1163531501&4294967295,N=F+(V<<20&4294967295|V>>>12),V=D+(F^P&(N^F))+M[13]+2850285829&4294967295,D=N+(V<<5&4294967295|V>>>27),V=P+(N^F&(D^N))+M[2]+4243563512&4294967295,P=D+(V<<9&4294967295|V>>>23),V=F+(D^N&(P^D))+M[7]+1735328473&4294967295,F=P+(V<<14&4294967295|V>>>18),V=N+(P^D&(F^P))+M[12]+2368359562&4294967295,N=F+(V<<20&4294967295|V>>>12),V=D+(N^F^P)+M[5]+4294588738&4294967295,D=N+(V<<4&4294967295|V>>>28),V=P+(D^N^F)+M[8]+2272392833&4294967295,P=D+(V<<11&4294967295|V>>>21),V=F+(P^D^N)+M[11]+1839030562&4294967295,F=P+(V<<16&4294967295|V>>>16),V=N+(F^P^D)+M[14]+4259657740&4294967295,N=F+(V<<23&4294967295|V>>>9),V=D+(N^F^P)+M[1]+2763975236&4294967295,D=N+(V<<4&4294967295|V>>>28),V=P+(D^N^F)+M[4]+1272893353&4294967295,P=D+(V<<11&4294967295|V>>>21),V=F+(P^D^N)+M[7]+4139469664&4294967295,F=P+(V<<16&4294967295|V>>>16),V=N+(F^P^D)+M[10]+3200236656&4294967295,N=F+(V<<23&4294967295|V>>>9),V=D+(N^F^P)+M[13]+681279174&4294967295,D=N+(V<<4&4294967295|V>>>28),V=P+(D^N^F)+M[0]+3936430074&4294967295,P=D+(V<<11&4294967295|V>>>21),V=F+(P^D^N)+M[3]+3572445317&4294967295,F=P+(V<<16&4294967295|V>>>16),V=N+(F^P^D)+M[6]+76029189&4294967295,N=F+(V<<23&4294967295|V>>>9),V=D+(N^F^P)+M[9]+3654602809&4294967295,D=N+(V<<4&4294967295|V>>>28),V=P+(D^N^F)+M[12]+3873151461&4294967295,P=D+(V<<11&4294967295|V>>>21),V=F+(P^D^N)+M[15]+530742520&4294967295,F=P+(V<<16&4294967295|V>>>16),V=N+(F^P^D)+M[2]+3299628645&4294967295,N=F+(V<<23&4294967295|V>>>9),V=D+(F^(N|~P))+M[0]+4096336452&4294967295,D=N+(V<<6&4294967295|V>>>26),V=P+(N^(D|~F))+M[7]+1126891415&4294967295,P=D+(V<<10&4294967295|V>>>22),V=F+(D^(P|~N))+M[14]+2878612391&4294967295,F=P+(V<<15&4294967295|V>>>17),V=N+(P^(F|~D))+M[5]+4237533241&4294967295,N=F+(V<<21&4294967295|V>>>11),V=D+(F^(N|~P))+M[12]+1700485571&4294967295,D=N+(V<<6&4294967295|V>>>26),V=P+(N^(D|~F))+M[3]+2399980690&4294967295,P=D+(V<<10&4294967295|V>>>22),V=F+(D^(P|~N))+M[10]+4293915773&4294967295,F=P+(V<<15&4294967295|V>>>17),V=N+(P^(F|~D))+M[1]+2240044497&4294967295,N=F+(V<<21&4294967295|V>>>11),V=D+(F^(N|~P))+M[8]+1873313359&4294967295,D=N+(V<<6&4294967295|V>>>26),V=P+(N^(D|~F))+M[15]+4264355552&4294967295,P=D+(V<<10&4294967295|V>>>22),V=F+(D^(P|~N))+M[6]+2734768916&4294967295,F=P+(V<<15&4294967295|V>>>17),V=N+(P^(F|~D))+M[13]+1309151649&4294967295,N=F+(V<<21&4294967295|V>>>11),V=D+(F^(N|~P))+M[4]+4149444226&4294967295,D=N+(V<<6&4294967295|V>>>26),V=P+(N^(D|~F))+M[11]+3174756917&4294967295,P=D+(V<<10&4294967295|V>>>22),V=F+(D^(P|~N))+M[2]+718787259&4294967295,F=P+(V<<15&4294967295|V>>>17),V=N+(P^(F|~D))+M[9]+3951481745&4294967295,A.g[0]=A.g[0]+D&4294967295,A.g[1]=A.g[1]+(F+(V<<21&4294967295|V>>>11))&4294967295,A.g[2]=A.g[2]+F&4294967295,A.g[3]=A.g[3]+P&4294967295}n.prototype.v=function(A,D){D===void 0&&(D=A.length);const N=D-this.blockSize,M=this.C;let F=this.h,P=0;for(;P<D;){if(F==0)for(;P<=N;)a(this,A,P),P+=this.blockSize;if(typeof A=="string"){for(;P<D;)if(M[F++]=A.charCodeAt(P++),F==this.blockSize){a(this,M),F=0;break}}else for(;P<D;)if(M[F++]=A[P++],F==this.blockSize){a(this,M),F=0;break}}this.h=F,this.o+=D},n.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var D=1;D<A.length-8;++D)A[D]=0;D=this.o*8;for(var N=A.length-8;N<A.length;++N)A[N]=D&255,D/=256;for(this.v(A),A=Array(16),D=0,N=0;N<4;++N)for(let M=0;M<32;M+=8)A[D++]=this.g[N]>>>M&255;return A};function i(A,D){var N=u;return Object.prototype.hasOwnProperty.call(N,A)?N[A]:N[A]=D(A)}function o(A,D){this.h=D;const N=[];let M=!0;for(let F=A.length-1;F>=0;F--){const P=A[F]|0;M&&P==D||(N[F]=P,M=!1)}this.g=N}var u={};function f(A){return-128<=A&&A<128?i(A,function(D){return new o([D|0],D<0?-1:0)}):new o([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return x;if(A<0)return T(d(-A));const D=[];let N=1;for(let M=0;A>=N;M++)D[M]=A/N|0,N*=4294967296;return new o(D,0)}function m(A,D){if(A.length==0)throw Error("number format error: empty string");if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(A.charAt(0)=="-")return T(m(A.substring(1),D));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=d(Math.pow(D,8));let M=x;for(let P=0;P<A.length;P+=8){var F=Math.min(8,A.length-P);const V=parseInt(A.substring(P,P+F),D);F<8?(F=d(Math.pow(D,F)),M=M.j(F).add(d(V))):(M=M.j(N),M=M.add(d(V)))}return M}var x=f(0),y=f(1),b=f(16777216);t=o.prototype,t.m=function(){if(w(this))return-T(this).m();let A=0,D=1;for(let N=0;N<this.g.length;N++){const M=this.i(N);A+=(M>=0?M:4294967296+M)*D,D*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(E(this))return"0";if(w(this))return"-"+T(this).toString(A);const D=d(Math.pow(A,6));var N=this;let M="";for(;;){const F=W(N,D).g;N=R(N,F.j(D));let P=((N.g.length>0?N.g[0]:N.h)>>>0).toString(A);if(N=F,E(N))return P+M;for(;P.length<6;)P="0"+P;M=P+M}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function E(A){if(A.h!=0)return!1;for(let D=0;D<A.g.length;D++)if(A.g[D]!=0)return!1;return!0}function w(A){return A.h==-1}t.l=function(A){return A=R(this,A),w(A)?-1:E(A)?0:1};function T(A){const D=A.g.length,N=[];for(let M=0;M<D;M++)N[M]=~A.g[M];return new o(N,~A.h).add(y)}t.abs=function(){return w(this)?T(this):this},t.add=function(A){const D=Math.max(this.g.length,A.g.length),N=[];let M=0;for(let F=0;F<=D;F++){let P=M+(this.i(F)&65535)+(A.i(F)&65535),V=(P>>>16)+(this.i(F)>>>16)+(A.i(F)>>>16);M=V>>>16,P&=65535,V&=65535,N[F]=V<<16|P}return new o(N,N[N.length-1]&-2147483648?-1:0)};function R(A,D){return A.add(T(D))}t.j=function(A){if(E(this)||E(A))return x;if(w(this))return w(A)?T(this).j(T(A)):T(T(this).j(A));if(w(A))return T(this.j(T(A)));if(this.l(b)<0&&A.l(b)<0)return d(this.m()*A.m());const D=this.g.length+A.g.length,N=[];for(var M=0;M<2*D;M++)N[M]=0;for(M=0;M<this.g.length;M++)for(let F=0;F<A.g.length;F++){const P=this.i(M)>>>16,V=this.i(M)&65535,Ee=A.i(F)>>>16,we=A.i(F)&65535;N[2*M+2*F]+=V*we,I(N,2*M+2*F),N[2*M+2*F+1]+=P*we,I(N,2*M+2*F+1),N[2*M+2*F+1]+=V*Ee,I(N,2*M+2*F+1),N[2*M+2*F+2]+=P*Ee,I(N,2*M+2*F+2)}for(A=0;A<D;A++)N[A]=N[2*A+1]<<16|N[2*A];for(A=D;A<2*D;A++)N[A]=0;return new o(N,0)};function I(A,D){for(;(A[D]&65535)!=A[D];)A[D+1]+=A[D]>>>16,A[D]&=65535,D++}function C(A,D){this.g=A,this.h=D}function W(A,D){if(E(D))throw Error("division by zero");if(E(A))return new C(x,x);if(w(A))return D=W(T(A),D),new C(T(D.g),T(D.h));if(w(D))return D=W(A,T(D)),new C(T(D.g),D.h);if(A.g.length>30){if(w(A)||w(D))throw Error("slowDivide_ only works with positive integers.");for(var N=y,M=D;M.l(A)<=0;)N=U(N),M=U(M);var F=B(N,1),P=B(M,1);for(M=B(M,2),N=B(N,2);!E(M);){var V=P.add(M);V.l(A)<=0&&(F=F.add(N),P=V),M=B(M,1),N=B(N,1)}return D=R(A,F.j(D)),new C(F,D)}for(F=x;A.l(D)>=0;){for(N=Math.max(1,Math.floor(A.m()/D.m())),M=Math.ceil(Math.log(N)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),P=d(N),V=P.j(D);w(V)||V.l(A)>0;)N-=M,P=d(N),V=P.j(D);E(P)&&(P=y),F=F.add(P),A=R(A,V)}return new C(F,A)}t.B=function(A){return W(this,A).h},t.and=function(A){const D=Math.max(this.g.length,A.g.length),N=[];for(let M=0;M<D;M++)N[M]=this.i(M)&A.i(M);return new o(N,this.h&A.h)},t.or=function(A){const D=Math.max(this.g.length,A.g.length),N=[];for(let M=0;M<D;M++)N[M]=this.i(M)|A.i(M);return new o(N,this.h|A.h)},t.xor=function(A){const D=Math.max(this.g.length,A.g.length),N=[];for(let M=0;M<D;M++)N[M]=this.i(M)^A.i(M);return new o(N,this.h^A.h)};function U(A){const D=A.g.length+1,N=[];for(let M=0;M<D;M++)N[M]=A.i(M)<<1|A.i(M-1)>>>31;return new o(N,A.h)}function B(A,D){const N=D>>5;D%=32;const M=A.g.length-N,F=[];for(let P=0;P<M;P++)F[P]=D>0?A.i(P+N)>>>D|A.i(P+N+1)<<32-D:A.i(P+N);return new o(F,A.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,h4=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=m,Fl=o}).apply(typeof Kb<"u"?Kb:typeof self<"u"?self:typeof window<"u"?window:{});var Dd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var d4,zf,m4,Zd,vx,p4,g4,x4;(function(){var t,e=Object.defineProperty;function r(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Dd=="object"&&Dd];for(var S=0;S<g.length;++S){var O=g[S];if(O&&O.Math==Math)return O}throw Error("Cannot find global object")}var n=r(this);function a(g,S){if(S)e:{var O=n;g=g.split(".");for(var G=0;G<g.length-1;G++){var fe=g[G];if(!(fe in O))break e;O=O[fe]}g=g[g.length-1],G=O[g],S=S(G),S!=G&&S!=null&&e(O,g,{configurable:!0,writable:!0,value:S})}}a("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(g){return g||function(S){var O=[],G;for(G in S)Object.prototype.hasOwnProperty.call(S,G)&&O.push([G,S[G]]);return O}});var i=i||{},o=this||self;function u(g){var S=typeof g;return S=="object"&&g!=null||S=="function"}function f(g,S,O){return g.call.apply(g.bind,arguments)}function d(g,S,O){return d=f,d.apply(null,arguments)}function m(g,S){var O=Array.prototype.slice.call(arguments,1);return function(){var G=O.slice();return G.push.apply(G,arguments),g.apply(this,G)}}function x(g,S){function O(){}O.prototype=S.prototype,g.Z=S.prototype,g.prototype=new O,g.prototype.constructor=g,g.Ob=function(G,fe,_e){for(var He=Array(arguments.length-2),vt=2;vt<arguments.length;vt++)He[vt-2]=arguments[vt];return S.prototype[fe].apply(G,He)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function b(g){const S=g.length;if(S>0){const O=Array(S);for(let G=0;G<S;G++)O[G]=g[G];return O}return[]}function E(g,S){for(let G=1;G<arguments.length;G++){const fe=arguments[G];var O=typeof fe;if(O=O!="object"?O:fe?Array.isArray(fe)?"array":O:"null",O=="array"||O=="object"&&typeof fe.length=="number"){O=g.length||0;const _e=fe.length||0;g.length=O+_e;for(let He=0;He<_e;He++)g[O+He]=fe[He]}else g.push(fe)}}class w{constructor(S,O){this.i=S,this.j=O,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function T(g){o.setTimeout(()=>{throw g},0)}function R(){var g=A;let S=null;return g.g&&(S=g.g,g.g=g.g.next,g.g||(g.h=null),S.next=null),S}class I{constructor(){this.h=this.g=null}add(S,O){const G=C.get();G.set(S,O),this.h?this.h.next=G:this.g=G,this.h=G}}var C=new w(()=>new W,g=>g.reset());class W{constructor(){this.next=this.g=this.h=null}set(S,O){this.h=S,this.g=O,this.next=null}reset(){this.next=this.g=this.h=null}}let U,B=!1,A=new I,D=()=>{const g=Promise.resolve(void 0);U=()=>{g.then(N)}};function N(){for(var g;g=R();){try{g.h.call(g.g)}catch(O){T(O)}var S=C;S.j(g),S.h<100&&(S.h++,g.next=S.g,S.g=g)}B=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(g,S){this.type=g,this.g=this.target=S,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var P=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,S=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const O=()=>{};o.addEventListener("test",O,S),o.removeEventListener("test",O,S)}catch{}return g})();function V(g){return/^[\s\xa0]*$/.test(g)}function Ee(g,S){F.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,S)}x(Ee,F),Ee.prototype.init=function(g,S){const O=this.type=g.type,G=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=S,S=g.relatedTarget,S||(O=="mouseover"?S=g.fromElement:O=="mouseout"&&(S=g.toElement)),this.relatedTarget=S,G?(this.clientX=G.clientX!==void 0?G.clientX:G.pageX,this.clientY=G.clientY!==void 0?G.clientY:G.pageY,this.screenX=G.screenX||0,this.screenY=G.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&Ee.Z.h.call(this)},Ee.prototype.h=function(){Ee.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var we="closure_listenable_"+(Math.random()*1e6|0),ie=0;function ee(g,S,O,G,fe){this.listener=g,this.proxy=null,this.src=S,this.type=O,this.capture=!!G,this.ha=fe,this.key=++ie,this.da=this.fa=!1}function ye(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function ae(g,S,O){for(const G in g)S.call(O,g[G],G,g)}function Me(g,S){for(const O in g)S.call(void 0,g[O],O,g)}function Y(g){const S={};for(const O in g)S[O]=g[O];return S}const j="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function X(g,S){let O,G;for(let fe=1;fe<arguments.length;fe++){G=arguments[fe];for(O in G)g[O]=G[O];for(let _e=0;_e<j.length;_e++)O=j[_e],Object.prototype.hasOwnProperty.call(G,O)&&(g[O]=G[O])}}function J(g){this.src=g,this.g={},this.h=0}J.prototype.add=function(g,S,O,G,fe){const _e=g.toString();g=this.g[_e],g||(g=this.g[_e]=[],this.h++);const He=ue(g,S,G,fe);return He>-1?(S=g[He],O||(S.fa=!1)):(S=new ee(S,this.src,_e,!!G,fe),S.fa=O,g.push(S)),S};function ne(g,S){const O=S.type;if(O in g.g){var G=g.g[O],fe=Array.prototype.indexOf.call(G,S,void 0),_e;(_e=fe>=0)&&Array.prototype.splice.call(G,fe,1),_e&&(ye(S),g.g[O].length==0&&(delete g.g[O],g.h--))}}function ue(g,S,O,G){for(let fe=0;fe<g.length;++fe){const _e=g[fe];if(!_e.da&&_e.listener==S&&_e.capture==!!O&&_e.ha==G)return fe}return-1}var Te="closure_lm_"+(Math.random()*1e6|0),Re={};function Ce(g,S,O,G,fe){if(Array.isArray(S)){for(let _e=0;_e<S.length;_e++)Ce(g,S[_e],O,G,fe);return null}return O=Qe(O),g&&g[we]?g.J(S,O,u(G)?!!G.capture:!1,fe):Fe(g,S,O,!1,G,fe)}function Fe(g,S,O,G,fe,_e){if(!S)throw Error("Invalid event type");const He=u(fe)?!!fe.capture:!!fe;let vt=ht(g);if(vt||(g[Te]=vt=new J(g)),O=vt.add(S,O,G,He,_e),O.proxy)return O;if(G=st(),O.proxy=G,G.src=g,G.listener=O,g.addEventListener)P||(fe=He),fe===void 0&&(fe=!1),g.addEventListener(S.toString(),G,fe);else if(g.attachEvent)g.attachEvent(lt(S.toString()),G);else if(g.addListener&&g.removeListener)g.addListener(G);else throw Error("addEventListener and attachEvent are unavailable.");return O}function st(){function g(O){return S.call(g.src,g.listener,O)}const S=It;return g}function te(g,S,O,G,fe){if(Array.isArray(S))for(var _e=0;_e<S.length;_e++)te(g,S[_e],O,G,fe);else G=u(G)?!!G.capture:!!G,O=Qe(O),g&&g[we]?(g=g.i,_e=String(S).toString(),_e in g.g&&(S=g.g[_e],O=ue(S,O,G,fe),O>-1&&(ye(S[O]),Array.prototype.splice.call(S,O,1),S.length==0&&(delete g.g[_e],g.h--)))):g&&(g=ht(g))&&(S=g.g[S.toString()],g=-1,S&&(g=ue(S,O,G,fe)),(O=g>-1?S[g]:null)&&Ct(O))}function Ct(g){if(typeof g!="number"&&g&&!g.da){var S=g.src;if(S&&S[we])ne(S.i,g);else{var O=g.type,G=g.proxy;S.removeEventListener?S.removeEventListener(O,G,g.capture):S.detachEvent?S.detachEvent(lt(O),G):S.addListener&&S.removeListener&&S.removeListener(G),(O=ht(S))?(ne(O,g),O.h==0&&(O.src=null,S[Te]=null)):ye(g)}}}function lt(g){return g in Re?Re[g]:Re[g]="on"+g}function It(g,S){if(g.da)g=!0;else{S=new Ee(S,this);const O=g.listener,G=g.ha||g.src;g.fa&&Ct(g),g=O.call(G,S)}return g}function ht(g){return g=g[Te],g instanceof J?g:null}var le="__closure_events_fn_"+(Math.random()*1e9>>>0);function Qe(g){return typeof g=="function"?g:(g[le]||(g[le]=function(S){return g.handleEvent(S)}),g[le])}function Be(){M.call(this),this.i=new J(this),this.M=this,this.G=null}x(Be,M),Be.prototype[we]=!0,Be.prototype.removeEventListener=function(g,S,O,G){te(this,g,S,O,G)};function Ye(g,S){var O,G=g.G;if(G)for(O=[];G;G=G.G)O.push(G);if(g=g.M,G=S.type||S,typeof S=="string")S=new F(S,g);else if(S instanceof F)S.target=S.target||g;else{var fe=S;S=new F(G,g),X(S,fe)}fe=!0;let _e,He;if(O)for(He=O.length-1;He>=0;He--)_e=S.g=O[He],fe=et(_e,G,!0,S)&&fe;if(_e=S.g=g,fe=et(_e,G,!0,S)&&fe,fe=et(_e,G,!1,S)&&fe,O)for(He=0;He<O.length;He++)_e=S.g=O[He],fe=et(_e,G,!1,S)&&fe}Be.prototype.N=function(){if(Be.Z.N.call(this),this.i){var g=this.i;for(const S in g.g){const O=g.g[S];for(let G=0;G<O.length;G++)ye(O[G]);delete g.g[S],g.h--}}this.G=null},Be.prototype.J=function(g,S,O,G){return this.i.add(String(g),S,!1,O,G)},Be.prototype.K=function(g,S,O,G){return this.i.add(String(g),S,!0,O,G)};function et(g,S,O,G){if(S=g.i.g[String(S)],!S)return!0;S=S.concat();let fe=!0;for(let _e=0;_e<S.length;++_e){const He=S[_e];if(He&&!He.da&&He.capture==O){const vt=He.listener,Vr=He.ha||He.src;He.fa&&ne(g.i,He),fe=vt.call(Vr,G)!==!1&&fe}}return fe&&!G.defaultPrevented}function Et(g,S){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=d(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:o.setTimeout(g,S||0)}function zt(g){g.g=Et(()=>{g.g=null,g.i&&(g.i=!1,zt(g))},g.l);const S=g.h;g.h=null,g.m.apply(null,S)}class Bt extends M{constructor(S,O){super(),this.m=S,this.l=O,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:zt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Br(g){M.call(this),this.h=g,this.g={}}x(Br,M);var Nn=[];function pa(g){ae(g.g,function(S,O){this.g.hasOwnProperty(O)&&Ct(S)},g),g.g={}}Br.prototype.N=function(){Br.Z.N.call(this),pa(this)},Br.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var dr=o.JSON.stringify,Rn=o.JSON.parse,mt=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function Kt(){}function Ir(){}var Tt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Yt(){F.call(this,"d")}x(Yt,F);function Dr(){F.call(this,"c")}x(Dr,F);var gr={},zi=null;function ss(){return zi=zi||new Be}gr.Ia="serverreachability";function ei(g){F.call(this,gr.Ia,g)}x(ei,F);function ea(g){const S=ss();Ye(S,new ei(S))}gr.STAT_EVENT="statevent";function Fa(g,S){F.call(this,gr.STAT_EVENT,g),this.stat=S}x(Fa,F);function Er(g){const S=ss();Ye(S,new Fa(S,g))}gr.Ja="timingevent";function Or(g,S){F.call(this,gr.Ja,g),this.size=S}x(Or,F);function ga(g,S){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},S)}function Xn(){this.g=!0}Xn.prototype.ua=function(){this.g=!1};function Vu(g,S,O,G,fe,_e){g.info(function(){if(g.g)if(_e){var He="",vt=_e.split("&");for(let Wt=0;Wt<vt.length;Wt++){var Vr=vt[Wt].split("=");if(Vr.length>1){const Tr=Vr[0];Vr=Vr[1];const La=Tr.split("_");He=La.length>=2&&La[1]=="type"?He+(Tr+"="+Vr+"&"):He+(Tr+"=redacted&")}}}else He=null;else He=_e;return"XMLHTTP REQ ("+G+") [attempt "+fe+"]: "+S+`
`+O+`
`+He})}function dc(g,S,O,G,fe,_e,He){g.info(function(){return"XMLHTTP RESP ("+G+") [ attempt "+fe+"]: "+S+`
`+O+`
`+_e+" "+He})}function Ma(g,S,O,G){g.info(function(){return"XMLHTTP TEXT ("+S+"): "+Uu(g,O)+(G?" "+G:"")})}function ti(g,S){g.info(function(){return"TIMEOUT: "+S})}Xn.prototype.info=function(){};function Uu(g,S){if(!g.g)return S;if(!S)return null;try{const _e=JSON.parse(S);if(_e){for(g=0;g<_e.length;g++)if(Array.isArray(_e[g])){var O=_e[g];if(!(O.length<2)){var G=O[1];if(Array.isArray(G)&&!(G.length<1)){var fe=G[0];if(fe!="noop"&&fe!="stop"&&fe!="close")for(let He=1;He<G.length;He++)G[He]=""}}}}return dr(_e)}catch{return S}}var ri={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ni={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},io;function ai(){}x(ai,Kt),ai.prototype.g=function(){return new XMLHttpRequest},io=new ai;function is(g){return encodeURIComponent(String(g))}function L(g){var S=1;g=g.split(":");const O=[];for(;S>0&&g.length;)O.push(g.shift()),S--;return g.length&&O.push(g.join(":")),O}function Q(g,S,O,G){this.j=g,this.i=S,this.l=O,this.S=G||1,this.V=new Br(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new H}function H(){this.i=null,this.g="",this.h=!1}var q={},K={};function Z(g,S,O){g.M=1,g.A=lo(Yr(S)),g.u=O,g.R=!0,de(g,null)}function de(g,S){g.F=Date.now(),ge(g),g.B=Yr(g.A);var O=g.B,G=g.S;Array.isArray(G)||(G=[String(G)]),pc(O.i,"t",G),g.C=0,O=g.j.L,g.h=new H,g.g=Eh(g.j,O?S:null,!g.u),g.P>0&&(g.O=new Bt(d(g.Y,g,g.g),g.P)),S=g.V,O=g.g,G=g.ba;var fe="readystatechange";Array.isArray(fe)||(fe&&(Nn[0]=fe.toString()),fe=Nn);for(let _e=0;_e<fe.length;_e++){const He=Ce(O,fe[_e],G||S.handleEvent,!1,S.h||S);if(!He)break;S.g[He.key]=He}S=g.J?Y(g.J):{},g.u?(g.v||(g.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,S)):(g.v="GET",g.g.ea(g.B,g.v,null,S)),ea(),Vu(g.i,g.v,g.B,g.l,g.S,g.u)}Q.prototype.ba=function(g){g=g.target;const S=this.O;S&&fs(g)==3?S.j():this.Y(g)},Q.prototype.Y=function(g){try{if(g==this.g)e:{const vt=fs(this.g),Vr=this.g.ya(),Wt=this.g.ca();if(!(vt<3)&&(vt!=3||this.g&&(this.h.h||this.g.la()||vn(this.g)))){this.K||vt!=4||Vr==7||(Vr==8||Wt<=0?ea(3):ea(2)),Ve(this);var S=this.g.ca();this.X=S;var O=Ae(this);if(this.o=S==200,dc(this.i,this.v,this.B,this.l,this.S,vt,S),this.o){if(this.U&&!this.L){t:{if(this.g){var G,fe=this.g;if((G=fe.g?fe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(G)){var _e=G;break t}}_e=null}if(g=_e)Ma(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ge(this,g);else{this.o=!1,this.m=3,Er(12),je(this),qe(this);break e}}if(this.R){g=!0;let Tr;for(;!this.K&&this.C<O.length;)if(Tr=xe(this,O),Tr==K){vt==4&&(this.m=4,Er(14),g=!1),Ma(this.i,this.l,null,"[Incomplete Response]");break}else if(Tr==q){this.m=4,Er(15),Ma(this.i,this.l,O,"[Invalid Chunk]"),g=!1;break}else Ma(this.i,this.l,Tr,null),Ge(this,Tr);if(me(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),vt!=4||O.length!=0||this.h.h||(this.m=1,Er(16),g=!1),this.o=this.o&&g,!g)Ma(this.i,this.l,O,"[Invalid Chunked Response]"),je(this),qe(this);else if(O.length>0&&!this.W){this.W=!0;var He=this.j;He.g==this&&He.aa&&!He.P&&(He.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),Qu(He),He.P=!0,Er(11))}}else Ma(this.i,this.l,O,null),Ge(this,O);vt==4&&je(this),this.o&&!this.K&&(vt==4?yh(this.j,this):(this.o=!1,ge(this)))}else ii(this.g),S==400&&O.indexOf("Unknown SID")>0?(this.m=3,Er(12)):(this.m=0,Er(13)),je(this),qe(this)}}}catch{}finally{}};function Ae(g){if(!me(g))return g.g.la();const S=vn(g.g);if(S==="")return"";let O="";const G=S.length,fe=fs(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return je(g),qe(g),"";g.h.i=new o.TextDecoder}for(let _e=0;_e<G;_e++)g.h.h=!0,O+=g.h.i.decode(S[_e],{stream:!(fe&&_e==G-1)});return S.length=0,g.h.g+=O,g.C=0,g.h.g}function me(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function xe(g,S){var O=g.C,G=S.indexOf(`
`,O);return G==-1?K:(O=Number(S.substring(O,G)),isNaN(O)?q:(G+=1,G+O>S.length?K:(S=S.slice(G,G+O),g.C=G+O,S)))}Q.prototype.cancel=function(){this.K=!0,je(this)};function ge(g){g.T=Date.now()+g.H,Le(g,g.H)}function Le(g,S){if(g.D!=null)throw Error("WatchDog timer not null");g.D=ga(d(g.aa,g),S)}function Ve(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Q.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(ti(this.i,this.B),this.M!=2&&(ea(),Er(17)),je(this),this.m=2,qe(this)):Le(this,this.T-g)};function qe(g){g.j.I==0||g.K||yh(g.j,g)}function je(g){Ve(g);var S=g.O;S&&typeof S.dispose=="function"&&S.dispose(),g.O=null,pa(g.V),g.g&&(S=g.g,g.g=null,S.abort(),S.dispose())}function Ge(g,S){try{var O=g.j;if(O.I!=0&&(O.g==g||In(O.h,g))){if(!g.L&&In(O.h,g)&&O.I==3){try{var G=O.Ba.g.parse(S)}catch{G=null}if(Array.isArray(G)&&G.length==3){var fe=G;if(fe[0]==0){e:if(!O.v){if(O.g)if(O.g.F+3e3<g.F)_c(O),Qi(O);else break e;po(O),Er(18)}}else O.xa=fe[1],0<O.xa-O.K&&fe[2]<37500&&O.F&&O.A==0&&!O.C&&(O.C=ga(d(O.Va,O),6e3));fr(O.h)<=1&&O.ta&&(O.ta=void 0)}else Is(O,11)}else if((g.L||O.g==g)&&_c(O),!V(S))for(fe=O.Ba.g.parse(S),S=0;S<fe.length;S++){let Wt=fe[S];const Tr=Wt[0];if(!(Tr<=O.K))if(O.K=Tr,Wt=Wt[1],O.I==2)if(Wt[0]=="c"){O.M=Wt[1],O.ba=Wt[2];const La=Wt[3];La!=null&&(O.ka=La,O.j.info("VER="+O.ka));const Ds=Wt[4];Ds!=null&&(O.za=Ds,O.j.info("SVER="+O.za));const hs=Wt[5];hs!=null&&typeof hs=="number"&&hs>0&&(G=1.5*hs,O.O=G,O.j.info("backChannelRequestTimeoutMs_="+G)),G=O;const ds=g.g;if(ds){const go=ds.g?ds.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(go){var _e=G.h;_e.g||go.indexOf("spdy")==-1&&go.indexOf("quic")==-1&&go.indexOf("h2")==-1||(_e.j=_e.l,_e.g=new Set,_e.h&&(ls(_e,_e.h),_e.h=null))}if(G.G){const wc=ds.g?ds.g.getResponseHeader("X-HTTP-Session-Id"):null;wc&&(G.wa=wc,Zt(G.J,G.G,wc))}}O.I=3,O.l&&O.l.ra(),O.aa&&(O.T=Date.now()-g.F,O.j.info("Handshake RTT: "+O.T+"ms")),G=O;var He=g;if(G.na=bh(G,G.L?G.ba:null,G.W),He.L){os(G.h,He);var vt=He,Vr=G.O;Vr&&(vt.H=Vr),vt.D&&(Ve(vt),ge(vt)),G.g=He}else xh(G);O.i.length>0&&Rs(O)}else Wt[0]!="stop"&&Wt[0]!="close"||Is(O,7);else O.I==3&&(Wt[0]=="stop"||Wt[0]=="close"?Wt[0]=="stop"?Is(O,7):$u(O):Wt[0]!="noop"&&O.l&&O.l.qa(Wt),O.A=0)}}ea(4)}catch{}}var Ze=class{constructor(g,S){this.g=g,this.map=S}};function Qt(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Jt(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function fr(g){return g.h?1:g.g?g.g.size:0}function In(g,S){return g.h?g.h==S:g.g?g.g.has(S):!1}function ls(g,S){g.g?g.g.add(S):g.h=S}function os(g,S){g.h&&g.h==S?g.h=null:g.g&&g.g.has(S)&&g.g.delete(S)}Qt.prototype.cancel=function(){if(this.i=xa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function xa(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let S=g.i;for(const O of g.g.values())S=S.concat(O.G);return S}return b(g.i)}var Hi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Dn(g,S){if(g){g=g.split("&");for(let O=0;O<g.length;O++){const G=g[O].indexOf("=");let fe,_e=null;G>=0?(fe=g[O].substring(0,G),_e=g[O].substring(G+1)):fe=g[O],S(fe,_e?decodeURIComponent(_e.replace(/\+/g," ")):"")}}}function va(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;g instanceof va?(this.l=g.l,hn(this,g.j),this.o=g.o,this.g=g.g,Gi(this,g.u),this.h=g.h,zu(this,ph(g.i)),this.m=g.m):g&&(S=String(g).match(Hi))?(this.l=!1,hn(this,S[1]||"",!0),this.o=As(S[2]||""),this.g=As(S[3]||"",!0),Gi(this,S[4]),this.h=As(S[5]||"",!0),zu(this,S[6]||"",!0),this.m=As(S[7]||"")):(this.l=!1,this.i=new Wi(null,this.l))}va.prototype.toString=function(){const g=[];var S=this.j;S&&g.push(oo(S,mc,!0),":");var O=this.g;return(O||S=="file")&&(g.push("//"),(S=this.o)&&g.push(oo(S,mc,!0),"@"),g.push(is(O).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),O=this.u,O!=null&&g.push(":",String(O))),(O=this.h)&&(this.g&&O.charAt(0)!="/"&&g.push("/"),g.push(oo(O,O.charAt(0)=="/"?Hu:hh,!0))),(O=this.i.toString())&&g.push("?",O),(O=this.m)&&g.push("#",oo(O,dh)),g.join("")},va.prototype.resolve=function(g){const S=Yr(this);let O=!!g.j;O?hn(S,g.j):O=!!g.o,O?S.o=g.o:O=!!g.g,O?S.g=g.g:O=g.u!=null;var G=g.h;if(O)Gi(S,g.u);else if(O=!!g.h){if(G.charAt(0)!="/")if(this.g&&!this.h)G="/"+G;else{var fe=S.h.lastIndexOf("/");fe!=-1&&(G=S.h.slice(0,fe+1)+G)}if(fe=G,fe==".."||fe==".")G="";else if(fe.indexOf("./")!=-1||fe.indexOf("/.")!=-1){G=fe.lastIndexOf("/",0)==0,fe=fe.split("/");const _e=[];for(let He=0;He<fe.length;){const vt=fe[He++];vt=="."?G&&He==fe.length&&_e.push(""):vt==".."?((_e.length>1||_e.length==1&&_e[0]!="")&&_e.pop(),G&&He==fe.length&&_e.push("")):(_e.push(vt),G=!0)}G=_e.join("/")}else G=fe}return O?S.h=G:O=g.i.toString()!=="",O?zu(S,ph(g.i)):O=!!g.m,O&&(S.m=g.m),S};function Yr(g){return new va(g)}function hn(g,S,O){g.j=O?As(S,!0):S,g.j&&(g.j=g.j.replace(/:$/,""))}function Gi(g,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);g.u=S}else g.u=null}function zu(g,S,O){S instanceof Wi?(g.i=S,gc(g.i,g.l)):(O||(S=oo(S,qi)),g.i=new Wi(S,g.l))}function Zt(g,S,O){g.i.set(S,O)}function lo(g){return Zt(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function As(g,S){return g?S?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function oo(g,S,O){return typeof g=="string"?(g=encodeURI(g).replace(S,ta),O&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function ta(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var mc=/[#\/\?@]/g,hh=/[#\?:]/g,Hu=/[#\?]/g,qi=/[#\?@]/g,dh=/#/g;function Wi(g,S){this.h=this.g=null,this.i=g||null,this.j=!!S}function ra(g){g.g||(g.g=new Map,g.h=0,g.i&&Dn(g.i,function(S,O){g.add(decodeURIComponent(S.replace(/\+/g," ")),O)}))}t=Wi.prototype,t.add=function(g,S){ra(this),this.i=null,g=Xi(this,g);let O=this.g.get(g);return O||this.g.set(g,O=[]),O.push(S),this.h+=1,this};function mh(g,S){ra(g),S=Xi(g,S),g.g.has(S)&&(g.i=null,g.h-=g.g.get(S).length,g.g.delete(S))}function Gu(g,S){return ra(g),S=Xi(g,S),g.g.has(S)}t.forEach=function(g,S){ra(this),this.g.forEach(function(O,G){O.forEach(function(fe){g.call(S,fe,G,this)},this)},this)};function qu(g,S){ra(g);let O=[];if(typeof S=="string")Gu(g,S)&&(O=O.concat(g.g.get(Xi(g,S))));else for(g=Array.from(g.g.values()),S=0;S<g.length;S++)O=O.concat(g[S]);return O}t.set=function(g,S){return ra(this),this.i=null,g=Xi(this,g),Gu(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[S]),this.h+=1,this},t.get=function(g,S){return g?(g=qu(this,g),g.length>0?String(g[0]):S):S};function pc(g,S,O){mh(g,S),O.length>0&&(g.i=null,g.g.set(Xi(g,S),b(O)),g.h+=O.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],S=Array.from(this.g.keys());for(let G=0;G<S.length;G++){var O=S[G];const fe=is(O);O=qu(this,O);for(let _e=0;_e<O.length;_e++){let He=fe;O[_e]!==""&&(He+="="+is(O[_e])),g.push(He)}}return this.i=g.join("&")};function ph(g){const S=new Wi;return S.i=g.i,g.g&&(S.g=new Map(g.g),S.h=g.h),S}function Xi(g,S){return S=String(S),g.j&&(S=S.toLowerCase()),S}function gc(g,S){S&&!g.j&&(ra(g),g.i=null,g.g.forEach(function(O,G){const fe=G.toLowerCase();G!=fe&&(mh(this,G),pc(this,fe,O))},g)),g.j=S}function cs(g,S){const O=new Xn;if(o.Image){const G=new Image;G.onload=m(Pa,O,"TestLoadImage: loaded",!0,S,G),G.onerror=m(Pa,O,"TestLoadImage: error",!1,S,G),G.onabort=m(Pa,O,"TestLoadImage: abort",!1,S,G),G.ontimeout=m(Pa,O,"TestLoadImage: timeout",!1,S,G),o.setTimeout(function(){G.ontimeout&&G.ontimeout()},1e4),G.src=g}else S(!1)}function Wu(g,S){const O=new Xn,G=new AbortController,fe=setTimeout(()=>{G.abort(),Pa(O,"TestPingServer: timeout",!1,S)},1e4);fetch(g,{signal:G.signal}).then(_e=>{clearTimeout(fe),_e.ok?Pa(O,"TestPingServer: ok",!0,S):Pa(O,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(fe),Pa(O,"TestPingServer: error",!1,S)})}function Pa(g,S,O,G,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),G(O)}catch{}}function Yi(){this.g=new mt}function ks(g){this.i=g.Sb||null,this.h=g.ab||!1}x(ks,Kt),ks.prototype.g=function(){return new co(this.i,this.h)};function co(g,S){Be.call(this),this.H=g,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(co,Be),t=co.prototype,t.open=function(g,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=S,this.readyState=1,us(this)},t.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(S.body=g),(this.H||o).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,$i(this)),this.readyState=0},t.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,us(this)),this.g&&(this.readyState=3,us(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xc(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function xc(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}t.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var S=g.value?g.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!g.done}))&&(this.response=this.responseText+=S)}g.done?$i(this):us(this),this.readyState==3&&xc(this)}},t.Oa=function(g){this.g&&(this.response=this.responseText=g,$i(this))},t.Na=function(g){this.g&&(this.response=g,$i(this))},t.ga=function(){this.g&&$i(this)};function $i(g){g.readyState=4,g.l=null,g.j=null,g.B=null,us(g)}t.setRequestHeader=function(g,S){this.A.append(g,S)},t.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],S=this.h.entries();for(var O=S.next();!O.done;)O=O.value,g.push(O[0]+": "+O[1]),O=S.next();return g.join(`\r
`)};function us(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(co.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function ja(g){let S="";return ae(g,function(O,G){S+=G,S+=":",S+=O,S+=`\r
`}),S}function uo(g,S,O){e:{for(G in O){var G=!1;break e}G=!0}G||(O=ja(O),typeof g=="string"?O!=null&&is(O):Zt(g,S,O))}function ir(g){Be.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(ir,Be);var Cs=/^https?$/i,Xu=["POST","PUT"];t=ir.prototype,t.Fa=function(g){this.H=g},t.ea=function(g,S,O,G){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);S=S?S.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():io.g(),this.g.onreadystatechange=y(d(this.Ca,this));try{this.B=!0,this.g.open(S,String(g),!0),this.B=!1}catch(_e){fo(this,_e);return}if(g=O||"",O=new Map(this.headers),G)if(Object.getPrototypeOf(G)===Object.prototype)for(var fe in G)O.set(fe,G[fe]);else if(typeof G.keys=="function"&&typeof G.get=="function")for(const _e of G.keys())O.set(_e,G.get(_e));else throw Error("Unknown input type for opt_headers: "+String(G));G=Array.from(O.keys()).find(_e=>_e.toLowerCase()=="content-type"),fe=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(Xu,S,void 0)>=0)||G||fe||O.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[_e,He]of O)this.g.setRequestHeader(_e,He);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(_e){fo(this,_e)}};function fo(g,S){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=S,g.o=5,Yu(g),si(g)}function Yu(g){g.A||(g.A=!0,Ye(g,"complete"),Ye(g,"error"))}t.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,Ye(this,"complete"),Ye(this,"abort"),si(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),si(this,!0)),ir.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ho(this):this.Xa())},t.Xa=function(){ho(this)};function ho(g){if(g.h&&typeof i<"u"){if(g.v&&fs(g)==4)setTimeout(g.Ca.bind(g),0);else if(Ye(g,"readystatechange"),fs(g)==4){g.h=!1;try{const _e=g.ca();e:switch(_e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var O;if(!(O=S)){var G;if(G=_e===0){let He=String(g.D).match(Hi)[1]||null;!He&&o.self&&o.self.location&&(He=o.self.location.protocol.slice(0,-1)),G=!Cs.test(He?He.toLowerCase():"")}O=G}if(O)Ye(g,"complete"),Ye(g,"success");else{g.o=6;try{var fe=fs(g)>2?g.g.statusText:""}catch{fe=""}g.l=fe+" ["+g.ca()+"]",Yu(g)}}finally{si(g)}}}}function si(g,S){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const O=g.g;g.g=null,S||Ye(g,"ready");try{O.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function fs(g){return g.g?g.g.readyState:0}t.ca=function(){try{return fs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(g){if(this.g){var S=this.g.responseText;return g&&S.indexOf(g)==0&&(S=S.substring(g.length)),Rn(S)}};function vn(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function ii(g){const S={};g=(g.g&&fs(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let G=0;G<g.length;G++){if(V(g[G]))continue;var O=L(g[G]);const fe=O[0];if(O=O[1],typeof O!="string")continue;O=O.trim();const _e=S[fe]||[];S[fe]=_e,_e.push(O)}Me(S,function(G){return G.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ns(g,S,O){return O&&O.internalChannelParams&&O.internalChannelParams[g]||S}function Ki(g){this.za=0,this.i=[],this.j=new Xn,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ns("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ns("baseRetryDelayMs",5e3,g),this.Za=Ns("retryDelaySeedMs",1e4,g),this.Ta=Ns("forwardChannelMaxRetries",2,g),this.va=Ns("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Qt(g&&g.concurrentRequestLimit),this.Ba=new Yi,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Ki.prototype,t.ka=8,t.I=1,t.connect=function(g,S,O,G){Er(0),this.W=g,this.H=S||{},O&&G!==void 0&&(this.H.OSID=O,this.H.OAID=G),this.F=this.X,this.J=bh(this,null,this.W),Rs(this)};function $u(g){if(vc(g),g.I==3){var S=g.V++,O=Yr(g.J);if(Zt(O,"SID",g.M),Zt(O,"RID",S),Zt(O,"TYPE","terminate"),mo(g,O),S=new Q(g,g.j,S),S.M=2,S.A=lo(Yr(O)),O=!1,o.navigator&&o.navigator.sendBeacon)try{O=o.navigator.sendBeacon(S.A.toString(),"")}catch{}!O&&o.Image&&(new Image().src=S.A,O=!0),O||(S.g=Eh(S.j,null),S.g.ea(S.A)),S.F=Date.now(),ge(S)}wh(g)}function Qi(g){g.g&&(Qu(g),g.g.cancel(),g.g=null)}function vc(g){Qi(g),g.v&&(o.clearTimeout(g.v),g.v=null),_c(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function Rs(g){if(!Jt(g.h)&&!g.m){g.m=!0;var S=g.Ea;U||D(),B||(U(),B=!0),A.add(S,g),g.D=0}}function yc(g,S){return fr(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=S.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=ga(d(g.Ea,g,S),_h(g,g.D)),g.D++,!0)}t.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const fe=new Q(this,this.j,g);let _e=this.o;if(this.U&&(_e?(_e=Y(_e),X(_e,this.U)):_e=this.U),this.u!==null||this.R||(fe.J=_e,_e=null),this.S)e:{for(var S=0,O=0;O<this.i.length;O++){t:{var G=this.i[O];if("__data__"in G.map&&(G=G.map.__data__,typeof G=="string")){G=G.length;break t}G=void 0}if(G===void 0)break;if(S+=G,S>4096){S=O;break e}if(S===4096||O===this.i.length-1){S=O+1;break e}}S=1e3}else S=1e3;S=gh(this,fe,S),O=Yr(this.J),Zt(O,"RID",g),Zt(O,"CVER",22),this.G&&Zt(O,"X-HTTP-Session-Id",this.G),mo(this,O),_e&&(this.R?S="headers="+is(ja(_e))+"&"+S:this.u&&uo(O,this.u,_e)),ls(this.h,fe),this.Ra&&Zt(O,"TYPE","init"),this.S?(Zt(O,"$req",S),Zt(O,"SID","null"),fe.U=!0,Z(fe,O,null)):Z(fe,O,S),this.I=2}}else this.I==3&&(g?Ku(this,g):this.i.length==0||Jt(this.h)||Ku(this))};function Ku(g,S){var O;S?O=S.l:O=g.V++;const G=Yr(g.J);Zt(G,"SID",g.M),Zt(G,"RID",O),Zt(G,"AID",g.K),mo(g,G),g.u&&g.o&&uo(G,g.u,g.o),O=new Q(g,g.j,O,g.D+1),g.u===null&&(O.J=g.o),S&&(g.i=S.G.concat(g.i)),S=gh(g,O,1e3),O.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),ls(g.h,O),Z(O,G,S)}function mo(g,S){g.H&&ae(g.H,function(O,G){Zt(S,G,O)}),g.l&&ae({},function(O,G){Zt(S,G,O)})}function gh(g,S,O){O=Math.min(g.i.length,O);const G=g.l?d(g.l.Ka,g.l,g):null;e:{var fe=g.i;let vt=-1;for(;;){const Vr=["count="+O];vt==-1?O>0?(vt=fe[0].g,Vr.push("ofs="+vt)):vt=0:Vr.push("ofs="+vt);let Wt=!0;for(let Tr=0;Tr<O;Tr++){var _e=fe[Tr].g;const La=fe[Tr].map;if(_e-=vt,_e<0)vt=Math.max(0,fe[Tr].g-100),Wt=!1;else try{_e="req"+_e+"_"||"";try{var He=La instanceof Map?La:Object.entries(La);for(const[Ds,hs]of He){let ds=hs;u(hs)&&(ds=dr(hs)),Vr.push(_e+Ds+"="+encodeURIComponent(ds))}}catch(Ds){throw Vr.push(_e+"type="+encodeURIComponent("_badmap")),Ds}}catch{G&&G(La)}}if(Wt){He=Vr.join("&");break e}}He=void 0}return g=g.i.splice(0,O),S.G=g,He}function xh(g){if(!g.g&&!g.v){g.Y=1;var S=g.Da;U||D(),B||(U(),B=!0),A.add(S,g),g.A=0}}function po(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=ga(d(g.Da,g),_h(g,g.A)),g.A++,!0)}t.Da=function(){if(this.v=null,vh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=ga(d(this.Wa,this),g)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Er(10),Qi(this),vh(this))};function Qu(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function vh(g){g.g=new Q(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var S=Yr(g.na);Zt(S,"RID","rpc"),Zt(S,"SID",g.M),Zt(S,"AID",g.K),Zt(S,"CI",g.F?"0":"1"),!g.F&&g.ia&&Zt(S,"TO",g.ia),Zt(S,"TYPE","xmlhttp"),mo(g,S),g.u&&g.o&&uo(S,g.u,g.o),g.O&&(g.g.H=g.O);var O=g.g;g=g.ba,O.M=1,O.A=lo(Yr(S)),O.u=null,O.R=!0,de(O,g)}t.Va=function(){this.C!=null&&(this.C=null,Qi(this),po(this),Er(19))};function _c(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function yh(g,S){var O=null;if(g.g==S){_c(g),Qu(g),g.g=null;var G=2}else if(In(g.h,S))O=S.G,os(g.h,S),G=1;else return;if(g.I!=0){if(S.o)if(G==1){O=S.u?S.u.length:0,S=Date.now()-S.F;var fe=g.D;G=ss(),Ye(G,new Or(G,O)),Rs(g)}else xh(g);else if(fe=S.m,fe==3||fe==0&&S.X>0||!(G==1&&yc(g,S)||G==2&&po(g)))switch(O&&O.length>0&&(S=g.h,S.i=S.i.concat(O)),fe){case 1:Is(g,5);break;case 4:Is(g,10);break;case 3:Is(g,6);break;default:Is(g,2)}}}function _h(g,S){let O=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(O*=2),O*S}function Is(g,S){if(g.j.info("Error code "+S),S==2){var O=d(g.bb,g),G=g.Ua;const fe=!G;G=new va(G||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||hn(G,"https"),lo(G),fe?cs(G.toString(),O):Wu(G.toString(),O)}else Er(2);g.I=0,g.l&&g.l.pa(S),wh(g),vc(g)}t.bb=function(g){g?(this.j.info("Successfully pinged google.com"),Er(2)):(this.j.info("Failed to ping google.com"),Er(1))};function wh(g){if(g.I=0,g.ja=[],g.l){const S=xa(g.h);(S.length!=0||g.i.length!=0)&&(E(g.ja,S),E(g.ja,g.i),g.h.i.length=0,b(g.i),g.i.length=0),g.l.oa()}}function bh(g,S,O){var G=O instanceof va?Yr(O):new va(O);if(G.g!="")S&&(G.g=S+"."+G.g),Gi(G,G.u);else{var fe=o.location;G=fe.protocol,S=S?S+"."+fe.hostname:fe.hostname,fe=+fe.port;const _e=new va(null);G&&hn(_e,G),S&&(_e.g=S),fe&&Gi(_e,fe),O&&(_e.h=O),G=_e}return O=g.G,S=g.wa,O&&S&&Zt(G,O,S),Zt(G,"VER",g.ka),mo(g,G),G}function Eh(g,S,O){if(S&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=g.Aa&&!g.ma?new ir(new ks({ab:O})):new ir(g.ma),S.Fa(g.L),S}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Th(){}t=Th.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Ji(){}Ji.prototype.g=function(g,S){return new Yn(g,S)};function Yn(g,S){Be.call(this),this.g=new Ki(S),this.l=g,this.h=S&&S.messageUrlParams||null,g=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(g?g["X-WebChannel-Content-Type"]=S.messageContentType:g={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(g?g["X-WebChannel-Client-Profile"]=S.sa:g={"X-WebChannel-Client-Profile":S.sa}),this.g.U=g,(g=S&&S.Qb)&&!V(g)&&(this.g.u=g),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!V(S)&&(this.g.G=S,g=this.h,g!==null&&S in g&&(g=this.h,S in g&&delete g[S])),this.j=new li(this)}x(Yn,Be),Yn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Yn.prototype.close=function(){$u(this.g)},Yn.prototype.o=function(g){var S=this.g;if(typeof g=="string"){var O={};O.__data__=g,g=O}else this.v&&(O={},O.__data__=dr(g),g=O);S.i.push(new Ze(S.Ya++,g)),S.I==3&&Rs(S)},Yn.prototype.N=function(){this.g.l=null,delete this.j,$u(this.g),delete this.g,Yn.Z.N.call(this)};function Sh(g){Yt.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var S=g.__sm__;if(S){e:{for(const O in S){g=O;break e}g=void 0}(this.i=g)&&(g=this.i,S=S!==null&&g in S?S[g]:void 0),this.data=S}else this.data=g}x(Sh,Yt);function Ah(){Dr.call(this),this.status=1}x(Ah,Dr);function li(g){this.g=g}x(li,Th),li.prototype.ra=function(){Ye(this.g,"a")},li.prototype.qa=function(g){Ye(this.g,new Sh(g))},li.prototype.pa=function(g){Ye(this.g,new Ah)},li.prototype.oa=function(){Ye(this.g,"b")},Ji.prototype.createWebChannel=Ji.prototype.g,Yn.prototype.send=Yn.prototype.o,Yn.prototype.open=Yn.prototype.m,Yn.prototype.close=Yn.prototype.close,x4=function(){return new Ji},g4=function(){return ss()},p4=gr,vx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ri.NO_ERROR=0,ri.TIMEOUT=8,ri.HTTP_ERROR=6,Zd=ri,ni.COMPLETE="complete",m4=ni,Ir.EventType=Tt,Tt.OPEN="a",Tt.CLOSE="b",Tt.ERROR="c",Tt.MESSAGE="d",Be.prototype.listen=Be.prototype.J,zf=Ir,ir.prototype.listenOnce=ir.prototype.K,ir.prototype.getLastError=ir.prototype.Ha,ir.prototype.getLastErrorCode=ir.prototype.ya,ir.prototype.getStatus=ir.prototype.ca,ir.prototype.getResponseJson=ir.prototype.La,ir.prototype.getResponseText=ir.prototype.la,ir.prototype.send=ir.prototype.ea,ir.prototype.setWithCredentials=ir.prototype.Fa,d4=ir}).apply(typeof Dd<"u"?Dd:typeof self<"u"?self:typeof window<"u"?window:{});const Qb="@firebase/firestore",Jb="4.9.2";let Pn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Pn.UNAUTHENTICATED=new Pn(null),Pn.GOOGLE_CREDENTIALS=new Pn("google-credentials-uid"),Pn.FIRST_PARTY=new Pn("first-party-uid"),Pn.MOCK_USER=new Pn("mock-user");let Ru="12.3.0";const Wo=new dv("@firebase/firestore");function eu(){return Wo.logLevel}function Ke(t,...e){if(Wo.logLevel<=Ft.DEBUG){const r=e.map(gv);Wo.debug(`Firestore (${Ru}): ${t}`,...r)}}function Di(t,...e){if(Wo.logLevel<=Ft.ERROR){const r=e.map(gv);Wo.error(`Firestore (${Ru}): ${t}`,...r)}}function gu(t,...e){if(Wo.logLevel<=Ft.WARN){const r=e.map(gv);Wo.warn(`Firestore (${Ru}): ${t}`,...r)}}function gv(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function ut(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,v4(t,n,r)}function v4(t,e,r){let n=`FIRESTORE (${Ru}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Di(n),new Error(n)}function $t(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||v4(e,a,n)}function xt(t,e){return t}const Ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Xe extends Li{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ml{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class y4{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class lD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(Pn.UNAUTHENTICATED)))}shutdown(){}}class oD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class cD{constructor(e){this.t=e,this.currentUser=Pn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){$t(this.o===void 0,42304);let n=this.i;const a=f=>this.i!==n?(n=this.i,r(f)):Promise.resolve();let i=new Ml;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ml,e.enqueueRetryable((()=>a(this.currentUser)))};const o=()=>{const f=i;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},u=f=>{Ke("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((f=>u(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(Ke("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ml)}}),0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(Ke("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?($t(typeof n.accessToken=="string",31837,{l:n}),new y4(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return $t(e===null||typeof e=="string",2055,{h:e}),new Pn(e)}}class uD{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Pn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class fD{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new uD(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(Pn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Zb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class hD{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ys(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){$t(this.o===void 0,3512);const n=i=>{i.error!=null&&Ke("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Ke("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>n(i)))};const a=i=>{Ke("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>a(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?a(i):Ke("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Zb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?($t(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Zb(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function dD(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class xv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=dD(40);for(let i=0;i<a.length;++i)n.length<20&&a[i]<r&&(n+=e.charAt(a[i]%62))}return n}}function Mt(t,e){return t<e?-1:t>e?1:0}function yx(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const a=t.charAt(n),i=e.charAt(n);if(a!==i)return L1(a)===L1(i)?Mt(a,i):L1(a)?1:-1}return Mt(t.length,e.length)}const mD=55296,pD=57343;function L1(t){const e=t.charCodeAt(0);return e>=mD&&e<=pD}function xu(t,e,r){return t.length===e.length&&t.every(((n,a)=>r(n,e[a])))}const eE="__name__";class Vs{constructor(e,r,n){r===void 0?r=0:r>e.length&&ut(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ut(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Vs.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Vs?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const i=Vs.compareSegments(e.get(a),r.get(a));if(i!==0)return i}return Mt(e.length,r.length)}static compareSegments(e,r){const n=Vs.isNumericId(e),a=Vs.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?Vs.extractNumericId(e).compare(Vs.extractNumericId(r)):yx(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fl.fromString(e.substring(4,e.length-2))}}class pr extends Vs{construct(e,r,n){return new pr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Xe(Ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((a=>a.length>0)))}return new pr(r)}static emptyPath(){return new pr([])}}const gD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class An extends Vs{construct(e,r,n){return new An(e,r,n)}static isValidIdentifier(e){return gD.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),An.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===eE}static keyField(){return new An([eE])}static fromServerFormat(e){const r=[];let n="",a=0;const i=()=>{if(n.length===0)throw new Xe(Ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new Xe(Ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new Xe(Ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,a+=2}else u==="`"?(o=!o,a++):u!=="."||o?(n+=u,a++):(i(),a++)}if(i(),o)throw new Xe(Ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new An(r)}static emptyPath(){return new An([])}}class at{constructor(e){this.path=e}static fromPath(e){return new at(pr.fromString(e))}static fromName(e){return new at(pr.fromString(e).popFirst(5))}static empty(){return new at(pr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&pr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return pr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new at(new pr(e.slice()))}}function _4(t,e,r){if(!r)throw new Xe(Ie.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function xD(t,e,r,n){if(e===!0&&n===!0)throw new Xe(Ie.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function tE(t){if(!at.isDocumentKey(t))throw new Xe(Ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function rE(t){if(at.isDocumentKey(t))throw new Xe(Ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function w4(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Km(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ut(12329,{type:typeof t})}function Ia(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Xe(Ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Km(t);throw new Xe(Ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function sn(t,e){const r={typeString:t};return e&&(r.value=e),r}function B0(t,e){if(!w4(t))throw new Xe(Ie.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const a=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(a&&typeof o!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(i!==void 0&&o!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new Xe(Ie.INVALID_ARGUMENT,r);return!0}const nE=-62135596800,aE=1e6;class _r{static now(){return _r.fromMillis(Date.now())}static fromDate(e){return _r.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*aE);return new _r(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Xe(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Xe(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<nE)throw new Xe(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Xe(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/aE}_compareTo(e){return this.seconds===e.seconds?Mt(this.nanoseconds,e.nanoseconds):Mt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:_r._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(B0(e,_r._jsonSchema))return new _r(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-nE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}_r._jsonSchemaVersion="firestore/timestamp/1.0",_r._jsonSchema={type:sn("string",_r._jsonSchemaVersion),seconds:sn("number"),nanoseconds:sn("number")};class pt{static fromTimestamp(e){return new pt(e)}static min(){return new pt(new _r(0,0))}static max(){return new pt(new _r(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const f0=-1;function vD(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=pt.fromTimestamp(n===1e9?new _r(r+1,0):new _r(r,n));return new Vl(a,at.empty(),e)}function yD(t){return new Vl(t.readTime,t.key,f0)}class Vl{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Vl(pt.min(),at.empty(),f0)}static max(){return new Vl(pt.max(),at.empty(),f0)}}function _D(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=at.comparator(t.documentKey,e.documentKey),r!==0?r:Mt(t.largestBatchId,e.largestBatchId))}const wD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class bD{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Iu(t){if(t.code!==Ie.FAILED_PRECONDITION||t.message!==wD)throw t;Ke("LocalStore","Unexpectedly lost primary lease")}class Oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ut(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Oe(((n,a)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,a)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,a)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof Oe?r:Oe.resolve(r)}catch(r){return Oe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):Oe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):Oe.reject(r)}static resolve(e){return new Oe(((r,n)=>{r(e)}))}static reject(e){return new Oe(((r,n)=>{n(e)}))}static waitFor(e){return new Oe(((r,n)=>{let a=0,i=0,o=!1;e.forEach((u=>{++a,u.next((()=>{++i,o&&i===a&&r()}),(f=>n(f)))})),o=!0,i===a&&r()}))}static or(e){let r=Oe.resolve(!1);for(const n of e)r=r.next((a=>a?Oe.resolve(a):n()));return r}static forEach(e,r){const n=[];return e.forEach(((a,i)=>{n.push(r.call(this,a,i))})),this.waitFor(n)}static mapArray(e,r){return new Oe(((n,a)=>{const i=e.length,o=new Array(i);let u=0;for(let f=0;f<i;f++){const d=f;r(e[d]).next((m=>{o[d]=m,++u,u===i&&n(o)}),(m=>a(m)))}}))}static doWhile(e,r){return new Oe(((n,a)=>{const i=()=>{e()===!0?r().next((()=>{i()}),a):n()};i()}))}}function ED(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Du(t){return t.name==="IndexedDbTransactionError"}class Qm{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Qm.ce=-1;const vv=-1;function Jm(t){return t==null}function hm(t){return t===0&&1/t==-1/0}function TD(t){return typeof t=="number"&&Number.isInteger(t)&&!hm(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const b4="";function SD(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=sE(e)),e=AD(t.get(r),e);return sE(e)}function AD(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const i=t.charAt(a);switch(i){case"\0":r+="";break;case b4:r+="";break;default:r+=i}}return r}function sE(t){return t+b4+""}function iE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Zl(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function E4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Rr{constructor(e,r){this.comparator=e,this.root=r||Tn.EMPTY}insert(e,r){return new Rr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Tn.BLACK,null,null))}remove(e){return new Rr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Tn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Od(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Od(this.root,e,this.comparator,!1)}getReverseIterator(){return new Od(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Od(this.root,e,this.comparator,!0)}}class Od{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&a&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Tn{constructor(e,r,n,a,i){this.key=e,this.value=r,this.color=n??Tn.RED,this.left=a??Tn.EMPTY,this.right=i??Tn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,i){return new Tn(e??this.key,r??this.value,n??this.color,a??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const i=n(e,a.key);return a=i<0?a.copy(null,null,null,a.left.insert(e,r,n),null):i===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Tn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return Tn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Tn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Tn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ut(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ut(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ut(27949);return e+(this.isRed()?0:1)}}Tn.EMPTY=null,Tn.RED=!0,Tn.BLACK=!1;Tn.EMPTY=new class{constructor(){this.size=0}get key(){throw ut(57766)}get value(){throw ut(16141)}get color(){throw ut(16727)}get left(){throw ut(29726)}get right(){throw ut(36894)}copy(e,r,n,a,i){return this}insert(e,r,n){return new Tn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class cn{constructor(e){this.comparator=e,this.data=new Rr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new lE(this.data.getIterator())}getIteratorFrom(e){return new lE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof cn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,i=n.getNext().key;if(this.comparator(a,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new cn(this.comparator);return r.data=e,r}}class lE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ra{constructor(e){this.fields=e,e.sort(An.comparator)}static empty(){return new Ra([])}unionWith(e){let r=new cn(An.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ra(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return xu(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}class T4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Cn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(a){try{return atob(a)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new T4("Invalid base64 string: "+i):i}})(e);return new Cn(r)}static fromUint8Array(e){const r=(function(a){let i="";for(let o=0;o<a.length;++o)i+=String.fromCharCode(a[o]);return i})(e);return new Cn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Mt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cn.EMPTY_BYTE_STRING=new Cn("");const kD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ul(t){if($t(!!t,39018),typeof t=="string"){let e=0;const r=kD.exec(t);if($t(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Gr(t.seconds),nanos:Gr(t.nanos)}}function Gr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function zl(t){return typeof t=="string"?Cn.fromBase64String(t):Cn.fromUint8Array(t)}const S4="server_timestamp",A4="__type__",k4="__previous_value__",C4="__local_write_time__";function yv(t){return(t?.mapValue?.fields||{})[A4]?.stringValue===S4}function Zm(t){const e=t.mapValue.fields[k4];return yv(e)?Zm(e):e}function h0(t){const e=Ul(t.mapValue.fields[C4].timestampValue);return new _r(e.seconds,e.nanos)}class CD{constructor(e,r,n,a,i,o,u,f,d,m){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=d,this.isUsingEmulator=m}}const dm="(default)";class d0{constructor(e,r){this.projectId=e,this.database=r||dm}static empty(){return new d0("","")}get isDefaultDatabase(){return this.database===dm}isEqual(e){return e instanceof d0&&e.projectId===this.projectId&&e.database===this.database}}const N4="__type__",ND="__max__",Fd={mapValue:{}},R4="__vector__",mm="value";function Hl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yv(t)?4:ID(t)?9007199254740991:RD(t)?10:11:ut(28295,{value:t})}function Ks(t,e){if(t===e)return!0;const r=Hl(t);if(r!==Hl(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return h0(t).isEqual(h0(e));case 3:return(function(a,i){if(typeof a.timestampValue=="string"&&typeof i.timestampValue=="string"&&a.timestampValue.length===i.timestampValue.length)return a.timestampValue===i.timestampValue;const o=Ul(a.timestampValue),u=Ul(i.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,i){return zl(a.bytesValue).isEqual(zl(i.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,i){return Gr(a.geoPointValue.latitude)===Gr(i.geoPointValue.latitude)&&Gr(a.geoPointValue.longitude)===Gr(i.geoPointValue.longitude)})(t,e);case 2:return(function(a,i){if("integerValue"in a&&"integerValue"in i)return Gr(a.integerValue)===Gr(i.integerValue);if("doubleValue"in a&&"doubleValue"in i){const o=Gr(a.doubleValue),u=Gr(i.doubleValue);return o===u?hm(o)===hm(u):isNaN(o)&&isNaN(u)}return!1})(t,e);case 9:return xu(t.arrayValue.values||[],e.arrayValue.values||[],Ks);case 10:case 11:return(function(a,i){const o=a.mapValue.fields||{},u=i.mapValue.fields||{};if(iE(o)!==iE(u))return!1;for(const f in o)if(o.hasOwnProperty(f)&&(u[f]===void 0||!Ks(o[f],u[f])))return!1;return!0})(t,e);default:return ut(52216,{left:t})}}function m0(t,e){return(t.values||[]).find((r=>Ks(r,e)))!==void 0}function vu(t,e){if(t===e)return 0;const r=Hl(t),n=Hl(e);if(r!==n)return Mt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Mt(t.booleanValue,e.booleanValue);case 2:return(function(i,o){const u=Gr(i.integerValue||i.doubleValue),f=Gr(o.integerValue||o.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1})(t,e);case 3:return oE(t.timestampValue,e.timestampValue);case 4:return oE(h0(t),h0(e));case 5:return yx(t.stringValue,e.stringValue);case 6:return(function(i,o){const u=zl(i),f=zl(o);return u.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(i,o){const u=i.split("/"),f=o.split("/");for(let d=0;d<u.length&&d<f.length;d++){const m=Mt(u[d],f[d]);if(m!==0)return m}return Mt(u.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(i,o){const u=Mt(Gr(i.latitude),Gr(o.latitude));return u!==0?u:Mt(Gr(i.longitude),Gr(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return cE(t.arrayValue,e.arrayValue);case 10:return(function(i,o){const u=i.fields||{},f=o.fields||{},d=u[mm]?.arrayValue,m=f[mm]?.arrayValue,x=Mt(d?.values?.length||0,m?.values?.length||0);return x!==0?x:cE(d,m)})(t.mapValue,e.mapValue);case 11:return(function(i,o){if(i===Fd.mapValue&&o===Fd.mapValue)return 0;if(i===Fd.mapValue)return 1;if(o===Fd.mapValue)return-1;const u=i.fields||{},f=Object.keys(u),d=o.fields||{},m=Object.keys(d);f.sort(),m.sort();for(let x=0;x<f.length&&x<m.length;++x){const y=yx(f[x],m[x]);if(y!==0)return y;const b=vu(u[f[x]],d[m[x]]);if(b!==0)return b}return Mt(f.length,m.length)})(t.mapValue,e.mapValue);default:throw ut(23264,{he:r})}}function oE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Mt(t,e);const r=Ul(t),n=Ul(e),a=Mt(r.seconds,n.seconds);return a!==0?a:Mt(r.nanos,n.nanos)}function cE(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const i=vu(r[a],n[a]);if(i)return i}return Mt(r.length,n.length)}function yu(t){return _x(t)}function _x(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=Ul(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return zl(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return at.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",a=!0;for(const i of r.values||[])a?a=!1:n+=",",n+=_x(i);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let a="{",i=!0;for(const o of n)i?i=!1:a+=",",a+=`${o}:${_x(r.fields[o])}`;return a+"}"})(t.mapValue):ut(61005,{value:t})}function em(t){switch(Hl(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Zm(t);return e?16+em(e):16;case 5:return 2*t.stringValue.length;case 6:return zl(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,i)=>a+em(i)),0)})(t.arrayValue);case 10:case 11:return(function(n){let a=0;return Zl(n.fields,((i,o)=>{a+=i.length+em(o)})),a})(t.mapValue);default:throw ut(13486,{value:t})}}function uE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function wx(t){return!!t&&"integerValue"in t}function _v(t){return!!t&&"arrayValue"in t}function fE(t){return!!t&&"nullValue"in t}function hE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function tm(t){return!!t&&"mapValue"in t}function RD(t){return(t?.mapValue?.fields||{})[N4]?.stringValue===R4}function Kf(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Zl(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=Kf(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Kf(t.arrayValue.values[r]);return e}return{...t}}function ID(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===ND}class fa{constructor(e){this.value=e}static empty(){return new fa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!tm(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kf(r)}setAll(e){let r=An.emptyPath(),n={},a=[];e.forEach(((o,u)=>{if(!r.isImmediateParentOf(u)){const f=this.getFieldsMap(r);this.applyChanges(f,n,a),n={},a=[],r=u.popLast()}o?n[u.lastSegment()]=Kf(o):a.push(u.lastSegment())}));const i=this.getFieldsMap(r);this.applyChanges(i,n,a)}delete(e){const r=this.field(e.popLast());tm(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ks(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];tm(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Zl(r,((a,i)=>e[a]=i));for(const a of n)delete e[a]}clone(){return new fa(Kf(this.value))}}function I4(t){const e=[];return Zl(t.fields,((r,n)=>{const a=new An([r]);if(tm(n)){const i=I4(n.mapValue).fields;if(i.length===0)e.push(a);else for(const o of i)e.push(a.child(o))}else e.push(a)})),new Ra(e)}class Bn{constructor(e,r,n,a,i,o,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=i,this.data=o,this.documentState=u}static newInvalidDocument(e){return new Bn(e,0,pt.min(),pt.min(),pt.min(),fa.empty(),0)}static newFoundDocument(e,r,n,a){return new Bn(e,1,r,pt.min(),n,a,0)}static newNoDocument(e,r){return new Bn(e,2,r,pt.min(),pt.min(),fa.empty(),0)}static newUnknownDocument(e,r){return new Bn(e,3,r,pt.min(),pt.min(),fa.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(pt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Bn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class pm{constructor(e,r){this.position=e,this.inclusive=r}}function dE(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const i=e[a],o=t.position[a];if(i.field.isKeyField()?n=at.comparator(at.fromName(o.referenceValue),r.key):n=vu(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function mE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ks(t.position[r],e.position[r]))return!1;return!0}class p0{constructor(e,r="asc"){this.field=e,this.dir=r}}function DD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class D4{}class an extends D4{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new FD(e,r,n):r==="array-contains"?new jD(e,n):r==="in"?new LD(e,n):r==="not-in"?new BD(e,n):r==="array-contains-any"?new VD(e,n):new an(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new MD(e,n):new PD(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(vu(r,this.value)):r!==null&&Hl(this.value)===Hl(r)&&this.matchesComparison(vu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ut(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ss extends D4{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Ss(e,r)}matches(e){return O4(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function O4(t){return t.op==="and"}function F4(t){return OD(t)&&O4(t)}function OD(t){for(const e of t.filters)if(e instanceof Ss)return!1;return!0}function bx(t){if(t instanceof an)return t.field.canonicalString()+t.op.toString()+yu(t.value);if(F4(t))return t.filters.map((e=>bx(e))).join(",");{const e=t.filters.map((r=>bx(r))).join(",");return`${t.op}(${e})`}}function M4(t,e){return t instanceof an?(function(n,a){return a instanceof an&&n.op===a.op&&n.field.isEqual(a.field)&&Ks(n.value,a.value)})(t,e):t instanceof Ss?(function(n,a){return a instanceof Ss&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((i,o,u)=>i&&M4(o,a.filters[u])),!0):!1})(t,e):void ut(19439)}function P4(t){return t instanceof an?(function(r){return`${r.field.canonicalString()} ${r.op} ${yu(r.value)}`})(t):t instanceof Ss?(function(r){return r.op.toString()+" {"+r.getFilters().map(P4).join(" ,")+"}"})(t):"Filter"}class FD extends an{constructor(e,r,n){super(e,r,n),this.key=at.fromName(n.referenceValue)}matches(e){const r=at.comparator(e.key,this.key);return this.matchesComparison(r)}}class MD extends an{constructor(e,r){super(e,"in",r),this.keys=j4("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class PD extends an{constructor(e,r){super(e,"not-in",r),this.keys=j4("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function j4(t,e){return(e.arrayValue?.values||[]).map((r=>at.fromName(r.referenceValue)))}class jD extends an{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return _v(r)&&m0(r.arrayValue,this.value)}}class LD extends an{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&m0(this.value.arrayValue,r)}}class BD extends an{constructor(e,r){super(e,"not-in",r)}matches(e){if(m0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!m0(this.value.arrayValue,r)}}class VD extends an{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!_v(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>m0(this.value.arrayValue,n)))}}class UD{constructor(e,r=null,n=[],a=[],i=null,o=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=i,this.startAt=o,this.endAt=u,this.Te=null}}function pE(t,e=null,r=[],n=[],a=null,i=null,o=null){return new UD(t,e,r,n,a,i,o)}function wv(t){const e=xt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>bx(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(i){return i.field.canonicalString()+i.dir})(n))).join(","),Jm(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>yu(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>yu(n))).join(",")),e.Te=r}return e.Te}function bv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!DD(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!M4(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!mE(t.startAt,e.startAt)&&mE(t.endAt,e.endAt)}function Ex(t){return at.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Ou{constructor(e,r=null,n=[],a=[],i=null,o="F",u=null,f=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function zD(t,e,r,n,a,i,o,u){return new Ou(t,e,r,n,a,i,o,u)}function Ev(t){return new Ou(t)}function gE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function L4(t){return t.collectionGroup!==null}function Qf(t){const e=xt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new cn(An.comparator);return o.filters.forEach((f=>{f.getFlattenedFilters().forEach((d=>{d.isInequality()&&(u=u.add(d.field))}))})),u})(e).forEach((i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new p0(i,n))})),r.has(An.keyField().canonicalString())||e.Ie.push(new p0(An.keyField(),n))}return e.Ie}function Gs(t){const e=xt(t);return e.Ee||(e.Ee=HD(e,Qf(t))),e.Ee}function HD(t,e){if(t.limitType==="F")return pE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const i=a.dir==="desc"?"asc":"desc";return new p0(a.field,i)}));const r=t.endAt?new pm(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new pm(t.startAt.position,t.startAt.inclusive):null;return pE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Tx(t,e){const r=t.filters.concat([e]);return new Ou(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Sx(t,e,r){return new Ou(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function ep(t,e){return bv(Gs(t),Gs(e))&&t.limitType===e.limitType}function B4(t){return`${wv(Gs(t))}|lt:${t.limitType}`}function tu(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((a=>P4(a))).join(", ")}]`),Jm(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((a=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(a))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((a=>yu(a))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((a=>yu(a))).join(",")),`Target(${n})`})(Gs(t))}; limitType=${t.limitType})`}function tp(t,e){return e.isFoundDocument()&&(function(n,a){const i=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):at.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)})(t,e)&&(function(n,a){for(const i of Qf(n))if(!i.field.isKeyField()&&a.data.field(i.field)===null)return!1;return!0})(t,e)&&(function(n,a){for(const i of n.filters)if(!i.matches(a))return!1;return!0})(t,e)&&(function(n,a){return!(n.startAt&&!(function(o,u,f){const d=dE(o,u,f);return o.inclusive?d<=0:d<0})(n.startAt,Qf(n),a)||n.endAt&&!(function(o,u,f){const d=dE(o,u,f);return o.inclusive?d>=0:d>0})(n.endAt,Qf(n),a))})(t,e)}function GD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function V4(t){return(e,r)=>{let n=!1;for(const a of Qf(t)){const i=qD(a,e,r);if(i!==0)return i;n=n||a.field.isKeyField()}return 0}}function qD(t,e,r){const n=t.field.isKeyField()?at.comparator(e.key,r.key):(function(i,o,u){const f=o.data.field(i),d=u.data.field(i);return f!==null&&d!==null?vu(f,d):ut(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ut(19790,{direction:t.dir})}}class ac{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,i]of n)if(this.equalsFn(a,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<a.length;i++)if(this.equalsFn(a[i][0],e))return void(a[i]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Zl(this.inner,((r,n)=>{for(const[a,i]of n)e(a,i)}))}isEmpty(){return E4(this.inner)}size(){return this.innerSize}}const WD=new Rr(at.comparator);function Oi(){return WD}const U4=new Rr(at.comparator);function Hf(...t){let e=U4;for(const r of t)e=e.insert(r.key,r);return e}function z4(t){let e=U4;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function Fo(){return Jf()}function H4(){return Jf()}function Jf(){return new ac((t=>t.toString()),((t,e)=>t.isEqual(e)))}const XD=new Rr(at.comparator),YD=new cn(at.comparator);function Pt(...t){let e=YD;for(const r of t)e=e.add(r);return e}const $D=new cn(Mt);function KD(){return $D}function Tv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hm(e)?"-0":e}}function G4(t){return{integerValue:""+t}}function QD(t,e){return TD(e)?G4(e):Tv(t,e)}class rp{constructor(){this._=void 0}}function JD(t,e,r){return t instanceof gm?(function(a,i){const o={fields:{[A4]:{stringValue:S4},[C4]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return i&&yv(i)&&(i=Zm(i)),i&&(o.fields[k4]=i),{mapValue:o}})(r,e):t instanceof g0?W4(t,e):t instanceof x0?X4(t,e):(function(a,i){const o=q4(a,i),u=xE(o)+xE(a.Ae);return wx(o)&&wx(a.Ae)?G4(u):Tv(a.serializer,u)})(t,e)}function ZD(t,e,r){return t instanceof g0?W4(t,e):t instanceof x0?X4(t,e):r}function q4(t,e){return t instanceof xm?(function(n){return wx(n)||(function(i){return!!i&&"doubleValue"in i})(n)})(e)?e:{integerValue:0}:null}class gm extends rp{}class g0 extends rp{constructor(e){super(),this.elements=e}}function W4(t,e){const r=Y4(e);for(const n of t.elements)r.some((a=>Ks(a,n)))||r.push(n);return{arrayValue:{values:r}}}class x0 extends rp{constructor(e){super(),this.elements=e}}function X4(t,e){let r=Y4(e);for(const n of t.elements)r=r.filter((a=>!Ks(a,n)));return{arrayValue:{values:r}}}class xm extends rp{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function xE(t){return Gr(t.integerValue||t.doubleValue)}function Y4(t){return _v(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function e8(t,e){return t.field.isEqual(e.field)&&(function(n,a){return n instanceof g0&&a instanceof g0||n instanceof x0&&a instanceof x0?xu(n.elements,a.elements,Ks):n instanceof xm&&a instanceof xm?Ks(n.Ae,a.Ae):n instanceof gm&&a instanceof gm})(t.transform,e.transform)}class t8{constructor(e,r){this.version=e,this.transformResults=r}}class Jn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Jn}static exists(e){return new Jn(void 0,e)}static updateTime(e){return new Jn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function rm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class np{}function $4(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ap(t.key,Jn.none()):new V0(t.key,t.data,Jn.none());{const r=t.data,n=fa.empty();let a=new cn(An.comparator);for(let i of e.fields)if(!a.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),a=a.add(i)}return new eo(t.key,n,new Ra(a.toArray()),Jn.none())}}function r8(t,e,r){t instanceof V0?(function(a,i,o){const u=a.value.clone(),f=yE(a.fieldTransforms,i,o.transformResults);u.setAll(f),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(t,e,r):t instanceof eo?(function(a,i,o){if(!rm(a.precondition,i))return void i.convertToUnknownDocument(o.version);const u=yE(a.fieldTransforms,i,o.transformResults),f=i.data;f.setAll(K4(a)),f.setAll(u),i.convertToFoundDocument(o.version,f).setHasCommittedMutations()})(t,e,r):(function(a,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,r)}function Zf(t,e,r,n){return t instanceof V0?(function(i,o,u,f){if(!rm(i.precondition,o))return u;const d=i.value.clone(),m=_E(i.fieldTransforms,f,o);return d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(t,e,r,n):t instanceof eo?(function(i,o,u,f){if(!rm(i.precondition,o))return u;const d=_E(i.fieldTransforms,f,o),m=o.data;return m.setAll(K4(i)),m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),u===null?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((x=>x.field)))})(t,e,r,n):(function(i,o,u){return rm(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u})(t,e,r)}function n8(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),i=q4(n.transform,a||null);i!=null&&(r===null&&(r=fa.empty()),r.set(n.field,i))}return r||null}function vE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&xu(n,a,((i,o)=>e8(i,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class V0 extends np{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class eo extends np{constructor(e,r,n,a,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function K4(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function yE(t,e,r){const n=new Map;$t(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let a=0;a<r.length;a++){const i=t[a],o=i.transform,u=e.data.field(i.field);n.set(i.field,ZD(o,u,r[a]))}return n}function _E(t,e,r){const n=new Map;for(const a of t){const i=a.transform,o=r.data.field(a.field);n.set(a.field,JD(i,o,e))}return n}class ap extends np{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class a8 extends np{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class s8{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const i=this.mutations[a];i.key.isEqual(e.key)&&r8(i,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Zf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Zf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=H4();return this.mutations.forEach((a=>{const i=e.get(a.key),o=i.overlayedDocument;let u=this.applyToLocalView(o,i.mutatedFields);u=r.has(a.key)?null:u;const f=$4(o,u);f!==null&&n.set(a.key,f),o.isValidDocument()||o.convertToNoDocument(pt.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Pt())}isEqual(e){return this.batchId===e.batchId&&xu(this.mutations,e.mutations,((r,n)=>vE(r,n)))&&xu(this.baseMutations,e.baseMutations,((r,n)=>vE(r,n)))}}class Sv{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){$t(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return XD})();const i=e.mutations;for(let o=0;o<i.length;o++)a=a.insert(i[o].key,n[o].version);return new Sv(e,r,n,a)}}class i8{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class l8{constructor(e,r){this.count=e,this.unchangedNames=r}}var en,Lt;function o8(t){switch(t){case Ie.OK:return ut(64938);case Ie.CANCELLED:case Ie.UNKNOWN:case Ie.DEADLINE_EXCEEDED:case Ie.RESOURCE_EXHAUSTED:case Ie.INTERNAL:case Ie.UNAVAILABLE:case Ie.UNAUTHENTICATED:return!1;case Ie.INVALID_ARGUMENT:case Ie.NOT_FOUND:case Ie.ALREADY_EXISTS:case Ie.PERMISSION_DENIED:case Ie.FAILED_PRECONDITION:case Ie.ABORTED:case Ie.OUT_OF_RANGE:case Ie.UNIMPLEMENTED:case Ie.DATA_LOSS:return!0;default:return ut(15467,{code:t})}}function Q4(t){if(t===void 0)return Di("GRPC error has no .code"),Ie.UNKNOWN;switch(t){case en.OK:return Ie.OK;case en.CANCELLED:return Ie.CANCELLED;case en.UNKNOWN:return Ie.UNKNOWN;case en.DEADLINE_EXCEEDED:return Ie.DEADLINE_EXCEEDED;case en.RESOURCE_EXHAUSTED:return Ie.RESOURCE_EXHAUSTED;case en.INTERNAL:return Ie.INTERNAL;case en.UNAVAILABLE:return Ie.UNAVAILABLE;case en.UNAUTHENTICATED:return Ie.UNAUTHENTICATED;case en.INVALID_ARGUMENT:return Ie.INVALID_ARGUMENT;case en.NOT_FOUND:return Ie.NOT_FOUND;case en.ALREADY_EXISTS:return Ie.ALREADY_EXISTS;case en.PERMISSION_DENIED:return Ie.PERMISSION_DENIED;case en.FAILED_PRECONDITION:return Ie.FAILED_PRECONDITION;case en.ABORTED:return Ie.ABORTED;case en.OUT_OF_RANGE:return Ie.OUT_OF_RANGE;case en.UNIMPLEMENTED:return Ie.UNIMPLEMENTED;case en.DATA_LOSS:return Ie.DATA_LOSS;default:return ut(39323,{code:t})}}(Lt=en||(en={}))[Lt.OK=0]="OK",Lt[Lt.CANCELLED=1]="CANCELLED",Lt[Lt.UNKNOWN=2]="UNKNOWN",Lt[Lt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Lt[Lt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Lt[Lt.NOT_FOUND=5]="NOT_FOUND",Lt[Lt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Lt[Lt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Lt[Lt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Lt[Lt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Lt[Lt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Lt[Lt.ABORTED=10]="ABORTED",Lt[Lt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Lt[Lt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Lt[Lt.INTERNAL=13]="INTERNAL",Lt[Lt.UNAVAILABLE=14]="UNAVAILABLE",Lt[Lt.DATA_LOSS=15]="DATA_LOSS";function c8(){return new TextEncoder}const u8=new Fl([4294967295,4294967295],0);function wE(t){const e=c8().encode(t),r=new h4;return r.update(e),new Uint8Array(r.digest())}function bE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Fl([r,n],0),new Fl([a,i],0)]}class Av{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Gf(`Invalid padding: ${r}`);if(n<0)throw new Gf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Gf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Gf(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Fl.fromNumber(this.ge)}ye(e,r,n){let a=e.add(r.multiply(Fl.fromNumber(n)));return a.compare(u8)===1&&(a=new Fl([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=wE(e),[n,a]=bE(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,a,i);if(!this.we(o))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Av(i,a,r);return n.forEach((u=>o.insert(u))),o}insert(e){if(this.ge===0)return;const r=wE(e),[n,a]=bE(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,a,i);this.Se(o)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Gf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class sp{constructor(e,r,n,a,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,U0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new sp(pt.min(),a,new Rr(Mt),Oi(),Pt())}}class U0{constructor(e,r,n,a,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new U0(n,r,Pt(),Pt(),Pt())}}class nm{constructor(e,r,n,a){this.be=e,this.removedTargetIds=r,this.key=n,this.De=a}}class J4{constructor(e,r){this.targetId=e,this.Ce=r}}class Z4{constructor(e,r,n=Cn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class EE{constructor(){this.ve=0,this.Fe=TE(),this.Me=Cn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Pt(),r=Pt(),n=Pt();return this.Fe.forEach(((a,i)=>{switch(i){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:ut(38017,{changeType:i})}})),new U0(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=TE()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,$t(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class f8{constructor(e){this.Ge=e,this.ze=new Map,this.je=Oi(),this.Je=Md(),this.He=Md(),this.Ye=new Rr(Mt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ut(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,a)=>{this.rt(a)&&r(a)}))}st(e){const r=e.targetId,n=e.Ce.count,a=this.ot(r);if(a){const i=a.target;if(Ex(i))if(n===0){const o=new at(i.path);this.et(r,o,Bn.newNoDocument(o,pt.min()))}else $t(n===1,20013,{expectedCount:n});else{const o=this._t(r);if(o!==n){const u=this.ut(e),f=u?this.ct(u,e,o):1;if(f!==0){this.it(r);const d=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,d)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:i=0}=r;let o,u;try{o=zl(n).toUint8Array()}catch(f){if(f instanceof T4)return gu("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new Av(o,a,i)}catch(f){return gu(f instanceof Gf?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.ge===0?null:u}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let a=0;return n.forEach((i=>{const o=this.Ge.ht(),u=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(u)||(this.et(r,i,null),a++)})),a}Tt(e){const r=new Map;this.ze.forEach(((i,o)=>{const u=this.ot(o);if(u){if(i.current&&Ex(u.target)){const f=new at(u.target.path);this.It(f).has(o)||this.Et(o,f)||this.et(o,f,Bn.newNoDocument(f,e))}i.Be&&(r.set(o,i.ke()),i.qe())}}));let n=Pt();this.He.forEach(((i,o)=>{let u=!0;o.forEachWhile((f=>{const d=this.ot(f);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const a=new sp(e,r,this.Ye,this.je,n);return this.je=Oi(),this.Je=Md(),this.He=Md(),this.Ye=new Rr(Mt),a}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,r)?a.Qe(r,1):a.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new EE,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new cn(Mt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new cn(Mt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Ke("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new EE),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Md(){return new Rr(at.comparator)}function TE(){return new Rr(at.comparator)}const h8={asc:"ASCENDING",desc:"DESCENDING"},d8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},m8={and:"AND",or:"OR"};class p8{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Ax(t,e){return t.useProto3Json||Jm(e)?e:{value:e}}function vm(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function eA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function g8(t,e){return vm(t,e.toTimestamp())}function qs(t){return $t(!!t,49232),pt.fromTimestamp((function(r){const n=Ul(r);return new _r(n.seconds,n.nanos)})(t))}function kv(t,e){return kx(t,e).canonicalString()}function kx(t,e){const r=(function(a){return new pr(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?r:r.child(e)}function tA(t){const e=pr.fromString(t);return $t(iA(e),10190,{key:e.toString()}),e}function Cx(t,e){return kv(t.databaseId,e.path)}function B1(t,e){const r=tA(e);if(r.get(1)!==t.databaseId.projectId)throw new Xe(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Xe(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new at(nA(r))}function rA(t,e){return kv(t.databaseId,e)}function x8(t){const e=tA(t);return e.length===4?pr.emptyPath():nA(e)}function Nx(t){return new pr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function nA(t){return $t(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function SE(t,e,r){return{name:Cx(t,e),fields:r.value.mapValue.fields}}function v8(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ut(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],i=(function(d,m){return d.useProto3Json?($t(m===void 0||typeof m=="string",58123),Cn.fromBase64String(m||"")):($t(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Cn.fromUint8Array(m||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&(function(d){const m=d.code===void 0?Ie.UNKNOWN:Q4(d.code);return new Xe(m,d.message||"")})(o);r=new Z4(n,a,i,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=B1(t,n.document.name),i=qs(n.document.updateTime),o=n.document.createTime?qs(n.document.createTime):pt.min(),u=new fa({mapValue:{fields:n.document.fields}}),f=Bn.newFoundDocument(a,i,o,u),d=n.targetIds||[],m=n.removedTargetIds||[];r=new nm(d,m,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=B1(t,n.document),i=n.readTime?qs(n.readTime):pt.min(),o=Bn.newNoDocument(a,i),u=n.removedTargetIds||[];r=new nm([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=B1(t,n.document),i=n.removedTargetIds||[];r=new nm([],i,a,null)}else{if(!("filter"in e))return ut(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:i}=n,o=new l8(a,i),u=n.targetId;r=new J4(u,o)}}return r}function y8(t,e){let r;if(e instanceof V0)r={update:SE(t,e.key,e.value)};else if(e instanceof ap)r={delete:Cx(t,e.key)};else if(e instanceof eo)r={update:SE(t,e.key,e.data),updateMask:C8(e.fieldMask)};else{if(!(e instanceof a8))return ut(16599,{Vt:e.type});r={verify:Cx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(i,o){const u=o.transform;if(u instanceof gm)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof g0)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof x0)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof xm)return{fieldPath:o.field.canonicalString(),increment:u.Ae};throw ut(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(a,i){return i.updateTime!==void 0?{updateTime:g8(a,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ut(27497)})(t,e.precondition)),r}function _8(t,e){return t&&t.length>0?($t(e!==void 0,14353),t.map((r=>(function(a,i){let o=a.updateTime?qs(a.updateTime):qs(i);return o.isEqual(pt.min())&&(o=qs(i)),new t8(o,a.transformResults||[])})(r,e)))):[]}function w8(t,e){return{documents:[rA(t,e.path)]}}function b8(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=rA(t,a);const i=(function(d){if(d.length!==0)return sA(Ss.create(d,"and"))})(e.filters);i&&(r.structuredQuery.where=i);const o=(function(d){if(d.length!==0)return d.map((m=>(function(y){return{field:ru(y.field),direction:S8(y.dir)}})(m)))})(e.orderBy);o&&(r.structuredQuery.orderBy=o);const u=Ax(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:r,parent:a}}function E8(t){let e=x8(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){$t(n===1,65062);const m=r.from[0];m.allDescendants?a=m.collectionId:e=e.child(m.collectionId)}let i=[];r.where&&(i=(function(x){const y=aA(x);return y instanceof Ss&&F4(y)?y.getFilters():[y]})(r.where));let o=[];r.orderBy&&(o=(function(x){return x.map((y=>(function(E){return new p0(nu(E.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(E.direction))})(y)))})(r.orderBy));let u=null;r.limit&&(u=(function(x){let y;return y=typeof x=="object"?x.value:x,Jm(y)?null:y})(r.limit));let f=null;r.startAt&&(f=(function(x){const y=!!x.before,b=x.values||[];return new pm(b,y)})(r.startAt));let d=null;return r.endAt&&(d=(function(x){const y=!x.before,b=x.values||[];return new pm(b,y)})(r.endAt)),zD(e,a,o,i,u,"F",f,d)}function T8(t,e){const r=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ut(28987,{purpose:a})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function aA(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=nu(r.unaryFilter.field);return an.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=nu(r.unaryFilter.field);return an.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=nu(r.unaryFilter.field);return an.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=nu(r.unaryFilter.field);return an.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ut(61313);default:return ut(60726)}})(t):t.fieldFilter!==void 0?(function(r){return an.create(nu(r.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ut(58110);default:return ut(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return Ss.create(r.compositeFilter.filters.map((n=>aA(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ut(1026)}})(r.compositeFilter.op))})(t):ut(30097,{filter:t})}function S8(t){return h8[t]}function A8(t){return d8[t]}function k8(t){return m8[t]}function ru(t){return{fieldPath:t.canonicalString()}}function nu(t){return An.fromServerFormat(t.fieldPath)}function sA(t){return t instanceof an?(function(r){if(r.op==="=="){if(hE(r.value))return{unaryFilter:{field:ru(r.field),op:"IS_NAN"}};if(fE(r.value))return{unaryFilter:{field:ru(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(hE(r.value))return{unaryFilter:{field:ru(r.field),op:"IS_NOT_NAN"}};if(fE(r.value))return{unaryFilter:{field:ru(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ru(r.field),op:A8(r.op),value:r.value}}})(t):t instanceof Ss?(function(r){const n=r.getFilters().map((a=>sA(a)));return n.length===1?n[0]:{compositeFilter:{op:k8(r.op),filters:n}}})(t):ut(54877,{filter:t})}function C8(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function iA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Cl{constructor(e,r,n,a,i=pt.min(),o=pt.min(),u=Cn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new Cl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Cl(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class N8{constructor(e){this.yt=e}}function R8(t){const e=E8({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Sx(e,e.limit,"L"):e}class I8{constructor(){this.Cn=new D8}addToCollectionParentIndex(e,r){return this.Cn.add(r),Oe.resolve()}getCollectionParents(e,r){return Oe.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Oe.resolve()}deleteFieldIndex(e,r){return Oe.resolve()}deleteAllFieldIndexes(e){return Oe.resolve()}createTargetIndexes(e,r){return Oe.resolve()}getDocumentsMatchingTarget(e,r){return Oe.resolve(null)}getIndexType(e,r){return Oe.resolve(0)}getFieldIndexes(e,r){return Oe.resolve([])}getNextCollectionGroupToUpdate(e){return Oe.resolve(null)}getMinOffset(e,r){return Oe.resolve(Vl.min())}getMinOffsetFromCollectionGroup(e,r){return Oe.resolve(Vl.min())}updateCollectionGroup(e,r,n){return Oe.resolve()}updateIndexEntries(e,r){return Oe.resolve()}}class D8{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new cn(pr.comparator),i=!a.has(n);return this.index[r]=a.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new cn(pr.comparator)).toArray()}}const AE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lA=41943040;class ca{static withCacheSize(e){return new ca(e,ca.DEFAULT_COLLECTION_PERCENTILE,ca.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}ca.DEFAULT_COLLECTION_PERCENTILE=10,ca.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ca.DEFAULT=new ca(lA,ca.DEFAULT_COLLECTION_PERCENTILE,ca.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ca.DISABLED=new ca(-1,0,0);class _u{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new _u(0)}static cr(){return new _u(-1)}}const kE="LruGarbageCollector",O8=1048576;function CE([t,e],[r,n]){const a=Mt(t,r);return a===0?Mt(e,n):a}class F8{constructor(e){this.Ir=e,this.buffer=new cn(CE),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();CE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class M8{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ke(kE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Du(r)?Ke(kE,"Ignoring IndexedDB error during garbage collection: ",r):await Iu(r)}await this.Vr(3e5)}))}}class P8{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return Oe.resolve(Qm.ce);const n=new F8(r);return this.mr.forEachTarget(e,(a=>n.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>n.Ar(a))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ke("LruGarbageCollector","Garbage collection skipped; disabled"),Oe.resolve(AE)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Ke("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),AE):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,a,i,o,u,f,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(Ke("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),a=this.params.maximumSequenceNumbersToCollect):a=x,o=Date.now(),this.nthSequenceNumber(e,a)))).next((x=>(n=x,u=Date.now(),this.removeTargets(e,n,r)))).next((x=>(i=x,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((x=>(d=Date.now(),eu()<=Ft.DEBUG&&Ke("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${a} in `+(u-o)+`ms
	Removed ${i} targets in `+(f-u)+`ms
	Removed ${x} documents in `+(d-f)+`ms
Total Duration: ${d-m}ms`),Oe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:i,documentsRemoved:x}))))}}function j8(t,e){return new P8(t,e)}class L8{constructor(){this.changes=new ac((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Bn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Oe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class B8{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}class V8{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,r)))).next((a=>(n!==null&&Zf(n.mutation,a,Ra.empty(),_r.now()),a)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Pt()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Pt()){const a=Fo();return this.populateOverlays(e,a,r).next((()=>this.computeViews(e,r,a,n).next((i=>{let o=Hf();return i.forEach(((u,f)=>{o=o.insert(u,f.overlayedDocument)})),o}))))}getOverlayedDocuments(e,r){const n=Fo();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Pt())))}populateOverlays(e,r,n){const a=[];return n.forEach((i=>{r.has(i)||a.push(i)})),this.documentOverlayCache.getOverlays(e,a).next((i=>{i.forEach(((o,u)=>{r.set(o,u)}))}))}computeViews(e,r,n,a){let i=Oi();const o=Jf(),u=(function(){return Jf()})();return r.forEach(((f,d)=>{const m=n.get(d.key);a.has(d.key)&&(m===void 0||m.mutation instanceof eo)?i=i.insert(d.key,d):m!==void 0?(o.set(d.key,m.mutation.getFieldMask()),Zf(m.mutation,d,m.mutation.getFieldMask(),_r.now())):o.set(d.key,Ra.empty())})),this.recalculateAndSaveOverlays(e,i).next((f=>(f.forEach(((d,m)=>o.set(d,m))),r.forEach(((d,m)=>u.set(d,new B8(m,o.get(d)??null)))),u)))}recalculateAndSaveOverlays(e,r){const n=Jf();let a=new Rr(((o,u)=>o-u)),i=Pt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((o=>{for(const u of o)u.keys().forEach((f=>{const d=r.get(f);if(d===null)return;let m=n.get(f)||Ra.empty();m=u.applyToLocalView(d,m),n.set(f,m);const x=(a.get(u.batchId)||Pt()).add(f);a=a.insert(u.batchId,x)}))})).next((()=>{const o=[],u=a.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),d=f.key,m=f.value,x=H4();m.forEach((y=>{if(!i.has(y)){const b=$4(r.get(y),n.get(y));b!==null&&x.set(y,b),i=i.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,x))}return Oe.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,a){return(function(o){return at.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):L4(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next((i=>{const o=a-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-i.size):Oe.resolve(Fo());let u=f0,f=i;return o.next((d=>Oe.forEach(d,((m,x)=>(u<x.largestBatchId&&(u=x.largestBatchId),i.get(m)?Oe.resolve():this.remoteDocumentCache.getEntry(e,m).next((y=>{f=f.insert(m,y)}))))).next((()=>this.populateOverlays(e,d,i))).next((()=>this.computeViews(e,f,d,Pt()))).next((m=>({batchId:u,changes:z4(m)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new at(r)).next((n=>{let a=Hf();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const i=r.collectionGroup;let o=Hf();return this.indexManager.getCollectionParents(e,i).next((u=>Oe.forEach(u,(f=>{const d=(function(x,y){return new Ou(y,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(r,f.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next((m=>{m.forEach(((x,y)=>{o=o.insert(x,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,r,n,a){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,a)))).next((o=>{i.forEach(((f,d)=>{const m=d.getKey();o.get(m)===null&&(o=o.insert(m,Bn.newInvalidDocument(m)))}));let u=Hf();return o.forEach(((f,d)=>{const m=i.get(f);m!==void 0&&Zf(m.mutation,d,Ra.empty(),_r.now()),tp(r,d)&&(u=u.insert(f,d))})),u}))}}class U8{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Oe.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(a){return{id:a.id,version:a.version,createTime:qs(a.createTime)}})(r)),Oe.resolve()}getNamedQuery(e,r){return Oe.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(a){return{name:a.name,query:R8(a.bundledQuery),readTime:qs(a.readTime)}})(r)),Oe.resolve()}}class z8{constructor(){this.overlays=new Rr(at.comparator),this.qr=new Map}getOverlay(e,r){return Oe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Fo();return Oe.forEach(r,(a=>this.getOverlay(e,a).next((i=>{i!==null&&n.set(a,i)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((a,i)=>{this.St(e,r,i)})),Oe.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.qr.get(n);return a!==void 0&&(a.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(n)),Oe.resolve()}getOverlaysForCollection(e,r,n){const a=Fo(),i=r.length+1,o=new at(r.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const f=u.getNext().value,d=f.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===i&&f.largestBatchId>n&&a.set(f.getKey(),f)}return Oe.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let i=new Rr(((d,m)=>d-m));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let m=i.get(d.largestBatchId);m===null&&(m=Fo(),i=i.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const u=Fo(),f=i.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((d,m)=>u.set(d,m))),!(u.size()>=a)););return Oe.resolve(u)}St(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const o=this.qr.get(a.largestBatchId).delete(n.key);this.qr.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new i8(r,n));let i=this.qr.get(r);i===void 0&&(i=Pt(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}class H8{constructor(){this.sessionToken=Cn.EMPTY_BYTE_STRING}getSessionToken(e){return Oe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Oe.resolve()}}class Cv{constructor(){this.Qr=new cn(mn.$r),this.Ur=new cn(mn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new mn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new mn(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new at(new pr([])),n=new mn(r,e),a=new mn(r,e+1),i=[];return this.Ur.forEachInRange([n,a],(o=>{this.Gr(o),i.push(o.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new at(new pr([])),n=new mn(r,e),a=new mn(r,e+1);let i=Pt();return this.Ur.forEachInRange([n,a],(o=>{i=i.add(o.key)})),i}containsKey(e){const r=new mn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class mn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return at.comparator(e.key,r.key)||Mt(e.Yr,r.Yr)}static Kr(e,r){return Mt(e.Yr,r.Yr)||at.comparator(e.key,r.key)}}class G8{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new cn(mn.$r)}checkEmpty(e){return Oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new s8(i,r,n,a);this.mutationQueue.push(o);for(const u of a)this.Zr=this.Zr.add(new mn(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Oe.resolve(o)}lookupMutationBatch(e,r){return Oe.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.ei(n),i=a<0?0:a;return Oe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Oe.resolve(this.mutationQueue.length===0?vv:this.tr-1)}getAllMutationBatches(e){return Oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new mn(r,0),a=new mn(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,a],(o=>{const u=this.Xr(o.Yr);i.push(u)})),Oe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new cn(Mt);return r.forEach((a=>{const i=new mn(a,0),o=new mn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],(u=>{n=n.add(u.Yr)}))})),Oe.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let i=n;at.isDocumentKey(i)||(i=i.child(""));const o=new mn(new at(i),0);let u=new cn(Mt);return this.Zr.forEachWhile((f=>{const d=f.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(u=u.add(f.Yr)),!0)}),o),Oe.resolve(this.ti(u))}ti(e){const r=[];return e.forEach((n=>{const a=this.Xr(n);a!==null&&r.push(a)})),r}removeMutationBatch(e,r){$t(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Oe.forEach(r.mutations,(a=>{const i=new mn(a.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new mn(r,0),a=this.Zr.firstAfterOrEqual(n);return Oe.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Oe.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}class q8{constructor(e){this.ri=e,this.docs=(function(){return new Rr(at.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),i=a?a.size:0,o=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Oe.resolve(n?n.document.mutableCopy():Bn.newInvalidDocument(r))}getEntries(e,r){let n=Oi();return r.forEach((a=>{const i=this.docs.get(a);n=n.insert(a,i?i.document.mutableCopy():Bn.newInvalidDocument(a))})),Oe.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let i=Oi();const o=r.path,u=new at(o.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:d,value:{document:m}}=f.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||_D(yD(m),n)<=0||(a.has(m.key)||tp(r,m))&&(i=i.insert(m.key,m.mutableCopy()))}return Oe.resolve(i)}getAllFromCollectionGroup(e,r,n,a){ut(9500)}ii(e,r){return Oe.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new W8(this)}getSize(e){return Oe.resolve(this.size)}}class W8 extends L8{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?r.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(n)})),Oe.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}class X8{constructor(e){this.persistence=e,this.si=new ac((r=>wv(r)),bv),this.lastRemoteSnapshotVersion=pt.min(),this.highestTargetId=0,this.oi=0,this._i=new Cv,this.targetCount=0,this.ai=_u.ur()}forEachTarget(e,r){return this.si.forEach(((n,a)=>r(a))),Oe.resolve()}getLastRemoteSnapshotVersion(e){return Oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Oe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Oe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Oe.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new _u(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Oe.resolve()}updateTargetData(e,r){return this.Pr(r),Oe.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Oe.resolve()}removeTargets(e,r,n){let a=0;const i=[];return this.si.forEach(((o,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)})),Oe.waitFor(i).next((()=>a))}getTargetCount(e){return Oe.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Oe.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Oe.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const a=this.persistence.referenceDelegate,i=[];return a&&r.forEach((o=>{i.push(a.markPotentiallyOrphaned(e,o))})),Oe.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Oe.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Oe.resolve(n)}containsKey(e,r){return Oe.resolve(this._i.containsKey(r))}}class oA{constructor(e,r){this.ui={},this.overlays={},this.ci=new Qm(0),this.li=!1,this.li=!0,this.hi=new H8,this.referenceDelegate=e(this),this.Pi=new X8(this),this.indexManager=new I8,this.remoteDocumentCache=(function(a){return new q8(a)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new N8(r),this.Ii=new U8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new z8,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new G8(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Ke("MemoryPersistence","Starting transaction:",e);const a=new Y8(this.ci.next());return this.referenceDelegate.Ei(),n(a).next((i=>this.referenceDelegate.di(a).next((()=>i)))).toPromise().then((i=>(a.raiseOnCommittedEvent(),i)))}Ai(e,r){return Oe.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class Y8 extends bD{constructor(e){super(),this.currentSequenceNumber=e}}class Nv{constructor(e){this.persistence=e,this.Ri=new Cv,this.Vi=null}static mi(e){return new Nv(e)}get fi(){if(this.Vi)return this.Vi;throw ut(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Oe.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Oe.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Oe.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((a=>this.fi.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((a=>{a.forEach((i=>this.fi.add(i.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Oe.forEach(this.fi,(n=>{const a=at.fromPath(n);return this.gi(e,a).next((i=>{i||r.removeEntry(a,pt.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return Oe.or([()=>Oe.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class ym{constructor(e,r){this.persistence=e,this.pi=new ac((n=>SD(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=j8(this,r)}static mi(e,r){return new ym(e,r)}Ei(){}di(e){return Oe.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((a=>n+a))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return Oe.forEach(this.pi,((n,a)=>this.br(e,n,a).next((i=>i?Oe.resolve():r(a)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),i=a.newChangeBuffer();return a.ii(e,(o=>this.br(e,o,r).next((u=>{u||(n++,i.removeEntry(o,pt.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Oe.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Oe.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Oe.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Oe.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=em(e.data.value)),r}br(e,r,n){return Oe.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.pi.get(r);return Oe.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Rv{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=a}static As(e,r){let n=Pt(),a=Pt();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:a=a.add(i.doc.key)}return new Rv(e,r.fromCache,n,a)}}class $8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class K8{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return H5()?8:ED(Gn())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,a){const i={result:null};return this.ys(e,r).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ws(e,r,a,n).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new $8;return this.Ss(e,r,o).next((u=>{if(i.result=u,this.Vs)return this.bs(e,r,o,u.size)}))})).next((()=>i.result))}bs(e,r,n,a){return n.documentReadCount<this.fs?(eu()<=Ft.DEBUG&&Ke("QueryEngine","SDK will not create cache indexes for query:",tu(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Oe.resolve()):(eu()<=Ft.DEBUG&&Ke("QueryEngine","Query:",tu(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.gs*a?(eu()<=Ft.DEBUG&&Ke("QueryEngine","The SDK decides to create cache indexes for query:",tu(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Gs(r))):Oe.resolve())}ys(e,r){if(gE(r))return Oe.resolve(null);let n=Gs(r);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(r.limit!==null&&a===1&&(r=Sx(r,null,"F"),n=Gs(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const o=Pt(...i);return this.ps.getDocuments(e,o).next((u=>this.indexManager.getMinOffset(e,n).next((f=>{const d=this.Ds(r,u);return this.Cs(r,d,o,f.readTime)?this.ys(e,Sx(r,null,"F")):this.vs(e,d,r,f)}))))})))))}ws(e,r,n,a){return gE(r)||a.isEqual(pt.min())?Oe.resolve(null):this.ps.getDocuments(e,n).next((i=>{const o=this.Ds(r,i);return this.Cs(r,o,n,a)?Oe.resolve(null):(eu()<=Ft.DEBUG&&Ke("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),tu(r)),this.vs(e,o,r,vD(a,f0)).next((u=>u)))}))}Ds(e,r){let n=new cn(V4(e));return r.forEach(((a,i)=>{tp(e,i)&&(n=n.add(i))})),n}Cs(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(a)>0)}Ss(e,r,n){return eu()<=Ft.DEBUG&&Ke("QueryEngine","Using full collection scan to execute query:",tu(r)),this.ps.getDocumentsMatchingQuery(e,r,Vl.min(),n)}vs(e,r,n,a){return this.ps.getDocumentsMatchingQuery(e,n,a).next((i=>(r.forEach((o=>{i=i.insert(o.key,o)})),i)))}}const Iv="LocalStore",Q8=3e8;class J8{constructor(e,r,n,a){this.persistence=e,this.Fs=r,this.serializer=a,this.Ms=new Rr(Mt),this.xs=new ac((i=>wv(i)),bv),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new V8(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function Z8(t,e,r,n){return new J8(t,e,r,n)}async function cA(t,e){const r=xt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next((i=>(a=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((i=>{const o=[],u=[];let f=Pt();for(const d of a){o.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}for(const d of i){u.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}return r.localDocuments.getDocuments(n,f).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:u})))}))}))}function eO(t,e){const r=xt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,f,d,m){const x=d.batch,y=x.keys();let b=Oe.resolve();return y.forEach((E=>{b=b.next((()=>m.getEntry(f,E))).next((w=>{const T=d.docVersions.get(E);$t(T!==null,48541),w.version.compareTo(T)<0&&(x.applyToRemoteDocument(w,d),w.isValidDocument()&&(w.setReadTime(d.commitVersion),m.addEntry(w)))}))})),b.next((()=>u.mutationQueue.removeMutationBatch(f,x)))})(r,n,e,i).next((()=>i.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let f=Pt();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(f=f.add(u.batch.mutations[d].key));return f})(e)))).next((()=>r.localDocuments.getDocuments(n,a)))}))}function uA(t){const e=xt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function tO(t,e){const r=xt(t),n=e.snapshotVersion;let a=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=r.Ns.newChangeBuffer({trackRemovals:!0});a=r.Ms;const u=[];e.targetChanges.forEach(((m,x)=>{const y=a.get(x);if(!y)return;u.push(r.Pi.removeMatchingKeys(i,m.removedDocuments,x).next((()=>r.Pi.addMatchingKeys(i,m.addedDocuments,x))));let b=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(x)!==null?b=b.withResumeToken(Cn.EMPTY_BYTE_STRING,pt.min()).withLastLimboFreeSnapshotVersion(pt.min()):m.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(m.resumeToken,n)),a=a.insert(x,b),(function(w,T,R){return w.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=Q8?!0:R.addedDocuments.size+R.modifiedDocuments.size+R.removedDocuments.size>0})(y,b,m)&&u.push(r.Pi.updateTargetData(i,b))}));let f=Oi(),d=Pt();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(i,m))})),u.push(rO(i,o,e.documentUpdates).next((m=>{f=m.ks,d=m.qs}))),!n.isEqual(pt.min())){const m=r.Pi.getLastRemoteSnapshotVersion(i).next((x=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n)));u.push(m)}return Oe.waitFor(u).next((()=>o.apply(i))).next((()=>r.localDocuments.getLocalViewOfDocuments(i,f,d))).next((()=>f))})).then((i=>(r.Ms=a,i)))}function rO(t,e,r){let n=Pt(),a=Pt();return r.forEach((i=>n=n.add(i))),e.getEntries(t,n).next((i=>{let o=Oi();return r.forEach(((u,f)=>{const d=i.get(u);f.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(u)),f.isNoDocument()&&f.version.isEqual(pt.min())?(e.removeEntry(u,f.readTime),o=o.insert(u,f)):!d.isValidDocument()||f.version.compareTo(d.version)>0||f.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(f),o=o.insert(u,f)):Ke(Iv,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",f.version)})),{ks:o,qs:a}}))}function nO(t,e){const r=xt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=vv),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function aO(t,e){const r=xt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return r.Pi.getTargetData(n,e).next((i=>i?(a=i,Oe.resolve(a)):r.Pi.allocateTargetId(n).next((o=>(a=new Cl(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=r.Ms.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function Rx(t,e,r){const n=xt(t),a=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,(o=>n.persistence.referenceDelegate.removeTarget(o,a)))}catch(o){if(!Du(o))throw o;Ke(Iv,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(a.target)}function NE(t,e,r){const n=xt(t);let a=pt.min(),i=Pt();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(f,d,m){const x=xt(f),y=x.xs.get(m);return y!==void 0?Oe.resolve(x.Ms.get(y)):x.Pi.getTargetData(d,m)})(n,o,Gs(e)).next((u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,u.targetId).next((f=>{i=f}))})).next((()=>n.Fs.getDocumentsMatchingQuery(o,e,r?a:pt.min(),r?i:Pt()))).next((u=>(sO(n,GD(e),u),{documents:u,Qs:i})))))}function sO(t,e,r){let n=t.Os.get(e)||pt.min();r.forEach(((a,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)})),t.Os.set(e,n)}class RE{constructor(){this.activeTargetIds=KD()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class iO{constructor(){this.Mo=new RE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new RE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class lO{Oo(e){}shutdown(){}}const IE="ConnectivityMonitor";class DE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ke(IE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ke(IE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Pd=null;function Ix(){return Pd===null?Pd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Pd++,"0x"+Pd.toString(16)}const V1="RestConnection",oO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${a}`,this.Wo=this.databaseId.database===dm?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Go(e,r,n,a,i){const o=Ix(),u=this.zo(e,r.toUriEncodedString());Ke(V1,`Sending RPC '${e}' ${o}:`,u,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,i);const{host:d}=new URL(u),m=Cu(d);return this.Jo(e,u,f,n,m).then((x=>(Ke(V1,`Received RPC '${e}' ${o}: `,x),x)),(x=>{throw gu(V1,`RPC '${e}' ${o} failed with error: `,x,"url: ",u,"request:",n),x}))}Ho(e,r,n,a,i,o){return this.Go(e,r,n,a,i)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ru})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((a,i)=>e[i]=a)),n&&n.headers.forEach(((a,i)=>e[i]=a))}zo(e,r){const n=oO[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}class uO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Fn="WebChannelConnection";class fO extends cO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,a,i){const o=Ix();return new Promise(((u,f)=>{const d=new d4;d.setWithCredentials(!0),d.listenOnce(m4.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Zd.NO_ERROR:const x=d.getResponseJson();Ke(Fn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(x)),u(x);break;case Zd.TIMEOUT:Ke(Fn,`RPC '${e}' ${o} timed out`),f(new Xe(Ie.DEADLINE_EXCEEDED,"Request time out"));break;case Zd.HTTP_ERROR:const y=d.getStatus();if(Ke(Fn,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let b=d.getResponseJson();Array.isArray(b)&&(b=b[0]);const E=b?.error;if(E&&E.status&&E.message){const w=(function(R){const I=R.toLowerCase().replace(/_/g,"-");return Object.values(Ie).indexOf(I)>=0?I:Ie.UNKNOWN})(E.status);f(new Xe(w,E.message))}else f(new Xe(Ie.UNKNOWN,"Server responded with status "+d.getStatus()))}else f(new Xe(Ie.UNAVAILABLE,"Connection failed."));break;default:ut(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Ke(Fn,`RPC '${e}' ${o} completed.`)}}));const m=JSON.stringify(a);Ke(Fn,`RPC '${e}' ${o} sending request:`,a),d.send(r,"POST",m,n,15)}))}T_(e,r,n){const a=Ix(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=x4(),u=g4(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,r,n),f.encodeInitMessageHeaders=!0;const m=i.join("");Ke(Fn,`Creating RPC '${e}' stream ${a}: ${m}`,f);const x=o.createWebChannel(m,f);this.I_(x);let y=!1,b=!1;const E=new uO({Yo:T=>{b?Ke(Fn,`Not sending because RPC '${e}' stream ${a} is closed:`,T):(y||(Ke(Fn,`Opening RPC '${e}' stream ${a} transport.`),x.open(),y=!0),Ke(Fn,`RPC '${e}' stream ${a} sending:`,T),x.send(T))},Zo:()=>x.close()}),w=(T,R,I)=>{T.listen(R,(C=>{try{I(C)}catch(W){setTimeout((()=>{throw W}),0)}}))};return w(x,zf.EventType.OPEN,(()=>{b||(Ke(Fn,`RPC '${e}' stream ${a} transport opened.`),E.o_())})),w(x,zf.EventType.CLOSE,(()=>{b||(b=!0,Ke(Fn,`RPC '${e}' stream ${a} transport closed`),E.a_(),this.E_(x))})),w(x,zf.EventType.ERROR,(T=>{b||(b=!0,gu(Fn,`RPC '${e}' stream ${a} transport errored. Name:`,T.name,"Message:",T.message),E.a_(new Xe(Ie.UNAVAILABLE,"The operation could not be completed")))})),w(x,zf.EventType.MESSAGE,(T=>{if(!b){const R=T.data[0];$t(!!R,16349);const I=R,C=I?.error||I[0]?.error;if(C){Ke(Fn,`RPC '${e}' stream ${a} received error:`,C);const W=C.status;let U=(function(D){const N=en[D];if(N!==void 0)return Q4(N)})(W),B=C.message;U===void 0&&(U=Ie.INTERNAL,B="Unknown error status: "+W+" with message "+C.message),b=!0,E.a_(new Xe(U,B)),x.close()}else Ke(Fn,`RPC '${e}' stream ${a} received:`,R),E.u_(R)}})),w(u,p4.STAT_EVENT,(T=>{T.stat===vx.PROXY?Ke(Fn,`RPC '${e}' stream ${a} detected buffering proxy`):T.stat===vx.NOPROXY&&Ke(Fn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{E.__()}),0),E}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function U1(){return typeof document<"u"?document:null}function ip(t){return new p8(t,!0)}class fA{constructor(e,r,n=1e3,a=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=a,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,r-n);a>0&&Ke("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const OE="PersistentStream";class hA{constructor(e,r,n,a,i,o,u,f){this.Mi=e,this.S_=n,this.b_=a,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new fA(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Ie.RESOURCE_EXHAUSTED?(Di(r.toString()),Di("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===r&&this.G_(n,a)}),(n=>{e((()=>{const a=new Xe(Ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ke(OE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(Ke(OE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class hO extends hA{constructor(e,r,n,a,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,o),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=v8(this.serializer,e),n=(function(i){if(!("targetChange"in i))return pt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?pt.min():o.readTime?qs(o.readTime):pt.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=Nx(this.serializer),r.addTarget=(function(i,o){let u;const f=o.target;if(u=Ex(f)?{documents:w8(i,f)}:{query:b8(i,f).ft},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=eA(i,o.resumeToken);const d=Ax(i,o.expectedCount);d!==null&&(u.expectedCount=d)}else if(o.snapshotVersion.compareTo(pt.min())>0){u.readTime=vm(i,o.snapshotVersion.toTimestamp());const d=Ax(i,o.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);const n=T8(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=Nx(this.serializer),r.removeTarget=e,this.q_(r)}}class dO extends hA{constructor(e,r,n,a,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return $t(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$t(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){$t(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=_8(e.writeResults,e.commitTime),n=qs(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=Nx(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>y8(this.serializer,n)))};this.q_(r)}}class mO{}class pO extends mO{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Xe(Ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Go(e,kx(r,n),a,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Xe(Ie.UNKNOWN,i.toString())}))}Ho(e,r,n,a,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.Ho(e,kx(r,n),a,o,u,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Xe(Ie.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class gO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Di(r),this.aa=!1):Ke("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Xo="RemoteStore";class xO{constructor(e,r,n,a,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((o=>{n.enqueueAndForget((async()=>{sc(this)&&(Ke(Xo,"Restarting streams for network reachability change."),await(async function(f){const d=xt(f);d.Ea.add(4),await z0(d),d.Ra.set("Unknown"),d.Ea.delete(4),await lp(d)})(this))}))})),this.Ra=new gO(n,a)}}async function lp(t){if(sc(t))for(const e of t.da)await e(!0)}async function z0(t){for(const e of t.da)await e(!1)}function dA(t,e){const r=xt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Mv(r)?Fv(r):Fu(r).O_()&&Ov(r,e))}function Dv(t,e){const r=xt(t),n=Fu(r);r.Ia.delete(e),n.O_()&&mA(r,e),r.Ia.size===0&&(n.O_()?n.L_():sc(r)&&r.Ra.set("Unknown"))}function Ov(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Fu(t).Y_(e)}function mA(t,e){t.Va.Ue(e),Fu(t).Z_(e)}function Fv(t){t.Va=new f8({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Fu(t).start(),t.Ra.ua()}function Mv(t){return sc(t)&&!Fu(t).x_()&&t.Ia.size>0}function sc(t){return xt(t).Ea.size===0}function pA(t){t.Va=void 0}async function vO(t){t.Ra.set("Online")}async function yO(t){t.Ia.forEach(((e,r)=>{Ov(t,e)}))}async function _O(t,e){pA(t),Mv(t)?(t.Ra.ha(e),Fv(t)):t.Ra.set("Unknown")}async function wO(t,e,r){if(t.Ra.set("Online"),e instanceof Z4&&e.state===2&&e.cause)try{await(async function(a,i){const o=i.cause;for(const u of i.targetIds)a.Ia.has(u)&&(await a.remoteSyncer.rejectListen(u,o),a.Ia.delete(u),a.Va.removeTarget(u))})(t,e)}catch(n){Ke(Xo,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await _m(t,n)}else if(e instanceof nm?t.Va.Ze(e):e instanceof J4?t.Va.st(e):t.Va.tt(e),!r.isEqual(pt.min()))try{const n=await uA(t.localStore);r.compareTo(n)>=0&&await(function(i,o){const u=i.Va.Tt(o);return u.targetChanges.forEach(((f,d)=>{if(f.resumeToken.approximateByteSize()>0){const m=i.Ia.get(d);m&&i.Ia.set(d,m.withResumeToken(f.resumeToken,o))}})),u.targetMismatches.forEach(((f,d)=>{const m=i.Ia.get(f);if(!m)return;i.Ia.set(f,m.withResumeToken(Cn.EMPTY_BYTE_STRING,m.snapshotVersion)),mA(i,f);const x=new Cl(m.target,f,d,m.sequenceNumber);Ov(i,x)})),i.remoteSyncer.applyRemoteEvent(u)})(t,r)}catch(n){Ke(Xo,"Failed to raise snapshot:",n),await _m(t,n)}}async function _m(t,e,r){if(!Du(e))throw e;t.Ea.add(1),await z0(t),t.Ra.set("Offline"),r||(r=()=>uA(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ke(Xo,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await lp(t)}))}function gA(t,e){return e().catch((r=>_m(t,r,e)))}async function op(t){const e=xt(t),r=Gl(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vv;for(;bO(e);)try{const a=await nO(e.localStore,n);if(a===null){e.Ta.length===0&&r.L_();break}n=a.batchId,EO(e,a)}catch(a){await _m(e,a)}xA(e)&&vA(e)}function bO(t){return sc(t)&&t.Ta.length<10}function EO(t,e){t.Ta.push(e);const r=Gl(t);r.O_()&&r.X_&&r.ea(e.mutations)}function xA(t){return sc(t)&&!Gl(t).x_()&&t.Ta.length>0}function vA(t){Gl(t).start()}async function TO(t){Gl(t).ra()}async function SO(t){const e=Gl(t);for(const r of t.Ta)e.ea(r.mutations)}async function AO(t,e,r){const n=t.Ta.shift(),a=Sv.from(n,e,r);await gA(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await op(t)}async function kO(t,e){e&&Gl(t).X_&&await(async function(n,a){if((function(o){return o8(o)&&o!==Ie.ABORTED})(a.code)){const i=n.Ta.shift();Gl(n).B_(),await gA(n,(()=>n.remoteSyncer.rejectFailedWrite(i.batchId,a))),await op(n)}})(t,e),xA(t)&&vA(t)}async function FE(t,e){const r=xt(t);r.asyncQueue.verifyOperationInProgress(),Ke(Xo,"RemoteStore received new credentials");const n=sc(r);r.Ea.add(3),await z0(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await lp(r)}async function CO(t,e){const r=xt(t);e?(r.Ea.delete(2),await lp(r)):e||(r.Ea.add(2),await z0(r),r.Ra.set("Unknown"))}function Fu(t){return t.ma||(t.ma=(function(r,n,a){const i=xt(r);return i.sa(),new hO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(t.datastore,t.asyncQueue,{Xo:vO.bind(null,t),t_:yO.bind(null,t),r_:_O.bind(null,t),H_:wO.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Mv(t)?Fv(t):t.Ra.set("Unknown")):(await t.ma.stop(),pA(t))}))),t.ma}function Gl(t){return t.fa||(t.fa=(function(r,n,a){const i=xt(r);return i.sa(),new dO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:TO.bind(null,t),r_:kO.bind(null,t),ta:SO.bind(null,t),na:AO.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await op(t)):(await t.fa.stop(),t.Ta.length>0&&(Ke(Xo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class Pv{constructor(e,r,n,a,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=i,this.deferred=new Ml,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,i){const o=Date.now()+n,u=new Pv(e,r,o,a,i);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Xe(Ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jv(t,e){if(Di("AsyncQueue",`${e}: ${t}`),Du(t))return new Xe(Ie.UNAVAILABLE,`${e}: ${t}`);throw t}class lu{static emptySet(e){return new lu(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||at.comparator(r.key,n.key):(r,n)=>at.comparator(r.key,n.key),this.keyedMap=Hf(),this.sortedSet=new Rr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof lu)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,i=n.getNext().key;if(!a.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new lu;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}class ME{constructor(){this.ga=new Rr(at.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ut(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class wu{constructor(e,r,n,a,i,o,u,f,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,a,i){const o=[];return r.forEach((u=>{o.push({type:0,doc:u})})),new wu(e,r,lu.emptySet(r),o,n,a,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ep(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}class NO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class RO{constructor(){this.queries=PE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const a=xt(r),i=a.queries;a.queries=PE(),i.forEach(((o,u)=>{for(const f of u.Sa)f.onError(n)}))})(this,new Xe(Ie.ABORTED,"Firestore shutting down"))}}function PE(){return new ac((t=>B4(t)),ep)}async function yA(t,e){const r=xt(t);let n=3;const a=e.query;let i=r.queries.get(a);i?!i.ba()&&e.Da()&&(n=2):(i=new NO,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(a,!0);break;case 1:i.wa=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(o){const u=jv(o,`Initialization of query '${tu(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&Lv(r)}async function _A(t,e){const r=xt(t),n=e.query;let a=3;const i=r.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?a=e.Da()?0:1:!i.ba()&&e.Da()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function IO(t,e){const r=xt(t);let n=!1;for(const a of e){const i=a.query,o=r.queries.get(i);if(o){for(const u of o.Sa)u.Fa(a)&&(n=!0);o.wa=a}}n&&Lv(r)}function DO(t,e,r){const n=xt(t),a=n.queries.get(e);if(a)for(const i of a.Sa)i.onError(r);n.queries.delete(e)}function Lv(t){t.Ca.forEach((e=>{e.next()}))}var Dx,jE;(jE=Dx||(Dx={})).Ma="default",jE.Cache="cache";class wA{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new wu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=wu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Dx.Cache}}class bA{constructor(e){this.key=e}}class EA{constructor(e){this.key=e}}class OO{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Pt(),this.mutatedKeys=Pt(),this.eu=V4(e),this.tu=new lu(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new ME,a=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,o=a,u=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((m,x)=>{const y=a.get(m),b=tp(this.query,x)?x:null,E=!!y&&this.mutatedKeys.has(y.key),w=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let T=!1;y&&b?y.data.isEqual(b.data)?E!==w&&(n.track({type:3,doc:b}),T=!0):this.su(y,b)||(n.track({type:2,doc:b}),T=!0,(f&&this.eu(b,f)>0||d&&this.eu(b,d)<0)&&(u=!0)):!y&&b?(n.track({type:0,doc:b}),T=!0):y&&!b&&(n.track({type:1,doc:y}),T=!0,(f||d)&&(u=!0)),T&&(b?(o=o.add(b),i=w?i.add(m):i.delete(m)):(o=o.delete(m),i=i.delete(m)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),i=i.delete(m.key),n.track({type:1,doc:m})}return{tu:o,iu:n,Cs:u,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((m,x)=>(function(b,E){const w=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ut(20277,{Rt:T})}};return w(b)-w(E)})(m.type,x.type)||this.eu(m.doc,x.doc))),this.ou(n),a=a??!1;const u=r&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,d=f!==this.Za;return this.Za=f,o.length!==0||d?{snapshot:new wu(this.query,e.tu,i,o,e.mutatedKeys,f===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new ME,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Pt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new EA(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new bA(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=Pt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return wu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Bv="SyncEngine";class FO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class MO{constructor(e){this.key=e,this.hu=!1}}class PO{constructor(e,r,n,a,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new ac((u=>B4(u)),ep),this.Iu=new Map,this.Eu=new Set,this.du=new Rr(at.comparator),this.Au=new Map,this.Ru=new Cv,this.Vu={},this.mu=new Map,this.fu=_u.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function jO(t,e,r=!0){const n=NA(t);let a;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.lu()):a=await TA(n,e,r,!0),a}async function LO(t,e){const r=NA(t);await TA(r,e,!0,!1)}async function TA(t,e,r,n){const a=await aO(t.localStore,Gs(e)),i=a.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let u;return n&&(u=await BO(t,e,i,o==="current",a.resumeToken)),t.isPrimaryClient&&r&&dA(t.remoteStore,a),u}async function BO(t,e,r,n,a){t.pu=(x,y,b)=>(async function(w,T,R,I){let C=T.view.ru(R);C.Cs&&(C=await NE(w.localStore,T.query,!1).then((({documents:A})=>T.view.ru(A,C))));const W=I&&I.targetChanges.get(T.targetId),U=I&&I.targetMismatches.get(T.targetId)!=null,B=T.view.applyChanges(C,w.isPrimaryClient,W,U);return BE(w,T.targetId,B.au),B.snapshot})(t,x,y,b);const i=await NE(t.localStore,e,!0),o=new OO(e,i.Qs),u=o.ru(i.documents),f=U0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),d=o.applyChanges(u,t.isPrimaryClient,f);BE(t,r,d.au);const m=new FO(e,r,o);return t.Tu.set(e,m),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),d.snapshot}async function VO(t,e,r){const n=xt(t),a=n.Tu.get(e),i=n.Iu.get(a.targetId);if(i.length>1)return n.Iu.set(a.targetId,i.filter((o=>!ep(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Rx(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),r&&Dv(n.remoteStore,a.targetId),Ox(n,a.targetId)})).catch(Iu)):(Ox(n,a.targetId),await Rx(n.localStore,a.targetId,!0))}async function UO(t,e){const r=xt(t),n=r.Tu.get(e),a=r.Iu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Dv(r.remoteStore,n.targetId))}async function zO(t,e,r){const n=$O(t);try{const a=await(function(o,u){const f=xt(o),d=_r.now(),m=u.reduce(((b,E)=>b.add(E.key)),Pt());let x,y;return f.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let E=Oi(),w=Pt();return f.Ns.getEntries(b,m).next((T=>{E=T,E.forEach(((R,I)=>{I.isValidDocument()||(w=w.add(R))}))})).next((()=>f.localDocuments.getOverlayedDocuments(b,E))).next((T=>{x=T;const R=[];for(const I of u){const C=n8(I,x.get(I.key).overlayedDocument);C!=null&&R.push(new eo(I.key,C,I4(C.value.mapValue),Jn.exists(!0)))}return f.mutationQueue.addMutationBatch(b,d,R,u)})).next((T=>{y=T;const R=T.applyToLocalDocumentSet(x,w);return f.documentOverlayCache.saveOverlays(b,T.batchId,R)}))})).then((()=>({batchId:y.batchId,changes:z4(x)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(o,u,f){let d=o.Vu[o.currentUser.toKey()];d||(d=new Rr(Mt)),d=d.insert(u,f),o.Vu[o.currentUser.toKey()]=d})(n,a.batchId,r),await H0(n,a.changes),await op(n.remoteStore)}catch(a){const i=jv(a,"Failed to persist write");r.reject(i)}}async function SA(t,e){const r=xt(t);try{const n=await tO(r.localStore,e);e.targetChanges.forEach(((a,i)=>{const o=r.Au.get(i);o&&($t(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?o.hu=!0:a.modifiedDocuments.size>0?$t(o.hu,14607):a.removedDocuments.size>0&&($t(o.hu,42227),o.hu=!1))})),await H0(r,n,e)}catch(n){await Iu(n)}}function LE(t,e,r){const n=xt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Tu.forEach(((i,o)=>{const u=o.view.va(e);u.snapshot&&a.push(u.snapshot)})),(function(o,u){const f=xt(o);f.onlineState=u;let d=!1;f.queries.forEach(((m,x)=>{for(const y of x.Sa)y.va(u)&&(d=!0)})),d&&Lv(f)})(n.eventManager,e),a.length&&n.Pu.H_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function HO(t,e,r){const n=xt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Au.get(e),i=a&&a.key;if(i){let o=new Rr(at.comparator);o=o.insert(i,Bn.newNoDocument(i,pt.min()));const u=Pt().add(i),f=new sp(pt.min(),new Map,new Rr(Mt),o,u);await SA(n,f),n.du=n.du.remove(i),n.Au.delete(e),Vv(n)}else await Rx(n.localStore,e,!1).then((()=>Ox(n,e,r))).catch(Iu)}async function GO(t,e){const r=xt(t),n=e.batch.batchId;try{const a=await eO(r.localStore,e);kA(r,n,null),AA(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await H0(r,a)}catch(a){await Iu(a)}}async function qO(t,e,r){const n=xt(t);try{const a=await(function(o,u){const f=xt(o);return f.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let m;return f.mutationQueue.lookupMutationBatch(d,u).next((x=>($t(x!==null,37113),m=x.keys(),f.mutationQueue.removeMutationBatch(d,x)))).next((()=>f.mutationQueue.performConsistencyCheck(d))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(d,m,u))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m))).next((()=>f.localDocuments.getDocuments(d,m)))}))})(n.localStore,e);kA(n,e,r),AA(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await H0(n,a)}catch(a){await Iu(a)}}function AA(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function kA(t,e,r){const n=xt(t);let a=n.Vu[n.currentUser.toKey()];if(a){const i=a.get(e);i&&(r?i.reject(r):i.resolve(),a=a.remove(e)),n.Vu[n.currentUser.toKey()]=a}}function Ox(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||CA(t,n)}))}function CA(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Dv(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Vv(t))}function BE(t,e,r){for(const n of r)n instanceof bA?(t.Ru.addReference(n.key,e),WO(t,n)):n instanceof EA?(Ke(Bv,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||CA(t,n.key)):ut(19791,{wu:n})}function WO(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Ke(Bv,"New document in limbo: "+r),t.Eu.add(n),Vv(t))}function Vv(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new at(pr.fromString(e)),n=t.fu.next();t.Au.set(n,new MO(r)),t.du=t.du.insert(r,n),dA(t.remoteStore,new Cl(Gs(Ev(r.path)),n,"TargetPurposeLimboResolution",Qm.ce))}}async function H0(t,e,r){const n=xt(t),a=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,f)=>{o.push(n.pu(f,e,r).then((d=>{if((d||r)&&n.isPrimaryClient){const m=d?!d.fromCache:r?.targetChanges.get(f.targetId)?.current;n.sharedClientState.updateQueryState(f.targetId,m?"current":"not-current")}if(d){a.push(d);const m=Rv.As(f.targetId,d);i.push(m)}})))})),await Promise.all(o),n.Pu.H_(a),await(async function(f,d){const m=xt(f);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>Oe.forEach(d,(y=>Oe.forEach(y.Es,(b=>m.persistence.referenceDelegate.addReference(x,y.targetId,b))).next((()=>Oe.forEach(y.ds,(b=>m.persistence.referenceDelegate.removeReference(x,y.targetId,b)))))))))}catch(x){if(!Du(x))throw x;Ke(Iv,"Failed to update sequence numbers: "+x)}for(const x of d){const y=x.targetId;if(!x.fromCache){const b=m.Ms.get(y),E=b.snapshotVersion,w=b.withLastLimboFreeSnapshotVersion(E);m.Ms=m.Ms.insert(y,w)}}})(n.localStore,i))}async function XO(t,e){const r=xt(t);if(!r.currentUser.isEqual(e)){Ke(Bv,"User change. New user:",e.toKey());const n=await cA(r.localStore,e);r.currentUser=e,(function(i,o){i.mu.forEach((u=>{u.forEach((f=>{f.reject(new Xe(Ie.CANCELLED,o))}))})),i.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await H0(r,n.Ls)}}function YO(t,e){const r=xt(t),n=r.Au.get(e);if(n&&n.hu)return Pt().add(n.key);{let a=Pt();const i=r.Iu.get(e);if(!i)return a;for(const o of i){const u=r.Tu.get(o);a=a.unionWith(u.view.nu)}return a}}function NA(t){const e=xt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=SA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=HO.bind(null,e),e.Pu.H_=IO.bind(null,e.eventManager),e.Pu.yu=DO.bind(null,e.eventManager),e}function $O(t){const e=xt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=GO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qO.bind(null,e),e}class wm{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ip(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return Z8(this.persistence,new K8,e.initialUser,this.serializer)}Cu(e){return new oA(Nv.mi,this.serializer)}Du(e){return new iO}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}wm.provider={build:()=>new wm};class KO extends wm{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){$t(this.persistence.referenceDelegate instanceof ym,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new M8(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?ca.withCacheSize(this.cacheSizeBytes):ca.DEFAULT;return new oA((n=>ym.mi(n,r)),this.serializer)}}class Fx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>LE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=XO.bind(null,this.syncEngine),await CO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new RO})()}createDatastore(e){const r=ip(e.databaseInfo.databaseId),n=(function(i){return new fO(i)})(e.databaseInfo);return(function(i,o,u,f){return new pO(i,o,u,f)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,a,i,o,u){return new xO(n,a,i,o,u)})(this.localStore,this.datastore,e.asyncQueue,(r=>LE(this.syncEngine,r,0)),(function(){return DE.v()?new DE:new lO})())}createSyncEngine(e,r){return(function(a,i,o,u,f,d,m){const x=new PO(a,i,o,u,f,d);return m&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){const n=xt(r);Ke(Xo,"RemoteStore shutting down."),n.Ea.add(5),await z0(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Fx.provider={build:()=>new Fx};class RA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Di("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}const ql="FirestoreClient";class QO{constructor(e,r,n,a,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Pn.UNAUTHENTICATED,this.clientId=xv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async o=>{Ke(ql,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(Ke(ql,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ml;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=jv(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function z1(t,e){t.asyncQueue.verifyOperationInProgress(),Ke(ql,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async a=>{n.isEqual(a)||(await cA(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function VE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await JO(t);Ke(ql,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>FE(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,a)=>FE(e.remoteStore,a))),t._onlineComponents=e}async function JO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ke(ql,"Using user provided OfflineComponentProvider");try{await z1(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(a){return a.name==="FirebaseError"?a.code===Ie.FAILED_PRECONDITION||a.code===Ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(r))throw r;gu("Error using user provided cache. Falling back to memory cache: "+r),await z1(t,new wm)}}else Ke(ql,"Using default OfflineComponentProvider"),await z1(t,new KO(void 0));return t._offlineComponents}async function IA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ke(ql,"Using user provided OnlineComponentProvider"),await VE(t,t._uninitializedComponentsProvider._online)):(Ke(ql,"Using default OnlineComponentProvider"),await VE(t,new Fx))),t._onlineComponents}function ZO(t){return IA(t).then((e=>e.syncEngine))}async function Mx(t){const e=await IA(t),r=e.eventManager;return r.onListen=jO.bind(null,e.syncEngine),r.onUnlisten=VO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=LO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=UO.bind(null,e.syncEngine),r}function e9(t,e,r={}){const n=new Ml;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,u,f,d){const m=new RA({next:y=>{m.Nu(),o.enqueueAndForget((()=>_A(i,x))),y.fromCache&&f.source==="server"?d.reject(new Xe(Ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),x=new wA(u,m,{includeMetadataChanges:!0,qa:!0});return yA(i,x)})(await Mx(t),t.asyncQueue,e,r,n))),n.promise}function DA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const UE=new Map;const OA="firestore.googleapis.com",zE=!0;class HE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Xe(Ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=OA,this.ssl=zE}else this.host=e.host,this.ssl=e.ssl??zE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=lA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<O8)throw new Xe(Ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}xD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=DA(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new Xe(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new Xe(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new Xe(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class cp{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new HE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Xe(Ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Xe(Ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new HE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new lD;switch(n.type){case"firstParty":return new fD(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Xe(Ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=UE.get(r);n&&(Ke("ComponentProvider","Removing Datastore"),UE.delete(r),n.terminate())})(this),Promise.resolve()}}function t9(t,e,r,n={}){t=Ia(t,cp);const a=Cu(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},u=`${e}:${r}`;a&&(a4(`https://${u}`),s4("Firestore",!0)),i.host!==OA&&i.host!==u&&gu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...i,host:u,ssl:a,emulatorOptions:n};if(!Go(f,o)&&(t._setSettings(f),n.mockUserToken)){let d,m;if(typeof n.mockUserToken=="string")d=n.mockUserToken,m=Pn.MOCK_USER;else{d=F5(n.mockUserToken,t._app?.options.projectId);const x=n.mockUserToken.sub||n.mockUserToken.user_id;if(!x)throw new Xe(Ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Pn(x)}t._authCredentials=new oD(new y4(d,m))}}class to{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new to(this.firestore,e,this._query)}}class qr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new qr(this.firestore,e,this._key)}toJSON(){return{type:qr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(B0(r,qr._jsonSchema))return new qr(e,n||null,new at(pr.fromString(r.referencePath)))}}qr._jsonSchemaVersion="firestore/documentReference/1.0",qr._jsonSchema={type:sn("string",qr._jsonSchemaVersion),referencePath:sn("string")};class Pl extends to{constructor(e,r,n){super(e,r,Ev(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new qr(this.firestore,null,new at(e))}withConverter(e){return new Pl(this.firestore,e,this._path)}}function ar(t,e,...r){if(t=un(t),_4("collection","path",e),t instanceof cp){const n=pr.fromString(e,...r);return rE(n),new Pl(t,null,n)}{if(!(t instanceof qr||t instanceof Pl))throw new Xe(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pr.fromString(e,...r));return rE(n),new Pl(t.firestore,null,n)}}function St(t,e,...r){if(t=un(t),arguments.length===1&&(e=xv.newId()),_4("doc","path",e),t instanceof cp){const n=pr.fromString(e,...r);return tE(n),new qr(t,null,new at(n))}{if(!(t instanceof qr||t instanceof Pl))throw new Xe(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(pr.fromString(e,...r));return tE(n),new qr(t.firestore,t instanceof Pl?t.converter:null,new at(n))}}const GE="AsyncQueue";class qE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new fA(this,"async_queue_retry"),this._c=()=>{const n=U1();n&&Ke(GE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=U1();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=U1();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new Ml;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Du(e))throw e;Ke(GE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Di("INTERNAL UNHANDLED ERROR: ",WE(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const a=Pv.createAndSchedule(this,e,r,n,(i=>this.hc(i)));return this.tc.push(a),a}uc(){this.nc&&ut(47125,{Pc:WE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function WE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function XE(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const i of n)if(i in a&&typeof a[i]=="function")return!0;return!1})(t,["next","error","complete"])}class Fi extends cp{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new qE,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qE(e),this._firestoreClient=void 0,await e}}}function r9(t,e){const r=typeof t=="object"?t:c4(),n=typeof t=="string"?t:dm,a=pv(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const i=D5("firestore");i&&t9(a,...i)}return a}function up(t){if(t._terminated)throw new Xe(Ie.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||n9(t),t._firestoreClient}function n9(t){const e=t._freezeSettings(),r=(function(a,i,o,u){return new CD(a,i,o,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,DA(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new QO(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(a){const i=a?._online.build();return{_offline:a?._offline.build(i),_online:i}})(t._componentsProvider))}class Za{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Za(Cn.fromBase64String(e))}catch(r){throw new Xe(Ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Za(Cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Za._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(B0(e,Za._jsonSchema))return Za.fromBase64String(e.bytes)}}Za._jsonSchemaVersion="firestore/bytes/1.0",Za._jsonSchema={type:sn("string",Za._jsonSchemaVersion),bytes:sn("string")};class G0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Xe(Ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new An(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Uv{constructor(e){this._methodName=e}}class Ws{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Xe(Ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Xe(Ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Mt(this._lat,e._lat)||Mt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ws._jsonSchemaVersion}}static fromJSON(e){if(B0(e,Ws._jsonSchema))return new Ws(e.latitude,e.longitude)}}Ws._jsonSchemaVersion="firestore/geoPoint/1.0",Ws._jsonSchema={type:sn("string",Ws._jsonSchemaVersion),latitude:sn("number"),longitude:sn("number")};class Xs{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==a[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Xs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(B0(e,Xs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new Xs(e.vectorValues);throw new Xe(Ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Xs._jsonSchemaVersion="firestore/vectorValue/1.0",Xs._jsonSchema={type:sn("string",Xs._jsonSchemaVersion),vectorValues:sn("object")};const a9=/^__.*__$/;class s9{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new eo(e,this.data,this.fieldMask,r,this.fieldTransforms):new V0(e,this.data,r,this.fieldTransforms)}}class FA{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new eo(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function MA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ut(40011,{Ac:t})}}class zv{constructor(e,r,n,a,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new zv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return bm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(MA(this.Ac)&&a9.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class i9{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||ip(e)}Cc(e,r,n,a=!1){return new zv({Ac:e,methodName:r,Dc:n,path:An.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function q0(t){const e=t._freezeSettings(),r=ip(t._databaseId);return new i9(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Hv(t,e,r,n,a,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,r,a);Gv("Data must be an object, but it was:",o,n);const u=LA(n,o);let f,d;if(i.merge)f=new Ra(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const m=[];for(const x of i.mergeFields){const y=Px(e,x,r);if(!o.contains(y))throw new Xe(Ie.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);VA(m,y)||m.push(y)}f=new Ra(m),d=o.fieldTransforms.filter((x=>f.covers(x.field)))}else f=null,d=o.fieldTransforms;return new s9(new fa(u),f,d)}class fp extends Uv{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fp}}function PA(t,e,r,n){const a=t.Cc(1,e,r);Gv("Data must be an object, but it was:",a,n);const i=[],o=fa.empty();Zl(n,((f,d)=>{const m=qv(e,f,r);d=un(d);const x=a.yc(m);if(d instanceof fp)i.push(m);else{const y=W0(d,x);y!=null&&(i.push(m),o.set(m,y))}}));const u=new Ra(i);return new FA(o,u,a.fieldTransforms)}function jA(t,e,r,n,a,i){const o=t.Cc(1,e,r),u=[Px(e,n,r)],f=[a];if(i.length%2!=0)throw new Xe(Ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)u.push(Px(e,i[y])),f.push(i[y+1]);const d=[],m=fa.empty();for(let y=u.length-1;y>=0;--y)if(!VA(d,u[y])){const b=u[y];let E=f[y];E=un(E);const w=o.yc(b);if(E instanceof fp)d.push(b);else{const T=W0(E,w);T!=null&&(d.push(b),m.set(b,T))}}const x=new Ra(d);return new FA(m,x,o.fieldTransforms)}function l9(t,e,r,n=!1){return W0(r,t.Cc(n?4:3,e))}function W0(t,e){if(BA(t=un(t)))return Gv("Unsupported field value:",e,t),LA(t,e);if(t instanceof Uv)return(function(n,a){if(!MA(a.Ac))throw a.Sc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(a);i&&a.fieldTransforms.push(i)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,a){const i=[];let o=0;for(const u of n){let f=W0(u,a.wc(o));f==null&&(f={nullValue:"NULL_VALUE"}),i.push(f),o++}return{arrayValue:{values:i}}})(t,e)}return(function(n,a){if((n=un(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return QD(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=_r.fromDate(n);return{timestampValue:vm(a.serializer,i)}}if(n instanceof _r){const i=new _r(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:vm(a.serializer,i)}}if(n instanceof Ws)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Za)return{bytesValue:eA(a.serializer,n._byteString)};if(n instanceof qr){const i=a.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw a.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:kv(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Xs)return(function(o,u){return{mapValue:{fields:{[N4]:{stringValue:R4},[mm]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw u.Sc("VectorValues must only contain numeric values.");return Tv(u.serializer,d)}))}}}}}})(n,a);throw a.Sc(`Unsupported field value: ${Km(n)}`)})(t,e)}function LA(t,e){const r={};return E4(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zl(t,((n,a)=>{const i=W0(a,e.mc(n));i!=null&&(r[n]=i)})),{mapValue:{fields:r}}}function BA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof _r||t instanceof Ws||t instanceof Za||t instanceof qr||t instanceof Uv||t instanceof Xs)}function Gv(t,e,r){if(!BA(r)||!w4(r)){const n=Km(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Px(t,e,r){if((e=un(e))instanceof G0)return e._internalPath;if(typeof e=="string")return qv(t,e);throw bm("Field path arguments must be of type string or ",t,!1,void 0,r)}const o9=new RegExp("[~\\*/\\[\\]]");function qv(t,e,r){if(e.search(o9)>=0)throw bm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new G0(...e.split("."))._internalPath}catch{throw bm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function bm(t,e,r,n,a){const i=n&&!n.isEmpty(),o=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(i||o)&&(f+=" (found",i&&(f+=` in field ${n}`),o&&(f+=` in document ${a}`),f+=")"),new Xe(Ie.INVALID_ARGUMENT,u+t+f)}function VA(t,e){return t.some((r=>r.isEqual(e)))}class UA{constructor(e,r,n,a,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new qr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new c9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(hp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class c9 extends UA{data(){return super.data()}}function hp(t,e){return typeof e=="string"?qv(t,e):e instanceof G0?e._internalPath:e._delegate._internalPath}function zA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Xe(Ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wv{}class HA extends Wv{}function jx(t,e,...r){let n=[];e instanceof Wv&&n.push(e),n=n.concat(r),(function(i){const o=i.filter((f=>f instanceof Xv)).length,u=i.filter((f=>f instanceof dp)).length;if(o>1||o>0&&u>0)throw new Xe(Ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const a of n)t=a._apply(t);return t}class dp extends HA{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new dp(e,r,n)}_apply(e){const r=this._parse(e);return qA(e._query,r),new to(e.firestore,e.converter,Tx(e._query,r))}_parse(e){const r=q0(e.firestore);return(function(i,o,u,f,d,m,x){let y;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new Xe(Ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){$E(x,m);const E=[];for(const w of x)E.push(YE(f,i,w));y={arrayValue:{values:E}}}else y=YE(f,i,x)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||$E(x,m),y=l9(u,o,x,m==="in"||m==="not-in");return an.create(d,m,y)})(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function GA(t,e,r){const n=e,a=hp("where",t);return dp._create(a,n,r)}class Xv extends Wv{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Xv(e,r)}_parse(e){const r=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return r.length===1?r[0]:Ss.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:((function(a,i){let o=a;const u=i.getFlattenedFilters();for(const f of u)qA(o,f),o=Tx(o,f)})(e._query,r),new to(e.firestore,e.converter,Tx(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Yv extends HA{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Yv(e,r)}_apply(e){const r=(function(a,i,o){if(a.startAt!==null)throw new Xe(Ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new Xe(Ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new p0(i,o)})(e._query,this._field,this._direction);return new to(e.firestore,e.converter,(function(a,i){const o=a.explicitOrderBy.concat([i]);return new Ou(a.path,a.collectionGroup,o,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,r))}}function u9(t,e="asc"){const r=e,n=hp("orderBy",t);return Yv._create(n,r)}function YE(t,e,r){if(typeof(r=un(r))=="string"){if(r==="")throw new Xe(Ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!L4(e)&&r.indexOf("/")!==-1)throw new Xe(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(pr.fromString(r));if(!at.isDocumentKey(n))throw new Xe(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return uE(t,new at(n))}if(r instanceof qr)return uE(t,r._key);throw new Xe(Ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Km(r)}.`)}function $E(t,e){if(!Array.isArray(t)||t.length===0)throw new Xe(Ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qA(t,e){const r=(function(a,i){for(const o of a)for(const u of o.getFlattenedFilters())if(i.indexOf(u.op)>=0)return u.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(r!==null)throw r===e.op?new Xe(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Xe(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class f9{convertValue(e,r="none"){switch(Hl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Gr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(zl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ut(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Zl(e,((a,i)=>{n[a]=this.convertValue(i,r)})),n}convertVectorValue(e){const r=e.fields?.[mm].arrayValue?.values?.map((n=>Gr(n.doubleValue)));return new Xs(r)}convertGeoPoint(e){return new Ws(Gr(e.latitude),Gr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Zm(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(h0(e));default:return null}}convertTimestamp(e){const r=Ul(e);return new _r(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=pr.fromString(e);$t(iA(n),9688,{name:e});const a=new d0(n.get(1),n.get(3)),i=new at(n.popFirst(5));return a.isEqual(r)||Di(`Document ${i} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}function $v(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class qf{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Po extends UA{constructor(e,r,n,a,i,o){super(e,r,n,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new am(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(hp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Xe(Ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Po._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Po._jsonSchemaVersion="firestore/documentSnapshot/1.0",Po._jsonSchema={type:sn("string",Po._jsonSchemaVersion),bundleSource:sn("string","DocumentSnapshot"),bundleName:sn("string"),bundle:sn("string")};class am extends Po{data(e={}){return super.data(e)}}class jo{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new qf(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new am(this._firestore,this._userDataWriter,n.key,n,new qf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Xe(Ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(a,i){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map((u=>{const f=new am(a._firestore,a._userDataWriter,u.doc.key,u.doc,new qf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:o++}}))}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((u=>i||u.type!==3)).map((u=>{const f=new am(a._firestore,a._userDataWriter,u.doc.key,u.doc,new qf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,m=-1;return u.type!==0&&(d=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),m=o.indexOf(u.doc.key)),{type:h9(u.type),doc:f,oldIndex:d,newIndex:m}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Xe(Ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=jo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach((i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),a.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function h9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ut(61501,{type:t})}}jo._jsonSchemaVersion="firestore/querySnapshot/1.0",jo._jsonSchema={type:sn("string",jo._jsonSchemaVersion),bundleSource:sn("string","QuerySnapshot"),bundleName:sn("string"),bundle:sn("string")};class Kv extends f9{constructor(e){super(),this.firestore=e}convertBytes(e){return new Za(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new qr(this.firestore,null,r)}}function El(t){t=Ia(t,to);const e=Ia(t.firestore,Fi),r=up(e),n=new Kv(e);return zA(t._query),e9(r,t._query).then((a=>new jo(e,n,t,a)))}function X0(t,e,r){t=Ia(t,qr);const n=Ia(t.firestore,Fi),a=$v(t.converter,e,r);return Y0(n,[Hv(q0(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,Jn.none())])}function nn(t,e,r,...n){t=Ia(t,qr);const a=Ia(t.firestore,Fi),i=q0(a);let o;return o=typeof(e=un(e))=="string"||e instanceof G0?jA(i,"updateDoc",t._key,e,r,n):PA(i,"updateDoc",t._key,e),Y0(a,[o.toMutation(t._key,Jn.exists(!0))])}function bu(t){return Y0(Ia(t.firestore,Fi),[new ap(t._key,Jn.none())])}function Us(t,e){const r=Ia(t.firestore,Fi),n=St(t),a=$v(t.converter,e);return Y0(r,[Hv(q0(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,Jn.exists(!1))]).then((()=>n))}function Un(t,...e){t=un(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||XE(e[n])||(r=e[n++]);const a={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(XE(e[n])){const f=e[n];e[n]=f.next?.bind(f),e[n+1]=f.error?.bind(f),e[n+2]=f.complete?.bind(f)}let i,o,u;if(t instanceof qr)o=Ia(t.firestore,Fi),u=Ev(t._key.path),i={next:f=>{e[n]&&e[n](d9(o,t,f))},error:e[n+1],complete:e[n+2]};else{const f=Ia(t,to);o=Ia(f.firestore,Fi),u=f._query;const d=new Kv(o);i={next:m=>{e[n]&&e[n](new jo(o,d,f,m))},error:e[n+1],complete:e[n+2]},zA(t._query)}return(function(d,m,x,y){const b=new RA(y),E=new wA(m,b,x);return d.asyncQueue.enqueueAndForget((async()=>yA(await Mx(d),E))),()=>{b.Nu(),d.asyncQueue.enqueueAndForget((async()=>_A(await Mx(d),E)))}})(up(o),u,a,i)}function Y0(t,e){return(function(n,a){const i=new Ml;return n.asyncQueue.enqueueAndForget((async()=>zO(await ZO(n),a,i))),i.promise})(up(t),e)}function d9(t,e,r){const n=r.docs.get(e._key),a=new Kv(t);return new Po(t,a,e._key,n,new qf(r.hasPendingWrites,r.fromCache),e.converter)}class m9{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=q0(e)}set(e,r,n){this._verifyNotCommitted();const a=H1(e,this._firestore),i=$v(a.converter,r,n),o=Hv(this._dataReader,"WriteBatch.set",a._key,i,a.converter!==null,n);return this._mutations.push(o.toMutation(a._key,Jn.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const i=H1(e,this._firestore);let o;return o=typeof(r=un(r))=="string"||r instanceof G0?jA(this._dataReader,"WriteBatch.update",i._key,r,n,a):PA(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,Jn.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=H1(e,this._firestore);return this._mutations=this._mutations.concat(new ap(r._key,Jn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Xe(Ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function H1(t,e){if((t=un(t)).firestore!==e)throw new Xe(Ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Lx(t){return up(t=Ia(t,Fi)),new m9(t,(e=>Y0(t,e)))}(function(e,r=!0){(function(a){Ru=a})(Nu),pu(new qo("firestore",((n,{instanceIdentifier:a,options:i})=>{const o=n.getProvider("app").getImmediate(),u=new Fi(new cD(n.getProvider("auth-internal")),new hD(o,n.getProvider("app-check-internal")),(function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Xe(Ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new d0(d.options.projectId,m)})(o,a),o);return i={useFetchStreams:r,...i},u._setSettings(i),u}),"PUBLIC").setMultipleInstances(!0)),Ol(Qb,Jb,e),Ol(Qb,Jb,"esm2020")})();function WA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const p9=WA,XA=new j0("auth","Firebase",WA());const Em=new dv("@firebase/auth");function g9(t,...e){Em.logLevel<=Ft.WARN&&Em.warn(`Auth (${Nu}): ${t}`,...e)}function sm(t,...e){Em.logLevel<=Ft.ERROR&&Em.error(`Auth (${Nu}): ${t}`,...e)}function Mi(t,...e){throw Qv(t,...e)}function Ys(t,...e){return Qv(t,...e)}function YA(t,e,r){const n={...p9(),[e]:r};return new j0("auth","Firebase",n).create(e,{appName:t.name})}function jl(t){return YA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return XA.create(t,...e)}function dt(t,e,...r){if(!t)throw Qv(e,...r)}function Ei(t){const e="INTERNAL ASSERTION FAILED: "+t;throw sm(e),new Error(e)}function Pi(t,e){t||Ei(e)}function Bx(){return typeof self<"u"&&self.location?.href||""}function x9(){return KE()==="http:"||KE()==="https:"}function KE(){return typeof self<"u"&&self.location?.protocol||null}function v9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(x9()||V5()||"connection"in navigator)?navigator.onLine:!0}function y9(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class $0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Pi(r>e,"Short delay should be less than long delay!"),this.isMobile=j5()||U5()}get(){return v9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Jv(t,e){Pi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class $A{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const _9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const w9=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],b9=new $0(3e4,6e4);function mp(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Mu(t,e,r,n,a={}){return KA(t,a,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const u=L0({key:t.config.apiKey,...o}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:f,...i};return B5()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Cu(t.emulatorConfig.host)&&(d.credentials="include"),$A.fetch()(await JA(t,t.config.apiHost,r,u),d)})}async function KA(t,e,r){t._canInitEmulator=!1;const n={..._9,...e};try{const a=new E9(t),i=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw jd(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const u=i.ok?o.errorMessage:o.error.message,[f,d]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw jd(t,"credential-already-in-use",o);if(f==="EMAIL_EXISTS")throw jd(t,"email-already-in-use",o);if(f==="USER_DISABLED")throw jd(t,"user-disabled",o);const m=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw YA(t,m,d);Mi(t,m)}}catch(a){if(a instanceof Li)throw a;Mi(t,"network-request-failed",{message:String(a)})}}async function QA(t,e,r,n,a={}){const i=await Mu(t,e,r,n,a);return"mfaPendingCredential"in i&&Mi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function JA(t,e,r,n){const a=`${e}${r}?${n}`,i=t,o=i.config.emulator?Jv(t.config,a):`${t.config.apiScheme}://${a}`;return w9.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class E9{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Ys(this.auth,"network-request-failed")),b9.get())})}}function jd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=Ys(t,e,n);return a.customData._tokenResponse=r,a}async function T9(t,e){return Mu(t,"POST","/v1/accounts:delete",e)}async function Tm(t,e){return Mu(t,"POST","/v1/accounts:lookup",e)}function e0(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function S9(t,e=!1){const r=un(t),n=await r.getIdToken(e),a=Zv(n);dt(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const i=typeof a.firebase=="object"?a.firebase:void 0,o=i?.sign_in_provider;return{claims:a,token:n,authTime:e0(G1(a.auth_time)),issuedAtTime:e0(G1(a.iat)),expirationTime:e0(G1(a.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function G1(t){return Number(t)*1e3}function Zv(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return sm("JWT malformed, contained fewer than 3 sections"),null;try{const a=e4(r);return a?JSON.parse(a):(sm("Failed to decode base64 JWT payload"),null)}catch(a){return sm("Caught error parsing JWT payload as JSON",a?.toString()),null}}function QE(t){const e=Zv(t);return dt(e,"internal-error"),dt(typeof e.exp<"u","internal-error"),dt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function v0(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Li&&A9(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function A9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class k9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Vx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=e0(this.lastLoginAt),this.creationTime=e0(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Sm(t){const e=t.auth,r=await t.getIdToken(),n=await v0(t,Tm(e,{idToken:r}));dt(n?.users.length,e,"internal-error");const a=n.users[0];t._notifyReloadListener(a);const i=a.providerUserInfo?.length?ZA(a.providerUserInfo):[],o=N9(t.providerData,i),u=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!o?.length,d=u?f:!1,m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new Vx(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(t,m)}async function C9(t){const e=un(t);await Sm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function N9(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function ZA(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function R9(t,e){const r=await KA(t,{},async()=>{const n=L0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:i}=t.config,o=await JA(t,a,"/v1/token",`key=${i}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:n};return t.emulatorConfig&&Cu(t.emulatorConfig.host)&&(f.credentials="include"),$A.fetch()(o,f)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function I9(t,e){return Mu(t,"POST","/v2/accounts:revokeToken",mp(t,e))}class ou{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){dt(e.idToken,"internal-error"),dt(typeof e.idToken<"u","internal-error"),dt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):QE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){dt(e.length!==0,"internal-error");const r=QE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(dt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:i}=await R9(e,r);this.updateTokensAndExpiration(n,a,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:i}=r,o=new ou;return n&&(dt(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),a&&(dt(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),i&&(dt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ou,this.toJSON())}_performRefresh(){return Ei("not implemented")}}function wl(t,e){dt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class _s{constructor({uid:e,auth:r,stsTokenManager:n,...a}){this.providerId="firebase",this.proactiveRefresh=new k9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Vx(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await v0(this,this.stsTokenManager.getToken(this.auth,e));return dt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return S9(this,e)}reload(){return C9(this)}_assign(e){this!==e&&(dt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new _s({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){dt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Sm(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ys(this.auth.app))return Promise.reject(jl(this.auth));const e=await this.getIdToken();return await v0(this,T9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,a=r.email??void 0,i=r.phoneNumber??void 0,o=r.photoURL??void 0,u=r.tenantId??void 0,f=r._redirectEventId??void 0,d=r.createdAt??void 0,m=r.lastLoginAt??void 0,{uid:x,emailVerified:y,isAnonymous:b,providerData:E,stsTokenManager:w}=r;dt(x&&w,e,"internal-error");const T=ou.fromJSON(this.name,w);dt(typeof x=="string",e,"internal-error"),wl(n,e.name),wl(a,e.name),dt(typeof y=="boolean",e,"internal-error"),dt(typeof b=="boolean",e,"internal-error"),wl(i,e.name),wl(o,e.name),wl(u,e.name),wl(f,e.name),wl(d,e.name),wl(m,e.name);const R=new _s({uid:x,auth:e,email:a,emailVerified:y,displayName:n,isAnonymous:b,photoURL:o,phoneNumber:i,tenantId:u,stsTokenManager:T,createdAt:d,lastLoginAt:m});return E&&Array.isArray(E)&&(R.providerData=E.map(I=>({...I}))),f&&(R._redirectEventId=f),R}static async _fromIdTokenResponse(e,r,n=!1){const a=new ou;a.updateFromServerResponse(r);const i=new _s({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await Sm(i),i}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];dt(a.localId!==void 0,"internal-error");const i=a.providerUserInfo!==void 0?ZA(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!i?.length,u=new ou;u.updateFromIdToken(n);const f=new _s({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:o}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:i,metadata:new Vx(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!i?.length};return Object.assign(f,d),f}}const JE=new Map;function Ti(t){Pi(t instanceof Function,"Expected a class definition");let e=JE.get(t);return e?(Pi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,JE.set(t,e),e)}class ek{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}ek.type="NONE";const ZE=ek;function im(t,e,r){return`firebase:${t}:${e}:${r}`}class cu{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:i}=this.auth;this.fullUserKey=im(this.userKey,a.apiKey,i),this.fullPersistenceKey=im("persistence",a.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Tm(this.auth,{idToken:e}).catch(()=>{});return r?_s._fromGetAccountInfoResponse(this.auth,r,e):null}return _s._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new cu(Ti(ZE),e,n);const a=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=a[0]||Ti(ZE);const o=im(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const m=await d._get(o);if(m){let x;if(typeof m=="string"){const y=await Tm(e,{idToken:m}).catch(()=>{});if(!y)break;x=await _s._fromGetAccountInfoResponse(e,y,m)}else x=_s._fromJSON(e,m);d!==i&&(u=x),i=d;break}}catch{}const f=a.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!f.length?new cu(i,e,n):(i=f[0],u&&await i._set(o,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new cu(i,e,n))}}function eT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ak(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ik(e))return"Blackberry";if(lk(e))return"Webos";if(rk(e))return"Safari";if((e.includes("chrome/")||nk(e))&&!e.includes("edge/"))return"Chrome";if(sk(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function tk(t=Gn()){return/firefox\//i.test(t)}function rk(t=Gn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nk(t=Gn()){return/crios\//i.test(t)}function ak(t=Gn()){return/iemobile/i.test(t)}function sk(t=Gn()){return/android/i.test(t)}function ik(t=Gn()){return/blackberry/i.test(t)}function lk(t=Gn()){return/webos/i.test(t)}function ey(t=Gn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function D9(t=Gn()){return ey(t)&&!!window.navigator?.standalone}function O9(){return z5()&&document.documentMode===10}function ok(t=Gn()){return ey(t)||sk(t)||lk(t)||ik(t)||/windows phone/i.test(t)||ak(t)}function ck(t,e=[]){let r;switch(t){case"Browser":r=eT(Gn());break;case"Worker":r=`${eT(Gn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Nu}/${n}`}class F9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,u)=>{try{const f=e(i);o(f)}catch(f){u(f)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function M9(t,e={}){return Mu(t,"GET","/v2/passwordPolicy",mp(t,e))}const P9=6;class j9{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??P9,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class L9{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tT(this),this.idTokenSubscription=new tT(this),this.beforeStateQueue=new F9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=XA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ti(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await cu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Tm(this,{idToken:e}),n=await _s._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ys(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=n?._redirectEventId,u=await this.tryRedirectSignIn(e);(!i||i===o)&&u?.user&&(n=u.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return dt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Sm(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=y9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ys(this.app))return Promise.reject(jl(this));const r=e?un(e):null;return r&&dt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&dt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ys(this.app)?Promise.reject(jl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ys(this.app)?Promise.reject(jl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ti(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await M9(this),r=new j9(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new j0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await I9(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ti(e)||this._popupRedirectResolver;dt(r,this,"argument-error"),this.redirectPersistenceManager=await cu.create(this,[Ti(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(dt(u,this,"internal-error"),u.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const f=e.addObserver(r,n,a);return()=>{o=!0,f()}}else{const f=e.addObserver(r);return()=>{o=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return dt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ck(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(ys(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&g9(`Error while retrieving App Check token: ${e.error}`),e?.token}}function pp(t){return un(t)}class tT{constructor(e){this.auth=e,this.observer=null,this.addObserver=K5(r=>this.observer=r)}get next(){return dt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ty={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function B9(t){ty=t}function V9(t){return ty.loadJS(t)}function U9(){return ty.gapiScript}function z9(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function H9(t,e){const r=pv(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),i=r.getOptions();if(Go(i,e??{}))return a;Mi(a,"already-initialized")}return r.initialize({options:e})}function G9(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Ti);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function q9(t,e,r){const n=pp(t);dt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,i=uk(e),{host:o,port:u}=W9(e),f=u===null?"":`:${u}`,d={url:`${i}//${o}${f}/`},m=Object.freeze({host:o,port:u,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){dt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),dt(Go(d,n.config.emulator)&&Go(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,Cu(o)?(a4(`${i}//${o}${f}`),s4("Auth",!0)):X9()}function uk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function W9(t){const e=uk(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const i=a[1];return{host:i,port:rT(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:rT(o)}}}function rT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function X9(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class fk{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ei("not implemented")}_getIdTokenResponse(e){return Ei("not implemented")}_linkToIdToken(e,r){return Ei("not implemented")}_getReauthenticationResolver(e){return Ei("not implemented")}}async function uu(t,e){return QA(t,"POST","/v1/accounts:signInWithIdp",mp(t,e))}const Y9="http://localhost";class Yo extends fk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Yo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Mi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,...i}=r;if(!n||!a)return null;const o=new Yo(n,a);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return uu(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,uu(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,uu(e,r)}buildRequest(){const e={requestUri:Y9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=L0(r)}return e}}class hk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class K0 extends hk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Tl extends K0{constructor(){super("facebook.com")}static credential(e){return Yo._fromParams({providerId:Tl.PROVIDER_ID,signInMethod:Tl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Tl.credentialFromTaggedObject(e)}static credentialFromError(e){return Tl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Tl.credential(e.oauthAccessToken)}catch{return null}}}Tl.FACEBOOK_SIGN_IN_METHOD="facebook.com";Tl.PROVIDER_ID="facebook.com";class Sl extends K0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Yo._fromParams({providerId:Sl.PROVIDER_ID,signInMethod:Sl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Sl.credentialFromTaggedObject(e)}static credentialFromError(e){return Sl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Sl.credential(r,n)}catch{return null}}}Sl.GOOGLE_SIGN_IN_METHOD="google.com";Sl.PROVIDER_ID="google.com";class Al extends K0{constructor(){super("github.com")}static credential(e){return Yo._fromParams({providerId:Al.PROVIDER_ID,signInMethod:Al.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Al.credentialFromTaggedObject(e)}static credentialFromError(e){return Al.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Al.credential(e.oauthAccessToken)}catch{return null}}}Al.GITHUB_SIGN_IN_METHOD="github.com";Al.PROVIDER_ID="github.com";class kl extends K0{constructor(){super("twitter.com")}static credential(e,r){return Yo._fromParams({providerId:kl.PROVIDER_ID,signInMethod:kl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return kl.credentialFromTaggedObject(e)}static credentialFromError(e){return kl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return kl.credential(r,n)}catch{return null}}}kl.TWITTER_SIGN_IN_METHOD="twitter.com";kl.PROVIDER_ID="twitter.com";async function $9(t,e){return QA(t,"POST","/v1/accounts:signUp",mp(t,e))}class Wl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const i=await _s._fromIdTokenResponse(e,n,a),o=nT(n);return new Wl({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=nT(n);return new Wl({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function nT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function K9(t){if(ys(t.app))return Promise.reject(jl(t));const e=pp(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Wl({user:e.currentUser,providerId:null,operationType:"signIn"});const r=await $9(e,{returnSecureToken:!0}),n=await Wl._fromIdTokenResponse(e,"signIn",r,!0);return await e._updateCurrentUser(n.user),n}class Am extends Li{constructor(e,r,n,a){super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,Am.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new Am(e,r,n,a)}}function dk(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Am._fromErrorAndOperation(t,i,e,n):i})}async function Q9(t,e,r=!1){const n=await v0(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Wl._forOperation(t,"link",n)}async function J9(t,e,r=!1){const{auth:n}=t;if(ys(n.app))return Promise.reject(jl(n));const a="reauthenticate";try{const i=await v0(t,dk(n,a,e,t),r);dt(i.idToken,n,"internal-error");const o=Zv(i.idToken);dt(o,n,"internal-error");const{sub:u}=o;return dt(t.uid===u,n,"user-mismatch"),Wl._forOperation(t,a,i)}catch(i){throw i?.code==="auth/user-not-found"&&Mi(n,"user-mismatch"),i}}async function Z9(t,e,r=!1){if(ys(t.app))return Promise.reject(jl(t));const n="signIn",a=await dk(t,n,e),i=await Wl._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(i.user),i}function eF(t,e,r,n){return un(t).onIdTokenChanged(e,r,n)}function tF(t,e,r){return un(t).beforeAuthStateChanged(e,r)}function rF(t,e,r,n){return un(t).onAuthStateChanged(e,r,n)}const km="__sak";class mk{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(km,"1"),this.storage.removeItem(km),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const nF=1e3,aF=10;class pk extends mk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ok(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,u,f)=>{this.notifyListeners(o,f)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);O9()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,aF):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},nF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}pk.type="LOCAL";const sF=pk;class gk extends mk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}gk.type="SESSION";const xk=gk;function iF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class gp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new gp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:i}=r.data,o=this.handlersMap[a];if(!o?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(o).map(async d=>d(r.origin,i)),f=await iF(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:f})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}gp.receivers=[];function ry(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class lF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let i,o;return new Promise((u,f)=>{const d=ry("",20);a.port1.start();const m=setTimeout(()=>{f(new Error("unsupported_event"))},n);o={messageChannel:a,onMessage(x){const y=x;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(m),i=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),u(y.data.response);break;default:clearTimeout(m),clearTimeout(i),f(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function $s(){return window}function oF(t){$s().location.href=t}function vk(){return typeof $s().WorkerGlobalScope<"u"&&typeof $s().importScripts=="function"}async function cF(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function uF(){return navigator?.serviceWorker?.controller||null}function fF(){return vk()?self:null}const yk="firebaseLocalStorageDb",hF=1,Cm="firebaseLocalStorage",_k="fbase_key";class Q0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function xp(t,e){return t.transaction([Cm],e?"readwrite":"readonly").objectStore(Cm)}function dF(){const t=indexedDB.deleteDatabase(yk);return new Q0(t).toPromise()}function Ux(){const t=indexedDB.open(yk,hF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Cm,{keyPath:_k})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Cm)?e(n):(n.close(),await dF(),e(await Ux()))})})}async function aT(t,e,r){const n=xp(t,!0).put({[_k]:e,value:r});return new Q0(n).toPromise()}async function mF(t,e){const r=xp(t,!1).get(e),n=await new Q0(r).toPromise();return n===void 0?null:n.value}function sT(t,e){const r=xp(t,!0).delete(e);return new Q0(r).toPromise()}const pF=800,gF=3;class wk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ux(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>gF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return vk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=gp._getInstance(fF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await cF(),!this.activeServiceWorker)return;this.sender=new lF(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||uF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ux();return await aT(e,km,"1"),await sT(e,km),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>aT(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>mF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>sT(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const i=xp(a,!1).getAll();return new Q0(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:i}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(i)&&(this.notifyListeners(a,i),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),pF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wk.type="LOCAL";const xF=wk;new $0(3e4,6e4);function vF(t,e){return e?Ti(e):(dt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class ny extends fk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return uu(e,this._buildIdpRequest())}_linkToIdToken(e,r){return uu(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return uu(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function yF(t){return Z9(t.auth,new ny(t),t.bypassAuthState)}function _F(t){const{auth:e,user:r}=t;return dt(r,e,"internal-error"),J9(r,new ny(t),t.bypassAuthState)}async function wF(t){const{auth:e,user:r}=t;return dt(r,e,"internal-error"),Q9(r,new ny(t),t.bypassAuthState)}class bk{constructor(e,r,n,a,i=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:i,error:o,type:u}=e;if(o){this.reject(o);return}const f={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return yF;case"linkViaPopup":case"linkViaRedirect":return wF;case"reauthViaPopup":case"reauthViaRedirect":return _F;default:Mi(this.auth,"internal-error")}}resolve(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const bF=new $0(2e3,1e4);class su extends bk{constructor(e,r,n,a,i){super(e,r,a,i),this.provider=n,this.authWindow=null,this.pollId=null,su.currentPopupAction&&su.currentPopupAction.cancel(),su.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return dt(e,this.auth,"internal-error"),e}async onExecution(){Pi(this.filter.length===1,"Popup operations only handle one event");const e=ry();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Ys(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Ys(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,su.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ys(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,bF.get())};e()}}su.currentPopupAction=null;const EF="pendingRedirect",lm=new Map;class TF extends bk{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=lm.get(this.auth._key());if(!e){try{const n=await SF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}lm.set(this.auth._key(),e)}return this.bypassAuthState||lm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function SF(t,e){const r=CF(e),n=kF(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function AF(t,e){lm.set(t._key(),e)}function kF(t){return Ti(t._redirectPersistence)}function CF(t){return im(EF,t.config.apiKey,t.name)}async function NF(t,e,r=!1){if(ys(t.app))return Promise.reject(jl(t));const n=pp(t),a=vF(n,e),o=await new TF(n,a,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}const RF=600*1e3;class IF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!DF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!Ek(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Ys(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=RF&&this.cachedEventUids.clear(),this.cachedEventUids.has(iT(e))}saveEventToCache(e){this.cachedEventUids.add(iT(e)),this.lastProcessedEventTime=Date.now()}}function iT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Ek({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function DF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ek(t);default:return!1}}async function OF(t,e={}){return Mu(t,"GET","/v1/projects",e)}const FF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,MF=/^https?/;async function PF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await OF(t);for(const r of e)try{if(jF(r))return}catch{}Mi(t,"unauthorized-domain")}function jF(t){const e=Bx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!MF.test(r))return!1;if(FF.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}const LF=new $0(3e4,6e4);function lT(){const t=$s().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function BF(t){return new Promise((e,r)=>{function n(){lT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{lT(),r(Ys(t,"network-request-failed"))},timeout:LF.get()})}if($s().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if($s().gapi?.load)n();else{const a=z9("iframefcb");return $s()[a]=()=>{gapi.load?n():r(Ys(t,"network-request-failed"))},V9(`${U9()}?onload=${a}`).catch(i=>r(i))}}).catch(e=>{throw om=null,e})}let om=null;function VF(t){return om=om||BF(t),om}const UF=new $0(5e3,15e3),zF="__/auth/iframe",HF="emulator/auth/iframe",GF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},qF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function WF(t){const e=t.config;dt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Jv(e,HF):`https://${t.config.authDomain}/${zF}`,n={apiKey:e.apiKey,appName:t.name,v:Nu},a=qF.get(t.config.apiHost);a&&(n.eid=a);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${L0(n).slice(1)}`}async function XF(t){const e=await VF(t),r=$s().gapi;return dt(r,t,"internal-error"),e.open({where:document.body,url:WF(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:GF,dontclear:!0},n=>new Promise(async(a,i)=>{await n.restyle({setHideOnLeave:!1});const o=Ys(t,"network-request-failed"),u=$s().setTimeout(()=>{i(o)},UF.get());function f(){$s().clearTimeout(u),a(n)}n.ping(f).then(f,()=>{i(o)})}))}const YF={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$F=500,KF=600,QF="_blank",JF="http://localhost";class oT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ZF(t,e,r,n=$F,a=KF){const i=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const f={...YF,width:n.toString(),height:a.toString(),top:i,left:o},d=Gn().toLowerCase();r&&(u=nk(d)?QF:r),tk(d)&&(e=e||JF,f.scrollbars="yes");const m=Object.entries(f).reduce((y,[b,E])=>`${y}${b}=${E},`,"");if(D9(d)&&u!=="_self")return eM(e||"",u),new oT(null);const x=window.open(e||"",u,m);dt(x,t,"popup-blocked");try{x.focus()}catch{}return new oT(x)}function eM(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const tM="__/auth/handler",rM="emulator/auth/handler",nM=encodeURIComponent("fac");async function cT(t,e,r,n,a,i){dt(t.config.authDomain,t,"auth-domain-config-required"),dt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Nu,eventId:a};if(e instanceof hk){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",$5(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,x]of Object.entries({}))o[m]=x}if(e instanceof K0){const m=e.getScopes().filter(x=>x!=="");m.length>0&&(o.scopes=m.join(","))}t.tenantId&&(o.tid=t.tenantId);const u=o;for(const m of Object.keys(u))u[m]===void 0&&delete u[m];const f=await t._getAppCheckToken(),d=f?`#${nM}=${encodeURIComponent(f)}`:"";return`${aM(t)}?${L0(u).slice(1)}${d}`}function aM({config:t}){return t.emulator?Jv(t,rM):`https://${t.authDomain}/${tM}`}const q1="webStorageSupport";class sM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xk,this._completeRedirectFn=NF,this._overrideRedirectResult=AF}async _openPopup(e,r,n,a){Pi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await cT(e,r,n,Bx(),a);return ZF(e,i,ry())}async _openRedirect(e,r,n,a){await this._originValidation(e);const i=await cT(e,r,n,Bx(),a);return oF(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:i}=this.eventManagers[r];return a?Promise.resolve(a):(Pi(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await XF(e),n=new IF(e);return r.register("authEvent",a=>(dt(a?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(q1,{type:q1},a=>{const i=a?.[0]?.[q1];i!==void 0&&r(!!i),Mi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=PF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return ok()||rk()||ey()}}const iM=sM;var uT="@firebase/auth",fT="1.11.1";class lM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){dt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function oM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function cM(t){pu(new qo("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=n.options;dt(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:o,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ck(t)},d=new L9(n,a,i,f);return G9(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),pu(new qo("auth-internal",e=>{const r=pp(e.getProvider("auth").getImmediate());return(n=>new lM(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ol(uT,fT,oM(t)),Ol(uT,fT,"esm2020")}const uM=300,fM=n4("authIdTokenMaxAge")||uM;let hT=null;const hM=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>fM)return;const a=r?.token;hT!==a&&(hT=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function dM(t=c4()){const e=pv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=H9(t,{popupRedirectResolver:iM,persistence:[xF,sF,xk]}),n=n4("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=hM(i.toString());tF(r,o,()=>o(r.currentUser)),eF(r,u=>o(u))}}const a=t4("auth");return a&&q9(r,`http://${a}`),r}function mM(){return document.getElementsByTagName("head")?.[0]??document}B9({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const i=Ys("internal-error");i.customData=a,r(i)},n.type="text/javascript",n.charset="UTF-8",mM().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});cM("Browser");const pM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gM=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),dT=t=>{const e=gM(t);return e.charAt(0).toUpperCase()+e.slice(1)},Tk=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),xM=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var vM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const yM=re.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...u},f)=>re.createElement("svg",{ref:f,...vM,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:Tk("lucide",a),...!i&&!xM(u)&&{"aria-hidden":"true"},...u},[...o.map(([d,m])=>re.createElement(d,m)),...Array.isArray(i)?i:[i]]));const We=(t,e)=>{const r=re.forwardRef(({className:n,...a},i)=>re.createElement(yM,{ref:i,iconNode:e,className:Tk(`lucide-${pM(dT(t))}`,`lucide-${t}`,n),...a}));return r.displayName=dT(t),r};const _M=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],wM=We("archive",_M);const bM=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Sk=We("arrow-down",bM);const EM=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ak=We("arrow-left",EM);const TM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],SM=We("arrow-right",TM);const AM=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],kM=We("arrow-up",AM);const CM=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],NM=We("bold",CM);const RM=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],IM=We("calculator",RM);const DM=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ay=We("calendar",DM);const OM=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],sy=We("camera",OM);const FM=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],MM=We("chevron-down",FM);const PM=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],jM=We("chevron-left",PM);const LM=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],kk=We("chevron-right",LM);const BM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],VM=We("circle-alert",BM);const UM=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],J0=We("circle-check-big",UM);const zM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Nm=We("circle-question-mark",zM);const HM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],GM=We("circle-x",HM);const qM=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ck=We("clock-3",qM);const WM=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],iy=We("clock",WM);const XM=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],YM=We("cloud-upload",XM);const $M=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],KM=We("credit-card",$M);const QM=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Rm=We("crown",QM);const JM=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],ZM=We("database",JM);const eP=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],ly=We("dollar-sign",eP);const tP=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Nk=We("download",tP);const rP=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],zs=We("external-link",rP);const nP=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Rk=We("file-spreadsheet",nP);const aP=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],zx=We("file-text",aP);const sP=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],iP=We("folder",sP);const lP=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],mT=We("heart",lP);const oP=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Z0=We("image",oP);const cP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],oy=We("info",cP);const uP=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],fP=We("italic",uP);const hP=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Ik=We("key",hP);const dP=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Im=We("link",dP);const mP=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],pP=We("list-checks",mP);const gP=[["path",{d:"M2 5h20",key:"1fs1ex"}],["path",{d:"M6 12h12",key:"8npq4p"}],["path",{d:"M9 19h6",key:"456am0"}]],xP=We("list-filter",gP);const vP=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],yP=We("list",vP);const _P=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],wP=We("lock",_P);const bP=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Dk=We("log-out",bP);const EP=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],TP=We("map-pin",EP);const SP=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],Dm=We("megaphone",SP);const AP=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],pT=We("message-square",AP);const kP=[["path",{d:"M5 12h14",key:"1ays0h"}]],cy=We("minus",kP);const CP=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],gT=We("music",CP);const NP=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],vp=We("package",NP);const RP=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],yp=We("pen-line",RP);const IP=[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]],Ok=We("plane",IP);const DP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],$o=We("plus",DP);const OP=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],FP=We("refresh-ccw",OP);const MP=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],PP=We("refresh-cw",MP);const jP=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],xT=We("rocket",jP);const LP=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],BP=We("rotate-ccw",LP);const VP=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ic=We("save",VP);const UP=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],zP=We("school",UP);const HP=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Fk=We("search",HP);const GP=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Mk=We("shield",GP);const qP=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],Pk=We("shopping-bag",qP);const WP=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],_p=We("shopping-cart",WP);const XP=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Ko=We("tag",XP);const YP=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]],$P=We("text-align-end",YP);const KP=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]],QP=We("text-align-center",KP);const JP=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],ZP=We("text-align-start",JP);const ej=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],jk=We("ticket",ej);const tj=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],eh=We("trash-2",tj);const rj=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Lk=We("triangle-alert",rj);const nj=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],th=We("truck",nj);const aj=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],W1=We("type",aj);const sj=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],ij=We("underline",sj);const lj=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],uy=We("upload",lj);const oj=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],fy=We("user",oj);const cj=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],vT=We("users",cj);const uj=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],fj=We("volume-2",uj);const hj=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],dj=We("volume-x",hj);const mj=[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]],pj=We("wallet",mj);const gj=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ha=We("x",gj);const xj=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Om=We("zap",xj);const vj=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],yj=We("zoom-in",vj);const _j=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],wj=We("zoom-out",_j);function bj({users:t,onLogin:e}){const[r,n]=re.useState(""),[a,i]=re.useState(""),o=d=>{d.preventDefault(),e(r,a)},f="PLUS ULTRA  GO BEYOND  PLUS ULTRA  GO BEYOND  ".repeat(4);return p.jsxs("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[p.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"radial-gradient(#ffffff 1px, transparent 1px)",backgroundSize:"20px 20px"}}),p.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-32 flex justify-center pointer-events-none overflow-hidden select-none opacity-10",children:p.jsxs("div",{className:"animate-scroll-down whitespace-nowrap text-8xl font-black text-slate-100 tracking-tighter",style:{writingMode:"vertical-rl"},children:[p.jsx("span",{children:f}),p.jsx("span",{children:f})]})}),p.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-32 flex justify-center pointer-events-none overflow-hidden select-none opacity-10",children:p.jsxs("div",{className:"animate-scroll-up whitespace-nowrap text-8xl font-black text-slate-100 tracking-tighter",style:{writingMode:"vertical-rl"},children:[p.jsx("span",{children:f}),p.jsx("span",{children:f})]})}),p.jsx("style",{jsx:!0,children:`
        @keyframes scroll-up {
          0% { transform: translateY(0); }
          100% { transform: translateY(-50%); }
        }
        
        @keyframes scroll-down {
          0% { transform: translateY(-50%); }
          100% { transform: translateY(0); }
        }

        .animate-scroll-up {
          /* 1.  50s */
          animation: scroll-up 50s linear infinite;
          /* 2.   GPU  () */
          will-change: transform;
        }

        .animate-scroll-down {
          /* 1.  50s */
          animation: scroll-down 50s linear infinite;
          /* 2.   */
          will-change: transform;
        }
      `}),p.jsxs("form",{onSubmit:o,className:`\r
          bg-white w-full max-w-md p-8 rounded-lg \r
          border-4 border-slate-900 \r
          shadow-[8px_8px_0px_0px_#FACC15] \r
          relative overflow-hidden z-10\r
        `,children:[p.jsx("div",{className:"absolute top-0 left-0 w-full h-1/4 bg-red-600 transform -skew-y-3 -mt-8 opacity-10"}),p.jsxs("div",{className:"text-center mb-8 relative z-10",children:[p.jsx("div",{className:"inline-block p-4 bg-slate-900 rounded-full text-yellow-400 mb-4 border-2 border-yellow-400",children:p.jsx(Mk,{size:36})}),p.jsx("h1",{className:"text-3xl font-black italic text-slate-900 tracking-wider",children:""}),p.jsx("p",{className:"text-slate-500 text-sm mt-1 font-bold",children:"U.A. ACADEMY LOGIN"})]}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{children:[p.jsxs("label",{className:"text-slate-900 text-sm font-black italic block mb-1 flex items-center gap-1",children:[p.jsx(fy,{size:16}),"  (Your ID)"]}),p.jsxs("select",{className:`\r
                w-full border-2 border-slate-900 rounded-lg px-3 py-2.5 \r
                bg-slate-50 text-slate-800 font-bold \r
                focus:outline-none focus:ring-4 focus:ring-yellow-400 \r
                transition-all appearance-none\r
              `,value:r,onChange:d=>n(d.target.value),required:!0,children:[p.jsx("option",{value:"",children:"..."}),t.map(d=>p.jsx("option",{value:d.id,children:d.name},d.id))]})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-slate-900 text-sm font-black italic block mb-1 flex items-center gap-1",children:[p.jsx(wP,{size:16}),"  (Password)"]}),p.jsx("input",{type:"password",value:a,onChange:d=>i(d.target.value),placeholder:"",className:`\r
                w-full border-2 border-slate-900 rounded-lg px-3 py-2 \r
                bg-slate-50 text-slate-900 font-bold \r
                focus:outline-none focus:ring-4 focus:ring-yellow-400 \r
                placeholder-slate-400 transition-all\r
              `,required:!0}),p.jsx("span",{className:"text-xs text-slate-500 font-medium mt-1",children:" 4  0 "})]}),p.jsxs("button",{type:"submit",className:`\r
              w-full py-3 mt-4 text-xl \r
              bg-red-600 text-white font-black italic \r
              rounded-lg border-2 border-red-800\r
              shadow-[4px_4px_0px_0px_rgba(15,23,42,1)]\r
              hover:bg-red-700 \r
              disabled:opacity-50 disabled:shadow-none\r
              transition-all transform active:translate-y-0.5 active:translate-x-0.5 active:shadow-none\r
            `,disabled:!r||!a,children:[p.jsx(SM,{size:20,className:"inline mr-2"})," (LOGIN!)"]})]})]})]})}var Ej="firebase",Tj="12.6.0";Ol(Ej,Tj,"app");console.log("FB KEY =","AIzaSyD97NjWJOV7NPgAzEEgzX7U31yXkq6L0VI");const Sj={apiKey:"AIzaSyD97NjWJOV7NPgAzEEgzX7U31yXkq6L0VI",authDomain:"my-shopping-cart-be7df.firebaseapp.com",projectId:"my-shopping-cart-be7df",storageBucket:"my-shopping-cart-be7df.firebasestorage.app",messagingSenderId:"968807957116",appId:"1:968807957116:web:b4d0c85cc06c9afed53ff9",measurementId:"G-M4E24RKXL0"},Bk=o4(Sj),$e=r9(Bk),X1=dM(Bk);var es=function(t,e){return Number(t.toFixed(e))},Aj=function(t,e){return e},Ar=function(t,e,r){r&&typeof r=="function"&&r(t,e)},kj=function(t){return-Math.cos(t*Math.PI)/2+.5},Cj=function(t){return t},Nj=function(t){return t*t},Rj=function(t){return t*(2-t)},Ij=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},Dj=function(t){return t*t*t},Oj=function(t){return--t*t*t+1},Fj=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},Mj=function(t){return t*t*t*t},Pj=function(t){return 1- --t*t*t*t},jj=function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},Lj=function(t){return t*t*t*t*t},Bj=function(t){return 1+--t*t*t*t*t},Vj=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},Vk={easeOut:kj,linear:Cj,easeInQuad:Nj,easeOutQuad:Rj,easeInOutQuad:Ij,easeInCubic:Dj,easeOutCubic:Oj,easeInOutCubic:Fj,easeInQuart:Mj,easeOutQuart:Pj,easeInOutQuart:jj,easeInQuint:Lj,easeOutQuint:Bj,easeInOutQuint:Vj},Uk=function(t){typeof t=="number"&&cancelAnimationFrame(t)},vs=function(t){t.mounted&&(Uk(t.animation),t.animate=!1,t.animation=null,t.velocity=null)};function zk(t,e,r,n){if(t.mounted){var a=new Date().getTime(),i=1;vs(t),t.animation=function(){if(!t.mounted)return Uk(t.animation);var o=new Date().getTime()-a,u=o/r,f=Vk[e],d=f(u);o>=r?(n(i),t.animation=null):t.animation&&(n(d),requestAnimationFrame(t.animation))},requestAnimationFrame(t.animation)}}function Uj(t){var e=t.scale,r=t.positionX,n=t.positionY;return!(Number.isNaN(e)||Number.isNaN(r)||Number.isNaN(n))}function ro(t,e,r,n){var a=Uj(e);if(!(!t.mounted||!a)){var i=t.setTransformState,o=t.transformState,u=o.scale,f=o.positionX,d=o.positionY,m=e.scale-u,x=e.positionX-f,y=e.positionY-d;r===0?i(e.scale,e.positionX,e.positionY):zk(t,n,r,function(b){var E=u+m*b,w=f+x*b,T=d+y*b;i(E,w,T)})}}function zj(t,e,r){var n=t.offsetWidth,a=t.offsetHeight,i=e.offsetWidth,o=e.offsetHeight,u=i*r,f=o*r,d=n-u,m=a-f;return{wrapperWidth:n,wrapperHeight:a,newContentWidth:u,newDiffWidth:d,newContentHeight:f,newDiffHeight:m}}var Hj=function(t,e,r,n,a,i,o){var u=t>e?r*(o?1:.5):0,f=n>a?i*(o?1:.5):0,d=t-e-u,m=u,x=n-a-f,y=f;return{minPositionX:d,maxPositionX:m,minPositionY:x,maxPositionY:y}},hy=function(t,e){var r=t.wrapperComponent,n=t.contentComponent,a=t.setup.centerZoomedOut;if(!r||!n)throw new Error("Components are not mounted");var i=zj(r,n,e),o=i.wrapperWidth,u=i.wrapperHeight,f=i.newContentWidth,d=i.newDiffWidth,m=i.newContentHeight,x=i.newDiffHeight,y=Hj(o,f,d,u,m,x,!!a);return y},Hx=function(t,e,r,n){return n?t<e?es(e,2):t>r?es(r,2):es(t,2):es(t,2)},Lo=function(t,e){var r=hy(t,e);return t.bounds=r,r};function rh(t,e,r,n,a,i,o){var u=r.minPositionX,f=r.minPositionY,d=r.maxPositionX,m=r.maxPositionY,x=0,y=0;o&&(x=a,y=i);var b=Hx(t,u-x,d+x,n),E=Hx(e,f-y,m+y,n);return{x:b,y:E}}function wp(t,e,r,n,a,i){var o=t.transformState,u=o.scale,f=o.positionX,d=o.positionY,m=n-u;if(typeof e!="number"||typeof r!="number")return console.error("Mouse X and Y position were not provided!"),{x:f,y:d};var x=f-e*m,y=d-r*m,b=rh(x,y,a,i,0,0,null);return b}function nh(t,e,r,n,a){var i=a?n:0,o=e-i;return!Number.isNaN(r)&&t>=r?r:!Number.isNaN(e)&&t<=o?o:t}var yT=function(t,e){var r=t.setup.panning.excluded,n=t.isInitialized,a=t.wrapperComponent,i=e.target,o="shadowRoot"in i&&"composedPath"in e,u=o?e.composedPath().some(function(m){return m instanceof Element?a?.contains(m):!1}):a?.contains(i),f=n&&i&&u;if(!f)return!1;var d=bp(i,r);return!d},_T=function(t){var e=t.isInitialized,r=t.isPanning,n=t.setup,a=n.panning.disabled,i=e&&r&&!a;return!!i},Gj=function(t,e){var r=t.transformState,n=r.positionX,a=r.positionY;t.isPanning=!0;var i=e.clientX,o=e.clientY;t.startCoords={x:i-n,y:o-a}},qj=function(t,e){var r=e.touches,n=t.transformState,a=n.positionX,i=n.positionY;t.isPanning=!0;var o=r.length===1;if(o){var u=r[0].clientX,f=r[0].clientY;t.startCoords={x:u-a,y:f-i}}};function Wj(t){var e=t.transformState,r=e.positionX,n=e.positionY,a=e.scale,i=t.setup,o=i.disabled,u=i.limitToBounds,f=i.centerZoomedOut,d=t.wrapperComponent;if(!(o||!d||!t.bounds)){var m=t.bounds,x=m.maxPositionX,y=m.minPositionX,b=m.maxPositionY,E=m.minPositionY,w=r>x||r<y,T=n>b||n<E,R=r>x?d.offsetWidth:t.setup.minPositionX||0,I=n>b?d.offsetHeight:t.setup.minPositionY||0,C=wp(t,R,I,a,t.bounds,u||f),W=C.x,U=C.y;return{scale:a,positionX:w?W:r,positionY:T?U:n}}}function Hk(t,e,r,n,a){var i=t.setup.limitToBounds,o=t.wrapperComponent,u=t.bounds,f=t.transformState,d=f.scale,m=f.positionX,x=f.positionY;if(!(o===null||u===null||e===m&&r===x)){var y=rh(e,r,u,i,n,a,o),b=y.x,E=y.y;t.setTransformState(d,b,E)}}var Xj=function(t,e,r){var n=t.startCoords,a=t.transformState,i=t.setup.panning,o=i.lockAxisX,u=i.lockAxisY,f=a.positionX,d=a.positionY;if(!n)return{x:f,y:d};var m=e-n.x,x=r-n.y,y=o?f:m,b=u?d:x;return{x:y,y:b}},Xl=function(t,e){var r=t.setup,n=t.transformState,a=n.scale,i=r.minScale,o=r.disablePadding;return e>0&&a>=i&&!o?e:0},Yj=function(t){var e=t.mounted,r=t.setup,n=r.disabled,a=r.velocityAnimation,i=t.transformState.scale,o=a.disabled,u=!o||i>1||!n||e;return!!u},$j=function(t){var e=t.mounted,r=t.velocity,n=t.bounds,a=t.setup,i=a.disabled,o=a.velocityAnimation,u=t.transformState.scale,f=o.disabled,d=!f||u>1||!i||e;return!(!d||!r||!n)};function Kj(t,e){var r=t.setup.velocityAnimation,n=r.equalToMove,a=r.animationTime,i=r.sensitivity;return n?a*e*i:a}function wT(t,e,r,n,a,i,o,u,f,d){if(a){if(e>o&&r>o){var m=o+(t-o)*d;return m>f?f:m<o?o:m}if(e<i&&r<i){var m=i+(t-i)*d;return m<u?u:m>i?i:m}}return n?e:Hx(t,i,o,a)}function Qj(t,e){var r=1;return e?Math.min(r,t.offsetWidth/window.innerWidth):r}function Jj(t,e){var r=Yj(t);if(r){var n=t.lastMousePosition,a=t.velocityTime,i=t.setup,o=t.wrapperComponent,u=i.velocityAnimation.equalToMove,f=Date.now();if(n&&a&&o){var d=Qj(o,u),m=e.x-n.x,x=e.y-n.y,y=m/d,b=x/d,E=f-a,w=m*m+x*x,T=Math.sqrt(w)/E;t.velocity={velocityX:y,velocityY:b,total:T}}t.lastMousePosition=e,t.velocityTime=f}}function Zj(t){var e=t.velocity,r=t.bounds,n=t.setup,a=t.wrapperComponent,i=$j(t);if(!(!i||!e||!r||!a)){var o=e.velocityX,u=e.velocityY,f=e.total,d=r.maxPositionX,m=r.minPositionX,x=r.maxPositionY,y=r.minPositionY,b=n.limitToBounds,E=n.alignmentAnimation,w=n.zoomAnimation,T=n.panning,R=T.lockAxisY,I=T.lockAxisX,C=w.animationType,W=E.sizeX,U=E.sizeY,B=E.velocityAlignmentTime,A=B,D=Kj(t,f),N=Math.max(D,A),M=Xl(t,W),F=Xl(t,U),P=M*a.offsetWidth/100,V=F*a.offsetHeight/100,Ee=d+P,we=m-P,ie=x+V,ee=y-V,ye=t.transformState,ae=new Date().getTime();zk(t,C,N,function(Me){var Y=t.transformState,j=Y.scale,X=Y.positionX,J=Y.positionY,ne=new Date().getTime()-ae,ue=ne/A,Te=Vk[E.animationType],Re=1-Te(Math.min(1,ue)),Ce=1-Me,Fe=X+o*Ce,st=J+u*Ce,te=wT(Fe,ye.positionX,X,I,b,m,d,we,Ee,Re),Ct=wT(st,ye.positionY,J,R,b,y,x,ee,ie,Re);(X!==Fe||J!==st)&&t.setTransformState(j,te,Ct)})}}function bT(t,e){var r=t.transformState.scale;vs(t),Lo(t,r),window.TouchEvent!==void 0&&e instanceof TouchEvent?qj(t,e):Gj(t,e)}function dy(t,e){var r=t.transformState.scale,n=t.setup,a=n.minScale,i=n.alignmentAnimation,o=i.disabled,u=i.sizeX,f=i.sizeY,d=i.animationTime,m=i.animationType,x=o||r<a||!u&&!f;if(!x){var y=Wj(t);y&&ro(t,y,e??d,m)}}function ET(t,e,r){var n=t.startCoords,a=t.setup,i=a.alignmentAnimation,o=i.sizeX,u=i.sizeY;if(n){var f=Xj(t,e,r),d=f.x,m=f.y,x=Xl(t,o),y=Xl(t,u);Jj(t,{x:d,y:m}),Hk(t,d,m,x,y)}}function eL(t){if(t.isPanning){var e=t.setup.panning.velocityDisabled,r=t.velocity,n=t.wrapperComponent,a=t.contentComponent;t.isPanning=!1,t.animate=!1,t.animation=null;var i=n?.getBoundingClientRect(),o=a?.getBoundingClientRect(),u=i?.width||0,f=i?.height||0,d=o?.width||0,m=o?.height||0,x=u<d||f<m,y=!e&&r&&r?.total>.1&&x;y?Zj(t):dy(t)}}function my(t,e,r,n){var a=t.setup,i=a.minScale,o=a.maxScale,u=a.limitToBounds,f=nh(es(e,2),i,o,0,!1),d=Lo(t,f),m=wp(t,r,n,f,d,u),x=m.x,y=m.y;return{scale:f,positionX:x,positionY:y}}function Gk(t,e,r){var n=t.transformState.scale,a=t.wrapperComponent,i=t.setup,o=i.minScale,u=i.limitToBounds,f=i.zoomAnimation,d=f.disabled,m=f.animationTime,x=f.animationType,y=d||n>=o;if((n>=1||u)&&dy(t),!(y||!a||!t.mounted)){var b=e||a.offsetWidth/2,E=r||a.offsetHeight/2,w=my(t,o,b,E);w&&ro(t,w,m,x)}}var Ll=function(){return Ll=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Ll.apply(this,arguments)};function TT(t,e,r){for(var n=0,a=e.length,i;n<a;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}var Ld={scale:1,positionX:0,positionY:0},Lf={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},Gx={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},qk=function(t){var e,r,n,a;return{previousScale:(e=t.initialScale)!==null&&e!==void 0?e:Ld.scale,scale:(r=t.initialScale)!==null&&r!==void 0?r:Ld.scale,positionX:(n=t.initialPositionX)!==null&&n!==void 0?n:Ld.positionX,positionY:(a=t.initialPositionY)!==null&&a!==void 0?a:Ld.positionY}},ST=function(t){var e=Ll({},Lf);return Object.keys(t).forEach(function(r){var n=typeof t[r]<"u",a=typeof Lf[r]<"u";if(a&&n){var i=Object.prototype.toString.call(Lf[r]),o=i==="[object Object]",u=i==="[object Array]";o?e[r]=Ll(Ll({},Lf[r]),t[r]):u?e[r]=TT(TT([],Lf[r],!0),t[r]):e[r]=t[r]}}),e},Wk=function(t,e,r){var n=t.transformState.scale,a=t.wrapperComponent,i=t.setup,o=i.maxScale,u=i.minScale,f=i.zoomAnimation,d=i.smooth,m=f.size;if(!a)throw new Error("Wrapper is not mounted");var x=d?n*Math.exp(e*r):n+e*r,y=nh(es(x,3),u,o,m,!1);return y};function Xk(t,e,r,n,a){var i=t.wrapperComponent,o=t.transformState,u=o.scale,f=o.positionX,d=o.positionY;if(!i)return console.error("No WrapperComponent found");var m=i.offsetWidth,x=i.offsetHeight,y=(m/2-f)/u,b=(x/2-d)/u,E=Wk(t,e,r),w=my(t,E,y,b);if(!w)return console.error("Error during zoom event. New transformation state was not calculated.");ro(t,w,n,a)}function Yk(t,e,r,n){var a=t.setup,i=t.wrapperComponent,o=a.limitToBounds,u=qk(t.props),f=t.transformState,d=f.scale,m=f.positionX,x=f.positionY;if(i){var y=hy(t,u.scale),b=rh(u.positionX,u.positionY,y,o,0,0,i),E={scale:u.scale,positionX:b.x,positionY:b.y};d===u.scale&&m===u.positionX&&x===u.positionY||(n?.(),ro(t,E,e,r))}}function tL(t,e,r,n){var a=t.getBoundingClientRect(),i=e.getBoundingClientRect(),o=r.getBoundingClientRect(),u=i.x*n.scale,f=i.y*n.scale;return{x:(a.x-o.x+u)/n.scale,y:(a.y-o.y+f)/n.scale}}function rL(t,e,r){var n=t.wrapperComponent,a=t.contentComponent,i=t.transformState,o=t.setup,u=o.limitToBounds,f=o.minScale,d=o.maxScale;if(!n||!a)return i;var m=n.getBoundingClientRect(),x=e.getBoundingClientRect(),y=tL(e,n,a,i),b=y.x,E=y.y,w=x.width/i.scale,T=x.height/i.scale,R=n.offsetWidth/w,I=n.offsetHeight/T,C=nh(r||Math.min(R,I),f,d,0,!1),W=(m.width-w*C)/2,U=(m.height-T*C)/2,B=(m.left-b)*C+W,A=(m.top-E)*C+U,D=hy(t,C),N=rh(B,A,D,u,0,0,n),M=N.x,F=N.y;return{positionX:M,positionY:F,scale:C}}var nL=function(t){return function(e,r,n){e===void 0&&(e=.5),r===void 0&&(r=300),n===void 0&&(n="easeOut"),Xk(t,1,e,r,n)}},aL=function(t){return function(e,r,n){e===void 0&&(e=.5),r===void 0&&(r=300),n===void 0&&(n="easeOut"),Xk(t,-1,e,r,n)}},sL=function(t){return function(e,r,n,a,i){a===void 0&&(a=300),i===void 0&&(i="easeOut");var o=t.transformState,u=o.positionX,f=o.positionY,d=o.scale,m=t.wrapperComponent,x=t.contentComponent,y=t.setup.disabled;if(!(y||!m||!x)){var b={positionX:Number.isNaN(e)?u:e,positionY:Number.isNaN(r)?f:r,scale:Number.isNaN(n)?d:n};ro(t,b,a,i)}}},iL=function(t){return function(e,r){e===void 0&&(e=200),r===void 0&&(r="easeOut"),Yk(t,e,r)}},lL=function(t){return function(e,r,n){r===void 0&&(r=200),n===void 0&&(n="easeOut");var a=t.transformState,i=t.wrapperComponent,o=t.contentComponent;if(i&&o){var u=$k(e||a.scale,i,o);ro(t,u,r,n)}}},oL=function(t){return function(e,r,n,a){n===void 0&&(n=600),a===void 0&&(a="easeOut"),vs(t);var i=t.wrapperComponent,o=typeof e=="string"?document.getElementById(e):e;if(i&&o&&i.contains(o)){var u=rL(t,o,r);ro(t,u,n,a)}}},qx=function(t){return{instance:t,zoomIn:nL(t),zoomOut:aL(t),setTransform:sL(t),resetTransform:iL(t),centerView:lL(t),zoomToElement:oL(t)}},cL=function(t){return{instance:t,state:t.transformState}},mr=function(t){var e={};return Object.assign(e,cL(t)),Object.assign(e,qx(t)),e},Y1=!1;function $1(){try{var t={get passive(){return Y1=!0,!1}};return t}catch{return Y1=!1,Y1}}var Bd=".".concat(Gx.wrapperClass),bp=function(t,e){return e.some(function(r){return t.matches("".concat(Bd," ").concat(r,", ").concat(Bd," .").concat(r,", ").concat(Bd," ").concat(r," *, ").concat(Bd," .").concat(r," *"))})},Wx=function(t){t&&clearTimeout(t)},uL=function(t,e,r){return"translate(".concat(t,"px, ").concat(e,"px) scale(").concat(r,")")},$k=function(t,e,r){var n=r.offsetWidth*t,a=r.offsetHeight*t,i=(e.offsetWidth-n)/2,o=(e.offsetHeight-a)/2;return{scale:t,positionX:i,positionY:o}};function fL(t){return function(e){t.forEach(function(r){typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var hL=function(t,e){var r=t.setup.wheel,n=r.disabled,a=r.wheelDisabled,i=r.touchPadDisabled,o=r.excluded,u=t.isInitialized,f=t.isPanning,d=e.target,m=u&&!f&&!n&&d;if(!m||a&&!e.ctrlKey||i&&e.ctrlKey)return!1;var x=bp(d,o);return!x},dL=function(t){return t?t.deltaY<0?1:-1:0};function mL(t,e){var r=dL(t),n=Aj(e,r);return n}function Kk(t,e,r){var n=e.getBoundingClientRect(),a=0,i=0;if("clientX"in t)a=(t.clientX-n.left)/r,i=(t.clientY-n.top)/r;else{var o=t.touches[0];a=(o.clientX-n.left)/r,i=(o.clientY-n.top)/r}return(Number.isNaN(a)||Number.isNaN(i))&&console.error("No mouse or touch offset found"),{x:a,y:i}}var pL=function(t,e,r,n,a){var i=t.transformState.scale,o=t.wrapperComponent,u=t.setup,f=u.maxScale,d=u.minScale,m=u.zoomAnimation,x=u.disablePadding,y=m.size,b=m.disabled;if(!o)throw new Error("Wrapper is not mounted");var E=i+e*r,w=n?!1:!b,T=nh(es(E,3),d,f,y,w&&!x);return T},gL=function(t,e){var r=t.previousWheelEvent,n=t.transformState.scale,a=t.setup,i=a.maxScale,o=a.minScale;return r?n<i||n>o||Math.sign(r.deltaY)!==Math.sign(e.deltaY)||r.deltaY>0&&r.deltaY<e.deltaY||r.deltaY<0&&r.deltaY>e.deltaY||Math.sign(r.deltaY)!==Math.sign(e.deltaY):!1},xL=function(t,e){var r=t.setup.pinch,n=r.disabled,a=r.excluded,i=t.isInitialized,o=e.target,u=i&&!n&&o;if(!u)return!1;var f=bp(o,a);return!f},vL=function(t){var e=t.setup.pinch.disabled,r=t.isInitialized,n=t.pinchStartDistance,a=r&&!e&&n;return!!a},yL=function(t,e,r){var n=r.getBoundingClientRect(),a=t.touches,i=es(a[0].clientX-n.left,5),o=es(a[0].clientY-n.top,5),u=es(a[1].clientX-n.left,5),f=es(a[1].clientY-n.top,5);return{x:(i+u)/2/e,y:(o+f)/2/e}},Qk=function(t){return Math.sqrt(Math.pow(t.touches[0].pageX-t.touches[1].pageX,2)+Math.pow(t.touches[0].pageY-t.touches[1].pageY,2))},_L=function(t,e){var r=t.pinchStartScale,n=t.pinchStartDistance,a=t.setup,i=a.maxScale,o=a.minScale,u=a.zoomAnimation,f=a.disablePadding,d=u.size,m=u.disabled;if(!r||n===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return t.transformState.scale;var x=e/n,y=x*r;return nh(es(y,2),o,i,d,!m&&!f)},wL=160,bL=100,EL=function(t,e){var r=t.props,n=r.onWheelStart,a=r.onZoomStart;t.wheelStopEventTimer||(vs(t),Ar(mr(t),e,n),Ar(mr(t),e,a))},TL=function(t,e){var r=t.props,n=r.onWheel,a=r.onZoom,i=t.contentComponent,o=t.setup,u=t.transformState,f=u.scale,d=o.limitToBounds,m=o.centerZoomedOut,x=o.zoomAnimation,y=o.wheel,b=o.disablePadding,E=o.smooth,w=x.size,T=x.disabled,R=y.step,I=y.smoothStep;if(!i)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var C=mL(e,null),W=E?I*Math.abs(e.deltaY):R,U=pL(t,C,W,!e.ctrlKey);if(f!==U){var B=Lo(t,U),A=Kk(e,i,f),D=T||w===0||m||b,N=d&&D,M=wp(t,A.x,A.y,U,B,N),F=M.x,P=M.y;t.previousWheelEvent=e,t.setTransformState(U,F,P),Ar(mr(t),e,n),Ar(mr(t),e,a)}},SL=function(t,e){var r=t.props,n=r.onWheelStop,a=r.onZoomStop;Wx(t.wheelAnimationTimer),t.wheelAnimationTimer=setTimeout(function(){t.mounted&&(Gk(t,e.x,e.y),t.wheelAnimationTimer=null)},bL);var i=gL(t,e);i&&(Wx(t.wheelStopEventTimer),t.wheelStopEventTimer=setTimeout(function(){t.mounted&&(t.wheelStopEventTimer=null,Ar(mr(t),e,n),Ar(mr(t),e,a))},wL))},Jk=function(t){for(var e=0,r=0,n=0;n<2;n+=1)e+=t.touches[n].clientX,r+=t.touches[n].clientY;var a=e/2,i=r/2;return{x:a,y:i}},AL=function(t,e){var r=Qk(e);t.pinchStartDistance=r,t.lastDistance=r,t.pinchStartScale=t.transformState.scale,t.isPanning=!1;var n=Jk(e);t.pinchLastCenterX=n.x,t.pinchLastCenterY=n.y,vs(t)},kL=function(t,e){var r=t.contentComponent,n=t.pinchStartDistance,a=t.wrapperComponent,i=t.transformState.scale,o=t.setup,u=o.limitToBounds,f=o.centerZoomedOut,d=o.zoomAnimation,m=o.alignmentAnimation,x=d.disabled,y=d.size;if(!(n===null||!r)){var b=yL(e,i,r);if(!(!Number.isFinite(b.x)||!Number.isFinite(b.y))){var E=Qk(e),w=_L(t,E),T=Jk(e),R=T.x-(t.pinchLastCenterX||0),I=T.y-(t.pinchLastCenterY||0);if(!(w===i&&R===0&&I===0)){t.pinchLastCenterX=T.x,t.pinchLastCenterY=T.y;var C=Lo(t,w),W=x||y===0||f,U=u&&W,B=wp(t,b.x,b.y,w,C,U),A=B.x,D=B.y;t.pinchMidpoint=b,t.lastDistance=E;var N=m.sizeX,M=m.sizeY,F=Xl(t,N),P=Xl(t,M),V=A+R,Ee=D+I,we=rh(V,Ee,C,u,F,P,a),ie=we.x,ee=we.y;t.setTransformState(w,ie,ee)}}}},CL=function(t){var e=t.pinchMidpoint;t.velocity=null,t.lastDistance=null,t.pinchMidpoint=null,t.pinchStartScale=null,t.pinchStartDistance=null,Gk(t,e?.x,e?.y)},Zk=function(t,e){var r=t.props.onZoomStop,n=t.setup.doubleClick.animationTime;Wx(t.doubleClickStopEventTimer),t.doubleClickStopEventTimer=setTimeout(function(){t.doubleClickStopEventTimer=null,Ar(mr(t),e,r)},n)},NL=function(t,e){var r=t.props,n=r.onZoomStart,a=r.onZoom,i=t.setup.doubleClick,o=i.animationTime,u=i.animationType;Ar(mr(t),e,n),Yk(t,o,u,function(){return Ar(mr(t),e,a)}),Zk(t,e)};function RL(t,e){return t==="toggle"?e===1?1:-1:t==="zoomOut"?-1:1}function IL(t,e){var r=t.setup,n=t.doubleClickStopEventTimer,a=t.transformState,i=t.contentComponent,o=a.scale,u=t.props,f=u.onZoomStart,d=u.onZoom,m=r.doubleClick,x=m.disabled,y=m.mode,b=m.step,E=m.animationTime,w=m.animationType;if(!x&&!n){if(y==="reset")return NL(t,e);if(!i)return console.error("No ContentComponent found");var T=RL(y,t.transformState.scale),R=Wk(t,T,b);if(o!==R){Ar(mr(t),e,f);var I=Kk(e,i,o),C=my(t,R,I.x,I.y);if(!C)return console.error("Error during zoom event. New transformation state was not calculated.");Ar(mr(t),e,d),ro(t,C,E,w),Zk(t,e)}}}var DL=function(t,e){var r=t.isInitialized,n=t.setup,a=t.wrapperComponent,i=n.doubleClick,o=i.disabled,u=i.excluded,f=e.target,d=a?.contains(f),m=r&&f&&d&&!o;if(!m)return!1;var x=bp(f,u);return!x},OL=(function(){function t(e){var r=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){r.initializeWindowEvents()},this.unmount=function(){r.cleanupWindowEvents()},this.update=function(n){r.props=n,Lo(r,r.transformState.scale),r.setup=ST(n)},this.initializeWindowEvents=function(){var n,a,i=$1(),o=(n=r.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,u=o?.defaultView;(a=r.wrapperComponent)===null||a===void 0||a.addEventListener("wheel",r.onWheelPanning,i),u?.addEventListener("mousedown",r.onPanningStart,i),u?.addEventListener("mousemove",r.onPanning,i),u?.addEventListener("mouseup",r.onPanningStop,i),o?.addEventListener("mouseleave",r.clearPanning,i),u?.addEventListener("keyup",r.setKeyUnPressed,i),u?.addEventListener("keydown",r.setKeyPressed,i)},this.cleanupWindowEvents=function(){var n,a,i=$1(),o=(n=r.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,u=o?.defaultView;u?.removeEventListener("mousedown",r.onPanningStart,i),u?.removeEventListener("mousemove",r.onPanning,i),u?.removeEventListener("mouseup",r.onPanningStop,i),o?.removeEventListener("mouseleave",r.clearPanning,i),u?.removeEventListener("keyup",r.setKeyUnPressed,i),u?.removeEventListener("keydown",r.setKeyPressed,i),document.removeEventListener("mouseleave",r.clearPanning,i),vs(r),(a=r.observer)===null||a===void 0||a.disconnect()},this.handleInitializeWrapperEvents=function(n){var a=$1();n.addEventListener("wheel",r.onWheelZoom,a),n.addEventListener("dblclick",r.onDoubleClick,a),n.addEventListener("touchstart",r.onTouchPanningStart,a),n.addEventListener("touchmove",r.onTouchPanning,a),n.addEventListener("touchend",r.onTouchPanningStop,a)},this.handleInitialize=function(n,a){var i=!1,o=r.setup.centerOnInit,u=function(f,d){for(var m=0,x=f;m<x.length;m++){var y=x[m];if(y.target===d)return!0}return!1};r.applyTransformation(),r.onInitCallbacks.forEach(function(f){f(mr(r))}),r.observer=new ResizeObserver(function(f){if(u(f,n)||u(f,a))if(o&&!i){var d=a.offsetWidth,m=a.offsetHeight;(d>0||m>0)&&(i=!0,r.setCenter())}else vs(r),Lo(r,r.transformState.scale),dy(r,0)}),r.observer.observe(n),r.observer.observe(a)},this.onWheelZoom=function(n){var a=r.setup.disabled;if(!a){var i=hL(r,n);if(i){var o=r.isPressingKeys(r.setup.wheel.activationKeys);o&&(EL(r,n),TL(r,n),SL(r,n))}}},this.onWheelPanning=function(n){var a=r.setup,i=a.disabled,o=a.wheel,u=a.panning;if(!(!r.wrapperComponent||!r.contentComponent||i||!o.wheelDisabled||u.disabled||!u.wheelPanning||n.ctrlKey)){n.preventDefault(),n.stopPropagation();var f=r.transformState,d=f.positionX,m=f.positionY,x=d-n.deltaX,y=m-n.deltaY,b=u.lockAxisX?d:x,E=u.lockAxisY?m:y,w=r.setup.alignmentAnimation,T=w.sizeX,R=w.sizeY,I=Xl(r,T),C=Xl(r,R);b===d&&E===m||Hk(r,b,E,I,C)}},this.onPanningStart=function(n){var a=r.setup.disabled,i=r.props.onPanningStart;if(!a){var o=yT(r,n);if(o){var u=r.isPressingKeys(r.setup.panning.activationKeys);u&&(n.button===0&&!r.setup.panning.allowLeftClickPan||n.button===1&&!r.setup.panning.allowMiddleClickPan||n.button===2&&!r.setup.panning.allowRightClickPan||(n.preventDefault(),n.stopPropagation(),vs(r),bT(r,n),Ar(mr(r),n,i)))}}},this.onPanning=function(n){var a=r.setup.disabled,i=r.props.onPanning;if(!a){var o=_T(r);if(o){var u=r.isPressingKeys(r.setup.panning.activationKeys);u&&(n.preventDefault(),n.stopPropagation(),ET(r,n.clientX,n.clientY),Ar(mr(r),n,i))}}},this.onPanningStop=function(n){var a=r.props.onPanningStop;r.isPanning&&(eL(r),Ar(mr(r),n,a))},this.onPinchStart=function(n){var a=r.setup.disabled,i=r.props,o=i.onPinchingStart,u=i.onZoomStart;if(!a){var f=xL(r,n);f&&(AL(r,n),vs(r),Ar(mr(r),n,o),Ar(mr(r),n,u))}},this.onPinch=function(n){var a=r.setup.disabled,i=r.props,o=i.onPinching,u=i.onZoom;if(!a){var f=vL(r);f&&(n.preventDefault(),n.stopPropagation(),kL(r,n),Ar(mr(r),n,o),Ar(mr(r),n,u))}},this.onPinchStop=function(n){var a=r.props,i=a.onPinchingStop,o=a.onZoomStop;r.pinchStartScale&&(CL(r),Ar(mr(r),n,i),Ar(mr(r),n,o))},this.onTouchPanningStart=function(n){var a=r.setup.disabled,i=r.props.onPanningStart;if(!a){var o=yT(r,n);if(o){var u=r.lastTouch&&+new Date-r.lastTouch<200&&n.touches.length===1;if(!u){r.lastTouch=+new Date,vs(r);var f=n.touches,d=f.length===1,m=f.length===2;d&&(vs(r),bT(r,n),Ar(mr(r),n,i)),m&&r.onPinchStart(n)}}}},this.onTouchPanning=function(n){var a=r.setup.disabled,i=r.props.onPanning;if(r.isPanning&&n.touches.length===1){if(a)return;var o=_T(r);if(!o)return;n.preventDefault(),n.stopPropagation();var u=n.touches[0];ET(r,u.clientX,u.clientY),Ar(mr(r),n,i)}else n.touches.length>1&&r.onPinch(n)},this.onTouchPanningStop=function(n){r.onPanningStop(n),r.onPinchStop(n)},this.onDoubleClick=function(n){var a=r.setup.disabled;if(!a){var i=DL(r,n);i&&IL(r,n)}},this.clearPanning=function(n){r.isPanning&&r.onPanningStop(n)},this.setKeyPressed=function(n){r.pressedKeys[n.key]=!0},this.setKeyUnPressed=function(n){r.pressedKeys[n.key]=!1},this.isPressingKeys=function(n){return n.length?!!n.find(function(a){return r.pressedKeys[a]}):!0},this.setTransformState=function(n,a,i){var o=r.props.onTransformed;if(!Number.isNaN(n)&&!Number.isNaN(a)&&!Number.isNaN(i)){n!==r.transformState.scale&&(r.transformState.previousScale=r.transformState.scale,r.transformState.scale=n),r.transformState.positionX=a,r.transformState.positionY=i,r.applyTransformation();var u=mr(r);r.onChangeCallbacks.forEach(function(f){return f(u)}),Ar(u,{scale:n,positionX:a,positionY:i},o)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(r.wrapperComponent&&r.contentComponent){var n=$k(r.transformState.scale,r.wrapperComponent,r.contentComponent);r.setTransformState(n.scale,n.positionX,n.positionY)}},this.handleTransformStyles=function(n,a,i){return r.props.customTransform?r.props.customTransform(n,a,i):uL(n,a,i)},this.applyTransformation=function(){if(!(!r.mounted||!r.contentComponent)){var n=r.transformState,a=n.scale,i=n.positionX,o=n.positionY,u=r.handleTransformStyles(i,o,a);r.contentComponent.style.transform=u}},this.getContext=function(){return mr(r)},this.onChange=function(n){return r.onChangeCallbacks.has(n)||r.onChangeCallbacks.add(n),function(){r.onChangeCallbacks.delete(n)}},this.onInit=function(n){return r.onInitCallbacks.has(n)||r.onInitCallbacks.add(n),function(){r.onInitCallbacks.delete(n)}},this.init=function(n,a){r.cleanupWindowEvents(),r.wrapperComponent=n,r.contentComponent=a,Lo(r,r.transformState.scale),r.handleInitializeWrapperEvents(n),r.handleInitialize(n,a),r.initializeWindowEvents(),r.isInitialized=!0;var i=mr(r);Ar(i,void 0,r.props.onInit)},this.props=e,this.setup=ST(this.props),this.transformState=qk(this.props)}return t})(),py=Bl.createContext(null),FL=function(t,e){return typeof t=="function"?t(e):t},ML=Bl.forwardRef(function(t,e){var r=re.useRef(new OL(t)).current,n=FL(t.children,qx(r));return re.useImperativeHandle(e,function(){return qx(r)},[r]),re.useEffect(function(){r.update(t)},[r,t]),Bl.createElement(py.Provider,{value:r},n)});Bl.forwardRef(function(t,e){var r=re.useRef(null),n=re.useContext(py);return re.useEffect(function(){return n.onChange(function(a){if(r.current){var i=0,o=0;r.current.style.transform=n.handleTransformStyles(i,o,1/a.instance.transformState.scale)}})},[n]),Bl.createElement("div",Ll({},t,{ref:fL([r,e])}))});function PL(t,e){e===void 0&&(e={});var r=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}var jL=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,AT={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};PL(jL);var LL=function(t){var e=t.children,r=t.wrapperClass,n=r===void 0?"":r,a=t.contentClass,i=a===void 0?"":a,o=t.wrapperStyle,u=t.contentStyle,f=t.wrapperProps,d=f===void 0?{}:f,m=t.contentProps,x=m===void 0?{}:m,y=re.useContext(py),b=y.init,E=y.cleanupWindowEvents,w=re.useRef(null),T=re.useRef(null);return re.useEffect(function(){var R=w.current,I=T.current;return R!==null&&I!==null&&b&&b?.(R,I),function(){E?.()}},[]),Bl.createElement("div",Ll({},d,{ref:w,className:"".concat(Gx.wrapperClass," ").concat(AT.wrapper," ").concat(n),style:o}),Bl.createElement("div",Ll({},x,{ref:T,className:"".concat(Gx.contentClass," ").concat(AT.content," ").concat(i),style:u}),e))};const ua=({isOpen:t,onClose:e,title:r,children:n})=>(re.useEffect(()=>{const a=i=>{i.key==="Escape"&&e()};return t&&window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t,e]),t?p.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/90 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:p.jsxs("div",{className:`\r
            bg-white w-full max-w-lg rounded-lg overflow-hidden relative \r
            border-4 border-slate-900 \r
            shadow-[8px_8px_0px_0px_#FACC15] \r
            animate-in zoom-in-95 duration-300\r
        `,onClick:a=>a.stopPropagation(),children:[p.jsxs("div",{className:"bg-slate-900 p-4 border-b-4 border-slate-900 flex justify-between items-center relative overflow-hidden",children:[p.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-slate-800 rotate-45 transform translate-x-10 -translate-y-10"}),p.jsxs("div",{className:"flex items-center gap-2 relative z-10",children:[p.jsx(Om,{className:"text-yellow-400 fill-yellow-400",size:24}),p.jsx("h3",{className:"text-xl font-black italic tracking-wider text-yellow-400 uppercase transform -skew-x-6",children:r})]}),p.jsx("button",{onClick:e,className:`\r
                    relative z-10 \r
                    bg-red-600 hover:bg-red-700 text-white \r
                    p-1.5 rounded border-2 border-white \r
                    transition-transform hover:scale-110 active:scale-95\r
                    shadow-lg\r
                `,children:p.jsx(ha,{size:20,strokeWidth:3})})]}),p.jsx("div",{className:"p-6 max-h-[80vh] overflow-y-auto bg-white",children:n}),p.jsxs("div",{className:"h-2 bg-yellow-400 border-t-2 border-slate-900 flex",children:[p.jsx("div",{className:"w-1/3 bg-red-600 border-r-2 border-slate-900"}),p.jsx("div",{className:"w-1/3 bg-white border-r-2 border-slate-900"}),p.jsx("div",{className:"w-1/3 bg-blue-600"})]})]})}):null);function eC({currentUser:t,onSubmit:e,onCancel:r}){const[n,a]=re.useState(t?.name||""),i=o=>{if(o.preventDefault(),!n.trim())return alert("");if(n.trim()===t?.name)return alert("");e(n)};return p.jsxs("form",{onSubmit:i,className:"space-y-4 font-sans text-slate-800",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-black text-slate-700 mb-1",children:" (Nickname)"}),p.jsxs("div",{className:"relative",children:[p.jsx(Ko,{size:16,className:"absolute left-3 top-3 text-slate-400"}),p.jsx("input",{type:"text",value:n,onChange:o=>a(o.target.value),className:"w-full border-2 border-slate-900 rounded p-2 pl-9 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 text-slate-900",placeholder:"",autoFocus:!0})]}),p.jsx("p",{className:"text-xs text-slate-400 mt-1 pl-1",children:"* "})]}),p.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-slate-100",children:[p.jsxs("button",{type:"button",onClick:r,className:"px-4 py-2 rounded border-2 border-slate-300 text-slate-600 font-bold hover:bg-slate-100 transition-all",children:[p.jsx(ha,{size:16,className:"inline mr-1"})," "]}),p.jsxs("button",{type:"submit",className:"px-4 py-2 bg-slate-900 text-yellow-400 rounded font-black border-2 border-slate-900 hover:bg-slate-800 shadow-[2px_2px_0px_0px_#FACC15] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(ic,{size:16,className:"inline mr-1"})," "]})]})]})}const BL=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=500,u=500;let f=a.width,d=a.height;f>d?f>o&&(d*=o/f,f=o):d>u&&(f*=u/d,d=u),i.width=f,i.height=d,i.getContext("2d").drawImage(a,0,0,f,d),e(i.toDataURL("image/jpeg",.7))}}});function tC({currentUser:t,onSubmit:e}){const[r,n]=re.useState(t?.avatar||""),[a,i]=re.useState(null),o=async f=>{f.target.files&&f.target.files[0]&&i(await BL(f.target.files[0]))},u=()=>{const f=a||r;f&&e(f)};return p.jsxs("div",{className:"space-y-6",children:[p.jsx("div",{className:"flex justify-center mb-4",children:p.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden border-4 border-orange-100 shadow-md",children:p.jsx("img",{src:a||r||t?.avatar,className:"w-full h-full object-cover",alt:"avatar",onError:f=>f.target.src=`https://api.dicebear.com/7.x/avataaars/svg?seed=${t?.name}&backgroundColor=ffdfbf`})})}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-stone-600 text-sm font-bold flex items-center gap-2",children:[p.jsx(Z0,{size:16})," "]}),p.jsx("input",{type:"text",className:"border border-stone-200 rounded-lg px-3 py-2 text-sm",placeholder:"",value:r,onChange:f=>{n(f.target.value),i(null)}})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-0 flex items-center",children:p.jsx("span",{className:"w-full border-t border-stone-200"})}),p.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:p.jsx("span",{className:"bg-white px-2 text-stone-400",children:""})})]}),p.jsxs("div",{className:"flex flex-col gap-2",children:[p.jsxs("label",{className:"text-stone-600 text-sm font-bold flex items-center gap-2",children:[p.jsx(uy,{size:16})," "]}),p.jsx("input",{type:"file",accept:"image/*",onChange:o,className:"block w-full text-sm text-stone-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-bold file:bg-orange-50 file:text-orange-600 hover:file:bg-orange-100 cursor-pointer"})]})]}),p.jsx("button",{className:"w-full py-2 bg-orange-400 text-white rounded-lg font-bold hover:bg-orange-500",onClick:u,children:""})]})}function rC({onSubmit:t}){const[e,r]=re.useState("");return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsx("label",{className:"text-stone-600 text-sm font-bold tracking-wide",children:""}),p.jsx("input",{type:"password",className:"border border-stone-200 rounded-lg px-3 py-2",placeholder:"",value:e,onChange:n=>r(n.target.value)})]}),p.jsx("button",{className:"w-full py-2 bg-orange-400 text-white rounded-lg font-bold hover:bg-orange-500 disabled:opacity-50",onClick:()=>t(e),disabled:!e,children:""})]})}const VL=["https://pbs.twimg.com/media/G8MiWocaEAAYWbC?format=jpg&name=large","https://pbs.twimg.com/media/G8MiYLNbIAA_YJg?format=jpg&name=large","https://pbs.twimg.com/media/G8MiZktakAAvzHC?format=jpg&name=large","https://pbs.twimg.com/media/G8Mis25acAAqfys?format=jpg&name=large","https://pbs.twimg.com/media/G8MivlbakAA4A73?format=jpg&name=large","https://pbs.twimg.com/media/G8MixoiaAAAyEGE?format=jpg&name=large","https://pbs.twimg.com/media/G8Mi4L9b0AAPNmS?format=jpg&name=large","https://pbs.twimg.com/media/G8Mi6X_bwAAkrMd?format=jpg&name=large","https://pbs.twimg.com/media/G8MjC5vbgAE_hJg?format=jpg&name=large","https://pbs.twimg.com/media/G8MjIZ0bwAAEAhT?format=jpg&name=large"];function UL({currentUser:t,onImageClick:e}){const[r,n]=re.useState([]),[a,i]=re.useState({exchangeRate:.24,totalShippingJPY:0,status:""}),[o,u]=re.useState(!0);re.useEffect(()=>{u(!0);const x=St($e,"artifacts","default-app-id","public","data","jf26_calc_data","main"),y=Un(x,b=>{if(b.exists()){const E=b.data(),T=(E.orders||[]).sort((R,I)=>{const C=R.buyer.localeCompare(I.buyer);return C!==0?C:R.id-I.id});n(T),i(E.settings||{exchangeRate:.24,totalShippingJPY:0,status:""})}u(!1)});return()=>y()},[]);const f=re.useMemo(()=>r.reduce((x,y)=>y.isBought?x+y.quantity:x,0),[r]),d=re.useMemo(()=>f>0?a.totalShippingJPY/f:0,[f,a.totalShippingJPY]),m=re.useMemo(()=>{const x={};return r.forEach(y=>{if(x[y.buyer]||(x[y.buyer]={items:[],totalItemPriceJPY:0,totalShippingShareJPY:0,count:0}),y.isBought){const b=y.price*y.quantity,E=d*y.quantity;x[y.buyer].items.push(y),x[y.buyer].totalItemPriceJPY+=b,x[y.buyer].totalShippingShareJPY+=E,x[y.buyer].count+=y.quantity}}),x},[r,d]);return o?p.jsx("div",{className:"p-10 text-center font-bold text-slate-500",children:"..."}):p.jsxs("div",{className:"space-y-8 pb-20",children:[p.jsx("div",{className:"bg-slate-900 text-yellow-400 p-6 rounded-xl border-4 border-yellow-400 shadow-[8px_8px_0px_0px_#0f172a] relative overflow-hidden",children:p.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-3xl font-black italic mb-2",children:"JS ONLINE "}),p.jsxs("div",{className:"space-y-1 font-bold text-white text-sm",children:[p.jsxs("p",{className:"flex items-center gap-2",children:[p.jsx(Ck,{size:16,className:"text-yellow-400"})," 12/17 11:00  12/21 16:00"]}),p.jsxs("a",{href:"https://jumpshop-online.com/collections/jf2026",target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 underline hover:text-yellow-300",children:[p.jsx(zs,{size:16})," "]})]})]}),p.jsx("div",{className:"bg-white p-4 rounded-lg border-4 border-slate-700 text-slate-900 w-full md:w-auto shadow-lg",children:p.jsxs("div",{className:"flex flex-col gap-3",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"font-black text-xs uppercase bg-slate-200 px-1 rounded",children:"STATUS"}),p.jsx("span",{className:"font-black text-purple-600",children:a.status})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-black text-slate-500 block",children:" (JPYTWD)"}),p.jsxs("div",{className:"flex items-center font-black",children:[p.jsx(ly,{size:14,className:"text-slate-400"}),p.jsx("span",{children:a.exchangeRate})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-black text-slate-500 block",children:" (JPY)"}),p.jsxs("div",{className:"flex items-center font-black",children:[p.jsx(th,{size:14,className:"text-slate-400"}),p.jsx("span",{children:a.totalShippingJPY})]})]})]})]})})]})}),p.jsxs("div",{className:"bg-white p-4 rounded-xl border-2 border-slate-200",children:[p.jsxs("h4",{className:"font-black text-sm text-slate-500 mb-3 flex items-center gap-2",children:[p.jsx(sy,{size:16}),"  ()"]}),p.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:VL.map((x,y)=>p.jsx("div",{onClick:()=>e(x),className:"w-20 h-20 shrink-0 bg-white rounded border border-slate-300 overflow-hidden hover:scale-105 transition-transform cursor-pointer relative group",children:p.jsx("img",{src:x,alt:`Item ${y}`,className:"w-full h-full object-cover"})},y))})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(m).map(([x,y])=>{const b=y.totalItemPriceJPY+y.totalShippingShareJPY,E=Math.ceil(b*a.exchangeRate);return p.jsxs("div",{className:"bg-white rounded-xl border-4 border-slate-900 p-5 shadow-[4px_4px_0px_0px_#6b21a8] relative overflow-hidden group hover:-translate-y-1 transition-transform",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4 border-b-2 border-slate-100 pb-2",children:[p.jsx("h3",{className:"text-2xl font-black italic text-slate-900",children:x}),p.jsxs("div",{className:"text-right",children:[p.jsx("p",{className:"text-xs font-bold text-slate-400",children:"TOTAL"}),p.jsxs("span",{className:"text-3xl font-black text-purple-600",children:["NT$ ",E]})]})]}),p.jsxs("div",{className:"space-y-2 text-sm font-bold text-slate-600",children:[p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{children:[" (",y.count,")"]}),p.jsxs("span",{children:["",y.totalItemPriceJPY.toLocaleString()]})]}),p.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[p.jsxs("span",{children:[" (",d.toFixed(0),")"]}),p.jsxs("span",{children:["",y.totalShippingShareJPY.toFixed(0)]})]}),p.jsxs("div",{className:"flex justify-between border-t border-slate-200 pt-1 text-slate-800 font-black",children:[p.jsx("span",{children:" (JPY)"}),p.jsxs("span",{children:["",Math.ceil(b).toLocaleString()]})]})]}),p.jsx("div",{className:"mt-4 pt-4 border-t-2 border-dashed border-slate-300",children:p.jsxs("details",{className:"group/detail",children:[p.jsxs("summary",{className:"text-xs font-black text-slate-500 cursor-pointer hover:text-slate-900 list-none flex justify-between items-center",children:[p.jsx("span",{children:""}),p.jsx(Sk,{size:12,className:"group-open/detail:rotate-180 transition-transform"})]}),p.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-y-auto pr-1",children:y.items.map((w,T)=>p.jsxs("div",{className:"flex justify-between text-xs font-medium text-slate-600 bg-slate-50 p-1.5 rounded",children:[p.jsxs("span",{className:"truncate w-2/3",children:[w.ip," ",w.name," x",w.quantity]}),p.jsxs("span",{children:["",w.price*w.quantity]})]},T))})]})})]},x)})})]})}const zL={titi:"",xiaomei:"",heng:"",baobao:"",yeye:"",Sjie:"S",qiaoyu:"",teacher:"",ann:"",Aurora:"Aurora"};function HL({currentUser:t}){const[e,r]=re.useState("vendors"),[n,a]=re.useState(!1),[i,o]=re.useState(null),[u,f]=re.useState(null),[d,m]=re.useState(0),x=t?.id==="yeye",y=t?.isMember;re.useEffect(()=>{if(!t?.id)return;const I=zL[t.id]||t.name;let C=0,W=0;const U=Un(St($e,"artifacts","default-app-id","public","data","jf26_calc_data","main"),A=>{if(A.exists()){const D=A.data(),N=D.orders||[],M=D.settings||{exchangeRate:.24,totalShippingJPY:0},F=N.reduce((we,ie)=>ie.isBought?we+ie.quantity:we,0),P=F>0?M.totalShippingJPY/F:0,Ee=N.filter(we=>we.buyer===I&&we.isBought).reduce((we,ie)=>we+ie.price*ie.quantity+P*ie.quantity,0);C=Math.ceil(Ee*M.exchangeRate)}else C=0;m(C+W)}),B=Un(ar($e,"artifacts","default-app-id","public","data","jf26_jcs_orders"),A=>{W=0,m(C+W)});return()=>{U(),B()}},[t]);const b=()=>{localStorage.removeItem("app_user_id"),window.location.reload()},E=async I=>{if(t)try{await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{name:I}),alert(""),o(null)}catch(C){console.error("",C),alert("")}},w=async I=>{t&&(await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{avatar:I}),alert(""),o(null))},T=async I=>{t&&(await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{password:I}),alert(""),o(null))},R=async()=>{if(t)if(t.isMember){if(t.memberValidUntil)confirm(`
`)&&(await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{memberValidUntil:null,memberCancelledAt:null}),alert(""));else if(confirm(`
 30 `)){const I=new Date;I.setDate(I.getDate()+30),await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberValidUntil:I.toISOString(),memberCancelledAt:new Date().toISOString()}),alert(`
 ${I.toLocaleDateString()}`)}}else confirm(` PLUS ULTRA 
`)&&(await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberSince:new Date().toISOString(),memberValidUntil:null,memberCancelledAt:null}),alert(""))};return p.jsxs("div",{className:"min-h-screen bg-slate-50 font-sans pb-20 selection:bg-yellow-400 selection:text-black",children:[p.jsx("header",{className:"sticky top-0 z-30 bg-slate-900 border-b-4 border-yellow-400 px-4 py-3 shadow-md",children:p.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-0",children:[p.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[p.jsxs(P0,{to:"/home",className:"flex items-center gap-2 bg-yellow-400 px-4 py-1.5 rounded transform -skew-x-12 border-2 border-yellow-600 hover:scale-105 transition-transform group",children:[p.jsx(Ak,{size:20,className:"text-slate-900 transform skew-x-12 group-hover:-translate-x-1 transition-transform",strokeWidth:3}),p.jsx("span",{className:"text-slate-900 font-black text-sm transform skew-x-12 hidden",children:""})]}),p.jsx("h1",{className:"text-2xl font-black italic tracking-tight text-white",children:"JF26 "})]}),p.jsxs("div",{className:"flex items-center justify-end gap-2 sm:gap-4 w-full sm:w-auto",children:[t&&p.jsx(GL,{amount:d}),p.jsxs("div",{className:"text-right hidden sm:block",children:[p.jsx("p",{className:"text-xs text-slate-400",children:"HERO NAME"}),p.jsx("p",{className:"font-bold text-white tracking-wide",children:t?.name})]}),p.jsxs("div",{className:"relative",children:[p.jsxs("button",{onClick:()=>a(!n),className:`w-10 h-10 rounded-full bg-slate-800 border-2 ${y?"border-purple-500":"border-yellow-400"} shadow-lg overflow-hidden hover:scale-105 transition-all relative`,children:[p.jsx("img",{src:t?.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${t?.name}`,alt:"avatar",className:"w-full h-full object-cover"}),y&&p.jsx("div",{className:"absolute -top-1 -right-1 bg-purple-600 rounded-full p-0.5 border border-white",children:p.jsx(Rm,{size:8,className:"text-white fill-white"})})]}),n&&p.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-xl border-2 border-slate-900 py-1 z-50 animate-in fade-in slide-in-from-top-2",children:[p.jsxs("div",{className:"px-3 py-2 border-b-2 border-slate-100 bg-slate-50",children:[p.jsxs("div",{className:"flex justify-between items-center mb-1",children:[p.jsxs("span",{className:"text-xs font-black text-slate-500 flex items-center gap-1",children:[p.jsx(Rm,{size:12,className:y?"text-purple-600 fill-purple-600":"text-slate-300"}),"PLUS "]}),y&&p.jsx("span",{className:"text-[10px] bg-purple-100 text-purple-700 px-1.5 rounded font-bold",children:"SUBSCRIBED"})]}),p.jsx("button",{onClick:R,className:`w-full text-xs font-bold py-1.5 rounded border-2 transition-all ${y&&t.memberValidUntil?"bg-green-100 text-green-700 border-green-300 hover:bg-green-200":y?"bg-white border-slate-300 text-slate-500 hover:bg-red-50 hover:text-red-500 hover:border-red-300":"bg-purple-600 border-purple-800 text-white hover:bg-purple-700"}`,children:y?t.memberValidUntil?" ()":" (30)":" (NT$90/)"})]}),p.jsxs("button",{onClick:()=>{a(!1),o("changeName")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(Ko,{size:16})," "]}),p.jsxs("button",{onClick:()=>{a(!1),o("changeAvatar")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(sy,{size:16})," "]}),p.jsxs("button",{onClick:()=>{a(!1),o("changePwd")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(Ik,{size:16})," "]}),p.jsx("div",{className:"border-t-2 border-slate-100 my-1"}),p.jsxs("button",{onClick:b,className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2 font-black",children:[p.jsx(Dk,{size:16})," "]})]})]})]})]})}),p.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[p.jsxs("div",{className:"text-center mb-8 relative",children:[p.jsxs("div",{className:"inline-block relative",children:[p.jsx("h2",{className:"text-5xl font-black text-slate-900 italic transform -skew-x-6 z-10 relative",children:"JUMP FESTA 2026"}),p.jsx("div",{className:"absolute -bottom-2 -right-4 w-[110%] h-6 bg-yellow-400 -z-0 transform -skew-x-6"})]}),p.jsxs("p",{className:"text-slate-500 font-bold mt-4 flex items-center justify-center gap-2",children:[p.jsx(xT,{size:18,className:"text-slate-900"})," ..."]}),p.jsxs("div",{className:"flex justify-center gap-3 text-sm font-black mt-6 flex-wrap",children:[p.jsxs("a",{href:"https://www.jumpfesta.com/maker/",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JF26  ",p.jsx(zs,{size:14})]}),p.jsxs("a",{href:"https://jumpcs.shueisha.co.jp/shop/pages/jumpfesta.aspx",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JCS ",p.jsx(zs,{size:14})]}),p.jsxs("a",{href:"https://docs.google.com/spreadsheets/d/1zfT-MMN-DwIRamibiAQUyp4lJLGBoxS3Rpeb1aVJLK8/edit?usp=sharing",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JF26  ",p.jsx(zs,{size:14})]}),p.jsxs("a",{href:"https://forms.gle/VsHvAvraVQp4dHaK8",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-yellow-400 border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JF26  ",p.jsx(zs,{size:14})]})]})]}),p.jsx("nav",{className:"max-w-md mx-auto mb-8 px-4",children:p.jsx("div",{className:"bg-white p-1 rounded-lg shadow-sm border-2 border-slate-200 flex justify-around gap-1",children:[{id:"vendors",label:"",icon:xT},{id:"js_pre",label:"JS  (Online)",icon:_p},{id:"jcs_lottery",label:"JCS ",icon:jk}].map(I=>{const C=I.icon,W=e===I.id;return p.jsxs("button",{onClick:()=>r(I.id),className:`
                                        flex-1 flex flex-col items-center justify-center gap-1 py-2 px-0.5 sm:px-4 rounded font-black transition-all border-2 
                                        ${W?"bg-slate-900 border-slate-900 text-yellow-400 shadow-md transform -translate-y-1":"bg-transparent border-transparent text-slate-500 hover:bg-slate-100 hover:text-slate-900"}
                                    `,children:[p.jsx(C,{size:20,className:W?"animate-pulse":""}),p.jsx("span",{className:"text-[11px] sm:text-sm whitespace-nowrap",children:I.label})]},I.id)})})}),p.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e==="vendors"&&p.jsx(qL,{currentUser:t,isAdmin:x}),e==="js_pre"&&p.jsx(UL,{currentUser:t,isAdmin:x,onImageClick:f}),e==="jcs_lottery"&&p.jsx(XL,{currentUser:t,isAdmin:x})]})]}),p.jsx(ua,{isOpen:i==="changeName",onClose:()=>o(null),title:"",children:p.jsx(eC,{currentUser:t,onSubmit:E,onCancel:()=>o(null)})}),p.jsx(ua,{isOpen:i==="changePwd",onClose:()=>o(null),title:"",children:p.jsx(rC,{onSubmit:T})}),p.jsx(ua,{isOpen:i==="changeAvatar",onClose:()=>o(null),title:"",children:p.jsx(tC,{currentUser:t,onSubmit:w})}),u&&p.jsx("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-0 animate-in fade-in duration-200",children:p.jsx(ML,{initialScale:1,minScale:.5,maxScale:4,centerOnInit:!0,children:({zoomIn:I,zoomOut:C,resetTransform:W})=>p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"absolute top-4 right-4 z-[110] flex items-center gap-2 bg-slate-900/80 p-2 rounded-full backdrop-blur border border-slate-700 shadow-xl",children:[p.jsx("button",{onClick:()=>I(),className:"p-2 text-white hover:text-yellow-400 hover:bg-white/10 rounded-full",children:p.jsx(yj,{size:20})}),p.jsx("button",{onClick:()=>C(),className:"p-2 text-white hover:text-yellow-400 hover:bg-white/10 rounded-full",children:p.jsx(wj,{size:20})}),p.jsx("button",{onClick:()=>W(),className:"p-2 text-white hover:text-yellow-400 hover:bg-white/10 rounded-full",children:p.jsx(BP,{size:20})}),p.jsx("div",{className:"w-px h-6 bg-slate-600 mx-1"}),p.jsx("button",{onClick:()=>f(null),className:"p-2 text-white hover:text-red-400 hover:bg-white/10 rounded-full",children:p.jsx(ha,{size:20})})]}),p.jsx(LL,{wrapperClass:"!w-screen !h-screen",contentClass:"!w-screen !h-screen flex items-center justify-center",children:p.jsx("img",{src:u,alt:"Full Preview",className:"max-w-full max-h-full object-contain"})})]})})})]})}function GL({amount:t}){const e=" JF26 ";return p.jsxs("div",{className:`\r
            relative group border-r border-slate-700 mr-1 pr-2 sm:mr-2 sm:pr-4\r
            flex w-full items-center justify-end gap-3   /*  */\r
            sm:w-auto sm:flex-col sm:items-end sm:gap-0  /*  */\r
        `,children:[p.jsxs("button",{type:"button",onClick:()=>alert(e),className:`\r
                    focus:outline-none group/btn\r
                    flex items-center gap-2              /*  */\r
                    sm:mb-1 sm:gap-1.5\r
                `,children:[p.jsx("span",{className:"text-[16px] sm:text-base text-slate-400 font-bold whitespace-nowrap pt-0.5",children:""}),p.jsxs("span",{className:"text-[10px] text-yellow-500 group-hover/btn:text-yellow-400 border-b border-dashed border-yellow-500/50 flex items-center gap-0.5 transition-colors",children:[p.jsx("span",{className:"hidden sm:inline",children:"?"}),p.jsx(Nm,{className:"block sm:hidden",size:14}),p.jsx(Nm,{className:"hidden sm:block",size:10})]})]}),p.jsxs("div",{className:"text-yellow-400 font-black drop-shadow-sm text-right flex items-center",children:[p.jsx("span",{className:"text-xs mr-1 text-yellow-200 mt-1",children:"NT$"}),p.jsx("span",{className:"text-xl sm:text-xl font-mono",children:t.toLocaleString()})]}),p.jsx("div",{className:"absolute top-12 right-0 w-max bg-slate-800 text-white text-xs p-2 rounded border border-yellow-400 shadow-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 hidden sm:block whitespace-pre-wrap text-left",children:e})]})}function qL({currentUser:t,isAdmin:e,modalType:r,setModalType:n}){const[a,i]=re.useState([]),[o,u]=re.useState(""),[f,d]=re.useState(null),[m,x]=re.useState(null),[y,b]=re.useState(0),E=[{name:"JS  (JUMP SHOP)",mainUrl:"https://jumpfesta.com/maker/",preOrder:{period:"2025/12/17 ~ 12/21",url:"https://jumpshop-online.com/collections/jf2026"},postOrder:{period:"",url:""},tags:[""],products:["Jump"],notes:"Jump Shop Online "}];re.useEffect(()=>{const U=Un(ar($e,"artifacts","default-app-id","public","data","jf26_vendors"),B=>{const A=B.docs.map(D=>({id:D.id,...D.data()}));i(A.sort((D,N)=>(D.order||0)-(N.order||0)))});return()=>U()},[]);const w=U=>{try{const B=U.updatedAt||U.createdAt;if(!B)return!1;const A=`vendor_${U.id}`;let D=t?.readHistory?.[A];if(!D&&t?.id)try{const N=`read_${t.id}_${A}`;D=localStorage.getItem(N)}catch(N){console.warn("LocalStorage access denied:",N)}return D?new Date(B)>new Date(D):!0}catch(B){return console.error("checkIsNew error:",B),!1}},T=async U=>{if(!t?.id)return;const B=new Date().toISOString(),A=`vendor_${U.id}`,D=`read_${t.id}_${A}`;try{try{localStorage.setItem(D,B),b(M=>M+1)}catch(M){console.warn("LocalStorage write failed:",M)}const N=St($e,"artifacts","default-app-id","public","data","users",t.id);await X0(N,{readHistory:{[A]:B}},{merge:!0})}catch(N){console.error("",N)}},R=async()=>{if(confirm(""))try{const U=Lx($e);E.forEach((B,A)=>{const D=St(ar($e,"artifacts","default-app-id","public","data","jf26_vendors"));U.set(D,{...B,order:A,updatedAt:new Date().toISOString()})}),await U.commit()}catch{alert("")}},I=async U=>{if(confirm(""))try{await bu(St($e,"artifacts","default-app-id","public","data","jf26_vendors",U))}catch(B){console.error("",B),alert("")}},C=a.filter(U=>(U.name||"").toLowerCase().includes(o.toLowerCase())||(Array.isArray(U.products)?U.products.some(B=>B.toLowerCase().includes(o.toLowerCase())):(U.products||U.ips||"").toLowerCase().includes(o.toLowerCase()))),W=U=>{switch(U){case"":return"bg-yellow-400 text-slate-900 border-slate-900";case"":return"bg-blue-500 text-white border-slate-900";case"":return"bg-red-600 text-white border-slate-900";default:return"bg-white text-slate-800 border-slate-900"}};return p.jsxs("div",{children:[e&&a.length===0&&p.jsx("div",{className:"flex justify-end mb-4",children:p.jsxs("button",{onClick:R,className:"px-4 py-1.5 bg-blue-100 text-blue-600 border border-blue-300 rounded hover:bg-blue-200 flex items-center gap-1 font-bold",children:[p.jsx(ZM,{size:12})," "]})}),p.jsxs("div",{className:"mb-10 flex flex-col md:flex-row items-center gap-4",children:[p.jsxs("div",{className:"flex-1 w-full h-12 rounded-xl border-4 border-slate-900 bg-white shadow-[4px_4px_0px_0px_#0f172a] transition-all focus-within:ring-4 focus-within:ring-yellow-400/50 overflow-hidden flex items-center",children:[p.jsx("div",{className:"pl-4 pr-2 flex items-center justify-center text-slate-900",children:p.jsx(Fk,{size:24,strokeWidth:3})}),p.jsx("input",{type:"text",placeholder:"  IP...",className:"w-full h-full bg-transparent border-none outline-none text-slate-900 font-bold placeholder:text-slate-400 placeholder:font-medium text-lg",value:o,onChange:U=>u(U.target.value)})]}),e&&p.jsxs("button",{onClick:()=>{d(null),n("vendor")},className:"w-full md:w-auto px-6 h-12 bg-slate-900 text-yellow-400 rounded-xl border-4 border-slate-900 font-black shadow-[4px_4px_0px_0px_#FACC15] hover:-translate-y-1 hover:shadow-[6px_6px_0px_0px_#FACC15] flex items-center justify-center gap-2 text-lg active:scale-[0.98] transition-all whitespace-nowrap",children:[p.jsx($o,{size:24,strokeWidth:3})," "]})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map((U,B)=>{const A=Array.isArray(U.products)?U.products:[],D=A.length>10,N=D?A.slice(0,10):A,M=w(U);return p.jsxs("div",{onClick:()=>T(U),className:"bg-white rounded-xl border-4 border-slate-900 p-5 shadow-[8px_8px_0px_0px_#FACC15] hover:-translate-y-1 hover:shadow-[10px_10px_0px_0px_#FACC15] transition-all duration-200 flex flex-col relative group cursor-pointer",children:[M&&p.jsx("div",{className:"absolute -top-3 -left-3 bg-red-600 text-white text-xs font-black px-2 py-1 shadow-md transform -rotate-12 z-20 border-2 border-white pointer-events-none animate-bounce",children:"NEW!"}),p.jsx("div",{className:"absolute top-3 right-3 w-3 h-3 rounded-full bg-slate-200 border-2 border-slate-900 z-10"}),p.jsxs("div",{className:"flex justify-between items-start mb-4 pr-4 border-b-2 border-slate-100 pb-2",children:[p.jsx("h3",{className:"font-black text-2xl text-slate-900 leading-tight italic",children:U.name}),e&&p.jsx("div",{className:"flex flex-col gap-1 ml-2 shrink-0",children:p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:F=>{F.stopPropagation(),d(U),n("vendor")},className:"p-1.5 bg-white text-slate-900 rounded border-2 border-slate-900 hover:bg-slate-100 shadow-[2px_2px_0px_0px_#000]",title:"",children:p.jsx(yp,{size:14,strokeWidth:2.5})}),p.jsx("button",{onClick:F=>{F.stopPropagation(),I(U.id)},className:"p-1.5 bg-red-500 text-white rounded border-2 border-slate-900 hover:bg-red-600 shadow-[2px_2px_0px_0px_#000]",title:"",children:p.jsx(eh,{size:14,strokeWidth:2.5})})]})})]}),U.tags&&U.tags.length>0&&p.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:U.tags.map(F=>p.jsx("span",{className:`text-[11px] font-black px-2 py-0.5 border-2 shadow-[2px_2px_0px_0px_rgba(0,0,0,0.1)] ${W(F)}`,children:F},F))}),p.jsxs("div",{className:"space-y-4 flex-1",children:[p.jsxs("div",{children:[p.jsxs("p",{className:"text-xs font-black text-slate-400 mb-2 flex items-center gap-1 uppercase tracking-wider",children:[p.jsx(Ko,{size:12}),"  (IPs)"]}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[N.map((F,P)=>p.jsx("span",{className:"bg-yellow-50 text-slate-900 text-xs font-bold px-2 py-1 border-2 border-slate-200 transition-transform hover:scale-105 hover:border-slate-900 hover:bg-yellow-200",children:F},P)),D&&p.jsxs("button",{onClick:F=>{F.stopPropagation(),x(U)},className:"bg-slate-800 text-white text-xs font-bold px-2 py-1 border-2 border-slate-900 hover:bg-slate-700 transition-colors cursor-pointer flex items-center gap-1",children:[p.jsx(yP,{size:12})," MORE..."]})]})]}),p.jsxs("div",{className:"space-y-2 bg-slate-50 p-3 rounded border-2 border-slate-200 relative",children:[U.preOrder?.period&&p.jsxs("div",{className:"text-sm",children:[p.jsx("span",{className:"text-[10px] font-black bg-yellow-400 text-slate-900 px-1 border border-slate-900 mr-2",children:""}),p.jsx("span",{className:"font-bold text-slate-700",children:U.preOrder.period})]}),U.postOrder?.period&&p.jsxs("div",{className:"text-sm",children:[p.jsx("span",{className:"text-[10px] font-black bg-blue-500 text-white px-1 border border-slate-900 mr-2",children:""}),p.jsx("span",{className:"font-bold text-slate-700",children:U.postOrder.period})]}),U.tags?.includes("")&&p.jsxs("div",{className:"text-sm flex items-center gap-2 text-red-600 font-black",children:[p.jsx(TP,{size:14}),"  JUMP FESTA "]})]}),U.notes&&p.jsxs("div",{className:"flex items-start gap-2 bg-red-50 p-2 rounded border-2 border-red-100",children:[p.jsx(VM,{size:14,className:"text-red-500 mt-0.5 shrink-0"}),p.jsx("p",{className:"text-xs font-bold text-red-600 leading-relaxed",children:U.notes})]})]}),p.jsxs("div",{className:"mt-6 space-y-3 pt-4 border-t-2 border-slate-100",children:[p.jsxs("div",{className:"flex gap-2",children:[U.preOrder?.url&&p.jsxs("a",{href:U.preOrder.url,target:"_blank",rel:"noreferrer",onClick:F=>F.stopPropagation(),className:"flex-1 py-2 bg-yellow-400 text-slate-900 text-center font-black rounded border-2 border-slate-900 hover:bg-yellow-300 transition-colors flex items-center justify-center gap-1 text-xs shadow-[3px_3px_0px_0px_#0f172a] active:translate-y-0.5 active:shadow-none",children:[p.jsx(_p,{size:14,strokeWidth:3})," "]}),U.postOrder?.url&&p.jsxs("a",{href:U.postOrder.url,target:"_blank",rel:"noreferrer",onClick:F=>F.stopPropagation(),className:"flex-1 py-2 bg-blue-500 text-white text-center font-black rounded border-2 border-slate-900 hover:bg-blue-400 transition-colors flex items-center justify-center gap-1 text-xs shadow-[3px_3px_0px_0px_#0f172a] active:translate-y-0.5 active:shadow-none",children:[p.jsx(th,{size:14,strokeWidth:3})," "]})]}),U.mainUrl&&p.jsxs("a",{href:U.mainUrl,target:"_blank",rel:"noreferrer",onClick:F=>F.stopPropagation(),className:"block w-full py-2 bg-slate-100 text-slate-700 text-center font-black rounded border-2 border-slate-900 hover:bg-slate-200 transition-colors flex items-center justify-center gap-2 text-sm",children:[p.jsx(zs,{size:16})," /"]})]})]},U.id)})}),p.jsx(ua,{isOpen:r==="vendor",onClose:()=>{n(null),d(null)},title:f?"EDIT VENDOR":"NEW VENDOR",children:p.jsx(WL,{initialData:f,onSubmit:async U=>{try{f?(await nn(St($e,"artifacts","default-app-id","public","data","jf26_vendors",f.id),{...U,updatedAt:new Date().toISOString()}),alert("")):(await Us(ar($e,"artifacts","default-app-id","public","data","jf26_vendors"),{...U,order:Date.now(),updatedAt:new Date().toISOString(),createdAt:new Date().toISOString()}),alert("")),n(null)}catch(B){console.error("",B),alert("")}},onCancel:()=>n(null)})}),m&&p.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:()=>x(null),children:p.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-2xl border-4 border-slate-900 overflow-hidden",onClick:U=>U.stopPropagation(),children:[p.jsxs("div",{className:"bg-slate-900 px-4 py-3 border-b-4 border-yellow-400 flex justify-between items-center",children:[p.jsxs("h3",{className:"font-black text-lg text-white flex items-center gap-2 truncate italic",children:[p.jsx(Ko,{size:20,className:"text-yellow-400"})," ",m.name]}),p.jsx("button",{onClick:()=>x(null),className:"text-slate-400 hover:text-white transition-colors",children:p.jsx(ha,{size:24})})]}),p.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto bg-slate-50",children:p.jsx("div",{className:"flex flex-wrap gap-2",children:(Array.isArray(m.products)?m.products:[]).map((U,B)=>p.jsx("span",{className:"bg-white text-slate-900 text-sm font-bold px-3 py-2 border-2 border-slate-900 shadow-[2px_2px_0px_0px_#ccc]",children:U},B))})})]})})]})}function WL({initialData:t,onSubmit:e,onCancel:r}){const[n,a]=re.useState({name:t?.name||"",mainUrl:t?.mainUrl||"",preOrder:{period:t?.preOrder?.period||"",url:t?.preOrder?.url||""},postOrder:{period:t?.postOrder?.period||"",url:t?.postOrder?.url||""},tags:t?.tags||[],products:t?.products||[],notes:t?.notes||""}),i=d=>{a(m=>{const x=m.tags.includes(d)?m.tags.filter(y=>y!==d):[...m.tags,d];return{...m,tags:x}})},o=d=>{const x=d.target.value.split(/[,]/).map(y=>y.trim()).filter(y=>y);a({...n,products:x})},u="w-full border-2 border-slate-300 rounded p-2 text-sm font-bold focus:border-slate-900 focus:ring-0 focus:shadow-[4px_4px_0px_0px_#FACC15] transition-all",f="block text-xs font-black text-slate-700 mb-1 uppercase tracking-wide";return p.jsxs("form",{onSubmit:d=>{d.preventDefault(),e(n)},className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:f,children:""}),p.jsx("input",{className:u,value:n.name,onChange:d=>a({...n,name:d.target.value}),required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:f,children:" (Main URL)"}),p.jsx("input",{className:u,value:n.mainUrl,onChange:d=>a({...n,mainUrl:d.target.value}),placeholder:"https://..."})]}),p.jsxs("div",{children:[p.jsx("label",{className:f,children:""}),p.jsx("div",{className:"flex gap-3",children:["","",""].map(d=>p.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded px-2 py-2 text-center text-xs font-black transition-all ${n.tags.includes(d)?"bg-slate-900 text-yellow-400 border-slate-900 shadow-[2px_2px_0px_0px_#FACC15] transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[p.jsx("input",{type:"checkbox",className:"hidden",checked:n.tags.includes(d),onChange:()=>i(d)}),n.tags.includes(d)&&p.jsx(J0,{size:10,className:"inline mr-1"}),d]},d))})]}),p.jsxs("div",{className:"bg-yellow-50 p-3 rounded border-2 border-yellow-200 space-y-2",children:[p.jsx("p",{className:f+" text-yellow-700 border-b border-yellow-200 pb-1",children:""}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),p.jsx("input",{className:u,value:n.preOrder.period,onChange:d=>a({...n,preOrder:{...n.preOrder,period:d.target.value}})})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),p.jsx("input",{className:u,value:n.preOrder.url,onChange:d=>a({...n,preOrder:{...n.preOrder,url:d.target.value}})})]})]}),p.jsxs("div",{className:"bg-blue-50 p-3 rounded border-2 border-blue-200 space-y-2",children:[p.jsx("p",{className:f+" text-blue-700 border-b border-blue-200 pb-1",children:""}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),p.jsx("input",{className:u,value:n.postOrder.period,onChange:d=>a({...n,postOrder:{...n.postOrder,period:d.target.value}})})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),p.jsx("input",{className:u,value:n.postOrder.url,onChange:d=>a({...n,postOrder:{...n.postOrder,url:d.target.value}})})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:f,children:" IP ()"}),p.jsx("textarea",{className:u+" h-20",defaultValue:n.products.join(", "),onChange:o,placeholder:"..."})]}),p.jsxs("div",{children:[p.jsx("label",{className:f,children:""}),p.jsx("input",{className:u,value:n.notes,onChange:d=>a({...n,notes:d.target.value})})]}),p.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t-2 border-slate-200 mt-2",children:[p.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded border-2 border-slate-300 font-black text-slate-500 hover:bg-slate-100 hover:text-slate-900",children:""}),p.jsx("button",{type:"submit",className:"px-6 py-2 rounded bg-slate-900 text-yellow-400 font-black border-2 border-slate-900 hover:bg-slate-800 shadow-[4px_4px_0px_0px_#FACC15] active:translate-y-0.5 active:shadow-none transition-all",children:" (SAVE)"})]})]})}function XL({currentUser:t,isAdmin:e}){const[r,n]=re.useState(Array.from({length:10},(u,f)=>({id:`order_${f+1}`,index:f+1}))),[a,i]=re.useState(null);re.useEffect(()=>{const u=Un(ar($e,"artifacts","default-app-id","public","data","jf26_jcs_orders"),f=>{const d={};f.docs.forEach(m=>{d[m.id]=m.data()}),n(m=>m.map(x=>({...x,...d[x.id]||{items:[]}})))});return()=>u()},[]);const o=u=>{switch(u){case"WON":return"bg-green-100 text-green-700 border-green-200";case"LOST":return"bg-slate-100 text-slate-400 border-slate-200 grayscale opacity-70";default:return"bg-white text-slate-900 border-slate-200"}};return p.jsxs("div",{children:[p.jsx("div",{className:"bg-slate-900 text-yellow-400 p-6 rounded-xl border-4 border-yellow-400 shadow-[8px_8px_0px_0px_#0f172a] relative overflow-hidden mb-10",children:p.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-3xl font-black italic mb-2",children:"JUMP CHARACTERS STORE "}),p.jsxs("div",{className:"space-y-1 font-bold text-white",children:[p.jsxs("p",{className:"flex items-center gap-2",children:[p.jsx(Ck,{size:18,className:"text-yellow-400"})," 12/17 11:00 ~ 12/21 16:00"]}),p.jsxs("a",{href:"https://jumpcs.shueisha.co.jp/shop/default.aspx",target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 underline hover:text-yellow-300",children:[p.jsx(zs,{size:18})," "]})]})]}),p.jsx("div",{className:"bg-yellow-400 text-slate-900 px-4 py-2 rounded font-black border-2 border-yellow-600 transform rotate-2",children:"(23)"})]})}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:r.map(u=>{const f=u.items&&u.items.length>0,d=f?u.items.reduce((m,x)=>m+Number(x.price)*Number(x.qty),0):0;return p.jsxs("div",{className:"bg-white rounded-xl border-4 border-slate-900 overflow-hidden shadow-[4px_4px_0px_0px_#6b21a8] hover:translate-y-[-2px] hover:shadow-[6px_6px_0px_0px_#6b21a8] transition-all",children:[p.jsxs("div",{className:"bg-slate-900 text-white px-4 py-3 flex justify-between items-center",children:[p.jsxs("h4",{className:"font-black italic text-lg flex items-center gap-2",children:[p.jsx(jk,{className:"text-purple-400",size:20})," ORDER #",u.index]}),e&&p.jsxs("button",{onClick:()=>i(u),className:"text-xs bg-slate-700 hover:bg-slate-600 px-2 py-1 rounded border border-slate-500 flex items-center gap-1",children:[p.jsx(yp,{size:12})," "]})]}),p.jsx("div",{className:"p-4 min-h-[150px]",children:f?p.jsxs("div",{className:"space-y-3",children:[u.items.map((m,x)=>p.jsxs("div",{className:`flex items-center justify-between p-2 rounded border-2 ${o(m.status)}`,children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("div",{className:"font-bold text-sm",children:m.name}),p.jsxs("div",{className:"text-xs opacity-80",children:["",m.price," x ",m.qty]})]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("div",{className:"font-mono font-black",children:["",m.price*m.qty]}),m.status==="WON"&&p.jsx(J0,{className:"text-green-600",size:18}),m.status==="LOST"&&p.jsx(XCircle,{className:"text-slate-400",size:18}),(!m.status||m.status==="PENDING")&&p.jsx(iy,{size:18,className:"text-slate-400"})]})]},x)),p.jsxs("div",{className:"border-t-2 border-slate-100 mt-2 pt-2 flex justify-between items-center font-black text-slate-900",children:[p.jsx("span",{children:"TOTAL"}),p.jsxs("span",{className:"text-lg",children:["",d.toLocaleString()]})]})]}):p.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-300 font-bold gap-2 py-8",children:[p.jsx(vp,{size:32}),p.jsx("span",{children:""})]})})]},u.id)})}),p.jsx(ua,{isOpen:!!a,onClose:()=>i(null),title:` #${a?.index}`,children:a&&p.jsx(YL,{initialData:a,onSubmit:async u=>{try{await X0(St($e,"artifacts","default-app-id","public","data","jf26_jcs_orders",a.id),u),i(null)}catch(f){console.error(f),alert("")}},onCancel:()=>i(null)})})]})}function YL({initialData:t,onSubmit:e,onCancel:r}){const[n,a]=re.useState(t.items||[]),i=()=>{a([...n,{name:"",qty:1,price:0,status:"PENDING"}])},o=(f,d,m)=>{const x=[...n];x[f][d]=m,a(x)},u=f=>{a(n.filter((d,m)=>m!==f))};return p.jsxs("form",{onSubmit:f=>{f.preventDefault(),e({items:n})},className:"space-y-4",children:[p.jsx("div",{className:"max-h-[50vh] overflow-y-auto space-y-4 p-1",children:n.map((f,d)=>p.jsxs("div",{className:"bg-slate-50 p-3 rounded border-2 border-slate-200 relative",children:[p.jsx("button",{type:"button",onClick:()=>u(d),className:"absolute top-1 right-1 text-slate-400 hover:text-red-500",children:p.jsx(ha,{size:16})}),p.jsxs("div",{className:"space-y-2 pr-6",children:[p.jsx("input",{className:"w-full text-sm font-bold border border-slate-300 rounded p-1",placeholder:"",value:f.name,onChange:m=>o(d,"name",m.target.value),required:!0}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{type:"number",className:"w-20 text-sm border border-slate-300 rounded p-1",placeholder:"",value:f.qty,onChange:m=>o(d,"qty",m.target.value)}),p.jsx("input",{type:"number",className:"flex-1 text-sm border border-slate-300 rounded p-1",placeholder:"()",value:f.price,onChange:m=>o(d,"price",m.target.value)})]}),p.jsx("div",{className:"flex gap-2 text-xs font-bold",children:["PENDING","WON","LOST"].map(m=>p.jsx("button",{type:"button",onClick:()=>o(d,"status",m),className:`flex-1 py-1 rounded border ${f.status===m?m==="WON"?"bg-green-500 text-white border-green-600":m==="LOST"?"bg-slate-500 text-white border-slate-600":"bg-yellow-400 text-black border-yellow-500":"bg-white text-slate-500 border-slate-200"}`,children:m==="WON"?"":m==="LOST"?"":""},m))})]})]},d))}),p.jsxs("button",{type:"button",onClick:i,className:"w-full py-2 bg-slate-100 text-slate-600 font-bold rounded border-2 border-dashed border-slate-300 hover:bg-slate-200 hover:border-slate-400 flex items-center justify-center gap-2",children:[p.jsx($o,{size:16})," "]}),p.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t-2 border-slate-100",children:[p.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded border font-bold",children:""}),p.jsx("button",{type:"submit",className:"px-6 py-2 rounded bg-slate-900 text-white font-bold",children:""})]})]})}function $L(){const[t,e]=re.useState(!1),[r,n]=re.useState(!0),a=re.useRef(null),i="4sNrzUoSLQY",o=`https://www.youtube.com/embed/${i}?autoplay=1&mute=1&loop=1&playlist=${i}&controls=1&enablejsapi=1`,u=()=>{if(!a.current)return;const f=r?"unMute":"mute";a.current.contentWindow.postMessage(JSON.stringify({event:"command",func:f,args:[]}),"*"),n(!r)};return p.jsx("div",{className:`
                fixed bottom-4 z-[9999] transition-all duration-300
                ${t?"left-4":"left-1/2 -translate-x-1/2 md:left-4 md:translate-x-0"}
                ${t?"w-12 h-12":"w-80"}
            `,children:p.jsxs("div",{className:"bg-slate-900 border-4 border-yellow-400 rounded-xl shadow-[4px_4px_0px_0px_#000] overflow-hidden flex flex-col h-full",children:[p.jsx("div",{style:{display:t?"none":"block",height:"180px"},children:p.jsx("iframe",{ref:a,width:"100%",height:"100%",src:o,title:"YouTube music player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})}),t?p.jsx("button",{onClick:()=>e(!1),className:"w-full h-full flex items-center justify-center text-yellow-400 hover:bg-slate-800 bg-slate-900",children:p.jsx(gT,{size:20,className:"animate-pulse"})}):p.jsxs("div",{className:"p-3 bg-slate-900",children:[p.jsxs("div",{className:"flex justify-between items-center mb-1",children:[p.jsxs("span",{className:"text-[10px] font-black text-yellow-400 flex items-center gap-1",children:[p.jsx(gT,{size:12})," BGM PLAYER"]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("button",{onClick:u,className:`hover:text-yellow-400 transition-colors ${r?"text-slate-400":"text-yellow-400"}`,title:r?"":"",children:r?p.jsx(dj,{size:16}):p.jsx(fj,{size:16})}),p.jsx("button",{onClick:()=>e(!0),className:"text-slate-400 hover:text-white",children:p.jsx(cy,{size:16})})]})]}),p.jsx("div",{className:"text-[10px] text-slate-400 text-center truncate px-1",children:r?" ":":   | "})]})]})})}const KL=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=800,u=800;let f=a.width,d=a.height;f>d?f>o&&(d*=o/f,f=o):d>u&&(f*=u/d,d=u),i.width=f,i.height=d,i.getContext("2d").drawImage(a,0,0,f,d),e(i.toDataURL("image/jpeg",.7))}}});function QL({onSubmit:t,onCancel:e,initialData:r=null}){const[n,a]=re.useState(r?.title||""),[i,o]=re.useState(()=>r?.images?.filter(I=>I.startsWith("http"))?.join(", ")||""),[u,f]=re.useState(r?.url||""),[d,m]=re.useState(r?.note||""),[x,y]=re.useState(()=>r?.images?.filter(I=>I.startsWith("data:"))||[]),b=async I=>{if(I.target.files){const B=5-(i.split(",").map(N=>N.trim()).filter(N=>N).length+x.length);if(B<=0){alert(" 5 "),I.target.value=null;return}const A=Array.from(I.target.files).slice(0,B),D=await Promise.all(A.map(N=>KL(N)));y(N=>[...N,...D]),I.target.value=null}},E=I=>{y(C=>C.filter((W,U)=>U!==I))},w=()=>{if(!n)return alert("");const C=[...i.split(",").map(W=>W.trim()).filter(W=>W),...x];t({title:n,images:C,url:u,note:d})},T=x.length+i.split(",").map(I=>I.trim()).filter(I=>I).length,R=!!r;return p.jsxs("form",{onSubmit:I=>{I.preventDefault(),w()},className:"flex flex-col gap-4 text-slate-800",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(pT,{size:16}),"  ()"]}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",placeholder:" ",value:n,onChange:I=>a(I.target.value),required:!0})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(Z0,{size:16}),"  ()"]}),p.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 text-sm h-16 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",placeholder:"",value:i,onChange:I=>o(I.target.value)})]}),p.jsxs("div",{className:"flex flex-col gap-2 p-3 border-2 border-dashed border-slate-300 rounded-lg bg-slate-100",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 flex items-center justify-between",children:[p.jsxs("span",{children:[p.jsx(uy,{size:16,className:"inline mr-1"}),"  ( ",T," / 5)"]}),T>=5&&p.jsx("span",{className:"text-red-600 font-bold",children:""})]}),p.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:b,disabled:T>=5,className:"block w-full text-sm text-slate-700 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-2 file:border-red-800 file:text-xs file:font-black file:bg-red-600 file:text-white hover:file:bg-red-700 cursor-pointer disabled:opacity-50"}),x.length>0&&p.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 pb-4",children:x.map((I,C)=>p.jsxs("div",{className:"relative shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 border-slate-900 shadow",children:[p.jsx("img",{src:I,className:"w-full h-full object-cover",alt:"preview"}),p.jsx("button",{type:"button",onClick:()=>E(C),className:"absolute top-0 right-0 bg-red-600 text-white rounded-full p-1 transform translate-x-1/3 -translate-y-1/3 border-2 border-white hover:bg-red-700 transition-all",children:p.jsx(ha,{size:12})})]},C))})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(zs,{size:16}),"  ()"]}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:u,onChange:I=>f(I.target.value),placeholder:"https://www.amazon.co.jp/..."})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(pT,{size:16})," / ()"]}),p.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 h-24 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",maxLength:500,value:d,onChange:I=>m(I.target.value),placeholder:" M  8000"})]}),p.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[p.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[p.jsx(ha,{size:16,className:"inline mr-1"})," "]}),p.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-red-600 text-white border-2 border-red-800 hover:bg-red-700 font-black italic shadow-[2px_2px_0px_0px_rgba(153,27,27,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(ic,{size:16,className:"inline mr-1"})," ",R?"":""]})]})]})}function JL({onSubmit:t,onCancel:e}){const[r,n]=re.useState(""),[a,i]=re.useState(""),[o,u]=re.useState(""),[f,d]=re.useState(""),[m,x]=re.useState([{id:Date.now(),name:"",price:"",quantity:1,url:""}]),y=()=>{x([...m,{id:Date.now(),name:"",price:"",quantity:1,url:""}])},b=T=>{m.length>1&&x(m.filter(R=>R.id!==T))},E=(T,R,I)=>{x(m.map(C=>C.id===T?{...C,[R]:I}:C))},w=T=>{if(T.preventDefault(),!r.trim())return alert(" IP ");if(!o.trim())return alert("");const R=m.filter(I=>I.name.trim()&&I.price);if(R.length===0)return alert("");t({ipName:r,type:a,sourceUrl:o,note:f,items:R})};return p.jsxs("form",{onSubmit:w,className:"space-y-5 font-sans text-slate-800",children:[p.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200",children:[p.jsxs("h4",{className:"font-black italic text-lg text-slate-900 border-b-2 border-slate-300 pb-2 mb-3 flex items-center gap-2",children:[p.jsx(oy,{size:20,className:"text-blue-600"}),"  (INFO)"]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" IP /  ",p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:" ...",value:r,onChange:T=>n(T.target.value)})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" ",p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsxs("div",{className:"flex gap-3",children:[p.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg p-2 text-center font-black transition-all ${a===""?"bg-slate-900 text-yellow-400 border-slate-900 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[p.jsx("input",{type:"radio",className:"hidden",value:"",checked:a==="",onChange:()=>i("")})," "]}),p.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg p-2 text-center font-black transition-all ${a===""?"bg-green-600 text-white border-green-800 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[p.jsx("input",{type:"radio",className:"hidden",value:"",checked:a==="",onChange:()=>i("")})," "]})]})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" /  ",p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsxs("div",{className:"relative",children:[p.jsx(Im,{size:16,className:"absolute left-3 top-3 text-slate-400"}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 pl-9 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:"...",value:o,onChange:T=>u(T.target.value)})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-black text-slate-700 mb-1",children:" ()"}),p.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-medium placeholder:font-normal h-20",placeholder:"...",value:f,onChange:T=>d(T.target.value)})]})]})]}),p.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border-2 border-slate-300",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsxs("h4",{className:"font-black italic text-lg text-slate-900 transform -skew-x-3 flex items-center gap-2",children:[p.jsx(_p,{size:20,className:"text-red-600"}),"  (ITEMS)"]}),p.jsx("button",{type:"button",onClick:y,className:"text-xs font-black px-3 py-1.5 bg-yellow-400 text-slate-900 rounded border-2 border-slate-900 hover:bg-yellow-500 transition-all shadow-sm",children:"+ "})]}),p.jsx("div",{className:"space-y-3",children:m.map((T,R)=>p.jsxs("div",{className:"bg-white p-3 rounded-lg border-2 border-slate-900 relative shadow-[2px_2px_0px_0px_rgba(15,23,42,1)] animate-in fade-in slide-in-from-bottom-1",children:[p.jsxs("div",{className:"flex justify-between items-center mb-2 border-b border-dashed border-slate-200 pb-1",children:[p.jsxs("span",{className:"text-xs font-black text-slate-400 italic",children:["ITEM #",R+1]}),m.length>1&&p.jsx("button",{type:"button",onClick:()=>b(T.id),className:"text-red-400 hover:text-red-600",children:p.jsx(ha,{size:16})})]}),p.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[p.jsxs("div",{className:"col-span-8",children:[p.jsxs("label",{className:"text-[10px] font-bold text-slate-500",children:[" ",p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsx("input",{className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm font-bold focus:border-slate-900 focus:ring-0",placeholder:" S",value:T.name,onChange:I=>E(T.id,"name",I.target.value)})]}),p.jsxs("div",{className:"col-span-4",children:[p.jsxs("label",{className:"text-[10px] font-bold text-slate-500",children:[" ",p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsx("input",{type:"number",className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm font-black text-red-600 focus:border-slate-900 focus:ring-0",placeholder:"",value:T.price,onChange:I=>E(T.id,"price",I.target.value)})]}),p.jsxs("div",{className:"col-span-4 sm:col-span-3",children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),p.jsxs("div",{className:"flex items-center",children:[p.jsx("button",{type:"button",onClick:()=>E(T.id,"quantity",Math.max(1,T.quantity-1)),className:"bg-slate-200 p-1 rounded-l border-y-2 border-l-2 border-slate-200 hover:bg-slate-300",children:p.jsx(cy,{size:12})}),p.jsx("input",{type:"number",className:"w-full text-center border-y-2 border-slate-200 p-1 text-sm font-bold h-[30px]",value:T.quantity,onChange:I=>E(T.id,"quantity",Math.max(1,parseInt(I.target.value)||1))}),p.jsx("button",{type:"button",onClick:()=>E(T.id,"quantity",T.quantity+1),className:"bg-slate-200 p-1 rounded-r border-y-2 border-r-2 border-slate-200 hover:bg-slate-300",children:p.jsx($o,{size:12})})]})]}),p.jsxs("div",{className:"col-span-8 sm:col-span-9",children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:" ()"}),p.jsx("input",{className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm text-slate-500 focus:border-slate-900 focus:ring-0",placeholder:"http://...",value:T.url,onChange:I=>E(T.id,"url",I.target.value)})]})]})]},T.id))})]}),p.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:[p.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[p.jsx(ha,{size:16,className:"inline mr-1"})," "]}),p.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-purple-600 text-white border-2 border-purple-800 hover:bg-purple-700 font-black italic shadow-[4px_4px_0px_0px_rgba(76,29,149,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(ic,{size:16,className:"inline mr-1"})," "]})]})]})}function ZL({group:t,currentOrder:e,onSubmit:r}){const[n,a]=re.useState(()=>{const m={};return t.items.forEach(x=>{const y=e?.items?.find(b=>b.itemId==x.id||b.name?.trim()===x.name?.trim()&&(b.spec?.trim()||"")===(x.spec?.trim()||""));m[x.id]=y?y.quantity:0}),m}),i=(m,x)=>{const y=parseInt(x)||0,b=t.items.find(w=>w.id===m);let E=Math.max(0,y);b?.limit&&E>b.limit&&(E=b.limit),a(w=>({...w,[m]:E}))},o=()=>{const m=t.items.map(x=>({itemId:x.id||x.name,name:x.name,spec:x.spec,price:x.price,image:x.image,quantity:n[x.id]||0})).filter(x=>x.quantity>0);if(m.length===0){e?confirm(" 0()")&&r([]):alert("");return}r(m)},u=t.items.reduce((m,x)=>{const y=Number(x.price)||0,b=n[x.id]||0;return m+y*b},0),f=Number(t.shippingFee||0),d=Math.round((u+f)*t.exchangeRate);return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg border-2 border-yellow-400 text-sm font-bold text-slate-800",children:[p.jsxs("p",{className:"flex items-center gap-2",children:[p.jsx(Om,{size:16,className:"text-red-600"}),""]}),p.jsxs("ul",{className:"mt-1 ml-1 list-disc list-inside text-xs font-medium text-slate-600 space-y-0.5",children:[p.jsxs("li",{children:["",t.exchangeRate]}),p.jsxs("li",{children:[" ",f.toLocaleString()]}),p.jsxs("li",{children:["",t.deadline]})]})]}),p.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border-2 border-slate-200",children:[p.jsx("h4",{className:"font-black italic text-lg text-slate-900 border-b border-slate-300 pb-3 mb-3",children:""}),p.jsx("div",{className:"space-y-4",children:t.items.map(m=>{const x=n[m.id]||0,y=m.limit&&x>=m.limit;return p.jsxs("div",{className:"flex items-center justify-between border-b-2 border-slate-100 pb-4 last:border-0 bg-white p-3 rounded-lg shadow-sm",children:[p.jsxs("div",{className:"flex items-start gap-3 flex-1 overflow-hidden",children:[p.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-100 border-2 border-slate-900 shrink-0 overflow-hidden flex items-center justify-center shadow-md",children:m.image?p.jsx("img",{src:m.image,alt:m.spec,className:"w-full h-full object-cover"}):p.jsx(Z0,{size:20,className:"text-slate-400"})}),p.jsxs("div",{className:"min-w-0 pt-1",children:[p.jsx("div",{className:"font-black italic text-slate-900 truncate",children:m.name}),p.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 mt-1 flex-wrap",children:[m.spec&&p.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full font-bold",children:m.spec}),p.jsxs("span",{className:"text-red-600 font-black flex items-center gap-0.5",children:["",m.price]}),m.limit&&p.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:[" (: ",m.limit,")"]}),y&&p.jsx("span",{className:"text-red-600 font-black text-xs",children:" (MAX!)"})]})]})]}),p.jsxs("div",{className:"flex items-center gap-1 pl-2 shrink-0",children:[p.jsx("button",{type:"button",className:"w-8 h-8 rounded-full bg-slate-100 hover:bg-slate-200 font-bold text-slate-900 flex items-center justify-center border-2 border-slate-900 transition-colors shadow-[1px_1px_0px_0px_rgba(15,23,42,1)] active:shadow-none active:translate-y-0.5 active:translate-x-0.5",onClick:()=>i(m.id,x-1),children:p.jsx(cy,{size:16})}),p.jsx("input",{type:"number",className:"w-10 text-center font-black italic text-lg border-none focus:ring-2 focus:ring-yellow-400 p-0 bg-transparent text-slate-900",value:x,onChange:b=>i(m.id,b.target.value),min:"0",max:m.limit||999}),p.jsx("button",{type:"button",className:`w-8 h-8 rounded-full font-bold flex items-center justify-center border-2 border-slate-900 transition-colors shadow-[1px_1px_0px_0px_rgba(15,23,42,1)] active:shadow-none active:translate-y-0.5 active:translate-x-0.5 ${y?"bg-slate-300 text-slate-600 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,onClick:()=>i(m.id,x+1),disabled:y,children:p.jsx($o,{size:16})})]})]},m.id)})})]}),p.jsxs("div",{className:"bg-slate-800 text-white p-4 rounded-lg border-2 border-yellow-400 shadow-md",children:[p.jsx("h4",{className:"text-xl font-black italic text-yellow-400 mb-2",children:" (Summary)"}),p.jsxs("p",{className:"flex justify-between font-bold text-white border-b border-slate-600 pb-1 text-base",children:[p.jsx("span",{children:" (Goods JPY)"}),p.jsxs("span",{className:"font-mono text-xl text-red-400",children:[" ",u.toLocaleString()]})]}),f>0&&p.jsxs("p",{className:"flex justify-between text-sm pt-1 text-slate-300",children:[p.jsx("span",{children:" (Shipping JPY)"}),p.jsxs("span",{className:"font-mono",children:[" ",f.toLocaleString()]})]}),p.jsxs("p",{className:"flex justify-between pt-2 border-t border-slate-600 mt-2 font-black text-xl italic",children:[p.jsx("span",{children:" (NT$)"}),p.jsxs("span",{className:"font-mono text-2xl text-yellow-400",children:["NT$ ",d.toLocaleString()]})]})]}),p.jsx("div",{className:"pt-4 sticky bottom-0 bg-white/90 backdrop-blur-sm pb-2 border-t-2 border-yellow-400 mt-4",children:p.jsxs("button",{type:"button",className:"w-full py-3 bg-red-600 text-white rounded-lg font-black italic text-xl hover:bg-red-700 transition-all shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] active:translate-y-1 active:shadow-none active:translate-x-1 border-2 border-slate-900",onClick:o,children:[p.jsx(J0,{size:20,className:"inline mr-2"}),u===0&&e?"":e?"":" (PLUS ULTRA!)"]})})]})}var Fm={};Fm.version="0.18.5";var nC=1252,e7=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],gy={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},xy=function(t){e7.indexOf(t)!=-1&&(nC=gy[0]=t)};function t7(){xy(1252)}var ws=function(t){xy(t)};function vy(){ws(1200),t7()}function kT(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function r7(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function aC(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Wf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?r7(t.slice(2)):e==254&&r==255?aC(t.slice(2)):e==65279?t.slice(1):t},Vd=function(e){return String.fromCharCode(e)},CT=function(e){return String.fromCharCode(e)},y0,Nl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _0(t){for(var e="",r=0,n=0,a=0,i=0,o=0,u=0,f=0,d=0;d<t.length;)r=t.charCodeAt(d++),i=r>>2,n=t.charCodeAt(d++),o=(r&3)<<4|n>>4,a=t.charCodeAt(d++),u=(n&15)<<2|a>>6,f=a&63,isNaN(n)?u=f=64:isNaN(a)&&(f=64),e+=Nl.charAt(i)+Nl.charAt(o)+Nl.charAt(u)+Nl.charAt(f);return e}function Oa(t){var e="",r=0,n=0,a=0,i=0,o=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)i=Nl.indexOf(t.charAt(d++)),o=Nl.indexOf(t.charAt(d++)),r=i<<2|o>>4,e+=String.fromCharCode(r),u=Nl.indexOf(t.charAt(d++)),n=(o&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),f=Nl.indexOf(t.charAt(d++)),a=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(a));return e}var At=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Bi=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Yl(t){return At?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function NT(t){return At?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ca=function(e){return At?Bi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Ep(t){if(typeof ArrayBuffer>"u")return Ca(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function no(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function n7(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function yy(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return yy(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var gn=At?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Bi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function a7(t){for(var e=[],r=0,n=t.length+250,a=Yl(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=t.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|u>>6&15|(o&3)<<4,a[r++]=128|u&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Yl(65535),n=65530)}return e.push(a.slice(0,r)),gn(e)}var Zn=/\u0000/g,Xf=/[\u0001-\u0006]/g;function fu(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function bs(t,e){var r=""+t;return r.length>=e?r:Pr("0",e-r.length)+r}function _y(t,e){var r=""+t;return r.length>=e?r:Pr(" ",e-r.length)+r}function Mm(t,e){var r=""+t;return r.length>=e?r:r+Pr(" ",e-r.length)}function s7(t,e){var r=""+Math.round(t);return r.length>=e?r:Pr("0",e-r.length)+r}function i7(t,e){var r=""+t;return r.length>=e?r:Pr("0",e-r.length)+r}var RT=Math.pow(2,32);function Qc(t,e){if(t>RT||t<-RT)return s7(t,e);var r=Math.round(t);return i7(r,e)}function Pm(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var IT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],K1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function l7(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},DT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},o7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function jm(t,e,r){for(var n=t<0?-1:1,a=t*n,i=0,o=1,u=0,f=1,d=0,m=0,x=Math.floor(a);d<e&&(x=Math.floor(a),u=x*o+i,m=x*d+f,!(a-x<5e-8));)a=1/(a-x),i=o,o=u,f=d,d=m;if(m>e&&(d>e?(m=f,u=i):(m=d,u=o)),!r)return[0,n*u,m];var y=Math.floor(n*u/m);return[y,n*u-y*m,m]}function Mo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),i=0,o=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=m7(f,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=i,u}var sC=new Date(1899,11,31,0,0,0),c7=sC.getTime(),u7=new Date(1900,2,1,0,0,0);function iC(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=u7&&(r+=1440*60*1e3),(r-(c7+(t.getTimezoneOffset()-sC.getTimezoneOffset())*6e4))/(1440*60*1e3)}function wy(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function f7(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function h7(t){var e=t<0?12:11,r=wy(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function d7(t){var e=wy(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function w0(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=h7(t):e===10?r=t.toFixed(10).substr(0,12):r=d7(t),wy(f7(r.toUpperCase()))}function Qo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):w0(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return rs(14,iC(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function m7(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function p7(t,e,r,n){var a="",i=0,o=0,u=r.y,f,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,d=2;break;default:f=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:f=r.m,d=e.length;break;case 3:return K1[r.m-1][1];case 5:return K1[r.m-1][0];default:return K1[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,d=e.length;break;case 3:return IT[r.q][0];default:return IT[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?bs(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(a=bs(i,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:f=u,d=1;break}var m=d>0?bs(f,d):"";return m}function Rl(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var lC=/%/g;function g7(t,e,r){var n=e.replace(lC,""),a=e.length-n.length;return ki(t,n,r*Math.pow(10,2*a))+Pr("%",a)}function x7(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ki(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function oC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+oC(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(a+i)%a)+"."+m.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var cC=/# (\?+)( ?)\/( ?)(\d+)/;function v7(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),i=Math.floor(a/n),o=a-i*n,u=n;return r+(i===0?"":""+i)+" "+(o===0?Pr(" ",t[1].length+1+t[4].length):_y(o,t[1].length)+t[2]+"/"+t[3]+bs(u,t[4].length))}function y7(t,e,r){return r+(e===0?"":""+e)+Pr(" ",t[1].length+2+t[4].length)}var uC=/^#*0*\.([0#]+)/,fC=/\).*[0#]/,hC=/\(###\) ###\\?-####/;function Kn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function OT(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function FT(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function _7(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function w7(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ya(t,e,r){if(t.charCodeAt(0)===40&&!e.match(fC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ya("n",n,r):"("+Ya("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return x7(t,e,r);if(e.indexOf("%")!==-1)return g7(t,e,r);if(e.indexOf("E")!==-1)return oC(e,r);if(e.charCodeAt(0)===36)return"$"+Ya(t,e.substr(e.charAt(1)==" "?2:1),r);var a,i,o,u,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Qc(f,e.length);if(e.match(/^[#?]+$/))return a=Qc(r,0),a==="0"&&(a=""),a.length>e.length?a:Kn(e.substr(0,e.length-a.length))+a;if(i=e.match(cC))return v7(i,f,d);if(e.match(/^#+0+$/))return d+Qc(f,e.length-e.indexOf("0"));if(i=e.match(uC))return a=OT(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Kn(i[1])).replace(/\.$/,"."+Kn(i[1])).replace(/\.(\d*)$/,function(E,w){return"."+w+Pr("0",Kn(i[1]).length-w.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+OT(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+Rl(Qc(f,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ya(t,e,-r):Rl(""+(Math.floor(r)+_7(r,i[1].length)))+"."+bs(FT(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Ya(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=fu(Ya(t,e.replace(/[\\-]/g,""),r)),o=0,fu(fu(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<a.length?a.charAt(o++):E==="0"?"0":""}));if(e.match(hC))return a=Ya(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=jm(f,Math.pow(10,o)-1,!1),a=""+d,m=ki("n",i[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+i[2]+"/"+i[3],m=Mm(u[2],o),m.length<i[4].length&&(m=Kn(i[4].substr(i[4].length-m.length))+m),a+=m,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=jm(f,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?_y(u[1],o)+i[2]+"/"+i[3]+Mm(u[2],o):Pr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=Qc(r,0),e.length<=a.length?a:Kn(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var x=e.indexOf(".")-o,y=e.length-a.length-x;return Kn(e.substr(0,x)+a+e.substr(e.length-y))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=FT(r,i[1].length),r<0?"-"+Ya(t,e,-r):Rl(w7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?bs(0,3-E.length):"")+E})+"."+bs(o,i[1].length);switch(e){case"###,##0.00":return Ya(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var b=Rl(Qc(f,0));return b!=="0"?d+b:"";case"###,###.00":return Ya(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ya(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function b7(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ki(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function E7(t,e,r){var n=e.replace(lC,""),a=e.length-n.length;return ki(t,n,r*Math.pow(10,2*a))+Pr("%",a)}function dC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+dC(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(a+i)%a)+"."+m.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ls(t,e,r){if(t.charCodeAt(0)===40&&!e.match(fC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ls("n",n,r):"("+Ls("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return b7(t,e,r);if(e.indexOf("%")!==-1)return E7(t,e,r);if(e.indexOf("E")!==-1)return dC(e,r);if(e.charCodeAt(0)===36)return"$"+Ls(t,e.substr(e.charAt(1)==" "?2:1),r);var a,i,o,u,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+bs(f,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:Kn(e.substr(0,e.length-a.length))+a;if(i=e.match(cC))return y7(i,f,d);if(e.match(/^#+0+$/))return d+bs(f,e.length-e.indexOf("0"));if(i=e.match(uC))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Kn(i[1])).replace(/\.$/,"."+Kn(i[1])),a=a.replace(/\.(\d*)$/,function(E,w){return"."+w+Pr("0",Kn(i[1]).length-w.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+Rl(""+f);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ls(t,e,-r):Rl(""+r)+"."+Pr("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Ls(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=fu(Ls(t,e.replace(/[\\-]/g,""),r)),o=0,fu(fu(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<a.length?a.charAt(o++):E==="0"?"0":""}));if(e.match(hC))return a=Ls(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=jm(f,Math.pow(10,o)-1,!1),a=""+d,m=ki("n",i[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+i[2]+"/"+i[3],m=Mm(u[2],o),m.length<i[4].length&&(m=Kn(i[4].substr(i[4].length-m.length))+m),a+=m,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=jm(f,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?_y(u[1],o)+i[2]+"/"+i[3]+Mm(u[2],o):Pr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:Kn(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var x=e.indexOf(".")-o,y=e.length-a.length-x;return Kn(e.substr(0,x)+a+e.substr(e.length-y))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ls(t,e,-r):Rl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?bs(0,3-E.length):"")+E})+"."+bs(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var b=Rl(""+f);return b!=="0"?d+b:"";default:if(e.match(/\.[0#?]*$/))return Ls(t,e.slice(0,e.lastIndexOf(".")),r)+Kn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ki(t,e,r){return(r|0)===r?Ls(t,e,r):Ya(t,e,r)}function T7(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var mC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Pm(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(mC))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function S7(t,e,r,n){for(var a=[],i="",o=0,u="",f="t",d,m,x,y="H";o<t.length;)switch(u=t.charAt(o)){case"G":if(!Pm(t,o))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(x=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(x);a[a.length]={t:"t",v:i},++o;break;case"\\":var b=t.charAt(++o),E=b==="("||b===")"?b:"t";a[a.length]={t:E,v:b},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=Mo(e,r,t.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},f=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Mo(e,r),d==null))return"";for(i=u;++o<t.length&&t.charAt(o).toLowerCase()===u;)i+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),a[a.length]={t:u,v:i},f=u;break;case"A":case"a":case"":var w={t:u,v:u};if(d==null&&(d=Mo(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(w.v=d.H>=12?"P":"A"),w.t="T",y="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(w.v=d.H>=12?"PM":"AM"),w.t="T",o+=5,y="h"):t.substr(o,5).toUpperCase()==="/"?(d!=null&&(w.v=d.H>=12?"":""),w.t="T",o+=5,y="h"):(w.t="t",++o),d==null&&w.t==="T")return"";a[a.length]=w,f=u;break;case"[":for(i=u;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(mC)){if(d==null&&(d=Mo(e,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pu(t)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=u;++o<t.length&&(u=t.charAt(o))==="0";)i+=u;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=u;++o<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(o))>-1;)i+=u;a[a.length]={t:"n",v:i};break;case"?":for(i=u;t.charAt(++o)===u;)i+=u;a[a.length]={t:u,v:i},f=u;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=u;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:u,v:u},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++o;break}var T=0,R=0,I;for(o=a.length-1,f="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=y,f="h",T<1&&(T=1);break;case"s":(I=a[o].v.match(/\.0+$/))&&(R=Math.max(R,I[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":f=a[o].t;break;case"m":f==="s"&&(a[o].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&a[o].v.match(/[Hh]/)&&(T=1),T<2&&a[o].v.match(/[Mm]/)&&(T=2),T<3&&a[o].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var C="",W;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=p7(a[o].t.charCodeAt(0),a[o].v,d,R),a[o].t="t";break;case"n":case"?":for(W=o+1;a[W]!=null&&((u=a[W].t)==="?"||u==="D"||(u===" "||u==="t")&&a[W+1]!=null&&(a[W+1].t==="?"||a[W+1].t==="t"&&a[W+1].v==="/")||a[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[W].v==="/"||a[W].v===" "&&a[W+1]!=null&&a[W+1].t=="?"));)a[o].v+=a[W].v,a[W]={v:"",t:";"},++W;C+=a[o].v,o=W-1;break;case"G":a[o].t="t",a[o].v=Qo(e,r);break}var U="",B,A;if(C.length>0){C.charCodeAt(0)==40?(B=e<0&&C.charCodeAt(0)===45?-e:e,A=ki("n",C,B)):(B=e<0&&n>1?-e:e,A=ki("n",C,B),B<0&&a[0]&&a[0].t=="t"&&(A=A.substr(1),a[0].v="-"+a[0].v)),W=A.length-1;var D=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){D=o;break}var N=a.length;if(D===a.length&&A.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(W>=a[o].v.length-1?(W-=a[o].v.length,a[o].v=A.substr(W+1,a[o].v.length)):W<0?a[o].v="":(a[o].v=A.substr(0,W+1),W=-1),a[o].t="t",N=o);W>=0&&N<a.length&&(a[N].v=A.substr(0,W+1)+a[N].v)}else if(D!==a.length&&A.indexOf("E")===-1){for(W=A.indexOf(".")-1,o=D;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(m=a[o].v.indexOf(".")>-1&&o===D?a[o].v.indexOf(".")-1:a[o].v.length-1,U=a[o].v.substr(m+1);m>=0;--m)W>=0&&(a[o].v.charAt(m)==="0"||a[o].v.charAt(m)==="#")&&(U=A.charAt(W--)+U);a[o].v=U,a[o].t="t",N=o}for(W>=0&&N<a.length&&(a[N].v=A.substr(0,W+1)+a[N].v),W=A.indexOf(".")+1,o=D;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==D)){for(m=a[o].v.indexOf(".")>-1&&o===D?a[o].v.indexOf(".")+1:0,U=a[o].v.substr(0,m);m<a[o].v.length;++m)W<A.length&&(U+=A.charAt(W++));a[o].v=U,a[o].t="t",N=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(B=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=ki(a[o].t,a[o].v,B),a[o].t="t");var M="";for(o=0;o!==a.length;++o)a[o]!=null&&(M+=a[o].v);return M}var MT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function PT(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function A7(t,e){var r=T7(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(MT),u=r[1].match(MT);return PT(e,o)?[n,r[0]]:PT(e,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,i]}function rs(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ot)[t],n==null&&(n=r.table&&r.table[DT[t]]||ot[DT[t]]),n==null&&(n=o7[t]||"General");break}if(Pm(n,0))return Qo(e,r);e instanceof Date&&(e=iC(e,r.date1904));var a=A7(n,e);if(Pm(a[1]))return Qo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return S7(a[1],e,r,a[0])}function Ci(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ot[r]==null){e<0&&(e=r);continue}if(ot[r]==t){e=r;break}}e<0&&(e=391)}return ot[e]=t,e}function Tp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ci(t[e],e)}function ju(){ot=l7()}var k7={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},pC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function C7(t){var e=typeof t=="number"?ot[t]:t;return e=e.replace(pC,"(\\d+)"),new RegExp("^"+e+"$")}function N7(t,e,r){var n=-1,a=-1,i=-1,o=-1,u=-1,f=-1;(e.match(pC)||[]).forEach(function(x,y){var b=parseInt(r[y+1],10);switch(x.toLowerCase().charAt(0)){case"y":n=b;break;case"d":i=b;break;case"h":o=b;break;case"s":f=b;break;case"m":o>=0?u=b:a=b;break}}),f>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&u==-1&&f==-1?d:n==-1&&a==-1&&i==-1?m:d+"T"+m}var R7=(function(){var t={};t.version="1.2.0";function e(){for(var A=0,D=new Array(256),N=0;N!=256;++N)A=N,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,D[N]=A;return typeof Int32Array<"u"?new Int32Array(D):D}var r=e();function n(A){var D=0,N=0,M=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)F[M]=A[M];for(M=0;M!=256;++M)for(N=A[M],D=256+M;D<4096;D+=256)N=F[D]=N>>>8^A[N&255];var P=[];for(M=1;M!=16;++M)P[M-1]=typeof Int32Array<"u"?F.subarray(M*256,M*256+256):F.slice(M*256,M*256+256);return P}var a=n(r),i=a[0],o=a[1],u=a[2],f=a[3],d=a[4],m=a[5],x=a[6],y=a[7],b=a[8],E=a[9],w=a[10],T=a[11],R=a[12],I=a[13],C=a[14];function W(A,D){for(var N=D^-1,M=0,F=A.length;M<F;)N=N>>>8^r[(N^A.charCodeAt(M++))&255];return~N}function U(A,D){for(var N=D^-1,M=A.length-15,F=0;F<M;)N=C[A[F++]^N&255]^I[A[F++]^N>>8&255]^R[A[F++]^N>>16&255]^T[A[F++]^N>>>24]^w[A[F++]]^E[A[F++]]^b[A[F++]]^y[A[F++]]^x[A[F++]]^m[A[F++]]^d[A[F++]]^f[A[F++]]^u[A[F++]]^o[A[F++]]^i[A[F++]]^r[A[F++]];for(M+=15;F<M;)N=N>>>8^r[(N^A[F++])&255];return~N}function B(A,D){for(var N=D^-1,M=0,F=A.length,P=0,V=0;M<F;)P=A.charCodeAt(M++),P<128?N=N>>>8^r[(N^P)&255]:P<2048?(N=N>>>8^r[(N^(192|P>>6&31))&255],N=N>>>8^r[(N^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,V=A.charCodeAt(M++)&1023,N=N>>>8^r[(N^(240|P>>8&7))&255],N=N>>>8^r[(N^(128|P>>2&63))&255],N=N>>>8^r[(N^(128|V>>6&15|(P&3)<<4))&255],N=N>>>8^r[(N^(128|V&63))&255]):(N=N>>>8^r[(N^(224|P>>12&15))&255],N=N>>>8^r[(N^(128|P>>6&63))&255],N=N>>>8^r[(N^(128|P&63))&255]);return~N}return t.table=r,t.bstr=W,t.buf=U,t.str=B,t})(),nt=(function(){var e={};e.version="1.2.1";function r(L,Q){for(var H=L.split("/"),q=Q.split("/"),K=0,Z=0,de=Math.min(H.length,q.length);K<de;++K){if(Z=H[K].length-q[K].length)return Z;if(H[K]!=q[K])return H[K]<q[K]?-1:1}return H.length-q.length}function n(L){if(L.charAt(L.length-1)=="/")return L.slice(0,-1).indexOf("/")===-1?L:n(L.slice(0,-1));var Q=L.lastIndexOf("/");return Q===-1?L:L.slice(0,Q+1)}function a(L){if(L.charAt(L.length-1)=="/")return a(L.slice(0,-1));var Q=L.lastIndexOf("/");return Q===-1?L:L.slice(Q+1)}function i(L,Q){typeof Q=="string"&&(Q=new Date(Q));var H=Q.getHours();H=H<<6|Q.getMinutes(),H=H<<5|Q.getSeconds()>>>1,L.write_shift(2,H);var q=Q.getFullYear()-1980;q=q<<4|Q.getMonth()+1,q=q<<5|Q.getDate(),L.write_shift(2,q)}function o(L){var Q=L.read_shift(2)&65535,H=L.read_shift(2)&65535,q=new Date,K=H&31;H>>>=5;var Z=H&15;H>>>=4,q.setMilliseconds(0),q.setFullYear(H+1980),q.setMonth(Z-1),q.setDate(K);var de=Q&31;Q>>>=5;var Ae=Q&63;return Q>>>=6,q.setHours(Q),q.setMinutes(Ae),q.setSeconds(de<<1),q}function u(L){Sn(L,0);for(var Q={},H=0;L.l<=L.length-4;){var q=L.read_shift(2),K=L.read_shift(2),Z=L.l+K,de={};switch(q){case 21589:H=L.read_shift(1),H&1&&(de.mtime=L.read_shift(4)),K>5&&(H&2&&(de.atime=L.read_shift(4)),H&4&&(de.ctime=L.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}L.l=Z,Q[q]=de}return Q}var f;function d(){return f||(f={})}function m(L,Q){if(L[0]==80&&L[1]==75)return ea(L,Q);if((L[0]|32)==109&&(L[1]|32)==105)return ti(L,Q);if(L.length<512)throw new Error("CFB file size "+L.length+" < 512");var H=3,q=512,K=0,Z=0,de=0,Ae=0,me=0,xe=[],ge=L.slice(0,512);Sn(ge,0);var Le=x(ge);switch(H=Le[0],H){case 3:q=512;break;case 4:q=4096;break;case 0:if(Le[1]==0)return ea(L,Q);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}q!==512&&(ge=L.slice(0,q),Sn(ge,28));var Ve=L.slice(0,q);y(ge,H);var qe=ge.read_shift(4,"i");if(H===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);ge.l+=4,de=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),Ae=ge.read_shift(4,"i"),K=ge.read_shift(4,"i"),me=ge.read_shift(4,"i"),Z=ge.read_shift(4,"i");for(var je=-1,Ge=0;Ge<109&&(je=ge.read_shift(4,"i"),!(je<0));++Ge)xe[Ge]=je;var Ze=b(L,q);T(me,Z,Ze,q,xe);var Qt=I(Ze,de,xe,q);Qt[de].name="!Directory",K>0&&Ae!==V&&(Qt[Ae].name="!MiniFAT"),Qt[xe[0]].name="!FAT",Qt.fat_addrs=xe,Qt.ssz=q;var Jt={},fr=[],In=[],ls=[];C(de,Qt,Ze,fr,K,Jt,In,Ae),E(In,ls,fr),fr.shift();var os={FileIndex:In,FullPaths:ls};return Q&&Q.raw&&(os.raw={header:Ve,sectors:Ze}),os}function x(L){if(L[L.l]==80&&L[L.l+1]==75)return[0,0];L.chk(Ee,"Header Signature: "),L.l+=16;var Q=L.read_shift(2,"u");return[L.read_shift(2,"u"),Q]}function y(L,Q){var H=9;switch(L.l+=2,H=L.read_shift(2)){case 9:if(Q!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(Q!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}L.chk("0600","Mini Sector Shift: "),L.chk("000000000000","Reserved: ")}function b(L,Q){for(var H=Math.ceil(L.length/Q)-1,q=[],K=1;K<H;++K)q[K-1]=L.slice(K*Q,(K+1)*Q);return q[H-1]=L.slice(H*Q),q}function E(L,Q,H){for(var q=0,K=0,Z=0,de=0,Ae=0,me=H.length,xe=[],ge=[];q<me;++q)xe[q]=ge[q]=q,Q[q]=H[q];for(;Ae<ge.length;++Ae)q=ge[Ae],K=L[q].L,Z=L[q].R,de=L[q].C,xe[q]===q&&(K!==-1&&xe[K]!==K&&(xe[q]=xe[K]),Z!==-1&&xe[Z]!==Z&&(xe[q]=xe[Z])),de!==-1&&(xe[de]=q),K!==-1&&q!=xe[q]&&(xe[K]=xe[q],ge.lastIndexOf(K)<Ae&&ge.push(K)),Z!==-1&&q!=xe[q]&&(xe[Z]=xe[q],ge.lastIndexOf(Z)<Ae&&ge.push(Z));for(q=1;q<me;++q)xe[q]===q&&(Z!==-1&&xe[Z]!==Z?xe[q]=xe[Z]:K!==-1&&xe[K]!==K&&(xe[q]=xe[K]));for(q=1;q<me;++q)if(L[q].type!==0){if(Ae=q,Ae!=xe[Ae])do Ae=xe[Ae],Q[q]=Q[Ae]+"/"+Q[q];while(Ae!==0&&xe[Ae]!==-1&&Ae!=xe[Ae]);xe[q]=-1}for(Q[0]+="/",q=1;q<me;++q)L[q].type!==2&&(Q[q]+="/")}function w(L,Q,H){for(var q=L.start,K=L.size,Z=[],de=q;H&&K>0&&de>=0;)Z.push(Q.slice(de*P,de*P+P)),K-=P,de=Oo(H,de*4);return Z.length===0?Se(0):gn(Z).slice(0,L.size)}function T(L,Q,H,q,K){var Z=V;if(L===V){if(Q!==0)throw new Error("DIFAT chain shorter than expected")}else if(L!==-1){var de=H[L],Ae=(q>>>2)-1;if(!de)return;for(var me=0;me<Ae&&(Z=Oo(de,me*4))!==V;++me)K.push(Z);T(Oo(de,q-4),Q-1,H,q,K)}}function R(L,Q,H,q,K){var Z=[],de=[];K||(K=[]);var Ae=q-1,me=0,xe=0;for(me=Q;me>=0;){K[me]=!0,Z[Z.length]=me,de.push(L[me]);var ge=H[Math.floor(me*4/q)];if(xe=me*4&Ae,q<4+xe)throw new Error("FAT boundary crossed: "+me+" 4 "+q);if(!L[ge])break;me=Oo(L[ge],xe)}return{nodes:Z,data:YT([de])}}function I(L,Q,H,q){var K=L.length,Z=[],de=[],Ae=[],me=[],xe=q-1,ge=0,Le=0,Ve=0,qe=0;for(ge=0;ge<K;++ge)if(Ae=[],Ve=ge+Q,Ve>=K&&(Ve-=K),!de[Ve]){me=[];var je=[];for(Le=Ve;Le>=0;){je[Le]=!0,de[Le]=!0,Ae[Ae.length]=Le,me.push(L[Le]);var Ge=H[Math.floor(Le*4/q)];if(qe=Le*4&xe,q<4+qe)throw new Error("FAT boundary crossed: "+Le+" 4 "+q);if(!L[Ge]||(Le=Oo(L[Ge],qe),je[Le]))break}Z[Ve]={nodes:Ae,data:YT([me])}}return Z}function C(L,Q,H,q,K,Z,de,Ae){for(var me=0,xe=q.length?2:0,ge=Q[L].data,Le=0,Ve=0,qe;Le<ge.length;Le+=128){var je=ge.slice(Le,Le+128);Sn(je,64),Ve=je.read_shift(2),qe=Cy(je,0,Ve-xe),q.push(qe);var Ge={name:qe,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0},Ze=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);Ze!==0&&(Ge.ct=W(je,je.l-8));var Qt=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);Qt!==0&&(Ge.mt=W(je,je.l-8)),Ge.start=je.read_shift(4,"i"),Ge.size=je.read_shift(4,"i"),Ge.size<0&&Ge.start<0&&(Ge.size=Ge.type=0,Ge.start=V,Ge.name=""),Ge.type===5?(me=Ge.start,K>0&&me!==V&&(Q[me].name="!StreamData")):Ge.size>=4096?(Ge.storage="fat",Q[Ge.start]===void 0&&(Q[Ge.start]=R(H,Ge.start,Q.fat_addrs,Q.ssz)),Q[Ge.start].name=Ge.name,Ge.content=Q[Ge.start].data.slice(0,Ge.size)):(Ge.storage="minifat",Ge.size<0?Ge.size=0:me!==V&&Ge.start!==V&&Q[me]&&(Ge.content=w(Ge,Q[me].data,(Q[Ae]||{}).data))),Ge.content&&Sn(Ge.content,0),Z[qe]=Ge,de.push(Ge)}}function W(L,Q){return new Date((ka(L,Q+4)/1e7*Math.pow(2,32)+ka(L,Q)/1e7-11644473600)*1e3)}function U(L,Q){return d(),m(f.readFileSync(L),Q)}function B(L,Q){var H=Q&&Q.type;switch(H||At&&Buffer.isBuffer(L)&&(H="buffer"),H||"base64"){case"file":return U(L,Q);case"base64":return m(Ca(Oa(L)),Q);case"binary":return m(Ca(L),Q)}return m(L,Q)}function A(L,Q){var H=Q||{},q=H.root||"Root Entry";if(L.FullPaths||(L.FullPaths=[]),L.FileIndex||(L.FileIndex=[]),L.FullPaths.length!==L.FileIndex.length)throw new Error("inconsistent CFB structure");L.FullPaths.length===0&&(L.FullPaths[0]=q+"/",L.FileIndex[0]={name:q,type:5}),H.CLSID&&(L.FileIndex[0].clsid=H.CLSID),D(L)}function D(L){var Q="Sh33tJ5";if(!nt.find(L,"/"+Q)){var H=Se(4);H[0]=55,H[1]=H[3]=50,H[2]=54,L.FileIndex.push({name:Q,type:2,content:H,size:4,L:69,R:69,C:69}),L.FullPaths.push(L.FullPaths[0]+Q),N(L)}}function N(L,Q){A(L);for(var H=!1,q=!1,K=L.FullPaths.length-1;K>=0;--K){var Z=L.FileIndex[K];switch(Z.type){case 0:q?H=!0:(L.FileIndex.pop(),L.FullPaths.pop());break;case 1:case 2:case 5:q=!0,isNaN(Z.R*Z.L*Z.C)&&(H=!0),Z.R>-1&&Z.L>-1&&Z.R==Z.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!Q)){var de=new Date(1987,1,19),Ae=0,me=Object.create?Object.create(null):{},xe=[];for(K=0;K<L.FullPaths.length;++K)me[L.FullPaths[K]]=!0,L.FileIndex[K].type!==0&&xe.push([L.FullPaths[K],L.FileIndex[K]]);for(K=0;K<xe.length;++K){var ge=n(xe[K][0]);q=me[ge],q||(xe.push([ge,{name:a(ge).replace("/",""),type:1,clsid:ie,ct:de,mt:de,content:null}]),me[ge]=!0)}for(xe.sort(function(qe,je){return r(qe[0],je[0])}),L.FullPaths=[],L.FileIndex=[],K=0;K<xe.length;++K)L.FullPaths[K]=xe[K][0],L.FileIndex[K]=xe[K][1];for(K=0;K<xe.length;++K){var Le=L.FileIndex[K],Ve=L.FullPaths[K];if(Le.name=a(Ve).replace("/",""),Le.L=Le.R=Le.C=-(Le.color=1),Le.size=Le.content?Le.content.length:0,Le.start=0,Le.clsid=Le.clsid||ie,K===0)Le.C=xe.length>1?1:-1,Le.size=0,Le.type=5;else if(Ve.slice(-1)=="/"){for(Ae=K+1;Ae<xe.length&&n(L.FullPaths[Ae])!=Ve;++Ae);for(Le.C=Ae>=xe.length?-1:Ae,Ae=K+1;Ae<xe.length&&n(L.FullPaths[Ae])!=n(Ve);++Ae);Le.R=Ae>=xe.length?-1:Ae,Le.type=1}else n(L.FullPaths[K+1]||"")==n(Ve)&&(Le.R=K+1),Le.type=2}}}function M(L,Q){var H=Q||{};if(H.fileType=="mad")return Uu(L,H);switch(N(L),H.fileType){case"zip":return Er(L,H)}var q=(function(qe){for(var je=0,Ge=0,Ze=0;Ze<qe.FileIndex.length;++Ze){var Qt=qe.FileIndex[Ze];if(Qt.content){var Jt=Qt.content.length;Jt>0&&(Jt<4096?je+=Jt+63>>6:Ge+=Jt+511>>9)}}for(var fr=qe.FullPaths.length+3>>2,In=je+7>>3,ls=je+127>>7,os=In+Ge+fr+ls,xa=os+127>>7,Hi=xa<=109?0:Math.ceil((xa-109)/127);os+xa+Hi+127>>7>xa;)Hi=++xa<=109?0:Math.ceil((xa-109)/127);var Dn=[1,Hi,xa,ls,fr,Ge,je,0];return qe.FileIndex[0].size=je<<6,Dn[7]=(qe.FileIndex[0].start=Dn[0]+Dn[1]+Dn[2]+Dn[3]+Dn[4]+Dn[5])+(Dn[6]+7>>3),Dn})(L),K=Se(q[7]<<9),Z=0,de=0;{for(Z=0;Z<8;++Z)K.write_shift(1,we[Z]);for(Z=0;Z<8;++Z)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),Z=0;Z<3;++Z)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,q[2]),K.write_shift(4,q[0]+q[1]+q[2]+q[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,q[3]?q[0]+q[1]+q[2]-1:V),K.write_shift(4,q[3]),K.write_shift(-4,q[1]?q[0]-1:V),K.write_shift(4,q[1]),Z=0;Z<109;++Z)K.write_shift(-4,Z<q[2]?q[1]+Z:-1)}if(q[1])for(de=0;de<q[1];++de){for(;Z<236+de*127;++Z)K.write_shift(-4,Z<q[2]?q[1]+Z:-1);K.write_shift(-4,de===q[1]-1?V:de+1)}var Ae=function(qe){for(de+=qe;Z<de-1;++Z)K.write_shift(-4,Z+1);qe&&(++Z,K.write_shift(-4,V))};for(de=Z=0,de+=q[1];Z<de;++Z)K.write_shift(-4,ee.DIFSECT);for(de+=q[2];Z<de;++Z)K.write_shift(-4,ee.FATSECT);Ae(q[3]),Ae(q[4]);for(var me=0,xe=0,ge=L.FileIndex[0];me<L.FileIndex.length;++me)ge=L.FileIndex[me],ge.content&&(xe=ge.content.length,!(xe<4096)&&(ge.start=de,Ae(xe+511>>9)));for(Ae(q[6]+7>>3);K.l&511;)K.write_shift(-4,ee.ENDOFCHAIN);for(de=Z=0,me=0;me<L.FileIndex.length;++me)ge=L.FileIndex[me],ge.content&&(xe=ge.content.length,!(!xe||xe>=4096)&&(ge.start=de,Ae(xe+63>>6)));for(;K.l&511;)K.write_shift(-4,ee.ENDOFCHAIN);for(Z=0;Z<q[4]<<2;++Z){var Le=L.FullPaths[Z];if(!Le||Le.length===0){for(me=0;me<17;++me)K.write_shift(4,0);for(me=0;me<3;++me)K.write_shift(4,-1);for(me=0;me<12;++me)K.write_shift(4,0);continue}ge=L.FileIndex[Z],Z===0&&(ge.start=ge.size?ge.start-1:V);var Ve=Z===0&&H.root||ge.name;if(xe=2*(Ve.length+1),K.write_shift(64,Ve,"utf16le"),K.write_shift(2,xe),K.write_shift(1,ge.type),K.write_shift(1,ge.color),K.write_shift(-4,ge.L),K.write_shift(-4,ge.R),K.write_shift(-4,ge.C),ge.clsid)K.write_shift(16,ge.clsid,"hex");else for(me=0;me<4;++me)K.write_shift(4,0);K.write_shift(4,ge.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,ge.start),K.write_shift(4,ge.size),K.write_shift(4,0)}for(Z=1;Z<L.FileIndex.length;++Z)if(ge=L.FileIndex[Z],ge.size>=4096)if(K.l=ge.start+1<<9,At&&Buffer.isBuffer(ge.content))ge.content.copy(K,K.l,0,ge.size),K.l+=ge.size+511&-512;else{for(me=0;me<ge.size;++me)K.write_shift(1,ge.content[me]);for(;me&511;++me)K.write_shift(1,0)}for(Z=1;Z<L.FileIndex.length;++Z)if(ge=L.FileIndex[Z],ge.size>0&&ge.size<4096)if(At&&Buffer.isBuffer(ge.content))ge.content.copy(K,K.l,0,ge.size),K.l+=ge.size+63&-64;else{for(me=0;me<ge.size;++me)K.write_shift(1,ge.content[me]);for(;me&63;++me)K.write_shift(1,0)}if(At)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function F(L,Q){var H=L.FullPaths.map(function(me){return me.toUpperCase()}),q=H.map(function(me){var xe=me.split("/");return xe[xe.length-(me.slice(-1)=="/"?2:1)]}),K=!1;Q.charCodeAt(0)===47?(K=!0,Q=H[0].slice(0,-1)+Q):K=Q.indexOf("/")!==-1;var Z=Q.toUpperCase(),de=K===!0?H.indexOf(Z):q.indexOf(Z);if(de!==-1)return L.FileIndex[de];var Ae=!Z.match(Xf);for(Z=Z.replace(Zn,""),Ae&&(Z=Z.replace(Xf,"!")),de=0;de<H.length;++de)if((Ae?H[de].replace(Xf,"!"):H[de]).replace(Zn,"")==Z||(Ae?q[de].replace(Xf,"!"):q[de]).replace(Zn,"")==Z)return L.FileIndex[de];return null}var P=64,V=-2,Ee="d0cf11e0a1b11ae1",we=[208,207,17,224,161,177,26,225],ie="00000000000000000000000000000000",ee={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:Ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ye(L,Q,H){d();var q=M(L,H);f.writeFileSync(Q,q)}function ae(L){for(var Q=new Array(L.length),H=0;H<L.length;++H)Q[H]=String.fromCharCode(L[H]);return Q.join("")}function Me(L,Q){var H=M(L,Q);switch(Q&&Q.type||"buffer"){case"file":return d(),f.writeFileSync(Q.filename,H),H;case"binary":return typeof H=="string"?H:ae(H);case"base64":return _0(typeof H=="string"?H:ae(H));case"buffer":if(At)return Buffer.isBuffer(H)?H:Bi(H);case"array":return typeof H=="string"?Ca(H):H}return H}var Y;function j(L){try{var Q=L.InflateRaw,H=new Q;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)Y=L;else throw new Error("zlib does not expose bytesRead")}catch(q){console.error("cannot use native zlib: "+(q.message||q))}}function X(L,Q){if(!Y)return ss(L,Q);var H=Y.InflateRaw,q=new H,K=q._processChunk(L.slice(L.l),q._finishFlushFlag);return L.l+=q.bytesRead,K}function J(L){return Y?Y.deflateRawSync(L):mt(L)}var ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Re(L){var Q=(L<<1|L<<11)&139536|(L<<5|L<<15)&558144;return(Q>>16|Q>>8|Q)&255}for(var Ce=typeof Uint8Array<"u",Fe=Ce?new Uint8Array(256):[],st=0;st<256;++st)Fe[st]=Re(st);function te(L,Q){var H=Fe[L&255];return Q<=8?H>>>8-Q:(H=H<<8|Fe[L>>8&255],Q<=16?H>>>16-Q:(H=H<<8|Fe[L>>16&255],H>>>24-Q))}function Ct(L,Q){var H=Q&7,q=Q>>>3;return(L[q]|(H<=6?0:L[q+1]<<8))>>>H&3}function lt(L,Q){var H=Q&7,q=Q>>>3;return(L[q]|(H<=5?0:L[q+1]<<8))>>>H&7}function It(L,Q){var H=Q&7,q=Q>>>3;return(L[q]|(H<=4?0:L[q+1]<<8))>>>H&15}function ht(L,Q){var H=Q&7,q=Q>>>3;return(L[q]|(H<=3?0:L[q+1]<<8))>>>H&31}function le(L,Q){var H=Q&7,q=Q>>>3;return(L[q]|(H<=1?0:L[q+1]<<8))>>>H&127}function Qe(L,Q,H){var q=Q&7,K=Q>>>3,Z=(1<<H)-1,de=L[K]>>>q;return H<8-q||(de|=L[K+1]<<8-q,H<16-q)||(de|=L[K+2]<<16-q,H<24-q)||(de|=L[K+3]<<24-q),de&Z}function Be(L,Q,H){var q=Q&7,K=Q>>>3;return q<=5?L[K]|=(H&7)<<q:(L[K]|=H<<q&255,L[K+1]=(H&7)>>8-q),Q+3}function Ye(L,Q,H){var q=Q&7,K=Q>>>3;return H=(H&1)<<q,L[K]|=H,Q+1}function et(L,Q,H){var q=Q&7,K=Q>>>3;return H<<=q,L[K]|=H&255,H>>>=8,L[K+1]=H,Q+8}function Et(L,Q,H){var q=Q&7,K=Q>>>3;return H<<=q,L[K]|=H&255,H>>>=8,L[K+1]=H&255,L[K+2]=H>>>8,Q+16}function zt(L,Q){var H=L.length,q=2*H>Q?2*H:Q+5,K=0;if(H>=Q)return L;if(At){var Z=NT(q);if(L.copy)L.copy(Z);else for(;K<L.length;++K)Z[K]=L[K];return Z}else if(Ce){var de=new Uint8Array(q);if(de.set)de.set(L);else for(;K<H;++K)de[K]=L[K];return de}return L.length=q,L}function Bt(L){for(var Q=new Array(L),H=0;H<L;++H)Q[H]=0;return Q}function Br(L,Q,H){var q=1,K=0,Z=0,de=0,Ae=0,me=L.length,xe=Ce?new Uint16Array(32):Bt(32);for(Z=0;Z<32;++Z)xe[Z]=0;for(Z=me;Z<H;++Z)L[Z]=0;me=L.length;var ge=Ce?new Uint16Array(me):Bt(me);for(Z=0;Z<me;++Z)xe[K=L[Z]]++,q<K&&(q=K),ge[Z]=0;for(xe[0]=0,Z=1;Z<=q;++Z)xe[Z+16]=Ae=Ae+xe[Z-1]<<1;for(Z=0;Z<me;++Z)Ae=L[Z],Ae!=0&&(ge[Z]=xe[Ae+16]++);var Le=0;for(Z=0;Z<me;++Z)if(Le=L[Z],Le!=0)for(Ae=te(ge[Z],q)>>q-Le,de=(1<<q+4-Le)-1;de>=0;--de)Q[Ae|de<<Le]=Le&15|Z<<4;return q}var Nn=Ce?new Uint16Array(512):Bt(512),pa=Ce?new Uint16Array(32):Bt(32);if(!Ce){for(var dr=0;dr<512;++dr)Nn[dr]=0;for(dr=0;dr<32;++dr)pa[dr]=0}(function(){for(var L=[],Q=0;Q<32;Q++)L.push(5);Br(L,pa,32);var H=[];for(Q=0;Q<=143;Q++)H.push(8);for(;Q<=255;Q++)H.push(9);for(;Q<=279;Q++)H.push(7);for(;Q<=287;Q++)H.push(8);Br(H,Nn,288)})();var Rn=(function(){for(var Q=Ce?new Uint8Array(32768):[],H=0,q=0;H<Te.length-1;++H)for(;q<Te[H+1];++q)Q[q]=H;for(;q<32768;++q)Q[q]=29;var K=Ce?new Uint8Array(259):[];for(H=0,q=0;H<ue.length-1;++H)for(;q<ue[H+1];++q)K[q]=H;function Z(Ae,me){for(var xe=0;xe<Ae.length;){var ge=Math.min(65535,Ae.length-xe),Le=xe+ge==Ae.length;for(me.write_shift(1,+Le),me.write_shift(2,ge),me.write_shift(2,~ge&65535);ge-- >0;)me[me.l++]=Ae[xe++]}return me.l}function de(Ae,me){for(var xe=0,ge=0,Le=Ce?new Uint16Array(32768):[];ge<Ae.length;){var Ve=Math.min(65535,Ae.length-ge);if(Ve<10){for(xe=Be(me,xe,+(ge+Ve==Ae.length)),xe&7&&(xe+=8-(xe&7)),me.l=xe/8|0,me.write_shift(2,Ve),me.write_shift(2,~Ve&65535);Ve-- >0;)me[me.l++]=Ae[ge++];xe=me.l*8;continue}xe=Be(me,xe,+(ge+Ve==Ae.length)+2);for(var qe=0;Ve-- >0;){var je=Ae[ge];qe=(qe<<5^je)&32767;var Ge=-1,Ze=0;if((Ge=Le[qe])&&(Ge|=ge&-32768,Ge>ge&&(Ge-=32768),Ge<ge))for(;Ae[Ge+Ze]==Ae[ge+Ze]&&Ze<250;)++Ze;if(Ze>2){je=K[Ze],je<=22?xe=et(me,xe,Fe[je+1]>>1)-1:(et(me,xe,3),xe+=5,et(me,xe,Fe[je-23]>>5),xe+=3);var Qt=je<8?0:je-4>>2;Qt>0&&(Et(me,xe,Ze-ue[je]),xe+=Qt),je=Q[ge-Ge],xe=et(me,xe,Fe[je]>>3),xe-=3;var Jt=je<4?0:je-2>>1;Jt>0&&(Et(me,xe,ge-Ge-Te[je]),xe+=Jt);for(var fr=0;fr<Ze;++fr)Le[qe]=ge&32767,qe=(qe<<5^Ae[ge])&32767,++ge;Ve-=Ze-1}else je<=143?je=je+48:xe=Ye(me,xe,1),xe=et(me,xe,Fe[je]),Le[qe]=ge&32767,++ge}xe=et(me,xe,0)-1}return me.l=(xe+7)/8|0,me.l}return function(me,xe){return me.length<8?Z(me,xe):de(me,xe)}})();function mt(L){var Q=Se(50+Math.floor(L.length*1.1)),H=Rn(L,Q);return Q.slice(0,H)}var Kt=Ce?new Uint16Array(32768):Bt(32768),Ir=Ce?new Uint16Array(32768):Bt(32768),Tt=Ce?new Uint16Array(128):Bt(128),Yt=1,Dr=1;function gr(L,Q){var H=ht(L,Q)+257;Q+=5;var q=ht(L,Q)+1;Q+=5;var K=It(L,Q)+4;Q+=4;for(var Z=0,de=Ce?new Uint8Array(19):Bt(19),Ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],me=1,xe=Ce?new Uint8Array(8):Bt(8),ge=Ce?new Uint8Array(8):Bt(8),Le=de.length,Ve=0;Ve<K;++Ve)de[ne[Ve]]=Z=lt(L,Q),me<Z&&(me=Z),xe[Z]++,Q+=3;var qe=0;for(xe[0]=0,Ve=1;Ve<=me;++Ve)ge[Ve]=qe=qe+xe[Ve-1]<<1;for(Ve=0;Ve<Le;++Ve)(qe=de[Ve])!=0&&(Ae[Ve]=ge[qe]++);var je=0;for(Ve=0;Ve<Le;++Ve)if(je=de[Ve],je!=0){qe=Fe[Ae[Ve]]>>8-je;for(var Ge=(1<<7-je)-1;Ge>=0;--Ge)Tt[qe|Ge<<je]=je&7|Ve<<3}var Ze=[];for(me=1;Ze.length<H+q;)switch(qe=Tt[le(L,Q)],Q+=qe&7,qe>>>=3){case 16:for(Z=3+Ct(L,Q),Q+=2,qe=Ze[Ze.length-1];Z-- >0;)Ze.push(qe);break;case 17:for(Z=3+lt(L,Q),Q+=3;Z-- >0;)Ze.push(0);break;case 18:for(Z=11+le(L,Q),Q+=7;Z-- >0;)Ze.push(0);break;default:Ze.push(qe),me<qe&&(me=qe);break}var Qt=Ze.slice(0,H),Jt=Ze.slice(H);for(Ve=H;Ve<286;++Ve)Qt[Ve]=0;for(Ve=q;Ve<30;++Ve)Jt[Ve]=0;return Yt=Br(Qt,Kt,286),Dr=Br(Jt,Ir,30),Q}function zi(L,Q){if(L[0]==3&&!(L[1]&3))return[Yl(Q),2];for(var H=0,q=0,K=NT(Q||1<<18),Z=0,de=K.length>>>0,Ae=0,me=0;(q&1)==0;){if(q=lt(L,H),H+=3,q>>>1)q>>1==1?(Ae=9,me=5):(H=gr(L,H),Ae=Yt,me=Dr);else{H&7&&(H+=8-(H&7));var xe=L[H>>>3]|L[(H>>>3)+1]<<8;if(H+=32,xe>0)for(!Q&&de<Z+xe&&(K=zt(K,Z+xe),de=K.length);xe-- >0;)K[Z++]=L[H>>>3],H+=8;continue}for(;;){!Q&&de<Z+32767&&(K=zt(K,Z+32767),de=K.length);var ge=Qe(L,H,Ae),Le=q>>>1==1?Nn[ge]:Kt[ge];if(H+=Le&15,Le>>>=4,(Le>>>8&255)===0)K[Z++]=Le;else{if(Le==256)break;Le-=257;var Ve=Le<8?0:Le-4>>2;Ve>5&&(Ve=0);var qe=Z+ue[Le];Ve>0&&(qe+=Qe(L,H,Ve),H+=Ve),ge=Qe(L,H,me),Le=q>>>1==1?pa[ge]:Ir[ge],H+=Le&15,Le>>>=4;var je=Le<4?0:Le-2>>1,Ge=Te[Le];for(je>0&&(Ge+=Qe(L,H,je),H+=je),!Q&&de<qe&&(K=zt(K,qe+100),de=K.length);Z<qe;)K[Z]=K[Z-Ge],++Z}}}return Q?[K,H+7>>>3]:[K.slice(0,Z),H+7>>>3]}function ss(L,Q){var H=L.slice(L.l||0),q=zi(H,Q);return L.l+=q[1],q[0]}function ei(L,Q){if(L)typeof console<"u"&&console.error(Q);else throw new Error(Q)}function ea(L,Q){var H=L;Sn(H,0);var q=[],K=[],Z={FileIndex:q,FullPaths:K};A(Z,{root:Q.root});for(var de=H.length-4;(H[de]!=80||H[de+1]!=75||H[de+2]!=5||H[de+3]!=6)&&de>=0;)--de;H.l=de+4,H.l+=4;var Ae=H.read_shift(2);H.l+=6;var me=H.read_shift(4);for(H.l=me,de=0;de<Ae;++de){H.l+=20;var xe=H.read_shift(4),ge=H.read_shift(4),Le=H.read_shift(2),Ve=H.read_shift(2),qe=H.read_shift(2);H.l+=8;var je=H.read_shift(4),Ge=u(H.slice(H.l+Le,H.l+Le+Ve));H.l+=Le+Ve+qe;var Ze=H.l;H.l=je+4,Fa(H,xe,ge,Z,Ge),H.l=Ze}return Z}function Fa(L,Q,H,q,K){L.l+=2;var Z=L.read_shift(2),de=L.read_shift(2),Ae=o(L);if(Z&8257)throw new Error("Unsupported ZIP encryption");for(var me=L.read_shift(4),xe=L.read_shift(4),ge=L.read_shift(4),Le=L.read_shift(2),Ve=L.read_shift(2),qe="",je=0;je<Le;++je)qe+=String.fromCharCode(L[L.l++]);if(Ve){var Ge=u(L.slice(L.l,L.l+Ve));(Ge[21589]||{}).mt&&(Ae=Ge[21589].mt),((K||{})[21589]||{}).mt&&(Ae=K[21589].mt)}L.l+=Ve;var Ze=L.slice(L.l,L.l+xe);switch(de){case 8:Ze=X(L,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Qt=!1;Z&8&&(me=L.read_shift(4),me==134695760&&(me=L.read_shift(4),Qt=!0),xe=L.read_shift(4),ge=L.read_shift(4)),xe!=Q&&ei(Qt,"Bad compressed size: "+Q+" != "+xe),ge!=H&&ei(Qt,"Bad uncompressed size: "+H+" != "+ge),ni(q,qe,Ze,{unsafe:!0,mt:Ae})}function Er(L,Q){var H=Q||{},q=[],K=[],Z=Se(1),de=H.compression?8:0,Ae=0,me=0,xe=0,ge=0,Le=0,Ve=L.FullPaths[0],qe=Ve,je=L.FileIndex[0],Ge=[],Ze=0;for(me=1;me<L.FullPaths.length;++me)if(qe=L.FullPaths[me].slice(Ve.length),je=L.FileIndex[me],!(!je.size||!je.content||qe=="Sh33tJ5")){var Qt=ge,Jt=Se(qe.length);for(xe=0;xe<qe.length;++xe)Jt.write_shift(1,qe.charCodeAt(xe)&127);Jt=Jt.slice(0,Jt.l),Ge[Le]=R7.buf(je.content,0);var fr=je.content;de==8&&(fr=J(fr)),Z=Se(30),Z.write_shift(4,67324752),Z.write_shift(2,20),Z.write_shift(2,Ae),Z.write_shift(2,de),je.mt?i(Z,je.mt):Z.write_shift(4,0),Z.write_shift(-4,Ge[Le]),Z.write_shift(4,fr.length),Z.write_shift(4,je.content.length),Z.write_shift(2,Jt.length),Z.write_shift(2,0),ge+=Z.length,q.push(Z),ge+=Jt.length,q.push(Jt),ge+=fr.length,q.push(fr),Z=Se(46),Z.write_shift(4,33639248),Z.write_shift(2,0),Z.write_shift(2,20),Z.write_shift(2,Ae),Z.write_shift(2,de),Z.write_shift(4,0),Z.write_shift(-4,Ge[Le]),Z.write_shift(4,fr.length),Z.write_shift(4,je.content.length),Z.write_shift(2,Jt.length),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(4,0),Z.write_shift(4,Qt),Ze+=Z.l,K.push(Z),Ze+=Jt.length,K.push(Jt),++Le}return Z=Se(22),Z.write_shift(4,101010256),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(2,Le),Z.write_shift(2,Le),Z.write_shift(4,Ze),Z.write_shift(4,ge),Z.write_shift(2,0),gn([gn(q),gn(K),Z])}var Or={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ga(L,Q){if(L.ctype)return L.ctype;var H=L.name||"",q=H.match(/\.([^\.]+)$/);return q&&Or[q[1]]||Q&&(q=(H=Q).match(/[\.\\]([^\.\\])+$/),q&&Or[q[1]])?Or[q[1]]:"application/octet-stream"}function Xn(L){for(var Q=_0(L),H=[],q=0;q<Q.length;q+=76)H.push(Q.slice(q,q+76));return H.join(`\r
`)+`\r
`}function Vu(L){var Q=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var ge=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});Q=Q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Q.charAt(0)==`
`&&(Q="=0D"+Q.slice(1)),Q=Q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],q=Q.split(`\r
`),K=0;K<q.length;++K){var Z=q[K];if(Z.length==0){H.push("");continue}for(var de=0;de<Z.length;){var Ae=76,me=Z.slice(de,de+Ae);me.charAt(Ae-1)=="="?Ae--:me.charAt(Ae-2)=="="?Ae-=2:me.charAt(Ae-3)=="="&&(Ae-=3),me=Z.slice(de,de+Ae),de+=Ae,de<Z.length&&(me+="="),H.push(me)}}return H.join(`\r
`)}function dc(L){for(var Q=[],H=0;H<L.length;++H){for(var q=L[H];H<=L.length&&q.charAt(q.length-1)=="=";)q=q.slice(0,q.length-1)+L[++H];Q.push(q)}for(var K=0;K<Q.length;++K)Q[K]=Q[K].replace(/[=][0-9A-Fa-f]{2}/g,function(Z){return String.fromCharCode(parseInt(Z.slice(1),16))});return Ca(Q.join(`\r
`))}function Ma(L,Q,H){for(var q="",K="",Z="",de,Ae=0;Ae<10;++Ae){var me=Q[Ae];if(!me||me.match(/^\s*$/))break;var xe=me.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":q=xe[2].trim();break;case"content-type":Z=xe[2].trim();break;case"content-transfer-encoding":K=xe[2].trim();break}}switch(++Ae,K.toLowerCase()){case"base64":de=Ca(Oa(Q.slice(Ae).join("")));break;case"quoted-printable":de=dc(Q.slice(Ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var ge=ni(L,q.slice(H.length),de,{unsafe:!0});Z&&(ge.ctype=Z)}function ti(L,Q){if(ae(L.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=Q&&Q.root||"",q=(At&&Buffer.isBuffer(L)?L.toString("binary"):ae(L)).split(`\r
`),K=0,Z="";for(K=0;K<q.length;++K)if(Z=q[K],!!/^Content-Location:/i.test(Z)&&(Z=Z.slice(Z.indexOf("file")),H||(H=Z.slice(0,Z.lastIndexOf("/")+1)),Z.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),Z.slice(0,H.length)!=H););var de=(q[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var Ae="--"+(de[1]||""),me=[],xe=[],ge={FileIndex:me,FullPaths:xe};A(ge);var Le,Ve=0;for(K=0;K<q.length;++K){var qe=q[K];qe!==Ae&&qe!==Ae+"--"||(Ve++&&Ma(ge,q.slice(Le,K),H),Le=K)}return ge}function Uu(L,Q){var H=Q||{},q=H.boundary||"SheetJS";q="------="+q;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+q.slice(2)+'"',"","",""],Z=L.FullPaths[0],de=Z,Ae=L.FileIndex[0],me=1;me<L.FullPaths.length;++me)if(de=L.FullPaths[me].slice(Z.length),Ae=L.FileIndex[me],!(!Ae.size||!Ae.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ze){return"_x"+Ze.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ze){return"_u"+Ze.charCodeAt(0).toString(16)+"_"});for(var xe=Ae.content,ge=At&&Buffer.isBuffer(xe)?xe.toString("binary"):ae(xe),Le=0,Ve=Math.min(1024,ge.length),qe=0,je=0;je<=Ve;++je)(qe=ge.charCodeAt(je))>=32&&qe<128&&++Le;var Ge=Le>=Ve*4/5;K.push(q),K.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+de),K.push("Content-Transfer-Encoding: "+(Ge?"quoted-printable":"base64")),K.push("Content-Type: "+ga(Ae,de)),K.push(""),K.push(Ge?Vu(ge):Xn(ge))}return K.push(q+`--\r
`),K.join(`\r
`)}function ri(L){var Q={};return A(Q,L),Q}function ni(L,Q,H,q){var K=q&&q.unsafe;K||A(L);var Z=!K&&nt.find(L,Q);if(!Z){var de=L.FullPaths[0];Q.slice(0,de.length)==de?de=Q:(de.slice(-1)!="/"&&(de+="/"),de=(de+Q).replace("//","/")),Z={name:a(Q),type:2},L.FileIndex.push(Z),L.FullPaths.push(de),K||nt.utils.cfb_gc(L)}return Z.content=H,Z.size=H?H.length:0,q&&(q.CLSID&&(Z.clsid=q.CLSID),q.mt&&(Z.mt=q.mt),q.ct&&(Z.ct=q.ct)),Z}function io(L,Q){A(L);var H=nt.find(L,Q);if(H){for(var q=0;q<L.FileIndex.length;++q)if(L.FileIndex[q]==H)return L.FileIndex.splice(q,1),L.FullPaths.splice(q,1),!0}return!1}function ai(L,Q,H){A(L);var q=nt.find(L,Q);if(q){for(var K=0;K<L.FileIndex.length;++K)if(L.FileIndex[K]==q)return L.FileIndex[K].name=a(H),L.FullPaths[K]=H,!0}return!1}function is(L){N(L,!0)}return e.find=F,e.read=B,e.parse=m,e.write=Me,e.writeFile=ye,e.utils={cfb_new:ri,cfb_add:ni,cfb_del:io,cfb_mov:ai,cfb_gc:is,ReadShift:t0,CheckField:jC,prep_blob:Sn,bconcat:gn,use_zlib:j,_deflateRaw:mt,_inflateRaw:ss,consts:ee},e})();function I7(t){return typeof t=="string"?Ep(t):Array.isArray(t)?n7(t):t}function ah(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Ep(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Hs(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([I7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=no(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function D7(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Lr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function jT(t,e){for(var r=[],n=Lr(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function Sp(t){for(var e=[],r=Lr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Ap(t){for(var e=[],r=Lr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function O7(t){for(var e=[],r=Lr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Lm=new Date(1899,11,30,0,0,0);function fn(t,e){var r=t.getTime(),n=Lm.getTime()+(t.getTimezoneOffset()-Lm.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var gC=new Date,F7=Lm.getTime()+(gC.getTimezoneOffset()-Lm.getTimezoneOffset())*6e4,LT=gC.getTimezoneOffset();function kp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+F7),e.getTimezoneOffset()!==LT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-LT)*6e4),e}function M7(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[i],10)}return e}var BT=new Date("2017-02-19T19:06:09.000Z"),xC=isNaN(BT.getFullYear())?new Date("2/19/17"):BT,P7=xC.getFullYear()==2017;function wr(t,e){var r=new Date(t);if(P7)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(xC.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Jo(t,e){if(At&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Hs(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Hs(aC(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Hs(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Hs(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function br(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=br(t[r]));return e}function Pr(t,e){for(var r="";r.length<e;)r+=t;return r}function Es(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var j7=["january","february","march","april","may","june","july","august","september","october","november","december"];function Eu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&j7.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var L7=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],u=1;u<i.length;++u)o.push(a),o.push(i[u]);return o}})();function vC(t){return t?t.content&&t.type?Jo(t.content,!0):t.data?Wf(t.data):t.asNodeBuffer&&At?Wf(t.asNodeBuffer().toString("binary")):t.asBinary?Wf(t.asBinary()):t._data&&t._data.getContent?Wf(Jo(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function yC(t){if(!t)return null;if(t.data)return kT(t.data);if(t.asNodeBuffer&&At)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?kT(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function B7(t){return t&&t.name.slice(-4)===".bin"?yC(t):vC(t)}function Qa(t,e){for(var r=t.FullPaths||Lr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function by(t,e){var r=Qa(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function tn(t,e,r){if(!r)return B7(by(t,e));if(!e)return null;try{return tn(t,e)}catch{return null}}function Na(t,e,r){if(!r)return vC(by(t,e));if(!e)return null;try{return Na(t,e)}catch{return null}}function V7(t,e,r){return yC(by(t,e))}function VT(t){for(var e=t.FullPaths||Lr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function bt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return At?n=Bi(r):n=a7(r),nt.utils.cfb_add(t,e,n)}nt.utils.cfb_add(t,e,r)}else t.file(e,r)}function Ey(){return nt.utils.cfb_new()}function _C(t,e){switch(e.type){case"base64":return nt.read(t,{type:"base64"});case"binary":return nt.read(t,{type:"binary"});case"buffer":case"array":return nt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Yf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Xr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,U7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,UT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,z7=/<[^>]*>/g,Wn=Xr.match(UT)?UT:z7,H7=/<\w*:/,G7=/<(\/?)\w+:/;function ft(t,e,r){for(var n={},a=0,i=0;a!==t.length&&!((i=t.charCodeAt(a))===32||i===10||i===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var o=t.match(U7),u=0,f="",d=0,m="",x="",y=1;if(o)for(d=0;d!=o.length;++d){for(x=o[d],i=0;i!=x.length&&x.charCodeAt(i)!==61;++i);for(m=x.slice(0,i).trim();x.charCodeAt(i+1)==32;)++i;for(y=(a=x.charCodeAt(i+1))==34||a==39?1:0,f=x.slice(i+1+y,x.length-y),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=f,n[m.toLowerCase()]=f;else{var b=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(n[b]&&m.slice(u-3,u)=="ext")continue;n[b]=f,n[b.toLowerCase()]=f}}return n}function Js(t){return t.replace(G7,"<$1")}var wC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ty=Sp(wC),Vt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(t,function(u,f){return wC[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,f){return String.fromCharCode(parseInt(f,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}})(),Sy=/[&<>'"]/g,q7=/[\u0000-\u0008\u000b-\u001f]/g;function sr(t){var e=t+"";return e.replace(Sy,function(r){return Ty[r]}).replace(q7,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function zT(t){return sr(t).replace(/ /g,"_x0020_")}var bC=/[\u0000-\u001f]/g;function Ay(t){var e=t+"";return e.replace(Sy,function(r){return Ty[r]}).replace(/\n/g,"<br/>").replace(bC,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function W7(t){var e=t+"";return e.replace(Sy,function(r){return Ty[r]}).replace(bC,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var HT=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function X7(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function yr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Q1(t){for(var e="",r=0,n=0,a=0,i=0,o=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function GT(t){var e=Yl(2*t.length),r,n,a=1,i=0,o=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function qT(t){return Bi(t,"binary").toString("utf8")}var Ud="foo bar baz",ur=At&&(qT(Ud)==Q1(Ud)&&qT||GT(Ud)==Q1(Ud)&&GT)||Q1,Hs=At?function(t){return Bi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},b0=(function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),EC=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}})(),Y7=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),$7=/<\/?(?:vt:)?variant>/g,K7=/<(?:vt:)([^>]*)>([\s\S]*)</;function WT(t,e){var r=ft(t),n=t.match(Y7(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace($7,"").match(K7);o&&a.push({v:ur(o[2]),t:o[1]})}),a}var TC=/(^\s|\s$|\n)/;function kn(t,e){return"<"+t+(e.match(TC)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function E0(t){return Lr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ue(t,e,r){return"<"+t+(r!=null?E0(r):"")+(e!=null?(e.match(TC)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Xx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Q7(t,e){switch(typeof t){case"string":var r=Ue("vt:lpwstr",sr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ue((t|0)==t?"vt:i4":"vt:r8",sr(String(t)));case"boolean":return Ue("vt:bool",t?"true":"false")}if(t instanceof Date)return Ue("vt:filetime",Xx(t));throw new Error("Unable to serialize "+t)}function ky(t){if(At&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return ur(no(yy(t)));throw new Error("Bad input format: expected Buffer or string")}var T0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,on={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},lc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Aa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function J7(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,i=5;i>=0;--i)a=a*256+t[e+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Z7(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,i=0,o=n?-e:e;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(e)?26985:0);for(var u=0;u<=5;++u,i/=256)t[r+u]=i&255;t[r+6]=(a&15)<<4|i&15,t[r+7]=a>>4|n}var XT=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,i=t[0][n].length;a<i;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},YT=At?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Bi(e)})):XT(t)}:XT,$T=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(Si(t,a)));return n.join("").replace(Zn,"")},Cy=At?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Zn,""):$T(t,e,r)}:$T,KT=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},SC=At?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):KT(t,e,r)}:KT,QT=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(au(t,a)));return n.join("")},sh=At?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):QT(e,r,n)}:QT,AC=function(t,e){var r=ka(t,e);return r>0?sh(t,e+4,e+4+r-1):""},kC=AC,CC=function(t,e){var r=ka(t,e);return r>0?sh(t,e+4,e+4+r-1):""},NC=CC,RC=function(t,e){var r=2*ka(t,e);return r>0?sh(t,e+4,e+4+r-1):""},IC=RC,DC=function(e,r){var n=ka(e,r);return n>0?Cy(e,r+4,r+4+n):""},OC=DC,FC=function(t,e){var r=ka(t,e);return r>0?sh(t,e+4,e+4+r):""},MC=FC,PC=function(t,e){return J7(t,e)},Bm=PC,Ny=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};At&&(kC=function(e,r){if(!Buffer.isBuffer(e))return AC(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},NC=function(e,r){if(!Buffer.isBuffer(e))return CC(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},IC=function(e,r){if(!Buffer.isBuffer(e))return RC(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},OC=function(e,r){if(!Buffer.isBuffer(e))return DC(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},MC=function(e,r){if(!Buffer.isBuffer(e))return FC(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Bm=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):PC(e,r)},Ny=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var au=function(t,e){return t[e]},Si=function(t,e){return t[e+1]*256+t[e]},eB=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ka=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Oo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},tB=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function t0(t,e){var r="",n,a,i=[],o,u,f,d;switch(e){case"dbcs":if(d=this.l,At&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(Si(this,d)),d+=2;t*=2;break;case"utf8":r=sh(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Cy(this,this.l,this.l+t);break;case"wstr":return t0.call(this,t,"dbcs");case"lpstr-ansi":r=kC(this,this.l),t=4+ka(this,this.l);break;case"lpstr-cp":r=NC(this,this.l),t=4+ka(this,this.l);break;case"lpwstr":r=IC(this,this.l),t=4+2*ka(this,this.l);break;case"lpp4":t=4+ka(this,this.l),r=OC(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ka(this,this.l),r=MC(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=au(this,this.l+t++))!==0;)i.push(Vd(o));r=i.join("");break;case"_wstr":for(t=0,r="";(o=Si(this,this.l+t))!==0;)i.push(Vd(o)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=au(this,d),this.l=d+1,u=t0.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Vd(Si(this,d))),d+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=au(this,d),this.l=d+1,u=t0.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Vd(au(this,d))),d+=1}r=i.join("");break;default:switch(t){case 1:return n=au(this,this.l),this.l++,n;case 2:return n=(e==="i"?eB:Si)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Oo:tB)(this,this.l),this.l+=4,n):(a=ka(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=Bm(this,this.l):a=Bm([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=SC(this,this.l,t);break}}return this.l+=t,r}var rB=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},nB=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},aB=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function sB(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)aB(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,rB(this,e,this.l);break;case 8:if(n=8,r==="f"){Z7(this,e,this.l);break}case 16:break;case-4:n=4,nB(this,e,this.l);break}return this.l+=n,this}function jC(t,e){var r=SC(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Sn(t,e){t.l=e,t.read_shift=t0,t.chk=jC,t.write_shift=sB}function qn(t,e){t.l+=e}function Se(t){var e=Yl(t);return Sn(e,0),e}function Vi(t,e,r){if(t){var n,a,i;Sn(t,t.l||0);for(var o=t.length,u=0,f=0;t.l<o;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=R0[u]||R0[65535];for(n=t.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=t.read_shift(1))&127)<<7*a;f=t.l+i;var m=d.f&&d.f(t,i,r);if(t.l=f,e(m,d,u))return}}}function da(){var t=[],e=At?256:2048,r=function(d){var m=Se(d);return Sn(m,0),m},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,e)))},o=function(){return a(),gn(t)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:u,end:o,_bufs:t}}function Pe(t,e,r,n){var a=+e,i;if(!isNaN(a)){n||(n=R0[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=t.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Ny(r)&&t.push(r)}}function r0(t,e,r){var n=br(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function JT(t,e,r){var n=br(t);return n.s=r0(n.s,e.s,r),n.e=r0(n.e,e.s,r),n}function n0(t,e){if(t.cRel&&t.c<0)for(t=br(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=br(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ct(t);return!t.cRel&&t.cRel!=null&&(r=oB(r)),!t.rRel&&t.rRel!=null&&(r=iB(r)),r}function J1(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Cr(t.s.c)+":"+(t.e.cRel?"":"$")+Cr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Wr(t.s.r)+":"+(t.e.rRel?"":"$")+Wr(t.e.r):n0(t.s,e.biff)+":"+n0(t.e,e.biff)}function Ry(t){return parseInt(lB(t),10)-1}function Wr(t){return""+(t+1)}function iB(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function lB(t){return t.replace(/\$(\d+)$/,"$1")}function Iy(t){for(var e=cB(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Cr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function oB(t){return t.replace(/^([A-Z])/,"$$$1")}function cB(t){return t.replace(/^\$([A-Z])/,"$1")}function uB(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Nr(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function ct(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ma(t){var e=t.indexOf(":");return e==-1?{s:Nr(t),e:Nr(t)}:{s:Nr(t.slice(0,e)),e:Nr(t.slice(e+1))}}function _t(t,e){return typeof e>"u"||typeof e=="number"?_t(t.s,t.e):(typeof t!="string"&&(t=ct(t)),typeof e!="string"&&(e=ct(e)),t==e?t:t+":"+e)}function Ut(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=t.length;for(r=0;n<i&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<i&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===i||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=i&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function ZT(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=rs(t.z,r?fn(e):e)}catch{}try{return t.w=rs((t.XF||{}).numFmtId||(r?14:0),r?fn(e):e)}catch{return""+e}}function ji(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ui[t.v]||t.v:e==null?ZT(t,t.v):ZT(t,e))}function ao(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function LC(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,i=t||(a?[]:{}),o=0,u=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?Nr(n.origin):n.origin;o=f.r,u=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var m=Ut(i["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),o==-1&&(d.e.r=o=m.e.r+1)}for(var x=0;x!=e.length;++x)if(e[x]){if(!Array.isArray(e[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=e[x].length;++y)if(!(typeof e[x][y]>"u")){var b={v:e[x][y]},E=o+x,w=u+y;if(d.s.r>E&&(d.s.r=E),d.s.c>w&&(d.s.c=w),d.e.r<E&&(d.e.r=E),d.e.c<w&&(d.e.c=w),e[x][y]&&typeof e[x][y]=="object"&&!Array.isArray(e[x][y])&&!(e[x][y]instanceof Date))b=e[x][y];else if(Array.isArray(b.v)&&(b.f=e[x][y][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(n.nullError)b.t="e",b.v=0;else if(n.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?b.t="n":typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=n.dateNF||ot[14],n.cellDates?(b.t="d",b.w=rs(b.z,fn(b.v))):(b.t="n",b.v=fn(b.v),b.w=rs(b.z,b.v))):b.t="s";if(a)i[E]||(i[E]=[]),i[E][w]&&i[E][w].z&&(b.z=i[E][w].z),i[E][w]=b;else{var T=ct({c:w,r:E});i[T]&&i[T].z&&(b.z=i[T].z),i[T]=b}}}return d.s.c<1e7&&(i["!ref"]=_t(d)),i}function Lu(t,e){return LC(null,t,e)}function fB(t){return t.read_shift(4,"i")}function Ts(t,e){return e||(e=Se(4)),e.write_shift(4,t),e}function Hn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function xn(t,e){var r=!1;return e==null&&(r=!0,e=Se(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function hB(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function dB(t,e){return e||(e=Se(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Dy(t,e){var r=t.l,n=t.read_shift(1),a=Hn(t),i=[],o={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)i.push(hB(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function mB(t,e){var r=!1;return e==null&&(r=!0,e=Se(15+4*t.t.length)),e.write_shift(1,0),xn(t.t,e),r?e.slice(0,e.l):e}var pB=Dy;function gB(t,e){var r=!1;return e==null&&(r=!0,e=Se(23+4*t.t.length)),e.write_shift(1,1),xn(t.t,e),e.write_shift(4,1),dB({},e),r?e.slice(0,e.l):e}function as(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function oc(t,e){return e==null&&(e=Se(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function cc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function uc(t,e){return e==null&&(e=Se(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var xB=Hn,BC=xn;function Oy(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Vm(t,e){var r=!1;return e==null&&(r=!0,e=Se(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var vB=Hn,Yx=Oy,Fy=Vm;function My(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?Bm([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Oo(e,0)>>2;return r?a/100:a}function VC(t,e){e==null&&(e=Se(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function UC(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function yB(t,e){return e||(e=Se(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var fc=UC,Bu=yB;function zn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Zo(t,e){return(e||Se(8)).write_shift(8,t,"f")}function _B(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=Bo[a];d&&(e.rgb=A0(d));break;case 2:e.rgb=A0([o,u,f]);break;case 3:e.theme=a;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function Um(t,e){if(e||(e=Se(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function wB(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function bB(t,e){e||(e=Se(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function zC(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function EB(t){return zC(t,1)}function TB(t){return zC(t,2)}var Py=2,oa=3,zd=11,eS=12,zm=19,Hd=64,SB=65,AB=71,kB=4108,CB=4126,pn=80,HC=81,NB=[pn,HC],$x={1:{n:"CodePage",t:Py},2:{n:"Category",t:pn},3:{n:"PresentationFormat",t:pn},4:{n:"ByteCount",t:oa},5:{n:"LineCount",t:oa},6:{n:"ParagraphCount",t:oa},7:{n:"SlideCount",t:oa},8:{n:"NoteCount",t:oa},9:{n:"HiddenCount",t:oa},10:{n:"MultimediaClipCount",t:oa},11:{n:"ScaleCrop",t:zd},12:{n:"HeadingPairs",t:kB},13:{n:"TitlesOfParts",t:CB},14:{n:"Manager",t:pn},15:{n:"Company",t:pn},16:{n:"LinksUpToDate",t:zd},17:{n:"CharacterCount",t:oa},19:{n:"SharedDoc",t:zd},22:{n:"HyperlinksChanged",t:zd},23:{n:"AppVersion",t:oa,p:"version"},24:{n:"DigSig",t:SB},26:{n:"ContentType",t:pn},27:{n:"ContentStatus",t:pn},28:{n:"Language",t:pn},29:{n:"Version",t:pn},255:{},2147483648:{n:"Locale",t:zm},2147483651:{n:"Behavior",t:zm},1919054434:{}},Kx={1:{n:"CodePage",t:Py},2:{n:"Title",t:pn},3:{n:"Subject",t:pn},4:{n:"Author",t:pn},5:{n:"Keywords",t:pn},6:{n:"Comments",t:pn},7:{n:"Template",t:pn},8:{n:"LastAuthor",t:pn},9:{n:"RevNumber",t:pn},10:{n:"EditTime",t:Hd},11:{n:"LastPrinted",t:Hd},12:{n:"CreatedDate",t:Hd},13:{n:"ModifiedDate",t:Hd},14:{n:"PageCount",t:oa},15:{n:"WordCount",t:oa},16:{n:"CharCount",t:oa},17:{n:"Thumbnail",t:AB},18:{n:"Application",t:pn},19:{n:"DocSecurity",t:oa},255:{},2147483648:{n:"Locale",t:zm},2147483651:{n:"Behavior",t:zm},1919054434:{}},tS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},RB=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function IB(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var DB=IB([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Bo=br(DB),Ui={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},GC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Qx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Gd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function jy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function OB(t){var e=jy();if(!t||!t.match)return e;var r={};if((t.match(Wn)||[]).forEach(function(n){var a=ft(n);switch(a[0].replace(H7,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[Qx[a.ContentType]]!==void 0&&e[Qx[a.ContentType]].push(a.PartName);break}}),e.xmlns!==on.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function qC(t,e){var r=O7(Qx),n=[],a;n[n.length]=Xr,n[n.length]=Ue("Types",null,{xmlns:on.CT,"xmlns:xsd":on.xsd,"xmlns:xsi":on.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Ue("Default",null,{Extension:f[0],ContentType:f[1]})}));var i=function(f){t[f]&&t[f].length>0&&(a=t[f][0],n[n.length]=Ue("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Gd[f][e.bookType]||Gd[f].xlsx}))},o=function(f){(t[f]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Gd[f][e.bookType]||Gd[f].xlsx})})},u=function(f){(t[f]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return i("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var kt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function S0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function a0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Wn)||[]).forEach(function(a){var i=ft(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var u=i.TargetMode==="External"?i.Target:Yf(i.Target,e);r[u]=o,n[i.Id]=o}}),r["!id"]=n,r}function hu(t){var e=[Xr,Ue("Relationships",null,{xmlns:on.RELS})];return Lr(t["!id"]).forEach(function(r){e[e.length]=Ue("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function nr(t,e,r,n,a,i){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[kt.HLINK,kt.XPATH,kt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var FB="application/vnd.oasis.opendocument.spreadsheet";function MB(t,e){for(var r=ky(t),n,a;n=T0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ft(n[0],!1),a.path=="/"&&a.type!==FB)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function PB(t){var e=[Xr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function rS(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function jB(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function LB(t){var e=[Xr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(rS(t[r][0],t[r][1])),e.push(jB("",t[r][0]));return e.push(rS("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function WC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Fm.version+"</meta:generator></office:meta></office:document-meta>"}var ts=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],BB=(function(){for(var t=new Array(ts.length),e=0;e<ts.length;++e){var r=ts[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function XC(t){var e={};t=ur(t);for(var r=0;r<ts.length;++r){var n=ts[r],a=t.match(BB[r]);a!=null&&a.length>0&&(e[n[1]]=Vt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=wr(e[n[1]]))}return e}function Z1(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=sr(e),n[n.length]=r?Ue(t,e,r):kn(t,e))}function YC(t,e){var r=e||{},n=[Xr,Ue("cp:coreProperties",null,{"xmlns:cp":on.CORE_PROPS,"xmlns:dc":on.dc,"xmlns:dcterms":on.dcterms,"xmlns:dcmitype":on.dcmitype,"xmlns:xsi":on.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Z1("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Xx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&Z1("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Xx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=ts.length;++i){var o=ts[i],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Z1(o[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Vo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],$C=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function KC(t,e,r,n){var a=[];if(typeof t=="string")a=WT(t,n);else for(var i=0;i<t.length;++i)a=a.concat(t[i].map(function(m){return{v:m}}));var o=typeof e=="string"?WT(e,n).map(function(m){return m.v}):e,u=0,f=0;if(o.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=o.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=o.slice(u,u+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=o.slice(u,u+f);break}u+=f}}function VB(t,e,r){var n={};return e||(e={}),t=ur(t),Vo.forEach(function(a){var i=(t.match(b0(a[0]))||[])[1];switch(a[2]){case"string":i&&(e[a[1]]=Vt(i));break;case"bool":e[a[1]]=i==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&KC(n.HeadingPairs,n.TitlesOfParts,e,r),e}function QC(t){var e=[],r=Ue;return t||(t={}),t.Application="SheetJS",e[e.length]=Xr,e[e.length]=Ue("Properties",null,{xmlns:on.EXT_PROPS,"xmlns:vt":on.vt}),Vo.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=sr(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+sr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var UB=/<[^>]+>[^<]*/g;function zB(t,e){var r={},n="",a=t.match(UB);if(a)for(var i=0;i!=a.length;++i){var o=a[i],u=ft(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Vt(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var f=o.split(">"),d=f[0].slice(4),m=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Vt(m);break;case"bool":r[n]=yr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(m);break;case"filetime":case"date":r[n]=wr(m);break;case"cy":case"error":r[n]=Vt(m);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,f)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function JC(t){var e=[Xr,Ue("Properties",null,{xmlns:on.CUST_PROPS,"xmlns:vt":on.vt})];if(!t)return e.join("");var r=1;return Lr(t).forEach(function(a){++r,e[e.length]=Ue("property",Q7(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:sr(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Jx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ex;function HB(t,e,r){ex||(ex=Sp(Jx)),e=ex[e]||e,t[e]=r}function GB(t,e){var r=[];return Lr(Jx).map(function(n){for(var a=0;a<ts.length;++a)if(ts[a][1]==n)return ts[a];for(a=0;a<Vo.length;++a)if(Vo[a][1]==n)return Vo[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(kn(Jx[n[1]]||n[1],a))}}),Ue("DocumentProperties",r.join(""),{xmlns:Aa.o})}function qB(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Lr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<ts.length;++o)if(i==ts[o][1])return;for(o=0;o<Vo.length;++o)if(i==Vo[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var u=t[i],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),a.push(Ue(zT(i),u,{"dt:dt":f}))}}),e&&Lr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=e[i],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Ue(zT(i),o,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Aa.o+'">'+a.join("")+"</"+n+">"}function Ly(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function WB(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var o=Se(8);return o.write_shift(4,n),o.write_shift(4,a),o}function ZC(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function eN(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function tN(t,e,r){return e===31?eN(t):ZC(t,e,r)}function Zx(t,e,r){return tN(t,e,r===!1?0:4)}function XB(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return tN(t,e,0)}function YB(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Zn,""),t.l-a&2&&(t.l+=2)}return r}function $B(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Zn,"");return r}function KB(t){var e=t.l,r=Hm(t,HC);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Hm(t,oa);return[r,n]}function QB(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(KB(t));return r}function nS(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var i=t.read_shift(4),o=t.read_shift(4);n[i]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Zn,"").replace(Xf,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function rN(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function JB(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Hm(t,e,r){var n=t.read_shift(2),a,i=r||{};if(t.l+=2,e!==eS&&n!==e&&NB.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===eS?n:e){case 2:return a=t.read_shift(2,"i"),i.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return ZC(t,n,4).replace(Zn,"");case 31:return eN(t);case 64:return Ly(t);case 65:return rN(t);case 71:return JB(t);case 80:return Zx(t,n,!i.raw).replace(Zn,"");case 81:return XB(t,n).replace(Zn,"");case 4108:return QB(t);case 4126:case 4127:return n==4127?YB(t):$B(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function aS(t,e){var r=Se(4),n=Se(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Se(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=WB(e);break;case 31:case 80:for(n=Se(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return gn([r,n])}function sS(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),i=[],o=0,u=0,f=-1,d={};for(o=0;o!=a;++o){var m=t.read_shift(4),x=t.read_shift(4);i[o]=[m,x+r]}i.sort(function(I,C){return I[1]-C[1]});var y={};for(o=0;o!=a;++o){if(t.l!==i[o][1]){var b=!0;if(o>0&&e)switch(e[i[o-1][0]].t){case 2:t.l+2===i[o][1]&&(t.l+=2,b=!1);break;case 80:t.l<=i[o][1]&&(t.l=i[o][1],b=!1);break;case 4108:t.l<=i[o][1]&&(t.l=i[o][1],b=!1);break}if((!e||o==0)&&t.l<=i[o][1]&&(b=!1,t.l=i[o][1]),b)throw new Error("Read Error: Expected address "+i[o][1]+" at "+t.l+" :"+o)}if(e){var E=e[i[o][0]];if(y[E.n]=Hm(t,E.t,{raw:!0}),E.p==="version"&&(y[E.n]=String(y[E.n]>>16)+"."+("0000"+String(y[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(y[E.n]){case 0:y[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ws(u=y[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[E.n])}}else if(i[o][0]===1){if(u=y.CodePage=Hm(t,Py),ws(u),f!==-1){var w=t.l;t.l=i[f][1],d=nS(t,u),t.l=w}}else if(i[o][0]===0){if(u===0){f=o,t.l=i[o+1][1];continue}d=nS(t,u)}else{var T=d[i[o][0]],R;switch(t[t.l]){case 65:t.l+=4,R=rN(t);break;case 30:t.l+=4,R=Zx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,R=Zx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,R=t.read_shift(4,"i");break;case 19:t.l+=4,R=t.read_shift(4);break;case 5:t.l+=4,R=t.read_shift(8,"f");break;case 11:t.l+=4,R=Hr(t,4);break;case 64:t.l+=4,R=wr(Ly(t));break;default:throw new Error("unparsed value: "+t[t.l])}y[T]=R}}return t.l=r+n,y}var nN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ZB(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function iS(t,e,r){var n=Se(8),a=[],i=[],o=8,u=0,f=Se(8),d=Se(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),i.push(f),a.push(d),o+=8+f.length,!e){d=Se(8),d.write_shift(4,0),a.unshift(d);var m=[Se(4)];for(m[0].write_shift(4,t.length),u=0;u<t.length;++u){var x=t[u][0];for(f=Se(8+2*(x.length+1)+(x.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,x.length+1),f.write_shift(0,x,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=gn(m),i.unshift(f),o+=8+f.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(nN.indexOf(t[u][0])>-1||$C.indexOf(t[u][0])>-1)&&t[u][1]!=null){var y=t[u][1],b=0;if(e){b=+e[t[u][0]];var E=r[b];if(E.p=="version"&&typeof y=="string"){var w=y.split(".");y=(+w[0]<<16)+(+w[1]||0)}f=aS(E.t,y)}else{var T=ZB(y);T==-1&&(T=31,y=String(y)),f=aS(T,y)}i.push(f),d=Se(8),d.write_shift(4,e?b:2+u),a.push(d),o+=8+f.length}var R=8*(i.length+1);for(u=0;u<i.length;++u)a[u].write_shift(4,R),R+=i[u].length;return n.write_shift(4,o),n.write_shift(4,i.length),gn([n].concat(a).concat(i))}function lS(t,e,r){var n=t.content;if(!n)return{};Sn(n,0);var a,i,o,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),m=n.read_shift(16);if(m!==nt.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(o=n.read_shift(16),f=n.read_shift(4));var x=sS(n,e),y={SystemIdentifier:d};for(var b in x)y[b]=x[b];if(y.FMTID=i,a===1)return y;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var E;try{E=sS(n,null)}catch{}for(b in E)y[b]=E[b];return y.FMTID=[i,o],y}function oS(t,e,r,n,a,i){var o=Se(a?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,nt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,a?68:48);var f=iS(t,r,n);if(u.push(f),a){var d=iS(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+f.length),u.push(d)}return gn(u)}function bl(t,e){return t.read_shift(e),null}function eV(t,e){e||(e=Se(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function tV(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Hr(t,e){return t.read_shift(e)===1}function Qn(t,e){return e||(e=Se(2)),e.write_shift(2,+!!t),e}function rn(t){return t.read_shift(2,"u")}function Ja(t,e){return e||(e=Se(2)),e.write_shift(2,t),e}function aN(t,e){return tV(t,e,rn)}function rV(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function sN(t,e,r){return r||(r=Se(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function ih(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?t.read_shift(n,a):"";return o}function nV(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,i=1+(r&1),o=0,u,f={};a&&(o=t.read_shift(2)),n&&(u=t.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",m=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*o),n&&(t.l+=u),f.t=m,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function aV(t){var e=t.t||"",r=Se(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Se(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return gn(a)}function ec(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function lh(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):ec(t,n,r)}function hc(t,e,r){if(r.biff>5)return lh(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function iN(t,e,r){return r||(r=Se(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function sV(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function iV(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Zn,"");return n&&(t.l+=24),a}function lV(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(i>>1,"utf16le").replace(Zn,"");return r+o}function oV(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return iV(t);case"0303000000000000c000000000000046":return lV(t);default:throw new Error("Unsupported Moniker "+r)}}function qd(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Zn,""):"";return r}function cS(t,e){e||(e=Se(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function cV(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var i,o,u,f,d="",m,x;a&16&&(i=qd(t,r-t.l)),a&128&&(o=qd(t,r-t.l)),(a&257)===257&&(u=qd(t,r-t.l)),(a&257)===1&&(f=oV(t,r-t.l)),a&8&&(d=qd(t,r-t.l)),a&32&&(m=t.read_shift(16)),a&64&&(x=Ly(t)),t.l=r;var y=o||u||f||"";y&&d&&(y+="#"+d),y||(y="#"+d),a&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var b={Target:y};return m&&(b.guid=m),x&&(b.time=x),i&&(b.Tooltip=i),b}function uV(t){var e=Se(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(i==28)n=n.slice(1),cS(n,e);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),i&8&&cS(a>-1?n.slice(a+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)e.write_shift(1,n.charCodeAt(r+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function lN(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function oN(t,e){var r=lN(t);return r[3]=0,r}function Zs(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function tc(t,e,r,n){return n||(n=Se(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function fV(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function hV(t,e,r){return e===0?"":hc(t,e,r)}function dV(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),i=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[a,i,o]}function cN(t){var e=t.read_shift(2),r=My(t);return[e,r]}function mV(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=ih(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,a}function Cp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function uN(t,e){return e||(e=Se(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function fN(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var pV=fN;function hN(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function gV(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function xV(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Mn(t){t.l+=2,t.l+=t.read_shift(2)}var vV={0:Mn,4:Mn,5:Mn,6:Mn,7:xV,8:Mn,9:Mn,10:Mn,11:Mn,12:Mn,13:gV,14:Mn,15:Mn,16:Mn,17:Mn,18:Mn,19:Mn,20:Mn,21:hN};function yV(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(vV[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Wd(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function By(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Se(a);return i.write_shift(2,n),i.write_shift(2,e),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function _V(t,e){return e===0||t.read_shift(2),1200}function wV(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=hc(t,0,r);return t.read_shift(e+n-t.l),a}function bV(t,e){var r=!e||e.biff==8,n=Se(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function EV(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function TV(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=ih(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function SV(t,e){var r=!e||e.biff>=8?2:1,n=Se(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function AV(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),i=[],o=0;o!=a&&t.l<r;++o)i.push(nV(t));return i.Count=n,i.Unique=a,i}function kV(t,e){var r=Se(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=aV(t[a]);var i=gn([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function CV(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function NV(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function RV(t){var e=fV(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function IV(t){return t.read_shift(2),t.read_shift(4)}function uS(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function DV(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),u=t.read_shift(2),f=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:u,Selected:f,TabRatio:d}}function OV(){var t=Se(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function FV(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function MV(t){var e=Se(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function PV(){}function jV(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=ih(t,0,r),n}function LV(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,i=Se(a);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function BV(t){var e=Zs(t);return e.isst=t.read_shift(4),e}function VV(t,e,r,n){var a=Se(10);return tc(t,e,n,a),a.write_shift(4,r),a}function UV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=Zs(t);r.biff==2&&t.l++;var i=lh(t,n-t.l,r);return a.val=i,a}function zV(t,e,r,n,a){var i=!a||a.biff==8,o=Se(8+ +i+(1+i)*r.length);return tc(t,e,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function HV(t,e,r){var n=t.read_shift(2),a=hc(t,0,r);return[n,a]}function GV(t,e,r,n){var a=r&&r.biff==5;n||(n=Se(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var qV=hc;function fS(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,i=t.read_shift(a),o=t.read_shift(a),u=t.read_shift(2),f=t.read_shift(2);return t.l=n,{s:{r:i,c:u},e:{r:o,c:f}}}function WV(t,e){var r=e.biff==8||!e.biff?4:2,n=Se(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function XV(t){var e=t.read_shift(2),r=t.read_shift(2),n=cN(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function YV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),i=[];t.l<r;)i.push(cN(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function $V(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function KV(t,e,r,n){var a={},i=t.read_shift(4),o=t.read_shift(4),u=t.read_shift(4),f=t.read_shift(2);return a.patternType=RB[u>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function QV(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=KV(t,e,n.fStyle,r),n}function hS(t,e,r,n){var a=r&&r.biff==5;n||(n=Se(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function JV(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function ZV(t){var e=Se(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function dS(t,e,r){var n=Zs(t);(r.biff==2||e==9)&&++t.l;var a=rV(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function eU(t,e,r,n,a,i){var o=Se(8);return tc(t,e,n,o),sN(r,i,o),o}function tU(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Zs(t),a=zn(t);return n.val=a,n}function rU(t,e,r,n){var a=Se(14);return tc(t,e,n,a),Zo(r,a),a}var mS=hV;function nU(t,e,r){var n=t.l+e,a=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=ec(t,i),u=[];n>t.l;)u.push(lh(t));return[i,a,o,u]}function pS(t,e,r){var n=t.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=mV(t,e-2,r)),i.body=a||t.read_shift(e-2),typeof a=="string"&&(i.Name=a),i}var aU=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function gS(t,e,r){var n=t.l+e,a=t.read_shift(2),i=t.read_shift(1),o=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),f=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=ec(t,o,r);a&32&&(d=aU[d.charCodeAt(0)]);var m=n-t.l;r&&r.biff==2&&--m;var x=n==t.l||u===0||!(m>0)?[]:yq(t,m,r,u);return{chKey:i,Name:d,itab:f,rgce:x}}function dN(t,e,r){if(r.biff<8)return sU(t,e,r);for(var n=[],a=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(dV(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function sU(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=ih(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function iU(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),i=ec(t,n,r),o=ec(t,a,r);return[i,o]}function lU(t,e,r){var n=fN(t);t.l++;var a=t.read_shift(1);return e-=8,[_q(t,e,r),a,n]}function xS(t,e,r){var n=pV(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,xq(t,e,r)]}function oU(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function cU(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),u=hc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,o,i]}}function uU(t,e,r){return cU(t,e,r)}function fU(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Cp(t));return r}function hU(t){var e=Se(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)uN(t[r],e);return e}function dU(t,e,r){if(r&&r.biff<8)return pU(t,e,r);var n=hN(t),a=yV(t,e-22,n[1]);return{cmo:n,ft:a}}var mU={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function pU(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((mU[n]||qn)(t,e,r)),{cmo:[a,n,i],ft:o}}function gU(t,e,r){var n=t.l,a="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:o=sV(t,6,r);var u=t.read_shift(2);t.read_shift(2),rn(t,2);var f=t.read_shift(2);t.l+=f;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var m=t[t.l],x=ec(t,t.lens[d+1]-t.lens[d]-1);if(a+=x,a.length>=(m?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function xU(t,e){var r=Cp(t);t.l+=16;var n=cV(t,e-24);return[r,n]}function vU(t){var e=Se(24),r=Nr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return gn([e,uV(t[1])])}function yU(t,e){t.read_shift(2);var r=Cp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Zn,""),[r,n]}function _U(t){var e=t[1].Tooltip,r=Se(10+2*(e.length+1));r.write_shift(2,2048);var n=Nr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function wU(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=tS[r]||r,r=t.read_shift(2),e[1]=tS[r]||r,e}function bU(t){return t||(t=Se(4)),t.write_shift(2,1),t.write_shift(2,1),t}function EU(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(oN(t));return r}function TU(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(oN(t));return r}function SU(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function mN(t,e,r){if(!r.cellStyles)return qn(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),u=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var d={s:a,e:i,w:o,ixfe:u,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function AU(t,e){var r=Se(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function kU(t,e){var r={};return e<32||(t.l+=16,r.header=zn(t),r.footer=zn(t),t.l+=2),r}function CU(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function NU(t){for(var e=Se(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var RU=Zs,IU=aN,DU=lh;function OU(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function FU(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Zs(t);++t.l;var a=hc(t,e-7,r);return n.t="str",n.val=a,n}function MU(t){var e=Zs(t);++t.l;var r=zn(t);return e.t="n",e.val=r,e}function PU(t,e,r){var n=Se(15);return fh(n,t,e),n.write_shift(8,r,"f"),n}function jU(t){var e=Zs(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function LU(t,e,r){var n=Se(9);return fh(n,t,e),n.write_shift(2,r),n}function BU(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function VU(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function UU(t,e,r){var n=t.l+e,a=Zs(t),i=t.read_shift(2),o=ec(t,i,r);return t.l=n,a.t="str",a.val=o,a}var zU=[2,3,48,49,131,139,140,245],ev=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Sp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,f){var d=[],m=Yl(1);switch(f.type){case"base64":m=Ca(Oa(u));break;case"binary":m=Ca(u);break;case"buffer":case"array":m=u;break}Sn(m,0);var x=m.read_shift(1),y=!!(x&136),b=!1,E=!1;switch(x){case 2:break;case 3:break;case 48:b=!0,y=!0;break;case 49:b=!0,y=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var w=0,T=521;x==2&&(w=m.read_shift(2)),m.l+=3,x!=2&&(w=m.read_shift(4)),w>1048576&&(w=1e6),x!=2&&(T=m.read_shift(2));var R=m.read_shift(2),I=f.codepage||1252;x!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(I=t[m[m.l]]),m.l+=1,m.l+=2),E&&(m.l+=36);for(var C=[],W={},U=Math.min(m.length,x==2?521:T-10-(b?264:0)),B=E?32:11;m.l<U&&m[m.l]!=13;)switch(W={},W.name=y0.utils.decode(I,m.slice(m.l,m.l+B)).replace(/[\u0000\r\n].*$/g,""),m.l+=B,W.type=String.fromCharCode(m.read_shift(1)),x!=2&&!E&&(W.offset=m.read_shift(4)),W.len=m.read_shift(1),x==2&&(W.offset=m.read_shift(2)),W.dec=m.read_shift(1),W.name.length&&C.push(W),x!=2&&(m.l+=E?13:14),W.type){case"B":(!b||W.len!=8)&&f.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+W.name+":"+W.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+W.type)}if(m[m.l]!==13&&(m.l=T-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=T;var A=0,D=0;for(d[0]=[],D=0;D!=C.length;++D)d[0][D]=C[D].name;for(;w-- >0;){if(m[m.l]===42){m.l+=R;continue}for(++m.l,d[++A]=[],D=0,D=0;D!=C.length;++D){var N=m.slice(m.l,m.l+C[D].len);m.l+=C[D].len,Sn(N,0);var M=y0.utils.decode(I,N);switch(C[D].type){case"C":M.trim().length&&(d[A][D]=M.replace(/\s+$/,""));break;case"D":M.length===8?d[A][D]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):d[A][D]=M;break;case"F":d[A][D]=parseFloat(M.trim());break;case"+":case"I":d[A][D]=E?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":d[A][D]=!0;break;case"N":case"F":d[A][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));d[A][D]="##MEMO##"+(E?parseInt(M.trim(),10):N.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(d[A][D]=+M||0);break;case"@":d[A][D]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":d[A][D]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":d[A][D]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[A][D]=-N.read_shift(-8,"f");break;case"B":if(b&&C[D].len==8){d[A][D]=N.read_shift(8,"f");break}case"G":case"P":N.l+=C[D].len;break;case"0":if(C[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[D].type)}}}if(x!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=C,d}function n(u,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var m=Lu(r(u,d),d);return m["!cols"]=d.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete d.DBF,m}function a(u,f){try{return ao(n(u,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,f){var d=f||{};if(+d.codepage>=0&&ws(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=da(),x=Wm(u,{header:1,raw:!0,cellDates:!0}),y=x[0],b=x.slice(1),E=u["!cols"]||[],w=0,T=0,R=0,I=1;for(w=0;w<y.length;++w){if(((E[w]||{}).DBF||{}).name){y[w]=E[w].DBF.name,++R;continue}if(y[w]!=null){if(++R,typeof y[w]=="number"&&(y[w]=y[w].toString(10)),typeof y[w]!="string")throw new Error("DBF Invalid column name "+y[w]+" |"+typeof y[w]+"|");if(y.indexOf(y[w])!==w){for(T=0;T<1024;++T)if(y.indexOf(y[w]+"_"+T)==-1){y[w]+="_"+T;break}}}}var C=Ut(u["!ref"]),W=[],U=[],B=[];for(w=0;w<=C.e.c-C.s.c;++w){var A="",D="",N=0,M=[];for(T=0;T<b.length;++T)b[T][w]!=null&&M.push(b[T][w]);if(M.length==0||y[w]==null){W[w]="?";continue}for(T=0;T<M.length;++T){switch(typeof M[T]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=M[T]instanceof Date?"D":"C";break;default:D="C"}N=Math.max(N,String(M[T]).length),A=A&&A!=D?"C":D}N>250&&(N=250),D=((E[w]||{}).DBF||{}).type,D=="C"&&E[w].DBF.len>N&&(N=E[w].DBF.len),A=="B"&&D=="N"&&(A="N",B[w]=E[w].DBF.dec,N=E[w].DBF.len),U[w]=A=="C"||D=="N"?N:i[A]||0,I+=U[w],W[w]=A}var F=m.next(32);for(F.write_shift(4,318902576),F.write_shift(4,b.length),F.write_shift(2,296+32*R),F.write_shift(2,I),w=0;w<4;++w)F.write_shift(4,0);for(F.write_shift(4,0|(+e[nC]||3)<<8),w=0,T=0;w<y.length;++w)if(y[w]!=null){var P=m.next(32),V=(y[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,V,"sbcs"),P.write_shift(1,W[w]=="?"?"C":W[w],"sbcs"),P.write_shift(4,T),P.write_shift(1,U[w]||i[W[w]]||0),P.write_shift(1,B[w]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),T+=U[w]||i[W[w]]||0}var Ee=m.next(264);for(Ee.write_shift(4,13),w=0;w<65;++w)Ee.write_shift(4,0);for(w=0;w<b.length;++w){var we=m.next(I);for(we.write_shift(1,0),T=0;T<y.length;++T)if(y[T]!=null)switch(W[T]){case"L":we.write_shift(1,b[w][T]==null?63:b[w][T]?84:70);break;case"B":we.write_shift(8,b[w][T]||0,"f");break;case"N":var ie="0";for(typeof b[w][T]=="number"&&(ie=b[w][T].toFixed(B[T]||0)),R=0;R<U[T]-ie.length;++R)we.write_shift(1,32);we.write_shift(1,ie,"sbcs");break;case"D":b[w][T]?(we.write_shift(4,("0000"+b[w][T].getFullYear()).slice(-4),"sbcs"),we.write_shift(2,("00"+(b[w][T].getMonth()+1)).slice(-2),"sbcs"),we.write_shift(2,("00"+b[w][T].getDate()).slice(-2),"sbcs")):we.write_shift(8,"00000000","sbcs");break;case"C":var ee=String(b[w][T]!=null?b[w][T]:"").slice(0,U[T]);for(we.write_shift(1,ee,"sbcs"),R=0;R<U[T]-ee.length;++R)we.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}})(),pN=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Lr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,b){var E=t[b];return typeof E=="number"?CT(E):E},n=function(y,b,E){var w=b.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return w==59?y:CT(w)};t["|"]=254;function a(y,b){switch(b.type){case"base64":return i(Oa(y),b);case"binary":return i(y,b);case"buffer":return i(At&&Buffer.isBuffer(y)?y.toString("binary"):no(y),b);case"array":return i(Jo(y),b)}throw new Error("Unrecognized type "+b.type)}function i(y,b){var E=y.split(/[\n\r]+/),w=-1,T=-1,R=0,I=0,C=[],W=[],U=null,B={},A=[],D=[],N=[],M=0,F;for(+b.codepage>=0&&ws(+b.codepage);R!==E.length;++R){M=0;var P=E[R].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),V=P.replace(/;;/g,"\0").split(";").map(function(ne){return ne.replace(/\u0000/g,";")}),Ee=V[0],we;if(P.length>0)switch(Ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&W.push(P.slice(3).replace(/;;/g,";"));break;case"C":var ie=!1,ee=!1,ye=!1,ae=!1,Me=-1,Y=-1;for(I=1;I<V.length;++I)switch(V[I].charAt(0)){case"A":break;case"X":T=parseInt(V[I].slice(1))-1,ee=!0;break;case"Y":for(w=parseInt(V[I].slice(1))-1,ee||(T=0),F=C.length;F<=w;++F)C[F]=[];break;case"K":we=V[I].slice(1),we.charAt(0)==='"'?we=we.slice(1,we.length-1):we==="TRUE"?we=!0:we==="FALSE"?we=!1:isNaN(Es(we))?isNaN(Eu(we).getDate())||(we=wr(we)):(we=Es(we),U!==null&&Pu(U)&&(we=kp(we))),ie=!0;break;case"E":ae=!0;var j=du(V[I].slice(1),{r:w,c:T});C[w][T]=[C[w][T],j];break;case"S":ye=!0,C[w][T]=[C[w][T],"S5S"];break;case"G":break;case"R":Me=parseInt(V[I].slice(1))-1;break;case"C":Y=parseInt(V[I].slice(1))-1;break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+P)}if(ie&&(C[w][T]&&C[w][T].length==2?C[w][T][0]=we:C[w][T]=we,U=null),ye){if(ae)throw new Error("SYLK shared formula cannot have own formula");var X=Me>-1&&C[Me][Y];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");C[w][T][1]=ON(X[1],{r:w-Me,c:T-Y})}break;case"F":var J=0;for(I=1;I<V.length;++I)switch(V[I].charAt(0)){case"X":T=parseInt(V[I].slice(1))-1,++J;break;case"Y":for(w=parseInt(V[I].slice(1))-1,F=C.length;F<=w;++F)C[F]=[];break;case"M":M=parseInt(V[I].slice(1))/20;break;case"F":break;case"G":break;case"P":U=W[parseInt(V[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=V[I].slice(1).split(" "),F=parseInt(N[0],10);F<=parseInt(N[1],10);++F)M=parseInt(N[2],10),D[F-1]=M===0?{hidden:!0}:{wch:M},$l(D[F-1]);break;case"C":T=parseInt(V[I].slice(1))-1,D[T]||(D[T]={});break;case"R":w=parseInt(V[I].slice(1))-1,A[w]||(A[w]={}),M>0?(A[w].hpt=M,A[w].hpx=Su(M)):M===0&&(A[w].hidden=!0);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+P)}J<1&&(U=null);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+P)}}return A.length>0&&(B["!rows"]=A),D.length>0&&(B["!cols"]=D),b&&b.sheetRows&&(C=C.slice(0,b.sheetRows)),[C,B]}function o(y,b){var E=a(y,b),w=E[0],T=E[1],R=Lu(w,b);return Lr(T).forEach(function(I){R[I]=T[I]}),R}function u(y,b){return ao(o(y,b),b)}function f(y,b,E,w){var T="C;Y"+(E+1)+";X"+(w+1)+";K";switch(y.t){case"n":T+=y.v||0,y.f&&!y.F&&(T+=";E"+qy(y.f,{r:E,c:w}));break;case"b":T+=y.v?"TRUE":"FALSE";break;case"e":T+=y.w||y.v;break;case"d":T+='"'+(y.w||y.v)+'"';break;case"s":T+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function d(y,b){b.forEach(function(E,w){var T="F;W"+(w+1)+" "+(w+1)+" ";E.hidden?T+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=k0(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=C0(E.wpx)),typeof E.wch=="number"&&(T+=Math.round(E.wch))),T.charAt(T.length-1)!=" "&&y.push(T)})}function m(y,b){b.forEach(function(E,w){var T="F;";E.hidden?T+="M0;":E.hpt?T+="M"+20*E.hpt+";":E.hpx&&(T+="M"+20*N0(E.hpx)+";"),T.length>2&&y.push(T+"R"+(w+1))})}function x(y,b){var E=["ID;PWXL;N;E"],w=[],T=Ut(y["!ref"]),R,I=Array.isArray(y),C=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),y["!cols"]&&d(E,y["!cols"]),y["!rows"]&&m(E,y["!rows"]),E.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var W=T.s.r;W<=T.e.r;++W)for(var U=T.s.c;U<=T.e.c;++U){var B=ct({r:W,c:U});R=I?(y[W]||[])[U]:y[B],!(!R||R.v==null&&(!R.f||R.F))&&w.push(f(R,y,W,U))}return E.join(C)+C+w.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:o,from_sheet:x}})(),gN=(function(){function t(i,o){switch(o.type){case"base64":return e(Oa(i),o);case"binary":return e(i,o);case"buffer":return e(At&&Buffer.isBuffer(i)?i.toString("binary"):no(i),o);case"array":return e(Jo(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var u=i.split(`
`),f=-1,d=-1,m=0,x=[];m!==u.length;++m){if(u[m].trim()==="BOT"){x[++f]=[],d=0;continue}if(!(f<0)){var y=u[m].trim().split(","),b=y[0],E=y[1];++m;for(var w=u[m]||"";(w.match(/["]/g)||[]).length&1&&m<u.length-1;)w+=`
`+u[++m];switch(w=w.trim(),+b){case-1:if(w==="BOT"){x[++f]=[],d=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?x[f][d]=!0:w==="FALSE"?x[f][d]=!1:isNaN(Es(E))?isNaN(Eu(E).getDate())?x[f][d]=E:x[f][d]=wr(E):x[f][d]=Es(E),++d;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),x[f][d++]=w!==""?w:null;break}if(w==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function r(i,o){return Lu(t(i,o),o)}function n(i,o){return ao(r(i,o),o)}var a=(function(){var i=function(f,d,m,x,y){f.push(d),f.push(m+","+x),f.push('"'+y.replace(/"/g,'""')+'"')},o=function(f,d,m,x){f.push(d+","+m),f.push(d==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(f){var d=[],m=Ut(f["!ref"]),x,y=Array.isArray(f);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,m.e.r-m.s.r+1,""),i(d,"TUPLES",0,m.e.c-m.s.c+1,""),i(d,"DATA",0,0,"");for(var b=m.s.r;b<=m.e.r;++b){o(d,-1,0,"BOT");for(var E=m.s.c;E<=m.e.c;++E){var w=ct({r:b,c:E});if(x=y?(f[b]||[])[E]:f[w],!x){o(d,1,0,"");continue}switch(x.t){case"n":var T=x.w;!T&&x.v!=null&&(T=x.v),T==null?x.f&&!x.F?o(d,1,0,"="+x.f):o(d,1,0,""):o(d,0,T,"V");break;case"b":o(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=rs(x.z||ot[14],fn(wr(x.v)))),o(d,0,x.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var R=`\r
`,I=d.join(R);return I}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),xN=(function(){function t(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,y){for(var b=x.split(`
`),E=-1,w=-1,T=0,R=[];T!==b.length;++T){var I=b[T].trim().split(":");if(I[0]==="cell"){var C=Nr(I[1]);if(R.length<=C.r)for(E=R.length;E<=C.r;++E)R[E]||(R[E]=[]);switch(E=C.r,w=C.c,I[2]){case"t":R[E][w]=t(I[3]);break;case"v":R[E][w]=+I[3];break;case"vtf":var W=I[I.length-1];case"vtc":switch(I[3]){case"nl":R[E][w]=!!+I[4];break;default:R[E][w]=+I[4];break}I[2]=="vtf"&&(R[E][w]=[R[E][w],W])}}}return y&&y.sheetRows&&(R=R.slice(0,y.sheetRows)),R}function n(x,y){return Lu(r(x,y),y)}function a(x,y){return ao(n(x,y),y)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(x){if(!x||!x["!ref"])return"";for(var y=[],b=[],E,w="",T=ma(x["!ref"]),R=Array.isArray(x),I=T.s.r;I<=T.e.r;++I)for(var C=T.s.c;C<=T.e.c;++C)if(w=ct({r:I,c:C}),E=R?(x[I]||[])[C]:x[w],!(!E||E.v==null||E.t==="z")){switch(b=["cell",w,"t"],E.t){case"s":case"str":b.push(e(E.v));break;case"n":E.f?(b[2]="vtf",b[3]="n",b[4]=E.v,b[5]=e(E.f)):(b[2]="v",b[3]=E.v);break;case"b":b[2]="vt"+(E.f?"f":"c"),b[3]="nl",b[4]=E.v?"1":"0",b[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var W=fn(wr(E.v));b[2]="vtc",b[3]="nd",b[4]=""+W,b[5]=E.w||rs(E.z||ot[14],W);break;case"e":continue}y.push(b.join(":"))}return y.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function m(x){return[i,o,u,o,d(x),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:m}})(),Tu=(function(){function t(m,x,y,b,E){E.raw?x[y][b]=m:m===""||(m==="TRUE"?x[y][b]=!0:m==="FALSE"?x[y][b]=!1:isNaN(Es(m))?isNaN(Eu(m).getDate())?x[y][b]=m:x[y][b]=wr(m):x[y][b]=Es(m))}function e(m,x){var y=x||{},b=[];if(!m||m.length===0)return b;for(var E=m.split(/[\r\n]/),w=E.length-1;w>=0&&E[w].length===0;)--w;for(var T=10,R=0,I=0;I<=w;++I)R=E[I].indexOf(" "),R==-1?R=E[I].length:R++,T=Math.max(T,R);for(I=0;I<=w;++I){b[I]=[];var C=0;for(t(E[I].slice(0,T).trim(),b,I,C,y),C=1;C<=(E[I].length-T)/10+1;++C)t(E[I].slice(T+(C-1)*10,T+C*10).trim(),b,I,C,y)}return y.sheetRows&&(b=b.slice(0,y.sheetRows)),b}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(m){for(var x={},y=!1,b=0,E=0;b<m.length;++b)(E=m.charCodeAt(b))==34?y=!y:!y&&E in r&&(x[E]=(x[E]||0)+1);E=[];for(b in x)Object.prototype.hasOwnProperty.call(x,b)&&E.push([x[b],b]);if(!E.length){x=n;for(b in x)Object.prototype.hasOwnProperty.call(x,b)&&E.push([x[b],b])}return E.sort(function(w,T){return w[0]-T[0]||n[w[1]]-n[T[1]]}),r[E.pop()[1]]||44}function i(m,x){var y=x||{},b="",E=y.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(b=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(b=m.charAt(4),m=m.slice(6)):b=a(m.slice(0,1024)):y&&y.FS?b=y.FS:b=a(m.slice(0,1024));var T=0,R=0,I=0,C=0,W=0,U=b.charCodeAt(0),B=!1,A=0,D=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var N=y.dateNF!=null?C7(y.dateNF):null;function M(){var F=m.slice(C,W),P={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)P.t="z";else if(y.raw)P.t="s",P.v=F;else if(F.trim().length===0)P.t="s",P.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(P.t="s",P.v=F.slice(2,-1).replace(/""/g,'"')):nG(F)?(P.t="n",P.f=F.slice(1)):(P.t="s",P.v=F);else if(F=="TRUE")P.t="b",P.v=!0;else if(F=="FALSE")P.t="b",P.v=!1;else if(!isNaN(I=Es(F)))P.t="n",y.cellText!==!1&&(P.w=F),P.v=I;else if(!isNaN(Eu(F).getDate())||N&&F.match(N)){P.z=y.dateNF||ot[14];var V=0;N&&F.match(N)&&(F=N7(F,y.dateNF,F.match(N)||[]),V=1),y.cellDates?(P.t="d",P.v=wr(F,V)):(P.t="n",P.v=fn(wr(F,V))),y.cellText!==!1&&(P.w=rs(P.z,P.v instanceof Date?fn(P.v):P.v)),y.cellNF||delete P.z}else P.t="s",P.v=F;if(P.t=="z"||(y.dense?(E[T]||(E[T]=[]),E[T][R]=P):E[ct({c:R,r:T})]=P),C=W+1,D=m.charCodeAt(C),w.e.c<R&&(w.e.c=R),w.e.r<T&&(w.e.r=T),A==U)++R;else if(R=0,++T,y.sheetRows&&y.sheetRows<=T)return!0}e:for(;W<m.length;++W)switch(A=m.charCodeAt(W)){case 34:D===34&&(B=!B);break;case U:case 10:case 13:if(!B&&M())break e;break}return W-C>0&&M(),E["!ref"]=_t(w),E}function o(m,x){return!(x&&x.PRN)||x.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?i(m,x):Lu(e(m,x),x)}function u(m,x){var y="",b=x.type=="string"?[0,0,0,0]:Zy(m,x);switch(x.type){case"base64":y=Oa(m);break;case"binary":y=m;break;case"buffer":x.codepage==65001?y=m.toString("utf8"):x.codepage&&typeof y0<"u"||(y=At&&Buffer.isBuffer(m)?m.toString("binary"):no(m));break;case"array":y=Jo(m);break;case"string":y=m;break;default:throw new Error("Unrecognized type "+x.type)}return b[0]==239&&b[1]==187&&b[2]==191?y=ur(y.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?y=ur(y):x.type=="binary"&&typeof y0<"u",y.slice(0,19)=="socialcalc:version:"?xN.to_sheet(x.type=="string"?y:ur(y),x):o(y,x)}function f(m,x){return ao(u(m,x),x)}function d(m){for(var x=[],y=Ut(m["!ref"]),b,E=Array.isArray(m),w=y.s.r;w<=y.e.r;++w){for(var T=[],R=y.s.c;R<=y.e.c;++R){var I=ct({r:w,c:R});if(b=E?(m[w]||[])[R]:m[I],!b||b.v==null){T.push("          ");continue}for(var C=(b.w||(ji(b),b.w)||"").slice(0,10);C.length<10;)C+=" ";T.push(C+(R===0?" ":""))}x.push(T.join(""))}return x.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:d}})();function HU(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=pN.to_workbook(t,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Tu.to_workbook(t,e)}}var Uo=(function(){function t(j,X,J){if(j){Sn(j,j.l||0);for(var ne=J.Enum||Me;j.l<j.length;){var ue=j.read_shift(2),Te=ne[ue]||ne[65535],Re=j.read_shift(2),Ce=j.l+Re,Fe=Te.f&&Te.f(j,Re,J);if(j.l=Ce,X(Fe,Te,ue))return}}}function e(j,X){switch(X.type){case"base64":return r(Ca(Oa(j)),X);case"binary":return r(Ca(j),X);case"buffer":case"array":return r(j,X)}throw"Unsupported type "+X.type}function r(j,X){if(!j)return j;var J=X||{},ne=J.dense?[]:{},ue="Sheet1",Te="",Re=0,Ce={},Fe=[],st=[],te={s:{r:0,c:0},e:{r:0,c:0}},Ct=J.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)J.Enum=Me,t(j,function(le,Qe,Be){switch(Be){case 0:J.vers=le,le>=4096&&(J.qpro=!0);break;case 6:te=le;break;case 204:le&&(Te=le);break;case 222:Te=le;break;case 15:case 51:J.qpro||(le[1].v=le[1].v.slice(1));case 13:case 14:case 16:Be==14&&(le[2]&112)==112&&(le[2]&15)>1&&(le[2]&15)<15&&(le[1].z=J.dateNF||ot[14],J.cellDates&&(le[1].t="d",le[1].v=kp(le[1].v))),J.qpro&&le[3]>Re&&(ne["!ref"]=_t(te),Ce[ue]=ne,Fe.push(ue),ne=J.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},Re=le[3],ue=Te||"Sheet"+(Re+1),Te="");var Ye=J.dense?(ne[le[0].r]||[])[le[0].c]:ne[ct(le[0])];if(Ye){Ye.t=le[1].t,Ye.v=le[1].v,le[1].z!=null&&(Ye.z=le[1].z),le[1].f!=null&&(Ye.f=le[1].f);break}J.dense?(ne[le[0].r]||(ne[le[0].r]=[]),ne[le[0].r][le[0].c]=le[1]):ne[ct(le[0])]=le[1];break}},J);else if(j[2]==26||j[2]==14)J.Enum=Y,j[2]==14&&(J.qpro=!0,j.l=0),t(j,function(le,Qe,Be){switch(Be){case 204:ue=le;break;case 22:le[1].v=le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(le[3]>Re&&(ne["!ref"]=_t(te),Ce[ue]=ne,Fe.push(ue),ne=J.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},Re=le[3],ue="Sheet"+(Re+1)),Ct>0&&le[0].r>=Ct)break;J.dense?(ne[le[0].r]||(ne[le[0].r]=[]),ne[le[0].r][le[0].c]=le[1]):ne[ct(le[0])]=le[1],te.e.c<le[0].c&&(te.e.c=le[0].c),te.e.r<le[0].r&&(te.e.r=le[0].r);break;case 27:le[14e3]&&(st[le[14e3][0]]=le[14e3][1]);break;case 1537:st[le[0]]=le[1],le[0]==Re&&(ue=le[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(ne["!ref"]=_t(te),Ce[Te||ue]=ne,Fe.push(Te||ue),!st.length)return{SheetNames:Fe,Sheets:Ce};for(var lt={},It=[],ht=0;ht<st.length;++ht)Ce[Fe[ht]]?(It.push(st[ht]||Fe[ht]),lt[st[ht]]=Ce[st[ht]]||Ce[Fe[ht]]):(It.push(st[ht]),lt[st[ht]]={"!ref":"A1"});return{SheetNames:It,Sheets:lt}}function n(j,X){var J=X||{};if(+J.codepage>=0&&ws(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var ne=da(),ue=Ut(j["!ref"]),Te=Array.isArray(j),Re=[];ze(ne,0,i(1030)),ze(ne,6,f(ue));for(var Ce=Math.min(ue.e.r,8191),Fe=ue.s.r;Fe<=Ce;++Fe)for(var st=Wr(Fe),te=ue.s.c;te<=ue.e.c;++te){Fe===ue.s.r&&(Re[te]=Cr(te));var Ct=Re[te]+st,lt=Te?(j[Fe]||[])[te]:j[Ct];if(!(!lt||lt.t=="z"))if(lt.t=="n")(lt.v|0)==lt.v&&lt.v>=-32768&&lt.v<=32767?ze(ne,13,b(Fe,te,lt.v)):ze(ne,14,w(Fe,te,lt.v));else{var It=ji(lt);ze(ne,15,x(Fe,te,It.slice(0,239)))}}return ze(ne,1),ne.end()}function a(j,X){var J=X||{};if(+J.codepage>=0&&ws(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var ne=da();ze(ne,0,o(j));for(var ue=0,Te=0;ue<j.SheetNames.length;++ue)(j.Sheets[j.SheetNames[ue]]||{})["!ref"]&&ze(ne,27,ae(j.SheetNames[ue],Te++));var Re=0;for(ue=0;ue<j.SheetNames.length;++ue){var Ce=j.Sheets[j.SheetNames[ue]];if(!(!Ce||!Ce["!ref"])){for(var Fe=Ut(Ce["!ref"]),st=Array.isArray(Ce),te=[],Ct=Math.min(Fe.e.r,8191),lt=Fe.s.r;lt<=Ct;++lt)for(var It=Wr(lt),ht=Fe.s.c;ht<=Fe.e.c;++ht){lt===Fe.s.r&&(te[ht]=Cr(ht));var le=te[ht]+It,Qe=st?(Ce[lt]||[])[ht]:Ce[le];if(!(!Qe||Qe.t=="z"))if(Qe.t=="n")ze(ne,23,M(lt,ht,Re,Qe.v));else{var Be=ji(Qe);ze(ne,22,A(lt,ht,Re,Be.slice(0,239)))}}++Re}}return ze(ne,1),ne.end()}function i(j){var X=Se(2);return X.write_shift(2,j),X}function o(j){var X=Se(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var J=0,ne=0,ue=0,Te=0;Te<j.SheetNames.length;++Te){var Re=j.SheetNames[Te],Ce=j.Sheets[Re];if(!(!Ce||!Ce["!ref"])){++ue;var Fe=ma(Ce["!ref"]);J<Fe.e.r&&(J=Fe.e.r),ne<Fe.e.c&&(ne=Fe.e.c)}}return J>8191&&(J=8191),X.write_shift(2,J),X.write_shift(1,ue),X.write_shift(1,ne),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function u(j,X,J){var ne={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&J.qpro?(ne.s.c=j.read_shift(1),j.l++,ne.s.r=j.read_shift(2),ne.e.c=j.read_shift(1),j.l++,ne.e.r=j.read_shift(2),ne):(ne.s.c=j.read_shift(2),ne.s.r=j.read_shift(2),X==12&&J.qpro&&(j.l+=2),ne.e.c=j.read_shift(2),ne.e.r=j.read_shift(2),X==12&&J.qpro&&(j.l+=2),ne.s.c==65535&&(ne.s.c=ne.e.c=ne.s.r=ne.e.r=0),ne)}function f(j){var X=Se(8);return X.write_shift(2,j.s.c),X.write_shift(2,j.s.r),X.write_shift(2,j.e.c),X.write_shift(2,j.e.r),X}function d(j,X,J){var ne=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(ne[0].c=j.read_shift(1),ne[3]=j.read_shift(1),ne[0].r=j.read_shift(2),j.l+=2):(ne[2]=j.read_shift(1),ne[0].c=j.read_shift(2),ne[0].r=j.read_shift(2)),ne}function m(j,X,J){var ne=j.l+X,ue=d(j,X,J);if(ue[1].t="s",J.vers==20768){j.l++;var Te=j.read_shift(1);return ue[1].v=j.read_shift(Te,"utf8"),ue}return J.qpro&&j.l++,ue[1].v=j.read_shift(ne-j.l,"cstr"),ue}function x(j,X,J){var ne=Se(7+J.length);ne.write_shift(1,255),ne.write_shift(2,X),ne.write_shift(2,j),ne.write_shift(1,39);for(var ue=0;ue<ne.length;++ue){var Te=J.charCodeAt(ue);ne.write_shift(1,Te>=128?95:Te)}return ne.write_shift(1,0),ne}function y(j,X,J){var ne=d(j,X,J);return ne[1].v=j.read_shift(2,"i"),ne}function b(j,X,J){var ne=Se(7);return ne.write_shift(1,255),ne.write_shift(2,X),ne.write_shift(2,j),ne.write_shift(2,J,"i"),ne}function E(j,X,J){var ne=d(j,X,J);return ne[1].v=j.read_shift(8,"f"),ne}function w(j,X,J){var ne=Se(13);return ne.write_shift(1,255),ne.write_shift(2,X),ne.write_shift(2,j),ne.write_shift(8,J,"f"),ne}function T(j,X,J){var ne=j.l+X,ue=d(j,X,J);if(ue[1].v=j.read_shift(8,"f"),J.qpro)j.l=ne;else{var Te=j.read_shift(2);W(j.slice(j.l,j.l+Te),ue),j.l+=Te}return ue}function R(j,X,J){var ne=X&32768;return X&=-32769,X=(ne?j:0)+(X>=8192?X-16384:X),(ne?"":"$")+(J?Cr(X):Wr(X))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function W(j,X){Sn(j,0);for(var J=[],ne=0,ue="",Te="",Re="",Ce="";j.l<j.length;){var Fe=j[j.l++];switch(Fe){case 0:J.push(j.read_shift(8,"f"));break;case 1:Te=R(X[0].c,j.read_shift(2),!0),ue=R(X[0].r,j.read_shift(2),!1),J.push(Te+ue);break;case 2:{var st=R(X[0].c,j.read_shift(2),!0),te=R(X[0].r,j.read_shift(2),!1);Te=R(X[0].c,j.read_shift(2),!0),ue=R(X[0].r,j.read_shift(2),!1),J.push(st+te+":"+Te+ue)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(j.read_shift(2));break;case 6:{for(var Ct="";Fe=j[j.l++];)Ct+=String.fromCharCode(Fe);J.push('"'+Ct.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:Ce=J.pop(),Re=J.pop(),J.push(["AND","OR"][Fe-20]+"("+Re+","+Ce+")");break;default:if(Fe<32&&C[Fe])Ce=J.pop(),Re=J.pop(),J.push(Re+C[Fe]+Ce);else if(I[Fe]){if(ne=I[Fe][1],ne==69&&(ne=j[j.l++]),ne>J.length){console.error("WK1 bad formula parse 0x"+Fe.toString(16)+":|"+J.join("|")+"|");return}var lt=J.slice(-ne);J.length-=ne,J.push(I[Fe][0]+"("+lt.join(",")+")")}else return Fe<=7?console.error("WK1 invalid opcode "+Fe.toString(16)):Fe<=24?console.error("WK1 unsupported op "+Fe.toString(16)):Fe<=30?console.error("WK1 invalid opcode "+Fe.toString(16)):Fe<=115?console.error("WK1 unsupported function opcode "+Fe.toString(16)):console.error("WK1 unrecognized opcode "+Fe.toString(16))}}J.length==1?X[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function U(j){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=j.read_shift(2),X[3]=j[j.l++],X[0].c=j[j.l++],X}function B(j,X){var J=U(j);return J[1].t="s",J[1].v=j.read_shift(X-4,"cstr"),J}function A(j,X,J,ne){var ue=Se(6+ne.length);ue.write_shift(2,j),ue.write_shift(1,J),ue.write_shift(1,X),ue.write_shift(1,39);for(var Te=0;Te<ne.length;++Te){var Re=ne.charCodeAt(Te);ue.write_shift(1,Re>=128?95:Re)}return ue.write_shift(1,0),ue}function D(j,X){var J=U(j);J[1].v=j.read_shift(2);var ne=J[1].v>>1;if(J[1].v&1)switch(ne&7){case 0:ne=(ne>>3)*5e3;break;case 1:ne=(ne>>3)*500;break;case 2:ne=(ne>>3)/20;break;case 3:ne=(ne>>3)/200;break;case 4:ne=(ne>>3)/2e3;break;case 5:ne=(ne>>3)/2e4;break;case 6:ne=(ne>>3)/16;break;case 7:ne=(ne>>3)/64;break}return J[1].v=ne,J}function N(j,X){var J=U(j),ne=j.read_shift(4),ue=j.read_shift(4),Te=j.read_shift(2);if(Te==65535)return ne===0&&ue===3221225472?(J[1].t="e",J[1].v=15):ne===0&&ue===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var Re=Te&32768;return Te=(Te&32767)-16446,J[1].v=(1-Re*2)*(ue*Math.pow(2,Te+32)+ne*Math.pow(2,Te)),J}function M(j,X,J,ne){var ue=Se(14);if(ue.write_shift(2,j),ue.write_shift(1,J),ue.write_shift(1,X),ne==0)return ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,65535),ue;var Te=0,Re=0,Ce=0,Fe=0;return ne<0&&(Te=1,ne=-ne),Re=Math.log2(ne)|0,ne/=Math.pow(2,Re-31),Fe=ne>>>0,(Fe&2147483648)==0&&(ne/=2,++Re,Fe=ne>>>0),ne-=Fe,Fe|=2147483648,Fe>>>=0,ne*=Math.pow(2,32),Ce=ne>>>0,ue.write_shift(4,Ce),ue.write_shift(4,Fe),Re+=16383+(Te?32768:0),ue.write_shift(2,Re),ue}function F(j,X){var J=N(j);return j.l+=X-14,J}function P(j,X){var J=U(j),ne=j.read_shift(4);return J[1].v=ne>>6,J}function V(j,X){var J=U(j),ne=j.read_shift(8,"f");return J[1].v=ne,J}function Ee(j,X){var J=V(j);return j.l+=X-10,J}function we(j,X){return j[j.l+X-1]==0?j.read_shift(X,"cstr"):""}function ie(j,X){var J=j[j.l++];J>X-1&&(J=X-1);for(var ne="";ne.length<J;)ne+=String.fromCharCode(j[j.l++]);return ne}function ee(j,X,J){if(!(!J.qpro||X<21)){var ne=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var ue=j.read_shift(X-21,"cstr");return[ne,ue]}}function ye(j,X){for(var J={},ne=j.l+X;j.l<ne;){var ue=j.read_shift(2);if(ue==14e3){for(J[ue]=[0,""],J[ue][0]=j.read_shift(2);j[j.l];)J[ue][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return J}function ae(j,X){var J=Se(5+j.length);J.write_shift(2,14e3),J.write_shift(2,X);for(var ne=0;ne<j.length;++ne){var ue=j.charCodeAt(ne);J[J.l++]=ue>127?95:ue}return J[J.l++]=0,J}var Me={0:{n:"BOF",f:rn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:we},222:{n:"SHEETNAMELP",f:ie},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ye},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:Ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:we},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ee},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}})();function GU(t){var e={},r=t.match(Wn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=ft(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=gy[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return e}var qU=(function(){var t=b0("t"),e=b0("rPr");function r(i){var o=i.match(t);if(!o)return{t:"s",v:""};var u={t:"s",v:Vt(o[1])},f=i.match(e);return f&&(u.s=GU(f[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(u){return u.v})}})(),WU=(function(){var e=/(\r\n|\n)/g;function r(a,i,o){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),i.push('<span style="'+u.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),o.push("</"+f+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),XU=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,YU=/<(?:\w+:)?r>/,$U=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Vy(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Vt(ur(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ur(t),r&&(n.h=Ay(n.t))):t.match(YU)&&(n.r=ur(t),n.t=Vt(ur((t.replace($U,"").match(XU)||[]).join("").replace(Wn,""))),r&&(n.h=WU(qU(n.r)))),n):{t:""}}var KU=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,QU=/<(?:\w+:)?(?:si|sstItem)>/g,JU=/<\/(?:\w+:)?(?:si|sstItem)>/;function ZU(t,e){var r=[],n="";if(!t)return r;var a=t.match(KU);if(a){n=a[2].replace(QU,"").split(JU);for(var i=0;i!=n.length;++i){var o=Vy(n[i].trim(),e);o!=null&&(r[r.length]=o)}a=ft(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var ez=/^\s|\s$|[\t\n\r]/;function vN(t,e){if(!e.bookSST)return"";var r=[Xr];r[r.length]=Ue("sst",null,{xmlns:lc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(ez)&&(i+=' xml:space="preserve"'),i+=">"+sr(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function tz(t){return[t.read_shift(4),t.read_shift(4)]}function rz(t,e){var r=[],n=!1;return Vi(t,function(i,o,u){switch(u){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function nz(t,e){return e||(e=Se(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var az=mB;function sz(t){var e=da();Pe(e,159,nz(t));for(var r=0;r<t.length;++r)Pe(e,19,az(t[r]));return Pe(e,160),e.end()}function yN(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ni(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function iz(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ni(t,4),e.U=Ni(t,4),e.W=Ni(t,4),e}function lz(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),i=[];a-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function oz(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(lz(t));return e}function cz(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function uz(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ni(t,4),e.U=Ni(t,4),e.W=Ni(t,4),e}function fz(t){var e=uz(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function _N(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function wN(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function hz(t){var e=Ni(t);switch(e.Minor){case 2:return[e.Minor,dz(t)];case 3:return[e.Minor,mz()];case 4:return[e.Minor,pz(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function dz(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=_N(t,r),a=wN(t,t.length-t.l);return{t:"Std",h:n,v:a}}function mz(){throw new Error("File is password-protected: ECMA-376 Extensible")}function pz(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Wn,function(i){var o=ft(i);switch(Js(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function gz(t,e){var r={},n=r.EncryptionVersionInfo=Ni(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=_N(t,a),e-=a,r.EncryptionVerifier=wN(t,e),r}function xz(t){var e={},r=e.EncryptionVersionInfo=Ni(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Uy(t){var e=0,r,n=yN(t),a=n.length+1,i,o,u,f,d;for(r=Yl(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],u=(e&16384)===0?0:1,f=e<<1&32767,d=u|f,e=d^o;return e^52811}var bN=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,u){return n(o^u)},i=function(o){for(var u=e[o.length-1],f=104,d=o.length-1;d>=0;--d)for(var m=o[d],x=0;x!=7;++x)m&64&&(u^=r[f]),m*=2,--f;return u};return function(o){for(var u=yN(o),f=i(u),d=u.length,m=Yl(16),x=0;x!=16;++x)m[x]=0;var y,b,E;for((d&1)===1&&(y=f>>8,m[d]=a(t[0],y),--d,y=f&255,b=u[u.length-1],m[d]=a(b,y));d>0;)--d,y=f>>8,m[d]=a(u[d],y),--d,y=f&255,m[d]=a(u[d],y);for(d=15,E=15-u.length;E>0;)y=f>>8,m[d]=a(t[E],y),--d,--E,y=f&255,m[d]=a(u[d],y),--d,--E;return m}})(),vz=function(t,e,r,n,a){a||(a=e),n||(n=bN(t));var i,o;for(i=0;i!=e.length;++i)o=e[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},yz=function(t){var e=0,r=bN(t);return function(n){var a=vz("",n,e,r);return e=a[1],a[0]}};function _z(t,e,r,n){var a={key:rn(t),verificationBytes:rn(t)};return r.password&&(a.verifier=Uy(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=yz(r.password)),a}function wz(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=xz(t):n.Data=gz(t,e),n}function bz(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?wz(t,e-2,n):_z(t,r.biff>=8?e:e-2,r,n),n}var EN=(function(){function t(a,i){switch(i.type){case"base64":return e(Oa(a),i);case"binary":return e(a,i);case"buffer":return e(At&&Buffer.isBuffer(a)?a.toString("binary"):no(a),i);case"array":return e(Jo(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){var o=i||{},u=o.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,x){Array.isArray(u)&&(u[x]=[]);for(var y=/\\\w+\b/g,b=0,E,w=-1;E=y.exec(m);){switch(E[0]){case"\\cell":var T=m.slice(b,y.lastIndex-E[0].length);if(T[0]==" "&&(T=T.slice(1)),++w,T.length){var R={v:T,t:"s"};Array.isArray(u)?u[x][w]=R:u[ct({r:x,c:w})]=R}break}b=y.lastIndex}w>d.e.c&&(d.e.c=w)}),u["!ref"]=_t(d),u}function r(a,i){return ao(t(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=Ut(a["!ref"]),u,f=Array.isArray(a),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)i.push("\\cellx"+(m+1));for(i.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var x=ct({r:d,c:m});u=f?(a[d]||[])[m]:a[x],!(!u||u.v==null&&(!u.f||u.F))&&(i.push(" "+(u.w||(ji(u),u.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function Ez(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function A0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Tz(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),i=Math.min(e,r,n),o=a-i;if(o===0)return[0,0,e];var u=0,f=0,d=a+i;switch(f=o/(d>1?2-d:d),a){case e:u=((r-n)/o+6)%6;break;case r:u=(n-e)/o+2;break;case n:u=(e-r)/o+4;break}return[u/6,f,d/2]}function Sz(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],u=6*e,f;if(r!==0)switch(u|0){case 0:case 6:f=a*u,o[0]+=a,o[1]+=f;break;case 1:f=a*(2-u),o[0]+=f,o[1]+=a;break;case 2:f=a*(u-2),o[1]+=a,o[2]+=f;break;case 3:f=a*(4-u),o[1]+=f,o[2]+=a;break;case 4:f=a*(u-4),o[2]+=a,o[0]+=f;break;case 5:f=a*(6-u),o[2]+=f,o[0]+=a;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function Gm(t,e){if(e===0)return t;var r=Tz(Ez(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),A0(Sz(r))}var TN=6,Az=15,kz=1,Vn=TN;function k0(t){return Math.floor((t+Math.round(128/Vn)/256)*Vn)}function C0(t){return Math.floor((t-5)/Vn*100+.5)/100}function qm(t){return Math.round((t*Vn+5)/Vn*256)/256}function tx(t){return qm(C0(k0(t)))}function zy(t){var e=Math.abs(t-tx(t)),r=Vn;if(e>.005)for(Vn=kz;Vn<Az;++Vn)Math.abs(t-tx(t))<=e&&(e=Math.abs(t-tx(t)),r=Vn);Vn=r}function $l(t){t.width?(t.wpx=k0(t.width),t.wch=C0(t.wpx),t.MDW=Vn):t.wpx?(t.wch=C0(t.wpx),t.width=qm(t.wch),t.MDW=Vn):typeof t.wch=="number"&&(t.width=qm(t.wch),t.wpx=k0(t.width),t.MDW=Vn),t.customWidth&&delete t.customWidth}var Cz=96,SN=Cz;function N0(t){return t*96/SN}function Su(t){return t*SN/96}var Nz={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Rz(t,e,r,n){e.Borders=[];var a={},i=!1;(t[0].match(Wn)||[]).forEach(function(o){var u=ft(o);switch(Js(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=yr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=yr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in borders")}})}function Iz(t,e,r,n){e.Fills=[];var a={},i=!1;(t[0].match(Wn)||[]).forEach(function(o){var u=ft(o);switch(Js(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fills")}})}function Dz(t,e,r,n){e.Fonts=[];var a={},i=!1;(t[0].match(Wn)||[]).forEach(function(o){var u=ft(o);switch(Js(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=ur(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?yr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?yr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?yr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?yr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?yr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?yr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?yr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=gy[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=yr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var f=Bo[a.color.index];a.color.index==81&&(f=Bo[1]),f||(f=Bo[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Gm(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fonts")}})}function Oz(t,e,r){e.NumberFmt=[];for(var n=Lr(ot),a=0;a<n.length;++a)e.NumberFmt[n[a]]=ot[n[a]];var i=t[0].match(Wn);if(i)for(a=0;a<i.length;++a){var o=ft(i[a]);switch(Js(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Vt(ur(o.formatCode)),f=parseInt(o.numFmtId,10);if(e.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=u}Ci(u,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Fz(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ue("numFmt",null,{numFmtId:n,formatCode:sr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ue("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Xd=["numFmtId","fillId","fontId","borderId","xfId"],Yd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Mz(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(Wn)||[]).forEach(function(i){var o=ft(i),u=0;switch(Js(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<Xd.length;++u)n[Xd[u]]&&(n[Xd[u]]=parseInt(n[Xd[u]],10));for(u=0;u<Yd.length;++u)n[Yd[u]]&&(n[Yd[u]]=yr(n[Yd[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};o.vertical&&(f.vertical=o.vertical),o.horizontal&&(f.horizontal=o.horizontal),o.textRotation!=null&&(f.textRotation=o.textRotation),o.indent&&(f.indent=o.indent),o.wrapText&&(f.wrapText=yr(o.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Pz(t){var e=[];return e[e.length]=Ue("cellXfs",null),t.forEach(function(r){e[e.length]=Ue("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ue("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var jz=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,d){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(e))&&Oz(x,m,d),(x=u.match(a))&&Dz(x,m,f,d),(x=u.match(n))&&Iz(x,m,f,d),(x=u.match(i))&&Rz(x,m,f,d),(x=u.match(r))&&Mz(x,m,d),m}})();function AN(t,e){var r=[Xr,Ue("styleSheet",null,{xmlns:lc[0],"xmlns:vt":on.vt})],n;return t.SSF&&(n=Fz(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Pz(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Lz(t,e){var r=t.read_shift(2),n=Hn(t);return[r,n]}function Bz(t,e,r){r||(r=Se(6+4*e.length)),r.write_shift(2,t),xn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Vz(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=wB(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var u=t.read_shift(1);u>0&&(n.family=u);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=_B(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Hn(t),n}function Uz(t,e){e||(e=Se(153)),e.write_shift(2,t.sz*20),bB(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Um(t.color,e);var n=0;return n=2,e.write_shift(1,n),xn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var zz=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rx,Hz=qn;function vS(t,e){e||(e=Se(84)),rx||(rx=Sp(zz));var r=rx[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Um({auto:1},e),Um({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Gz(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function kN(t,e,r){r||(r=Se(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Bf(t,e){return e||(e=Se(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var qz=qn;function Wz(t,e){return e||(e=Se(51)),e.write_shift(1,0),Bf(null,e),Bf(null,e),Bf(null,e),Bf(null,e),Bf(null,e),e.length>e.l?e.slice(0,e.l):e}function Xz(t,e){return e||(e=Se(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Vm(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Yz(t,e,r){var n=Se(2052);return n.write_shift(4,t),Vm(e,n),Vm(r,n),n.length>n.l?n.slice(0,n.l):n}function $z(t,e,r){var n={};n.NumberFmt=[];for(var a in ot)n.NumberFmt[a]=ot[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Vi(t,function(f,d,m){switch(m){case 44:n.NumberFmt[f[0]]=f[1],Ci(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=Gm(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(m),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(m);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}function Kz(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Pe(t,615,Ts(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Pe(t,44,Bz(a,e[a]))}),Pe(t,616))}}function Qz(t){var e=1;Pe(t,611,Ts(e)),Pe(t,43,Uz({sz:12,color:{theme:1},name:"Calibri",family:2})),Pe(t,612)}function Jz(t){var e=2;Pe(t,603,Ts(e)),Pe(t,45,vS({patternType:"none"})),Pe(t,45,vS({patternType:"gray125"})),Pe(t,604)}function Zz(t){var e=1;Pe(t,613,Ts(e)),Pe(t,46,Wz()),Pe(t,614)}function eH(t){var e=1;Pe(t,626,Ts(e)),Pe(t,47,kN({numFmtId:0},65535)),Pe(t,627)}function tH(t,e){Pe(t,617,Ts(e.length)),e.forEach(function(r){Pe(t,47,kN(r,0))}),Pe(t,618)}function rH(t){var e=1;Pe(t,619,Ts(e)),Pe(t,48,Xz({xfId:0,name:"Normal"})),Pe(t,620)}function nH(t){var e=0;Pe(t,505,Ts(e)),Pe(t,506)}function aH(t){var e=0;Pe(t,508,Yz(e,"TableStyleMedium9","PivotStyleMedium4")),Pe(t,509)}function sH(t,e){var r=da();return Pe(r,278),Kz(r,t.SSF),Qz(r),Jz(r),Zz(r),eH(r),tH(r,e.cellXfs),rH(r),nH(r),aH(r),Pe(r,279),r.end()}var iH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function lH(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Wn)||[]).forEach(function(a){var i=ft(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[iH.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function oH(){}function cH(){}var uH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,hH=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function dH(t,e,r){e.themeElements={};var n;[["clrScheme",uH,lH],["fontScheme",fH,oH],["fmtScheme",hH,cH]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var mH=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function CN(t,e){(!t||t.length===0)&&(t=Hy());var r,n={};if(!(r=t.match(mH)))throw new Error("themeElements not found in theme");return dH(r[0],n,e),n.raw=t,n}function Hy(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Xr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function pH(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var o;try{o=_C(i,{type:"array"})}catch{return}var u=Na(o,"theme/theme/theme1.xml",!0);if(u)return CN(u,r)}}function gH(t){return t.read_shift(4)}function xH(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=vH(t,4);break;case 2:e.xclrValue=lN(t);break;case 3:e.xclrValue=gH(t);break;case 4:t.l+=4;break}return t.l+=8,e}function vH(t,e){return qn(t,e)}function yH(t,e){return qn(t,e)}function _H(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=xH(t);break;case 6:n[1]=yH(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function wH(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),i=[];a-- >0;)i.push(_H(t,r-t.l));return{ixfe:n,ext:i}}function bH(t,e){e.forEach(function(r){r[0]})}function EH(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Hn(t)}}function TH(t){var e=Se(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),xn(t.name,e),e.slice(0,e.l)}function SH(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function AH(t){var e=Se(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function kH(t,e){var r=Se(8+2*e.length);return r.write_shift(4,t),xn(e,r),r.slice(0,r.l)}function CH(t){return t.l+=4,t.read_shift(4)!=0}function NH(t,e){var r=Se(8);return r.write_shift(4,t),r.write_shift(4,1),r}function RH(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,u=2;return Vi(t,function(f,d,m){switch(m){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(x){u==1?n.Cell.push({type:n.Types[x[0]-1].name,index:x[1]}):u==0&&n.Value.push({type:n.Types[x[0]-1].name,index:x[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:i.push(m),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function IH(){var t=da();return Pe(t,332),Pe(t,334,Ts(1)),Pe(t,335,TH({name:"XLDAPR",version:12e4,flags:3496657072})),Pe(t,336),Pe(t,339,kH(1,"XLDAPR")),Pe(t,52),Pe(t,35,Ts(514)),Pe(t,4096,Ts(0)),Pe(t,4097,Ja(1)),Pe(t,36),Pe(t,53),Pe(t,340),Pe(t,337,NH(1)),Pe(t,51,AH([[1,0]])),Pe(t,338),Pe(t,333),t.end()}function DH(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,i=2,o;return t.replace(Wn,function(u){var f=ft(u);switch(Js(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):i==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function NN(){var t=[Xr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function OH(t){var e=[];if(!t)return e;var r=1;return(t.match(Wn)||[]).forEach(function(n){var a=ft(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function FH(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ct(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function MH(t,e,r){var n=[];return Vi(t,function(i,o,u){switch(u){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function PH(t,e,r,n){if(!t)return t;var a=n||{},i=!1;Vi(t,function(u,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function jH(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var iu=1024;function RN(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ue("xml",null,{"xmlns:v":Aa.v,"xmlns:o":Aa.o,"xmlns:x":Aa.x,"xmlns:mv":Aa.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];iu<t*1e3;)iu+=1e3;return e.forEach(function(i){var o=Nr(i[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Ue("v:fill",f,u),m={on:"t",obscured:"t"};++iu,a=a.concat(["<v:shape"+E0({id:"_x0000_s"+iu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Ue("v:shadow",null,m),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",kn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),kn("x:AutoFill","False"),kn("x:Row",String(o.r)),kn("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function yS(t,e,r,n){var a=Array.isArray(t),i;e.forEach(function(o){var u=Nr(o.ref);if(a?(t[u.r]||(t[u.r]=[]),i=t[u.r][u.c]):i=t[o.ref],!i){i={t:"z"},a?t[u.r][u.c]=i:t[o.ref]=i;var f=Ut(t["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var d=_t(f);d!==t["!ref"]&&(t["!ref"]=d)}i.c||(i.c=[]);var m={a:o.author,t:o.t,r:o.r,T:r};o.h&&(m.h=o.h);for(var x=i.c.length-1;x>=0;--x){if(!r&&i.c[x].T)return;r&&!i.c[x].T&&i.c.splice(x,1)}if(r&&n){for(x=0;x<n.length;++x)if(m.a==n[x].id){m.a=n[x].name||m.a;break}}i.c.push(m)})}function LH(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=ft(u[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=Nr(f.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var x=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!x&&!!x[1]&&Vy(x[1])||{r:"",t:"",h:""};d.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),d.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=y.h),n.push(d)}}}}),n}function IN(t){var e=[Xr,Ue("comments",null,{xmlns:lc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var i=sr(a.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(sr(f.a))),i.push(f.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)e.push(kn("t",sr(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,u=1;u<i.length;++u)o+=`Reply:
    `+i[u]+`
`;e.push(kn("t",sr(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function BH(t,e){var r=[],n=!1,a={},i=0;return t.replace(Wn,function(u,f){var d=ft(u);switch(Js(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=f+u.length;break;case"</text>":a.t=t.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function VH(t,e,r){var n=[Xr,Ue("ThreadedComments",null,{xmlns:on.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?i=f.id:f.parentId=i,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Ue("threadedComment",kn("text",o.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function UH(t,e){var r=[],n=!1;return t.replace(Wn,function(i){var o=ft(i);switch(Js(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function zH(t){var e=[Xr,Ue("personList",null,{xmlns:on.TCMNT,"xmlns:x":lc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ue("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function HH(t){var e={};e.iauthor=t.read_shift(4);var r=fc(t);return e.rfx=r.s,e.ref=ct(r.s),t.l+=16,e}function GH(t,e){return e==null&&(e=Se(36)),e.write_shift(4,t[1].iauthor),Bu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var qH=Hn;function WH(t){return xn(t.slice(0,54))}function XH(t,e){var r=[],n=[],a={},i=!1;return Vi(t,function(u,f,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function YH(t){var e=da(),r=[];return Pe(e,628),Pe(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Pe(e,632,WH(a.a)))})}),Pe(e,631),Pe(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Nr(n[0]),e:Nr(n[0])};Pe(e,635,GH([i,a])),a.t&&a.t.length>0&&Pe(e,637,gB(a)),Pe(e,636),delete a.iauthor})}),Pe(e,634),Pe(e,629),e.end()}var $H="application/vnd.ms-office.vbaProject";function KH(t){var e=nt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");nt.utils.cfb_add(e,a,t.FileIndex[n].content)}}),nt.write(e)}function QH(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&nt.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var DN=["xlsb","xlsm","xlam","biff8","xla"];function JH(){return{"!type":"dialog"}}function ZH(){return{"!type":"dialog"}}function eG(){return{"!type":"macro"}}function tG(){return{"!type":"macro"}}var du=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,i,o){var u=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return u?m+=e.c:--m,f?d+=e.r:--d,a+(u?"":"$")+Cr(m)+(f?"":"$")+Wr(d)}return function(a,i){return e=i,a.replace(t,r)}})(),Gy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,qy=(function(){return function(e,r){return e.replace(Gy,function(n,a,i,o,u,f){var d=Iy(o)-(i?0:r.c),m=Ry(f)-(u?0:r.r),x=m==0?"":u?m+1:"["+m+"]",y=d==0?"":i?d+1:"["+d+"]";return a+"R"+x+"C"+y})}})();function ON(t,e){return t.replace(Gy,function(r,n,a,i,o,u){return n+(a=="$"?a+i:Cr(Iy(i)+e.c))+(o=="$"?o+u:Wr(Ry(u)+e.r))})}function rG(t,e,r){var n=ma(e),a=n.s,i=Nr(r),o={r:i.r-a.r,c:i.c-a.c};return ON(t,o)}function nG(t){return t.length!=1}function _S(t){return t.replace(/_xlfn\./g,"")}function Zr(t){t.l+=1}function Kl(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function FN(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return MN(t);r.biff==12&&(n=4)}var a=t.read_shift(n),i=t.read_shift(n),o=Kl(t),u=Kl(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function MN(t){var e=Kl(t),r=Kl(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function aG(t,e,r){if(r.biff<8)return MN(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),i=Kl(t),o=Kl(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function PN(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return sG(t);var n=t.read_shift(r&&r.biff==12?4:2),a=Kl(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function sG(t){var e=Kl(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function iG(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function lG(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return oG(t);var a=t.read_shift(n>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,u=(i&32768)>>15;if(i&=16383,u==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:u}}function oG(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function cG(t,e,r){var n=(t[t.l++]&96)>>5,a=FN(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function uG(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=FN(t,i,r);return[n,a,o]}function fG(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function hG(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,a]}function dG(t,e,r){var n=(t[t.l++]&96)>>5,a=aG(t,e-1,r);return[n,a]}function mG(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function wS(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function pG(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function gG(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function xG(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function vG(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function yG(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function jN(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function _G(t){return t.read_shift(2),jN(t)}function wG(t){return t.read_shift(2),jN(t)}function bG(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=PN(t,0,r);return[n,a]}function EG(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=lG(t,0,r);return[n,a]}function TG(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=PN(t,0,r);return[n,a,i]}function SG(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[Cq[a],VN[a],n]}function AG(t,e,r){var n=t[t.l++],a=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:kG(t);return[a,(i[0]===0?VN:kq)[i[1]]]}function kG(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function CG(t,e,r){t.l+=r&&r.biff==2?3:4}function NG(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function RG(t){return t.l++,Ui[t.read_shift(1)]}function IG(t){return t.l++,t.read_shift(2)}function DG(t){return t.l++,t.read_shift(1)!==0}function OG(t){return t.l++,zn(t)}function FG(t,e,r){return t.l++,ih(t,e-1,r)}function MG(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Hr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ui[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=zn(t);break;case 2:r[1]=hc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function PG(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?fc:Cp)(t));return a}function jG(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var u=0;u!=a;++u)o[i][u]=MG(t,r.biff);return o}function LG(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function BG(t,e,r){if(r.biff==5)return VG(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[n,a,i]}function VG(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function UG(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function zG(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function HG(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function GG(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,a]}var qG=qn,WG=qn,XG=qn;function oh(t,e,r){return t.l+=2,[iG(t)]}function Wy(t){return t.l+=6,[]}var YG=oh,$G=Wy,KG=Wy,QG=oh;function LN(t){return t.l+=2,[rn(t),t.read_shift(2)&1]}var JG=oh,ZG=LN,eq=Wy,tq=oh,rq=oh,nq=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function aq(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),o=nq[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:a,C:i}}function sq(t){return t.l+=2,[t.read_shift(4)]}function iq(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function lq(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function oq(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function cq(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function uq(t){return t.l+=4,[0,0]}var bS={1:{n:"PtgExp",f:NG},2:{n:"PtgTbl",f:XG},3:{n:"PtgAdd",f:Zr},4:{n:"PtgSub",f:Zr},5:{n:"PtgMul",f:Zr},6:{n:"PtgDiv",f:Zr},7:{n:"PtgPower",f:Zr},8:{n:"PtgConcat",f:Zr},9:{n:"PtgLt",f:Zr},10:{n:"PtgLe",f:Zr},11:{n:"PtgEq",f:Zr},12:{n:"PtgGe",f:Zr},13:{n:"PtgGt",f:Zr},14:{n:"PtgNe",f:Zr},15:{n:"PtgIsect",f:Zr},16:{n:"PtgUnion",f:Zr},17:{n:"PtgRange",f:Zr},18:{n:"PtgUplus",f:Zr},19:{n:"PtgUminus",f:Zr},20:{n:"PtgPercent",f:Zr},21:{n:"PtgParen",f:Zr},22:{n:"PtgMissArg",f:Zr},23:{n:"PtgStr",f:FG},26:{n:"PtgSheet",f:iq},27:{n:"PtgEndSheet",f:lq},28:{n:"PtgErr",f:RG},29:{n:"PtgBool",f:DG},30:{n:"PtgInt",f:IG},31:{n:"PtgNum",f:OG},32:{n:"PtgArray",f:mG},33:{n:"PtgFunc",f:SG},34:{n:"PtgFuncVar",f:AG},35:{n:"PtgName",f:LG},36:{n:"PtgRef",f:bG},37:{n:"PtgArea",f:cG},38:{n:"PtgMemArea",f:UG},39:{n:"PtgMemErr",f:qG},40:{n:"PtgMemNoMem",f:WG},41:{n:"PtgMemFunc",f:zG},42:{n:"PtgRefErr",f:HG},43:{n:"PtgAreaErr",f:fG},44:{n:"PtgRefN",f:EG},45:{n:"PtgAreaN",f:dG},46:{n:"PtgMemAreaN",f:oq},47:{n:"PtgMemNoMemN",f:cq},57:{n:"PtgNameX",f:BG},58:{n:"PtgRef3d",f:TG},59:{n:"PtgArea3d",f:uG},60:{n:"PtgRefErr3d",f:GG},61:{n:"PtgAreaErr3d",f:hG},255:{}},fq={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},hq={1:{n:"PtgElfLel",f:LN},2:{n:"PtgElfRw",f:tq},3:{n:"PtgElfCol",f:YG},6:{n:"PtgElfRwV",f:rq},7:{n:"PtgElfColV",f:QG},10:{n:"PtgElfRadical",f:JG},11:{n:"PtgElfRadicalS",f:eq},13:{n:"PtgElfColS",f:$G},15:{n:"PtgElfColSV",f:KG},16:{n:"PtgElfRadicalLel",f:ZG},25:{n:"PtgList",f:aq},29:{n:"PtgSxName",f:sq},255:{}},dq={0:{n:"PtgAttrNoop",f:uq},1:{n:"PtgAttrSemi",f:yG},2:{n:"PtgAttrIf",f:xG},4:{n:"PtgAttrChoose",f:pG},8:{n:"PtgAttrGoto",f:gG},16:{n:"PtgAttrSum",f:CG},32:{n:"PtgAttrBaxcel",f:wS},33:{n:"PtgAttrBaxcel",f:wS},64:{n:"PtgAttrSpace",f:_G},65:{n:"PtgAttrSpaceSemi",f:wG},128:{n:"PtgAttrIfError",f:vG},255:{}};function ch(t,e,r,n){if(n.biff<8)return qn(t,e);for(var a=t.l+e,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=jG(t,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=PG(t,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=a-t.l,e!==0&&i.push(qn(t,e)),i}function uh(t,e,r){for(var n=t.l+e,a,i,o=[];n!=t.l;)e=n-t.l,i=t[t.l],a=bS[i]||bS[fq[i]],(i===24||i===25)&&(a=(i===24?hq:dq)[t[t.l+1]]),!a||!a.f?qn(t,e):o.push([a.n,a.f(t,e,r)]);return o}function mq(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var pq={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function gq(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function BN(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ES(t,e,r){var n=BN(t,e,r);return n=="#REF"?n:gq(n,r)}function Ln(t,e,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},u=[],f,d,m,x=0,y=0,b,E="";if(!t[0]||!t[0][0])return"";for(var w=-1,T="",R=0,I=t[0].length;R<I;++R){var C=t[0][R];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),d=u.pop(),w>=0){switch(t[0][w][1][0]){case 0:T=Pr(" ",t[0][w][1][1]);break;case 1:T=Pr("\r",t[0][w][1][1]);break;default:if(T="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}d=d+T,w=-1}u.push(d+pq[C[0]]+f);break;case"PtgIsect":f=u.pop(),d=u.pop(),u.push(d+" "+f);break;case"PtgUnion":f=u.pop(),d=u.pop(),u.push(d+","+f);break;case"PtgRange":f=u.pop(),d=u.pop(),u.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=r0(C[1][1],o,a),u.push(n0(m,i));break;case"PtgRefN":m=r?r0(C[1][1],r,a):C[1][1],u.push(n0(m,i));break;case"PtgRef3d":x=C[1][1],m=r0(C[1][2],o,a),E=ES(n,x,a),u.push(E+"!"+n0(m,i));break;case"PtgFunc":case"PtgFuncVar":var W=C[1][0],U=C[1][1];W||(W=0),W&=127;var B=W==0?[]:u.slice(-W);u.length-=W,U==="User"&&(U=B.shift()),u.push(U+"("+B.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":b=JT(C[1][1],r?{s:r}:o,a),u.push(J1(b,a));break;case"PtgArea":b=JT(C[1][1],o,a),u.push(J1(b,a));break;case"PtgArea3d":x=C[1][1],b=C[1][2],E=ES(n,x,a),u.push(E+"!"+J1(b,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=C[1][2];var A=(n.names||[])[y-1]||(n[0]||[])[y],D=A?A.Name:"SH33TJSNAME"+String(y);D&&D.slice(0,6)=="_xlfn."&&!a.xlfn&&(D=D.slice(6)),u.push(D);break;case"PtgNameX":var N=C[1][1];y=C[1][2];var M;if(a.biff<=5)N<0&&(N=-N),n[N]&&(M=n[N][y]);else{var F="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][y]&&n[N][y].itab>0&&(F=n.SheetNames[n[N][y].itab-1]+"!"):F=n.SheetNames[y-1]+"!"),n[N]&&n[N][y])F+=n[N][y].Name;else if(n[0]&&n[0][y])F+=n[0][y].Name;else{var P=(BN(n,N,a)||"").split(";;");P[y-1]?F=P[y-1]:F+="SH33TJSERRX"}u.push(F);break}M||(M={Name:"SH33TJSERRY"}),u.push(M.Name);break;case"PtgParen":var V="(",Ee=")";if(w>=0){switch(T="",t[0][w][1][0]){case 2:V=Pr(" ",t[0][w][1][1])+V;break;case 3:V=Pr("\r",t[0][w][1][1])+V;break;case 4:Ee=Pr(" ",t[0][w][1][1])+Ee;break;case 5:Ee=Pr("\r",t[0][w][1][1])+Ee;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][w][1][0])}w=-1}u.push(V+u.pop()+Ee);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:C[1][1],r:C[1][0]};var we={c:r.c,r:r.r};if(n.sharedf[ct(m)]){var ie=n.sharedf[ct(m)];u.push(Ln(ie,o,we,n,a))}else{var ee=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){u.push(Ln(d[1],o,we,n,a)),ee=!0;break}ee||u.push(C[1])}break;case"PtgArray":u.push("{"+mq(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=R;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var ye=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&ye.indexOf(t[0][R][0])==-1){C=t[0][w];var ae=!0;switch(C[1][0]){case 4:ae=!1;case 0:T=Pr(" ",C[1][1]);break;case 5:ae=!1;case 1:T=Pr("\r",C[1][1]);break;default:if(T="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((ae?T:"")+u.pop()+(ae?"":T)),w=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function xq(t,e,r){var n=t.l+e,a=r.biff==2?1:2,i,o=t.read_shift(a);if(o==65535)return[[],qn(t,e-2)];var u=uh(t,o,r);return e!==o+a&&(i=ch(t,e-o-a,u,r)),t.l=n,[u,i]}function vq(t,e,r){var n=t.l+e,a=r.biff==2?1:2,i,o=t.read_shift(a);if(o==65535)return[[],qn(t,e-2)];var u=uh(t,o,r);return e!==o+a&&(i=ch(t,e-o-a,u,r)),t.l=n,[u,i]}function yq(t,e,r,n){var a=t.l+e,i=uh(t,n,r),o;return a!==t.l&&(o=ch(t,a-t.l,i,r)),[i,o]}function _q(t,e,r){var n=t.l+e,a,i=t.read_shift(2),o=uh(t,i,r);return i==65535?[[],qn(t,e-2)]:(e!==i+2&&(a=ch(t,n-i-2,o,r)),[o,a])}function wq(t){var e;if(Si(t,t.l+6)!==65535)return[zn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function bq(t){if(t==null){var e=Se(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Zo(t);return Zo(0)}function nx(t,e,r){var n=t.l+e,a=Zs(t);r.biff==2&&++t.l;var i=wq(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=vq(t,n-t.l,r);return{cell:a,val:i[0],formula:u,shared:o>>3&1,tt:i[1]}}function Eq(t,e,r,n,a){var i=tc(e,r,a),o=bq(t.v),u=Se(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var d=Se(t.bf.length),m=0;m<t.bf.length;++m)d[m]=t.bf[m];var x=gn([i,o,u,d]);return x}function Np(t,e,r){var n=t.read_shift(4),a=uh(t,n,r),i=t.read_shift(4),o=i>0?ch(t,i,a,r):null;return[a,o]}var Tq=Np,Rp=Np,Sq=Np,Aq=Np,kq={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},VN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Cq={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function TS(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Nq(t){var e="of:="+t.replace(Gy,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function ax(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function Rq(t){return t.replace(/\./,"!")}var s0={},mu={},i0=typeof Map<"u";function Xy(t,e,r){var n=0,a=t.length;if(r){if(i0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=i0?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(i0?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function Ip(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Vn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=C0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=qm(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function zo(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function so(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,i=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Ci(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=i;++a)if(t[a].numFmtId===n)return a;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function UN(t,e,r,n,a,i){try{n.cellNF&&(t.z=ot[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=wr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ot[e]==null&&Ci(k7[e]||"General",e),t.t==="e")t.w=t.w||Ui[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=w0(t.v);else if(t.t==="d"){var o=fn(t.v);(o|0)===o?t.w=o.toString(10):t.w=w0(o)}else{if(t.v===void 0)return"";t.w=Qo(t.v,mu)}else t.t==="d"?t.w=rs(e,fn(t.v),mu):t.w=rs(e,t.v,mu)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Gm(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Gm(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&i.Fills)throw u}}}function Iq(t,e,r){if(t&&t["!ref"]){var n=Ut(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function Dq(t,e){var r=Ut(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=_t(r))}var Oq=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Fq=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Mq=/<(?:\w:)?hyperlink [^>]*>/mg,Pq=/"(\w*:\w*)"/,jq=/<(?:\w:)?col\b[^>]*[\/]?>/g,Lq=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Bq=/<(?:\w:)?pageMargins[^>]*\/>/g,zN=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Vq=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Uq=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function zq(t,e,r,n,a,i,o){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",x=t.match(Fq);x?(d=t.slice(0,x.index),m=t.slice(x.index+x[0].length)):d=m=t;var y=d.match(zN);y?Yy(y[0],u,a,r):(y=d.match(Vq))&&Gq(y[0],y[1]||"",u,a,r);var b=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(b>0){var E=d.slice(b,b+50).match(Pq);E&&Dq(u,E[1])}var w=d.match(Uq);w&&w[1]&&nW(w[1],a);var T=[];if(e.cellStyles){var R=d.match(jq);R&&Jq(T,R)}x&&iW(x[1],u,e,f,i,o);var I=m.match(Lq);I&&(u["!autofilter"]=eW(I[0]));var C=[],W=m.match(Oq);if(W)for(b=0;b!=W.length;++b)C[b]=Ut(W[b].slice(W[b].indexOf('"')+1));var U=m.match(Mq);U&&$q(u,U,n);var B=m.match(Bq);if(B&&(u["!margins"]=Kq(ft(B[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=_t(f)),e.sheetRows>0&&u["!ref"]){var A=Ut(u["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>f.e.r&&(A.e.r=f.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>f.e.c&&(A.e.c=f.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),u["!fullref"]=u["!ref"],u["!ref"]=_t(A))}return T.length>0&&(u["!cols"]=T),C.length>0&&(u["!merges"]=C),u}function Hq(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+_t(t[r])+'"/>';return e+"</mergeCells>"}function Yy(t,e,r,n){var a=ft(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Vt(ur(a.codeName)))}function Gq(t,e,r,n,a){Yy(t.slice(0,t.indexOf(">")),r,n,a)}function qq(t,e,r,n,a){var i=!1,o={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[r];try{e.Workbook&&(f=e.Workbook.Sheets[r].CodeName||f)}catch{}i=!0,o.codeName=Hs(sr(f))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),u=(u||"")+Ue("outlinePr",null,d)}!i&&!u||(a[a.length]=Ue("sheetPr",u,o))}var Wq=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Xq=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Yq(t){var e={sheet:1};return Wq.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Xq.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Uy(t.password).toString(16).toUpperCase()),Ue("sheetProtection",null,e)}function $q(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var i=ft(ur(e[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Vt(i.location))):(i.Target="#"+Vt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var u=Ut(i.ref),f=u.s.r;f<=u.e.r;++f)for(var d=u.s.c;d<=u.e.c;++d){var m=ct({c:d,r:f});n?(t[f]||(t[f]=[]),t[f][d]||(t[f][d]={t:"z",v:void 0}),t[f][d].l=i):(t[m]||(t[m]={t:"z",v:void 0}),t[m].l=i)}}}function Kq(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Qq(t){return zo(t),Ue("pageMargins",null,t)}function Jq(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=ft(e[n],!0);a.hidden&&(a.hidden=yr(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,zy(a.width)),$l(a);i<=o;)t[i++]=br(a)}}function Zq(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=Ue("col",null,Ip(a,n)));return r[r.length]="</cols>",r.join("")}function eW(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function tW(t,e,r,n){var a=typeof t.ref=="string"?t.ref:_t(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=ma(a);o.s.r==o.e.r&&(o.e.r=ma(e["!ref"]).e.r,a=_t(o));for(var u=0;u<i.length;++u){var f=i[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ue("autoFilter",null,{ref:a})}var rW=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function nW(t,e){e.Views||(e.Views=[{}]),(t.match(rW)||[]).forEach(function(r,n){var a=ft(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),yr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function aW(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,a),{})}function sW(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Ui[t.v];break;case"d":n&&n.cellDates?a=wr(t.v,-1).toISOString():(t=br(t),t.t="n",a=""+(t.v=fn(wr(t.v)))),typeof t.z>"u"&&(t.z=ot[14]);break;default:a=t.v;break}var u=kn("v",sr(a)),f={r:e},d=so(n.cellXfs,t,n);switch(d!==0&&(f.s=d),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=kn("v",""+Xy(n.Strings,t.v,n.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var m=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=Ue("f",sr(t.f),m)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(f.cm=1),Ue("c",u,f)}var iW=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=b0("v"),o=b0("f");return function(f,d,m,x,y,b){for(var E=0,w="",T=[],R=[],I=0,C=0,W=0,U="",B,A,D=0,N=0,M,F,P=0,V=0,Ee=Array.isArray(b.CellXf),we,ie=[],ee=[],ye=Array.isArray(d),ae=[],Me={},Y=!1,j=!!m.sheetStubs,X=f.split(e),J=0,ne=X.length;J!=ne;++J){w=X[J].trim();var ue=w.length;if(ue!==0){var Te=0;e:for(E=0;E<ue;++E)switch(w[E]){case">":if(w[E-1]!="/"){++E;break e}if(m&&m.cellStyles){if(A=ft(w.slice(Te,E),!0),D=A.r!=null?parseInt(A.r,10):D+1,N=-1,m.sheetRows&&m.sheetRows<D)continue;Me={},Y=!1,A.ht&&(Y=!0,Me.hpt=parseFloat(A.ht),Me.hpx=Su(Me.hpt)),A.hidden=="1"&&(Y=!0,Me.hidden=!0),A.outlineLevel!=null&&(Y=!0,Me.level=+A.outlineLevel),Y&&(ae[D-1]=Me)}break;case"<":Te=E;break}if(Te>=E)break;if(A=ft(w.slice(Te,E),!0),D=A.r!=null?parseInt(A.r,10):D+1,N=-1,!(m.sheetRows&&m.sheetRows<D)){x.s.r>D-1&&(x.s.r=D-1),x.e.r<D-1&&(x.e.r=D-1),m&&m.cellStyles&&(Me={},Y=!1,A.ht&&(Y=!0,Me.hpt=parseFloat(A.ht),Me.hpx=Su(Me.hpt)),A.hidden=="1"&&(Y=!0,Me.hidden=!0),A.outlineLevel!=null&&(Y=!0,Me.level=+A.outlineLevel),Y&&(ae[D-1]=Me)),T=w.slice(E).split(t);for(var Re=0;Re!=T.length&&T[Re].trim().charAt(0)=="<";++Re);for(T=T.slice(Re),E=0;E!=T.length;++E)if(w=T[E].trim(),w.length!==0){if(R=w.match(r),I=E,C=0,W=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,R!=null&&R.length===2){for(I=0,U=R[1],C=0;C!=U.length&&!((W=U.charCodeAt(C)-64)<1||W>26);++C)I=26*I+W;--I,N=I}else++N;for(C=0;C!=w.length&&w.charCodeAt(C)!==62;++C);if(++C,A=ft(w.slice(0,C),!0),A.r||(A.r=ct({r:D-1,c:N})),U=w.slice(C),B={t:""},(R=U.match(i))!=null&&R[1]!==""&&(B.v=Vt(R[1])),m.cellFormula){if((R=U.match(o))!=null&&R[1]!==""){if(B.f=Vt(ur(R[1])).replace(/\r\n/g,`
`),m.xlfn||(B.f=_S(B.f)),R[0].indexOf('t="array"')>-1)B.F=(U.match(a)||[])[1],B.F.indexOf(":")>-1&&ie.push([Ut(B.F),B.F]);else if(R[0].indexOf('t="shared"')>-1){F=ft(R[0]);var Ce=Vt(ur(R[1]));m.xlfn||(Ce=_S(Ce)),ee[parseInt(F.si,10)]=[F,Ce,A.r]}}else(R=U.match(/<f[^>]*\/>/))&&(F=ft(R[0]),ee[F.si]&&(B.f=rG(ee[F.si][1],ee[F.si][2],A.r)));var Fe=Nr(A.r);for(C=0;C<ie.length;++C)Fe.r>=ie[C][0].s.r&&Fe.r<=ie[C][0].e.r&&Fe.c>=ie[C][0].s.c&&Fe.c<=ie[C][0].e.c&&(B.F=ie[C][1])}if(A.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(j)B.t="z";else continue;else B.t=A.t||"n";switch(x.s.c>N&&(x.s.c=N),x.e.c<N&&(x.e.c=N),B.t){case"n":if(B.v==""||B.v==null){if(!j)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!j)continue;B.t="z"}else M=s0[parseInt(B.v,10)],B.v=M.t,B.r=M.r,m.cellHTML&&(B.h=M.h);break;case"str":B.t="s",B.v=B.v!=null?ur(B.v):"",m.cellHTML&&(B.h=Ay(B.v));break;case"inlineStr":R=U.match(n),B.t="s",R!=null&&(M=Vy(R[1]))?(B.v=M.t,m.cellHTML&&(B.h=M.h)):B.v="";break;case"b":B.v=yr(B.v);break;case"d":m.cellDates?B.v=wr(B.v,1):(B.v=fn(wr(B.v,1)),B.t="n");break;case"e":(!m||m.cellText!==!1)&&(B.w=B.v),B.v=GC[B.v];break}if(P=V=0,we=null,Ee&&A.s!==void 0&&(we=b.CellXf[A.s],we!=null&&(we.numFmtId!=null&&(P=we.numFmtId),m.cellStyles&&we.fillId!=null&&(V=we.fillId))),UN(B,P,V,m,y,b),m.cellDates&&Ee&&B.t=="n"&&Pu(ot[P])&&(B.t="d",B.v=kp(B.v)),A.cm&&m.xlmeta){var st=(m.xlmeta.Cell||[])[+A.cm-1];st&&st.type=="XLDAPR"&&(B.D=!0)}if(ye){var te=Nr(A.r);d[te.r]||(d[te.r]=[]),d[te.r][te.c]=B}else d[A.r]=B}}}}ae.length>0&&(d["!rows"]=ae)}})();function lW(t,e,r,n){var a=[],i=[],o=Ut(t["!ref"]),u="",f,d="",m=[],x=0,y=0,b=t["!rows"],E=Array.isArray(t),w={r:d},T,R=-1;for(y=o.s.c;y<=o.e.c;++y)m[y]=Cr(y);for(x=o.s.r;x<=o.e.r;++x){for(i=[],d=Wr(x),y=o.s.c;y<=o.e.c;++y){f=m[y]+d;var I=E?(t[x]||[])[y]:t[f];I!==void 0&&(u=sW(I,f,t,e))!=null&&i.push(u)}(i.length>0||b&&b[x])&&(w={r:d},b&&b[x]&&(T=b[x],T.hidden&&(w.hidden=1),R=-1,T.hpx?R=N0(T.hpx):T.hpt&&(R=T.hpt),R>-1&&(w.ht=R,w.customHeight=1),T.level&&(w.outlineLevel=T.level)),a[a.length]=Ue("row",i.join(""),w))}if(b)for(;x<b.length;++x)b&&b[x]&&(w={r:x+1},T=b[x],T.hidden&&(w.hidden=1),R=-1,T.hpx?R=N0(T.hpx):T.hpt&&(R=T.hpt),R>-1&&(w.ht=R,w.customHeight=1),T.level&&(w.outlineLevel=T.level),a[a.length]=Ue("row","",w));return a.join("")}function HN(t,e,r,n){var a=[Xr,Ue("worksheet",null,{xmlns:lc[0],"xmlns:r":on.r})],i=r.SheetNames[t],o=0,u="",f=r.Sheets[i];f==null&&(f={});var d=f["!ref"]||"A1",m=Ut(d);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),d=_t(m)}n||(n={}),f["!comments"]=[];var x=[];qq(f,r,t,e,a),a[a.length]=Ue("dimension",null,{ref:d}),a[a.length]=aW(f,e,t,r),e.sheetFormat&&(a[a.length]=Ue("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=Zq(f,f["!cols"])),a[o=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=lW(f,e),u.length>0&&(a[a.length]=u)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),f["!protect"]&&(a[a.length]=Yq(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=tW(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=Hq(f["!merges"]));var y=-1,b,E=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(w){w[1].Target&&(b={ref:w[0]},w[1].Target.charAt(0)!="#"&&(E=nr(n,-1,sr(w[1].Target).replace(/#.*$/,""),kt.HLINK),b["r:id"]="rId"+E),(y=w[1].Target.indexOf("#"))>-1&&(b.location=sr(w[1].Target.slice(y+1))),w[1].Tooltip&&(b.tooltip=sr(w[1].Tooltip)),a[a.length]=Ue("hyperlink",null,b))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=Qq(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=kn("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:d}))),x.length>0&&(E=nr(n,-1,"../drawings/drawing"+(t+1)+".xml",kt.DRAW),a[a.length]=Ue("drawing",null,{"r:id":"rId"+E}),f["!drawing"]=x),f["!comments"].length>0&&(E=nr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",kt.VML),a[a.length]=Ue("legacyDrawing",null,{"r:id":"rId"+E}),f["!legacy"]=E),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function oW(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function cW(t,e,r){var n=Se(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;a.hpx?i=N0(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var d={r:t,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var x=-1,y=-1,b=m<<10;b<m+1<<10;++b){d.c=b;var E=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ct(d)];E&&(x<0&&(x=b),y=b)}x<0||(++u,n.write_shift(4,x),n.write_shift(4,y))}var w=n.l;return n.l=f,n.write_shift(4,u),n.l=w,n.length>n.l?n.slice(0,n.l):n}function uW(t,e,r,n){var a=cW(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Pe(t,0,a)}var fW=fc,hW=Bu;function dW(){}function mW(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=xB(t),r}function pW(t,e,r){r==null&&(r=Se(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Um({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),BC(t,r),r.slice(0,r.l)}function gW(t){var e=as(t);return[e]}function xW(t,e,r){return r==null&&(r=Se(8)),oc(e,r)}function vW(t){var e=cc(t);return[e]}function yW(t,e,r){return r==null&&(r=Se(4)),uc(e,r)}function _W(t){var e=as(t),r=t.read_shift(1);return[e,r,"b"]}function wW(t,e,r){return r==null&&(r=Se(9)),oc(e,r),r.write_shift(1,t.v?1:0),r}function bW(t){var e=cc(t),r=t.read_shift(1);return[e,r,"b"]}function EW(t,e,r){return r==null&&(r=Se(5)),uc(e,r),r.write_shift(1,t.v?1:0),r}function TW(t){var e=as(t),r=t.read_shift(1);return[e,r,"e"]}function SW(t,e,r){return r==null&&(r=Se(9)),oc(e,r),r.write_shift(1,t.v),r}function AW(t){var e=cc(t),r=t.read_shift(1);return[e,r,"e"]}function kW(t,e,r){return r==null&&(r=Se(8)),uc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function CW(t){var e=as(t),r=t.read_shift(4);return[e,r,"s"]}function NW(t,e,r){return r==null&&(r=Se(12)),oc(e,r),r.write_shift(4,e.v),r}function RW(t){var e=cc(t),r=t.read_shift(4);return[e,r,"s"]}function IW(t,e,r){return r==null&&(r=Se(8)),uc(e,r),r.write_shift(4,e.v),r}function DW(t){var e=as(t),r=zn(t);return[e,r,"n"]}function OW(t,e,r){return r==null&&(r=Se(16)),oc(e,r),Zo(t.v,r),r}function GN(t){var e=cc(t),r=zn(t);return[e,r,"n"]}function FW(t,e,r){return r==null&&(r=Se(12)),uc(e,r),Zo(t.v,r),r}function MW(t){var e=as(t),r=My(t);return[e,r,"n"]}function PW(t,e,r){return r==null&&(r=Se(12)),oc(e,r),VC(t.v,r),r}function jW(t){var e=cc(t),r=My(t);return[e,r,"n"]}function LW(t,e,r){return r==null&&(r=Se(8)),uc(e,r),VC(t.v,r),r}function BW(t){var e=as(t),r=Dy(t);return[e,r,"is"]}function VW(t){var e=as(t),r=Hn(t);return[e,r,"str"]}function UW(t,e,r){return r==null&&(r=Se(12+4*t.v.length)),oc(e,r),xn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function zW(t){var e=cc(t),r=Hn(t);return[e,r,"str"]}function HW(t,e,r){return r==null&&(r=Se(8+4*t.v.length)),uc(e,r),xn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function GW(t,e,r){var n=t.l+e,a=as(t);a.r=r["!row"];var i=t.read_shift(1),o=[a,i,"b"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Ln(u,null,a,r.supbooks,r)}else t.l=n;return o}function qW(t,e,r){var n=t.l+e,a=as(t);a.r=r["!row"];var i=t.read_shift(1),o=[a,i,"e"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Ln(u,null,a,r.supbooks,r)}else t.l=n;return o}function WW(t,e,r){var n=t.l+e,a=as(t);a.r=r["!row"];var i=zn(t),o=[a,i,"n"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Ln(u,null,a,r.supbooks,r)}else t.l=n;return o}function XW(t,e,r){var n=t.l+e,a=as(t);a.r=r["!row"];var i=Hn(t),o=[a,i,"str"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Ln(u,null,a,r.supbooks,r)}else t.l=n;return o}var YW=fc,$W=Bu;function KW(t,e){return e==null&&(e=Se(4)),e.write_shift(4,t),e}function QW(t,e){var r=t.l+e,n=fc(t),a=Oy(t),i=Hn(t),o=Hn(t),u=Hn(t);t.l=r;var f={rfx:n,relId:a,loc:i,display:u};return o&&(f.Tooltip=o),f}function JW(t,e){var r=Se(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Bu({s:Nr(t[0]),e:Nr(t[0])},r),Fy("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return xn(a||"",r),xn(t[1].Tooltip||"",r),xn("",r),r.slice(0,r.l)}function ZW(){}function eX(t,e,r){var n=t.l+e,a=UC(t),i=t.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var u=Tq(t,n-t.l,r);o[1]=u}else t.l=n;return o}function tX(t,e,r){var n=t.l+e,a=fc(t),i=[a];if(r.cellFormula){var o=Aq(t,n-t.l,r);i[1]=o,t.l=n}else t.l=n;return i}function rX(t,e,r){r==null&&(r=Se(18));var n=Ip(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var qN=["left","right","top","bottom","header","footer"];function nX(t){var e={};return qN.forEach(function(r){e[r]=zn(t)}),e}function aX(t,e){return e==null&&(e=Se(48)),zo(t),qN.forEach(function(r){Zo(t[r],e)}),e}function sX(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function iX(t,e,r){r==null&&(r=Se(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function lX(t){var e=Se(24);return e.write_shift(4,4),e.write_shift(4,1),Bu(t,e),e}function oX(t,e){return e==null&&(e=Se(66)),e.write_shift(2,t.password?Uy(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function cX(){}function uX(){}function fX(t,e,r,n,a,i,o){if(!t)return t;var u=e||{};n||(n={"!id":{}});var f=u.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,y=!1,b,E,w,T,R,I,C,W,U,B=[];u.biff=12,u["!row"]=0;var A=0,D=!1,N=[],M={},F=u.supbooks||a.supbooks||[[]];if(F.sharedf=M,F.arrayf=N,F.SheetNames=a.SheetNames||a.Sheets.map(function(ye){return ye.name}),!u.supbooks&&(u.supbooks=F,a.Names))for(var P=0;P<a.Names.length;++P)F[0][P+1]=a.Names[P];var V=[],Ee=[],we=!1;R0[16]={n:"BrtShortReal",f:GN};var ie;if(Vi(t,function(ae,Me,Y){if(!y)switch(Y){case 148:d=ae;break;case 0:b=ae,u.sheetRows&&u.sheetRows<=b.r&&(y=!0),W=Wr(T=b.r),u["!row"]=b.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=Su(ae.hpt)),Ee[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:ae[2]},ae[2]){case"n":E.v=ae[1];break;case"s":C=s0[ae[1]],E.v=C.t,E.r=C.r;break;case"b":E.v=!!ae[1];break;case"e":E.v=ae[1],u.cellText!==!1&&(E.w=Ui[E.v]);break;case"str":E.t="s",E.v=ae[1];break;case"is":E.t="s",E.v=ae[1].t;break}if((w=o.CellXf[ae[0].iStyleRef])&&UN(E,w.numFmtId,null,u,i,o),R=ae[0].c==-1?R+1:ae[0].c,u.dense?(f[T]||(f[T]=[]),f[T][R]=E):f[Cr(R)+W]=E,u.cellFormula){for(D=!1,A=0;A<N.length;++A){var j=N[A];b.r>=j[0].s.r&&b.r<=j[0].e.r&&R>=j[0].s.c&&R<=j[0].e.c&&(E.F=_t(j[0]),D=!0)}!D&&ae.length>3&&(E.f=ae[3])}if(m.s.r>b.r&&(m.s.r=b.r),m.s.c>R&&(m.s.c=R),m.e.r<b.r&&(m.e.r=b.r),m.e.c<R&&(m.e.c=R),u.cellDates&&w&&E.t=="n"&&Pu(ot[w.numFmtId])){var X=Mo(E.v);X&&(E.t="d",E.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}ie&&(ie.type=="XLDAPR"&&(E.D=!0),ie=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;E={t:"z",v:void 0},R=ae[0].c==-1?R+1:ae[0].c,u.dense?(f[T]||(f[T]=[]),f[T][R]=E):f[Cr(R)+W]=E,m.s.r>b.r&&(m.s.r=b.r),m.s.c>R&&(m.s.c=R),m.e.r<b.r&&(m.e.r=b.r),m.e.c<R&&(m.e.c=R),ie&&(ie.type=="XLDAPR"&&(E.D=!0),ie=void 0);break;case 176:B.push(ae);break;case 49:ie=((u.xlmeta||{}).Cell||[])[ae-1];break;case 494:var J=n["!id"][ae.relId];for(J?(ae.Target=J.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=J):ae.relId==""&&(ae.Target="#"+ae.loc),T=ae.rfx.s.r;T<=ae.rfx.e.r;++T)for(R=ae.rfx.s.c;R<=ae.rfx.e.c;++R)u.dense?(f[T]||(f[T]=[]),f[T][R]||(f[T][R]={t:"z",v:void 0}),f[T][R].l=ae):(I=ct({c:R,r:T}),f[I]||(f[I]={t:"z",v:void 0}),f[I].l=ae);break;case 426:if(!u.cellFormula)break;N.push(ae),U=u.dense?f[T][R]:f[Cr(R)+W],U.f=Ln(ae[1],m,{r:b.r,c:R},F,u),U.F=_t(ae[0]);break;case 427:if(!u.cellFormula)break;M[ct(ae[0].s)]=ae[1],U=u.dense?f[T][R]:f[Cr(R)+W],U.f=Ln(ae[1],m,{r:b.r,c:R},F,u);break;case 60:if(!u.cellStyles)break;for(;ae.e>=ae.s;)V[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},we||(we=!0,zy(ae.w/256)),$l(V[ae.e+1]);break;case 161:f["!autofilter"]={ref:_t(ae)};break;case 476:f["!margins"]=ae;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ae.name&&(a.Sheets[r].CodeName=ae.name),(ae.above||ae.left)&&(f["!outline"]={above:ae.above,left:ae.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ae.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!Me.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=_t(d||m)),u.sheetRows&&f["!ref"]){var ee=Ut(f["!ref"]);u.sheetRows<=+ee.e.r&&(ee.e.r=u.sheetRows-1,ee.e.r>m.e.r&&(ee.e.r=m.e.r),ee.e.r<ee.s.r&&(ee.s.r=ee.e.r),ee.e.c>m.e.c&&(ee.e.c=m.e.c),ee.e.c<ee.s.c&&(ee.s.c=ee.e.c),f["!fullref"]=f["!ref"],f["!ref"]=_t(ee))}return B.length>0&&(f["!merges"]=B),V.length>0&&(f["!cols"]=V),Ee.length>0&&(f["!rows"]=Ee),f}function hX(t,e,r,n,a,i,o){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=br(e),e.z=e.z||ot[14],e.v=fn(wr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r,c:n};switch(f.s=so(a.cellXfs,e,a),e.l&&i["!links"].push([ct(f),e.l]),e.c&&i["!comments"].push([ct(f),e.c]),e.t){case"s":case"str":return a.bookSST?(u=Xy(a.Strings,e.v,a.revStrings),f.t="s",f.v=u,o?Pe(t,18,IW(e,f)):Pe(t,7,NW(e,f))):(f.t="str",o?Pe(t,17,HW(e,f)):Pe(t,6,UW(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Pe(t,13,LW(e,f)):Pe(t,2,PW(e,f)):o?Pe(t,16,FW(e,f)):Pe(t,5,OW(e,f)),!0;case"b":return f.t="b",o?Pe(t,15,EW(e,f)):Pe(t,4,wW(e,f)),!0;case"e":return f.t="e",o?Pe(t,14,kW(e,f)):Pe(t,3,SW(e,f)),!0}return o?Pe(t,12,yW(e,f)):Pe(t,1,xW(e,f)),!0}function dX(t,e,r,n){var a=Ut(e["!ref"]||"A1"),i,o="",u=[];Pe(t,145);var f=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var m=a.s.r;m<=d;++m){o=Wr(m),uW(t,e,a,m);var x=!1;if(m<=a.e.r)for(var y=a.s.c;y<=a.e.c;++y){m===a.s.r&&(u[y]=Cr(y)),i=u[y]+o;var b=f?(e[m]||[])[y]:e[i];if(!b){x=!1;continue}x=hX(t,b,m,y,n,e,x)}}Pe(t,146)}function mX(t,e){!e||!e["!merges"]||(Pe(t,177,KW(e["!merges"].length)),e["!merges"].forEach(function(r){Pe(t,176,$W(r))}),Pe(t,178))}function pX(t,e){!e||!e["!cols"]||(Pe(t,390),e["!cols"].forEach(function(r,n){r&&Pe(t,60,rX(n,r))}),Pe(t,391))}function gX(t,e){!e||!e["!ref"]||(Pe(t,648),Pe(t,649,lX(Ut(e["!ref"]))),Pe(t,650))}function xX(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=nr(r,-1,n[1].Target.replace(/#.*$/,""),kt.HLINK);Pe(t,494,JW(n,a))}}),delete e["!links"]}function vX(t,e,r,n){if(e["!comments"].length>0){var a=nr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",kt.VML);Pe(t,551,Fy("rId"+a)),e["!legacy"]=a}}function yX(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],i=typeof a.ref=="string"?a.ref:_t(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=ma(i);u.s.r==u.e.r&&(u.e.r=ma(e["!ref"]).e.r,i=_t(u));for(var f=0;f<o.length;++f){var d=o[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Pe(t,161,Bu(Ut(i))),Pe(t,162)}}function _X(t,e,r){Pe(t,133),Pe(t,137,iX(e,r)),Pe(t,138),Pe(t,134)}function wX(t,e){e["!protect"]&&Pe(t,535,oX(e["!protect"]))}function bX(t,e,r,n){var a=da(),i=r.SheetNames[t],o=r.Sheets[i]||{},u=i;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var f=Ut(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Pe(a,129),(r.vbaraw||o["!outline"])&&Pe(a,147,pW(u,o["!outline"])),Pe(a,148,hW(f)),_X(a,o,r.Workbook),pX(a,o),dX(a,o,t,e),wX(a,o),yX(a,o,r,t),mX(a,o),xX(a,o,n),o["!margins"]&&Pe(a,476,aX(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&gX(a,o),vX(a,o,t,n),Pe(a,130),a.end()}function EX(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var a=Vt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,a,n]}function TX(t,e,r,n,a,i){var o=i||{"!type":"chart"};if(!t)return i;var u=0,f=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var y=EX(x);m.s.r=m.s.c=0,m.e.c=u,d=Cr(u),y[0].forEach(function(b,E){o[d+Wr(E)]={t:"n",v:b,z:y[1]},f=E}),m.e.r<f&&(m.e.r=f),++u}),u>0&&(o["!ref"]=_t(m)),o}function SX(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,u=t.match(zN);return u&&Yy(u[0],i,a,r),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function AX(t,e){t.l+=10;var r=Hn(t);return{name:r}}function kX(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Vi(t,function(f,d,m){switch(m){case 550:i["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var $y=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],CX=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],NX=[],RX=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function SS(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var i=e[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=yr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function AS(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=yr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function WN(t){AS(t.WBProps,$y),AS(t.CalcPr,RX),SS(t.WBView,CX),SS(t.Sheets,NX),mu.date1904=yr(t.WBProps.date1904)}function IX(t){return!t.Workbook||!t.Workbook.WBProps?"false":yr(t.Workbook.WBProps.date1904)?"true":"false"}var DX="][*?/\\".split("");function XN(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return DX.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function OX(t,e,r){t.forEach(function(n,a){XN(n);for(var i=0;i<a;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[a]&&e[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function FX(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];OX(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)Iq(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var MX=/<\w+:workbook/;function PX(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(t.replace(Wn,function(f,d){var m=ft(f);switch(Js(m[0])){case"<?xml":break;case"<workbook":f.match(MX)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=m[a];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":$y.forEach(function(x){if(m[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=yr(m[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(m[x[0]],10);break;default:r.WBProps[x[0]]=m[x[0]]}}),m.codeName&&(r.WBProps.CodeName=ur(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=Vt(ur(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=ur(m.name),m.comment&&(i.Comment=m.comment),m.localSheetId&&(i.Sheet=+m.localSheetId),yr(m.hidden||"0")&&(i.Hidden=!0),o=d+f.length;break;case"</definedName>":i.Ref=Vt(ur(t.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),lc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return WN(r),r}function YN(t){var e=[Xr];e[e.length]=Ue("workbook",null,{xmlns:lc[0],"xmlns:r":on.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&($y.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ue("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:sr(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Ue("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=Ue("definedName",sr(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function jX(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Yx(t),r.name=Hn(t),r}function LX(t,e){return e||(e=Se(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Fy(t.strRelID,e),xn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function BX(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?Hn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function VX(t,e){e||(e=Se(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),BC(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function UX(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function zX(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),i=vB(t),o=Sq(t,0,r),u=Oy(t);t.l=n;var f={Name:i,Ptg:o};return a<268435455&&(f.Sheet=a),u&&(f.Comment=u),f}function HX(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],R0[16]={n:"BrtFRTArchID$",f:UX},Vi(t,function(f,d,m){switch(m){case 156:o.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Ln(f.Ptg,null,null,o,e),delete e.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,f]):o[0]=[m,f],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(f),o.XTI=o.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(m),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),WN(r),r.Names=i,r.supbooks=o,r}function GX(t,e){Pe(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Pe(t,156,LX(a))}Pe(t,144)}function qX(t,e){e||(e=Se(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return xn("SheetJS",e),xn(Fm.version,e),xn(Fm.version,e),xn("7262",e),e.length>e.l?e.slice(0,e.l):e}function WX(t,e){e||(e=Se(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function XX(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Pe(t,135),Pe(t,158,WX(a)),Pe(t,136))}}function YX(t,e){var r=da();return Pe(r,131),Pe(r,128,qX()),Pe(r,153,VX(t.Workbook&&t.Workbook.WBProps||null)),XX(r,t),GX(r,t),Pe(r,132),r.end()}function $X(t,e,r){return e.slice(-4)===".bin"?HX(t,r):PX(t,r)}function KX(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?fX(t,n,r,a,i,o,u):zq(t,n,r,a,i,o,u)}function QX(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?kX(t,n,r,a,i):SX(t,n,r,a,i)}function JX(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?eG():tG()}function ZX(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?JH():ZH()}function eY(t,e,r,n){return e.slice(-4)===".bin"?$z(t,r,n):jz(t,r,n)}function tY(t,e,r){return CN(t,r)}function rY(t,e,r){return e.slice(-4)===".bin"?rz(t,r):ZU(t,r)}function nY(t,e,r){return e.slice(-4)===".bin"?XH(t,r):LH(t,r)}function aY(t,e,r){return e.slice(-4)===".bin"?MH(t):OH(t)}function sY(t,e,r,n){return r.slice(-4)===".bin"?PH(t,e,r,n):void 0}function iY(t,e,r){return e.slice(-4)===".bin"?RH(t,e,r):DH(t,e,r)}function lY(t,e,r){return(e.slice(-4)===".bin"?YX:YN)(t)}function oY(t,e,r,n,a){return(e.slice(-4)===".bin"?bX:HN)(t,r,n,a)}function cY(t,e,r){return(e.slice(-4)===".bin"?sH:AN)(t,r)}function uY(t,e,r){return(e.slice(-4)===".bin"?sz:vN)(t,r)}function fY(t,e,r){return(e.slice(-4)===".bin"?YH:IN)(t)}function hY(t){return(t.slice(-4)===".bin"?IH:NN)()}var $N=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,KN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match($N),i,o,u,f;if(a)for(f=0;f!=a.length;++f)i=a[f].match(KN),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?u="xmlns"+i[1].slice(6):u=i[1].slice(o+1),n[u]=i[2].slice(1,i[2].length-1));return n}function dY(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match($N),a,i,o,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(KN),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var l0;function mY(t,e){var r=l0[t]||Vt(t);return r==="General"?Qo(e):rs(r,e)}function pY(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=yr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=wr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Vt(e)]=a}function gY(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ui[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=w0(t.v):t.w=Qo(t.v):t.w=mY(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=l0[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Pu(n)){var a=Mo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function xY(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=Nz[n.Pattern]||n.Pattern)}t[e.ID]=e}function vY(t,e,r,n,a,i,o,u,f,d){var m="General",x=n.StyleID,y={};d=d||{};var b=[],E=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&o&&(x=o.StyleID);i[x]!==void 0&&(i[x].nf&&(m=i[x].nf),i[x].Interior&&b.push(i[x].Interior),!!i[x].Parent);)x=i[x].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=yr(t);break;case"String":n.t="s",n.r=HT(Vt(t)),n.v=t.indexOf("<")>-1?Vt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(wr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Vt(t):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=GC[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=HT(e||t));break}if(gY(n,m,d),d.cellFormula!==!1)if(n.Formula){var w=Vt(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=du(w,a),delete n.Formula,n.ArrayRange=="RC"?n.F=du("RC:RC",a):n.ArrayRange&&(n.F=du(n.ArrayRange,a),f.push([Ut(n.F),n.F]))}else for(E=0;E<f.length;++E)a.r>=f[E][0].s.r&&a.r<=f[E][0].e.r&&a.c>=f[E][0].s.c&&a.c<=f[E][0].e.c&&(n.F=f[E][1]);d.cellStyles&&(b.forEach(function(T){!y.patternType&&T.patternType&&(y.patternType=T.patternType)}),n.s=y),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function yY(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function sx(t,e){var r=e||{};ju();var n=Wf(ky(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ur(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=br(r);return o.type="string",Tu.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Qe){a.indexOf("<"+Qe)>=0&&(i=!0)}),i)return a$(n,r);l0={"General Number":"General","General Date":ot[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ot[15],"Short Date":ot[14],"Long Time":ot[19],"Medium Time":ot[18],"Short Time":ot[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ot[2],Standard:ot[4],Percent:ot[10],Scientific:ot[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],d,m={},x=[],y=r.dense?[]:{},b="",E={},w={},T=xs('<Data ss:Type="String">'),R=0,I=0,C=0,W={s:{r:2e6,c:2e6},e:{r:0,c:0}},U={},B={},A="",D=0,N=[],M={},F={},P=0,V=[],Ee=[],we={},ie=[],ee,ye=!1,ae=[],Me=[],Y={},j=0,X=0,J={Sheets:[],WBProps:{date1904:!1}},ne={};T0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ue="";u=T0.exec(n);)switch(u[3]=(ue=u[3]).toLowerCase()){case"data":if(ue=="data"){if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?vY(n.slice(R,u.index),A,T,f[f.length-1][0]=="comment"?we:E,{c:I,r:C},U,ie[I],w,ae,r):(A="",T=xs(u[0]),R=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Ee.length>0&&(E.c=Ee),(!r.sheetRows||r.sheetRows>C)&&E.v!==void 0&&(r.dense?(y[C]||(y[C]=[]),y[C][I]=E):y[Cr(I)+Wr(C)]=E),E.HRef&&(E.l={Target:Vt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(j=I+(parseInt(E.MergeAcross,10)|0),X=C+(parseInt(E.MergeDown,10)|0),N.push({s:{c:I,r:C},e:{c:j,r:X}})),!r.sheetStubs)E.MergeAcross?I=j+1:++I;else if(E.MergeAcross||E.MergeDown){for(var Te=I;Te<=j;++Te)for(var Re=C;Re<=X;++Re)(Te>I||Re>C)&&(r.dense?(y[Re]||(y[Re]=[]),y[Re][Te]={t:"z"}):y[Cr(Te)+Wr(Re)]={t:"z"});I=j+1}else++I;else E=dY(u[0]),E.Index&&(I=+E.Index-1),I<W.s.c&&(W.s.c=I),I>W.e.c&&(W.e.c=I),u[0].slice(-2)==="/>"&&++I,Ee=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(C<W.s.r&&(W.s.r=C),C>W.e.r&&(W.e.r=C),u[0].slice(-2)==="/>"&&(w=xs(u[0]),w.Index&&(C=+w.Index-1)),I=0,++C):(w=xs(u[0]),w.Index&&(C=+w.Index-1),Y={},(w.AutoFitHeight=="0"||w.Height)&&(Y.hpx=parseInt(w.Height,10),Y.hpt=N0(Y.hpx),Me[C]=Y),w.Hidden=="1"&&(Y.hidden=!0,Me[C]=Y));break;case"worksheet":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));x.push(b),W.s.r<=W.e.r&&W.s.c<=W.e.c&&(y["!ref"]=_t(W),r.sheetRows&&r.sheetRows<=W.e.r&&(y["!fullref"]=y["!ref"],W.e.r=r.sheetRows-1,y["!ref"]=_t(W))),N.length&&(y["!merges"]=N),ie.length>0&&(y["!cols"]=ie),Me.length>0&&(y["!rows"]=Me),m[b]=y}else W={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=I=0,f.push([u[3],!1]),d=xs(u[0]),b=Vt(d.Name),y=r.dense?[]:{},N=[],ae=[],Me=[],ne={name:b,Hidden:0},J.Sheets.push(ne);break;case"table":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),ie=[],ye=!1}break;case"style":u[1]==="/"?xY(U,B,r):B=xs(u[0]);break;case"numberformat":B.nf=Vt(xs(u[0]).Format||"General"),l0[B.nf]&&(B.nf=l0[B.nf]);for(var Ce=0;Ce!=392&&ot[Ce]!=B.nf;++Ce);if(Ce==392){for(Ce=57;Ce!=392;++Ce)if(ot[Ce]==null){Ci(B.nf,Ce);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(ee=xs(u[0]),ee.Hidden&&(ee.hidden=!0,delete ee.Hidden),ee.Width&&(ee.wpx=parseInt(ee.Width,10)),!ye&&ee.wpx>10){ye=!0,Vn=TN;for(var Fe=0;Fe<ie.length;++Fe)ie[Fe]&&$l(ie[Fe])}ye&&$l(ee),ie[ee.Index-1||ie.length]=ee;for(var st=0;st<+ee.Span;++st)ie[ie.length]=br(ee);break;case"namedrange":if(u[1]==="/")break;J.Names||(J.Names=[]);var te=ft(u[0]),Ct={Name:te.Name,Ref:du(te.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(Ct.Sheet=J.Sheets.length-1),J.Names.push(Ct);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?A+=n.slice(D,u.index):D=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=xs(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?HB(M,ue,n.slice(P,u.index)):P=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));yY(we),Ee.push(we)}else f.push([u[3],!1]),d=xs(u[0]),we={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var lt=xs(u[0]);y["!autofilter"]={ref:du(lt.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return IS(n,r);var It=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:It=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:It=!1}break;case"excelworkbook":switch(u[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:It=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:It=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(P,u.index)){case"SheetHidden":ne.Hidden=1;break;case"SheetVeryHidden":ne.Hidden=2;break}else P=u.index+u[0].length;break;case"header":y["!margins"]||zo(y["!margins"]={},"xlml"),isNaN(+ft(u[0]).Margin)||(y["!margins"].header=+ft(u[0]).Margin);break;case"footer":y["!margins"]||zo(y["!margins"]={},"xlml"),isNaN(+ft(u[0]).Margin)||(y["!margins"].footer=+ft(u[0]).Margin);break;case"pagemargins":var ht=ft(u[0]);y["!margins"]||zo(y["!margins"]={},"xlml"),isNaN(+ht.Top)||(y["!margins"].top=+ht.Top),isNaN(+ht.Left)||(y["!margins"].left=+ht.Left),isNaN(+ht.Right)||(y["!margins"].right=+ht.Right),isNaN(+ht.Bottom)||(y["!margins"].bottom=+ht.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:It=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:It=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:It=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:It=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:It=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:It=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:It=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:It=!1}break;case"smarttags":break;default:It=!1;break}if(It||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?pY(F,ue,V,n.slice(P,u.index)):(V=u,P=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var le={};return!r.bookSheets&&!r.bookProps&&(le.Sheets=m),le.SheetNames=x,le.Workbook=J,le.SSF=br(ot),le.Props=M,le.Custprops=F,le}function tv(t,e){switch(Qy(e=e||{}),e.type||"base64"){case"base64":return sx(Oa(t),e);case"binary":case"buffer":case"file":return sx(t,e);case"array":return sx(no(t),e)}}function _Y(t,e){var r=[];return t.Props&&r.push(GB(t.Props,e)),t.Custprops&&r.push(qB(t.Props,t.Custprops)),r.join("")}function wY(){return""}function bY(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var i=[];i.push(Ue("NumberFormat",null,{"ss:Format":sr(ot[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Ue("Style",i.join(""),o))}),Ue("Styles",r.join(""))}function QN(t){return Ue("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+qy(t.Ref,{r:0,c:0})})}function EY(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(QN(a)))}return Ue("Names",r.join(""))}function TY(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],o=0;o<a.length;++o){var u=a[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||i.push(QN(u)))}return i.join("")}function SY(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Ue("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Ue("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Ue("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ue("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(kn("ProtectContents","True")),t["!protect"].objects&&a.push(kn("ProtectObjects","True")),t["!protect"].scenarios&&a.push(kn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(kn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(kn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Ue("WorksheetOptions",a.join(""),{xmlns:Aa.x})}function AY(t){return t.map(function(e){var r=X7(e.t||""),n=Ue("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",n,{"ss:Author":e.a})}).join("")}function kY(t,e,r,n,a,i,o){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+sr(qy(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var f=Nr(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=sr(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=sr(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],m=0;m!=d.length;++m)d[m].s.c!=o.c||d[m].s.r!=o.r||(d[m].e.c>d[m].s.c&&(u["ss:MergeAcross"]=d[m].e.c-d[m].s.c),d[m].e.r>d[m].s.r&&(u["ss:MergeDown"]=d[m].e.r-d[m].s.r));var x="",y="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":x="Number",y=String(t.v);break;case"b":x="Boolean",y=t.v?"1":"0";break;case"e":x="Error",y=Ui[t.v];break;case"d":x="DateTime",y=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ot[14]);break;case"s":x="String",y=W7(t.v||"");break}var b=so(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+b),u["ss:Index"]=o.c+1;var E=t.v!=null?y:"",w=t.t=="z"?"":'<Data ss:Type="'+x+'">'+E+"</Data>";return(t.c||[]).length>0&&(w+=AY(t.c)),Ue("Cell",w,u)}function CY(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Su(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function NY(t,e,r,n){if(!t["!ref"])return"";var a=Ut(t["!ref"]),i=t["!merges"]||[],o=0,u=[];t["!cols"]&&t["!cols"].forEach(function(T,R){$l(T);var I=!!T.width,C=Ip(R,T),W={"ss:Index":R+1};I&&(W["ss:Width"]=k0(C.width)),T.hidden&&(W["ss:Hidden"]="1"),u.push(Ue("Column",null,W))});for(var f=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var m=[CY(d,(t["!rows"]||[])[d])],x=a.s.c;x<=a.e.c;++x){var y=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>x)&&!(i[o].s.r>d)&&!(i[o].e.c<x)&&!(i[o].e.r<d)){(i[o].s.c!=x||i[o].s.r!=d)&&(y=!0);break}if(!y){var b={r:d,c:x},E=ct(b),w=f?(t[d]||[])[x]:t[E];m.push(kY(w,E,t,e,r,n,b))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function RY(t,e,r){var n=[],a=r.SheetNames[t],i=r.Sheets[a],o=i?TY(i,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?NY(i,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(SY(i,e,t,r)),n.join("")}function IY(t,e){e||(e={}),t.SSF||(t.SSF=br(ot)),t.SSF&&(ju(),Tp(t.SSF),e.revssf=Ap(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],so(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(_Y(t,e)),r.push(wY()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ue("Worksheet",RY(n,e,t),{"ss:Name":sr(t.SheetNames[n])}));return r[2]=bY(t,e),r[3]=EY(t),Xr+Ue("Workbook",r.join(""),{xmlns:Aa.ss,"xmlns:o":Aa.o,"xmlns:x":Aa.x,"xmlns:ss":Aa.ss,"xmlns:dt":Aa.dt,"xmlns:html":Aa.html})}function DY(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=EB(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=TB(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var OY=[60,1084,2066,2165,2175];function FY(t,e,r,n,a){var i=n,o=[],u=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}o.push(u),r.l+=i;for(var f=Si(r,r.l),d=rv[f],m=0;d!=null&&OY.indexOf(f)>-1;)i=Si(r,r.l+2),m=r.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),u=r.slice(m,r.l+4+i),o.push(u),r.l+=4+i,d=rv[f=Si(r,r.l)];var x=gn(o);Sn(x,0);var y=0;x.lens=[];for(var b=0;b<o.length;++b)x.lens.push(y),y+=o[b].length;if(x.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+x.length+" < "+n;return e.f(x,x.length,a)}function js(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ot[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ui[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=w0(t.v):t.w=Qo(t.v):t.w=rs(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Pu(ot[n]||String(n))){var a=Mo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function $d(t,e,r){return{v:t,ixfe:e,t:r}}function MY(t,e){var r={opts:{}},n={},a=e.dense?[]:{},i={},o={},u=null,f=[],d="",m={},x,y="",b,E,w,T,R={},I=[],C,W,U=[],B=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},N=function(mt){return mt<8?Bo[mt]:mt<64&&B[mt-8]||Bo[mt]},M=function(mt,Kt,Ir){var Tt=Kt.XF.data;if(!(!Tt||!Tt.patternType||!Ir||!Ir.cellStyles)){Kt.s={},Kt.s.patternType=Tt.patternType;var Yt;(Yt=A0(N(Tt.icvFore)))&&(Kt.s.fgColor={rgb:Yt}),(Yt=A0(N(Tt.icvBack)))&&(Kt.s.bgColor={rgb:Yt})}},F=function(mt,Kt,Ir){if(!(Y>1)&&!(Ir.sheetRows&&mt.r>=Ir.sheetRows)){if(Ir.cellStyles&&Kt.XF&&Kt.XF.data&&M(mt,Kt,Ir),delete Kt.ixfe,delete Kt.XF,x=mt,y=ct(mt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),mt.r<o.s.r&&(o.s.r=mt.r),mt.c<o.s.c&&(o.s.c=mt.c),mt.r+1>o.e.r&&(o.e.r=mt.r+1),mt.c+1>o.e.c&&(o.e.c=mt.c+1),Ir.cellFormula&&Kt.f){for(var Tt=0;Tt<I.length;++Tt)if(!(I[Tt][0].s.c>mt.c||I[Tt][0].s.r>mt.r)&&!(I[Tt][0].e.c<mt.c||I[Tt][0].e.r<mt.r)){Kt.F=_t(I[Tt][0]),(I[Tt][0].s.c!=mt.c||I[Tt][0].s.r!=mt.r)&&delete Kt.f,Kt.f&&(Kt.f=""+Ln(I[Tt][1],o,mt,ae,P));break}}Ir.dense?(a[mt.r]||(a[mt.r]=[]),a[mt.r][mt.c]=Kt):a[y]=Kt}},P={enc:!1,sbcch:0,snames:[],sharedf:R,arrayf:I,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(P.password=e.password);var V,Ee=[],we=[],ie=[],ee=[],ye=!1,ae=[];ae.SheetNames=P.snames,ae.sharedf=P.sharedf,ae.arrayf=P.arrayf,ae.names=[],ae.XTI=[];var Me=0,Y=0,j=0,X=[],J=[],ne;P.codepage=1200,ws(1200);for(var ue=!1;t.l<t.length-1;){var Te=t.l,Re=t.read_shift(2);if(Re===0&&Me===10)break;var Ce=t.l===t.length?0:t.read_shift(2),Fe=rv[Re];if(Fe&&Fe.f){if(e.bookSheets&&Me===133&&Re!==133)break;if(Me=Re,Fe.r===2||Fe.r==12){var st=t.read_shift(2);if(Ce-=2,!P.enc&&st!==Re&&((st&255)<<8|st>>8)!==Re)throw new Error("rt mismatch: "+st+"!="+Re);Fe.r==12&&(t.l+=10,Ce-=10)}var te={};if(Re===10?te=Fe.f(t,Ce,P):te=FY(Re,Fe,t,Ce,P),Y==0&&[9,521,1033,2057].indexOf(Me)===-1)continue;switch(Re){case 34:r.opts.Date1904=A.WBProps.date1904=te;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(t.l=0),P.enc=te,!e.password)throw new Error("File is password-protected");if(te.valid==null)throw new Error("Encryption scheme unsupported");if(!te.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=te;break;case 66:var Ct=Number(te);switch(Ct){case 21010:Ct=1200;break;case 32768:Ct=1e4;break;case 32769:Ct=1252;break}ws(P.codepage=Ct),ue=!0;break;case 317:P.rrtabid=te;break;case 25:P.winlocked=te;break;case 439:r.opts.RefreshAll=te;break;case 12:r.opts.CalcCount=te;break;case 16:r.opts.CalcDelta=te;break;case 17:r.opts.CalcIter=te;break;case 13:r.opts.CalcMode=te;break;case 14:r.opts.CalcPrecision=te;break;case 95:r.opts.CalcSaveRecalc=te;break;case 15:P.CalcRefMode=te;break;case 2211:r.opts.FullCalc=te;break;case 129:te.fDialog&&(a["!type"]="dialog"),te.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),te.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:U.push(te);break;case 430:ae.push([te]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(te);break;case 24:case 536:ne={Name:te.Name,Ref:Ln(te.rgce,o,null,ae,P)},te.itab>0&&(ne.Sheet=te.itab-1),ae.names.push(ne),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(te),te.Name=="_xlnm._FilterDatabase"&&te.itab>0&&te.rgce&&te.rgce[0]&&te.rgce[0][0]&&te.rgce[0][0][0]=="PtgArea3d"&&(J[te.itab-1]={ref:_t(te.rgce[0][0][1][2])});break;case 22:P.ExternCount=te;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(te),ae.XTI=ae.XTI.concat(te);break;case 2196:if(P.biff<8)break;ne!=null&&(ne.Comment=te[1]);break;case 18:a["!protect"]=te;break;case 19:te!==0&&P.WTF&&console.error("Password verifier: "+te);break;case 133:i[te.pos]=te,P.snames.push(te.name);break;case 10:{if(--Y)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=_t(o),e.sheetRows&&e.sheetRows<=o.e.r){var lt=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=_t(o),o.e.r=lt}o.e.r++,o.e.c++}Ee.length>0&&(a["!merges"]=Ee),we.length>0&&(a["!objects"]=we),ie.length>0&&(a["!cols"]=ie),ee.length>0&&(a["!rows"]=ee),A.Sheets.push(D)}d===""?m=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Re]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[te.BIFFVer]||8),P.biffguess=te.BIFFVer==0,te.BIFFVer==0&&te.dt==4096&&(P.biff=5,ue=!0,ws(P.codepage=28591)),P.biff==8&&te.BIFFVer==0&&te.dt==16&&(P.biff=2),Y++)break;if(a=e.dense?[]:{},P.biff<8&&!ue&&(ue=!0,ws(P.codepage=e.codepage||1252)),P.biff<5||te.BIFFVer==0&&te.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var It={pos:t.l-Ce,name:d};i[It.pos]=It,P.snames.push(d)}else d=(i[Te]||{name:""}).name;te.dt==32&&(a["!type"]="chart"),te.dt==64&&(a["!type"]="macro"),Ee=[],we=[],P.arrayf=I=[],ie=[],ee=[],ye=!1,D={Hidden:(i[Te]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[te.r]||[])[te.c]:a[ct({c:te.c,r:te.r})])&&++te.c,C={ixfe:te.ixfe,XF:U[te.ixfe]||{},v:te.val,t:"n"},j>0&&(C.z=X[C.ixfe>>8&63]),js(C,e,r.opts.Date1904),F({c:te.c,r:te.r},C,e);break;case 5:case 517:C={ixfe:te.ixfe,XF:U[te.ixfe],v:te.val,t:te.t},j>0&&(C.z=X[C.ixfe>>8&63]),js(C,e,r.opts.Date1904),F({c:te.c,r:te.r},C,e);break;case 638:C={ixfe:te.ixfe,XF:U[te.ixfe],v:te.rknum,t:"n"},j>0&&(C.z=X[C.ixfe>>8&63]),js(C,e,r.opts.Date1904),F({c:te.c,r:te.r},C,e);break;case 189:for(var ht=te.c;ht<=te.C;++ht){var le=te.rkrec[ht-te.c][0];C={ixfe:le,XF:U[le],v:te.rkrec[ht-te.c][1],t:"n"},j>0&&(C.z=X[C.ixfe>>8&63]),js(C,e,r.opts.Date1904),F({c:ht,r:te.r},C,e)}break;case 6:case 518:case 1030:{if(te.val=="String"){u=te;break}if(C=$d(te.val,te.cell.ixfe,te.tt),C.XF=U[C.ixfe],e.cellFormula){var Qe=te.formula;if(Qe&&Qe[0]&&Qe[0][0]&&Qe[0][0][0]=="PtgExp"){var Be=Qe[0][0][1][0],Ye=Qe[0][0][1][1],et=ct({r:Be,c:Ye});R[et]?C.f=""+Ln(te.formula,o,te.cell,ae,P):C.F=((e.dense?(a[Be]||[])[Ye]:a[et])||{}).F}else C.f=""+Ln(te.formula,o,te.cell,ae,P)}j>0&&(C.z=X[C.ixfe>>8&63]),js(C,e,r.opts.Date1904),F(te.cell,C,e),u=te}break;case 7:case 519:if(u)u.val=te,C=$d(te,u.cell.ixfe,"s"),C.XF=U[C.ixfe],e.cellFormula&&(C.f=""+Ln(u.formula,o,u.cell,ae,P)),j>0&&(C.z=X[C.ixfe>>8&63]),js(C,e,r.opts.Date1904),F(u.cell,C,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{I.push(te);var Et=ct(te[0].s);if(b=e.dense?(a[te[0].s.r]||[])[te[0].s.c]:a[Et],e.cellFormula&&b){if(!u||!Et||!b)break;b.f=""+Ln(te[1],o,te[0],ae,P),b.F=_t(te[0])}}break;case 1212:{if(!e.cellFormula)break;if(y){if(!u)break;R[ct(u.cell)]=te[0],b=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[ct(u.cell)],(b||{}).f=""+Ln(te[0],o,x,ae,P)}}break;case 253:C=$d(f[te.isst].t,te.ixfe,"s"),f[te.isst].h&&(C.h=f[te.isst].h),C.XF=U[C.ixfe],j>0&&(C.z=X[C.ixfe>>8&63]),js(C,e,r.opts.Date1904),F({c:te.c,r:te.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:te.ixfe,XF:U[te.ixfe],t:"z"},j>0&&(C.z=X[C.ixfe>>8&63]),js(C,e,r.opts.Date1904),F({c:te.c,r:te.r},C,e));break;case 190:if(e.sheetStubs)for(var zt=te.c;zt<=te.C;++zt){var Bt=te.ixfe[zt-te.c];C={ixfe:Bt,XF:U[Bt],t:"z"},j>0&&(C.z=X[C.ixfe>>8&63]),js(C,e,r.opts.Date1904),F({c:zt,r:te.r},C,e)}break;case 214:case 516:case 4:C=$d(te.val,te.ixfe,"s"),C.XF=U[C.ixfe],j>0&&(C.z=X[C.ixfe>>8&63]),js(C,e,r.opts.Date1904),F({c:te.c,r:te.r},C,e);break;case 0:case 512:Y===1&&(o=te);break;case 252:f=te;break;case 1054:if(P.biff==4){X[j++]=te[1];for(var Br=0;Br<j+163&&ot[Br]!=te[1];++Br);Br>=163&&Ci(te[1],j+163)}else Ci(te[1],te[0]);break;case 30:{X[j++]=te;for(var Nn=0;Nn<j+163&&ot[Nn]!=te;++Nn);Nn>=163&&Ci(te,j+163)}break;case 229:Ee=Ee.concat(te);break;case 93:we[te.cmo[0]]=P.lastobj=te;break;case 438:P.lastobj.TxO=te;break;case 127:P.lastobj.ImData=te;break;case 440:for(T=te[0].s.r;T<=te[0].e.r;++T)for(w=te[0].s.c;w<=te[0].e.c;++w)b=e.dense?(a[T]||[])[w]:a[ct({c:w,r:T})],b&&(b.l=te[1]);break;case 2048:for(T=te[0].s.r;T<=te[0].e.r;++T)for(w=te[0].s.c;w<=te[0].e.c;++w)b=e.dense?(a[T]||[])[w]:a[ct({c:w,r:T})],b&&b.l&&(b.l.Tooltip=te[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;b=e.dense?(a[te[0].r]||[])[te[0].c]:a[ct(te[0])];var pa=we[te[2]];b||(e.dense?(a[te[0].r]||(a[te[0].r]=[]),b=a[te[0].r][te[0].c]={t:"z"}):b=a[ct(te[0])]={t:"z"},o.e.r=Math.max(o.e.r,te[0].r),o.s.r=Math.min(o.s.r,te[0].r),o.e.c=Math.max(o.e.c,te[0].c),o.s.c=Math.min(o.s.c,te[0].c)),b.c||(b.c=[]),E={a:te[1],t:pa.TxO.t},b.c.push(E)}break;case 2173:bH(U[te.ixfe],te.ext);break;case 125:{if(!P.cellStyles)break;for(;te.e>=te.s;)ie[te.e--]={width:te.w/256,level:te.level||0,hidden:!!(te.flags&1)},ye||(ye=!0,zy(te.w/256)),$l(ie[te.e+1])}break;case 520:{var dr={};te.level!=null&&(ee[te.r]=dr,dr.level=te.level),te.hidden&&(ee[te.r]=dr,dr.hidden=!0),te.hpt&&(ee[te.r]=dr,dr.hpt=te.hpt,dr.hpx=Su(te.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||zo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Re]]=te;break;case 161:a["!margins"]||zo(a["!margins"]={}),a["!margins"].header=te.header,a["!margins"].footer=te.footer;break;case 574:te.RTL&&(A.Views[0].RTL=!0);break;case 146:B=te;break;case 2198:V=te;break;case 140:W=te;break;case 442:d?D.CodeName=te||D.name:A.WBProps.CodeName=te||"ThisWorkbook";break}}else Fe||console.error("Missing Info for XLS Record 0x"+Re.toString(16)),t.l+=Ce}return r.SheetNames=Lr(i).sort(function(Rn,mt){return Number(Rn)-Number(mt)}).map(function(Rn){return i[Rn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&J.forEach(function(Rn,mt){r.Sheets[r.SheetNames[mt]]["!autofilter"]=Rn}),r.Strings=f,r.SSF=br(ot),P.enc&&(r.Encryption=P.enc),V&&(r.Themes=V),r.Metadata={},W!==void 0&&(r.Metadata.Country=W),ae.names.length>0&&(A.Names=ae.names),r.Workbook=A,r}var o0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function PY(t,e,r){var n=nt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=lS(n,$x,o0.DSI);for(var i in a)e[i]=a[i]}catch(d){if(r.WTF)throw d}var o=nt.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var u=lS(o,Kx,o0.SI);for(var f in u)e[f]==null&&(e[f]=u[f])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(KC(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function jY(t,e){var r=[],n=[],a=[],i=0,o,u=jT($x,"n"),f=jT(Kx,"n");if(t.Props)for(o=Lr(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(u,o[i])?r:Object.prototype.hasOwnProperty.call(f,o[i])?n:a).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=Lr(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(u,o[i])?r:Object.prototype.hasOwnProperty.call(f,o[i])?n:a).push([o[i],t.Custprops[o[i]]]);var d=[];for(i=0;i<a.length;++i)nN.indexOf(a[i][0])>-1||$C.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);n.length&&nt.utils.cfb_add(e,"/SummaryInformation",oS(n,o0.SI,f,Kx)),(r.length||d.length)&&nt.utils.cfb_add(e,"/DocumentSummaryInformation",oS(r,o0.DSI,u,$x,d.length?d:null,o0.UDI))}function JN(t,e){e||(e={}),Qy(e),vy(),e.codepage&&xy(e.codepage);var r,n;if(t.FullPaths){if(nt.find(t,"/encryption"))throw new Error("File is password-protected");r=nt.find(t,"!CompObj"),n=nt.find(t,"/Workbook")||nt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ca(Oa(t));break;case"binary":t=Ca(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Sn(t,0),n={content:t}}var a,i;if(r&&DY(r),e.bookProps&&!e.bookSheets)a={};else{var o=At?"buffer":"array";if(n&&n.content)a=MY(n.content,e);else if((i=nt.find(t,"PerfectOffice_MAIN"))&&i.content)a=Uo.to_workbook(i.content,(e.type=o,e));else if((i=nt.find(t,"NativeContent_MAIN"))&&i.content)a=Uo.to_workbook(i.content,(e.type=o,e));else throw(i=nt.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&nt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=KH(t))}var u={};return t.FullPaths&&PY(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}function LY(t,e){var r=e||{},n=nt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return nt.utils.cfb_add(n,a,ZN(t,r)),r.biff==8&&(t.Props||t.Custprops)&&jY(t,n),r.biff==8&&t.vbaraw&&QH(n,nt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var R0={0:{f:oW},1:{f:gW},2:{f:MW},3:{f:TW},4:{f:_W},5:{f:DW},6:{f:VW},7:{f:CW},8:{f:XW},9:{f:WW},10:{f:GW},11:{f:qW},12:{f:vW},13:{f:jW},14:{f:AW},15:{f:bW},16:{f:GN},17:{f:zW},18:{f:RW},19:{f:Dy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:zX},40:{},42:{},43:{f:Vz},44:{f:Lz},45:{f:Hz},46:{f:qz},47:{f:Gz},48:{},49:{f:fB},50:{},51:{f:SH},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:mN},62:{f:BW},63:{f:FH},64:{f:cX},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sX},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:mW},148:{f:fW,p:16},151:{f:ZW},152:{},153:{f:BX},154:{},155:{},156:{f:jX},157:{},158:{},159:{T:1,f:tz},160:{T:-1},161:{T:1,f:fc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:YW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:EH},336:{T:-1},337:{f:CH,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Yx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:dN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:eX},427:{f:tX},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nX},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:dW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:QW},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Yx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:qH},633:{T:1},634:{T:-1},635:{T:1,f:HH},636:{T:-1},637:{f:pB},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:AX},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:uX},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},rv={6:{f:nx},10:{f:bl},12:{f:rn},13:{f:rn},14:{f:Hr},15:{f:Hr},16:{f:zn},17:{f:Hr},18:{f:Hr},19:{f:rn},20:{f:mS},21:{f:mS},23:{f:dN},24:{f:gS},25:{f:Hr},26:{},27:{},28:{f:uU},29:{},34:{f:Hr},35:{f:pS},38:{f:zn},39:{f:zn},40:{f:zn},41:{f:zn},42:{f:Hr},43:{f:Hr},47:{f:bz},49:{f:jV},51:{f:rn},60:{},61:{f:DV},64:{f:Hr},65:{f:PV},66:{f:rn},77:{},80:{},81:{},82:{},85:{f:rn},89:{},90:{},91:{},92:{f:wV},93:{f:dU},94:{},95:{f:Hr},96:{},97:{},99:{f:Hr},125:{f:mN},128:{f:JV},129:{f:EV},130:{f:rn},131:{f:Hr},132:{f:Hr},133:{f:TV},134:{},140:{f:wU},141:{f:rn},144:{},146:{f:TU},151:{},152:{},153:{},154:{},155:{},156:{f:rn},157:{},158:{},160:{f:IU},161:{f:kU},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:YV},190:{f:$V},193:{f:bl},197:{},198:{},199:{},200:{},201:{},202:{f:Hr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:rn},220:{},221:{f:Hr},222:{},224:{f:QV},225:{f:_V},226:{f:bl},227:{},229:{f:fU},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:AV},253:{f:BV},255:{f:CV},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:aN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Hr},353:{f:bl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:nU},431:{f:Hr},432:{},433:{},434:{},437:{},438:{f:gU},439:{f:Hr},440:{f:xU},441:{},442:{f:lh},443:{},444:{f:rn},445:{},446:{},448:{f:bl},449:{f:IV,r:2},450:{f:bl},512:{f:fS},513:{f:RU},515:{f:tU},516:{f:UV},517:{f:dS},519:{f:DU},520:{f:NV},523:{},545:{f:xS},549:{f:uS},566:{},574:{f:FV},638:{f:XV},659:{},1048:{},1054:{f:HV},1084:{},1212:{f:lU},2048:{f:yU},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Wd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:bl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:SU,r:12},2173:{f:wH,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Hr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:iU,r:12},2197:{},2198:{f:pH,r:12},2199:{},2200:{},2201:{},2202:{f:oU,r:12},2203:{f:bl},2204:{},2205:{},2206:{},2207:{},2211:{f:RV},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:rn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:CU},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:EU},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:fS},1:{},2:{f:jU},3:{f:MU},4:{f:FU},5:{f:dS},7:{f:BU},8:{},9:{f:Wd},11:{},22:{f:rn},30:{f:qV},31:{},32:{},33:{f:xS},36:{},37:{f:uS},50:{f:VU},62:{},52:{},67:{},68:{f:rn},69:{},86:{},126:{},127:{f:OU},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:UU},223:{},234:{},354:{},421:{},518:{f:nx},521:{f:Wd},536:{f:gS},547:{f:pS},561:{},579:{},1030:{f:nx},1033:{f:Wd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ze(t,e,r,n){var a=e;if(!isNaN(a)){var i=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&Ny(r)&&t.push(r)}}function BY(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return ze(t,e,r,a);var i=e;if(!isNaN(i)){for(var o=r.parts||[],u=0,f=0,d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;var m=t.next(4);for(m.write_shift(2,i),m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d;f<a;){for(m=t.next(4),m.write_shift(2,60),d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d}}}function fh(t,e,r){return t||(t=Se(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function VY(t,e,r,n){var a=Se(9);return fh(a,t,e),sN(r,n||"b",a),a}function UY(t,e,r){var n=Se(8+2*r.length);return fh(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function zY(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?fn(wr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?ze(t,2,LU(r,n,a)):ze(t,3,PU(r,n,a));return;case"b":case"e":ze(t,5,VY(r,n,e.v,e.t));return;case"s":case"str":ze(t,4,UY(r,n,(e.v||"").slice(0,255)));return}ze(t,1,fh(null,r,n))}function HY(t,e,r,n){var a=Array.isArray(e),i=Ut(e["!ref"]||"A1"),o,u="",f=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=_t(i)}for(var d=i.s.r;d<=i.e.r;++d){u=Wr(d);for(var m=i.s.c;m<=i.e.c;++m){d===i.s.r&&(f[m]=Cr(m)),o=f[m]+u;var x=a?(e[d]||[])[m]:e[o];x&&zY(t,x,d,m)}}}function GY(t,e){for(var r=e||{},n=da(),a=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ze(n,r.biff==4?1033:r.biff==3?521:9,By(t,16,r)),HY(n,t.Sheets[t.SheetNames[a]],a,r),ze(n,10),n.end()}function qY(t,e,r){ze(t,49,LV({sz:12,name:"Arial"},r))}function WY(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&ze(t,1054,GV(a,e[a],r))})}function XY(t,e){var r=Se(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ze(t,2151,r),r=Se(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),uN(Ut(e["!ref"]||"A1"),r),r.write_shift(4,4),ze(t,2152,r)}function YY(t,e){for(var r=0;r<16;++r)ze(t,224,hS({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ze(t,224,hS(n,0,e))})}function $Y(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];ze(t,440,vU(n)),n[1].Tooltip&&ze(t,2048,_U(n))}delete e["!links"]}function KY(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&ze(t,125,AU(Ip(a,n),a))})}}function QY(t,e,r,n,a){var i=16+so(a.cellXfs,e,a);if(e.v==null&&!e.bf){ze(t,513,tc(r,n,i));return}if(e.bf)ze(t,6,Eq(e,r,n,a,i));else switch(e.t){case"d":case"n":var o=e.t=="d"?fn(wr(e.v)):e.v;ze(t,515,rU(r,n,o,i));break;case"b":case"e":ze(t,517,eU(r,n,e.v,i,a,e.t));break;case"s":case"str":if(a.bookSST){var u=Xy(a.Strings,e.v,a.revStrings);ze(t,253,VV(r,n,u,i))}else ze(t,516,zV(r,n,(e.v||"").slice(0,255),i,a));break;default:ze(t,513,tc(r,n,i))}}function JY(t,e,r){var n=da(),a=r.SheetNames[t],i=r.Sheets[a]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[t]||{},f=Array.isArray(i),d=e.biff==8,m,x="",y=[],b=Ut(i["!ref"]||"A1"),E=d?65536:16384;if(b.e.c>255||b.e.r>=E){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");b.e.c=Math.min(b.e.c,255),b.e.r=Math.min(b.e.c,E-1)}ze(n,2057,By(r,16,e)),ze(n,13,Ja(1)),ze(n,12,Ja(100)),ze(n,15,Qn(!0)),ze(n,17,Qn(!1)),ze(n,16,Zo(.001)),ze(n,95,Qn(!0)),ze(n,42,Qn(!1)),ze(n,43,Qn(!1)),ze(n,130,Ja(1)),ze(n,128,ZV()),ze(n,131,Qn(!1)),ze(n,132,Qn(!1)),d&&KY(n,i["!cols"]),ze(n,512,WV(b,e)),d&&(i["!links"]=[]);for(var w=b.s.r;w<=b.e.r;++w){x=Wr(w);for(var T=b.s.c;T<=b.e.c;++T){w===b.s.r&&(y[T]=Cr(T)),m=y[T]+x;var R=f?(i[w]||[])[T]:i[m];R&&(QY(n,R,w,T,e),d&&R.l&&i["!links"].push([m,R.l]))}}var I=u.CodeName||u.name||a;return d&&ze(n,574,MV((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&ze(n,229,hU(i["!merges"])),d&&$Y(n,i),ze(n,442,iN(I)),d&&XY(n,i),ze(n,10),n.end()}function ZY(t,e,r){var n=da(),a=(t||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},u=r.biff==8,f=r.biff==5;if(ze(n,2057,By(t,5,r)),r.bookType=="xla"&&ze(n,135),ze(n,225,u?Ja(1200):null),ze(n,193,eV(2)),f&&ze(n,191),f&&ze(n,192),ze(n,226),ze(n,92,bV("SheetJS",r)),ze(n,66,Ja(u?1200:1252)),u&&ze(n,353,Ja(0)),u&&ze(n,448),ze(n,317,NU(t.SheetNames.length)),u&&t.vbaraw&&ze(n,211),u&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";ze(n,442,iN(d))}ze(n,156,Ja(17)),ze(n,25,Qn(!1)),ze(n,18,Qn(!1)),ze(n,19,Ja(0)),u&&ze(n,431,Qn(!1)),u&&ze(n,444,Ja(0)),ze(n,61,OV()),ze(n,64,Qn(!1)),ze(n,141,Ja(0)),ze(n,34,Qn(IX(t)=="true")),ze(n,14,Qn(!0)),u&&ze(n,439,Qn(!1)),ze(n,218,Ja(0)),qY(n,t,r),WY(n,t.SSF,r),YY(n,r),u&&ze(n,352,Qn(!1));var m=n.end(),x=da();u&&ze(x,140,bU()),u&&r.Strings&&BY(x,252,kV(r.Strings)),ze(x,10);var y=x.end(),b=da(),E=0,w=0;for(w=0;w<t.SheetNames.length;++w)E+=(u?12:11)+(u?2:1)*t.SheetNames[w].length;var T=m.length+E+y.length;for(w=0;w<t.SheetNames.length;++w){var R=i[w]||{};ze(b,133,SV({pos:T,hs:R.Hidden||0,dt:0,name:t.SheetNames[w]},r)),T+=e[w].length}var I=b.end();if(E!=I.length)throw new Error("BS8 "+E+" != "+I.length);var C=[];return m.length&&C.push(m),I.length&&C.push(I),y.length&&C.push(y),gn(C)}function e$(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=br(ot)),t&&t.SSF&&(ju(),Tp(t.SSF),r.revssf=Ap(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Jy(r),r.cellXfs=[],so(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=JY(a,r,t);return n.unshift(ZY(t,n,r)),gn(n)}function ZN(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=ma(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return e$(t,e);case 4:case 3:case 2:return GY(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function kS(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),o=a.index,u=i&&i.index||t.length,f=L7(t.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,x=0,y=0,b={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(o=0;o<f.length;++o){var w=f[o].trim(),T=w.slice(0,3).toLowerCase();if(T=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}m=0;continue}if(!(T!="<td"&&T!="<th")){var R=w.split(/<\/t[dh]>/i);for(u=0;u<R.length;++u){var I=R[u].trim();if(I.match(/<t[dh]/i)){for(var C=I,W=0;C.charAt(0)=="<"&&(W=C.indexOf(">"))>-1;)C=C.slice(W+1);for(var U=0;U<E.length;++U){var B=E[U];B.s.c==m&&B.s.r<d&&d<=B.e.r&&(m=B.e.c+1,U=-1)}var A=ft(I.slice(0,I.indexOf(">")));y=A.colspan?+A.colspan:1,((x=+A.rowspan)>1||y>1)&&E.push({s:{r:d,c:m},e:{r:d+(x||1)-1,c:m+y-1}});var D=A.t||A["data-t"]||"";if(!C.length){m+=y;continue}if(C=EC(C),b.s.r>d&&(b.s.r=d),b.e.r<d&&(b.e.r=d),b.s.c>m&&(b.s.c=m),b.e.c<m&&(b.e.c=m),!C.length){m+=y;continue}var N={t:"s",v:C};r.raw||!C.trim().length||D=="s"||(C==="TRUE"?N={t:"b",v:!0}:C==="FALSE"?N={t:"b",v:!1}:isNaN(Es(C))?isNaN(Eu(C).getDate())||(N={t:"d",v:wr(C)},r.cellDates||(N={t:"n",v:fn(N.v)}),N.z=r.dateNF||ot[14]):N={t:"n",v:Es(C)}),r.dense?(n[d]||(n[d]=[]),n[d][m]=N):n[ct({r:d,c:m})]=N,m+=y}}}}return n["!ref"]=_t(b),E.length&&(n["!merges"]=E),n}function t$(t,e,r,n){for(var a=t["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var u=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>o)&&!(a[d].e.r<r||a[d].e.c<o)){if(a[d].s.r<r||a[d].s.c<o){u=-1;break}u=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(u<0)){var m=ct({r,c:o}),x=n.dense?(t[r]||[])[o]:t[m],y=x&&x.v!=null&&(x.h||Ay(x.w||(ji(x),x.w)||""))||"",b={};u>1&&(b.rowspan=u),f>1&&(b.colspan=f),n.editable?y='<span contenteditable="true">'+y+"</span>":x&&(b["data-t"]=x&&x.t||"z",x.v!=null&&(b["data-v"]=x.v),x.z!=null&&(b["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+x.l.Target+'">'+y+"</a>")),b.id=(n.id||"sjs")+"-"+m,i.push(Ue("td",y,b))}}var E="<tr>";return E+i.join("")+"</tr>"}var r$='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',n$="</body></html>";function a$(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ao(kS(r[0],e),e);var n=t_();return r.forEach(function(a,i){r_(n,kS(a,e),"Sheet"+(i+1))}),n}function s$(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function e3(t,e){var r=e||{},n=r.header!=null?r.header:r$,a=r.footer!=null?r.footer:n$,i=[n],o=ma(t["!ref"]);r.dense=Array.isArray(t),i.push(s$(t,o,r));for(var u=o.s.r;u<=o.e.r;++u)i.push(t$(t,o,u,r));return i.push("</table>"+a),i.join("")}function t3(t,e,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Nr(n.origin):n.origin;a=o.r,i=o.c}var u=e.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var m=ma(t["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),a==-1&&(d.e.r=a=m.e.r+1)}var x=[],y=0,b=t["!rows"]||(t["!rows"]=[]),E=0,w=0,T=0,R=0,I=0,C=0;for(t["!cols"]||(t["!cols"]=[]);E<u.length&&w<f;++E){var W=u[E];if(CS(W)){if(n.display)continue;b[w]={hidden:!0}}var U=W.children;for(T=R=0;T<U.length;++T){var B=U[T];if(!(n.display&&CS(B))){var A=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):EC(B.innerHTML),D=B.getAttribute("data-z")||B.getAttribute("z");for(y=0;y<x.length;++y){var N=x[y];N.s.c==R+i&&N.s.r<w+a&&w+a<=N.e.r&&(R=N.e.c+1-i,y=-1)}C=+B.getAttribute("colspan")||1,((I=+B.getAttribute("rowspan")||1)>1||C>1)&&x.push({s:{r:w+a,c:R+i},e:{r:w+a+(I||1)-1,c:R+i+(C||1)-1}});var M={t:"s",v:A},F=B.getAttribute("data-t")||B.getAttribute("t")||"";A!=null&&(A.length==0?M.t=F||"z":n.raw||A.trim().length==0||F=="s"||(A==="TRUE"?M={t:"b",v:!0}:A==="FALSE"?M={t:"b",v:!1}:isNaN(Es(A))?isNaN(Eu(A).getDate())||(M={t:"d",v:wr(A)},n.cellDates||(M={t:"n",v:fn(M.v)}),M.z=n.dateNF||ot[14]):M={t:"n",v:Es(A)})),M.z===void 0&&D!=null&&(M.z=D);var P="",V=B.getElementsByTagName("A");if(V&&V.length)for(var Ee=0;Ee<V.length&&!(V[Ee].hasAttribute("href")&&(P=V[Ee].getAttribute("href"),P.charAt(0)!="#"));++Ee);P&&P.charAt(0)!="#"&&(M.l={Target:P}),n.dense?(t[w+a]||(t[w+a]=[]),t[w+a][R+i]=M):t[ct({c:R+i,r:w+a})]=M,d.e.c<R+i&&(d.e.c=R+i),R+=C}}++w}return x.length&&(t["!merges"]=(t["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,w-1+a),t["!ref"]=_t(d),w>=f&&(t["!fullref"]=_t((d.e.r=u.length-E+w-1+a,d))),t}function r3(t,e){var r=e||{},n=r.dense?[]:{};return t3(n,t,e)}function i$(t,e){return ao(r3(t,e),e)}function CS(t){var e="",r=l$(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function l$(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function o$(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Vt(e.replace(/<[^>]*>/g,""));return[r]}var NS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function n3(t,e){var r=e||{},n=ky(t),a=[],i,o,u={name:""},f="",d=0,m,x,y={},b=[],E=r.dense?[]:{},w,T,R={value:""},I="",C=0,W=[],U=-1,B=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,N={},M=[],F={},P=0,V=0,Ee=[],we=1,ie=1,ee=[],ye={Names:[]},ae={},Me=["",""],Y=[],j={},X="",J=0,ne=!1,ue=!1,Te=0;for(T0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=T0.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?E["!ref"]=_t(A):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(E["!fullref"]=E["!ref"],A.e.r=r.sheetRows-1,E["!ref"]=_t(A)),M.length&&(E["!merges"]=M),Ee.length&&(E["!rows"]=Ee),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),b.push(m.name),y[m.name]=E,ue=!1):w[0].charAt(w[0].length-2)!=="/"&&(m=ft(w[0],!1),U=B=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,E=r.dense?[]:{},M=[],Ee=[],ue=!0);break;case"table-row-group":w[1]==="/"?--D:++D;break;case"table-row":case"":if(w[1]==="/"){U+=we,we=1;break}if(x=ft(w[0],!1),x.?U=x.-1:U==-1&&(U=0),we=+x["number-rows-repeated"]||1,we<10)for(Te=0;Te<we;++Te)D>0&&(Ee[U+Te]={level:D});B=-1;break;case"covered-table-cell":w[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(E[U]||(E[U]=[]),E[U][B]={t:"z"}):E[ct({r:U,c:B})]={t:"z"}),I="",W=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++B,R=ft(w[0],!1),ie=parseInt(R["number-columns-repeated"]||"1",10),T={t:"z",v:null},R.formula&&r.cellFormula!=!1&&(T.f=TS(Vt(R.formula))),(R.||R["value-type"])=="string"&&(T.t="s",T.v=Vt(R["string-value"]||""),r.dense?(E[U]||(E[U]=[]),E[U][B]=T):E[ct({r:U,c:B})]=T),B+=ie-1;else if(w[1]!=="/"){++B,I="",C=0,W=[],ie=1;var Re=we?U+we-1:U;if(B>A.e.c&&(A.e.c=B),B<A.s.c&&(A.s.c=B),U<A.s.r&&(A.s.r=U),Re>A.e.r&&(A.e.r=Re),R=ft(w[0],!1),Y=[],j={},T={t:R.||R["value-type"],v:null},r.cellFormula)if(R.formula&&(R.formula=Vt(R.formula)),R["number-matrix-columns-spanned"]&&R["number-matrix-rows-spanned"]&&(P=parseInt(R["number-matrix-rows-spanned"],10)||0,V=parseInt(R["number-matrix-columns-spanned"],10)||0,F={s:{r:U,c:B},e:{r:U+P-1,c:B+V-1}},T.F=_t(F),ee.push([F,T.F])),R.formula)T.f=TS(R.formula);else for(Te=0;Te<ee.length;++Te)U>=ee[Te][0].s.r&&U<=ee[Te][0].e.r&&B>=ee[Te][0].s.c&&B<=ee[Te][0].e.c&&(T.F=ee[Te][1]);switch((R["number-columns-spanned"]||R["number-rows-spanned"])&&(P=parseInt(R["number-rows-spanned"],10)||0,V=parseInt(R["number-columns-spanned"],10)||0,F={s:{r:U,c:B},e:{r:U+P-1,c:B+V-1}},M.push(F)),R["number-columns-repeated"]&&(ie=parseInt(R["number-columns-repeated"],10)),T.t){case"boolean":T.t="b",T.v=yr(R["boolean-value"]);break;case"float":T.t="n",T.v=parseFloat(R.value);break;case"percentage":T.t="n",T.v=parseFloat(R.value);break;case"currency":T.t="n",T.v=parseFloat(R.value);break;case"date":T.t="d",T.v=wr(R["date-value"]),r.cellDates||(T.t="n",T.v=fn(T.v)),T.z="m/d/yy";break;case"time":T.t="n",T.v=M7(R["time-value"])/86400,r.cellDates&&(T.t="d",T.v=kp(T.v)),T.z="HH:MM:SS";break;case"number":T.t="n",T.v=parseFloat(R.);break;default:if(T.t==="string"||T.t==="text"||!T.t)T.t="s",R["string-value"]!=null&&(I=Vt(R["string-value"]),W=[]);else throw new Error("Unsupported value type "+T.t)}}else{if(ne=!1,T.t==="s"&&(T.v=I||"",W.length&&(T.R=W),ne=C==0),ae.Target&&(T.l=ae),Y.length>0&&(T.c=Y,Y=[]),I&&r.cellText!==!1&&(T.w=I),ne&&(T.t="z",delete T.v),(!ne||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=U))for(var Ce=0;Ce<we;++Ce){if(ie=parseInt(R["number-columns-repeated"]||"1",10),r.dense)for(E[U+Ce]||(E[U+Ce]=[]),E[U+Ce][B]=Ce==0?T:br(T);--ie>0;)E[U+Ce][B+ie]=br(T);else for(E[ct({r:U+Ce,c:B})]=T;--ie>0;)E[ct({r:U+Ce,c:B+ie})]=br(T);A.e.c<=B&&(A.e.c=B)}ie=parseInt(R["number-columns-repeated"]||"1",10),B+=ie-1,ie=0,T={},I="",W=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((i=a.pop())[0]!==w[3])throw"Bad state: "+i}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((i=a.pop())[0]!==w[3])throw"Bad state: "+i;j.t=I,W.length&&(j.R=W),j.a=X,Y.push(j)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);X="",J=0,I="",C=0,W=[];break;case"creator":w[1]==="/"?X=n.slice(J,w.index):J=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((i=a.pop())[0]!==w[3])throw"Bad state: "+i}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);I="",C=0,W=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(N[u.name]=f,(i=a.pop())[0]!==w[3])throw"Bad state: "+i}else w[0].charAt(w[0].length-2)!=="/"&&(f="",u=ft(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=ft(w[0],!1),f+=NS[w[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=ft(w[0],!1),f+=NS[w[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,w.index);break}else d=w.index+w[0].length;break;case"named-range":o=ft(w[0],!1),Me=ax(o["cell-range-address"]);var Fe={Name:o.name,Ref:Me[0]+"!"+Me[1]};ue&&(Fe.Sheet=b.length),ye.Names.push(Fe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!R||!R["string-value"])){var st=o$(n.slice(C,w.index));I=(I.length>0?I+`
`:"")+st[0]}else ft(w[0],!1),C=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{Me=ax(ft(w[0])["target-range-address"]),y[Me[0]]["!autofilter"]={ref:Me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(ae=ft(w[0],!1),!ae.href)break;ae.Target=Vt(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(Me=ax(ae.Target.slice(1)),ae.Target="#"+Me[0]+"!"+Me[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var te={Sheets:y,SheetNames:b,Workbook:ye};return r.bookSheets&&delete te.Sheets,te}function RS(t,e){e=e||{},Qa(t,"META-INF/manifest.xml")&&MB(tn(t,"META-INF/manifest.xml"),e);var r=Na(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=n3(ur(r),e);return Qa(t,"meta.xml")&&(n.Props=XC(tn(t,"meta.xml"))),n}function IS(t,e){return n3(t,e)}var c$=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+E0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Xr+e}})(),DS=(function(){var t=function(i){return sr(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,u){var f=[];f.push('      <table:table table:name="'+sr(o.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,m=0,x=ma(i["!ref"]||"A1"),y=i["!merges"]||[],b=0,E=Array.isArray(i);if(i["!cols"])for(m=0;m<=x.e.c;++m)f.push("        <table:table-column"+(i["!cols"][m]?' table:style-name="co'+i["!cols"][m].ods+'"':"")+`></table:table-column>
`);var w="",T=i["!rows"]||[];for(d=0;d<x.s.r;++d)w=T[d]?' table:style-name="ro'+T[d].ods+'"':"",f.push("        <table:table-row"+w+`></table:table-row>
`);for(;d<=x.e.r;++d){for(w=T[d]?' table:style-name="ro'+T[d].ods+'"':"",f.push("        <table:table-row"+w+`>
`),m=0;m<x.s.c;++m)f.push(e);for(;m<=x.e.c;++m){var R=!1,I={},C="";for(b=0;b!=y.length;++b)if(!(y[b].s.c>m)&&!(y[b].s.r>d)&&!(y[b].e.c<m)&&!(y[b].e.r<d)){(y[b].s.c!=m||y[b].s.r!=d)&&(R=!0),I["table:number-columns-spanned"]=y[b].e.c-y[b].s.c+1,I["table:number-rows-spanned"]=y[b].e.r-y[b].s.r+1;break}if(R){f.push(r);continue}var W=ct({r:d,c:m}),U=E?(i[d]||[])[m]:i[W];if(U&&U.f&&(I["table:formula"]=sr(Nq(U.f)),U.F&&U.F.slice(0,W.length)==W)){var B=ma(U.F);I["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,I["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!U){f.push(e);continue}switch(U.t){case"b":C=U.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=U.v?"true":"false";break;case"n":C=U.w||String(U.v||0),I["office:value-type"]="float",I["office:value"]=U.v||0;break;case"s":case"str":C=U.v==null?"":U.v,I["office:value-type"]="string";break;case"d":C=U.w||wr(U.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=wr(U.v).toISOString(),I["table:style-name"]="ce1";break;default:f.push(e);continue}var A=t(C);if(U.l&&U.l.Target){var D=U.l.Target;D=D.charAt(0)=="#"?"#"+Rq(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),A=Ue("text:a",A,{"xlink:href":D.replace(/&/g,"&amp;")})}f.push("          "+Ue("table:table-cell",Ue("text:p",A,{}),I)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var x=d["!cols"][m];if(x.width==null&&x.wpx==null&&x.wch==null)continue;$l(x),x.ods=u;var y=d["!cols"][m].wpx+"px";i.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),i.push(`  </style:style>
`),++u}}});var f=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=f;var x=d["!rows"][m].hpx+"px";i.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),i.push(`  </style:style>
`),++f}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,u){var f=[Xr],d=E0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=E0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+d+m+`>
`),f.push(WC().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,o),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)f.push(n(o.Sheets[o.SheetNames[x]],o,x));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function a3(t,e){if(e.bookType=="fods")return DS(t,e);var r=Ey(),n="",a=[],i=[];return n="mimetype",bt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",bt(r,n,DS(t,e)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",bt(r,n,c$(t,e)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",bt(r,n,Xr+WC()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",bt(r,n,LB(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",bt(r,n,PB(a)),r}function rc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function nv(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):ur(no(t))}function u$(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ca(Hs(t))}function f$(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Ql(t){var e=t.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function OS(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function h$(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function d$(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)t[e+i]=a&255;t[e+15]|=r>=0?0:128}function I0(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function rr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function jr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function qt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=I0(t,r),i=a&7;a=Math.floor(a/8);var o=0,u;if(a==0)break;switch(i){case 0:{for(var f=r[0];t[r[0]++]>=128;);u=t.slice(f,r[0])}break;case 5:o=4,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=I0(t,r),u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:i};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function En(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(rr(n*8+a.type)),a.type==2&&e.push(rr(a.data.length)),e.push(a.data))})}),Ql(e)}function Ky(t,e){return t?.map(function(r){return e(r.data)})||[]}function $a(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=I0(t,n),i=qt(t.slice(n[0],n[0]+a));n[0]+=a;var o={id:jr(i[1][0].data),messages:[]};i[2].forEach(function(u){var f=qt(u.data),d=jr(f[3][0].data);o.messages.push({meta:f,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=i[3])!=null&&e[0]&&(o.merge=jr(i[3][0].data)>>>0>0),r.push(o)}return r}function Jc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:rr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:rr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:rr(o.data.length)}],n[2].push({data:En(o.meta),type:2})});var i=En(n);e.push(rr(i.length)),e.push(i),a.forEach(function(o){return e.push(o)})}),Ql(e)}function m$(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=I0(e,r),a=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=e[r[0]],u>1&&(o|=e[r[0]+1]<<8),u>2&&(o|=e[r[0]+2]<<16),u>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}a.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var f=0,d=0;if(i==1?(d=(e[r[0]]>>2&7)+4,f=(e[r[0]++]&224)<<3,f|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,i==2?(f=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(f=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Ql(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var m=Ql(a);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function Ka(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(m$(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Ql(e)}function Zc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var i=rr(n),o=i.length;e.push(i),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Ql(e)}function p$(t,e,r,n){var a=rc(t),i=a.getUint32(4,!0),o=(n>1?12:8)+OS(i&(n>1?3470:398))*4,u=-1,f=-1,d=NaN,m=new Date(2001,0,1);i&512&&(u=a.getUint32(o,!0),o+=4),o+=OS(i&(n>1?12288:4096))*4,i&16&&(f=a.getUint32(o,!0),o+=4),i&32&&(d=a.getFloat64(o,!0),o+=8),i&64&&(m.setTime(m.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var x;switch(t[2]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:e[f]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(f>-1)x={t:"s",v:e[f]};else if(!isNaN(d))x={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return x}function g$(t,e,r){var n=rc(t),a=n.getUint32(8,!0),i=12,o=-1,u=-1,f=NaN,d=NaN,m=new Date(2001,0,1);a&1&&(f=h$(t,i),i+=16),a&2&&(d=n.getFloat64(i,!0),i+=8),a&4&&(m.setTime(m.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(u=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var x;switch(t[1]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:e[u]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(o>-1)x={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:x={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return x}function ix(t,e){var r=new Uint8Array(32),n=rc(r),a=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,d$(r,a,t.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),i|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,a)}function lx(t,e){var r=new Uint8Array(32),n=rc(r),a=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),i|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,a)}function x$(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return p$(t,e,r,t[0]);case 5:return g$(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function jn(t){var e=qt(t);return I0(e[1][0].data)}function FS(t,e){var r=qt(e.data),n=jr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var u=qt(o.data),f=jr(u[1][0].data)>>>0;switch(n){case 1:i[f]=nv(u[3][0].data);break;case 8:{var d=t[jn(u[9][0].data)][0],m=qt(d.data),x=t[jn(m[1][0].data)][0],y=jr(x.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var b=qt(x.data);i[f]=b[3].map(function(E){return nv(E.data)}).join("")}break}}),i}function v$(t,e){var r,n,a,i,o,u,f,d,m,x,y,b,E,w,T=qt(t),R=jr(T[1][0].data)>>>0,I=jr(T[2][0].data)>>>0,C=((n=(r=T[8])==null?void 0:r[0])==null?void 0:n.data)&&jr(T[8][0].data)>0||!1,W,U;if((i=(a=T[7])==null?void 0:a[0])!=null&&i.data&&e!=0)W=(u=(o=T[7])==null?void 0:o[0])==null?void 0:u.data,U=(d=(f=T[6])==null?void 0:f[0])==null?void 0:d.data;else if((x=(m=T[4])==null?void 0:m[0])!=null&&x.data&&e!=1)W=(b=(y=T[4])==null?void 0:y[0])==null?void 0:b.data,U=(w=(E=T[3])==null?void 0:E[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var B=C?4:1,A=rc(W),D=[],N=0;N<W.length/2;++N){var M=A.getUint16(N*2,!0);M<65535&&D.push([N,M])}if(D.length!=I)throw"Expected ".concat(I," cells, found ").concat(D.length);var F=[];for(N=0;N<D.length-1;++N)F[D[N][0]]=U.subarray(D[N][1]*B,D[N+1][1]*B);return D.length>=1&&(F[D[D.length-1][0]]=U.subarray(D[D.length-1][1]*B)),{R,cells:F}}function y$(t,e){var r,n=qt(e.data),a=(r=n?.[7])!=null&&r[0]?jr(n[7][0].data)>>>0>0?1:0:-1,i=Ky(n[5],function(o){return v$(o,a)});return{nrows:jr(n[4][0].data)>>>0,data:i.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(f,d){if(o[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));o[u.R][d]=f}),o},[])}}function _$(t,e,r){var n,a=qt(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(jr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(jr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=_t(i);var o=qt(a[4][0].data),u=FS(t,t[jn(o[4][0].data)][0]),f=(n=o[17])!=null&&n[0]?FS(t,t[jn(o[17][0].data)][0]):[],d=qt(o[3][0].data),m=0;d[1].forEach(function(x){var y=qt(x.data),b=t[jn(y[2][0].data)][0],E=jr(b.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var w=y$(t,b);w.data.forEach(function(T,R){T.forEach(function(I,C){var W=ct({r:m+R,c:C}),U=x$(I,u,f);U&&(r[W]=U)})}),m+=w.nrows})}function w$(t,e){var r=qt(e.data),n={"!ref":"A1"},a=t[jn(r[2][0].data)],i=jr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return _$(t,a[0],n),n}function b$(t,e){var r,n=qt(e.data),a={name:(r=n[1])!=null&&r[0]?nv(n[1][0].data):"",sheets:[]},i=Ky(n[2],jn);return i.forEach(function(o){t[o].forEach(function(u){var f=jr(u.meta[1][0].data);f==6e3&&a.sheets.push(w$(t,u))})}),a}function E$(t,e){var r=t_(),n=qt(e.data),a=Ky(n[1],jn);if(a.forEach(function(i){t[i].forEach(function(o){var u=jr(o.meta[1][0].data);if(u==2){var f=b$(t,o);f.sheets.forEach(function(d,m){r_(r,d,m==0?f.name:f.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ox(t){var e,r,n,a,i={},o=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=Ka(f.content)}catch(x){return console.log("?? "+f.content.length+" "+(x.message||x))}var m;try{m=$a(d)}catch(x){return console.log("## "+(x.message||x))}m.forEach(function(x){i[x.id]=x.messages,o.push(x.id)})}}),!o.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=i?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&jr(i[1][0].meta[1][0].data)==1&&i[1][0];if(u||o.forEach(function(f){i[f].forEach(function(d){var m=jr(d.meta[1][0].data)>>>0;if(m==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return E$(i,u)}function T$(t,e,r){var n,a,i,o;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&jr(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,d=rc(t[7][0].data),m=0,x=[],y=rc(t[4][0].data),b=0,E=[],w=0;w<e.length;++w){if(e[w]==null){d.setUint16(w*2,65535,!0),y.setUint16(w*2,65535);continue}d.setUint16(w*2,m,!0),y.setUint16(w*2,b,!0);var T,R;switch(typeof e[w]){case"string":T=ix({t:"s",v:e[w]},r),R=lx({t:"s",v:e[w]},r);break;case"number":T=ix({t:"n",v:e[w]},r),R=lx({t:"n",v:e[w]},r);break;case"boolean":T=ix({t:"b",v:e[w]},r),R=lx({t:"b",v:e[w]},r);break;default:throw new Error("Unsupported value "+e[w])}x.push(T),m+=T.length,E.push(R),b+=R.length,++f}for(t[2][0].data=rr(f);w<t[7][0].data.length/2;++w)d.setUint16(w*2,65535,!0),y.setUint16(w*2,65535,!0);return t[6][0].data=Ql(x),t[3][0].data=Ql(E),f}function S$(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ma(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(_t(n)));var i=Wm(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(X){return X.forEach(function(J){typeof J=="string"&&o.push(J)})});var u={},f=[],d=nt.read(e.numbers,{type:"base64"});d.FileIndex.map(function(X,J){return[X,d.FullPaths[J]]}).forEach(function(X){var J=X[0],ne=X[1];if(J.type==2&&J.name.match(/\.iwa/)){var ue=J.content,Te=Ka(ue),Re=$a(Te);Re.forEach(function(Ce){f.push(Ce.id),u[Ce.id]={deps:[],location:ne,type:jr(Ce.messages[0].meta[1][0].data)}})}}),f.sort(function(X,J){return X-J});var m=f.filter(function(X){return X>1}).map(function(X){return[X,rr(X)]});d.FileIndex.map(function(X,J){return[X,d.FullPaths[J]]}).forEach(function(X){var J=X[0];if(X[1],!!J.name.match(/\.iwa/)){var ne=$a(Ka(J.content));ne.forEach(function(ue){ue.messages.forEach(function(Te){m.forEach(function(Re){ue.messages.some(function(Ce){return jr(Ce.meta[1][0].data)!=11006&&f$(Ce.data,Re[1])})&&u[Re[0]].deps.push(ue.id)})})})}});for(var x=nt.find(d,u[1].location),y=$a(Ka(x.content)),b,E=0;E<y.length;++E){var w=y[E];w.id==1&&(b=w)}var T=jn(qt(b.messages[0].data)[1][0].data);for(x=nt.find(d,u[T].location),y=$a(Ka(x.content)),E=0;E<y.length;++E)w=y[E],w.id==T&&(b=w);for(T=jn(qt(b.messages[0].data)[2][0].data),x=nt.find(d,u[T].location),y=$a(Ka(x.content)),E=0;E<y.length;++E)w=y[E],w.id==T&&(b=w);for(T=jn(qt(b.messages[0].data)[2][0].data),x=nt.find(d,u[T].location),y=$a(Ka(x.content)),E=0;E<y.length;++E)w=y[E],w.id==T&&(b=w);var R=qt(b.messages[0].data);{R[6][0].data=rr(n.e.r+1),R[7][0].data=rr(n.e.c+1);var I=jn(R[46][0].data),C=nt.find(d,u[I].location),W=$a(Ka(C.content));{for(var U=0;U<W.length&&W[U].id!=I;++U);if(W[U].id!=I)throw"Bad ColumnRowUIDMapArchive";var B=qt(W[U].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var A=0;A<=n.e.c;++A){var D=[];D[1]=D[2]=[{type:0,data:rr(A+420690)}],B[1].push({type:2,data:En(D)}),B[2].push({type:0,data:rr(A)}),B[3].push({type:0,data:rr(A)})}B[4]=[],B[5]=[],B[6]=[];for(var N=0;N<=n.e.r;++N)D=[],D[1]=D[2]=[{type:0,data:rr(N+726270)}],B[4].push({type:2,data:En(D)}),B[5].push({type:0,data:rr(N)}),B[6].push({type:0,data:rr(N)});W[U].messages[0].data=En(B)}C.content=Zc(Jc(W)),C.size=C.content.length,delete R[46];var M=qt(R[4][0].data);{M[7][0].data=rr(n.e.r+1);var F=qt(M[1][0].data),P=jn(F[2][0].data);C=nt.find(d,u[P].location),W=$a(Ka(C.content));{if(W[0].id!=P)throw"Bad HeaderStorageBucket";var V=qt(W[0].messages[0].data);for(N=0;N<i.length;++N){var Ee=qt(V[2][0].data);Ee[1][0].data=rr(N),Ee[4][0].data=rr(i[N].length),V[2][N]={type:V[2][0].type,data:En(Ee)}}W[0].messages[0].data=En(V)}C.content=Zc(Jc(W)),C.size=C.content.length;var we=jn(M[2][0].data);C=nt.find(d,u[we].location),W=$a(Ka(C.content));{if(W[0].id!=we)throw"Bad HeaderStorageBucket";for(V=qt(W[0].messages[0].data),A=0;A<=n.e.c;++A)Ee=qt(V[2][0].data),Ee[1][0].data=rr(A),Ee[4][0].data=rr(n.e.r+1),V[2][A]={type:V[2][0].type,data:En(Ee)};W[0].messages[0].data=En(V)}C.content=Zc(Jc(W)),C.size=C.content.length;var ie=jn(M[4][0].data);(function(){for(var X=nt.find(d,u[ie].location),J=$a(Ka(X.content)),ne,ue=0;ue<J.length;++ue){var Te=J[ue];Te.id==ie&&(ne=Te)}var Re=qt(ne.messages[0].data);{Re[3]=[];var Ce=[];o.forEach(function(te,Ct){Ce[1]=[{type:0,data:rr(Ct)}],Ce[2]=[{type:0,data:rr(1)}],Ce[3]=[{type:2,data:u$(te)}],Re[3].push({type:2,data:En(Ce)})})}ne.messages[0].data=En(Re);var Fe=Jc(J),st=Zc(Fe);X.content=st,X.size=X.content.length})();var ee=qt(M[3][0].data);{var ye=ee[1][0];delete ee[2];var ae=qt(ye.data);{var Me=jn(ae[2][0].data);(function(){for(var X=nt.find(d,u[Me].location),J=$a(Ka(X.content)),ne,ue=0;ue<J.length;++ue){var Te=J[ue];Te.id==Me&&(ne=Te)}var Re=qt(ne.messages[0].data);{delete Re[6],delete ee[7];var Ce=new Uint8Array(Re[5][0].data);Re[5]=[];for(var Fe=0,st=0;st<=n.e.r;++st){var te=qt(Ce);Fe+=T$(te,i[st],o),te[1][0].data=rr(st),Re[5].push({data:En(te),type:2})}Re[1]=[{type:0,data:rr(n.e.c+1)}],Re[2]=[{type:0,data:rr(n.e.r+1)}],Re[3]=[{type:0,data:rr(Fe)}],Re[4]=[{type:0,data:rr(n.e.r+1)}]}ne.messages[0].data=En(Re);var Ct=Jc(J),lt=Zc(Ct);X.content=lt,X.size=X.content.length})()}ye.data=En(ae)}M[3][0].data=En(ee)}R[4][0].data=En(M)}b.messages[0].data=En(R);var Y=Jc(y),j=Zc(Y);return x.content=j,x.size=x.content.length,d}function s3(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Qy(t){s3([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Jy(t){s3([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function A$(t){return kt.WS.indexOf(t)>-1?"sheet":t==kt.CS?"chart":t==kt.DS?"dialog":t==kt.MS?"macro":t&&t.length?t:"sheet"}function k$(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,A$(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function C$(t,e,r,n,a,i,o,u,f,d,m,x){try{i[n]=a0(Na(t,r,!0),e);var y=tn(t,e),b;switch(u){case"sheet":b=KX(y,e,a,f,i[n],d,m,x);break;case"chart":if(b=QX(y,e,a,f,i[n],d,m,x),!b||!b["!drawel"])break;var E=Yf(b["!drawel"].Target,e),w=S0(E),T=jH(Na(t,E,!0),a0(Na(t,w,!0),E)),R=Yf(T,E),I=S0(R);b=TX(Na(t,R,!0),R,f,a0(Na(t,I,!0),R),d,b);break;case"macro":b=JX(y,e,a,f,i[n],d,m,x);break;case"dialog":b=ZX(y,e,a,f,i[n],d,m,x);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=b;var C=[];i&&i[n]&&Lr(i[n]).forEach(function(W){var U="";if(i[n][W].Type==kt.CMNT){U=Yf(i[n][W].Target,e);var B=nY(tn(t,U,!0),U,f);if(!B||!B.length)return;yS(b,B,!1)}i[n][W].Type==kt.TCMNT&&(U=Yf(i[n][W].Target,e),C=C.concat(BH(tn(t,U,!0),f)))}),C&&C.length&&yS(b,C,!0,f.people||[])}catch(W){if(f.WTF)throw W}}function Xa(t){return t.charAt(0)=="/"?t.slice(1):t}function N$(t,e){if(ju(),e=e||{},Qy(e),Qa(t,"META-INF/manifest.xml")||Qa(t,"objectdata.xml"))return RS(t,e);if(Qa(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ox<"u"){if(t.FileIndex)return ox(t);var r=nt.utils.cfb_new();return VT(t).forEach(function(Ee){bt(r,Ee,V7(t,Ee))}),ox(r)}throw new Error("Unsupported NUMBERS file")}if(!Qa(t,"[Content_Types].xml"))throw Qa(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Qa(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=VT(t),a=OB(Na(t,"[Content_Types].xml")),i=!1,o,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",tn(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!tn(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},d={};if(!e.bookSheets&&!e.bookProps){if(s0=[],a.sst)try{s0=rY(tn(t,Xa(a.sst)),a.sst,e)}catch(Ee){if(e.WTF)throw Ee}e.cellStyles&&a.themes.length&&(f=tY(Na(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=eY(tn(t,Xa(a.style)),a.style,f,e))}a.links.map(function(Ee){try{var we=a0(Na(t,S0(Xa(Ee))),Ee);return sY(tn(t,Xa(Ee)),we,Ee,e)}catch{}});var m=$X(tn(t,Xa(a.workbooks[0])),a.workbooks[0],e),x={},y="";a.coreprops.length&&(y=tn(t,Xa(a.coreprops[0]),!0),y&&(x=XC(y)),a.extprops.length!==0&&(y=tn(t,Xa(a.extprops[0]),!0),y&&VB(y,x,e)));var b={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(y=Na(t,Xa(a.custprops[0]),!0),y&&(b=zB(y,e)));var E={};if((e.bookSheets||e.bookProps)&&(m.Sheets?o=m.Sheets.map(function(we){return we.name}):x.Worksheets&&x.SheetNames.length>0&&(o=x.SheetNames),e.bookProps&&(E.Props=x,E.Custprops=b),e.bookSheets&&typeof o<"u"&&(E.SheetNames=o),e.bookSheets?E.SheetNames:e.bookProps))return E;o={};var w={};e.bookDeps&&a.calcchain&&(w=aY(tn(t,Xa(a.calcchain)),a.calcchain));var T=0,R={},I,C;{var W=m.Sheets;x.Worksheets=W.length,x.SheetNames=[];for(var U=0;U!=W.length;++U)x.SheetNames[U]=W[U].name}var B=i?"bin":"xml",A=a.workbooks[0].lastIndexOf("/"),D=(a.workbooks[0].slice(0,A+1)+"_rels/"+a.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Qa(t,D)||(D="xl/_rels/workbook."+B+".rels");var N=a0(Na(t,D,!0),D.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=iY(tn(t,Xa(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=UH(tn(t,Xa(a.people[0])),e)),N&&(N=k$(N,m.Sheets));var M=tn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=x.Worksheets;++T){var F="sheet";if(N&&N[T]?(I="xl/"+N[T][1].replace(/[\/]?xl\//,""),Qa(t,I)||(I=N[T][1]),Qa(t,I)||(I=D.replace(/_rels\/.*$/,"")+N[T][1]),F=N[T][2]):(I="xl/worksheets/sheet"+(T+1-M)+"."+B,I=I.replace(/sheet0\./,"sheet.")),C=I.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(T!=e.sheets)continue e;break;case"string":if(x.SheetNames[T].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var P=!1,V=0;V!=e.sheets.length;++V)typeof e.sheets[V]=="number"&&e.sheets[V]==T&&(P=1),typeof e.sheets[V]=="string"&&e.sheets[V].toLowerCase()==x.SheetNames[T].toLowerCase()&&(P=1);if(!P)continue e}}C$(t,I,C,x.SheetNames[T],T,R,o,F,e,m,f,d)}return E={Directory:a,Workbook:m,Props:x,Custprops:b,Deps:w,Sheets:o,SheetNames:x.SheetNames,Strings:s0,Styles:d,Themes:f,SSF:br(ot)},e&&e.bookFiles&&(t.files?(E.keys=n,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(Ee,we){Ee=Ee.replace(/^Root Entry[\/]/,""),E.keys.push(Ee),E.files[Ee]=t.FileIndex[we]}))),e&&e.bookVBA&&(a.vba.length>0?E.vbaraw=tn(t,Xa(a.vba[0]),!0):a.defaults&&a.defaults.bin===$H&&(E.vbaraw=tn(t,"xl/vbaProject.bin",!0))),E}function R$(t,e){var r=e||{},n="Workbook",a=nt.find(t,n);try{if(n="/!DataSpaces/Version",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(iz(a.content),n="/!DataSpaces/DataSpaceMap",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=oz(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=cz(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);fz(a.content)}catch{}if(n="/EncryptionInfo",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=hz(a.content);if(n="/EncryptedPackage",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function I$(t,e){return e.bookType=="ods"?a3(t,e):e.bookType=="numbers"?S$(t,e):e.bookType=="xlsb"?D$(t,e):O$(t,e)}function D$(t,e){iu=1024,t&&!t.SSF&&(t.SSF=br(ot)),t&&t.SSF&&(ju(),Tp(t.SSF),e.revssf=Ap(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,i0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=DN.indexOf(e.bookType)>-1,a=jy();Jy(e=e||{});var i=Ey(),o="",u=0;if(e.cellXfs=[],so(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",bt(i,o,YC(t.Props,e)),a.coreprops.push(o),nr(e.rels,2,o,kt.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,bt(i,o,QC(t.Props)),a.extprops.push(o),nr(e.rels,3,o,kt.EXT_PROPS),t.Custprops!==t.Props&&Lr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",bt(i,o,JC(t.Custprops)),a.custprops.push(o),nr(e.rels,4,o,kt.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var m={"!id":{}},x=t.Sheets[t.SheetNames[u-1]],y=(x||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,bt(i,o,oY(u-1,o,e,t,m)),a.sheets.push(o),nr(e.wbrels,-1,"worksheets/sheet"+u+"."+r,kt.WS[0])}if(x){var b=x["!comments"],E=!1,w="";b&&b.length>0&&(w="xl/comments"+u+"."+r,bt(i,w,fY(b,w)),a.comments.push(w),nr(m,-1,"../comments"+u+"."+r,kt.CMNT),E=!0),x["!legacy"]&&E&&bt(i,"xl/drawings/vmlDrawing"+u+".vml",RN(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&bt(i,S0(o),hu(m))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,bt(i,o,uY(e.Strings,o,e)),a.strs.push(o),nr(e.wbrels,-1,"sharedStrings."+r,kt.SST)),o="xl/workbook."+r,bt(i,o,lY(t,o)),a.workbooks.push(o),nr(e.rels,1,o,kt.WB),o="xl/theme/theme1.xml",bt(i,o,Hy(t.Themes,e)),a.themes.push(o),nr(e.wbrels,-1,"theme/theme1.xml",kt.THEME),o="xl/styles."+r,bt(i,o,cY(t,o,e)),a.styles.push(o),nr(e.wbrels,-1,"styles."+r,kt.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",bt(i,o,t.vbaraw),a.vba.push(o),nr(e.wbrels,-1,"vbaProject.bin",kt.VBA)),o="xl/metadata."+r,bt(i,o,hY(o)),a.metadata.push(o),nr(e.wbrels,-1,"metadata."+r,kt.XLMETA),bt(i,"[Content_Types].xml",qC(a,e)),bt(i,"_rels/.rels",hu(e.rels)),bt(i,"xl/_rels/workbook."+r+".rels",hu(e.wbrels)),delete e.revssf,delete e.ssf,i}function O$(t,e){iu=1024,t&&!t.SSF&&(t.SSF=br(ot)),t&&t.SSF&&(ju(),Tp(t.SSF),e.revssf=Ap(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,i0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=DN.indexOf(e.bookType)>-1,a=jy();Jy(e=e||{});var i=Ey(),o="",u=0;if(e.cellXfs=[],so(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",bt(i,o,YC(t.Props,e)),a.coreprops.push(o),nr(e.rels,2,o,kt.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,bt(i,o,QC(t.Props)),a.extprops.push(o),nr(e.rels,3,o,kt.EXT_PROPS),t.Custprops!==t.Props&&Lr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",bt(i,o,JC(t.Custprops)),a.custprops.push(o),nr(e.rels,4,o,kt.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var x={"!id":{}},y=t.Sheets[t.SheetNames[u-1]],b=(y||{})["!type"]||"sheet";switch(b){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,bt(i,o,HN(u-1,e,t,x)),a.sheets.push(o),nr(e.wbrels,-1,"worksheets/sheet"+u+"."+r,kt.WS[0])}if(y){var E=y["!comments"],w=!1,T="";if(E&&E.length>0){var R=!1;E.forEach(function(I){I[1].forEach(function(C){C.T==!0&&(R=!0)})}),R&&(T="xl/threadedComments/threadedComment"+u+"."+r,bt(i,T,VH(E,m,e)),a.threadedcomments.push(T),nr(x,-1,"../threadedComments/threadedComment"+u+"."+r,kt.TCMNT)),T="xl/comments"+u+"."+r,bt(i,T,IN(E)),a.comments.push(T),nr(x,-1,"../comments"+u+"."+r,kt.CMNT),w=!0}y["!legacy"]&&w&&bt(i,"xl/drawings/vmlDrawing"+u+".vml",RN(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}x["!id"].rId1&&bt(i,S0(o),hu(x))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,bt(i,o,vN(e.Strings,e)),a.strs.push(o),nr(e.wbrels,-1,"sharedStrings."+r,kt.SST)),o="xl/workbook."+r,bt(i,o,YN(t)),a.workbooks.push(o),nr(e.rels,1,o,kt.WB),o="xl/theme/theme1.xml",bt(i,o,Hy(t.Themes,e)),a.themes.push(o),nr(e.wbrels,-1,"theme/theme1.xml",kt.THEME),o="xl/styles."+r,bt(i,o,AN(t,e)),a.styles.push(o),nr(e.wbrels,-1,"styles."+r,kt.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",bt(i,o,t.vbaraw),a.vba.push(o),nr(e.wbrels,-1,"vbaProject.bin",kt.VBA)),o="xl/metadata."+r,bt(i,o,NN()),a.metadata.push(o),nr(e.wbrels,-1,"metadata."+r,kt.XLMETA),m.length>1&&(o="xl/persons/person.xml",bt(i,o,zH(m)),a.people.push(o),nr(e.wbrels,-1,"persons/person.xml",kt.PEOPLE)),bt(i,"[Content_Types].xml",qC(a,e)),bt(i,"_rels/.rels",hu(e.rels)),bt(i,"xl/_rels/workbook."+r+".rels",hu(e.wbrels)),delete e.revssf,delete e.ssf,i}function Zy(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Oa(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function F$(t,e){return nt.find(t,"EncryptedPackage")?R$(t,e):JN(t,e)}function M$(t,e){var r,n=t,a=e||{};return a.type||(a.type=At&&Buffer.isBuffer(t)?"buffer":"base64"),r=_C(n,a),N$(r,a)}function i3(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return tv(t.slice(r),e);default:break e}return Tu.to_workbook(t,e)}function P$(t,e){var r="",n=Zy(t,e);switch(e.type){case"base64":r=Oa(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Jo(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ur(r)),e.type="binary",i3(r,e)}function j$(t,e){var r=t;return e.type=="base64"&&(r=Oa(r)),r=y0.utils.decode(1200,r.slice(2),"str"),e.type="binary",i3(r,e)}function L$(t){return t.match(/[^\x00-\x7F]/)?Hs(t):t}function cx(t,e,r,n){return n?(r.type="string",Tu.to_workbook(t,r)):Tu.to_workbook(e,r)}function av(t,e){vy();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return av(new Uint8Array(t),(r=br(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),mu={},r.dateNF&&(mu.dateNF=r.dateNF),r.type||(r.type=At&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=At?"buffer":"binary",n=D7(t),typeof Uint8Array<"u"&&!At&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=L$(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=br(r),r.type="array",av(yy(n),r)}switch((a=Zy(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return F$(nt.read(n,r),r);break;case 9:if(a[1]<=8)return JN(n,r);break;case 60:return tv(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return HU(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return gN.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?M$(n,r):cx(t,n,r,i);case 239:return a[3]===60?tv(n,r):cx(t,n,r,i);case 255:if(a[1]===254)return j$(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Uo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Uo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ev.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return EN.to_workbook(n,r);break;case 10:case 13:case 32:return P$(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return zU.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?ev.to_workbook(n,r):cx(t,n,r,i)}function l3(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return ah(e.file,nt.write(t,{type:At?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return nt.write(t,e)}function B$(t,e){var r=br(e||{}),n=I$(t,r);return V$(n,r)}function V$(t,e){var r={},n=At?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?nt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(Ep(a))}return e.password&&typeof encrypt_agile<"u"?l3(encrypt_agile(a,e.password),e):e.type==="file"?ah(e.file,a):e.type=="string"?ur(a):a}function U$(t,e){var r=e||{},n=LY(t,r);return l3(n,r)}function Bs(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return _0(Hs(n));case"binary":return Hs(n);case"string":return t;case"file":return ah(e.file,n,"utf8");case"buffer":return At?Bi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Bs(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function z$(t,e){switch(e.type){case"base64":return _0(t);case"binary":return t;case"string":return t;case"file":return ah(e.file,t,"binary");case"buffer":return At?Bi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Kd(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?_0(r):e.type=="string"?ur(r):r;case"file":return ah(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function o3(t,e){vy(),FX(t);var r=br(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=o3(t,r);return r.type="array",Ep(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Bs(IY(t,r),r);case"slk":case"sylk":return Bs(pN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return Bs(e3(t.Sheets[t.SheetNames[a]],r),r);case"txt":return z$(u3(t.Sheets[t.SheetNames[a]],r),r);case"csv":return Bs(e_(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return Bs(gN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return Kd(ev.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return Bs(Tu.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return Bs(EN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return Bs(xN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return Bs(a3(t,r),r);case"wk1":return Kd(Uo.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return Kd(Uo.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Kd(ZN(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),U$(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return B$(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function H$(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function c3(t,e,r){var n={};return n.type="file",n.file=e,H$(n),o3(t,n)}function G$(t,e,r,n,a,i,o,u){var f=Wr(r),d=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,y=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!o||t[r])for(var b=e.s.c;b<=e.e.c;++b){var E=o?t[r][b]:t[n[b]+f];if(E===void 0||E.t===void 0){if(d===void 0)continue;i[b]!=null&&(y[i[b]]=d);continue}var w=E.v;switch(E.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(i[b]!=null){if(w==null)if(E.t=="e"&&w===null)y[i[b]]=null;else if(d!==void 0)y[i[b]]=d;else if(m&&w===null)y[i[b]]=null;else continue;else y[i[b]]=m&&(E.t!=="n"||E.t==="n"&&u.rawNumbers!==!1)?w:ji(E,w,u);w!=null&&(x=!1)}}return{row:y,isempty:x}}function Wm(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},m=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof m){case"string":f=Ut(m);break;case"number":f=Ut(t["!ref"]),f.s.r=m;break;default:f=m}n>0&&(a=0);var x=Wr(f.s.r),y=[],b=[],E=0,w=0,T=Array.isArray(t),R=f.s.r,I=0,C={};T&&!t[R]&&(t[R]=[]);var W=d.skipHidden&&t["!cols"]||[],U=d.skipHidden&&t["!rows"]||[];for(I=f.s.c;I<=f.e.c;++I)if(!(W[I]||{}).hidden)switch(y[I]=Cr(I),r=T?t[R][I]:t[y[I]+x],n){case 1:i[I]=I-f.s.c;break;case 2:i[I]=y[I];break;case 3:i[I]=d.header[I-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=ji(r,null,d),w=C[o]||0,!w)C[o]=1;else{do u=o+"_"+w++;while(C[u]);C[o]=w,C[u]=1}i[I]=u}for(R=f.s.r+a;R<=f.e.r;++R)if(!(U[R]||{}).hidden){var B=G$(t,f,R,y,n,i,T,d);(B.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(b[E++]=B.row)}return b.length=E,b}var MS=/"/g;function q$(t,e,r,n,a,i,o,u){for(var f=!0,d=[],m="",x=Wr(r),y=e.s.c;y<=e.e.c;++y)if(n[y]){var b=u.dense?(t[r]||[])[y]:t[n[y]+x];if(b==null)m="";else if(b.v!=null){f=!1,m=""+(u.rawNumbers&&b.t=="n"?b.v:ji(b,null,u));for(var E=0,w=0;E!==m.length;++E)if((w=m.charCodeAt(E))===a||w===i||w===34||u.forceQuotes){m='"'+m.replace(MS,'""')+'"';break}m=="ID"&&(m='"ID"')}else b.f!=null&&!b.F?(f=!1,m="="+b.f,m.indexOf(",")>=0&&(m='"'+m.replace(MS,'""')+'"')):m="";d.push(m)}return u.blankrows===!1&&f?null:d.join(o)}function e_(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Ut(t["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),m="",x=[];n.dense=Array.isArray(t);for(var y=n.skipHidden&&t["!cols"]||[],b=n.skipHidden&&t["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(y[E]||{}).hidden||(x[E]=Cr(E));for(var w=0,T=a.s.r;T<=a.e.r;++T)(b[T]||{}).hidden||(m=q$(t,a,T,x,o,f,i,n),m!=null&&(n.strip&&(m=m.replace(d,"")),(m||n.blankrows!==!1)&&r.push((w++?u:"")+m)));return delete n.dense,r.join("")}function u3(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=e_(t,e);return r}function W$(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Ut(t["!ref"]),i="",o=[],u,f=[],d=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)o[u]=Cr(u);for(var m=a.s.r;m<=a.e.r;++m)for(i=Wr(m),u=a.s.c;u<=a.e.c;++u)if(e=o[u]+i,r=d?(t[m]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=e+"="+n}return f}function f3(t,e,r){var n=r||{},a=+!n.skipHeader,i=t||{},o=0,u=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?Nr(n.origin):n.origin;o=f.r,u=f.c}var d,m={s:{c:0,r:0},e:{c:u,r:o+e.length-1+a}};if(i["!ref"]){var x=Ut(i["!ref"]);m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),o==-1&&(o=x.e.r+1,m.e.r=o+e.length-1+a)}else o==-1&&(o=0,m.e.r=e.length-1+a);var y=n.header||[],b=0;e.forEach(function(w,T){Lr(w).forEach(function(R){(b=y.indexOf(R))==-1&&(y[b=y.length]=R);var I=w[R],C="z",W="",U=ct({c:u+b,r:o+T+a});d=D0(i,U),I&&typeof I=="object"&&!(I instanceof Date)?i[U]=I:(typeof I=="number"?C="n":typeof I=="boolean"?C="b":typeof I=="string"?C="s":I instanceof Date?(C="d",n.cellDates||(C="n",I=fn(I)),W=n.dateNF||ot[14]):I===null&&n.nullError&&(C="e",I=0),d?(d.t=C,d.v=I,delete d.w,delete d.R,W&&(d.z=W)):i[U]=d={t:C,v:I},W&&(d.z=W))})}),m.e.c=Math.max(m.e.c,u+y.length-1);var E=Wr(o);if(a)for(b=0;b<y.length;++b)i[Cr(b+u)+E]={t:"s",v:y[b]};return i["!ref"]=_t(m),i}function X$(t,e){return f3(null,t,e)}function D0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Nr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?D0(t,ct(e)):D0(t,ct({r:e,c:r||0}))}function Y$(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function t_(){return{SheetNames:[],Sheets:{}}}function r_(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=o+a)!=-1;++a);}if(XN(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function $$(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Y$(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function K$(t,e){return t.z=e,t}function h3(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function Q$(t,e,r){return h3(t,"#"+e,r)}function J$(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Z$(t,e,r,n){for(var a=typeof e!="string"?e:Ut(e),i=typeof e=="string"?e:_t(e),o=a.s.r;o<=a.e.r;++o)for(var u=a.s.c;u<=a.e.c;++u){var f=D0(t,o,u);f.t="n",f.F=i,delete f.v,o==a.s.r&&u==a.s.c&&(f.f=r,n&&(f.D=!0))}return t}var Ho={encode_col:Cr,encode_row:Wr,encode_cell:ct,encode_range:_t,decode_col:Iy,decode_row:Ry,split_cell:uB,decode_cell:Nr,decode_range:ma,format_cell:ji,sheet_add_aoa:LC,sheet_add_json:f3,sheet_add_dom:t3,aoa_to_sheet:Lu,json_to_sheet:X$,table_to_sheet:r3,table_to_book:i$,sheet_to_csv:e_,sheet_to_txt:u3,sheet_to_json:Wm,sheet_to_html:e3,sheet_to_formulae:W$,sheet_to_row_object_array:Wm,sheet_get_cell:D0,book_new:t_,book_append_sheet:r_,book_set_sheet_visibility:$$,cell_set_number_format:K$,cell_set_hyperlink:h3,cell_set_internal_link:Q$,cell_add_comment:J$,sheet_set_array_formula:Z$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const eK="";function tK({group:t,orders:e,currentUser:r,onEdit:n}){const a=r?.name===eK,[i,o]=re.useState(t.exchangeRate||.21),[u,f]=re.useState(t.shippingFee||0);re.useEffect(()=>{t.exchangeRate!==void 0&&o(t.exchangeRate),t.shippingFee!==void 0&&f(t.shippingFee)},[t]);const d=async()=>{if(a)try{await nn(St($e,"artifacts","default-app-id","public","data","groups",t.id),{exchangeRate:Number(i),shippingFee:Number(u)}),console.log("")}catch(w){console.error("",w),alert("")}},m=re.useMemo(()=>e.map(w=>{const T=w.items.reduce((I,C)=>I+C.quantity,0),R=w.items.reduce((I,C)=>I+C.price*C.quantity,0);return{userId:w.userId,userName:w.userName,totalQty:T,totalAmount:R}}).sort((w,T)=>T.totalAmount-w.totalAmount),[e]),x=m.reduce((w,T)=>w+T.totalAmount,0),y=m.reduce((w,T)=>w+T.totalQty,0),b=y>0?u/y:0,E=()=>{const w=[];e.forEach(I=>{I.items.forEach(C=>{const W=C.price*C.quantity,U=b*C.quantity,B=W+U;w.push({:I.userName,:C.name,:C.spec||"-"," ()":C.price,:C.quantity," ()":W," ()":Math.round(U)," () ()":Math.round(B)," (NT$)":Math.round(B*i),:new Date(I.updatedAt).toLocaleString()})})});const T=Ho.json_to_sheet(w),R=Ho.book_new();Ho.book_append_sheet(R,T,""),c3(R,`_${t.title}_${i}.xlsx`)};return p.jsxs("div",{className:"space-y-6 text-slate-800 font-sans",children:[p.jsxs("div",{className:"bg-slate-900 p-4 rounded-lg border-2 border-yellow-400 shadow-lg text-white",children:[p.jsxs("h4",{className:"font-black italic text-xl text-yellow-400 mb-3 transform -skew-x-3",children:[p.jsx(IM,{size:20,className:"inline mr-2 fill-yellow-400 text-slate-900"})," "]}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-bold text-slate-400 flex items-center gap-1",children:[p.jsx(ly,{size:14,className:"text-red-500"}),"  (JPY  TWD)"]}),a?p.jsx("input",{type:"number",step:"0.001",value:i,onChange:w=>o(w.target.value),onBlur:d,className:"w-full px-3 py-1.5 rounded border-2 border-yellow-400 text-center font-black text-slate-900 focus:outline-none focus:ring-4 focus:ring-red-600 bg-yellow-100 shadow-md transition-all"}):p.jsx("span",{className:"font-mono text-2xl font-black text-yellow-400 bg-slate-800 px-3 py-1 rounded border border-yellow-400",children:i})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-bold text-slate-400 flex items-center gap-1",children:[p.jsx(th,{size:14,className:"text-red-500"}),"  (JPY)"]}),a?p.jsx("input",{type:"number",value:u,onChange:w=>f(w.target.value),onBlur:d,className:"w-full px-3 py-1.5 rounded border-2 border-yellow-400 text-center font-black text-slate-900 focus:outline-none focus:ring-4 focus:ring-red-600 bg-yellow-100 shadow-md transition-all"}):p.jsx("span",{className:"font-mono text-2xl font-black text-yellow-400 bg-slate-800 px-3 py-1 rounded border border-yellow-400",children:u})]})]})]}),p.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center bg-white p-4 rounded-lg border-2 border-slate-900 shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] gap-4 sm:gap-0",children:[p.jsxs("div",{className:"flex gap-6 text-sm font-bold",children:[p.jsxs("div",{children:[p.jsx("span",{className:"text-slate-500 block text-xs",children:""}),p.jsx("span",{className:"font-black text-3xl text-red-600 italic",children:y})]}),p.jsxs("div",{className:"border-l border-slate-200 pl-4",children:[p.jsx("span",{className:"text-slate-500 block text-xs",children:" ()"}),p.jsxs("div",{className:"flex flex-col leading-snug",children:[p.jsxs("span",{className:"font-black text-xl text-slate-900",children:["",(x+Number(u)).toLocaleString()]}),p.jsxs("span",{className:"text-sm text-yellow-600 font-black tracking-wider",children:[" NT$",Math.round((x+Number(u))*i).toLocaleString()]})]})]})]}),a&&p.jsxs("button",{onClick:E,className:"w-full sm:w-auto flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded border-2 border-green-800 text-sm font-black italic shadow-[2px_2px_0px_0px_rgba(20,83,45,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(Rk,{size:18})," EXCEL "]})]}),p.jsxs("div",{className:"border-2 border-slate-900 rounded-lg overflow-hidden shadow-lg bg-white",children:[p.jsxs("div",{className:"bg-slate-900 px-4 py-3 text-xs font-black text-yellow-400 flex justify-between uppercase",children:[p.jsx("span",{children:" ()"}),p.jsx("span",{className:"text-right",children:" (TWD)"})]}),p.jsxs("div",{className:"divide-y divide-slate-200 max-h-60 overflow-y-auto bg-white",children:[m.map(w=>{const T=Math.round(b*w.totalQty),R=w.totalAmount+T,I=Math.round(R*i);return p.jsxs("div",{className:"flex justify-between items-center px-4 py-3 text-sm hover:bg-slate-50 transition-colors",children:[p.jsxs("div",{className:"flex flex-col",children:[p.jsxs("span",{className:"font-black text-slate-900 flex items-center gap-1",children:[p.jsx(fy,{size:14,className:"text-red-600"})," ",w.userName]}),p.jsxs("span",{className:"text-slate-500 text-xs italic",children:[w.totalQty," "]})]}),p.jsxs("div",{className:"text-right",children:[p.jsxs("div",{className:"font-black text-lg text-slate-900 font-mono",children:["",R.toLocaleString()]}),p.jsxs("div",{className:"text-xs font-bold bg-yellow-400/30 text-slate-900 px-1.5 py-0.5 rounded inline-block mt-1 border border-yellow-400",children:[" NT$",I.toLocaleString()]}),Number(u)>0&&p.jsxs("span",{className:"text-[10px] text-slate-400 font-medium ml-1 block",children:["(",w.totalAmount," + ",T,")"]})]})]},w.userId)}),m.length===0&&p.jsx("div",{className:"p-4 text-center text-slate-300 text-sm italic",children:""})]})]}),p.jsx("div",{className:"h-2 bg-yellow-400 border-t-2 border-slate-900 mt-5"}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("h4",{className:"font-black italic text-lg text-slate-900 flex items-center gap-2 transform -skew-x-3",children:[p.jsx(Nk,{size:20,className:"text-red-600"})," "]}),e.map(w=>{const T=r&&w.userId===r.id,R=w.items.reduce((B,A)=>B+A.price*A.quantity,0),I=w.items.reduce((B,A)=>B+A.quantity,0),C=Math.round(b*I),W=R+C,U=Math.round(W*i);return p.jsxs("div",{className:`bg-white rounded-lg border-4 ${T?"border-red-600 shadow-[4px_4px_0px_0px_#FACC15]":"border-slate-900 shadow-md"} transition-all`,children:[p.jsxs("div",{className:`px-5 py-3 border-b-2 flex justify-between items-center ${T?"bg-red-50 border-red-200":"bg-slate-50 border-slate-100"}`,children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-black ${T?"bg-red-600 text-white":"bg-slate-900 text-yellow-400"}`,children:w.userName.charAt(0)}),p.jsxs("div",{className:"flex flex-col",children:[p.jsxs("span",{className:`font-black italic text-sm ${T?"text-red-700":"text-slate-900"}`,children:[w.userName," ",T&&"(YOU)"]}),p.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:new Date(w.updatedAt).toLocaleDateString()})]})]}),T&&n&&p.jsxs("button",{onClick:n,className:"flex items-center gap-1 bg-white text-blue-600 text-xs font-black px-3 py-1.5 rounded border-2 border-slate-900 shadow-sm hover:bg-blue-50 transition-all italic",children:[p.jsx(yp,{size:14})," "]})]}),p.jsxs("div",{className:"p-5 bg-white",children:[p.jsx("ul",{className:"space-y-3",children:w.items.map((B,A)=>p.jsxs("li",{className:"flex justify-between items-start text-sm border-b border-dashed border-slate-200 last:border-0 pb-2 last:pb-0",children:[p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{className:"text-slate-900 font-black text-base",children:B.name}),B.spec&&p.jsxs("span",{className:"text-slate-500 text-xs italic",children:[": ",B.spec]})]}),p.jsxs("div",{className:"flex flex-col items-end",children:[p.jsxs("span",{className:"font-black font-mono text-xl text-red-600 italic",children:["x ",B.quantity]}),p.jsx("div",{className:"text-right",children:p.jsxs("span",{className:"text-xs text-slate-500",children:["",B.price]})})]})]},A))}),p.jsxs("div",{className:"mt-4 pt-3 border-t-2 border-slate-200 flex flex-col items-end",children:[p.jsxs("div",{className:"flex gap-4 text-xs text-slate-400 mb-1 font-bold",children:[p.jsxs("span",{children:[" ",R.toLocaleString()]}),p.jsx("span",{children:"+"}),p.jsxs("span",{children:[" ",C]})]}),p.jsxs("div",{className:"flex items-baseline gap-2",children:[p.jsx("span",{className:"text-slate-500 text-sm",children:"TOTAL JPY"}),p.jsxs("span",{className:"font-black text-slate-900 font-mono text-2xl",children:["",W.toLocaleString()]})]}),p.jsxs("div",{className:"text-lg font-black bg-yellow-400 text-slate-900 px-3 py-0.5 rounded mt-1 italic border-2 border-slate-900",children:[" NT$",U.toLocaleString()]})]})]})]},w.userId)})]})]})}const rK="",Vf=250;function nK({group:t,orders:e,currentUser:r,onUpdate:n}){const a=r?.name===rK,[i,o]=re.useState(t.secondPayment?.weights||{}),[u,f]=re.useState(t.secondPayment?.boxWeight||0),[d,m]=re.useState(t.secondPayment?.minChargeDiff||0),x=re.useMemo(()=>t.items||[],[t.items]),y=re.useMemo(()=>{let w=0,T=0;const R=new Set;e.forEach(M=>{R.add(M.userId),M.items.forEach(F=>{const P=parseFloat(i[F.id]||i[F.itemId]||0);w+=P*F.quantity,T+=F.quantity})});const I=w+parseFloat(u||0),C=Math.max(.3,I),W=Math.round(C*Vf),U=parseFloat(u||0)*Vf,B=T>0?U/T:0,A=parseFloat(d||0),D=R.size,N=D>0?A/D:0;return{totalWeight:I.toFixed(2),billingWeight:C.toFixed(2),totalAmount:W,totalItemsCount:T,boxCostPerItem:B,minChargeTotal:A,minChargePerPerson:N}},[i,u,d,e]),b=()=>{n({weights:i,boxWeight:parseFloat(u),minChargeDiff:parseFloat(d)})},E=()=>{const w={};e.forEach(C=>{w[C.userId]||(w[C.userId]={name:C.userName,items:[],totalCost:0});let W=0;C.items.forEach(U=>{const A=parseFloat(i[U.id]||i[U.itemId]||0)*Vf+y.boxCostPerItem;W+=A*U.quantity,w[C.userId].items.push(`${U.name} x${U.quantity}`)}),w[C.userId].totalCost+=W});const T=Object.values(w).map(C=>({:C.name,:C.items.join(`
`)," (TWD)":Math.round(C.totalCost+y.minChargePerPerson),:""})),R=Ho.json_to_sheet(T);R["!cols"]=[{wch:15},{wch:40},{wch:15},{wch:20}];const I=Ho.book_new();Ho.book_append_sheet(I,R,""),c3(I,`_${t.title}.xlsx`)};return p.jsxs("div",{className:"space-y-6 font-sans text-slate-800",children:[p.jsxs("div",{className:"bg-slate-900 text-white p-4 rounded-xl border-2 border-yellow-400 shadow-lg",children:[p.jsxs("h4",{className:"font-black italic text-lg text-yellow-400 mb-3 flex items-center gap-2 transform -skew-x-3",children:[p.jsx(Ok,{size:20}),"  (INTL SHIPPING)"]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[p.jsxs("div",{className:"bg-slate-800 p-2 rounded border border-slate-600 flex flex-col justify-center",children:[p.jsx("span",{className:"text-slate-400 block text-xs mb-1",children:" (Billing Weight)"}),p.jsxs("div",{className:"flex items-baseline gap-2",children:[p.jsxs("span",{className:"text-xl font-mono font-bold text-white",children:[y.billingWeight," kg"]}),p.jsxs("span",{className:"text-[10px] text-slate-500",children:["( ",y.totalWeight," kg)"]})]})]}),p.jsxs("div",{className:"bg-slate-800 p-2 rounded border border-slate-600 flex flex-col justify-center",children:[p.jsx("span",{className:"text-slate-400 block text-xs mb-1",children:" (Total Cost)"}),p.jsxs("span",{className:"text-xl font-mono font-bold text-yellow-400",children:["NT$ ",y.totalAmount]})]})]}),p.jsxs("div",{className:"mt-2 text-xs text-slate-400 flex items-center gap-1",children:[p.jsx(oy,{size:12})," NT$250/kg ( 0.3kg  0.3kg )"]})]}),p.jsx("div",{className:"border-2 border-slate-900 rounded-lg overflow-hidden",children:p.jsxs("table",{className:"w-full text-sm",children:[p.jsx("thead",{className:"bg-slate-100 border-b-2 border-slate-900 text-slate-700 font-bold",children:p.jsxs("tr",{children:[p.jsx("th",{className:"p-3 text-left",children:""}),p.jsx("th",{className:"p-3 text-center w-24",children:""}),p.jsx("th",{className:"p-3 text-right",children:""})]})}),p.jsxs("tbody",{className:"divide-y divide-slate-200",children:[x.map(w=>{const T=parseFloat(i[w.id]||0),R=Math.round(T*Vf+y.boxCostPerItem);return p.jsxs("tr",{className:"bg-white hover:bg-slate-50",children:[p.jsxs("td",{className:"p-3 font-medium text-slate-900",children:[w.name," ",p.jsx("span",{className:"text-xs text-slate-400 block",children:w.spec})]}),p.jsx("td",{className:"p-3 text-center",children:a?p.jsx("input",{type:"number",step:"0.01",className:"w-20 border-2 border-slate-300 rounded px-1 text-center font-bold focus:border-yellow-400 focus:outline-none",placeholder:"kg",value:i[w.id]||"",onChange:I=>o({...i,[w.id]:I.target.value})}):p.jsxs("span",{className:"font-mono",children:[T||"-"," kg"]})}),p.jsxs("td",{className:"p-3 text-right font-bold text-slate-700",children:["NT$ ",R,p.jsx("span",{className:"text-[10px] text-slate-400 font-normal",children:"/"})]})]},w.id)}),p.jsxs("tr",{className:"bg-yellow-50/50",children:[p.jsxs("td",{className:"p-3 font-black text-slate-800 flex items-center gap-2",children:[p.jsx(vp,{size:16}),"  (Shared Box)"]}),p.jsx("td",{className:"p-3 text-center",children:a?p.jsx("input",{type:"number",step:"0.01",className:"w-20 border-2 border-yellow-400 rounded px-1 text-center font-bold focus:outline-none bg-white",placeholder:"kg",value:u,onChange:w=>f(w.target.value)}):p.jsxs("span",{className:"font-mono",children:[u," kg"]})}),p.jsxs("td",{className:"p-3 text-right text-xs text-slate-500",children:[p.jsxs("span",{className:"font-bold text-slate-700 block",children:["NT$ ",Math.round(y.boxCostPerItem),"/"]}),"()"]})]}),p.jsxs("tr",{className:"bg-blue-50/50",children:[p.jsxs("td",{className:"p-3 font-black text-slate-800 flex items-center gap-2",children:[p.jsx(pj,{size:16}),"  (Min Charge)"]}),p.jsx("td",{className:"p-3 text-center",children:a?p.jsx("input",{type:"number",className:"w-20 border-2 border-blue-400 rounded px-1 text-center font-bold focus:outline-none bg-white",placeholder:"NT$",value:d,onChange:w=>m(w.target.value)}):p.jsxs("span",{className:"font-mono",children:["NT$ ",d]})}),p.jsxs("td",{className:"p-3 text-right text-xs text-slate-500",children:[p.jsxs("span",{className:"font-bold text-slate-700 block",children:["NT$ ",Math.round(y.minChargePerPerson),"/"]}),"()"]})]})]})]})}),p.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg border-2 border-slate-200",children:[p.jsxs("h5",{className:"font-bold text-slate-700 mb-2 border-b border-slate-300 pb-1 flex justify-between items-end",children:[p.jsx("span",{children:""}),p.jsx("span",{className:"text-[10px] text-slate-400 font-normal",children:"(x250) + (x) + "})]}),p.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:e.map(w=>{let T=0;return w.items.forEach(R=>{const C=parseFloat(i[R.id]||i[R.itemId]||0)*Vf+y.boxCostPerItem;T+=C*R.quantity}),T+=y.minChargePerPerson,p.jsxs("div",{className:"flex justify-between text-sm hover:bg-slate-100 p-1 rounded",children:[p.jsxs("span",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"font-bold text-slate-700",children:w.userName}),p.jsxs("span",{className:"text-xs text-slate-400",children:["(",w.items.reduce((R,I)=>R+I.quantity,0)," )"]})]}),p.jsxs("span",{className:"font-mono font-black text-slate-900",children:["NT$ ",Math.round(T)]})]},w.userId)})})]}),a&&p.jsxs("div",{className:"flex justify-end pt-2 gap-2",children:[p.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded font-black border-2 border-green-800 hover:bg-green-700 shadow-[4px_4px_0px_0px_#166534] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(Nk,{size:18}),"  Excel"]}),p.jsxs("button",{onClick:b,className:"flex items-center gap-2 px-6 py-2 bg-slate-900 text-yellow-400 rounded font-black border-2 border-slate-900 hover:bg-slate-800 shadow-[4px_4px_0px_0px_#FACC15] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(ic,{size:18})," "]})]})]})}function PS({images:t}){const[e,r]=re.useState(0),n=Array.isArray(t)&&t.length>0?t:[];if(n.length===0)return p.jsx("div",{className:"w-full h-full flex items-center justify-center bg-stone-100 text-stone-300",children:p.jsx(Z0,{size:24,className:"opacity-20"})});const a=o=>{o.stopPropagation(),r(u=>(u+1)%n.length)},i=o=>{o.stopPropagation(),r(u=>(u-1+n.length)%n.length)};return p.jsxs("div",{className:"relative w-full h-full bg-stone-100 group",children:[p.jsx("img",{src:n[e],alt:"product",className:"w-full h-full object-cover transition-transform duration-500 hover:scale-105"}),n.length>1&&p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:i,className:"absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white text-stone-600",children:p.jsx(jM,{size:16})}),p.jsx("button",{onClick:a,className:"absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white text-stone-600",children:p.jsx(kk,{size:16})}),p.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1",children:n.map((o,u)=>p.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${u===e?"bg-orange-500":"bg-white/70"}`},u))})]})]})}function aK({currentUser:t,onLogout:e,onOpenModal:r}){const[n,a]=re.useState(!1),i=t?.isMember,o=async()=>{if(t)if(t.isMember){if(t.memberValidUntil)confirm(`
`)&&(await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{memberValidUntil:null,memberCancelledAt:null}),alert(""));else if(confirm(`
 30 `)){const u=new Date;u.setDate(u.getDate()+30),await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberValidUntil:u.toISOString(),memberCancelledAt:new Date().toISOString()}),alert(`
 ${u.toLocaleDateString()}`)}}else confirm(` PLUS ULTRA 
`)&&(await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberSince:new Date().toISOString(),memberValidUntil:null,memberCancelledAt:null}),alert(""))};return p.jsxs("div",{className:"relative z-50",children:[p.jsxs("button",{onClick:()=>a(!n),className:`w-10 h-10 rounded-full bg-slate-800 border-2 ${i?"border-purple-500":"border-yellow-400"} shadow-lg overflow-hidden hover:scale-105 transition-all relative`,children:[p.jsx("img",{src:t.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${t.name}`,alt:"avatar",className:"w-full h-full object-cover"}),i&&p.jsx("div",{className:"absolute -top-1 -right-1 bg-purple-600 rounded-full p-0.5 border border-white",children:p.jsx(Rm,{size:8,className:"text-white fill-white"})})]}),n&&p.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-xl border-2 border-slate-900 py-1 z-50 animate-in fade-in slide-in-from-top-2",children:[p.jsxs("div",{className:"px-3 py-2 border-b-2 border-slate-100 bg-slate-50",children:[p.jsxs("div",{className:"flex justify-between items-center mb-1",children:[p.jsxs("span",{className:"text-xs font-black text-slate-500 flex items-center gap-1",children:[p.jsx(Rm,{size:12,className:i?"text-purple-600 fill-purple-600":"text-slate-300"}),"PLUS "]}),i&&p.jsx("span",{className:"text-[10px] bg-purple-100 text-purple-700 px-1.5 rounded font-bold",children:"SUBSCRIBED"})]}),p.jsx("button",{onClick:o,className:`w-full text-xs font-bold py-1.5 rounded border-2 transition-all ${i&&t.memberValidUntil?"bg-green-100 text-green-700 border-green-300 hover:bg-green-200":i?"bg-white border-slate-300 text-slate-500 hover:bg-red-50 hover:text-red-500 hover:border-red-300":"bg-purple-600 border-purple-800 text-white hover:bg-purple-700"}`,children:i?t.memberValidUntil?" ()":" (30)":" (NT$90/)"}),(t.memberSince||t.memberCancelledAt)&&p.jsxs("div",{className:"mt-2 text-[10px] text-slate-400 border-t border-slate-200 pt-1 space-y-0.5",children:[t.memberSince&&p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx(iy,{size:8})," : ",new Date(t.memberSince).toLocaleDateString()]}),t.memberValidUntil&&p.jsxs("div",{className:"text-red-500 font-bold flex items-center gap-1",children:[p.jsx(ay,{size:8})," : ",new Date(t.memberValidUntil).toLocaleDateString()]})]})]}),p.jsxs("button",{onClick:()=>{a(!1),r("changeName")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(Ko,{size:16})," "]}),p.jsxs("button",{onClick:()=>{a(!1),r("changeAvatar")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(sy,{size:16})," "]}),p.jsxs("button",{onClick:()=>{a(!1),r("changePwd")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(Ik,{size:16})," "]}),p.jsx("div",{className:"border-t-2 border-slate-100 my-1"}),t?.name===""&&p.jsx(P0,{to:"/admin/dashboard",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-yellow-50 hover:text-yellow-700 transition-colors border-b border-gray-100",role:"menuitem",onClick:()=>setIsOpen(!1),children:" "}),p.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2 font-black",children:[p.jsx(Dk,{size:16})," "]})]})]})}function sK({title:t="",user:e,children:r,onLogout:n,onOpenModal:a}){return p.jsx("header",{className:"sticky top-0 z-30 bg-slate-900 border-b-4 border-yellow-400 px-4 py-3 shadow-md",children:p.jsxs("div",{className:"max-w-5xl mx-auto flex flex-wrap items-center justify-between gap-y-3",children:[p.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto justify-center md:justify-start",children:[p.jsx("div",{className:"bg-yellow-400 p-2 rounded transform -skew-x-12 border-2 border-yellow-800",children:p.jsx(Pk,{size:24,className:"text-slate-900 transform skew-x-12"})}),p.jsx("h1",{className:"text-3xl md:text-2xl font-black italic tracking-tight text-white drop-shadow-md",children:t})]}),p.jsxs("div",{className:"flex items-center w-full md:w-auto md:flex-1 md:justify-end gap-2",children:[p.jsx("div",{className:"flex-1 min-w-0 md:flex-none",children:r}),p.jsxs("div",{className:"text-right hidden md:block shrink-0",children:[p.jsx("p",{className:"text-xs text-slate-400",children:"HERO NAME"}),p.jsx("p",{className:"font-bold text-white tracking-wide",children:e?.name})]}),p.jsx("div",{className:"shrink-0 ml-1",children:p.jsx(aK,{currentUser:e,onLogout:n,onOpenModal:a})})]})]})})}function iK({isMember:t,fee:e,amount:r,description:n}){const i=n||`

  ()
 `;return p.jsxs("div",{className:`\r
            relative group border-r border-slate-700 mr-1 pr-2 sm:mr-2 sm:pr-4\r
            flex w-full items-center justify-end gap-3   /*  */\r
            sm:w-auto sm:flex-col sm:items-end sm:gap-0  /*  */\r
        `,children:[p.jsxs("button",{type:"button",onClick:()=>alert(i),className:`\r
                    focus:outline-none group/btn\r
                    flex items-center gap-2              /*  */\r
                    sm:mb-1 sm:gap-1.5\r
                `,children:[p.jsx("span",{className:"text-[16px] sm:text-base text-slate-400 font-bold whitespace-nowrap pt-0.5",children:""}),p.jsxs("span",{className:"text-[10px] text-yellow-500 group-hover/btn:text-yellow-400 border-b border-dashed border-yellow-500/50 flex items-center gap-0.5 transition-colors",children:[p.jsx("span",{className:"hidden sm:inline",children:"?"}),p.jsx(Nm,{className:"block sm:hidden",size:14}),p.jsx(Nm,{className:"hidden sm:block",size:10})]})]}),p.jsxs("div",{className:"text-yellow-400 font-black drop-shadow-sm text-right flex items-center",children:[p.jsx("span",{className:"text-xs mr-1 text-yellow-200 mt-1",children:"NT$"}),p.jsx("span",{className:"text-xl sm:text-xl font-mono",children:t?`${e} + ${r.toLocaleString()}`:r.toLocaleString()})]}),p.jsx("div",{className:"absolute top-12 right-0 w-max bg-slate-800 text-white text-xs p-2 rounded border border-yellow-400 shadow-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 hidden sm:block whitespace-pre-wrap text-left",children:i})]})}const ux=["","","","","","","",""],lK=90;function oK({appUser:t,usersData:e,handleLogout:r}){const[n,a]=re.useState([]),[i,o]=re.useState([]),[u,f]=re.useState([]),[d,m]=re.useState([]),[x,y]=re.useState(null),[b,E]=re.useState(null),[w,T]=re.useState(null),[R,I]=re.useState("wishing"),[C,W]=re.useState(""),[U,B]=re.useState(""),[A,D]=re.useState("<div>Loading...</div>"),N=15,[M,F]=re.useState(1),[P,V]=re.useState(0),Ee=i.find(le=>le.id===b)||null;re.useEffect(()=>{const le=Un(ar($e,"artifacts","default-app-id","public","data","wishes"),Et=>a(Et.docs.map(zt=>({id:zt.id,...zt.data()})))),Qe=Un(ar($e,"artifacts","default-app-id","public","data","groups"),Et=>o(Et.docs.map(zt=>({id:zt.id,...zt.data()})))),Be=Un(ar($e,"artifacts","default-app-id","public","data","orders"),Et=>f(Et.docs.map(zt=>({id:zt.id,...zt.data()})))),Ye=Un(ar($e,"artifacts","default-app-id","public","data","miscCharges"),Et=>m(Et.docs.map(zt=>({id:zt.id,...zt.data()})))),et=Un(St($e,"artifacts","default-app-id","public","data","system","bulletin"),Et=>{Et.exists()&&D(Et.data().content)});return()=>{le(),Qe(),Be(),Ye(),et()}},[]),re.useEffect(()=>{F(1)},[R,C,U]);const we=(le,Qe)=>{const Be=le.updatedAt||le.createdAt;if(!Be)return!1;const Ye=`${Qe}_${le.id}`;let et=t?.readHistory?.[Ye];if(!et){const Et=`read_${t?.id}_${Qe}_${le.id}`;et=localStorage.getItem(Et)}return et?new Date(Be)>new Date(et):!0},ie=async(le,Qe)=>{const Be=new Date().toISOString(),Ye=`${Qe}_${le.id}`,et=`read_${t?.id}_${Qe}_${le.id}`;if(localStorage.setItem(et,Be),V(Et=>Et+1),t&&t.id)try{const Et=St($e,"artifacts","default-app-id","public","data","users",t.id);await X0(Et,{readHistory:{[Ye]:Be}},{merge:!0})}catch(Et){console.error("",Et)}},ee=async le=>{t&&(await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{password:le}),alert(""),y(null))},ye=async le=>{if(t)try{await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{name:le}),alert(""),y(null)}catch(Qe){console.error("",Qe),alert("")}},ae=async le=>{t&&(await nn(St($e,"artifacts","default-app-id","public","data","users",t.id),{avatar:le}),alert(""),y(null))},Me=async le=>{try{w?await nn(St($e,"artifacts","default-app-id","public","data","wishes",w.id),{...le,updatedAt:new Date().toISOString()}):await Us(ar($e,"artifacts","default-app-id","public","data","wishes"),{...le,authorName:t.name,authorId:t.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),plusOnes:[]}),y(null),T(null)}catch(Qe){console.error(Qe),alert("")}},Y=async le=>{if(confirm(`${le.title}`))try{await bu(St($e,"artifacts","default-app-id","public","data","wishes",le.id))}catch(Qe){console.error(Qe)}},j=async le=>{if(!t)return;ie(le,"wish");const Qe=le.plusOnes||[],Ye=Qe.includes(t.name)?Qe.filter(et=>et!==t.name):[...Qe,t.name];await nn(St($e,"artifacts","default-app-id","public","data","wishes",le.id),{plusOnes:Ye})},X=async le=>{const Qe={title:`[] ${le.ipName}`,type:"",infoUrl:le.sourceUrl,status:"",createdBy:t.name,createdById:t.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),exchangeRate:.21,shippingFee:0,deadline:"",items:le.items.map(Be=>({id:Be.id,name:Be.name,price:Be.price,limit:Be.quantity,image:"",spec:""})),note:le.note,requestType:le.type,secondPayment:{},paymentStatus:""};try{const Be=await Us(ar($e,"artifacts","default-app-id","public","data","groups"),Qe),Ye=le.items.map(et=>({itemId:et.id,name:et.name,price:et.price,quantity:et.quantity,image:""}));await Us(ar($e,"artifacts","default-app-id","public","data","orders"),{groupId:Be.id,userId:t.id,userName:t.name,items:Ye,updatedAt:new Date().toISOString()}),y(null),alert("")}catch(Be){console.error("",Be),alert("")}},J=async(le,Qe)=>{const Be=u.find(et=>et.groupId===Qe&&et.userId===t.id);if(le.length===0){if(Be)try{await bu(St($e,"artifacts","default-app-id","public","data","orders",Be.id)),alert("")}catch(et){console.error("",et),alert("")}y("viewOrders");return}const Ye={groupId:Qe,userId:t.id,userName:t.name,items:le,updatedAt:new Date().toISOString()};Be?await nn(St($e,"artifacts","default-app-id","public","data","orders",Be.id),Ye):await Us(ar($e,"artifacts","default-app-id","public","data","orders"),Ye),y("viewOrders")},ne=re.useMemo(()=>{if(!u||!i||u.length===0||!t)return 0;const le=u.reduce((Be,Ye)=>{if(Ye.userId!==t.id)return Be;const et=i.find(zt=>zt.id===Ye.groupId);if(!et)return Be;const Et={};if(u.forEach(zt=>{zt.groupId===et.id&&(Et[et.id]||(Et[et.id]=0),zt.items.forEach(Bt=>{Et[et.id]+=Number(Bt.quantity)||0}))}),["",""].includes(et.status)){const zt=Number(et.exchangeRate||0),Bt=Number(et.shippingFee||0),Br=Et[et.id]||1,Nn=Bt/Br,pa=(Ye.items||[]).reduce((Yt,Dr)=>Yt+(Number(Dr.quantity)||0),0),dr=(Ye.items||[]).reduce((Yt,Dr)=>Yt+(Number(Dr.price)||0)*(Number(Dr.quantity)||0),0),Rn=Nn*pa,mt=dr+Rn,Kt=Math.round(mt*zt);let Ir=0;if(et.secondPayment){const Dr=et.secondPayment.weights||{},gr=parseFloat(et.secondPayment.boxWeight||0),zi=parseFloat(et.secondPayment.minChargeDiff||0),ss=gr*250,ei=Br>0?ss/Br:0,Fa=new Set(u.filter(Or=>Or.groupId===et.id).map(Or=>Or.userId)).size,Er=Fa>0?zi/Fa:0;Ye.items.forEach(Or=>{const Xn=parseFloat(Dr[Or.itemId]||0)*250+ei;Ir+=Xn*Or.quantity}),Ir+=Er}const Tt=et.paymentStatus||"";if(Tt==="")return Be;if(Tt==="")return Be+Kt;if(Tt==="")return Be;if(Tt==="")return Be+Math.round(Ir);if(Tt==="")return Be;if(Tt==="+")return Be+Kt+Math.round(Ir);if(Tt==="+")return Be}return Be},0),Qe=d.filter(Be=>Be.targetUserId===t.id&&(Be.paymentStatus||"")==="").reduce((Be,Ye)=>Be+Number(Ye.amount||0),0);return le+Qe},[u,i,t,d]),{memberFeeSplit:ue,isMember:Te}=re.useMemo(()=>{if(!t||!e.length)return{memberFeeSplit:0,isMember:!1};const le=e.filter(Be=>Be.isMember).length;return{memberFeeSplit:le>0?Math.ceil(lK/le):0,isMember:t.isMember}},[t,e]),Re=le=>{let Qe=i.filter(Be=>le.includes(Be.status));return(C||U)&&(Qe=Qe.filter(Be=>{if(!Be.deadline||Be.deadline==="")return!1;const Ye=new Date(Be.deadline).getTime(),et=C?new Date(C).getTime():0,Et=U?new Date(U).getTime()+864e5:1/0;return Ye>=et&&Ye<Et})),Qe.sort((Be,Ye)=>{const et=Be.releaseDate||"9999-12-31",Et=Ye.releaseDate||"9999-12-31";return et.localeCompare(Et)})},Ce=Re([""]),Fe=Re([""]),st=Re([""]),te=Re([""]),Ct=R==="active"?Ce:R==="completed"?Fe:R==="shipping"?st:R==="closed"?te:[],lt=Math.ceil(Ct.length/N),It=Ct.slice((M-1)*N,M*N),ht=()=>lt<=1?null:p.jsxs("div",{className:"flex justify-center items-center gap-2 mt-8 animate-in fade-in slide-in-from-bottom-4",children:[p.jsx("button",{onClick:()=>F(le=>Math.max(1,le-1)),disabled:M===1,className:"px-3 py-1 rounded font-black border-2 border-slate-900 bg-white text-slate-900 hover:bg-slate-100 disabled:opacity-30 disabled:cursor-not-allowed transition-all",children:"PREV"}),Array.from({length:lt},(le,Qe)=>Qe+1).map(le=>p.jsx("button",{onClick:()=>F(le),className:`w-8 h-8 rounded flex items-center justify-center font-black border-2 border-slate-900 transition-all ${M===le?"bg-slate-900 text-yellow-400 transform -translate-y-1 shadow-[2px_2px_0px_0px_#FACC15]":"bg-white text-slate-500 hover:bg-slate-50"}`,children:le},le)),p.jsx("button",{onClick:()=>F(le=>Math.min(lt,le+1)),disabled:M===lt,className:"px-3 py-1 rounded font-black border-2 border-slate-900 bg-white text-slate-900 hover:bg-slate-100 disabled:opacity-30 disabled:cursor-not-allowed transition-all",children:"NEXT"})]});return p.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-800 font-sans pb-20 selection:bg-yellow-400 selection:text-black",children:[p.jsx(sK,{user:t,onLogout:r,onOpenModal:le=>y(le),children:p.jsx(iK,{isMember:Te,fee:ue,amount:ne})}),p.jsx("section",{className:"max-w-5xl mx-auto mt-6 px-4",children:p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[p.jsxs("div",{className:"md:col-span-3 bg-white rounded-lg p-0 shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] border-2 border-slate-900 relative overflow-hidden flex flex-col",children:[p.jsx("div",{className:"bg-yellow-400 border-b-2 border-slate-900 p-3 flex justify-between items-center",children:p.jsxs("div",{className:"flex items-center gap-2 text-slate-900 font-black text-lg italic transform -skew-x-6",children:[p.jsx(Dm,{size:24,className:"fill-slate-900"}),p.jsx("h2",{children:"ACADEMY NEWS"})]})}),p.jsx("div",{className:"p-6 flex-1",children:p.jsx("div",{className:"prose prose-slate prose-sm max-w-none text-slate-700 font-medium",dangerouslySetInnerHTML:{__html:A}})})]}),p.jsx("div",{className:"md:col-span-1",children:p.jsx(P0,{to:"/jf26",className:"block w-full h-full relative group transition-all duration-300 hover:-translate-y-1 focus:outline-none",children:p.jsxs("div",{className:"h-full bg-white p-2 rounded-xl border-4 border-slate-900 shadow-[4px_4px_0px_0px_#FACC15] transition-all overflow-hidden relative flex flex-col",children:[p.jsx("div",{className:"bg-slate-900 text-yellow-400 font-black text-center text-sm py-1 mb-1 italic",children:"JF26 "}),p.jsxs("div",{className:"flex-1 overflow-hidden rounded-lg border-2 border-slate-100 relative",children:[p.jsx("img",{src:"https://www.jumpfesta.com/assets/images/top_jumpfesta_pc@2x.webp",alt:"JF26",className:"w-full h-full object-cover"}),p.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors"})]}),p.jsx("div",{className:"absolute top-2 right-2 bg-red-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full animate-pulse border border-white shadow-sm transform rotate-12",children:"HOT!"})]})})})]})}),p.jsx("nav",{className:"max-w-5xl mx-auto mt-8 px-4",children:p.jsx("div",{className:"bg-white p-1 rounded-lg shadow-sm border-2 border-slate-200 flex justify-around gap-1",children:[{id:"wishing",label:"",icon:mT},{id:"active",label:"",icon:Om},{id:"completed",label:"",icon:J0},{id:"shipping",label:"",icon:Ok},{id:"misc",label:"",icon:zx},{id:"closed",label:"",icon:wM}].map(le=>p.jsxs("button",{onClick:()=>I(le.id),className:`flex-1 flex flex-col items-center justify-center gap-1 py-2 px-0.5 sm:px-4 rounded font-black transition-all border-2 ${R===le.id?"bg-slate-900 border-slate-900 text-yellow-400 shadow-md transform -translate-y-1":"bg-transparent border-transparent text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:[p.jsx(le.icon,{size:20,className:R===le.id?"animate-pulse":""}),p.jsx("span",{className:"text-[11px] sm:text-sm whitespace-nowrap",children:le.label})]},le.id))})}),p.jsxs("main",{className:"max-w-5xl mx-auto px-4 py-8",children:[R==="wishing"&&p.jsxs("div",{children:[p.jsxs("div",{className:"mb-6 bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r shadow-sm text-blue-900 text-sm font-bold flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[p.jsx(oy,{className:"shrink-0 mt-0.5 text-blue-600",size:18}),p.jsx("p",{className:"leading-relaxed",children:"+1"})]}),p.jsx("div",{className:"flex justify-end mb-6",children:p.jsxs("button",{onClick:()=>{T(null),y("wish")},className:"px-6 py-2 bg-red-600 text-white border-2 border-red-800 rounded font-black hover:bg-red-700 flex items-center gap-2 shadow-[2px_2px_0px_0px_rgba(153,27,27,1)] active:translate-y-0.5 active:shadow-none transition-all italic",children:[p.jsx($o,{size:20})," MAKE A WISH"]})}),p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(le=>{const Qe=we(le,"wish");return p.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm border-2 border-slate-200 hover:border-slate-900 hover:shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] transition-all flex flex-col h-full relative group",onClick:()=>ie(le,"wish"),children:[Qe&&p.jsx("div",{className:"absolute -top-3 -left-3 bg-red-600 text-white text-xs font-black px-2 py-1 shadow-md transform -rotate-12 z-50 border-2 border-white pointer-events-none animate-bounce",children:"NEW!"}),p.jsx("div",{className:"mb-3 w-full aspect-video bg-slate-100 rounded border border-slate-200 overflow-hidden",children:p.jsx(PS,{images:le.images})}),p.jsxs("div",{className:"flex-1",children:[p.jsx("h3",{className:"font-bold text-lg text-slate-900 line-clamp-2 mb-2",children:le.title}),p.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[p.jsxs("span",{className:"bg-yellow-100 text-yellow-800 border border-yellow-200 text-xs px-2 py-1 rounded font-bold",children:["BY: ",le.authorName]}),le.url&&p.jsxs("a",{href:le.url,target:"_blank",rel:"noreferrer",onClick:Be=>Be.stopPropagation(),className:"text-blue-600 font-bold text-xs hover:underline truncate max-w-[120px] flex items-center gap-1",children:[p.jsx(zs,{size:10})," Link"]})]}),p.jsx("p",{className:"text-slate-600 text-sm mb-4 line-clamp-3 bg-slate-50 p-2 rounded border border-slate-100",children:le.note||""})]}),p.jsxs("div",{className:"pt-4 border-t-2 border-slate-100 flex justify-between items-end mt-auto",children:[p.jsx("div",{className:"text-xs font-bold text-slate-400",children:le.plusOnes?.length>0&&p.jsxs("span",{className:"text-red-600 flex items-center gap-1",children:[p.jsx(mT,{size:10,className:"fill-red-600"})," ",le.plusOnes.length," "]})}),p.jsxs("div",{className:"flex gap-2",children:[t?.id===le.authorId&&p.jsx("button",{onClick:Be=>{Be.stopPropagation(),Y(le)},className:"text-slate-400 hover:text-red-600 p-1",children:p.jsx(eh,{size:16})}),p.jsx("button",{onClick:Be=>{Be.stopPropagation(),j(le)},className:`flex items-center gap-1 px-3 py-1.5 rounded-full text-sm font-black border-2 transition-all ${le.plusOnes?.includes(t?.name)?"bg-red-100 border-red-500 text-red-600":"bg-white border-slate-200 text-slate-400 hover:border-slate-400"}`,children:"+1"})]})]})]},le.id)})})]}),R==="misc"&&p.jsxs("div",{children:[p.jsxs("div",{className:"mb-6 bg-gray-50 border-l-4 border-gray-500 p-4 rounded-r shadow-sm text-gray-900 text-sm font-bold flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[p.jsx(zx,{className:"shrink-0 mt-0.5 text-gray-600",size:18}),p.jsx("p",{className:"leading-relaxed",children:"..."})]}),p.jsx("div",{className:"bg-white rounded-lg shadow-sm border-2 border-slate-200 overflow-hidden",children:p.jsxs("table",{className:"w-full text-sm text-left",children:[p.jsx("thead",{className:"bg-slate-100 text-slate-700 font-black border-b-2 border-slate-200",children:p.jsxs("tr",{children:[p.jsx("th",{className:"px-4 py-3",children:""}),p.jsx("th",{className:"px-4 py-3",children:""}),p.jsx("th",{className:"px-4 py-3",children:""}),p.jsx("th",{className:"px-4 py-3 text-right",children:" (TWD)"}),p.jsx("th",{className:"px-4 py-3 text-center",children:""})]})}),p.jsxs("tbody",{children:[d.filter(le=>le.targetUserId===t?.id||t?.name==="").sort((le,Qe)=>new Date(Qe.createdAt)-new Date(le.createdAt)).map(le=>p.jsxs("tr",{className:`border-b border-slate-100 transition-colors ${(le.paymentStatus||"")===""?"bg-green-50/50":"hover:bg-slate-50"}`,children:[p.jsx("td",{className:"px-4 py-3 text-slate-500 font-mono text-xs",children:new Date(le.createdAt).toLocaleDateString()}),p.jsx("td",{className:"px-4 py-3 font-bold text-slate-800",children:le.title}),p.jsx("td",{className:"px-4 py-3 text-slate-500 text-xs max-w-[150px] truncate",title:le.note,children:le.note||"-"}),p.jsxs("td",{className:`px-4 py-3 text-right font-black ${(le.paymentStatus||"")===""?"text-slate-400 line-through decoration-2":"text-slate-900"}`,children:["$",le.amount]}),p.jsx("td",{className:"px-4 py-3 text-center",children:p.jsx("span",{className:`px-2 py-1 rounded text-xs font-black ${(le.paymentStatus||"")===""?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:le.paymentStatus||""})})]},le.id)),d.filter(le=>le.targetUserId===t?.id).length===0&&p.jsx("tr",{children:p.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-slate-400 font-bold",children:""})})]})]})})]}),(R==="active"||R==="completed"||R==="closed"||R==="shipping")&&p.jsxs("div",{children:[R==="active"&&p.jsxs("div",{className:"mb-6 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r shadow-sm text-yellow-900 text-sm font-bold flex items-start gap-3 animate-in fade-in slide-in-from-top-2",children:[p.jsx(Dm,{className:"shrink-0 mt-0.5 text-yellow-600",size:18}),p.jsx("p",{className:"leading-relaxed",children:"~~ ~"})]}),p.jsxs("div",{className:"mb-6 bg-slate-200 p-3 rounded-lg flex flex-col sm:flex-row items-center gap-4 border-2 border-slate-300",children:[p.jsxs("div",{className:"flex items-center gap-2 font-bold text-slate-700 text-sm",children:[p.jsx(Fk,{size:18,className:"text-slate-500"})," ",R==="active"?":":":"]}),p.jsxs("div",{className:"flex items-center gap-2 flex-1 w-full",children:[p.jsx("input",{type:"date",className:"border-2 border-slate-300 rounded px-2 py-1 text-sm focus:border-yellow-400 focus:outline-none flex-1",value:C,onChange:le=>W(le.target.value)}),p.jsx("span",{className:"text-slate-400 font-bold",children:"~"}),p.jsx("input",{type:"date",className:"border-2 border-slate-300 rounded px-2 py-1 text-sm focus:border-yellow-400 focus:outline-none flex-1",value:U,onChange:le=>B(le.target.value)})]}),(C||U)&&p.jsx("button",{onClick:()=>{W(""),B("")},className:"text-xs bg-slate-400 text-white px-3 py-1.5 rounded font-bold hover:bg-slate-500",children:""})]}),R==="active"&&p.jsx("div",{className:"flex justify-end mb-6 gap-2",children:t?.name!==""&&p.jsxs("button",{onClick:()=>y("createPersonalRequest"),className:"px-6 py-2 bg-purple-600 text-white rounded border-2 border-purple-800 font-black hover:bg-purple-700 flex items-center gap-2 shadow-[4px_4px_0px_0px_rgba(76,29,149,1)] active:translate-y-0.5 active:shadow-none transition-all italic",children:[p.jsx(Om,{size:18})," "]})}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[It.map(le=>{const Qe=!!u.find(Ye=>Ye.groupId===le.id&&Ye.userId===t?.id),Be=R==="active"?we(le,"group"):!1;return p.jsxs("div",{className:`bg-white rounded-lg p-5 shadow-sm border-2 border-slate-900 flex flex-col relative overflow-visible ${R==="closed"?"opacity-75 grayscale-[0.5]":""}`,onClick:()=>R==="active"&&ie(le,"group"),children:[Be&&p.jsx("div",{className:"absolute -top-3 -left-3 bg-red-600 text-white text-xs font-black px-2 py-1 shadow-md transform -rotate-12 z-50 border-2 border-white pointer-events-none animate-bounce",children:"NEW!"}),p.jsx("div",{className:"flex justify-between items-start mb-2",children:p.jsxs("div",{className:"flex flex-col gap-1",children:[le.type===""?p.jsx("span",{className:"self-start px-2 py-0.5 text-[10px] font-black text-white bg-green-600 rounded border border-green-800",children:"  IN STOCK"}):le.type===""?p.jsx("span",{className:"self-start px-2 py-0.5 text-[10px] font-black text-white bg-purple-600 rounded border border-purple-800",children:"  REQUEST"}):p.jsx("span",{className:"self-start px-2 py-0.5 text-[10px] font-black text-slate-900 bg-yellow-400 rounded border border-slate-900",children:"  PRE-ORDER"}),p.jsx("h3",{className:"font-black text-xl text-slate-900 italic",children:le.title})]})}),p.jsx("div",{className:"mb-4 w-full aspect-video bg-slate-100 rounded border border-slate-200 overflow-hidden",children:p.jsx(PS,{images:le.images||[]})}),p.jsxs("div",{className:"space-y-2 text-sm text-slate-600 mb-6 flex-1",children:[p.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1 font-bold",children:[p.jsx("span",{children:""}),p.jsx("span",{className:"text-red-600",children:le.deadline})]}),le.releaseDate&&p.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1 font-bold",children:[p.jsx("span",{children:""}),p.jsx("span",{className:"text-blue-600",children:le.releaseDate})]}),p.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1",children:[p.jsx("span",{children:""}),p.jsxs("span",{children:[le.items?.length||0," "]})]}),le.infoUrl&&p.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1",children:[p.jsx("span",{children:""}),p.jsxs("a",{href:le.infoUrl,target:"_blank",rel:"noreferrer",onClick:Ye=>Ye.stopPropagation(),className:"text-blue-600 font-bold hover:underline flex items-center gap-1",children:[p.jsx(zs,{size:12})," Link"]})]}),Qe&&R==="active"&&p.jsx("div",{className:"mt-2 bg-green-100 text-green-700 border border-green-300 px-2 py-1 rounded text-center text-xs font-black transform -rotate-1",children:" (ORDERED)"})]}),le.status!==""&&p.jsxs("div",{className:"mt-4 mb-4",children:[p.jsx("div",{className:"flex justify-between text-[10px] text-slate-400 mb-1 px-1 font-bold",children:ux.map(Ye=>p.jsx("span",{className:`${(le.trackingStatus||"")===Ye?"text-blue-600":""}`,children:Ye},Ye))}),p.jsx("div",{className:"h-3 bg-slate-200 rounded-full overflow-hidden flex border border-slate-300",children:ux.map((Ye,et)=>{const Et=ux.indexOf(le.trackingStatus||"");return p.jsx("div",{className:`flex-1 border-r border-white last:border-0 transition-all duration-500 ${et<=Et?"bg-blue-600":"bg-transparent"}`},Ye)})})]}),p.jsxs("div",{className:"flex gap-2 mt-auto",children:[R==="active"&&p.jsx("button",{className:`flex-1 px-4 py-2 rounded font-black text-white border-2 transition-all italic ${Qe?"bg-green-600 border-green-800 hover:bg-green-700":"bg-red-600 border-red-800 hover:bg-red-700"}`,onClick:Ye=>{Ye.stopPropagation(),E(le.id),y("joinGroup")},children:Qe?"":""}),p.jsx("button",{className:`px-3 py-2 rounded font-bold border-2 ${R!=="active"?"flex-1 bg-slate-100 border-slate-300 text-slate-700 hover:bg-slate-200":"bg-white border-slate-300 text-slate-600 hover:border-slate-500"}`,onClick:Ye=>{Ye.stopPropagation(),E(le.id),y("viewOrders")},children:""})]})]},le.id)}),It.length===0&&p.jsxs("div",{className:"col-span-full py-12 flex flex-col items-center justify-center text-slate-300",children:[p.jsx(Mk,{size:48,className:"mb-3 opacity-50"}),p.jsx("p",{className:"font-bold",children:""})]})]}),p.jsx(ht,{})]})]}),p.jsx(ua,{isOpen:x==="wish",onClose:()=>{y(null),T(null)},title:w?"":"",children:p.jsx(QL,{onSubmit:Me,onCancel:()=>{y(null),T(null)},initialData:w})}),p.jsx(ua,{isOpen:x==="createPersonalRequest",onClose:()=>y(null),title:"",children:p.jsx(JL,{onSubmit:X,onCancel:()=>y(null)})}),p.jsx(ua,{isOpen:x==="secondPayment",onClose:()=>y(null),title:"",children:Ee&&p.jsx(nK,{group:Ee,orders:u.filter(le=>le.groupId===Ee?.id),currentUser:t,onUpdate:null,isReadOnly:!0})}),p.jsx(ua,{isOpen:x==="changeName",onClose:()=>y(null),title:"",children:p.jsx(eC,{currentUser:t,onSubmit:ye,onCancel:()=>y(null)})}),p.jsx(ua,{isOpen:x==="changePwd",onClose:()=>y(null),title:"",children:p.jsx(rC,{onSubmit:ee})}),p.jsx(ua,{isOpen:x==="changeAvatar",onClose:()=>y(null),title:"",children:p.jsx(tC,{currentUser:t,onSubmit:ae})}),p.jsx(ua,{isOpen:x==="joinGroup",onClose:()=>y(null),title:`${Ee?.title}`,children:Ee&&p.jsx(ZL,{group:Ee,currentOrder:u.find(le=>le.groupId===Ee?.id&&le.userId===t?.id),onSubmit:le=>J(le,Ee.id)})}),p.jsx(ua,{isOpen:x==="viewOrders",onClose:()=>y(null),title:`${Ee?.title}`,children:Ee&&p.jsx(tK,{group:Ee,orders:u.filter(le=>le.groupId===Ee?.id),currentUser:t,onEdit:Ee?.status===""?()=>y("joinGroup"):null})})]})}const cK=()=>{const[t,e]=re.useState(!1),[r,n]=re.useState([]),[a,i]=re.useState([]),[o,u]=re.useState(null),[f,d]=re.useState(0),m=F0(),x=["artifacts","default-app-id","public","data","backorders"],y=["artifacts","default-app-id","public","data","groups"],b=U=>n(B=>[...B,U]),E=async()=>{try{const U=ar($e,...x),B=await El(U),A=new Set;B.forEach(D=>{const N=D.data();N.sheetCategory&&A.add(N.sheetCategory)}),i(Array.from(A).sort())}catch(U){console.error("",U)}},w=async()=>{try{const U=ar($e,...y),B=await El(U);d(B.size)}catch(U){console.error(U)}};re.useEffect(()=>{E(),w()},[]);const T=async U=>{if(window.confirm(` ${U}`)){e(!0),b(`  [${U}]...`);try{const B=ar($e,...x),A=jx(B,GA("sheetCategory","==",U)),D=await El(A),N=Lx($e);D.forEach(M=>N.delete(M.ref)),await N.commit(),b(" "),E()}catch(B){b(` : ${B.message}`)}finally{e(!1)}}},R=U=>{const B=U.target.files[0];B&&(u(B),n([` ${B.name}`," "]))},I=async()=>{if(!o)return;e(!0),n(B=>[...B," ..."]);const U=new FileReader;U.onload=async B=>{try{const A=B.target.result,D=av(A,{type:"binary"});let N=D.SheetNames.filter(F=>F.includes(""));N.length===0&&(N=D.SheetNames),b(` : ${N.join(", ")}`);const M=[];if(N.forEach(F=>{const P=D.Sheets[F],V=Ho.sheet_to_json(P,{header:1});let Ee=-1,we={};for(let ie=0;ie<V.length;ie++)if(JSON.stringify(V[ie]).includes("")){Ee=ie,V[ie].forEach((ee,ye)=>{if(typeof ee!="string")return;const ae=ee.trim();ae.includes("")?we.title=ye:ae.includes("")?we.type=ye:ae.includes("")||ae.includes("")?we.orderDate=ye:ae.includes("")?we.rate=ye:ae.includes("")?we.status=ye:ae.includes("")?we.payProgress=ye:ae.includes("")?we.payStatus=ye:ae.includes("")&&(we.link=ye)});break}if(Ee!==-1)for(let ie=Ee+1;ie<V.length;ie++){const ee=V[ie];if(!we.title||!ee[we.title])continue;let ye="";ee[we.status]&&String(ee[we.status]).includes("")&&(ye="");let ae=ee[we.orderDate],Me=ee[we.rate];const Y={title:ee[we.title],type:ee[we.type]||"",orderDate:ae||"",rate:parseFloat(Me)||0,status:ye,paymentStatus:`${ee[we.payProgress]||""} ${ee[we.payStatus]||""}`.trim(),link:ee[we.link]||"",sheetCategory:F,createdAt:new Date().toISOString(),isArchived:ye===""};Object.keys(Y).forEach(j=>Y[j]===void 0&&delete Y[j]),M.push(Y)}}),M.length===0)b(" ");else{const F=ar($e,...x),P=500;let V=0;for(let Ee=0;Ee<M.length;Ee+=P){const we=M.slice(Ee,Ee+P);await Promise.all(we.map(async ie=>{await Us(F,ie),V++}))}b(`  ${V}  backorders`),E(),u(null),document.getElementById("file_input").value=""}}catch(A){b(` : ${A.message}`)}finally{e(!1)}},U.readAsBinaryString(o)},C=async()=>{if(window.confirm(`backordersgroups
 Groups

`)){e(!0),b("  Groups...");try{const U=ar($e,...x),B=await El(U);if(B.empty){b(" backorders "),e(!1);return}const A=ar($e,...y);let D=0;const N=B.docs.map(async M=>{const F=M.data();let P=F.rate,V=F.orderDate;(P===0||!P)&&typeof F.orderDate=="number"&&F.orderDate<1&&(P=F.orderDate,V="");let Ee="2025-12-31T23:59";typeof V=="string"&&V.includes(".")&&(Ee=V.replace(/\./g,"-")+"T23:59");const we={title:F.title,exchangeRate:Number(P)||0,deadline:Ee,status:"",trackingStatus:F.status||"",paymentStatus:F.paymentStatus||"",type:F.type||"",infoUrl:F.link||"",createdBy:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),sheetCategory:F.sheetCategory,images:[],items:[{id:1,name:F.title,spec:"",price:"0",image:""}]};await Us(A,we),D++});await Promise.all(N),b(`  ${D} `),w()}catch(U){console.error(U),b(` : ${U.message}`)}finally{e(!1)}}},W=async()=>{const U=prompt(`  (Groups)


 'DELETE' `);if(U!=="DELETE"){U!==null&&alert("");return}e(!0),b("  Groups ...");try{const B=ar($e,...y),A=await El(B);if(A.empty){b(" Groups "),e(!1);return}const D=Lx($e);let N=0;A.forEach(M=>{D.delete(M.ref),N++}),await D.commit(),b(`  Groups ${N} `),w()}catch(B){b(` : ${B.message}`)}finally{e(!1)}};return p.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:""}),p.jsx("button",{onClick:()=>m("/"),className:"px-4 py-2 bg-white border rounded shadow-sm hover:bg-gray-50",children:" "})]}),p.jsxs("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-blue-500",children:[p.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-2 flex items-center gap-2",children:[p.jsx(YM,{}),"  1 Excel  (Backorders)"]}),p.jsxs("div",{className:"flex gap-4 items-end",children:[p.jsx("input",{id:"file_input",type:"file",accept:".xlsx, .xls",onChange:R,disabled:t,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),p.jsx("button",{onClick:I,disabled:!o||t,className:`px-6 py-2 rounded-lg font-bold text-white ${o?"bg-blue-600 hover:bg-blue-700":"bg-gray-400"}`,children:""})]})]}),p.jsxs("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-yellow-500",children:[p.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:" 2"}),p.jsx("div",{className:"bg-gray-50 rounded-md p-4 max-h-40 overflow-y-auto mb-4",children:a.length===0?p.jsx("p",{className:"text-sm text-gray-400",children:""}):p.jsx("ul",{className:"space-y-2",children:a.map(U=>p.jsxs("li",{className:"flex justify-between items-center text-sm",children:[p.jsx("span",{children:U}),p.jsxs("button",{onClick:()=>T(U),className:"text-red-600 hover:underline flex items-center gap-1",children:[p.jsx(eh,{size:14})," "]})]},U))})})]}),p.jsx("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-green-500",children:p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("div",{children:[p.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[p.jsx(PP,{}),"  3 (Sync to Groups)"]}),p.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[" Groups  ",p.jsx("span",{className:"font-bold text-green-600",children:f})," "]})]}),p.jsx("button",{onClick:C,disabled:t||a.length===0,className:`px-6 py-3 rounded-lg font-bold text-white shadow-lg transition-transform transform active:scale-95 ${t||a.length===0?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:" "})]})}),p.jsx("div",{className:"bg-red-50 shadow rounded-lg p-6 border-2 border-red-200",children:p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("div",{children:[p.jsxs("h3",{className:"text-lg font-bold text-red-700 flex items-center gap-2",children:[p.jsx(Lk,{})," "]}),p.jsx("p",{className:"text-sm text-red-600 mt-1",children:" Groups "})]}),p.jsxs("button",{onClick:W,disabled:t||f===0,className:`px-4 py-2 rounded-lg font-bold text-white shadow transition-colors ${t||f===0?"bg-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700"}`,children:["  Groups (",f,")"]})]})}),p.jsx("div",{className:"bg-black text-green-400 p-4 rounded-lg shadow h-64 overflow-y-auto font-mono text-xs leading-5",children:r.length===0?"...":r.map((U,B)=>p.jsx("div",{className:"border-b border-gray-800 pb-1 mb-1 break-all",children:U},B))})]})})},uK=["","",""],fK=["","","","","","","",""],hK=["","","","","","+","+"],dK=()=>{const[t,e]=re.useState([]),[r,n]=re.useState([]),[a,i]=re.useState(null),[o,u]=re.useState([]),[f,d]=re.useState(!0),[m,x]=re.useState(!1),[y,b]=re.useState({});F0();const E=["artifacts","default-app-id","public","data","groups"],w=["artifacts","default-app-id","public","data","users"],T=["artifacts","default-app-id","public","data","orders"],R=async()=>{d(!0);try{const ee=ar($e,...E),ye=jx(ee,u9("createdAt","desc")),Me=(await El(ye)).docs.map(X=>({id:X.id,...X.data()}));if(e(Me),Me.length>0){const X=Me[0].sheetCategory||"";b({[X]:!0})}const Y=ar($e,...w),j=await El(Y);n(j.docs.map(X=>({id:X.id,...X.data()})))}catch(ee){console.error("",ee)}finally{d(!1)}};re.useEffect(()=>{R()},[]);const I=re.useMemo(()=>{const ee={};return t.forEach(ye=>{const ae=ye.sheetCategory||"";ee[ae]||(ee[ae]=[]),ee[ae].push(ye)}),Object.keys(ee).sort().reduce((ye,ae)=>(ye[ae]=ee[ae],ye),{})},[t]),C=ee=>{b(ye=>({...ye,[ee]:!ye[ee]}))},W=async ee=>{i(ee),u([]);try{const ye=ar($e,...T),ae=jx(ye,GA("groupId","==",ee.id)),Me=await El(ae);u(Me.docs.map(Y=>({id:Y.id,...Y.data()})))}catch(ye){console.error("",ye)}},U=async()=>{if(a){x(!0);try{const ee=St($e,...E,a.id),{id:ye,...ae}=a;ae.updatedAt=new Date().toISOString(),ae.trackingStatus===""?(ae.isArchived=!0,ae.status=""):(ae.isArchived=!1,ae.status=""),await nn(ee,ae);const Me=ar($e,...T),Y=o.map(async j=>{const X=j.items?.reduce((ue,Te)=>ue+Number(Te.price)*Number(Te.quantity),0)||0,J=Math.ceil(X*(a.exchangeRate||0)),ne={groupId:a.id,userId:j.userId,userName:j.userName,items:j.items,totalJpy:X,totalTwd:J,updatedAt:new Date().toISOString()};if(j.isNew){const{isNew:ue,id:Te,...Re}=ne;return Re.createdAt=new Date().toISOString(),Us(Me,Re)}else{const ue=St($e,...T,j.id);return nn(ue,ne)}});await Promise.all(Y),e(j=>j.map(X=>X.id===a.id?{...X,...ae}:X)),alert(" ")}catch{alert(" ")}finally{x(!1)}}},B=async ee=>{if(window.confirm(" "))try{await bu(St($e,...E,ee)),i(null),R()}catch{alert("")}},A=(ee,ye,ae)=>{const Me=[...a.items];Me[ee][ye]=ae,i({...a,items:Me})},D=()=>i({...a,items:[...a.items||[],{id:Date.now(),name:"",spec:"",price:"",image:""}]}),N=ee=>i({...a,items:a.items.filter((ye,ae)=>ae!==ee)}),M=()=>u([...o,{id:`temp-${Date.now()}`,isNew:!0,userId:"",userName:"",items:[]}]),F=async ee=>{window.confirm("")&&(o[ee].isNew||await bu(St($e,...T,o[ee].id)),u(o.filter((ye,ae)=>ae!==ee)))},P=(ee,ye)=>{const ae=r.find(Y=>Y.id===ye),Me=[...o];Me[ee].userId=ye,Me[ee].userName=ae?ae.name:"",u(Me)},V=ee=>{const ye=[...o];ye[ee].items.push({itemId:"",name:"",quantity:1,price:0,spec:""}),u(ye)},Ee=(ee,ye,ae,Me)=>{const Y=[...o];if(ae==="itemId"){const j=a.items.find(X=>String(X.id)===String(Me));j&&(Y[ee].items[ye]={...Y[ee].items[ye],itemId:j.id,name:j.name,price:j.price,spec:j.spec||""})}else Y[ee].items[ye][ae]=Me;u(Y)},we=(ee,ye)=>{const ae=[...o];ae[ee].items=ae[ee].items.filter((Me,Y)=>Y!==ye),u(ae)},ie=ee=>ee.items?.reduce((ye,ae)=>ye+Number(ae.price)*Number(ae.quantity),0)||0;return f?p.jsx("div",{className:"p-10 text-center",children:"..."}):p.jsxs("div",{className:"flex h-screen bg-gray-100 overflow-hidden text-sm",children:[p.jsxs("div",{className:"w-1/4 bg-white border-r border-gray-200 flex flex-col shadow-inner",children:[p.jsx("div",{className:"p-4 border-b bg-slate-50 flex justify-between items-center",children:p.jsx("h2",{className:"font-black text-slate-700 tracking-tighter uppercase",children:""})}),p.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:Object.entries(I).map(([ee,ye])=>p.jsxs("div",{className:"rounded overflow-hidden",children:[p.jsxs("button",{onClick:()=>C(ee),className:"w-full flex items-center gap-2 p-2 hover:bg-slate-100 text-left font-bold text-slate-600 border-b border-slate-50",children:[y[ee]?p.jsx(MM,{size:16}):p.jsx(kk,{size:16}),p.jsx(iP,{size:16,className:"text-yellow-500 fill-yellow-500"}),p.jsx("span",{className:"truncate flex-1",children:ee}),p.jsx("span",{className:"text-[10px] bg-slate-200 px-1.5 rounded-full",children:ye.length})]}),y[ee]&&p.jsx("div",{className:"bg-slate-50/50",children:ye.map(ae=>p.jsxs("div",{onClick:()=>W(ae),className:`pl-8 pr-4 py-2.5 cursor-pointer border-l-2 transition-all hover:bg-blue-50/50 ${a?.id===ae.id?"bg-blue-50 border-l-blue-600 font-bold text-blue-700":"border-l-transparent text-slate-500"}`,children:[p.jsx("div",{className:"truncate",children:ae.title}),p.jsx("div",{className:"text-[10px] opacity-60 flex justify-between mt-1",children:p.jsx("span",{children:ae.trackingStatus})})]},ae.id))})]},ee))})]}),p.jsx("div",{className:"flex-1 flex flex-col h-full overflow-hidden",children:a?p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"p-4 bg-white border-b flex justify-between items-center shadow-sm z-10",children:[p.jsxs("div",{children:[p.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-blue-800",children:[p.jsx(yp,{size:20})," ",a.title]}),p.jsxs("p",{className:"text-xs text-slate-400",children:["",a.sheetCategory||""]})]}),p.jsxs("div",{className:"flex gap-2",children:[p.jsxs("button",{onClick:()=>B(a.id),className:"px-4 py-2 text-red-600 hover:bg-red-50 rounded flex items-center gap-2 font-bold",children:[p.jsx(eh,{size:18})," "]}),p.jsx("button",{onClick:U,disabled:m,className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center gap-2 shadow-lg font-bold",children:m?"...":""})]})]}),p.jsx("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-100",children:p.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[p.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[p.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-700 border-b pb-2",children:""}),p.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[p.jsxs("div",{className:"col-span-2",children:[p.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),p.jsx("input",{type:"text",value:a.title,onChange:ee=>i({...a,title:ee.target.value}),className:"w-full border p-2 rounded"})]}),p.jsxs("div",{className:"col-span-2",children:[p.jsx("label",{className:"block text-xs font-bold text-blue-600 mb-1",children:" ()"}),p.jsx("input",{list:"category-list",type:"text",value:a.sheetCategory||"",onChange:ee=>i({...a,sheetCategory:ee.target.value}),className:"w-full border p-2 rounded bg-blue-50 border-blue-200",placeholder:" 2025.11"}),p.jsx("datalist",{id:"category-list",children:Object.keys(I).map(ee=>p.jsx("option",{value:ee},ee))})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:[p.jsx(Ko,{size:14})," "]}),p.jsx("select",{value:a.type||"",onChange:ee=>i({...a,type:ee.target.value}),className:"w-full border p-2 rounded",children:uK.map(ee=>p.jsx("option",{value:ee,children:ee},ee))})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:[p.jsx(xP,{size:14})," "]}),p.jsx("select",{value:a.trackingStatus||"",onChange:ee=>i({...a,trackingStatus:ee.target.value}),className:"w-full border p-2 rounded",children:fK.map(ee=>p.jsx("option",{value:ee,children:ee},ee))})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),p.jsx("input",{type:"number",value:a.exchangeRate,onChange:ee=>i({...a,exchangeRate:Number(ee.target.value)}),className:"w-full border p-2 rounded"})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"block text-xs font-bold text-blue-600 mb-1",children:[p.jsx(th,{size:14}),"  ()"]}),p.jsx("input",{type:"number",value:a.domesticShippingFee||0,onChange:ee=>i({...a,domesticShippingFee:Number(ee.target.value)}),className:"w-full border p-2 rounded bg-blue-50"})]}),p.jsxs("div",{className:"col-span-2",children:[p.jsxs("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:[p.jsx(KM,{size:14})," "]}),p.jsx("select",{value:a.paymentStatus||"",onChange:ee=>i({...a,paymentStatus:ee.target.value}),className:"w-full border p-2 rounded",children:hK.map(ee=>p.jsx("option",{value:ee,children:ee},ee))})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:[p.jsx(iy,{size:14})," "]}),p.jsx("input",{type:"datetime-local",value:a.deadline||"",onChange:ee=>i({...a,deadline:ee.target.value}),className:"w-full border p-2 rounded"})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:[p.jsx(ay,{size:14})," "]}),p.jsx("input",{type:"text",value:a.releaseDate||"",onChange:ee=>i({...a,releaseDate:ee.target.value}),className:"w-full border p-2 rounded",placeholder:"2025.11"})]})]})]}),p.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[p.jsxs("h3",{className:"text-lg font-bold text-gray-700 flex items-center gap-2",children:[p.jsx(vp,{size:20})," "]}),p.jsx("button",{onClick:D,className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-bold hover:bg-green-200",children:"+ "})]}),p.jsx("div",{className:"space-y-2",children:a.items?.map((ee,ye)=>p.jsxs("div",{className:"flex gap-2 items-center bg-gray-50 p-2 rounded",children:[p.jsx("input",{type:"text",placeholder:"",value:ee.name,onChange:ae=>A(ye,"name",ae.target.value),className:"flex-1 p-1 border rounded text-sm"}),p.jsx("input",{type:"text",placeholder:"",value:ee.spec,onChange:ae=>A(ye,"spec",ae.target.value),className:"w-24 p-1 border rounded text-sm"}),p.jsx("input",{type:"number",placeholder:"",value:ee.price,onChange:ae=>A(ye,"price",ae.target.value),className:"w-24 p-1 border rounded text-sm font-bold text-blue-600"}),p.jsx("button",{onClick:()=>N(ye),className:"text-gray-400 hover:text-red-500",children:p.jsx(ha,{size:18})})]},ye))})]}),p.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-blue-200",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[p.jsxs("h3",{className:"text-lg font-bold text-blue-800 flex items-center gap-2",children:[p.jsx(fy,{size:20})," "]}),p.jsx("button",{onClick:M,className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-bold hover:bg-blue-200",children:"+ "})]}),p.jsx("div",{className:"space-y-4",children:o.map((ee,ye)=>{const ae=ie(ee),Me=Math.ceil(ae*(a.exchangeRate||0));return p.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[p.jsxs("div",{className:"flex justify-between items-center mb-3",children:[p.jsxs("select",{value:ee.userId,onChange:Y=>P(ye,Y.target.value),className:"p-1 border rounded font-bold text-blue-600",children:[p.jsx("option",{value:"",children:"--  --"}),r.map(Y=>p.jsx("option",{value:Y.id,children:Y.name},Y.id))]}),p.jsxs("div",{className:"text-right font-black text-red-600 italic",children:["NT$ ",Me]})]}),p.jsxs("div",{className:"pl-4 border-l-2 border-slate-300 space-y-2",children:[ee.items?.map((Y,j)=>p.jsxs("div",{className:"flex gap-2 items-center",children:[p.jsxs("select",{value:Y.itemId,onChange:X=>Ee(ye,j,"itemId",X.target.value),className:"flex-1 p-1 border rounded text-xs",children:[p.jsx("option",{value:"",children:"--  --"}),a.items?.map(X=>p.jsxs("option",{value:X.id,children:[X.name," (",X.price,")"]},X.id))]}),p.jsx("input",{type:"number",value:Y.quantity,onChange:X=>Ee(ye,j,"quantity",X.target.value),className:"w-12 p-1 border rounded text-center font-bold"}),p.jsx("button",{onClick:()=>we(ye,j),className:"text-gray-400 hover:text-red-500",children:p.jsx(ha,{size:16})})]},j)),p.jsx("button",{onClick:()=>V(ye),className:"text-[10px] text-blue-500 underline mt-1",children:"+ "})]}),p.jsx("div",{className:"text-right mt-2",children:p.jsx("button",{onClick:()=>F(ye),className:"text-[10px] text-red-300 hover:text-red-600 underline",children:""})})]},ee.id)})})]})]})})]}):p.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-300",children:[p.jsx(_p,{size:80,className:"mb-4 opacity-20"}),p.jsx("p",{className:"text-lg font-black italic tracking-widest uppercase",children:"Select a mission from the list"}),p.jsx("p",{className:"text-xs font-bold opacity-60",children:""})]})})]})},mK=({initialContent:t,onChange:e})=>{const r=re.useRef(null);re.useEffect(()=>{r.current&&r.current.innerHTML!==t&&(r.current.innerHTML=t)},[t]);const n=(o,u=null)=>{document.execCommand(o,!1,u),r.current&&e(r.current.innerHTML)},a=[{name:"Black",value:"#000000"},{name:"Red",value:"#EF4444"},{name:"Orange",value:"#F97316"},{name:"Blue",value:"#3B82F6"}],i=({onClick:o,title:u,children:f})=>p.jsx("button",{type:"button",onClick:o,title:u,className:"p-1.5 hover:bg-slate-200 rounded text-slate-600 transition-colors",children:f});return p.jsxs("div",{className:"border-2 border-slate-900 rounded-lg overflow-hidden flex flex-col h-64 bg-white shadow-sm",children:[p.jsxs("div",{className:"bg-slate-50 border-b-2 border-slate-900 p-2 flex flex-wrap gap-1 items-center",children:[p.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[p.jsx(i,{onClick:()=>n("bold"),title:"",children:p.jsx(NM,{size:14})}),p.jsx(i,{onClick:()=>n("italic"),title:"",children:p.jsx(fP,{size:14})}),p.jsx(i,{onClick:()=>n("underline"),title:"",children:p.jsx(ij,{size:14})})]}),p.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[p.jsx(i,{onClick:()=>n("justifyLeft"),title:"",children:p.jsx(ZP,{size:14})}),p.jsx(i,{onClick:()=>n("justifyCenter"),title:"",children:p.jsx(QP,{size:14})}),p.jsx(i,{onClick:()=>n("justifyRight"),title:"",children:p.jsx($P,{size:14})})]}),p.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[p.jsx(i,{onClick:()=>n("fontSize","5"),title:"",children:p.jsx(W1,{size:16})}),p.jsx(i,{onClick:()=>n("fontSize","3"),title:"",children:p.jsx(W1,{size:12})}),p.jsx(i,{onClick:()=>n("fontSize","1"),title:"",children:p.jsx(W1,{size:10})})]}),p.jsx("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:a.map(o=>p.jsx("button",{type:"button",onClick:()=>n("foreColor",o.value),className:"w-5 h-5 rounded border border-slate-300 hover:scale-110 transition-transform",style:{backgroundColor:o.value},title:o.name},o.value))}),p.jsx(i,{onClick:()=>{const o=prompt(":","http://");o&&n("createLink",o)},title:"",children:p.jsx(Im,{size:14})})]}),p.jsx("div",{className:"flex-1 p-4 focus:outline-none overflow-y-auto prose prose-slate prose-sm max-w-none",contentEditable:!0,suppressContentEditableWarning:!0,ref:r,onInput:o=>e(o.currentTarget.innerHTML)})]})},pK=["","","","","","","",""];function gK({currentUser:t}){const[e,r]=re.useState([]),[n,a]=re.useState({exchangeRate:.24,totalShippingJPY:0,status:""}),[i,o]=re.useState(!0),[u,f]=re.useState(!1);re.useEffect(()=>{const E=St($e,"artifacts","default-app-id","public","data","jf26_calc_data","main"),w=Un(E,T=>{if(T.exists()){const R=T.data(),C=(R.orders||[]).sort((W,U)=>W.buyer.localeCompare(U.buyer)||W.id-U.id);r(C),a(R.settings||{exchangeRate:.24,totalShippingJPY:0,status:""})}o(!1)});return()=>w()},[]);const d=(E,w,T)=>{r(R=>R.map(I=>I.id===E?{...I,[w]:T}:I)),f(!0)},m=(E,w,T)=>{confirm(`${E} ${w} ${T} `)&&(r(R=>R.map(I=>I.ip===E&&I.name===w?{...I,price:Number(T)}:I)),f(!0))},x=async()=>{try{await X0(St($e,"artifacts","default-app-id","public","data","jf26_calc_data","main"),{orders:e,settings:n,updatedAt:new Date().toISOString(),updatedBy:t?.name||""}),f(!1),alert("")}catch(E){alert(""+E.message)}},y=re.useMemo(()=>e.reduce((E,w)=>w.isBought?E+w.quantity:E,0),[e]),b=re.useMemo(()=>y>0?n.totalShippingJPY/y:0,[y,n.totalShippingJPY]);return i?p.jsx("div",{className:"p-10 text-center font-black text-slate-400 animate-pulse",children:"..."}):p.jsxs("div",{className:"space-y-6 p-4 bg-slate-50 min-h-screen",children:[p.jsxs("div",{className:"flex flex-col md:flex-row gap-4 justify-between items-end bg-white p-6 rounded-2xl border-4 border-slate-900 shadow-[6px_6px_0px_0px_#0f172a]",children:[p.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 w-full",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1",children:""}),p.jsx("select",{value:n.status,onChange:E=>{a({...n,status:E.target.value}),f(!0)},className:"w-full font-bold border-2 border-slate-200 rounded-lg px-2 py-1.5 focus:border-yellow-400 outline-none",children:pK.map(E=>p.jsx("option",{value:E,children:E},E))})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1",children:""}),p.jsxs("div",{className:"relative",children:[p.jsx(ly,{className:"absolute left-2 top-2 text-slate-400",size:14}),p.jsx("input",{type:"number",step:"0.001",value:n.exchangeRate,onChange:E=>{a({...n,exchangeRate:parseFloat(E.target.value)||0}),f(!0)},className:"w-full pl-7 font-mono font-bold border-2 border-slate-200 rounded-lg py-1"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1",children:" (JPY)"}),p.jsxs("div",{className:"relative",children:[p.jsx(th,{className:"absolute left-2 top-2 text-slate-400",size:14}),p.jsx("input",{type:"number",value:n.totalShippingJPY,onChange:E=>{a({...n,totalShippingJPY:parseFloat(E.target.value)||0}),f(!0)},className:"w-full pl-7 font-mono font-bold border-2 border-slate-200 rounded-lg py-1"})]})]}),p.jsxs("div",{className:"bg-slate-900 rounded-lg p-2 text-white flex flex-col justify-center items-center",children:[p.jsx("span",{className:"text-[10px] text-slate-400",children:""}),p.jsxs("span",{className:"text-sm font-black text-yellow-400",children:[" ",b.toFixed(1)]})]})]}),p.jsxs("button",{onClick:x,disabled:!u,className:`shrink-0 flex items-center gap-2 px-8 py-3 rounded-xl font-black text-lg transition-all ${u?"bg-red-500 text-white shadow-[4px_4px_0px_0px_#7f1d1d] hover:-translate-y-1":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:[p.jsx(ic,{size:20})," "]})]}),p.jsx("div",{className:"bg-white border-4 border-slate-900 rounded-2xl overflow-hidden shadow-[8px_8px_0px_0px_#0f172a]",children:p.jsxs("table",{className:"w-full text-left border-collapse",children:[p.jsx("thead",{children:p.jsxs("tr",{className:"bg-slate-800 text-white text-[10px] uppercase font-black",children:[p.jsx("th",{className:"p-4 w-24",children:""}),p.jsx("th",{className:"p-4",children:""}),p.jsx("th",{className:"p-4 text-center w-20",children:""}),p.jsx("th",{className:"p-4 text-right w-32",children:""}),p.jsx("th",{className:"p-4 text-center w-24",children:""}),p.jsx("th",{className:"p-4 text-center w-16",children:""})]})}),p.jsx("tbody",{className:"divide-y-2 divide-slate-100",children:e.map(E=>p.jsxs("tr",{className:`hover:bg-slate-50 transition-colors ${!E.isBought&&"bg-red-50/50"}`,children:[p.jsx("td",{className:"p-4",children:p.jsx("span",{className:"font-black text-slate-900 bg-yellow-400/30 px-2 py-1 rounded",children:E.buyer})}),p.jsx("td",{className:"p-4",children:p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{className:"text-[10px] text-slate-400 font-bold",children:E.ip}),p.jsx("span",{className:"font-bold text-slate-700",children:E.name})]})}),p.jsx("td",{className:"p-4 text-center font-mono font-black",children:E.quantity}),p.jsx("td",{className:"p-4",children:p.jsx("input",{type:"number",value:E.price,onChange:w=>d(E.id,"price",w.target.value),className:"w-full text-right font-mono font-bold bg-transparent border-b-2 border-dotted border-slate-300 focus:border-slate-900 outline-none"})}),p.jsx("td",{className:"p-4 text-center",children:p.jsxs("button",{onClick:()=>d(E.id,"isBought",!E.isBought),className:`flex items-center gap-1 mx-auto px-2 py-1 rounded font-black text-xs border-2 transition-all ${E.isBought?"bg-green-100 border-green-500 text-green-700":"bg-white border-slate-300 text-slate-400"}`,children:[E.isBought?p.jsx(J0,{size:14}):p.jsx(GM,{size:14}),E.isBought?"":""]})}),p.jsx("td",{className:"p-4 text-center",children:p.jsx("button",{onClick:()=>m(E.ip,E.name,E.price),className:"p-2 text-slate-400 hover:text-blue-500 transition-colors",title:"",children:p.jsx(FP,{size:16})})})]},E.id))})]})}),u&&p.jsxs("div",{className:"fixed bottom-10 right-10 flex items-center gap-3 bg-red-600 text-white px-6 py-4 rounded-2xl shadow-2xl border-4 border-white animate-bounce",children:[p.jsx(Lk,{size:24}),p.jsx("span",{className:"font-black text-lg",children:""})]})]})}const xK=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=800,u=800;let f=a.width,d=a.height;f>d?f>o&&(d*=o/f,f=o):d>u&&(f*=u/d,d=u),i.width=f,i.height=d,i.getContext("2d").drawImage(a,0,0,f,d),e(i.toDataURL("image/jpeg",.7))}}});function vK({onSubmit:t,onCancel:e,initialData:r=null,submitLabel:n=""}){const[a,i]=re.useState(r?.title||""),[o,u]=re.useState(r?.type||""),[f,d]=re.useState(()=>r?.images?.filter(M=>M.startsWith("http"))?.join(", ")||""),[m,x]=re.useState(()=>r?.images?.filter(M=>M.startsWith("data:"))||[]),[y,b]=re.useState(r?.infoUrl||""),[E,w]=re.useState(()=>r?.deadline?r.deadline.slice(0,16):""),[T,R]=re.useState(r?.releaseDate||""),[I,C]=re.useState(r?.items||[{id:1,name:"",spec:"",price:"",limit:"",image:""}]),W=()=>C([...I,{id:Date.now(),name:"",spec:"",price:"",limit:"",image:""}]),U=(M,F,P)=>C(I.map(V=>V.id===M?{...V,[F]:P}:V)),B=M=>I.length>1?C(I.filter(F=>F.id!==M)):C([{id:Date.now(),name:"",spec:"",price:"",limit:"",image:""}]),A=(M,F)=>{const P=[...I];F==="up"&&M>0&&([P[M-1],P[M]]=[P[M],P[M-1]]),F==="down"&&M<P.length-1&&([P[M+1],P[M]]=[P[M],P[M+1]]),C(P)},D=async M=>{if(M.target.files){const F=Array.from(M.target.files),P=await Promise.all(F.map(V=>xK(V)));x(V=>[...V,...P]),M.target.value=null}},N=()=>{if(!a||!E)return alert("");const M=I.filter(P=>P.name&&P.price);if(M.length===0)return alert("/");const F=f.split(",").map(P=>P.trim()).filter(P=>P);t({title:a,type:o,images:[...F,...m],infoUrl:y,deadline:E,releaseDate:T,items:M})};return p.jsxs("form",{onSubmit:M=>{M.preventDefault(),N()},className:"space-y-4",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(vp,{size:16}),"  ()"]}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:a,onChange:M=>i(M.target.value),placeholder:" 6  BD ",required:!0})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(Ko,{size:16})," "]}),p.jsxs("div",{className:"flex gap-2 text-xs sm:text-sm",children:[p.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg py-2 px-1 text-center font-black transition-all ${o===""?"bg-slate-900 text-yellow-400 border-slate-900 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[p.jsx("input",{type:"radio",className:"hidden",name:"groupType",value:"",checked:o==="",onChange:()=>u("")})," "]}),p.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg py-2 px-1 text-center font-black transition-all ${o===""?"bg-green-600 text-white border-green-800 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[p.jsx("input",{type:"radio",className:"hidden",name:"groupType",value:"",checked:o==="",onChange:()=>u("")})," "]})]})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(Z0,{size:16}),"  ()"]}),p.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 text-sm h-16 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:f,onChange:M=>d(M.target.value),placeholder:" ()"})]}),p.jsxs("div",{className:"flex flex-col gap-2 p-3 border-2 border-dashed border-slate-300 rounded-lg bg-slate-100",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 flex items-center gap-2",children:[p.jsx(uy,{size:16})," "]}),p.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:D,className:"block w-full text-sm text-slate-700 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-2 file:border-red-800 file:text-xs file:font-black file:bg-red-600 file:text-white hover:file:bg-red-700 cursor-pointer"}),m.length>0&&p.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 pb-4",children:m.map((M,F)=>p.jsxs("div",{className:"relative shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 border-slate-900 shadow",children:[p.jsx("img",{src:M,className:"w-full h-full object-cover",alt:"preview"}),p.jsx("button",{type:"button",onClick:()=>x(P=>P.filter((V,Ee)=>Ee!==F)),className:"absolute top-0 right-0 bg-red-600 text-white rounded-full p-1 transform translate-x-1/3 -translate-y-1/3 border-2 border-white hover:bg-red-700 transition-all",children:p.jsx(ha,{size:12})})]},F))})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(Im,{size:16})," / ()"]}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:y,onChange:M=>b(M.target.value),placeholder:"https://shueisha.co.jp/..."})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(ay,{size:16})," / ()"]}),p.jsx("input",{type:"datetime-local",className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:E,onChange:M=>w(M.target.value),required:!0})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsx("label",{className:"text-sm font-black italic text-slate-900 mb-1",children:" ()"}),p.jsx("input",{type:"date",className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:T,onChange:M=>R(M.target.value)})]})]}),p.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border-2 border-slate-300",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4 flex-wrap gap-2",children:[p.jsx("h4",{className:"font-black italic text-lg text-slate-900 transform -skew-x-3",children:o===""?" (ITEMS)":" (ITEMS)"}),p.jsx("button",{type:"button",onClick:W,className:"text-sm font-black px-3 py-1 bg-yellow-400 text-slate-900 rounded border-2 border-slate-900 hover:bg-yellow-500 transition-all",children:"+ "})]}),p.jsx("div",{className:"space-y-4",children:I.map((M,F)=>p.jsxs("div",{className:"bg-white p-3 rounded-lg border-2 border-slate-900 relative flex gap-3 items-start shadow-[2px_2px_0px_0px_rgba(15,23,42,1)]",children:[p.jsxs("div",{className:"flex flex-col gap-1 justify-center pt-1",children:[p.jsxs("span",{className:"text-xl font-black text-red-600 italic leading-none",children:[F+1,"."]}),p.jsx("button",{type:"button",onClick:()=>A(F,"up"),disabled:F===0,className:"text-slate-400 hover:text-blue-600 disabled:opacity-30 p-0.5",children:p.jsx(kM,{size:16})}),p.jsx("button",{type:"button",onClick:()=>A(F,"down"),disabled:F===I.length-1,className:"text-slate-400 hover:text-blue-600 disabled:opacity-30 p-0.5",children:p.jsx(Sk,{size:16})})]}),p.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-2",children:[p.jsx("div",{className:"col-span-12 sm:col-span-7",children:p.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm bg-slate-50 focus:bg-white focus:ring-2 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:"",value:M.name,onChange:P=>U(M.id,"name",P.target.value),required:!0})}),p.jsxs("div",{className:"col-span-12 sm:col-span-5 relative",children:[p.jsx("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-slate-400",children:p.jsx(Im,{size:14})}),p.jsx("input",{className:"w-full border-2 border-slate-300 p-2 pl-7 rounded text-sm text-slate-700 focus:ring-2 focus:ring-yellow-400",placeholder:"",value:M.image||"",onChange:P=>U(M.id,"image",P.target.value)}),M.image&&p.jsx("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 w-6 h-6 rounded border-2 border-slate-900 bg-slate-100 overflow-hidden shadow",children:p.jsx("img",{src:M.image,className:"w-full h-full object-cover",onError:P=>P.target.style.display="none"})})]}),p.jsx("div",{className:"col-span-6 sm:col-span-5",children:p.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400",placeholder:"",value:M.spec,onChange:P=>U(M.id,"spec",P.target.value)})}),p.jsx("div",{className:"col-span-3 sm:col-span-4",children:p.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400 font-black text-red-600",type:"number",placeholder:"",value:M.price,onChange:P=>U(M.id,"price",P.target.value),required:!0})}),p.jsx("div",{className:"col-span-3 sm:col-span-3",children:p.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400",type:"number",placeholder:"",value:M.limit,onChange:P=>U(M.id,"limit",P.target.value)})})]}),p.jsx("button",{type:"button",onClick:()=>B(M.id),className:"text-red-600 hover:text-red-800 p-1 mt-1 shrink-0",children:p.jsx(ha,{size:18})})]},M.id))})]}),p.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[p.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[p.jsx(ha,{size:16,className:"inline mr-1"})," "]}),p.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-slate-900 text-yellow-400 border-2 border-slate-900 hover:bg-slate-700 font-black italic shadow-[4px_4px_0px_0px_#FACC15] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(ic,{size:16,className:"inline mr-1"})," ",n]})]})]})}function yK({currentUser:t}){const[e,r]=re.useState("groups"),n=F0(),[a,i]=re.useState(""),[o,u]=re.useState(""),[f,d]=re.useState([]),[m,x]=re.useState([]),[y,b]=re.useState(!1),[E,w]=re.useState({title:"",amount:"",targetUserId:"",note:"",paymentStatus:""});if(!(t?.name===""||t?.id==="yeye"))return p.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-100",children:p.jsxs("div",{className:"bg-white p-10 rounded-2xl border-4 border-slate-900 shadow-[8px_8px_0px_0px_#ef4444] text-center",children:[p.jsx("h2",{className:"text-3xl font-black text-red-500 mb-4 italic",children:"ACCESS DENIED"}),p.jsx("p",{className:"font-bold text-slate-600",children:""}),p.jsx("button",{onClick:()=>n("/"),className:"mt-6 px-6 py-2 bg-slate-900 text-white font-bold rounded",children:""})]})});re.useEffect(()=>{const B=Un(St($e,"artifacts","default-app-id","public","data","system","bulletin"),N=>{N.exists()&&(i(N.data().content),u(N.data().content))}),A=Un(ar($e,"artifacts","default-app-id","public","data","miscCharges"),N=>d(N.docs.map(M=>({id:M.id,...M.data()})))),D=Un(ar($e,"artifacts","default-app-id","public","data","users"),N=>x(N.docs.map(M=>({id:M.id,...M.data()}))));return()=>{B(),A(),D()}},[]);const R=async B=>{try{await Us(ar($e,"artifacts","default-app-id","public","data","groups"),{...B,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"",createdBy:"",exchangeRate:B.exchangeRate||.21,shippingFee:0,secondPayment:{},paymentStatus:""}),b(!1),alert("")}catch{alert("")}},I=async()=>{try{await X0(St($e,"artifacts","default-app-id","public","data","system","bulletin"),{content:o},{merge:!0}),i(o),alert("")}catch{alert("")}},C=async()=>{if(!E.title||!E.amount||!E.targetUserId){alert("");return}try{const B=m.find(A=>A.id===E.targetUserId);await Us(ar($e,"artifacts","default-app-id","public","data","miscCharges"),{...E,amount:Number(E.amount),targetUserName:B?B.name:"Unknown",createdAt:new Date().toISOString()}),w({title:"",amount:"",targetUserId:"",note:"",paymentStatus:""}),alert("")}catch(B){console.error(B)}},W=async(B,A)=>{try{await nn(St($e,"artifacts","default-app-id","public","data","miscCharges",B),{paymentStatus:A})}catch(D){console.error(D)}},U=async B=>{if(confirm(""))try{await bu(St($e,"artifacts","default-app-id","public","data","miscCharges",B))}catch(A){console.error(A)}};return p.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col font-sans text-slate-800",children:[p.jsx("header",{className:"bg-slate-900 text-white shadow-md z-50 sticky top-0",children:p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center py-4 gap-4",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("button",{onClick:()=>n("/"),className:"text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[p.jsx(Ak,{size:20}),p.jsx("span",{className:"hidden sm:inline",children:""})]}),p.jsx("h1",{className:"text-xl font-black italic tracking-wider border-l border-gray-700 pl-4 text-yellow-400",children:"HERO ADMIN"})]}),p.jsx("nav",{className:"flex flex-wrap justify-center gap-2 bg-slate-800 p-1 rounded-lg",children:[{id:"import",label:"Excel",icon:Rk},{id:"groups",label:"",icon:pP},{id:"misc",label:"",icon:zx},{id:"js_orders",label:"JF26",icon:Pk},{id:"bulletin",label:"",icon:Dm},{id:"users",label:"",icon:vT}].map(B=>p.jsxs("button",{onClick:()=>r(B.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-black transition-all ${e===B.id?"bg-yellow-400 text-slate-900 shadow-lg":"text-gray-400 hover:text-white hover:bg-slate-700"}`,children:[p.jsx(B.icon,{size:14}),B.label]},B.id))})]})})}),p.jsx("main",{className:"flex-1 overflow-auto p-4 sm:p-8",children:p.jsxs("div",{className:"max-w-7xl mx-auto",children:[e==="import"&&p.jsx(cK,{}),e==="groups"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h2",{className:"text-2xl font-black italic text-slate-800",children:""}),p.jsxs("button",{onClick:()=>b(!0),className:"px-6 py-2 bg-slate-900 text-white rounded font-black hover:bg-slate-700 flex items-center gap-2 shadow-[4px_4px_0px_0px_#FACC15] transition-all italic",children:[p.jsx($o,{size:18})," "]})]}),p.jsx(dK,{})]}),e==="js_orders"&&p.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:[p.jsxs("div",{className:"mb-6",children:[p.jsx("h2",{className:"text-2xl font-black text-slate-800 italic",children:"JF26 JS ONLINE "}),p.jsx("p",{className:"text-slate-500 font-bold text-sm",children:""})]}),p.jsx(gK,{currentUser:t})]}),e==="users"&&p.jsxs("div",{className:"bg-white p-10 rounded-2xl border-4 border-slate-900 text-center font-bold text-slate-400",children:[p.jsx(vT,{size:48,className:"mx-auto mb-4 opacity-20"}),"..."]}),e==="bulletin"&&p.jsxs("div",{className:"bg-white p-6 rounded-lg shadow border-4 border-slate-900",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4 pb-2 border-b-2",children:[p.jsxs("h2",{className:"text-xl font-black flex items-center gap-2 italic",children:[p.jsx(Dm,{className:"text-yellow-500"})," "]}),p.jsxs("button",{onClick:I,className:"px-4 py-2 rounded bg-slate-900 text-yellow-400 font-black hover:bg-slate-800 flex items-center gap-2 shadow-[3px_3px_0px_0px_#ccc]",children:[p.jsx(ic,{size:18})," "]})]}),p.jsx(mK,{initialContent:o,onChange:u})]}),e==="misc"&&p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-white p-6 rounded-lg shadow border-4 border-slate-900",children:[p.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2 text-slate-700 italic",children:[p.jsx($o,{className:"text-green-600"})," "]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:""}),p.jsxs("select",{className:"w-full border-2 border-slate-200 p-2 rounded font-bold",value:E.targetUserId,onChange:B=>w({...E,targetUserId:B.target.value}),children:[p.jsx("option",{value:"",children:"--  --"}),m.map(B=>p.jsx("option",{value:B.id,children:B.name},B.id))]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:""}),p.jsx("input",{type:"text",className:"w-full border-2 border-slate-200 p-2 rounded font-bold",placeholder:"/",value:E.title,onChange:B=>w({...E,title:B.target.value})})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:" (TWD)"}),p.jsx("input",{type:"number",className:"w-full border-2 border-slate-200 p-2 rounded font-bold",placeholder:"0",value:E.amount,onChange:B=>w({...E,amount:B.target.value})})]}),p.jsx("button",{onClick:C,className:"bg-slate-900 text-yellow-400 p-2.5 rounded font-black hover:bg-slate-800 transition-colors",children:""})]})]}),p.jsx("div",{className:"bg-white rounded-lg shadow border-4 border-slate-900 overflow-hidden",children:p.jsxs("table",{className:"w-full text-sm text-left font-bold",children:[p.jsx("thead",{className:"bg-slate-900 text-white border-b",children:p.jsxs("tr",{children:[p.jsx("th",{className:"px-4 py-3 italic",children:"DATE"}),p.jsx("th",{className:"px-4 py-3",children:"HERO"}),p.jsx("th",{className:"px-4 py-3",children:"TITLE"}),p.jsx("th",{className:"px-4 py-3 text-right",children:"AMOUNT"}),p.jsx("th",{className:"px-4 py-3 text-center",children:"STATUS"}),p.jsx("th",{className:"px-4 py-3 text-center",children:"ACTION"})]})}),p.jsx("tbody",{children:f.sort((B,A)=>new Date(A.createdAt)-new Date(B.createdAt)).map(B=>p.jsxs("tr",{className:"border-b hover:bg-slate-50",children:[p.jsx("td",{className:"px-4 py-3 text-slate-400 font-mono text-xs",children:new Date(B.createdAt).toLocaleDateString()}),p.jsx("td",{className:"px-4 py-3 text-blue-700",children:B.targetUserName}),p.jsx("td",{className:"px-4 py-3",children:B.title}),p.jsxs("td",{className:"px-4 py-3 text-right font-mono",children:["$",B.amount]}),p.jsx("td",{className:"px-4 py-3 text-center",children:p.jsxs("select",{className:`text-[10px] font-black border-2 rounded px-1.5 py-0.5 ${B.paymentStatus===""?"bg-green-100 text-green-700 border-green-300":"bg-red-100 text-red-700 border-red-300"}`,value:B.paymentStatus||"",onChange:A=>W(B.id,A.target.value),children:[p.jsx("option",{value:"",children:""}),p.jsx("option",{value:"",children:""})]})}),p.jsx("td",{className:"px-4 py-3 text-center",children:p.jsx("button",{onClick:()=>U(B.id),className:"text-slate-300 hover:text-red-600 transition-colors",children:p.jsx(eh,{size:16})})})]},B.id))})]})})]})]})}),p.jsx(ua,{isOpen:y,onClose:()=>b(!1),title:"",children:p.jsx(vK,{onSubmit:R,onCancel:()=>b(!1),submitLabel:""})})]})}function _K(){const[t,e]=re.useState(null),[r,n]=re.useState(null),[a,i]=re.useState(!0),[o,u]=re.useState([]),f=re.useCallback(()=>{n(null),localStorage.removeItem("app_user_id"),i(!1)},[]);re.useEffect(()=>((async()=>{try{X1.currentUser||await K9(X1)}catch(x){console.error("Firebase ",x)}})(),rF(X1,x=>{e(x)})),[]),re.useEffect(()=>{if(!t)return;const m=Un(ar($e,"artifacts","default-app-id","public","data","users"),b=>{const E=b.docs.map(w=>({id:w.id,...w.data()}));u(E)}),x=localStorage.getItem("app_user_id");let y=()=>{};return x?y=Un(St($e,"artifacts","default-app-id","public","data","users",x),b=>{b.exists()?(n({id:b.id,...b.data()}),i(!1)):f()},()=>f()):i(!1),()=>{m(),y()}},[t,f]);const d=(m,x)=>{const y=typeof m=="object"&&m!==null?m.id:m,b=o.find(E=>E.id===y);b&&String(b.password).trim()===String(x).trim()?(localStorage.setItem("app_user_id",b.id),n(b),i(!1)):alert("")};return a?p.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-900 text-yellow-400",children:[p.jsx("div",{className:"flex items-center gap-2 mb-4 animate-bounce",children:p.jsx(zP,{size:80,className:"text-yellow-400 drop-shadow-[0_0_15px_rgba(250,204,21,0.5)]"})}),p.jsx("p",{className:"text-3xl font-black italic tracking-widest animate-pulse",children:"PLUS ULTRA..."})]}):p.jsx(m5,{children:p.jsxs("div",{className:"relative min-h-screen",children:[r&&p.jsx($L,{}),p.jsxs(qR,{children:[p.jsx(Uf,{path:"/",element:r?p.jsx(Rd,{to:"/home",replace:!0}):p.jsx(bj,{users:o,onLogin:d})}),p.jsx(Uf,{path:"/home",element:r?p.jsx(oK,{appUser:r,usersData:o,handleLogout:f}):p.jsx(Rd,{to:"/",replace:!0})}),p.jsx(Uf,{path:"/jf26",element:r?p.jsx(HL,{currentUser:r}):p.jsx(Rd,{to:"/",replace:!0})}),p.jsx(Uf,{path:"/admin/dashboard",element:r?.name===""?p.jsx(yK,{currentUser:r}):p.jsx(Rd,{to:"/home",replace:!0})})]})]})})}Z6.createRoot(document.getElementById("root")).render(p.jsx(Bl.StrictMode,{children:p.jsx(_K,{})}));
