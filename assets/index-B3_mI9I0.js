(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function YS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var I1={exports:{}},Pf={};var Fw;function $6(){if(Fw)return Pf;Fw=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,i){var o=null;if(i!==void 0&&(o=""+i),a.key!==void 0&&(o=""+a.key),"key"in a){i={};for(var u in a)u!=="key"&&(i[u]=a[u])}else i=a;return a=i.ref,{$$typeof:t,type:n,key:o,ref:a!==void 0?a:null,props:i}}return Pf.Fragment=e,Pf.jsx=r,Pf.jsxs=r,Pf}var jw;function K6(){return jw||(jw=1,I1.exports=$6()),I1.exports}var m=K6(),D1={exports:{}},xt={};var Pw;function Q6(){if(Pw)return xt;Pw=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),y=Symbol.iterator;function b(U){return U===null||typeof U!="object"?null:(U=y&&U[y]||U["@@iterator"],typeof U=="function"?U:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,E={};function k(U,P,G){this.props=U,this.context=P,this.refs=E,this.updater=G||w}k.prototype.isReactComponent={},k.prototype.setState=function(U,P){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,P,"setState")},k.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function I(){}I.prototype=k.prototype;function N(U,P,G){this.props=U,this.context=P,this.refs=E,this.updater=G||w}var z=N.prototype=new I;z.constructor=N,T(z,k.prototype),z.isPureReactComponent=!0;var H=Array.isArray;function q(){}var A={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function R(U,P,G){var Y=G.ref;return{$$typeof:t,type:U,key:P,ref:Y!==void 0?Y:null,props:G}}function M(U,P){return R(U.type,P,U.props)}function O(U){return typeof U=="object"&&U!==null&&U.$$typeof===t}function j(U){var P={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(G){return P[G]})}var L=/\/+/g;function Ne(U,P){return typeof U=="object"&&U!==null&&U.key!=null?j(""+U.key):P.toString(36)}function _e(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(q,q):(U.status="pending",U.then(function(P){U.status==="pending"&&(U.status="fulfilled",U.value=P)},function(P){U.status==="pending"&&(U.status="rejected",U.reason=P)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function ne(U,P,G,Y,Z){var oe=typeof U;(oe==="undefined"||oe==="boolean")&&(U=null);var ye=!1;if(U===null)ye=!0;else switch(oe){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(U.$$typeof){case t:case e:ye=!0;break;case p:return ye=U._init,ne(ye(U._payload),P,G,Y,Z)}}if(ye)return Z=Z(U),ye=Y===""?"."+Ne(U,0):Y,H(Z)?(G="",ye!=null&&(G=ye.replace(L,"$&/")+"/"),ne(Z,P,G,"",function(De){return De})):Z!=null&&(O(Z)&&(Z=M(Z,G+(Z.key==null||U&&U.key===Z.key?"":(""+Z.key).replace(L,"$&/")+"/")+ye)),P.push(Z)),1;ye=0;var Fe=Y===""?".":Y+":";if(H(U))for(var Te=0;Te<U.length;Te++)Y=U[Te],oe=Fe+Ne(Y,Te),ye+=ne(Y,P,G,oe,Z);else if(Te=b(U),typeof Te=="function")for(U=Te.call(U),Te=0;!(Y=U.next()).done;)Y=Y.value,oe=Fe+Ne(Y,Te++),ye+=ne(Y,P,G,oe,Z);else if(oe==="object"){if(typeof U.then=="function")return ne(_e(U),P,G,Y,Z);throw P=String(U),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.")}return ye}function se(U,P,G){if(U==null)return U;var Y=[],Z=0;return ne(U,Y,"","",function(oe){return P.call(G,oe,Z++)}),Y}function Ee(U){if(U._status===-1){var P=U._result;P=P(),P.then(function(G){(U._status===0||U._status===-1)&&(U._status=1,U._result=G)},function(G){(U._status===0||U._status===-1)&&(U._status=2,U._result=G)}),U._status===-1&&(U._status=0,U._result=P)}if(U._status===1)return U._result.default;throw U._result}var ie=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var P=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(P))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},Ve={map:se,forEach:function(U,P,G){se(U,function(){P.apply(this,arguments)},G)},count:function(U){var P=0;return se(U,function(){P++}),P},toArray:function(U){return se(U,function(P){return P})||[]},only:function(U){if(!O(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return xt.Activity=x,xt.Children=Ve,xt.Component=k,xt.Fragment=r,xt.Profiler=a,xt.PureComponent=N,xt.StrictMode=n,xt.Suspense=f,xt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,xt.__COMPILER_RUNTIME={__proto__:null,c:function(U){return A.H.useMemoCache(U)}},xt.cache=function(U){return function(){return U.apply(null,arguments)}},xt.cacheSignal=function(){return null},xt.cloneElement=function(U,P,G){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var Y=T({},U.props),Z=U.key;if(P!=null)for(oe in P.key!==void 0&&(Z=""+P.key),P)!F.call(P,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&P.ref===void 0||(Y[oe]=P[oe]);var oe=arguments.length-2;if(oe===1)Y.children=G;else if(1<oe){for(var ye=Array(oe),Fe=0;Fe<oe;Fe++)ye[Fe]=arguments[Fe+2];Y.children=ye}return R(U.type,Z,Y)},xt.createContext=function(U){return U={$$typeof:o,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:i,_context:U},U},xt.createElement=function(U,P,G){var Y,Z={},oe=null;if(P!=null)for(Y in P.key!==void 0&&(oe=""+P.key),P)F.call(P,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(Z[Y]=P[Y]);var ye=arguments.length-2;if(ye===1)Z.children=G;else if(1<ye){for(var Fe=Array(ye),Te=0;Te<ye;Te++)Fe[Te]=arguments[Te+2];Z.children=Fe}if(U&&U.defaultProps)for(Y in ye=U.defaultProps,ye)Z[Y]===void 0&&(Z[Y]=ye[Y]);return R(U,oe,Z)},xt.createRef=function(){return{current:null}},xt.forwardRef=function(U){return{$$typeof:u,render:U}},xt.isValidElement=O,xt.lazy=function(U){return{$$typeof:p,_payload:{_status:-1,_result:U},_init:Ee}},xt.memo=function(U,P){return{$$typeof:h,type:U,compare:P===void 0?null:P}},xt.startTransition=function(U){var P=A.T,G={};A.T=G;try{var Y=U(),Z=A.S;Z!==null&&Z(G,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(q,ie)}catch(oe){ie(oe)}finally{P!==null&&G.types!==null&&(P.types=G.types),A.T=P}},xt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},xt.use=function(U){return A.H.use(U)},xt.useActionState=function(U,P,G){return A.H.useActionState(U,P,G)},xt.useCallback=function(U,P){return A.H.useCallback(U,P)},xt.useContext=function(U){return A.H.useContext(U)},xt.useDebugValue=function(){},xt.useDeferredValue=function(U,P){return A.H.useDeferredValue(U,P)},xt.useEffect=function(U,P){return A.H.useEffect(U,P)},xt.useEffectEvent=function(U){return A.H.useEffectEvent(U)},xt.useId=function(){return A.H.useId()},xt.useImperativeHandle=function(U,P,G){return A.H.useImperativeHandle(U,P,G)},xt.useInsertionEffect=function(U,P){return A.H.useInsertionEffect(U,P)},xt.useLayoutEffect=function(U,P){return A.H.useLayoutEffect(U,P)},xt.useMemo=function(U,P){return A.H.useMemo(U,P)},xt.useOptimistic=function(U,P){return A.H.useOptimistic(U,P)},xt.useReducer=function(U,P,G){return A.H.useReducer(U,P,G)},xt.useRef=function(U){return A.H.useRef(U)},xt.useState=function(U){return A.H.useState(U)},xt.useSyncExternalStore=function(U,P,G){return A.H.useSyncExternalStore(U,P,G)},xt.useTransition=function(){return A.H.useTransition()},xt.version="19.2.1",xt}var Mw;function fv(){return Mw||(Mw=1,D1.exports=Q6()),D1.exports}var ee=fv();const $s=YS(ee);var O1={exports:{}},Mf={},F1={exports:{}},j1={};var Lw;function J6(){return Lw||(Lw=1,(function(t){function e(ne,se){var Ee=ne.length;ne.push(se);e:for(;0<Ee;){var ie=Ee-1>>>1,Ve=ne[ie];if(0<a(Ve,se))ne[ie]=se,ne[Ee]=Ve,Ee=ie;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var se=ne[0],Ee=ne.pop();if(Ee!==se){ne[0]=Ee;e:for(var ie=0,Ve=ne.length,U=Ve>>>1;ie<U;){var P=2*(ie+1)-1,G=ne[P],Y=P+1,Z=ne[Y];if(0>a(G,Ee))Y<Ve&&0>a(Z,G)?(ne[ie]=Z,ne[Y]=Ee,ie=Y):(ne[ie]=G,ne[P]=Ee,ie=P);else if(Y<Ve&&0>a(Z,Ee))ne[ie]=Z,ne[Y]=Ee,ie=Y;else break e}}return se}function a(ne,se){var Ee=ne.sortIndex-se.sortIndex;return Ee!==0?Ee:ne.id-se.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var f=[],h=[],p=1,x=null,y=3,b=!1,w=!1,T=!1,E=!1,k=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function z(ne){for(var se=r(h);se!==null;){if(se.callback===null)n(h);else if(se.startTime<=ne)n(h),se.sortIndex=se.expirationTime,e(f,se);else break;se=r(h)}}function H(ne){if(T=!1,z(ne),!w)if(r(f)!==null)w=!0,q||(q=!0,j());else{var se=r(h);se!==null&&_e(H,se.startTime-ne)}}var q=!1,A=-1,F=5,R=-1;function M(){return E?!0:!(t.unstable_now()-R<F)}function O(){if(E=!1,q){var ne=t.unstable_now();R=ne;var se=!0;try{e:{w=!1,T&&(T=!1,I(A),A=-1),b=!0;var Ee=y;try{t:{for(z(ne),x=r(f);x!==null&&!(x.expirationTime>ne&&M());){var ie=x.callback;if(typeof ie=="function"){x.callback=null,y=x.priorityLevel;var Ve=ie(x.expirationTime<=ne);if(ne=t.unstable_now(),typeof Ve=="function"){x.callback=Ve,z(ne),se=!0;break t}x===r(f)&&n(f),z(ne)}else n(f);x=r(f)}if(x!==null)se=!0;else{var U=r(h);U!==null&&_e(H,U.startTime-ne),se=!1}}break e}finally{x=null,y=Ee,b=!1}se=void 0}}finally{se?j():q=!1}}}var j;if(typeof N=="function")j=function(){N(O)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,Ne=L.port2;L.port1.onmessage=O,j=function(){Ne.postMessage(null)}}else j=function(){k(O,0)};function _e(ne,se){A=k(function(){ne(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ne){ne.callback=null},t.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<ne?Math.floor(1e3/ne):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(ne){switch(y){case 1:case 2:case 3:var se=3;break;default:se=y}var Ee=y;y=se;try{return ne()}finally{y=Ee}},t.unstable_requestPaint=function(){E=!0},t.unstable_runWithPriority=function(ne,se){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var Ee=y;y=ne;try{return se()}finally{y=Ee}},t.unstable_scheduleCallback=function(ne,se,Ee){var ie=t.unstable_now();switch(typeof Ee=="object"&&Ee!==null?(Ee=Ee.delay,Ee=typeof Ee=="number"&&0<Ee?ie+Ee:ie):Ee=ie,ne){case 1:var Ve=-1;break;case 2:Ve=250;break;case 5:Ve=1073741823;break;case 4:Ve=1e4;break;default:Ve=5e3}return Ve=Ee+Ve,ne={id:p++,callback:se,priorityLevel:ne,startTime:Ee,expirationTime:Ve,sortIndex:-1},Ee>ie?(ne.sortIndex=Ee,e(h,ne),r(f)===null&&ne===r(h)&&(T?(I(A),A=-1):T=!0,_e(H,Ee-ie))):(ne.sortIndex=Ve,e(f,ne),w||b||(w=!0,q||(q=!0,j()))),ne},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(ne){var se=y;return function(){var Ee=y;y=se;try{return ne.apply(this,arguments)}finally{y=Ee}}}})(j1)),j1}var Bw;function Z6(){return Bw||(Bw=1,F1.exports=J6()),F1.exports}var P1={exports:{}},Rn={};var Vw;function eR(){if(Vw)return Rn;Vw=1;var t=fv();function e(f){var h="https://react.dev/errors/"+f;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(f,h,p){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:f,containerInfo:h,implementation:p}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,h){if(f==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Rn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Rn.createPortal=function(f,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return i(f,h,null,p)},Rn.flushSync=function(f){var h=o.T,p=n.p;try{if(o.T=null,n.p=2,f)return f()}finally{o.T=h,n.p=p,n.d.f()}},Rn.preconnect=function(f,h){typeof f=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(f,h))},Rn.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},Rn.preinit=function(f,h){if(typeof f=="string"&&h&&typeof h.as=="string"){var p=h.as,x=u(p,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,b=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?n.d.S(f,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:b}):p==="script"&&n.d.X(f,{crossOrigin:x,integrity:y,fetchPriority:b,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Rn.preinitModule=function(f,h){if(typeof f=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=u(h.as,h.crossOrigin);n.d.M(f,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(f)},Rn.preload=function(f,h){if(typeof f=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,x=u(p,h.crossOrigin);n.d.L(f,p,{crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Rn.preloadModule=function(f,h){if(typeof f=="string")if(h){var p=u(h.as,h.crossOrigin);n.d.m(f,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(f)},Rn.requestFormReset=function(f){n.d.r(f)},Rn.unstable_batchedUpdates=function(f,h){return f(h)},Rn.useFormState=function(f,h,p){return o.H.useFormState(f,h,p)},Rn.useFormStatus=function(){return o.H.useHostTransitionStatus()},Rn.version="19.2.1",Rn}var Uw;function tR(){if(Uw)return P1.exports;Uw=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),P1.exports=eR(),P1.exports}var zw;function rR(){if(zw)return Mf;zw=1;var t=Z6(),e=fv(),r=tR();function n(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)l+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var l=s,c=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(c=l.return),s=l.return;while(s)}return l.tag===3?c:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function f(s){if(i(s)!==s)throw Error(n(188))}function h(s){var l=s.alternate;if(!l){if(l=i(s),l===null)throw Error(n(188));return l!==s?null:s}for(var c=s,d=l;;){var v=c.return;if(v===null)break;var _=v.alternate;if(_===null){if(d=v.return,d!==null){c=d;continue}break}if(v.child===_.child){for(_=v.child;_;){if(_===c)return f(v),s;if(_===d)return f(v),l;_=_.sibling}throw Error(n(188))}if(c.return!==d.return)c=v,d=_;else{for(var C=!1,V=v.child;V;){if(V===c){C=!0,c=v,d=_;break}if(V===d){C=!0,d=v,c=_;break}V=V.sibling}if(!C){for(V=_.child;V;){if(V===c){C=!0,c=_,d=v;break}if(V===d){C=!0,d=_,c=v;break}V=V.sibling}if(!C)throw Error(n(189))}}if(c.alternate!==d)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:l}function p(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=p(s),l!==null)return l;s=s.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),N=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),q=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function j(s){return s===null||typeof s!="object"?null:(s=O&&s[O]||s["@@iterator"],typeof s=="function"?s:null)}var L=Symbol.for("react.client.reference");function Ne(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===L?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case T:return"Fragment";case k:return"Profiler";case E:return"StrictMode";case H:return"Suspense";case q:return"SuspenseList";case R:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case w:return"Portal";case N:return s.displayName||"Context";case I:return(s._context.displayName||"Context")+".Consumer";case z:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:Ne(s.type)||"Memo";case F:l=s._payload,s=s._init;try{return Ne(s(l))}catch{}}return null}var _e=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ee={pending:!1,data:null,method:null,action:null},ie=[],Ve=-1;function U(s){return{current:s}}function P(s){0>Ve||(s.current=ie[Ve],ie[Ve]=null,Ve--)}function G(s,l){Ve++,ie[Ve]=s.current,s.current=l}var Y=U(null),Z=U(null),oe=U(null),ye=U(null);function Fe(s,l){switch(G(oe,l),G(Z,s),G(Y,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?nw(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=nw(l),s=aw(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}P(Y),G(Y,s)}function Te(){P(Y),P(Z),P(oe)}function De(s){s.memoizedState!==null&&G(ye,s);var l=Y.current,c=aw(l,s.type);l!==c&&(G(Z,s),G(Y,c))}function rt(s){Z.current===s&&(P(Y),P(Z)),ye.current===s&&(P(ye),Df._currentValue=Ee)}var re,ft;function ce(s){if(re===void 0)try{throw Error()}catch(c){var l=c.stack.trim().match(/\n( *(at )?)/);re=l&&l[1]||"",ft=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+re+s+ft}var ze=!1;function Ce(s,l){if(!s||ze)return"";ze=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(l){var Oe=function(){throw Error()};if(Object.defineProperty(Oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Oe,[])}catch(we){var ve=we}Reflect.construct(s,[],Oe)}else{try{Oe.call()}catch(we){ve=we}s.call(Oe.prototype)}}else{try{throw Error()}catch(we){ve=we}(Oe=s())&&typeof Oe.catch=="function"&&Oe.catch(function(){})}}catch(we){if(we&&ve&&typeof we.stack=="string")return[we.stack,ve.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=d.DetermineComponentFrameRoot(),C=_[0],V=_[1];if(C&&V){var ae=C.split(`
`),pe=V.split(`
`);for(v=d=0;d<ae.length&&!ae[d].includes("DetermineComponentFrameRoot");)d++;for(;v<pe.length&&!pe[v].includes("DetermineComponentFrameRoot");)v++;if(d===ae.length||v===pe.length)for(d=ae.length-1,v=pe.length-1;1<=d&&0<=v&&ae[d]!==pe[v];)v--;for(;1<=d&&0<=v;d--,v--)if(ae[d]!==pe[v]){if(d!==1||v!==1)do if(d--,v--,0>v||ae[d]!==pe[v]){var ke=`
`+ae[d].replace(" at new "," at ");return s.displayName&&ke.includes("<anonymous>")&&(ke=ke.replace("<anonymous>",s.displayName)),ke}while(1<=d&&0<=v);break}}}finally{ze=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?ce(c):""}function je(s,l){switch(s.tag){case 26:case 27:case 5:return ce(s.type);case 16:return ce("Lazy");case 13:return s.child!==l&&l!==null?ce("Suspense Fallback"):ce("Suspense");case 19:return ce("SuspenseList");case 0:case 15:return Ce(s.type,!1);case 11:return Ce(s.type.render,!1);case 1:return Ce(s.type,!0);case 31:return ce("Activity");default:return""}}function tt(s){try{var l="",c=null;do l+=je(s,c),c=s,s=s.return;while(s);return l}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var nt=Object.prototype.hasOwnProperty,ht=t.unstable_scheduleCallback,fr=t.unstable_cancelCallback,da=t.unstable_shouldYield,Hn=t.unstable_requestPaint,Ht=t.unstable_now,en=t.unstable_getCurrentPriorityLevel,kn=t.unstable_ImmediatePriority,Jn=t.unstable_UserBlockingPriority,Yt=t.unstable_NormalPriority,on=t.unstable_LowPriority,dt=t.unstable_IdlePriority,Pt=t.log,tn=t.unstable_setDisableYieldValue,Mt=null,or=null;function cn(s){if(typeof Pt=="function"&&tn(s),or&&typeof or.setStrictMode=="function")try{or.setStrictMode(Mt,s)}catch{}}var mr=Math.clz32?Math.clz32:oo,ns=Math.log,as=Math.LN2;function oo(s){return s>>>=0,s===0?32:31-(ns(s)/as|0)|0}var ma=256,ti=262144,Cr=4194304;function qn(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Da(s,l,c){var d=s.pendingLanes;if(d===0)return 0;var v=0,_=s.suspendedLanes,C=s.pingedLanes;s=s.warmLanes;var V=d&134217727;return V!==0?(d=V&~_,d!==0?v=qn(d):(C&=V,C!==0?v=qn(C):c||(c=V&~s,c!==0&&(v=qn(c))))):(V=d&~_,V!==0?v=qn(V):C!==0?v=qn(C):c||(c=d&~s,c!==0&&(v=qn(c)))),v===0?0:l!==0&&l!==v&&(l&_)===0&&(_=v&-v,c=l&-l,_>=c||_===32&&(c&4194048)!==0)?l:v}function pa(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function Uu(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mc(){var s=Cr;return Cr<<=1,(Cr&62914560)===0&&(Cr=4194304),s}function Oa(s){for(var l=[],c=0;31>c;c++)l.push(s);return l}function ri(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function zu(s,l,c,d,v,_){var C=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var V=s.entanglements,ae=s.expirationTimes,pe=s.hiddenUpdates;for(c=C&~c;0<c;){var ke=31-mr(c),Oe=1<<ke;V[ke]=0,ae[ke]=-1;var ve=pe[ke];if(ve!==null)for(pe[ke]=null,ke=0;ke<ve.length;ke++){var we=ve[ke];we!==null&&(we.lane&=-536870913)}c&=~Oe}d!==0&&ni(s,d,0),_!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=_&~(C&~l))}function ni(s,l,c){s.pendingLanes|=l,s.suspendedLanes&=~l;var d=31-mr(l);s.entangledLanes|=l,s.entanglements[d]=s.entanglements[d]|1073741824|c&261930}function ai(s,l){var c=s.entangledLanes|=l;for(s=s.entanglements;c;){var d=31-mr(c),v=1<<d;v&l|s[d]&l&&(s[d]|=l),c&=~v}}function co(s,l){var c=l&-l;return c=(c&42)!==0?1:si(c),(c&(s.suspendedLanes|l))!==0?0:c}function si(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function ss(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function B(){var s=se.p;return s!==0?s:(s=window.event,s===void 0?32:kw(s.type))}function J(s,l){var c=se.p;try{return se.p=s,l()}finally{se.p=c}}var W=Math.random().toString(36).slice(2),K="__reactFiber$"+W,Q="__reactProps$"+W,te="__reactContainer$"+W,de="__reactEvents$"+W,Ae="__reactListeners$"+W,me="__reactHandles$"+W,xe="__reactResources$"+W,ge="__reactMarker$"+W;function Be(s){delete s[K],delete s[Q],delete s[de],delete s[Ae],delete s[me]}function Ue(s){var l=s[K];if(l)return l;for(var c=s.parentNode;c;){if(l=c[te]||c[K]){if(c=l.alternate,l.child!==null||c!==null&&c.child!==null)for(s=fw(s);s!==null;){if(c=s[K])return c;s=fw(s)}return l}s=c,c=s.parentNode}return null}function Xe(s){if(s=s[K]||s[te]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function Le(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(n(33))}function We(s){var l=s[xe];return l||(l=s[xe]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Ze(s){s[ge]=!0}var $t=new Set,Kt={};function cr(s,l){Nn(s,l),Nn(s+"Capture",l)}function Nn(s,l){for(Kt[s]=l,s=0;s<l.length;s++)$t.add(l[s])}var is=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ls={},ga={};function Gi(s){return nt.call(ga,s)?!0:nt.call(ls,s)?!1:is.test(s)?ga[s]=!0:(ls[s]=!0,!1)}function Cn(s,l,c){if(Gi(l))if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var d=l.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+c)}}function xa(s,l,c){if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+c)}}function Hr(s,l,c,d){if(d===null)s.removeAttribute(c);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(l,c,""+d)}}function un(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Wi(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Hu(s,l,c){var d=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,_=d.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return v.call(this)},set:function(C){c=""+C,_.call(this,C)}}),Object.defineProperty(s,l,{enumerable:d.enumerable}),{getValue:function(){return c},setValue:function(C){c=""+C},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Qt(s){if(!s._valueTracker){var l=Wi(s)?"checked":"value";s._valueTracker=Hu(s,l,""+s[l])}}function uo(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var c=l.getValue(),d="";return s&&(d=Wi(s)?s.checked?"true":"false":s.value),s=d,s!==c?(l.setValue(s),!0):!1}function ks(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var fo=/[\n"\\]/g;function Zn(s){return s.replace(fo,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function pc(s,l,c,d,v,_,C,V){s.name="",C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"?s.type=C:s.removeAttribute("type"),l!=null?C==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+un(l)):s.value!==""+un(l)&&(s.value=""+un(l)):C!=="submit"&&C!=="reset"||s.removeAttribute("value"),l!=null?qu(s,C,un(l)):c!=null?qu(s,C,un(c)):d!=null&&s.removeAttribute("value"),v==null&&_!=null&&(s.defaultChecked=!!_),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?s.name=""+un(V):s.removeAttribute("name")}function uh(s,l,c,d,v,_,C,V){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),l!=null||c!=null){if(!(_!=="submit"&&_!=="reset"||l!=null)){Qt(s);return}c=c!=null?""+un(c):"",l=l!=null?""+un(l):c,V||l===s.value||(s.value=l),s.defaultValue=l}d=d??v,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=V?s.checked:!!d,s.defaultChecked=!!d,C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(s.name=C),Qt(s)}function qu(s,l,c){l==="number"&&ks(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Xi(s,l,c,d){if(s=s.options,l){l={};for(var v=0;v<c.length;v++)l["$"+c[v]]=!0;for(c=0;c<s.length;c++)v=l.hasOwnProperty("$"+s[c].value),s[c].selected!==v&&(s[c].selected=v),v&&d&&(s[c].defaultSelected=!0)}else{for(c=""+un(c),l=null,v=0;v<s.length;v++){if(s[v].value===c){s[v].selected=!0,d&&(s[v].defaultSelected=!0);return}l!==null||s[v].disabled||(l=s[v])}l!==null&&(l.selected=!0)}}function fh(s,l,c){if(l!=null&&(l=""+un(l),l!==s.value&&(s.value=l),c==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=c!=null?""+un(c):""}function Yi(s,l,c,d){if(l==null){if(d!=null){if(c!=null)throw Error(n(92));if(_e(d)){if(1<d.length)throw Error(n(93));d=d[0]}c=d}c==null&&(c=""),l=c}c=un(l),s.defaultValue=c,d=s.textContent,d===c&&d!==""&&d!==null&&(s.value=d),Qt(s)}function ea(s,l){if(l){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=l;return}}s.textContent=l}var hh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Gu(s,l,c){var d=l.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?d?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":d?s.setProperty(l,c):typeof c!="number"||c===0||hh.has(l)?l==="float"?s.cssFloat=c:s[l]=(""+c).trim():s[l]=c+"px"}function Wu(s,l,c){if(l!=null&&typeof l!="object")throw Error(n(62));if(s=s.style,c!=null){for(var d in c)!c.hasOwnProperty(d)||l!=null&&l.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var v in l)d=l[v],l.hasOwnProperty(v)&&c[v]!==d&&Gu(s,v,d)}else for(var _ in l)l.hasOwnProperty(_)&&Gu(s,_,l[_])}function gc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$i=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function xc(s){return $i.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function os(){}var Xu=null;function Fa(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ki=null,Ns=null;function ho(s){var l=Xe(s);if(l&&(s=l.stateNode)){var c=s[Q]||null;e:switch(s=l.stateNode,l.type){case"input":if(pc(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),l=c.name,c.type==="radio"&&l!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Zn(""+l)+'"][type="radio"]'),l=0;l<c.length;l++){var d=c[l];if(d!==s&&d.form===s.form){var v=d[Q]||null;if(!v)throw Error(n(90));pc(d,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(l=0;l<c.length;l++)d=c[l],d.form===s.form&&uo(d)}break e;case"textarea":fh(s,c.value,c.defaultValue);break e;case"select":l=c.value,l!=null&&Xi(s,!!c.multiple,l,!1)}}}var vc=!1;function Qi(s,l,c){if(vc)return s(l,c);vc=!0;try{var d=s(l);return d}finally{if(vc=!1,(Ki!==null||Ns!==null)&&(id(),Ki&&(l=Ki,s=Ns,Ns=Ki=null,ho(l),s)))for(l=0;l<s.length;l++)ho(s[l])}}function cs(s,l){var c=s.stateNode;if(c===null)return null;var d=c[Q]||null;if(d===null)return null;c=d[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,l,typeof c));return c}var ja=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mo=!1;if(ja)try{var nr={};Object.defineProperty(nr,"passive",{get:function(){mo=!0}}),window.addEventListener("test",nr,nr),window.removeEventListener("test",nr,nr)}catch{mo=!1}var Cs=null,Yu=null,po=null;function $u(){if(po)return po;var s,l=Yu,c=l.length,d,v="value"in Cs?Cs.value:Cs.textContent,_=v.length;for(s=0;s<c&&l[s]===v[s];s++);var C=c-s;for(d=1;d<=C&&l[c-d]===v[_-d];d++);return po=v.slice(s,1<d?1-d:void 0)}function go(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function ii(){return!0}function us(){return!1}function gn(s){function l(c,d,v,_,C){this._reactName=c,this._targetInst=v,this.type=d,this.nativeEvent=_,this.target=C,this.currentTarget=null;for(var V in s)s.hasOwnProperty(V)&&(c=s[V],this[V]=c?c(_):_[V]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?ii:us,this.isPropagationStopped=us,this}return x(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ii)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ii)},persist:function(){},isPersistent:ii}),l}var li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rs=gn(li),Ji=x({},li,{view:0,detail:0}),Ku=gn(Ji),Zi,yc,Is,_c=x({},Ji,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:el,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Is&&(Is&&s.type==="mousemove"?(Zi=s.screenX-Is.screenX,yc=s.screenY-Is.screenY):yc=Zi=0,Is=s),Zi)},movementY:function(s){return"movementY"in s?s.movementY:yc}}),Qu=gn(_c),xo=x({},_c,{dataTransfer:0}),mh=gn(xo),ph=x({},Ji,{relatedTarget:0}),vo=gn(ph),Ju=x({},li,{animationName:0,elapsedTime:0,pseudoElement:0}),gh=gn(Ju),bc=x({},li,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),xh=gn(bc),vh=x({},li,{data:0}),Ds=gn(vh),yh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_h={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wh(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=bh[s])?!!l[s]:!1}function el(){return wh}var Gn=x({},Ji,{key:function(s){if(s.key){var l=yh[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=go(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?_h[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:el,charCode:function(s){return s.type==="keypress"?go(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?go(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Eh=gn(Gn),Th=x({},_c,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oi=gn(Th),g=x({},Ji,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:el}),S=gn(g),D=x({},li,{propertyName:0,elapsedTime:0,pseudoElement:0}),X=gn(D),fe=x({},_c,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),be=gn(fe),Ge=x({},li,{newState:0,oldState:0}),yt=gn(Ge),Pr=[9,13,27,32],qt=ja&&"CompositionEvent"in window,br=null;ja&&"documentMode"in document&&(br=document.documentMode);var Pa=ja&&"TextEvent"in window&&!br,Os=ja&&(!qt||br&&8<br&&11>=br),fs=" ",hs=!1;function yo(s,l){switch(s){case"keyup":return Pr.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Ec=!1;function y3(s,l){switch(s){case"compositionend":return wc(l);case"keypress":return l.which!==32?null:(hs=!0,fs);case"textInput":return s=l.data,s===fs&&hs?null:s;default:return null}}function _3(s,l){if(Ec)return s==="compositionend"||!qt&&yo(s,l)?(s=$u(),po=Yu=Cs=null,Ec=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Os&&l.locale!=="ko"?null:l.data;default:return null}}var b3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function m_(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!b3[s.type]:l==="textarea"}function p_(s,l,c,d){Ki?Ns?Ns.push(d):Ns=[d]:Ki=d,l=dd(l,"onChange"),0<l.length&&(c=new Rs("onChange","change",null,c,d),s.push({event:c,listeners:l}))}var Zu=null,ef=null;function w3(s){Qb(s,0)}function Sh(s){var l=Le(s);if(uo(l))return s}function g_(s,l){if(s==="change")return l}var x_=!1;if(ja){var Lp;if(ja){var Bp="oninput"in document;if(!Bp){var v_=document.createElement("div");v_.setAttribute("oninput","return;"),Bp=typeof v_.oninput=="function"}Lp=Bp}else Lp=!1;x_=Lp&&(!document.documentMode||9<document.documentMode)}function y_(){Zu&&(Zu.detachEvent("onpropertychange",__),ef=Zu=null)}function __(s){if(s.propertyName==="value"&&Sh(ef)){var l=[];p_(l,ef,s,Fa(s)),Qi(w3,l)}}function E3(s,l,c){s==="focusin"?(y_(),Zu=l,ef=c,Zu.attachEvent("onpropertychange",__)):s==="focusout"&&y_()}function T3(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Sh(ef)}function S3(s,l){if(s==="click")return Sh(l)}function A3(s,l){if(s==="input"||s==="change")return Sh(l)}function k3(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var va=typeof Object.is=="function"?Object.is:k3;function tf(s,l){if(va(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var c=Object.keys(s),d=Object.keys(l);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var v=c[d];if(!nt.call(l,v)||!va(s[v],l[v]))return!1}return!0}function b_(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function w_(s,l){var c=b_(s);s=0;for(var d;c;){if(c.nodeType===3){if(d=s+c.textContent.length,s<=l&&d>=l)return{node:c,offset:l-s};s=d}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=b_(c)}}function E_(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?E_(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function T_(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=ks(s.document);l instanceof s.HTMLIFrameElement;){try{var c=typeof l.contentWindow.location.href=="string"}catch{c=!1}if(c)s=l.contentWindow;else break;l=ks(s.document)}return l}function Vp(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var N3=ja&&"documentMode"in document&&11>=document.documentMode,Tc=null,Up=null,rf=null,zp=!1;function S_(s,l,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;zp||Tc==null||Tc!==ks(d)||(d=Tc,"selectionStart"in d&&Vp(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),rf&&tf(rf,d)||(rf=d,d=dd(Up,"onSelect"),0<d.length&&(l=new Rs("onSelect","select",null,l,c),s.push({event:l,listeners:d}),l.target=Tc)))}function _o(s,l){var c={};return c[s.toLowerCase()]=l.toLowerCase(),c["Webkit"+s]="webkit"+l,c["Moz"+s]="moz"+l,c}var Sc={animationend:_o("Animation","AnimationEnd"),animationiteration:_o("Animation","AnimationIteration"),animationstart:_o("Animation","AnimationStart"),transitionrun:_o("Transition","TransitionRun"),transitionstart:_o("Transition","TransitionStart"),transitioncancel:_o("Transition","TransitionCancel"),transitionend:_o("Transition","TransitionEnd")},Hp={},A_={};ja&&(A_=document.createElement("div").style,"AnimationEvent"in window||(delete Sc.animationend.animation,delete Sc.animationiteration.animation,delete Sc.animationstart.animation),"TransitionEvent"in window||delete Sc.transitionend.transition);function bo(s){if(Hp[s])return Hp[s];if(!Sc[s])return s;var l=Sc[s],c;for(c in l)if(l.hasOwnProperty(c)&&c in A_)return Hp[s]=l[c];return s}var k_=bo("animationend"),N_=bo("animationiteration"),C_=bo("animationstart"),C3=bo("transitionrun"),R3=bo("transitionstart"),I3=bo("transitioncancel"),R_=bo("transitionend"),I_=new Map,qp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");qp.push("scrollEnd");function ds(s,l){I_.set(s,l),cr(l,[s])}var Ah=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ma=[],Ac=0,Gp=0;function kh(){for(var s=Ac,l=Gp=Ac=0;l<s;){var c=Ma[l];Ma[l++]=null;var d=Ma[l];Ma[l++]=null;var v=Ma[l];Ma[l++]=null;var _=Ma[l];if(Ma[l++]=null,d!==null&&v!==null){var C=d.pending;C===null?v.next=v:(v.next=C.next,C.next=v),d.pending=v}_!==0&&D_(c,v,_)}}function Nh(s,l,c,d){Ma[Ac++]=s,Ma[Ac++]=l,Ma[Ac++]=c,Ma[Ac++]=d,Gp|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function Wp(s,l,c,d){return Nh(s,l,c,d),Ch(s)}function wo(s,l){return Nh(s,null,null,l),Ch(s)}function D_(s,l,c){s.lanes|=c;var d=s.alternate;d!==null&&(d.lanes|=c);for(var v=!1,_=s.return;_!==null;)_.childLanes|=c,d=_.alternate,d!==null&&(d.childLanes|=c),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(v=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,v&&l!==null&&(v=31-mr(c),s=_.hiddenUpdates,d=s[v],d===null?s[v]=[l]:d.push(l),l.lane=c|536870912),_):null}function Ch(s){if(50<Sf)throw Sf=0,t1=null,Error(n(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var kc={};function D3(s,l,c,d){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ya(s,l,c,d){return new D3(s,l,c,d)}function Xp(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ci(s,l){var c=s.alternate;return c===null?(c=ya(s.tag,l,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=l,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,l=s.dependencies,c.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function O_(s,l){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,l=c.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Rh(s,l,c,d,v,_){var C=0;if(d=s,typeof s=="function")Xp(s)&&(C=1);else if(typeof s=="string")C=M6(s,c,Y.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case R:return s=ya(31,c,l,v),s.elementType=R,s.lanes=_,s;case T:return Eo(c.children,v,_,l);case E:C=8,v|=24;break;case k:return s=ya(12,c,l,v|2),s.elementType=k,s.lanes=_,s;case H:return s=ya(13,c,l,v),s.elementType=H,s.lanes=_,s;case q:return s=ya(19,c,l,v),s.elementType=q,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case N:C=10;break e;case I:C=9;break e;case z:C=11;break e;case A:C=14;break e;case F:C=16,d=null;break e}C=29,c=Error(n(130,s===null?"null":typeof s,"")),d=null}return l=ya(C,c,l,v),l.elementType=s,l.type=d,l.lanes=_,l}function Eo(s,l,c,d){return s=ya(7,s,d,l),s.lanes=c,s}function Yp(s,l,c){return s=ya(6,s,null,l),s.lanes=c,s}function F_(s){var l=ya(18,null,null,0);return l.stateNode=s,l}function $p(s,l,c){return l=ya(4,s.children!==null?s.children:[],s.key,l),l.lanes=c,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var j_=new WeakMap;function La(s,l){if(typeof s=="object"&&s!==null){var c=j_.get(s);return c!==void 0?c:(l={value:s,source:l,stack:tt(l)},j_.set(s,l),l)}return{value:s,source:l,stack:tt(l)}}var Nc=[],Cc=0,Ih=null,nf=0,Ba=[],Va=0,tl=null,Fs=1,js="";function ui(s,l){Nc[Cc++]=nf,Nc[Cc++]=Ih,Ih=s,nf=l}function P_(s,l,c){Ba[Va++]=Fs,Ba[Va++]=js,Ba[Va++]=tl,tl=s;var d=Fs;s=js;var v=32-mr(d)-1;d&=~(1<<v),c+=1;var _=32-mr(l)+v;if(30<_){var C=v-v%5;_=(d&(1<<C)-1).toString(32),d>>=C,v-=C,Fs=1<<32-mr(l)+v|c<<v|d,js=_+s}else Fs=1<<_|c<<v|d,js=s}function Kp(s){s.return!==null&&(ui(s,1),P_(s,1,0))}function Qp(s){for(;s===Ih;)Ih=Nc[--Cc],Nc[Cc]=null,nf=Nc[--Cc],Nc[Cc]=null;for(;s===tl;)tl=Ba[--Va],Ba[Va]=null,js=Ba[--Va],Ba[Va]=null,Fs=Ba[--Va],Ba[Va]=null}function M_(s,l){Ba[Va++]=Fs,Ba[Va++]=js,Ba[Va++]=tl,Fs=l.id,js=l.overflow,tl=s}var xn=null,pr=null,Ft=!1,rl=null,Ua=!1,Jp=Error(n(519));function nl(s){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw af(La(l,s)),Jp}function L_(s){var l=s.stateNode,c=s.type,d=s.memoizedProps;switch(l[K]=s,l[Q]=d,c){case"dialog":Nt("cancel",l),Nt("close",l);break;case"iframe":case"object":case"embed":Nt("load",l);break;case"video":case"audio":for(c=0;c<kf.length;c++)Nt(kf[c],l);break;case"source":Nt("error",l);break;case"img":case"image":case"link":Nt("error",l),Nt("load",l);break;case"details":Nt("toggle",l);break;case"input":Nt("invalid",l),uh(l,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":Nt("invalid",l);break;case"textarea":Nt("invalid",l),Yi(l,d.value,d.defaultValue,d.children)}c=d.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||l.textContent===""+c||d.suppressHydrationWarning===!0||tw(l.textContent,c)?(d.popover!=null&&(Nt("beforetoggle",l),Nt("toggle",l)),d.onScroll!=null&&Nt("scroll",l),d.onScrollEnd!=null&&Nt("scrollend",l),d.onClick!=null&&(l.onclick=os),l=!0):l=!1,l||nl(s,!0)}function B_(s){for(xn=s.return;xn;)switch(xn.tag){case 5:case 31:case 13:Ua=!1;return;case 27:case 3:Ua=!0;return;default:xn=xn.return}}function Rc(s){if(s!==xn)return!1;if(!Ft)return B_(s),Ft=!0,!1;var l=s.tag,c;if((c=l!==3&&l!==27)&&((c=l===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||g1(s.type,s.memoizedProps)),c=!c),c&&pr&&nl(s),B_(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));pr=uw(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));pr=uw(s)}else l===27?(l=pr,xl(s.type)?(s=b1,b1=null,pr=s):pr=l):pr=xn?Ha(s.stateNode.nextSibling):null;return!0}function To(){pr=xn=null,Ft=!1}function Zp(){var s=rl;return s!==null&&(aa===null?aa=s:aa.push.apply(aa,s),rl=null),s}function af(s){rl===null?rl=[s]:rl.push(s)}var eg=U(null),So=null,fi=null;function al(s,l,c){G(eg,l._currentValue),l._currentValue=c}function hi(s){s._currentValue=eg.current,P(eg)}function tg(s,l,c){for(;s!==null;){var d=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,d!==null&&(d.childLanes|=l)):d!==null&&(d.childLanes&l)!==l&&(d.childLanes|=l),s===c)break;s=s.return}}function rg(s,l,c,d){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var _=v.dependencies;if(_!==null){var C=v.child;_=_.firstContext;e:for(;_!==null;){var V=_;_=v;for(var ae=0;ae<l.length;ae++)if(V.context===l[ae]){_.lanes|=c,V=_.alternate,V!==null&&(V.lanes|=c),tg(_.return,c,s),d||(C=null);break e}_=V.next}}else if(v.tag===18){if(C=v.return,C===null)throw Error(n(341));C.lanes|=c,_=C.alternate,_!==null&&(_.lanes|=c),tg(C,c,s),C=null}else C=v.child;if(C!==null)C.return=v;else for(C=v;C!==null;){if(C===s){C=null;break}if(v=C.sibling,v!==null){v.return=C.return,C=v;break}C=C.return}v=C}}function Ic(s,l,c,d){s=null;for(var v=l,_=!1;v!==null;){if(!_){if((v.flags&524288)!==0)_=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var C=v.alternate;if(C===null)throw Error(n(387));if(C=C.memoizedProps,C!==null){var V=v.type;va(v.pendingProps.value,C.value)||(s!==null?s.push(V):s=[V])}}else if(v===ye.current){if(C=v.alternate,C===null)throw Error(n(387));C.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(Df):s=[Df])}v=v.return}s!==null&&rg(l,s,c,d),l.flags|=262144}function Dh(s){for(s=s.firstContext;s!==null;){if(!va(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ao(s){So=s,fi=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function vn(s){return V_(So,s)}function Oh(s,l){return So===null&&Ao(s),V_(s,l)}function V_(s,l){var c=l._currentValue;if(l={context:l,memoizedValue:c,next:null},fi===null){if(s===null)throw Error(n(308));fi=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else fi=fi.next=l;return c}var O3=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(c,d){s.push(d)}};this.abort=function(){l.aborted=!0,s.forEach(function(c){return c()})}},F3=t.unstable_scheduleCallback,j3=t.unstable_NormalPriority,qr={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ng(){return{controller:new O3,data:new Map,refCount:0}}function sf(s){s.refCount--,s.refCount===0&&F3(j3,function(){s.controller.abort()})}var lf=null,ag=0,Dc=0,Oc=null;function P3(s,l){if(lf===null){var c=lf=[];ag=0,Dc=l1(),Oc={status:"pending",value:void 0,then:function(d){c.push(d)}}}return ag++,l.then(U_,U_),l}function U_(){if(--ag===0&&lf!==null){Oc!==null&&(Oc.status="fulfilled");var s=lf;lf=null,Dc=0,Oc=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function M3(s,l){var c=[],d={status:"pending",value:null,reason:null,then:function(v){c.push(v)}};return s.then(function(){d.status="fulfilled",d.value=l;for(var v=0;v<c.length;v++)(0,c[v])(l)},function(v){for(d.status="rejected",d.reason=v,v=0;v<c.length;v++)(0,c[v])(void 0)}),d}var z_=ne.S;ne.S=function(s,l){Sb=Ht(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&P3(s,l),z_!==null&&z_(s,l)};var ko=U(null);function sg(){var s=ko.current;return s!==null?s:ur.pooledCache}function Fh(s,l){l===null?G(ko,ko.current):G(ko,l.pool)}function H_(){var s=sg();return s===null?null:{parent:qr._currentValue,pool:s}}var Fc=Error(n(460)),ig=Error(n(474)),jh=Error(n(542)),Ph={then:function(){}};function q_(s){return s=s.status,s==="fulfilled"||s==="rejected"}function G_(s,l,c){switch(c=s[c],c===void 0?s.push(l):c!==l&&(l.then(os,os),l=c),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,X_(s),s;default:if(typeof l.status=="string")l.then(os,os);else{if(s=ur,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=l,s.status="pending",s.then(function(d){if(l.status==="pending"){var v=l;v.status="fulfilled",v.value=d}},function(d){if(l.status==="pending"){var v=l;v.status="rejected",v.reason=d}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,X_(s),s}throw Co=l,Fc}}function No(s){try{var l=s._init;return l(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Co=c,Fc):c}}var Co=null;function W_(){if(Co===null)throw Error(n(459));var s=Co;return Co=null,s}function X_(s){if(s===Fc||s===jh)throw Error(n(483))}var jc=null,of=0;function Mh(s){var l=of;return of+=1,jc===null&&(jc=[]),G_(jc,s,l)}function cf(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Lh(s,l){throw l.$$typeof===y?Error(n(525)):(s=Object.prototype.toString.call(l),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function Y_(s){function l(ue,le){if(s){var he=ue.deletions;he===null?(ue.deletions=[le],ue.flags|=16):he.push(le)}}function c(ue,le){if(!s)return null;for(;le!==null;)l(ue,le),le=le.sibling;return null}function d(ue){for(var le=new Map;ue!==null;)ue.key!==null?le.set(ue.key,ue):le.set(ue.index,ue),ue=ue.sibling;return le}function v(ue,le){return ue=ci(ue,le),ue.index=0,ue.sibling=null,ue}function _(ue,le,he){return ue.index=he,s?(he=ue.alternate,he!==null?(he=he.index,he<le?(ue.flags|=67108866,le):he):(ue.flags|=67108866,le)):(ue.flags|=1048576,le)}function C(ue){return s&&ue.alternate===null&&(ue.flags|=67108866),ue}function V(ue,le,he,Re){return le===null||le.tag!==6?(le=Yp(he,ue.mode,Re),le.return=ue,le):(le=v(le,he),le.return=ue,le)}function ae(ue,le,he,Re){var at=he.type;return at===T?ke(ue,le,he.props.children,Re,he.key):le!==null&&(le.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===F&&No(at)===le.type)?(le=v(le,he.props),cf(le,he),le.return=ue,le):(le=Rh(he.type,he.key,he.props,null,ue.mode,Re),cf(le,he),le.return=ue,le)}function pe(ue,le,he,Re){return le===null||le.tag!==4||le.stateNode.containerInfo!==he.containerInfo||le.stateNode.implementation!==he.implementation?(le=$p(he,ue.mode,Re),le.return=ue,le):(le=v(le,he.children||[]),le.return=ue,le)}function ke(ue,le,he,Re,at){return le===null||le.tag!==7?(le=Eo(he,ue.mode,Re,at),le.return=ue,le):(le=v(le,he),le.return=ue,le)}function Oe(ue,le,he){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return le=Yp(""+le,ue.mode,he),le.return=ue,le;if(typeof le=="object"&&le!==null){switch(le.$$typeof){case b:return he=Rh(le.type,le.key,le.props,null,ue.mode,he),cf(he,le),he.return=ue,he;case w:return le=$p(le,ue.mode,he),le.return=ue,le;case F:return le=No(le),Oe(ue,le,he)}if(_e(le)||j(le))return le=Eo(le,ue.mode,he,null),le.return=ue,le;if(typeof le.then=="function")return Oe(ue,Mh(le),he);if(le.$$typeof===N)return Oe(ue,Oh(ue,le),he);Lh(ue,le)}return null}function ve(ue,le,he,Re){var at=le!==null?le.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return at!==null?null:V(ue,le,""+he,Re);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case b:return he.key===at?ae(ue,le,he,Re):null;case w:return he.key===at?pe(ue,le,he,Re):null;case F:return he=No(he),ve(ue,le,he,Re)}if(_e(he)||j(he))return at!==null?null:ke(ue,le,he,Re,null);if(typeof he.then=="function")return ve(ue,le,Mh(he),Re);if(he.$$typeof===N)return ve(ue,le,Oh(ue,he),Re);Lh(ue,he)}return null}function we(ue,le,he,Re,at){if(typeof Re=="string"&&Re!==""||typeof Re=="number"||typeof Re=="bigint")return ue=ue.get(he)||null,V(le,ue,""+Re,at);if(typeof Re=="object"&&Re!==null){switch(Re.$$typeof){case b:return ue=ue.get(Re.key===null?he:Re.key)||null,ae(le,ue,Re,at);case w:return ue=ue.get(Re.key===null?he:Re.key)||null,pe(le,ue,Re,at);case F:return Re=No(Re),we(ue,le,he,Re,at)}if(_e(Re)||j(Re))return ue=ue.get(he)||null,ke(le,ue,Re,at,null);if(typeof Re.then=="function")return we(ue,le,he,Mh(Re),at);if(Re.$$typeof===N)return we(ue,le,he,Oh(le,Re),at);Lh(le,Re)}return null}function Je(ue,le,he,Re){for(var at=null,Vt=null,et=le,wt=le=0,Rt=null;et!==null&&wt<he.length;wt++){et.index>wt?(Rt=et,et=null):Rt=et.sibling;var Ut=ve(ue,et,he[wt],Re);if(Ut===null){et===null&&(et=Rt);break}s&&et&&Ut.alternate===null&&l(ue,et),le=_(Ut,le,wt),Vt===null?at=Ut:Vt.sibling=Ut,Vt=Ut,et=Rt}if(wt===he.length)return c(ue,et),Ft&&ui(ue,wt),at;if(et===null){for(;wt<he.length;wt++)et=Oe(ue,he[wt],Re),et!==null&&(le=_(et,le,wt),Vt===null?at=et:Vt.sibling=et,Vt=et);return Ft&&ui(ue,wt),at}for(et=d(et);wt<he.length;wt++)Rt=we(et,ue,wt,he[wt],Re),Rt!==null&&(s&&Rt.alternate!==null&&et.delete(Rt.key===null?wt:Rt.key),le=_(Rt,le,wt),Vt===null?at=Rt:Vt.sibling=Rt,Vt=Rt);return s&&et.forEach(function(wl){return l(ue,wl)}),Ft&&ui(ue,wt),at}function lt(ue,le,he,Re){if(he==null)throw Error(n(151));for(var at=null,Vt=null,et=le,wt=le=0,Rt=null,Ut=he.next();et!==null&&!Ut.done;wt++,Ut=he.next()){et.index>wt?(Rt=et,et=null):Rt=et.sibling;var wl=ve(ue,et,Ut.value,Re);if(wl===null){et===null&&(et=Rt);break}s&&et&&wl.alternate===null&&l(ue,et),le=_(wl,le,wt),Vt===null?at=wl:Vt.sibling=wl,Vt=wl,et=Rt}if(Ut.done)return c(ue,et),Ft&&ui(ue,wt),at;if(et===null){for(;!Ut.done;wt++,Ut=he.next())Ut=Oe(ue,Ut.value,Re),Ut!==null&&(le=_(Ut,le,wt),Vt===null?at=Ut:Vt.sibling=Ut,Vt=Ut);return Ft&&ui(ue,wt),at}for(et=d(et);!Ut.done;wt++,Ut=he.next())Ut=we(et,ue,wt,Ut.value,Re),Ut!==null&&(s&&Ut.alternate!==null&&et.delete(Ut.key===null?wt:Ut.key),le=_(Ut,le,wt),Vt===null?at=Ut:Vt.sibling=Ut,Vt=Ut);return s&&et.forEach(function(Y6){return l(ue,Y6)}),Ft&&ui(ue,wt),at}function ir(ue,le,he,Re){if(typeof he=="object"&&he!==null&&he.type===T&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case b:e:{for(var at=he.key;le!==null;){if(le.key===at){if(at=he.type,at===T){if(le.tag===7){c(ue,le.sibling),Re=v(le,he.props.children),Re.return=ue,ue=Re;break e}}else if(le.elementType===at||typeof at=="object"&&at!==null&&at.$$typeof===F&&No(at)===le.type){c(ue,le.sibling),Re=v(le,he.props),cf(Re,he),Re.return=ue,ue=Re;break e}c(ue,le);break}else l(ue,le);le=le.sibling}he.type===T?(Re=Eo(he.props.children,ue.mode,Re,he.key),Re.return=ue,ue=Re):(Re=Rh(he.type,he.key,he.props,null,ue.mode,Re),cf(Re,he),Re.return=ue,ue=Re)}return C(ue);case w:e:{for(at=he.key;le!==null;){if(le.key===at)if(le.tag===4&&le.stateNode.containerInfo===he.containerInfo&&le.stateNode.implementation===he.implementation){c(ue,le.sibling),Re=v(le,he.children||[]),Re.return=ue,ue=Re;break e}else{c(ue,le);break}else l(ue,le);le=le.sibling}Re=$p(he,ue.mode,Re),Re.return=ue,ue=Re}return C(ue);case F:return he=No(he),ir(ue,le,he,Re)}if(_e(he))return Je(ue,le,he,Re);if(j(he)){if(at=j(he),typeof at!="function")throw Error(n(150));return he=at.call(he),lt(ue,le,he,Re)}if(typeof he.then=="function")return ir(ue,le,Mh(he),Re);if(he.$$typeof===N)return ir(ue,le,Oh(ue,he),Re);Lh(ue,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,le!==null&&le.tag===6?(c(ue,le.sibling),Re=v(le,he),Re.return=ue,ue=Re):(c(ue,le),Re=Yp(he,ue.mode,Re),Re.return=ue,ue=Re),C(ue)):c(ue,le)}return function(ue,le,he,Re){try{of=0;var at=ir(ue,le,he,Re);return jc=null,at}catch(et){if(et===Fc||et===jh)throw et;var Vt=ya(29,et,null,ue.mode);return Vt.lanes=Re,Vt.return=ue,Vt}finally{}}}var Ro=Y_(!0),$_=Y_(!1),sl=!1;function lg(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function og(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function il(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ll(s,l,c){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(Gt&2)!==0){var v=d.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),d.pending=l,l=Ch(s),D_(s,null,c),l}return Nh(s,d,l,c),Ch(s)}function uf(s,l,c){if(l=l.updateQueue,l!==null&&(l=l.shared,(c&4194048)!==0)){var d=l.lanes;d&=s.pendingLanes,c|=d,l.lanes=c,ai(s,c)}}function cg(s,l){var c=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var v=null,_=null;if(c=c.firstBaseUpdate,c!==null){do{var C={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};_===null?v=_=C:_=_.next=C,c=c.next}while(c!==null);_===null?v=_=l:_=_.next=l}else v=_=l;c={baseState:d.baseState,firstBaseUpdate:v,lastBaseUpdate:_,shared:d.shared,callbacks:d.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=l}var ug=!1;function ff(){if(ug){var s=Oc;if(s!==null)throw s}}function hf(s,l,c,d){ug=!1;var v=s.updateQueue;sl=!1;var _=v.firstBaseUpdate,C=v.lastBaseUpdate,V=v.shared.pending;if(V!==null){v.shared.pending=null;var ae=V,pe=ae.next;ae.next=null,C===null?_=pe:C.next=pe,C=ae;var ke=s.alternate;ke!==null&&(ke=ke.updateQueue,V=ke.lastBaseUpdate,V!==C&&(V===null?ke.firstBaseUpdate=pe:V.next=pe,ke.lastBaseUpdate=ae))}if(_!==null){var Oe=v.baseState;C=0,ke=pe=ae=null,V=_;do{var ve=V.lane&-536870913,we=ve!==V.lane;if(we?(Ct&ve)===ve:(d&ve)===ve){ve!==0&&ve===Dc&&(ug=!0),ke!==null&&(ke=ke.next={lane:0,tag:V.tag,payload:V.payload,callback:null,next:null});e:{var Je=s,lt=V;ve=l;var ir=c;switch(lt.tag){case 1:if(Je=lt.payload,typeof Je=="function"){Oe=Je.call(ir,Oe,ve);break e}Oe=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=lt.payload,ve=typeof Je=="function"?Je.call(ir,Oe,ve):Je,ve==null)break e;Oe=x({},Oe,ve);break e;case 2:sl=!0}}ve=V.callback,ve!==null&&(s.flags|=64,we&&(s.flags|=8192),we=v.callbacks,we===null?v.callbacks=[ve]:we.push(ve))}else we={lane:ve,tag:V.tag,payload:V.payload,callback:V.callback,next:null},ke===null?(pe=ke=we,ae=Oe):ke=ke.next=we,C|=ve;if(V=V.next,V===null){if(V=v.shared.pending,V===null)break;we=V,V=we.next,we.next=null,v.lastBaseUpdate=we,v.shared.pending=null}}while(!0);ke===null&&(ae=Oe),v.baseState=ae,v.firstBaseUpdate=pe,v.lastBaseUpdate=ke,_===null&&(v.shared.lanes=0),hl|=C,s.lanes=C,s.memoizedState=Oe}}function K_(s,l){if(typeof s!="function")throw Error(n(191,s));s.call(l)}function Q_(s,l){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)K_(c[s],l)}var Pc=U(null),Bh=U(0);function J_(s,l){s=bi,G(Bh,s),G(Pc,l),bi=s|l.baseLanes}function fg(){G(Bh,bi),G(Pc,Pc.current)}function hg(){bi=Bh.current,P(Pc),P(Bh)}var _a=U(null),za=null;function ol(s){var l=s.alternate;G(Mr,Mr.current&1),G(_a,s),za===null&&(l===null||Pc.current!==null||l.memoizedState!==null)&&(za=s)}function dg(s){G(Mr,Mr.current),G(_a,s),za===null&&(za=s)}function Z_(s){s.tag===22?(G(Mr,Mr.current),G(_a,s),za===null&&(za=s)):cl()}function cl(){G(Mr,Mr.current),G(_a,_a.current)}function ba(s){P(_a),za===s&&(za=null),P(Mr)}var Mr=U(0);function Vh(s){for(var l=s;l!==null;){if(l.tag===13){var c=l.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||y1(c)||_1(c)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var di=0,_t=null,ar=null,Gr=null,Uh=!1,Mc=!1,Io=!1,zh=0,df=0,Lc=null,L3=0;function Rr(){throw Error(n(321))}function mg(s,l){if(l===null)return!1;for(var c=0;c<l.length&&c<s.length;c++)if(!va(s[c],l[c]))return!1;return!0}function pg(s,l,c,d,v,_){return di=_,_t=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,ne.H=s===null||s.memoizedState===null?P2:Rg,Io=!1,_=c(d,v),Io=!1,Mc&&(_=t2(l,c,d,v)),e2(s),_}function e2(s){ne.H=gf;var l=ar!==null&&ar.next!==null;if(di=0,Gr=ar=_t=null,Uh=!1,df=0,Lc=null,l)throw Error(n(300));s===null||Wr||(s=s.dependencies,s!==null&&Dh(s)&&(Wr=!0))}function t2(s,l,c,d){_t=s;var v=0;do{if(Mc&&(Lc=null),df=0,Mc=!1,25<=v)throw Error(n(301));if(v+=1,Gr=ar=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}ne.H=M2,_=l(c,d)}while(Mc);return _}function B3(){var s=ne.H,l=s.useState()[0];return l=typeof l.then=="function"?mf(l):l,s=s.useState()[0],(ar!==null?ar.memoizedState:null)!==s&&(_t.flags|=1024),l}function gg(){var s=zh!==0;return zh=0,s}function xg(s,l,c){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~c}function vg(s){if(Uh){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Uh=!1}di=0,Gr=ar=_t=null,Mc=!1,df=zh=0,Lc=null}function Wn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gr===null?_t.memoizedState=Gr=s:Gr=Gr.next=s,Gr}function Lr(){if(ar===null){var s=_t.alternate;s=s!==null?s.memoizedState:null}else s=ar.next;var l=Gr===null?_t.memoizedState:Gr.next;if(l!==null)Gr=l,ar=s;else{if(s===null)throw _t.alternate===null?Error(n(467)):Error(n(310));ar=s,s={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},Gr===null?_t.memoizedState=Gr=s:Gr=Gr.next=s}return Gr}function Hh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function mf(s){var l=df;return df+=1,Lc===null&&(Lc=[]),s=G_(Lc,s,l),l=_t,(Gr===null?l.memoizedState:Gr.next)===null&&(l=l.alternate,ne.H=l===null||l.memoizedState===null?P2:Rg),s}function qh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return mf(s);if(s.$$typeof===N)return vn(s)}throw Error(n(438,String(s)))}function yg(s){var l=null,c=_t.updateQueue;if(c!==null&&(l=c.memoCache),l==null){var d=_t.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(l={data:d.data.map(function(v){return v.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),c===null&&(c=Hh(),_t.updateQueue=c),c.memoCache=l,c=l.data[l.index],c===void 0)for(c=l.data[l.index]=Array(s),d=0;d<s;d++)c[d]=M;return l.index++,c}function mi(s,l){return typeof l=="function"?l(s):l}function Gh(s){var l=Lr();return _g(l,ar,s)}function _g(s,l,c){var d=s.queue;if(d===null)throw Error(n(311));d.lastRenderedReducer=c;var v=s.baseQueue,_=d.pending;if(_!==null){if(v!==null){var C=v.next;v.next=_.next,_.next=C}l.baseQueue=v=_,d.pending=null}if(_=s.baseState,v===null)s.memoizedState=_;else{l=v.next;var V=C=null,ae=null,pe=l,ke=!1;do{var Oe=pe.lane&-536870913;if(Oe!==pe.lane?(Ct&Oe)===Oe:(di&Oe)===Oe){var ve=pe.revertLane;if(ve===0)ae!==null&&(ae=ae.next={lane:0,revertLane:0,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),Oe===Dc&&(ke=!0);else if((di&ve)===ve){pe=pe.next,ve===Dc&&(ke=!0);continue}else Oe={lane:0,revertLane:pe.revertLane,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},ae===null?(V=ae=Oe,C=_):ae=ae.next=Oe,_t.lanes|=ve,hl|=ve;Oe=pe.action,Io&&c(_,Oe),_=pe.hasEagerState?pe.eagerState:c(_,Oe)}else ve={lane:Oe,revertLane:pe.revertLane,gesture:pe.gesture,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},ae===null?(V=ae=ve,C=_):ae=ae.next=ve,_t.lanes|=Oe,hl|=Oe;pe=pe.next}while(pe!==null&&pe!==l);if(ae===null?C=_:ae.next=V,!va(_,s.memoizedState)&&(Wr=!0,ke&&(c=Oc,c!==null)))throw c;s.memoizedState=_,s.baseState=C,s.baseQueue=ae,d.lastRenderedState=_}return v===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function bg(s){var l=Lr(),c=l.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var d=c.dispatch,v=c.pending,_=l.memoizedState;if(v!==null){c.pending=null;var C=v=v.next;do _=s(_,C.action),C=C.next;while(C!==v);va(_,l.memoizedState)||(Wr=!0),l.memoizedState=_,l.baseQueue===null&&(l.baseState=_),c.lastRenderedState=_}return[_,d]}function r2(s,l,c){var d=_t,v=Lr(),_=Ft;if(_){if(c===void 0)throw Error(n(407));c=c()}else c=l();var C=!va((ar||v).memoizedState,c);if(C&&(v.memoizedState=c,Wr=!0),v=v.queue,Tg(s2.bind(null,d,v,s),[s]),v.getSnapshot!==l||C||Gr!==null&&Gr.memoizedState.tag&1){if(d.flags|=2048,Bc(9,{destroy:void 0},a2.bind(null,d,v,c,l),null),ur===null)throw Error(n(349));_||(di&127)!==0||n2(d,l,c)}return c}function n2(s,l,c){s.flags|=16384,s={getSnapshot:l,value:c},l=_t.updateQueue,l===null?(l=Hh(),_t.updateQueue=l,l.stores=[s]):(c=l.stores,c===null?l.stores=[s]:c.push(s))}function a2(s,l,c,d){l.value=c,l.getSnapshot=d,i2(l)&&l2(s)}function s2(s,l,c){return c(function(){i2(l)&&l2(s)})}function i2(s){var l=s.getSnapshot;s=s.value;try{var c=l();return!va(s,c)}catch{return!0}}function l2(s){var l=wo(s,2);l!==null&&sa(l,s,2)}function wg(s){var l=Wn();if(typeof s=="function"){var c=s;if(s=c(),Io){cn(!0);try{c()}finally{cn(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:s},l}function o2(s,l,c,d){return s.baseState=c,_g(s,ar,typeof d=="function"?d:mi)}function V3(s,l,c,d,v){if(Yh(s))throw Error(n(485));if(s=l.action,s!==null){var _={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(C){_.listeners.push(C)}};ne.T!==null?c(!0):_.isTransition=!1,d(_),c=l.pending,c===null?(_.next=l.pending=_,c2(l,_)):(_.next=c.next,l.pending=c.next=_)}}function c2(s,l){var c=l.action,d=l.payload,v=s.state;if(l.isTransition){var _=ne.T,C={};ne.T=C;try{var V=c(v,d),ae=ne.S;ae!==null&&ae(C,V),u2(s,l,V)}catch(pe){Eg(s,l,pe)}finally{_!==null&&C.types!==null&&(_.types=C.types),ne.T=_}}else try{_=c(v,d),u2(s,l,_)}catch(pe){Eg(s,l,pe)}}function u2(s,l,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(d){f2(s,l,d)},function(d){return Eg(s,l,d)}):f2(s,l,c)}function f2(s,l,c){l.status="fulfilled",l.value=c,h2(l),s.state=c,l=s.pending,l!==null&&(c=l.next,c===l?s.pending=null:(c=c.next,l.next=c,c2(s,c)))}function Eg(s,l,c){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do l.status="rejected",l.reason=c,h2(l),l=l.next;while(l!==d)}s.action=null}function h2(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function d2(s,l){return l}function m2(s,l){if(Ft){var c=ur.formState;if(c!==null){e:{var d=_t;if(Ft){if(pr){t:{for(var v=pr,_=Ua;v.nodeType!==8;){if(!_){v=null;break t}if(v=Ha(v.nextSibling),v===null){v=null;break t}}_=v.data,v=_==="F!"||_==="F"?v:null}if(v){pr=Ha(v.nextSibling),d=v.data==="F!";break e}}nl(d)}d=!1}d&&(l=c[0])}}return c=Wn(),c.memoizedState=c.baseState=l,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d2,lastRenderedState:l},c.queue=d,c=O2.bind(null,_t,d),d.dispatch=c,d=wg(!1),_=Cg.bind(null,_t,!1,d.queue),d=Wn(),v={state:l,dispatch:null,action:s,pending:null},d.queue=v,c=V3.bind(null,_t,v,_,c),v.dispatch=c,d.memoizedState=s,[l,c,!1]}function p2(s){var l=Lr();return g2(l,ar,s)}function g2(s,l,c){if(l=_g(s,l,d2)[0],s=Gh(mi)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var d=mf(l)}catch(C){throw C===Fc?jh:C}else d=l;l=Lr();var v=l.queue,_=v.dispatch;return c!==l.memoizedState&&(_t.flags|=2048,Bc(9,{destroy:void 0},U3.bind(null,v,c),null)),[d,_,s]}function U3(s,l){s.action=l}function x2(s){var l=Lr(),c=ar;if(c!==null)return g2(l,c,s);Lr(),l=l.memoizedState,c=Lr();var d=c.queue.dispatch;return c.memoizedState=s,[l,d,!1]}function Bc(s,l,c,d){return s={tag:s,create:c,deps:d,inst:l,next:null},l=_t.updateQueue,l===null&&(l=Hh(),_t.updateQueue=l),c=l.lastEffect,c===null?l.lastEffect=s.next=s:(d=c.next,c.next=s,s.next=d,l.lastEffect=s),s}function v2(){return Lr().memoizedState}function Wh(s,l,c,d){var v=Wn();_t.flags|=s,v.memoizedState=Bc(1|l,{destroy:void 0},c,d===void 0?null:d)}function Xh(s,l,c,d){var v=Lr();d=d===void 0?null:d;var _=v.memoizedState.inst;ar!==null&&d!==null&&mg(d,ar.memoizedState.deps)?v.memoizedState=Bc(l,_,c,d):(_t.flags|=s,v.memoizedState=Bc(1|l,_,c,d))}function y2(s,l){Wh(8390656,8,s,l)}function Tg(s,l){Xh(2048,8,s,l)}function z3(s){_t.flags|=4;var l=_t.updateQueue;if(l===null)l=Hh(),_t.updateQueue=l,l.events=[s];else{var c=l.events;c===null?l.events=[s]:c.push(s)}}function _2(s){var l=Lr().memoizedState;return z3({ref:l,nextImpl:s}),function(){if((Gt&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function b2(s,l){return Xh(4,2,s,l)}function w2(s,l){return Xh(4,4,s,l)}function E2(s,l){if(typeof l=="function"){s=s();var c=l(s);return function(){typeof c=="function"?c():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function T2(s,l,c){c=c!=null?c.concat([s]):null,Xh(4,4,E2.bind(null,l,s),c)}function Sg(){}function S2(s,l){var c=Lr();l=l===void 0?null:l;var d=c.memoizedState;return l!==null&&mg(l,d[1])?d[0]:(c.memoizedState=[s,l],s)}function A2(s,l){var c=Lr();l=l===void 0?null:l;var d=c.memoizedState;if(l!==null&&mg(l,d[1]))return d[0];if(d=s(),Io){cn(!0);try{s()}finally{cn(!1)}}return c.memoizedState=[d,l],d}function Ag(s,l,c){return c===void 0||(di&1073741824)!==0&&(Ct&261930)===0?s.memoizedState=l:(s.memoizedState=c,s=kb(),_t.lanes|=s,hl|=s,c)}function k2(s,l,c,d){return va(c,l)?c:Pc.current!==null?(s=Ag(s,c,d),va(s,l)||(Wr=!0),s):(di&42)===0||(di&1073741824)!==0&&(Ct&261930)===0?(Wr=!0,s.memoizedState=c):(s=kb(),_t.lanes|=s,hl|=s,l)}function N2(s,l,c,d,v){var _=se.p;se.p=_!==0&&8>_?_:8;var C=ne.T,V={};ne.T=V,Cg(s,!1,l,c);try{var ae=v(),pe=ne.S;if(pe!==null&&pe(V,ae),ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var ke=M3(ae,d);pf(s,l,ke,Ta(s))}else pf(s,l,d,Ta(s))}catch(Oe){pf(s,l,{then:function(){},status:"rejected",reason:Oe},Ta())}finally{se.p=_,C!==null&&V.types!==null&&(C.types=V.types),ne.T=C}}function H3(){}function kg(s,l,c,d){if(s.tag!==5)throw Error(n(476));var v=C2(s).queue;N2(s,v,l,Ee,c===null?H3:function(){return R2(s),c(d)})}function C2(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:Ee,baseState:Ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:Ee},next:null};var c={};return l.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:c},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function R2(s){var l=C2(s);l.next===null&&(l=s.alternate.memoizedState),pf(s,l.next.queue,{},Ta())}function Ng(){return vn(Df)}function I2(){return Lr().memoizedState}function D2(){return Lr().memoizedState}function q3(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var c=Ta();s=il(c);var d=ll(l,s,c);d!==null&&(sa(d,l,c),uf(d,l,c)),l={cache:ng()},s.payload=l;return}l=l.return}}function G3(s,l,c){var d=Ta();c={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Yh(s)?F2(l,c):(c=Wp(s,l,c,d),c!==null&&(sa(c,s,d),j2(c,l,d)))}function O2(s,l,c){var d=Ta();pf(s,l,c,d)}function pf(s,l,c,d){var v={lane:d,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Yh(s))F2(l,v);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=l.lastRenderedReducer,_!==null))try{var C=l.lastRenderedState,V=_(C,c);if(v.hasEagerState=!0,v.eagerState=V,va(V,C))return Nh(s,l,v,0),ur===null&&kh(),!1}catch{}finally{}if(c=Wp(s,l,v,d),c!==null)return sa(c,s,d),j2(c,l,d),!0}return!1}function Cg(s,l,c,d){if(d={lane:2,revertLane:l1(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},Yh(s)){if(l)throw Error(n(479))}else l=Wp(s,c,d,2),l!==null&&sa(l,s,2)}function Yh(s){var l=s.alternate;return s===_t||l!==null&&l===_t}function F2(s,l){Mc=Uh=!0;var c=s.pending;c===null?l.next=l:(l.next=c.next,c.next=l),s.pending=l}function j2(s,l,c){if((c&4194048)!==0){var d=l.lanes;d&=s.pendingLanes,c|=d,l.lanes=c,ai(s,c)}}var gf={readContext:vn,use:qh,useCallback:Rr,useContext:Rr,useEffect:Rr,useImperativeHandle:Rr,useLayoutEffect:Rr,useInsertionEffect:Rr,useMemo:Rr,useReducer:Rr,useRef:Rr,useState:Rr,useDebugValue:Rr,useDeferredValue:Rr,useTransition:Rr,useSyncExternalStore:Rr,useId:Rr,useHostTransitionStatus:Rr,useFormState:Rr,useActionState:Rr,useOptimistic:Rr,useMemoCache:Rr,useCacheRefresh:Rr};gf.useEffectEvent=Rr;var P2={readContext:vn,use:qh,useCallback:function(s,l){return Wn().memoizedState=[s,l===void 0?null:l],s},useContext:vn,useEffect:y2,useImperativeHandle:function(s,l,c){c=c!=null?c.concat([s]):null,Wh(4194308,4,E2.bind(null,l,s),c)},useLayoutEffect:function(s,l){return Wh(4194308,4,s,l)},useInsertionEffect:function(s,l){Wh(4,2,s,l)},useMemo:function(s,l){var c=Wn();l=l===void 0?null:l;var d=s();if(Io){cn(!0);try{s()}finally{cn(!1)}}return c.memoizedState=[d,l],d},useReducer:function(s,l,c){var d=Wn();if(c!==void 0){var v=c(l);if(Io){cn(!0);try{c(l)}finally{cn(!1)}}}else v=l;return d.memoizedState=d.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},d.queue=s,s=s.dispatch=G3.bind(null,_t,s),[d.memoizedState,s]},useRef:function(s){var l=Wn();return s={current:s},l.memoizedState=s},useState:function(s){s=wg(s);var l=s.queue,c=O2.bind(null,_t,l);return l.dispatch=c,[s.memoizedState,c]},useDebugValue:Sg,useDeferredValue:function(s,l){var c=Wn();return Ag(c,s,l)},useTransition:function(){var s=wg(!1);return s=N2.bind(null,_t,s.queue,!0,!1),Wn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,c){var d=_t,v=Wn();if(Ft){if(c===void 0)throw Error(n(407));c=c()}else{if(c=l(),ur===null)throw Error(n(349));(Ct&127)!==0||n2(d,l,c)}v.memoizedState=c;var _={value:c,getSnapshot:l};return v.queue=_,y2(s2.bind(null,d,_,s),[s]),d.flags|=2048,Bc(9,{destroy:void 0},a2.bind(null,d,_,c,l),null),c},useId:function(){var s=Wn(),l=ur.identifierPrefix;if(Ft){var c=js,d=Fs;c=(d&~(1<<32-mr(d)-1)).toString(32)+c,l="_"+l+"R_"+c,c=zh++,0<c&&(l+="H"+c.toString(32)),l+="_"}else c=L3++,l="_"+l+"r_"+c.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:Ng,useFormState:m2,useActionState:m2,useOptimistic:function(s){var l=Wn();l.memoizedState=l.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=c,l=Cg.bind(null,_t,!0,c),c.dispatch=l,[s,l]},useMemoCache:yg,useCacheRefresh:function(){return Wn().memoizedState=q3.bind(null,_t)},useEffectEvent:function(s){var l=Wn(),c={impl:s};return l.memoizedState=c,function(){if((Gt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},Rg={readContext:vn,use:qh,useCallback:S2,useContext:vn,useEffect:Tg,useImperativeHandle:T2,useInsertionEffect:b2,useLayoutEffect:w2,useMemo:A2,useReducer:Gh,useRef:v2,useState:function(){return Gh(mi)},useDebugValue:Sg,useDeferredValue:function(s,l){var c=Lr();return k2(c,ar.memoizedState,s,l)},useTransition:function(){var s=Gh(mi)[0],l=Lr().memoizedState;return[typeof s=="boolean"?s:mf(s),l]},useSyncExternalStore:r2,useId:I2,useHostTransitionStatus:Ng,useFormState:p2,useActionState:p2,useOptimistic:function(s,l){var c=Lr();return o2(c,ar,s,l)},useMemoCache:yg,useCacheRefresh:D2};Rg.useEffectEvent=_2;var M2={readContext:vn,use:qh,useCallback:S2,useContext:vn,useEffect:Tg,useImperativeHandle:T2,useInsertionEffect:b2,useLayoutEffect:w2,useMemo:A2,useReducer:bg,useRef:v2,useState:function(){return bg(mi)},useDebugValue:Sg,useDeferredValue:function(s,l){var c=Lr();return ar===null?Ag(c,s,l):k2(c,ar.memoizedState,s,l)},useTransition:function(){var s=bg(mi)[0],l=Lr().memoizedState;return[typeof s=="boolean"?s:mf(s),l]},useSyncExternalStore:r2,useId:I2,useHostTransitionStatus:Ng,useFormState:x2,useActionState:x2,useOptimistic:function(s,l){var c=Lr();return ar!==null?o2(c,ar,s,l):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:yg,useCacheRefresh:D2};M2.useEffectEvent=_2;function Ig(s,l,c,d){l=s.memoizedState,c=c(d,l),c=c==null?l:x({},l,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Dg={enqueueSetState:function(s,l,c){s=s._reactInternals;var d=Ta(),v=il(d);v.payload=l,c!=null&&(v.callback=c),l=ll(s,v,d),l!==null&&(sa(l,s,d),uf(l,s,d))},enqueueReplaceState:function(s,l,c){s=s._reactInternals;var d=Ta(),v=il(d);v.tag=1,v.payload=l,c!=null&&(v.callback=c),l=ll(s,v,d),l!==null&&(sa(l,s,d),uf(l,s,d))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var c=Ta(),d=il(c);d.tag=2,l!=null&&(d.callback=l),l=ll(s,d,c),l!==null&&(sa(l,s,c),uf(l,s,c))}};function L2(s,l,c,d,v,_,C){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,_,C):l.prototype&&l.prototype.isPureReactComponent?!tf(c,d)||!tf(v,_):!0}function B2(s,l,c,d){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(c,d),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(c,d),l.state!==s&&Dg.enqueueReplaceState(l,l.state,null)}function Do(s,l){var c=l;if("ref"in l){c={};for(var d in l)d!=="ref"&&(c[d]=l[d])}if(s=s.defaultProps){c===l&&(c=x({},c));for(var v in s)c[v]===void 0&&(c[v]=s[v])}return c}function V2(s){Ah(s)}function U2(s){console.error(s)}function z2(s){Ah(s)}function $h(s,l){try{var c=s.onUncaughtError;c(l.value,{componentStack:l.stack})}catch(d){setTimeout(function(){throw d})}}function H2(s,l,c){try{var d=s.onCaughtError;d(c.value,{componentStack:c.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function Og(s,l,c){return c=il(c),c.tag=3,c.payload={element:null},c.callback=function(){$h(s,l)},c}function q2(s){return s=il(s),s.tag=3,s}function G2(s,l,c,d){var v=c.type.getDerivedStateFromError;if(typeof v=="function"){var _=d.value;s.payload=function(){return v(_)},s.callback=function(){H2(l,c,d)}}var C=c.stateNode;C!==null&&typeof C.componentDidCatch=="function"&&(s.callback=function(){H2(l,c,d),typeof v!="function"&&(dl===null?dl=new Set([this]):dl.add(this));var V=d.stack;this.componentDidCatch(d.value,{componentStack:V!==null?V:""})})}function W3(s,l,c,d,v){if(c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(l=c.alternate,l!==null&&Ic(l,c,v,!0),c=_a.current,c!==null){switch(c.tag){case 31:case 13:return za===null?ld():c.alternate===null&&Ir===0&&(Ir=3),c.flags&=-257,c.flags|=65536,c.lanes=v,d===Ph?c.flags|=16384:(l=c.updateQueue,l===null?c.updateQueue=new Set([d]):l.add(d),a1(s,d,v)),!1;case 22:return c.flags|=65536,d===Ph?c.flags|=16384:(l=c.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([d])},c.updateQueue=l):(c=l.retryQueue,c===null?l.retryQueue=new Set([d]):c.add(d)),a1(s,d,v)),!1}throw Error(n(435,c.tag))}return a1(s,d,v),ld(),!1}if(Ft)return l=_a.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=v,d!==Jp&&(s=Error(n(422),{cause:d}),af(La(s,c)))):(d!==Jp&&(l=Error(n(423),{cause:d}),af(La(l,c))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,d=La(d,c),v=Og(s.stateNode,d,v),cg(s,v),Ir!==4&&(Ir=2)),!1;var _=Error(n(520),{cause:d});if(_=La(_,c),Tf===null?Tf=[_]:Tf.push(_),Ir!==4&&(Ir=2),l===null)return!0;d=La(d,c),c=l;do{switch(c.tag){case 3:return c.flags|=65536,s=v&-v,c.lanes|=s,s=Og(c.stateNode,d,s),cg(c,s),!1;case 1:if(l=c.type,_=c.stateNode,(c.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(dl===null||!dl.has(_))))return c.flags|=65536,v&=-v,c.lanes|=v,v=q2(v),G2(v,s,c,d),cg(c,v),!1}c=c.return}while(c!==null);return!1}var Fg=Error(n(461)),Wr=!1;function yn(s,l,c,d){l.child=s===null?$_(l,null,c,d):Ro(l,s.child,c,d)}function W2(s,l,c,d,v){c=c.render;var _=l.ref;if("ref"in d){var C={};for(var V in d)V!=="ref"&&(C[V]=d[V])}else C=d;return Ao(l),d=pg(s,l,c,C,_,v),V=gg(),s!==null&&!Wr?(xg(s,l,v),pi(s,l,v)):(Ft&&V&&Kp(l),l.flags|=1,yn(s,l,d,v),l.child)}function X2(s,l,c,d,v){if(s===null){var _=c.type;return typeof _=="function"&&!Xp(_)&&_.defaultProps===void 0&&c.compare===null?(l.tag=15,l.type=_,Y2(s,l,_,d,v)):(s=Rh(c.type,null,d,l,l.mode,v),s.ref=l.ref,s.return=l,l.child=s)}if(_=s.child,!zg(s,v)){var C=_.memoizedProps;if(c=c.compare,c=c!==null?c:tf,c(C,d)&&s.ref===l.ref)return pi(s,l,v)}return l.flags|=1,s=ci(_,d),s.ref=l.ref,s.return=l,l.child=s}function Y2(s,l,c,d,v){if(s!==null){var _=s.memoizedProps;if(tf(_,d)&&s.ref===l.ref)if(Wr=!1,l.pendingProps=d=_,zg(s,v))(s.flags&131072)!==0&&(Wr=!0);else return l.lanes=s.lanes,pi(s,l,v)}return jg(s,l,c,d,v)}function $2(s,l,c,d){var v=d.children,_=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((l.flags&128)!==0){if(_=_!==null?_.baseLanes|c:c,s!==null){for(d=l.child=s.child,v=0;d!==null;)v=v|d.lanes|d.childLanes,d=d.sibling;d=v&~_}else d=0,l.child=null;return K2(s,l,_,c,d)}if((c&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Fh(l,_!==null?_.cachePool:null),_!==null?J_(l,_):fg(),Z_(l);else return d=l.lanes=536870912,K2(s,l,_!==null?_.baseLanes|c:c,c,d)}else _!==null?(Fh(l,_.cachePool),J_(l,_),cl(),l.memoizedState=null):(s!==null&&Fh(l,null),fg(),cl());return yn(s,l,v,c),l.child}function xf(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function K2(s,l,c,d,v){var _=sg();return _=_===null?null:{parent:qr._currentValue,pool:_},l.memoizedState={baseLanes:c,cachePool:_},s!==null&&Fh(l,null),fg(),Z_(l),s!==null&&Ic(s,l,d,!0),l.childLanes=v,null}function Kh(s,l){return l=Jh({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function Q2(s,l,c){return Ro(l,s.child,null,c),s=Kh(l,l.pendingProps),s.flags|=2,ba(l),l.memoizedState=null,s}function X3(s,l,c){var d=l.pendingProps,v=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(Ft){if(d.mode==="hidden")return s=Kh(l,d),l.lanes=536870912,xf(null,s);if(dg(l),(s=pr)?(s=cw(s,Ua),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:tl!==null?{id:Fs,overflow:js}:null,retryLane:536870912,hydrationErrors:null},c=F_(s),c.return=l,l.child=c,xn=l,pr=null)):s=null,s===null)throw nl(l);return l.lanes=536870912,null}return Kh(l,d)}var _=s.memoizedState;if(_!==null){var C=_.dehydrated;if(dg(l),v)if(l.flags&256)l.flags&=-257,l=Q2(s,l,c);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(n(558));else if(Wr||Ic(s,l,c,!1),v=(c&s.childLanes)!==0,Wr||v){if(d=ur,d!==null&&(C=co(d,c),C!==0&&C!==_.retryLane))throw _.retryLane=C,wo(s,C),sa(d,s,C),Fg;ld(),l=Q2(s,l,c)}else s=_.treeContext,pr=Ha(C.nextSibling),xn=l,Ft=!0,rl=null,Ua=!1,s!==null&&M_(l,s),l=Kh(l,d),l.flags|=4096;return l}return s=ci(s.child,{mode:d.mode,children:d.children}),s.ref=l.ref,l.child=s,s.return=l,s}function Qh(s,l){var c=l.ref;if(c===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(s===null||s.ref!==c)&&(l.flags|=4194816)}}function jg(s,l,c,d,v){return Ao(l),c=pg(s,l,c,d,void 0,v),d=gg(),s!==null&&!Wr?(xg(s,l,v),pi(s,l,v)):(Ft&&d&&Kp(l),l.flags|=1,yn(s,l,c,v),l.child)}function J2(s,l,c,d,v,_){return Ao(l),l.updateQueue=null,c=t2(l,d,c,v),e2(s),d=gg(),s!==null&&!Wr?(xg(s,l,_),pi(s,l,_)):(Ft&&d&&Kp(l),l.flags|=1,yn(s,l,c,_),l.child)}function Z2(s,l,c,d,v){if(Ao(l),l.stateNode===null){var _=kc,C=c.contextType;typeof C=="object"&&C!==null&&(_=vn(C)),_=new c(d,_),l.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Dg,l.stateNode=_,_._reactInternals=l,_=l.stateNode,_.props=d,_.state=l.memoizedState,_.refs={},lg(l),C=c.contextType,_.context=typeof C=="object"&&C!==null?vn(C):kc,_.state=l.memoizedState,C=c.getDerivedStateFromProps,typeof C=="function"&&(Ig(l,c,C,d),_.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(C=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),C!==_.state&&Dg.enqueueReplaceState(_,_.state,null),hf(l,d,_,v),ff(),_.state=l.memoizedState),typeof _.componentDidMount=="function"&&(l.flags|=4194308),d=!0}else if(s===null){_=l.stateNode;var V=l.memoizedProps,ae=Do(c,V);_.props=ae;var pe=_.context,ke=c.contextType;C=kc,typeof ke=="object"&&ke!==null&&(C=vn(ke));var Oe=c.getDerivedStateFromProps;ke=typeof Oe=="function"||typeof _.getSnapshotBeforeUpdate=="function",V=l.pendingProps!==V,ke||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(V||pe!==C)&&B2(l,_,d,C),sl=!1;var ve=l.memoizedState;_.state=ve,hf(l,d,_,v),ff(),pe=l.memoizedState,V||ve!==pe||sl?(typeof Oe=="function"&&(Ig(l,c,Oe,d),pe=l.memoizedState),(ae=sl||L2(l,c,ae,d,ve,pe,C))?(ke||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(l.flags|=4194308)):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=d,l.memoizedState=pe),_.props=d,_.state=pe,_.context=C,d=ae):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),d=!1)}else{_=l.stateNode,og(s,l),C=l.memoizedProps,ke=Do(c,C),_.props=ke,Oe=l.pendingProps,ve=_.context,pe=c.contextType,ae=kc,typeof pe=="object"&&pe!==null&&(ae=vn(pe)),V=c.getDerivedStateFromProps,(pe=typeof V=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(C!==Oe||ve!==ae)&&B2(l,_,d,ae),sl=!1,ve=l.memoizedState,_.state=ve,hf(l,d,_,v),ff();var we=l.memoizedState;C!==Oe||ve!==we||sl||s!==null&&s.dependencies!==null&&Dh(s.dependencies)?(typeof V=="function"&&(Ig(l,c,V,d),we=l.memoizedState),(ke=sl||L2(l,c,ke,d,ve,we,ae)||s!==null&&s.dependencies!==null&&Dh(s.dependencies))?(pe||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(d,we,ae),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(d,we,ae)),typeof _.componentDidUpdate=="function"&&(l.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof _.componentDidUpdate!="function"||C===s.memoizedProps&&ve===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&ve===s.memoizedState||(l.flags|=1024),l.memoizedProps=d,l.memoizedState=we),_.props=d,_.state=we,_.context=ae,d=ke):(typeof _.componentDidUpdate!="function"||C===s.memoizedProps&&ve===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||C===s.memoizedProps&&ve===s.memoizedState||(l.flags|=1024),d=!1)}return _=d,Qh(s,l),d=(l.flags&128)!==0,_||d?(_=l.stateNode,c=d&&typeof c.getDerivedStateFromError!="function"?null:_.render(),l.flags|=1,s!==null&&d?(l.child=Ro(l,s.child,null,v),l.child=Ro(l,null,c,v)):yn(s,l,c,v),l.memoizedState=_.state,s=l.child):s=pi(s,l,v),s}function eb(s,l,c,d){return To(),l.flags|=256,yn(s,l,c,d),l.child}var Pg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Mg(s){return{baseLanes:s,cachePool:H_()}}function Lg(s,l,c){return s=s!==null?s.childLanes&~c:0,l&&(s|=Ea),s}function tb(s,l,c){var d=l.pendingProps,v=!1,_=(l.flags&128)!==0,C;if((C=_)||(C=s!==null&&s.memoizedState===null?!1:(Mr.current&2)!==0),C&&(v=!0,l.flags&=-129),C=(l.flags&32)!==0,l.flags&=-33,s===null){if(Ft){if(v?ol(l):cl(),(s=pr)?(s=cw(s,Ua),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:tl!==null?{id:Fs,overflow:js}:null,retryLane:536870912,hydrationErrors:null},c=F_(s),c.return=l,l.child=c,xn=l,pr=null)):s=null,s===null)throw nl(l);return _1(s)?l.lanes=32:l.lanes=536870912,null}var V=d.children;return d=d.fallback,v?(cl(),v=l.mode,V=Jh({mode:"hidden",children:V},v),d=Eo(d,v,c,null),V.return=l,d.return=l,V.sibling=d,l.child=V,d=l.child,d.memoizedState=Mg(c),d.childLanes=Lg(s,C,c),l.memoizedState=Pg,xf(null,d)):(ol(l),Bg(l,V))}var ae=s.memoizedState;if(ae!==null&&(V=ae.dehydrated,V!==null)){if(_)l.flags&256?(ol(l),l.flags&=-257,l=Vg(s,l,c)):l.memoizedState!==null?(cl(),l.child=s.child,l.flags|=128,l=null):(cl(),V=d.fallback,v=l.mode,d=Jh({mode:"visible",children:d.children},v),V=Eo(V,v,c,null),V.flags|=2,d.return=l,V.return=l,d.sibling=V,l.child=d,Ro(l,s.child,null,c),d=l.child,d.memoizedState=Mg(c),d.childLanes=Lg(s,C,c),l.memoizedState=Pg,l=xf(null,d));else if(ol(l),_1(V)){if(C=V.nextSibling&&V.nextSibling.dataset,C)var pe=C.dgst;C=pe,d=Error(n(419)),d.stack="",d.digest=C,af({value:d,source:null,stack:null}),l=Vg(s,l,c)}else if(Wr||Ic(s,l,c,!1),C=(c&s.childLanes)!==0,Wr||C){if(C=ur,C!==null&&(d=co(C,c),d!==0&&d!==ae.retryLane))throw ae.retryLane=d,wo(s,d),sa(C,s,d),Fg;y1(V)||ld(),l=Vg(s,l,c)}else y1(V)?(l.flags|=192,l.child=s.child,l=null):(s=ae.treeContext,pr=Ha(V.nextSibling),xn=l,Ft=!0,rl=null,Ua=!1,s!==null&&M_(l,s),l=Bg(l,d.children),l.flags|=4096);return l}return v?(cl(),V=d.fallback,v=l.mode,ae=s.child,pe=ae.sibling,d=ci(ae,{mode:"hidden",children:d.children}),d.subtreeFlags=ae.subtreeFlags&65011712,pe!==null?V=ci(pe,V):(V=Eo(V,v,c,null),V.flags|=2),V.return=l,d.return=l,d.sibling=V,l.child=d,xf(null,d),d=l.child,V=s.child.memoizedState,V===null?V=Mg(c):(v=V.cachePool,v!==null?(ae=qr._currentValue,v=v.parent!==ae?{parent:ae,pool:ae}:v):v=H_(),V={baseLanes:V.baseLanes|c,cachePool:v}),d.memoizedState=V,d.childLanes=Lg(s,C,c),l.memoizedState=Pg,xf(s.child,d)):(ol(l),c=s.child,s=c.sibling,c=ci(c,{mode:"visible",children:d.children}),c.return=l,c.sibling=null,s!==null&&(C=l.deletions,C===null?(l.deletions=[s],l.flags|=16):C.push(s)),l.child=c,l.memoizedState=null,c)}function Bg(s,l){return l=Jh({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Jh(s,l){return s=ya(22,s,null,l),s.lanes=0,s}function Vg(s,l,c){return Ro(l,s.child,null,c),s=Bg(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function rb(s,l,c){s.lanes|=l;var d=s.alternate;d!==null&&(d.lanes|=l),tg(s.return,l,c)}function Ug(s,l,c,d,v,_){var C=s.memoizedState;C===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:v,treeForkCount:_}:(C.isBackwards=l,C.rendering=null,C.renderingStartTime=0,C.last=d,C.tail=c,C.tailMode=v,C.treeForkCount=_)}function nb(s,l,c){var d=l.pendingProps,v=d.revealOrder,_=d.tail;d=d.children;var C=Mr.current,V=(C&2)!==0;if(V?(C=C&1|2,l.flags|=128):C&=1,G(Mr,C),yn(s,l,d,c),d=Ft?nf:0,!V&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&rb(s,c,l);else if(s.tag===19)rb(s,c,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(c=l.child,v=null;c!==null;)s=c.alternate,s!==null&&Vh(s)===null&&(v=c),c=c.sibling;c=v,c===null?(v=l.child,l.child=null):(v=c.sibling,c.sibling=null),Ug(l,!1,v,c,_,d);break;case"backwards":case"unstable_legacy-backwards":for(c=null,v=l.child,l.child=null;v!==null;){if(s=v.alternate,s!==null&&Vh(s)===null){l.child=v;break}s=v.sibling,v.sibling=c,c=v,v=s}Ug(l,!0,c,null,_,d);break;case"together":Ug(l,!1,null,null,void 0,d);break;default:l.memoizedState=null}return l.child}function pi(s,l,c){if(s!==null&&(l.dependencies=s.dependencies),hl|=l.lanes,(c&l.childLanes)===0)if(s!==null){if(Ic(s,l,c,!1),(c&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(n(153));if(l.child!==null){for(s=l.child,c=ci(s,s.pendingProps),l.child=c,c.return=l;s.sibling!==null;)s=s.sibling,c=c.sibling=ci(s,s.pendingProps),c.return=l;c.sibling=null}return l.child}function zg(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Dh(s)))}function Y3(s,l,c){switch(l.tag){case 3:Fe(l,l.stateNode.containerInfo),al(l,qr,s.memoizedState.cache),To();break;case 27:case 5:De(l);break;case 4:Fe(l,l.stateNode.containerInfo);break;case 10:al(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,dg(l),null;break;case 13:var d=l.memoizedState;if(d!==null)return d.dehydrated!==null?(ol(l),l.flags|=128,null):(c&l.child.childLanes)!==0?tb(s,l,c):(ol(l),s=pi(s,l,c),s!==null?s.sibling:null);ol(l);break;case 19:var v=(s.flags&128)!==0;if(d=(c&l.childLanes)!==0,d||(Ic(s,l,c,!1),d=(c&l.childLanes)!==0),v){if(d)return nb(s,l,c);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),G(Mr,Mr.current),d)break;return null;case 22:return l.lanes=0,$2(s,l,c,l.pendingProps);case 24:al(l,qr,s.memoizedState.cache)}return pi(s,l,c)}function ab(s,l,c){if(s!==null)if(s.memoizedProps!==l.pendingProps)Wr=!0;else{if(!zg(s,c)&&(l.flags&128)===0)return Wr=!1,Y3(s,l,c);Wr=(s.flags&131072)!==0}else Wr=!1,Ft&&(l.flags&1048576)!==0&&P_(l,nf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var d=l.pendingProps;if(s=No(l.elementType),l.type=s,typeof s=="function")Xp(s)?(d=Do(s,d),l.tag=1,l=Z2(null,l,s,d,c)):(l.tag=0,l=jg(null,l,s,d,c));else{if(s!=null){var v=s.$$typeof;if(v===z){l.tag=11,l=W2(null,l,s,d,c);break e}else if(v===A){l.tag=14,l=X2(null,l,s,d,c);break e}}throw l=Ne(s)||s,Error(n(306,l,""))}}return l;case 0:return jg(s,l,l.type,l.pendingProps,c);case 1:return d=l.type,v=Do(d,l.pendingProps),Z2(s,l,d,v,c);case 3:e:{if(Fe(l,l.stateNode.containerInfo),s===null)throw Error(n(387));d=l.pendingProps;var _=l.memoizedState;v=_.element,og(s,l),hf(l,d,null,c);var C=l.memoizedState;if(d=C.cache,al(l,qr,d),d!==_.cache&&rg(l,[qr],c,!0),ff(),d=C.element,_.isDehydrated)if(_={element:d,isDehydrated:!1,cache:C.cache},l.updateQueue.baseState=_,l.memoizedState=_,l.flags&256){l=eb(s,l,d,c);break e}else if(d!==v){v=La(Error(n(424)),l),af(v),l=eb(s,l,d,c);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(pr=Ha(s.firstChild),xn=l,Ft=!0,rl=null,Ua=!0,c=$_(l,null,d,c),l.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(To(),d===v){l=pi(s,l,c);break e}yn(s,l,d,c)}l=l.child}return l;case 26:return Qh(s,l),s===null?(c=pw(l.type,null,l.pendingProps,null))?l.memoizedState=c:Ft||(c=l.type,s=l.pendingProps,d=md(oe.current).createElement(c),d[K]=l,d[Q]=s,_n(d,c,s),Ze(d),l.stateNode=d):l.memoizedState=pw(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return De(l),s===null&&Ft&&(d=l.stateNode=hw(l.type,l.pendingProps,oe.current),xn=l,Ua=!0,v=pr,xl(l.type)?(b1=v,pr=Ha(d.firstChild)):pr=v),yn(s,l,l.pendingProps.children,c),Qh(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&Ft&&((v=d=pr)&&(d=T6(d,l.type,l.pendingProps,Ua),d!==null?(l.stateNode=d,xn=l,pr=Ha(d.firstChild),Ua=!1,v=!0):v=!1),v||nl(l)),De(l),v=l.type,_=l.pendingProps,C=s!==null?s.memoizedProps:null,d=_.children,g1(v,_)?d=null:C!==null&&g1(v,C)&&(l.flags|=32),l.memoizedState!==null&&(v=pg(s,l,B3,null,null,c),Df._currentValue=v),Qh(s,l),yn(s,l,d,c),l.child;case 6:return s===null&&Ft&&((s=c=pr)&&(c=S6(c,l.pendingProps,Ua),c!==null?(l.stateNode=c,xn=l,pr=null,s=!0):s=!1),s||nl(l)),null;case 13:return tb(s,l,c);case 4:return Fe(l,l.stateNode.containerInfo),d=l.pendingProps,s===null?l.child=Ro(l,null,d,c):yn(s,l,d,c),l.child;case 11:return W2(s,l,l.type,l.pendingProps,c);case 7:return yn(s,l,l.pendingProps,c),l.child;case 8:return yn(s,l,l.pendingProps.children,c),l.child;case 12:return yn(s,l,l.pendingProps.children,c),l.child;case 10:return d=l.pendingProps,al(l,l.type,d.value),yn(s,l,d.children,c),l.child;case 9:return v=l.type._context,d=l.pendingProps.children,Ao(l),v=vn(v),d=d(v),l.flags|=1,yn(s,l,d,c),l.child;case 14:return X2(s,l,l.type,l.pendingProps,c);case 15:return Y2(s,l,l.type,l.pendingProps,c);case 19:return nb(s,l,c);case 31:return X3(s,l,c);case 22:return $2(s,l,c,l.pendingProps);case 24:return Ao(l),d=vn(qr),s===null?(v=sg(),v===null&&(v=ur,_=ng(),v.pooledCache=_,_.refCount++,_!==null&&(v.pooledCacheLanes|=c),v=_),l.memoizedState={parent:d,cache:v},lg(l),al(l,qr,v)):((s.lanes&c)!==0&&(og(s,l),hf(l,null,null,c),ff()),v=s.memoizedState,_=l.memoizedState,v.parent!==d?(v={parent:d,cache:d},l.memoizedState=v,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=v),al(l,qr,d)):(d=_.cache,al(l,qr,d),d!==v.cache&&rg(l,[qr],c,!0))),yn(s,l,l.pendingProps.children,c),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function gi(s){s.flags|=4}function Hg(s,l,c,d,v){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(Ib())s.flags|=8192;else throw Co=Ph,ig}else s.flags&=-16777217}function sb(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!_w(l))if(Ib())s.flags|=8192;else throw Co=Ph,ig}function Zh(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?mc():536870912,s.lanes|=l,Hc|=l)}function vf(s,l){if(!Ft)switch(s.tailMode){case"hidden":l=s.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function gr(s){var l=s.alternate!==null&&s.alternate.child===s.child,c=0,d=0;if(l)for(var v=s.child;v!==null;)c|=v.lanes|v.childLanes,d|=v.subtreeFlags&65011712,d|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)c|=v.lanes|v.childLanes,d|=v.subtreeFlags,d|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=d,s.childLanes=c,l}function $3(s,l,c){var d=l.pendingProps;switch(Qp(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gr(l),null;case 1:return gr(l),null;case 3:return c=l.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),l.memoizedState.cache!==d&&(l.flags|=2048),hi(qr),Te(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(Rc(l)?gi(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Zp())),gr(l),null;case 26:var v=l.type,_=l.memoizedState;return s===null?(gi(l),_!==null?(gr(l),sb(l,_)):(gr(l),Hg(l,v,null,d,c))):_?_!==s.memoizedState?(gi(l),gr(l),sb(l,_)):(gr(l),l.flags&=-16777217):(s=s.memoizedProps,s!==d&&gi(l),gr(l),Hg(l,v,s,d,c)),null;case 27:if(rt(l),c=oe.current,v=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==d&&gi(l);else{if(!d){if(l.stateNode===null)throw Error(n(166));return gr(l),null}s=Y.current,Rc(l)?L_(l):(s=hw(v,d,c),l.stateNode=s,gi(l))}return gr(l),null;case 5:if(rt(l),v=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==d&&gi(l);else{if(!d){if(l.stateNode===null)throw Error(n(166));return gr(l),null}if(_=Y.current,Rc(l))L_(l);else{var C=md(oe.current);switch(_){case 1:_=C.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:_=C.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":_=C.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":_=C.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":_=C.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof d.is=="string"?C.createElement("select",{is:d.is}):C.createElement("select"),d.multiple?_.multiple=!0:d.size&&(_.size=d.size);break;default:_=typeof d.is=="string"?C.createElement(v,{is:d.is}):C.createElement(v)}}_[K]=l,_[Q]=d;e:for(C=l.child;C!==null;){if(C.tag===5||C.tag===6)_.appendChild(C.stateNode);else if(C.tag!==4&&C.tag!==27&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===l)break e;for(;C.sibling===null;){if(C.return===null||C.return===l)break e;C=C.return}C.sibling.return=C.return,C=C.sibling}l.stateNode=_;e:switch(_n(_,v,d),v){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}d&&gi(l)}}return gr(l),Hg(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,c),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==d&&gi(l);else{if(typeof d!="string"&&l.stateNode===null)throw Error(n(166));if(s=oe.current,Rc(l)){if(s=l.stateNode,c=l.memoizedProps,d=null,v=xn,v!==null)switch(v.tag){case 27:case 5:d=v.memoizedProps}s[K]=l,s=!!(s.nodeValue===c||d!==null&&d.suppressHydrationWarning===!0||tw(s.nodeValue,c)),s||nl(l,!0)}else s=md(s).createTextNode(d),s[K]=l,l.stateNode=s}return gr(l),null;case 31:if(c=l.memoizedState,s===null||s.memoizedState!==null){if(d=Rc(l),c!==null){if(s===null){if(!d)throw Error(n(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[K]=l}else To(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;gr(l),s=!1}else c=Zp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return l.flags&256?(ba(l),l):(ba(l),null);if((l.flags&128)!==0)throw Error(n(558))}return gr(l),null;case 13:if(d=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=Rc(l),d!==null&&d.dehydrated!==null){if(s===null){if(!v)throw Error(n(318));if(v=l.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[K]=l}else To(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;gr(l),v=!1}else v=Zp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return l.flags&256?(ba(l),l):(ba(l),null)}return ba(l),(l.flags&128)!==0?(l.lanes=c,l):(c=d!==null,s=s!==null&&s.memoizedState!==null,c&&(d=l.child,v=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(v=d.alternate.memoizedState.cachePool.pool),_=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(_=d.memoizedState.cachePool.pool),_!==v&&(d.flags|=2048)),c!==s&&c&&(l.child.flags|=8192),Zh(l,l.updateQueue),gr(l),null);case 4:return Te(),s===null&&f1(l.stateNode.containerInfo),gr(l),null;case 10:return hi(l.type),gr(l),null;case 19:if(P(Mr),d=l.memoizedState,d===null)return gr(l),null;if(v=(l.flags&128)!==0,_=d.rendering,_===null)if(v)vf(d,!1);else{if(Ir!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(_=Vh(s),_!==null){for(l.flags|=128,vf(d,!1),s=_.updateQueue,l.updateQueue=s,Zh(l,s),l.subtreeFlags=0,s=c,c=l.child;c!==null;)O_(c,s),c=c.sibling;return G(Mr,Mr.current&1|2),Ft&&ui(l,d.treeForkCount),l.child}s=s.sibling}d.tail!==null&&Ht()>ad&&(l.flags|=128,v=!0,vf(d,!1),l.lanes=4194304)}else{if(!v)if(s=Vh(_),s!==null){if(l.flags|=128,v=!0,s=s.updateQueue,l.updateQueue=s,Zh(l,s),vf(d,!0),d.tail===null&&d.tailMode==="hidden"&&!_.alternate&&!Ft)return gr(l),null}else 2*Ht()-d.renderingStartTime>ad&&c!==536870912&&(l.flags|=128,v=!0,vf(d,!1),l.lanes=4194304);d.isBackwards?(_.sibling=l.child,l.child=_):(s=d.last,s!==null?s.sibling=_:l.child=_,d.last=_)}return d.tail!==null?(s=d.tail,d.rendering=s,d.tail=s.sibling,d.renderingStartTime=Ht(),s.sibling=null,c=Mr.current,G(Mr,v?c&1|2:c&1),Ft&&ui(l,d.treeForkCount),s):(gr(l),null);case 22:case 23:return ba(l),hg(),d=l.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(l.flags|=8192):d&&(l.flags|=8192),d?(c&536870912)!==0&&(l.flags&128)===0&&(gr(l),l.subtreeFlags&6&&(l.flags|=8192)):gr(l),c=l.updateQueue,c!==null&&Zh(l,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),d=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(d=l.memoizedState.cachePool.pool),d!==c&&(l.flags|=2048),s!==null&&P(ko),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),l.memoizedState.cache!==c&&(l.flags|=2048),hi(qr),gr(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function K3(s,l){switch(Qp(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return hi(qr),Te(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return rt(l),null;case 31:if(l.memoizedState!==null){if(ba(l),l.alternate===null)throw Error(n(340));To()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(ba(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(n(340));To()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return P(Mr),null;case 4:return Te(),null;case 10:return hi(l.type),null;case 22:case 23:return ba(l),hg(),s!==null&&P(ko),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return hi(qr),null;case 25:return null;default:return null}}function ib(s,l){switch(Qp(l),l.tag){case 3:hi(qr),Te();break;case 26:case 27:case 5:rt(l);break;case 4:Te();break;case 31:l.memoizedState!==null&&ba(l);break;case 13:ba(l);break;case 19:P(Mr);break;case 10:hi(l.type);break;case 22:case 23:ba(l),hg(),s!==null&&P(ko);break;case 24:hi(qr)}}function yf(s,l){try{var c=l.updateQueue,d=c!==null?c.lastEffect:null;if(d!==null){var v=d.next;c=v;do{if((c.tag&s)===s){d=void 0;var _=c.create,C=c.inst;d=_(),C.destroy=d}c=c.next}while(c!==v)}}catch(V){Zt(l,l.return,V)}}function ul(s,l,c){try{var d=l.updateQueue,v=d!==null?d.lastEffect:null;if(v!==null){var _=v.next;d=_;do{if((d.tag&s)===s){var C=d.inst,V=C.destroy;if(V!==void 0){C.destroy=void 0,v=l;var ae=c,pe=V;try{pe()}catch(ke){Zt(v,ae,ke)}}}d=d.next}while(d!==_)}}catch(ke){Zt(l,l.return,ke)}}function lb(s){var l=s.updateQueue;if(l!==null){var c=s.stateNode;try{Q_(l,c)}catch(d){Zt(s,s.return,d)}}}function ob(s,l,c){c.props=Do(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(d){Zt(s,l,d)}}function _f(s,l){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof c=="function"?s.refCleanup=c(d):c.current=d}}catch(v){Zt(s,l,v)}}function Ps(s,l){var c=s.ref,d=s.refCleanup;if(c!==null)if(typeof d=="function")try{d()}catch(v){Zt(s,l,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(v){Zt(s,l,v)}else c.current=null}function cb(s){var l=s.type,c=s.memoizedProps,d=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":c.autoFocus&&d.focus();break e;case"img":c.src?d.src=c.src:c.srcSet&&(d.srcset=c.srcSet)}}catch(v){Zt(s,s.return,v)}}function qg(s,l,c){try{var d=s.stateNode;v6(d,s.type,c,l),d[Q]=l}catch(v){Zt(s,s.return,v)}}function ub(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&xl(s.type)||s.tag===4}function Gg(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||ub(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&xl(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Wg(s,l,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,l?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,l):(l=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,l.appendChild(s),c=c._reactRootContainer,c!=null||l.onclick!==null||(l.onclick=os));else if(d!==4&&(d===27&&xl(s.type)&&(c=s.stateNode,l=null),s=s.child,s!==null))for(Wg(s,l,c),s=s.sibling;s!==null;)Wg(s,l,c),s=s.sibling}function ed(s,l,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,l?c.insertBefore(s,l):c.appendChild(s);else if(d!==4&&(d===27&&xl(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(ed(s,l,c),s=s.sibling;s!==null;)ed(s,l,c),s=s.sibling}function fb(s){var l=s.stateNode,c=s.memoizedProps;try{for(var d=s.type,v=l.attributes;v.length;)l.removeAttributeNode(v[0]);_n(l,d,c),l[K]=s,l[Q]=c}catch(_){Zt(s,s.return,_)}}var xi=!1,Xr=!1,Xg=!1,hb=typeof WeakSet=="function"?WeakSet:Set,fn=null;function Q3(s,l){if(s=s.containerInfo,m1=bd,s=T_(s),Vp(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var v=d.anchorOffset,_=d.focusNode;d=d.focusOffset;try{c.nodeType,_.nodeType}catch{c=null;break e}var C=0,V=-1,ae=-1,pe=0,ke=0,Oe=s,ve=null;t:for(;;){for(var we;Oe!==c||v!==0&&Oe.nodeType!==3||(V=C+v),Oe!==_||d!==0&&Oe.nodeType!==3||(ae=C+d),Oe.nodeType===3&&(C+=Oe.nodeValue.length),(we=Oe.firstChild)!==null;)ve=Oe,Oe=we;for(;;){if(Oe===s)break t;if(ve===c&&++pe===v&&(V=C),ve===_&&++ke===d&&(ae=C),(we=Oe.nextSibling)!==null)break;Oe=ve,ve=Oe.parentNode}Oe=we}c=V===-1||ae===-1?null:{start:V,end:ae}}else c=null}c=c||{start:0,end:0}}else c=null;for(p1={focusedElem:s,selectionRange:c},bd=!1,fn=l;fn!==null;)if(l=fn,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,fn=s;else for(;fn!==null;){switch(l=fn,_=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)v=s[c],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,c=l,v=_.memoizedProps,_=_.memoizedState,d=c.stateNode;try{var Je=Do(c.type,v);s=d.getSnapshotBeforeUpdate(Je,_),d.__reactInternalSnapshotBeforeUpdate=s}catch(lt){Zt(c,c.return,lt)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,c=s.nodeType,c===9)v1(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":v1(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=l.sibling,s!==null){s.return=l.return,fn=s;break}fn=l.return}}function db(s,l,c){var d=c.flags;switch(c.tag){case 0:case 11:case 15:yi(s,c),d&4&&yf(5,c);break;case 1:if(yi(s,c),d&4)if(s=c.stateNode,l===null)try{s.componentDidMount()}catch(C){Zt(c,c.return,C)}else{var v=Do(c.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(v,l,s.__reactInternalSnapshotBeforeUpdate)}catch(C){Zt(c,c.return,C)}}d&64&&lb(c),d&512&&_f(c,c.return);break;case 3:if(yi(s,c),d&64&&(s=c.updateQueue,s!==null)){if(l=null,c.child!==null)switch(c.child.tag){case 27:case 5:l=c.child.stateNode;break;case 1:l=c.child.stateNode}try{Q_(s,l)}catch(C){Zt(c,c.return,C)}}break;case 27:l===null&&d&4&&fb(c);case 26:case 5:yi(s,c),l===null&&d&4&&cb(c),d&512&&_f(c,c.return);break;case 12:yi(s,c);break;case 31:yi(s,c),d&4&&gb(s,c);break;case 13:yi(s,c),d&4&&xb(s,c),d&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=i6.bind(null,c),A6(s,c))));break;case 22:if(d=c.memoizedState!==null||xi,!d){l=l!==null&&l.memoizedState!==null||Xr,v=xi;var _=Xr;xi=d,(Xr=l)&&!_?_i(s,c,(c.subtreeFlags&8772)!==0):yi(s,c),xi=v,Xr=_}break;case 30:break;default:yi(s,c)}}function mb(s){var l=s.alternate;l!==null&&(s.alternate=null,mb(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Be(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var wr=null,ta=!1;function vi(s,l,c){for(c=c.child;c!==null;)pb(s,l,c),c=c.sibling}function pb(s,l,c){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(Mt,c)}catch{}switch(c.tag){case 26:Xr||Ps(c,l),vi(s,l,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Xr||Ps(c,l);var d=wr,v=ta;xl(c.type)&&(wr=c.stateNode,ta=!1),vi(s,l,c),Cf(c.stateNode),wr=d,ta=v;break;case 5:Xr||Ps(c,l);case 6:if(d=wr,v=ta,wr=null,vi(s,l,c),wr=d,ta=v,wr!==null)if(ta)try{(wr.nodeType===9?wr.body:wr.nodeName==="HTML"?wr.ownerDocument.body:wr).removeChild(c.stateNode)}catch(_){Zt(c,l,_)}else try{wr.removeChild(c.stateNode)}catch(_){Zt(c,l,_)}break;case 18:wr!==null&&(ta?(s=wr,lw(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Qc(s)):lw(wr,c.stateNode));break;case 4:d=wr,v=ta,wr=c.stateNode.containerInfo,ta=!0,vi(s,l,c),wr=d,ta=v;break;case 0:case 11:case 14:case 15:ul(2,c,l),Xr||ul(4,c,l),vi(s,l,c);break;case 1:Xr||(Ps(c,l),d=c.stateNode,typeof d.componentWillUnmount=="function"&&ob(c,l,d)),vi(s,l,c);break;case 21:vi(s,l,c);break;case 22:Xr=(d=Xr)||c.memoizedState!==null,vi(s,l,c),Xr=d;break;default:vi(s,l,c)}}function gb(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Qc(s)}catch(c){Zt(l,l.return,c)}}}function xb(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Qc(s)}catch(c){Zt(l,l.return,c)}}function J3(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new hb),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new hb),l;default:throw Error(n(435,s.tag))}}function td(s,l){var c=J3(s);l.forEach(function(d){if(!c.has(d)){c.add(d);var v=l6.bind(null,s,d);d.then(v,v)}})}function ra(s,l){var c=l.deletions;if(c!==null)for(var d=0;d<c.length;d++){var v=c[d],_=s,C=l,V=C;e:for(;V!==null;){switch(V.tag){case 27:if(xl(V.type)){wr=V.stateNode,ta=!1;break e}break;case 5:wr=V.stateNode,ta=!1;break e;case 3:case 4:wr=V.stateNode.containerInfo,ta=!0;break e}V=V.return}if(wr===null)throw Error(n(160));pb(_,C,v),wr=null,ta=!1,_=v.alternate,_!==null&&(_.return=null),v.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)vb(l,s),l=l.sibling}var ms=null;function vb(s,l){var c=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:ra(l,s),na(s),d&4&&(ul(3,s,s.return),yf(3,s),ul(5,s,s.return));break;case 1:ra(l,s),na(s),d&512&&(Xr||c===null||Ps(c,c.return)),d&64&&xi&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?d:c.concat(d))));break;case 26:var v=ms;if(ra(l,s),na(s),d&512&&(Xr||c===null||Ps(c,c.return)),d&4){var _=c!==null?c.memoizedState:null;if(d=s.memoizedState,c===null)if(d===null)if(s.stateNode===null){e:{d=s.type,c=s.memoizedProps,v=v.ownerDocument||v;t:switch(d){case"title":_=v.getElementsByTagName("title")[0],(!_||_[ge]||_[K]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=v.createElement(d),v.head.insertBefore(_,v.querySelector("head > title"))),_n(_,d,c),_[K]=s,Ze(_),d=_;break e;case"link":var C=vw("link","href",v).get(d+(c.href||""));if(C){for(var V=0;V<C.length;V++)if(_=C[V],_.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&_.getAttribute("rel")===(c.rel==null?null:c.rel)&&_.getAttribute("title")===(c.title==null?null:c.title)&&_.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){C.splice(V,1);break t}}_=v.createElement(d),_n(_,d,c),v.head.appendChild(_);break;case"meta":if(C=vw("meta","content",v).get(d+(c.content||""))){for(V=0;V<C.length;V++)if(_=C[V],_.getAttribute("content")===(c.content==null?null:""+c.content)&&_.getAttribute("name")===(c.name==null?null:c.name)&&_.getAttribute("property")===(c.property==null?null:c.property)&&_.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&_.getAttribute("charset")===(c.charSet==null?null:c.charSet)){C.splice(V,1);break t}}_=v.createElement(d),_n(_,d,c),v.head.appendChild(_);break;default:throw Error(n(468,d))}_[K]=s,Ze(_),d=_}s.stateNode=d}else yw(v,s.type,s.stateNode);else s.stateNode=xw(v,d,s.memoizedProps);else _!==d?(_===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):_.count--,d===null?yw(v,s.type,s.stateNode):xw(v,d,s.memoizedProps)):d===null&&s.stateNode!==null&&qg(s,s.memoizedProps,c.memoizedProps)}break;case 27:ra(l,s),na(s),d&512&&(Xr||c===null||Ps(c,c.return)),c!==null&&d&4&&qg(s,s.memoizedProps,c.memoizedProps);break;case 5:if(ra(l,s),na(s),d&512&&(Xr||c===null||Ps(c,c.return)),s.flags&32){v=s.stateNode;try{ea(v,"")}catch(Je){Zt(s,s.return,Je)}}d&4&&s.stateNode!=null&&(v=s.memoizedProps,qg(s,v,c!==null?c.memoizedProps:v)),d&1024&&(Xg=!0);break;case 6:if(ra(l,s),na(s),d&4){if(s.stateNode===null)throw Error(n(162));d=s.memoizedProps,c=s.stateNode;try{c.nodeValue=d}catch(Je){Zt(s,s.return,Je)}}break;case 3:if(xd=null,v=ms,ms=pd(l.containerInfo),ra(l,s),ms=v,na(s),d&4&&c!==null&&c.memoizedState.isDehydrated)try{Qc(l.containerInfo)}catch(Je){Zt(s,s.return,Je)}Xg&&(Xg=!1,yb(s));break;case 4:d=ms,ms=pd(s.stateNode.containerInfo),ra(l,s),na(s),ms=d;break;case 12:ra(l,s),na(s);break;case 31:ra(l,s),na(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,td(s,d)));break;case 13:ra(l,s),na(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(nd=Ht()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,td(s,d)));break;case 22:v=s.memoizedState!==null;var ae=c!==null&&c.memoizedState!==null,pe=xi,ke=Xr;if(xi=pe||v,Xr=ke||ae,ra(l,s),Xr=ke,xi=pe,na(s),d&8192)e:for(l=s.stateNode,l._visibility=v?l._visibility&-2:l._visibility|1,v&&(c===null||ae||xi||Xr||Oo(s)),c=null,l=s;;){if(l.tag===5||l.tag===26){if(c===null){ae=c=l;try{if(_=ae.stateNode,v)C=_.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none";else{V=ae.stateNode;var Oe=ae.memoizedProps.style,ve=Oe!=null&&Oe.hasOwnProperty("display")?Oe.display:null;V.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(Je){Zt(ae,ae.return,Je)}}}else if(l.tag===6){if(c===null){ae=l;try{ae.stateNode.nodeValue=v?"":ae.memoizedProps}catch(Je){Zt(ae,ae.return,Je)}}}else if(l.tag===18){if(c===null){ae=l;try{var we=ae.stateNode;v?ow(we,!0):ow(ae.stateNode,!1)}catch(Je){Zt(ae,ae.return,Je)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;c===l&&(c=null),l=l.return}c===l&&(c=null),l.sibling.return=l.return,l=l.sibling}d&4&&(d=s.updateQueue,d!==null&&(c=d.retryQueue,c!==null&&(d.retryQueue=null,td(s,c))));break;case 19:ra(l,s),na(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,td(s,d)));break;case 30:break;case 21:break;default:ra(l,s),na(s)}}function na(s){var l=s.flags;if(l&2){try{for(var c,d=s.return;d!==null;){if(ub(d)){c=d;break}d=d.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var v=c.stateNode,_=Gg(s);ed(s,_,v);break;case 5:var C=c.stateNode;c.flags&32&&(ea(C,""),c.flags&=-33);var V=Gg(s);ed(s,V,C);break;case 3:case 4:var ae=c.stateNode.containerInfo,pe=Gg(s);Wg(s,pe,ae);break;default:throw Error(n(161))}}catch(ke){Zt(s,s.return,ke)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function yb(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;yb(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function yi(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)db(s,l.alternate,l),l=l.sibling}function Oo(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:ul(4,l,l.return),Oo(l);break;case 1:Ps(l,l.return);var c=l.stateNode;typeof c.componentWillUnmount=="function"&&ob(l,l.return,c),Oo(l);break;case 27:Cf(l.stateNode);case 26:case 5:Ps(l,l.return),Oo(l);break;case 22:l.memoizedState===null&&Oo(l);break;case 30:Oo(l);break;default:Oo(l)}s=s.sibling}}function _i(s,l,c){for(c=c&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var d=l.alternate,v=s,_=l,C=_.flags;switch(_.tag){case 0:case 11:case 15:_i(v,_,c),yf(4,_);break;case 1:if(_i(v,_,c),d=_,v=d.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(pe){Zt(d,d.return,pe)}if(d=_,v=d.updateQueue,v!==null){var V=d.stateNode;try{var ae=v.shared.hiddenCallbacks;if(ae!==null)for(v.shared.hiddenCallbacks=null,v=0;v<ae.length;v++)K_(ae[v],V)}catch(pe){Zt(d,d.return,pe)}}c&&C&64&&lb(_),_f(_,_.return);break;case 27:fb(_);case 26:case 5:_i(v,_,c),c&&d===null&&C&4&&cb(_),_f(_,_.return);break;case 12:_i(v,_,c);break;case 31:_i(v,_,c),c&&C&4&&gb(v,_);break;case 13:_i(v,_,c),c&&C&4&&xb(v,_);break;case 22:_.memoizedState===null&&_i(v,_,c),_f(_,_.return);break;case 30:break;default:_i(v,_,c)}l=l.sibling}}function Yg(s,l){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&sf(c))}function $g(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&sf(s))}function ps(s,l,c,d){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)_b(s,l,c,d),l=l.sibling}function _b(s,l,c,d){var v=l.flags;switch(l.tag){case 0:case 11:case 15:ps(s,l,c,d),v&2048&&yf(9,l);break;case 1:ps(s,l,c,d);break;case 3:ps(s,l,c,d),v&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&sf(s)));break;case 12:if(v&2048){ps(s,l,c,d),s=l.stateNode;try{var _=l.memoizedProps,C=_.id,V=_.onPostCommit;typeof V=="function"&&V(C,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ae){Zt(l,l.return,ae)}}else ps(s,l,c,d);break;case 31:ps(s,l,c,d);break;case 13:ps(s,l,c,d);break;case 23:break;case 22:_=l.stateNode,C=l.alternate,l.memoizedState!==null?_._visibility&2?ps(s,l,c,d):bf(s,l):_._visibility&2?ps(s,l,c,d):(_._visibility|=2,Vc(s,l,c,d,(l.subtreeFlags&10256)!==0||!1)),v&2048&&Yg(C,l);break;case 24:ps(s,l,c,d),v&2048&&$g(l.alternate,l);break;default:ps(s,l,c,d)}}function Vc(s,l,c,d,v){for(v=v&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var _=s,C=l,V=c,ae=d,pe=C.flags;switch(C.tag){case 0:case 11:case 15:Vc(_,C,V,ae,v),yf(8,C);break;case 23:break;case 22:var ke=C.stateNode;C.memoizedState!==null?ke._visibility&2?Vc(_,C,V,ae,v):bf(_,C):(ke._visibility|=2,Vc(_,C,V,ae,v)),v&&pe&2048&&Yg(C.alternate,C);break;case 24:Vc(_,C,V,ae,v),v&&pe&2048&&$g(C.alternate,C);break;default:Vc(_,C,V,ae,v)}l=l.sibling}}function bf(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var c=s,d=l,v=d.flags;switch(d.tag){case 22:bf(c,d),v&2048&&Yg(d.alternate,d);break;case 24:bf(c,d),v&2048&&$g(d.alternate,d);break;default:bf(c,d)}l=l.sibling}}var wf=8192;function Uc(s,l,c){if(s.subtreeFlags&wf)for(s=s.child;s!==null;)bb(s,l,c),s=s.sibling}function bb(s,l,c){switch(s.tag){case 26:Uc(s,l,c),s.flags&wf&&s.memoizedState!==null&&L6(c,ms,s.memoizedState,s.memoizedProps);break;case 5:Uc(s,l,c);break;case 3:case 4:var d=ms;ms=pd(s.stateNode.containerInfo),Uc(s,l,c),ms=d;break;case 22:s.memoizedState===null&&(d=s.alternate,d!==null&&d.memoizedState!==null?(d=wf,wf=16777216,Uc(s,l,c),wf=d):Uc(s,l,c));break;default:Uc(s,l,c)}}function wb(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Ef(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var d=l[c];fn=d,Tb(d,s)}wb(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Eb(s),s=s.sibling}function Eb(s){switch(s.tag){case 0:case 11:case 15:Ef(s),s.flags&2048&&ul(9,s,s.return);break;case 3:Ef(s);break;case 12:Ef(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,rd(s)):Ef(s);break;default:Ef(s)}}function rd(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var d=l[c];fn=d,Tb(d,s)}wb(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:ul(8,l,l.return),rd(l);break;case 22:c=l.stateNode,c._visibility&2&&(c._visibility&=-3,rd(l));break;default:rd(l)}s=s.sibling}}function Tb(s,l){for(;fn!==null;){var c=fn;switch(c.tag){case 0:case 11:case 15:ul(8,c,l);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var d=c.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:sf(c.memoizedState.cache)}if(d=c.child,d!==null)d.return=c,fn=d;else e:for(c=s;fn!==null;){d=fn;var v=d.sibling,_=d.return;if(mb(d),d===c){fn=null;break e}if(v!==null){v.return=_,fn=v;break e}fn=_}}}var Z3={getCacheForType:function(s){var l=vn(qr),c=l.data.get(s);return c===void 0&&(c=s(),l.data.set(s,c)),c},cacheSignal:function(){return vn(qr).controller.signal}},e6=typeof WeakMap=="function"?WeakMap:Map,Gt=0,ur=null,kt=null,Ct=0,Jt=0,wa=null,fl=!1,zc=!1,Kg=!1,bi=0,Ir=0,hl=0,Fo=0,Qg=0,Ea=0,Hc=0,Tf=null,aa=null,Jg=!1,nd=0,Sb=0,ad=1/0,sd=null,dl=null,rn=0,ml=null,qc=null,wi=0,Zg=0,e1=null,Ab=null,Sf=0,t1=null;function Ta(){return(Gt&2)!==0&&Ct!==0?Ct&-Ct:ne.T!==null?l1():B()}function kb(){if(Ea===0)if((Ct&536870912)===0||Ft){var s=ti;ti<<=1,(ti&3932160)===0&&(ti=262144),Ea=s}else Ea=536870912;return s=_a.current,s!==null&&(s.flags|=32),Ea}function sa(s,l,c){(s===ur&&(Jt===2||Jt===9)||s.cancelPendingCommit!==null)&&(Gc(s,0),pl(s,Ct,Ea,!1)),ri(s,c),((Gt&2)===0||s!==ur)&&(s===ur&&((Gt&2)===0&&(Fo|=c),Ir===4&&pl(s,Ct,Ea,!1)),Ms(s))}function Nb(s,l,c){if((Gt&6)!==0)throw Error(n(327));var d=!c&&(l&127)===0&&(l&s.expiredLanes)===0||pa(s,l),v=d?n6(s,l):n1(s,l,!0),_=d;do{if(v===0){zc&&!d&&pl(s,l,0,!1);break}else{if(c=s.current.alternate,_&&!t6(c)){v=n1(s,l,!1),_=!1;continue}if(v===2){if(_=l,s.errorRecoveryDisabledLanes&_)var C=0;else C=s.pendingLanes&-536870913,C=C!==0?C:C&536870912?536870912:0;if(C!==0){l=C;e:{var V=s;v=Tf;var ae=V.current.memoizedState.isDehydrated;if(ae&&(Gc(V,C).flags|=256),C=n1(V,C,!1),C!==2){if(Kg&&!ae){V.errorRecoveryDisabledLanes|=_,Fo|=_,v=4;break e}_=aa,aa=v,_!==null&&(aa===null?aa=_:aa.push.apply(aa,_))}v=C}if(_=!1,v!==2)continue}}if(v===1){Gc(s,0),pl(s,l,0,!0);break}e:{switch(d=s,_=v,_){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:pl(d,l,Ea,!fl);break e;case 2:aa=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(v=nd+300-Ht(),10<v)){if(pl(d,l,Ea,!fl),Da(d,0,!0)!==0)break e;wi=l,d.timeoutHandle=sw(Cb.bind(null,d,c,aa,sd,Jg,l,Ea,Fo,Hc,fl,_,"Throttled",-0,0),v);break e}Cb(d,c,aa,sd,Jg,l,Ea,Fo,Hc,fl,_,null,-0,0)}}break}while(!0);Ms(s)}function Cb(s,l,c,d,v,_,C,V,ae,pe,ke,Oe,ve,we){if(s.timeoutHandle=-1,Oe=l.subtreeFlags,Oe&8192||(Oe&16785408)===16785408){Oe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:os},bb(l,_,Oe);var Je=(_&62914560)===_?nd-Ht():(_&4194048)===_?Sb-Ht():0;if(Je=B6(Oe,Je),Je!==null){wi=_,s.cancelPendingCommit=Je(Mb.bind(null,s,l,_,c,d,v,C,V,ae,ke,Oe,null,ve,we)),pl(s,_,C,!pe);return}}Mb(s,l,_,c,d,v,C,V,ae)}function t6(s){for(var l=s;;){var c=l.tag;if((c===0||c===11||c===15)&&l.flags&16384&&(c=l.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var d=0;d<c.length;d++){var v=c[d],_=v.getSnapshot;v=v.value;try{if(!va(_(),v))return!1}catch{return!1}}if(c=l.child,l.subtreeFlags&16384&&c!==null)c.return=l,l=c;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function pl(s,l,c,d){l&=~Qg,l&=~Fo,s.suspendedLanes|=l,s.pingedLanes&=~l,d&&(s.warmLanes|=l),d=s.expirationTimes;for(var v=l;0<v;){var _=31-mr(v),C=1<<_;d[_]=-1,v&=~C}c!==0&&ni(s,c,l)}function id(){return(Gt&6)===0?(Af(0),!1):!0}function r1(){if(kt!==null){if(Jt===0)var s=kt.return;else s=kt,fi=So=null,vg(s),jc=null,of=0,s=kt;for(;s!==null;)ib(s.alternate,s),s=s.return;kt=null}}function Gc(s,l){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,b6(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),wi=0,r1(),ur=s,kt=c=ci(s.current,null),Ct=l,Jt=0,wa=null,fl=!1,zc=pa(s,l),Kg=!1,Hc=Ea=Qg=Fo=hl=Ir=0,aa=Tf=null,Jg=!1,(l&8)!==0&&(l|=l&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=l;0<d;){var v=31-mr(d),_=1<<v;l|=s[v],d&=~_}return bi=l,kh(),c}function Rb(s,l){_t=null,ne.H=gf,l===Fc||l===jh?(l=W_(),Jt=3):l===ig?(l=W_(),Jt=4):Jt=l===Fg?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,wa=l,kt===null&&(Ir=1,$h(s,La(l,s.current)))}function Ib(){var s=_a.current;return s===null?!0:(Ct&4194048)===Ct?za===null:(Ct&62914560)===Ct||(Ct&536870912)!==0?s===za:!1}function Db(){var s=ne.H;return ne.H=gf,s===null?gf:s}function Ob(){var s=ne.A;return ne.A=Z3,s}function ld(){Ir=4,fl||(Ct&4194048)!==Ct&&_a.current!==null||(zc=!0),(hl&134217727)===0&&(Fo&134217727)===0||ur===null||pl(ur,Ct,Ea,!1)}function n1(s,l,c){var d=Gt;Gt|=2;var v=Db(),_=Ob();(ur!==s||Ct!==l)&&(sd=null,Gc(s,l)),l=!1;var C=Ir;e:do try{if(Jt!==0&&kt!==null){var V=kt,ae=wa;switch(Jt){case 8:r1(),C=6;break e;case 3:case 2:case 9:case 6:_a.current===null&&(l=!0);var pe=Jt;if(Jt=0,wa=null,Wc(s,V,ae,pe),c&&zc){C=0;break e}break;default:pe=Jt,Jt=0,wa=null,Wc(s,V,ae,pe)}}r6(),C=Ir;break}catch(ke){Rb(s,ke)}while(!0);return l&&s.shellSuspendCounter++,fi=So=null,Gt=d,ne.H=v,ne.A=_,kt===null&&(ur=null,Ct=0,kh()),C}function r6(){for(;kt!==null;)Fb(kt)}function n6(s,l){var c=Gt;Gt|=2;var d=Db(),v=Ob();ur!==s||Ct!==l?(sd=null,ad=Ht()+500,Gc(s,l)):zc=pa(s,l);e:do try{if(Jt!==0&&kt!==null){l=kt;var _=wa;t:switch(Jt){case 1:Jt=0,wa=null,Wc(s,l,_,1);break;case 2:case 9:if(q_(_)){Jt=0,wa=null,jb(l);break}l=function(){Jt!==2&&Jt!==9||ur!==s||(Jt=7),Ms(s)},_.then(l,l);break e;case 3:Jt=7;break e;case 4:Jt=5;break e;case 7:q_(_)?(Jt=0,wa=null,jb(l)):(Jt=0,wa=null,Wc(s,l,_,7));break;case 5:var C=null;switch(kt.tag){case 26:C=kt.memoizedState;case 5:case 27:var V=kt;if(C?_w(C):V.stateNode.complete){Jt=0,wa=null;var ae=V.sibling;if(ae!==null)kt=ae;else{var pe=V.return;pe!==null?(kt=pe,od(pe)):kt=null}break t}}Jt=0,wa=null,Wc(s,l,_,5);break;case 6:Jt=0,wa=null,Wc(s,l,_,6);break;case 8:r1(),Ir=6;break e;default:throw Error(n(462))}}a6();break}catch(ke){Rb(s,ke)}while(!0);return fi=So=null,ne.H=d,ne.A=v,Gt=c,kt!==null?0:(ur=null,Ct=0,kh(),Ir)}function a6(){for(;kt!==null&&!da();)Fb(kt)}function Fb(s){var l=ab(s.alternate,s,bi);s.memoizedProps=s.pendingProps,l===null?od(s):kt=l}function jb(s){var l=s,c=l.alternate;switch(l.tag){case 15:case 0:l=J2(c,l,l.pendingProps,l.type,void 0,Ct);break;case 11:l=J2(c,l,l.pendingProps,l.type.render,l.ref,Ct);break;case 5:vg(l);default:ib(c,l),l=kt=O_(l,bi),l=ab(c,l,bi)}s.memoizedProps=s.pendingProps,l===null?od(s):kt=l}function Wc(s,l,c,d){fi=So=null,vg(l),jc=null,of=0;var v=l.return;try{if(W3(s,v,l,c,Ct)){Ir=1,$h(s,La(c,s.current)),kt=null;return}}catch(_){if(v!==null)throw kt=v,_;Ir=1,$h(s,La(c,s.current)),kt=null;return}l.flags&32768?(Ft||d===1?s=!0:zc||(Ct&536870912)!==0?s=!1:(fl=s=!0,(d===2||d===9||d===3||d===6)&&(d=_a.current,d!==null&&d.tag===13&&(d.flags|=16384))),Pb(l,s)):od(l)}function od(s){var l=s;do{if((l.flags&32768)!==0){Pb(l,fl);return}s=l.return;var c=$3(l.alternate,l,bi);if(c!==null){kt=c;return}if(l=l.sibling,l!==null){kt=l;return}kt=l=s}while(l!==null);Ir===0&&(Ir=5)}function Pb(s,l){do{var c=K3(s.alternate,s);if(c!==null){c.flags&=32767,kt=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!l&&(s=s.sibling,s!==null)){kt=s;return}kt=s=c}while(s!==null);Ir=6,kt=null}function Mb(s,l,c,d,v,_,C,V,ae){s.cancelPendingCommit=null;do cd();while(rn!==0);if((Gt&6)!==0)throw Error(n(327));if(l!==null){if(l===s.current)throw Error(n(177));if(_=l.lanes|l.childLanes,_|=Gp,zu(s,c,_,C,V,ae),s===ur&&(kt=ur=null,Ct=0),qc=l,ml=s,wi=c,Zg=_,e1=v,Ab=d,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,o6(Yt,function(){return zb(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||d){d=ne.T,ne.T=null,v=se.p,se.p=2,C=Gt,Gt|=4;try{Q3(s,l,c)}finally{Gt=C,se.p=v,ne.T=d}}rn=1,Lb(),Bb(),Vb()}}function Lb(){if(rn===1){rn=0;var s=ml,l=qc,c=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||c){c=ne.T,ne.T=null;var d=se.p;se.p=2;var v=Gt;Gt|=4;try{vb(l,s);var _=p1,C=T_(s.containerInfo),V=_.focusedElem,ae=_.selectionRange;if(C!==V&&V&&V.ownerDocument&&E_(V.ownerDocument.documentElement,V)){if(ae!==null&&Vp(V)){var pe=ae.start,ke=ae.end;if(ke===void 0&&(ke=pe),"selectionStart"in V)V.selectionStart=pe,V.selectionEnd=Math.min(ke,V.value.length);else{var Oe=V.ownerDocument||document,ve=Oe&&Oe.defaultView||window;if(ve.getSelection){var we=ve.getSelection(),Je=V.textContent.length,lt=Math.min(ae.start,Je),ir=ae.end===void 0?lt:Math.min(ae.end,Je);!we.extend&&lt>ir&&(C=ir,ir=lt,lt=C);var ue=w_(V,lt),le=w_(V,ir);if(ue&&le&&(we.rangeCount!==1||we.anchorNode!==ue.node||we.anchorOffset!==ue.offset||we.focusNode!==le.node||we.focusOffset!==le.offset)){var he=Oe.createRange();he.setStart(ue.node,ue.offset),we.removeAllRanges(),lt>ir?(we.addRange(he),we.extend(le.node,le.offset)):(he.setEnd(le.node,le.offset),we.addRange(he))}}}}for(Oe=[],we=V;we=we.parentNode;)we.nodeType===1&&Oe.push({element:we,left:we.scrollLeft,top:we.scrollTop});for(typeof V.focus=="function"&&V.focus(),V=0;V<Oe.length;V++){var Re=Oe[V];Re.element.scrollLeft=Re.left,Re.element.scrollTop=Re.top}}bd=!!m1,p1=m1=null}finally{Gt=v,se.p=d,ne.T=c}}s.current=l,rn=2}}function Bb(){if(rn===2){rn=0;var s=ml,l=qc,c=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||c){c=ne.T,ne.T=null;var d=se.p;se.p=2;var v=Gt;Gt|=4;try{db(s,l.alternate,l)}finally{Gt=v,se.p=d,ne.T=c}}rn=3}}function Vb(){if(rn===4||rn===3){rn=0,Hn();var s=ml,l=qc,c=wi,d=Ab;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?rn=5:(rn=0,qc=ml=null,Ub(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(dl=null),ss(c),l=l.stateNode,or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(Mt,l,void 0,(l.current.flags&128)===128)}catch{}if(d!==null){l=ne.T,v=se.p,se.p=2,ne.T=null;try{for(var _=s.onRecoverableError,C=0;C<d.length;C++){var V=d[C];_(V.value,{componentStack:V.stack})}}finally{ne.T=l,se.p=v}}(wi&3)!==0&&cd(),Ms(s),v=s.pendingLanes,(c&261930)!==0&&(v&42)!==0?s===t1?Sf++:(Sf=0,t1=s):Sf=0,Af(0)}}function Ub(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,sf(l)))}function cd(){return Lb(),Bb(),Vb(),zb()}function zb(){if(rn!==5)return!1;var s=ml,l=Zg;Zg=0;var c=ss(wi),d=ne.T,v=se.p;try{se.p=32>c?32:c,ne.T=null,c=e1,e1=null;var _=ml,C=wi;if(rn=0,qc=ml=null,wi=0,(Gt&6)!==0)throw Error(n(331));var V=Gt;if(Gt|=4,Eb(_.current),_b(_,_.current,C,c),Gt=V,Af(0,!1),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(Mt,_)}catch{}return!0}finally{se.p=v,ne.T=d,Ub(s,l)}}function Hb(s,l,c){l=La(c,l),l=Og(s.stateNode,l,2),s=ll(s,l,2),s!==null&&(ri(s,2),Ms(s))}function Zt(s,l,c){if(s.tag===3)Hb(s,s,c);else for(;l!==null;){if(l.tag===3){Hb(l,s,c);break}else if(l.tag===1){var d=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(dl===null||!dl.has(d))){s=La(c,s),c=q2(2),d=ll(l,c,2),d!==null&&(G2(c,d,l,s),ri(d,2),Ms(d));break}}l=l.return}}function a1(s,l,c){var d=s.pingCache;if(d===null){d=s.pingCache=new e6;var v=new Set;d.set(l,v)}else v=d.get(l),v===void 0&&(v=new Set,d.set(l,v));v.has(c)||(Kg=!0,v.add(c),s=s6.bind(null,s,l,c),l.then(s,s))}function s6(s,l,c){var d=s.pingCache;d!==null&&d.delete(l),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,ur===s&&(Ct&c)===c&&(Ir===4||Ir===3&&(Ct&62914560)===Ct&&300>Ht()-nd?(Gt&2)===0&&Gc(s,0):Qg|=c,Hc===Ct&&(Hc=0)),Ms(s)}function qb(s,l){l===0&&(l=mc()),s=wo(s,l),s!==null&&(ri(s,l),Ms(s))}function i6(s){var l=s.memoizedState,c=0;l!==null&&(c=l.retryLane),qb(s,c)}function l6(s,l){var c=0;switch(s.tag){case 31:case 13:var d=s.stateNode,v=s.memoizedState;v!==null&&(c=v.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(n(314))}d!==null&&d.delete(l),qb(s,c)}function o6(s,l){return ht(s,l)}var ud=null,Xc=null,s1=!1,fd=!1,i1=!1,gl=0;function Ms(s){s!==Xc&&s.next===null&&(Xc===null?ud=Xc=s:Xc=Xc.next=s),fd=!0,s1||(s1=!0,u6())}function Af(s,l){if(!i1&&fd){i1=!0;do for(var c=!1,d=ud;d!==null;){if(s!==0){var v=d.pendingLanes;if(v===0)var _=0;else{var C=d.suspendedLanes,V=d.pingedLanes;_=(1<<31-mr(42|s)+1)-1,_&=v&~(C&~V),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(c=!0,Yb(d,_))}else _=Ct,_=Da(d,d===ur?_:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(_&3)===0||pa(d,_)||(c=!0,Yb(d,_));d=d.next}while(c);i1=!1}}function c6(){Gb()}function Gb(){fd=s1=!1;var s=0;gl!==0&&_6()&&(s=gl);for(var l=Ht(),c=null,d=ud;d!==null;){var v=d.next,_=Wb(d,l);_===0?(d.next=null,c===null?ud=v:c.next=v,v===null&&(Xc=c)):(c=d,(s!==0||(_&3)!==0)&&(fd=!0)),d=v}rn!==0&&rn!==5||Af(s),gl!==0&&(gl=0)}function Wb(s,l){for(var c=s.suspendedLanes,d=s.pingedLanes,v=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var C=31-mr(_),V=1<<C,ae=v[C];ae===-1?((V&c)===0||(V&d)!==0)&&(v[C]=Uu(V,l)):ae<=l&&(s.expiredLanes|=V),_&=~V}if(l=ur,c=Ct,c=Da(s,s===l?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,c===0||s===l&&(Jt===2||Jt===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&fr(d),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||pa(s,c)){if(l=c&-c,l===s.callbackPriority)return l;switch(d!==null&&fr(d),ss(c)){case 2:case 8:c=Jn;break;case 32:c=Yt;break;case 268435456:c=dt;break;default:c=Yt}return d=Xb.bind(null,s),c=ht(c,d),s.callbackPriority=l,s.callbackNode=c,l}return d!==null&&d!==null&&fr(d),s.callbackPriority=2,s.callbackNode=null,2}function Xb(s,l){if(rn!==0&&rn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(cd()&&s.callbackNode!==c)return null;var d=Ct;return d=Da(s,s===ur?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(Nb(s,d,l),Wb(s,Ht()),s.callbackNode!=null&&s.callbackNode===c?Xb.bind(null,s):null)}function Yb(s,l){if(cd())return null;Nb(s,l,!0)}function u6(){w6(function(){(Gt&6)!==0?ht(kn,c6):Gb()})}function l1(){if(gl===0){var s=Dc;s===0&&(s=ma,ma<<=1,(ma&261888)===0&&(ma=256)),gl=s}return gl}function $b(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:xc(""+s)}function Kb(s,l){var c=l.ownerDocument.createElement("input");return c.name=l.name,c.value=l.value,s.id&&c.setAttribute("form",s.id),l.parentNode.insertBefore(c,l),s=new FormData(s),c.parentNode.removeChild(c),s}function f6(s,l,c,d,v){if(l==="submit"&&c&&c.stateNode===v){var _=$b((v[Q]||null).action),C=d.submitter;C&&(l=(l=C[Q]||null)?$b(l.formAction):C.getAttribute("formAction"),l!==null&&(_=l,C=null));var V=new Rs("action","action",null,d,v);s.push({event:V,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(gl!==0){var ae=C?Kb(v,C):new FormData(v);kg(c,{pending:!0,data:ae,method:v.method,action:_},null,ae)}}else typeof _=="function"&&(V.preventDefault(),ae=C?Kb(v,C):new FormData(v),kg(c,{pending:!0,data:ae,method:v.method,action:_},_,ae))},currentTarget:v}]})}}for(var o1=0;o1<qp.length;o1++){var c1=qp[o1],h6=c1.toLowerCase(),d6=c1[0].toUpperCase()+c1.slice(1);ds(h6,"on"+d6)}ds(k_,"onAnimationEnd"),ds(N_,"onAnimationIteration"),ds(C_,"onAnimationStart"),ds("dblclick","onDoubleClick"),ds("focusin","onFocus"),ds("focusout","onBlur"),ds(C3,"onTransitionRun"),ds(R3,"onTransitionStart"),ds(I3,"onTransitionCancel"),ds(R_,"onTransitionEnd"),Nn("onMouseEnter",["mouseout","mouseover"]),Nn("onMouseLeave",["mouseout","mouseover"]),Nn("onPointerEnter",["pointerout","pointerover"]),Nn("onPointerLeave",["pointerout","pointerover"]),cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),cr("onBeforeInput",["compositionend","keypress","textInput","paste"]),cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),m6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(kf));function Qb(s,l){l=(l&4)!==0;for(var c=0;c<s.length;c++){var d=s[c],v=d.event;d=d.listeners;e:{var _=void 0;if(l)for(var C=d.length-1;0<=C;C--){var V=d[C],ae=V.instance,pe=V.currentTarget;if(V=V.listener,ae!==_&&v.isPropagationStopped())break e;_=V,v.currentTarget=pe;try{_(v)}catch(ke){Ah(ke)}v.currentTarget=null,_=ae}else for(C=0;C<d.length;C++){if(V=d[C],ae=V.instance,pe=V.currentTarget,V=V.listener,ae!==_&&v.isPropagationStopped())break e;_=V,v.currentTarget=pe;try{_(v)}catch(ke){Ah(ke)}v.currentTarget=null,_=ae}}}}function Nt(s,l){var c=l[de];c===void 0&&(c=l[de]=new Set);var d=s+"__bubble";c.has(d)||(Jb(l,s,2,!1),c.add(d))}function u1(s,l,c){var d=0;l&&(d|=4),Jb(c,s,d,l)}var hd="_reactListening"+Math.random().toString(36).slice(2);function f1(s){if(!s[hd]){s[hd]=!0,$t.forEach(function(c){c!=="selectionchange"&&(m6.has(c)||u1(c,!1,s),u1(c,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[hd]||(l[hd]=!0,u1("selectionchange",!1,l))}}function Jb(s,l,c,d){switch(kw(l)){case 2:var v=z6;break;case 8:v=H6;break;default:v=A1}c=v.bind(null,l,c,s),v=void 0,!mo||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),d?v!==void 0?s.addEventListener(l,c,{capture:!0,passive:v}):s.addEventListener(l,c,!0):v!==void 0?s.addEventListener(l,c,{passive:v}):s.addEventListener(l,c,!1)}function h1(s,l,c,d,v){var _=d;if((l&1)===0&&(l&2)===0&&d!==null)e:for(;;){if(d===null)return;var C=d.tag;if(C===3||C===4){var V=d.stateNode.containerInfo;if(V===v)break;if(C===4)for(C=d.return;C!==null;){var ae=C.tag;if((ae===3||ae===4)&&C.stateNode.containerInfo===v)return;C=C.return}for(;V!==null;){if(C=Ue(V),C===null)return;if(ae=C.tag,ae===5||ae===6||ae===26||ae===27){d=_=C;continue e}V=V.parentNode}}d=d.return}Qi(function(){var pe=_,ke=Fa(c),Oe=[];e:{var ve=I_.get(s);if(ve!==void 0){var we=Rs,Je=s;switch(s){case"keypress":if(go(c)===0)break e;case"keydown":case"keyup":we=Eh;break;case"focusin":Je="focus",we=vo;break;case"focusout":Je="blur",we=vo;break;case"beforeblur":case"afterblur":we=vo;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=Qu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=mh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=S;break;case k_:case N_:case C_:we=gh;break;case R_:we=X;break;case"scroll":case"scrollend":we=Ku;break;case"wheel":we=be;break;case"copy":case"cut":case"paste":we=xh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=oi;break;case"toggle":case"beforetoggle":we=yt}var lt=(l&4)!==0,ir=!lt&&(s==="scroll"||s==="scrollend"),ue=lt?ve!==null?ve+"Capture":null:ve;lt=[];for(var le=pe,he;le!==null;){var Re=le;if(he=Re.stateNode,Re=Re.tag,Re!==5&&Re!==26&&Re!==27||he===null||ue===null||(Re=cs(le,ue),Re!=null&&lt.push(Nf(le,Re,he))),ir)break;le=le.return}0<lt.length&&(ve=new we(ve,Je,null,c,ke),Oe.push({event:ve,listeners:lt}))}}if((l&7)===0){e:{if(ve=s==="mouseover"||s==="pointerover",we=s==="mouseout"||s==="pointerout",ve&&c!==Xu&&(Je=c.relatedTarget||c.fromElement)&&(Ue(Je)||Je[te]))break e;if((we||ve)&&(ve=ke.window===ke?ke:(ve=ke.ownerDocument)?ve.defaultView||ve.parentWindow:window,we?(Je=c.relatedTarget||c.toElement,we=pe,Je=Je?Ue(Je):null,Je!==null&&(ir=i(Je),lt=Je.tag,Je!==ir||lt!==5&&lt!==27&&lt!==6)&&(Je=null)):(we=null,Je=pe),we!==Je)){if(lt=Qu,Re="onMouseLeave",ue="onMouseEnter",le="mouse",(s==="pointerout"||s==="pointerover")&&(lt=oi,Re="onPointerLeave",ue="onPointerEnter",le="pointer"),ir=we==null?ve:Le(we),he=Je==null?ve:Le(Je),ve=new lt(Re,le+"leave",we,c,ke),ve.target=ir,ve.relatedTarget=he,Re=null,Ue(ke)===pe&&(lt=new lt(ue,le+"enter",Je,c,ke),lt.target=he,lt.relatedTarget=ir,Re=lt),ir=Re,we&&Je)t:{for(lt=p6,ue=we,le=Je,he=0,Re=ue;Re;Re=lt(Re))he++;Re=0;for(var at=le;at;at=lt(at))Re++;for(;0<he-Re;)ue=lt(ue),he--;for(;0<Re-he;)le=lt(le),Re--;for(;he--;){if(ue===le||le!==null&&ue===le.alternate){lt=ue;break t}ue=lt(ue),le=lt(le)}lt=null}else lt=null;we!==null&&Zb(Oe,ve,we,lt,!1),Je!==null&&ir!==null&&Zb(Oe,ir,Je,lt,!0)}}e:{if(ve=pe?Le(pe):window,we=ve.nodeName&&ve.nodeName.toLowerCase(),we==="select"||we==="input"&&ve.type==="file")var Vt=g_;else if(m_(ve))if(x_)Vt=A3;else{Vt=T3;var et=E3}else we=ve.nodeName,!we||we.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?pe&&gc(pe.elementType)&&(Vt=g_):Vt=S3;if(Vt&&(Vt=Vt(s,pe))){p_(Oe,Vt,c,ke);break e}et&&et(s,ve,pe),s==="focusout"&&pe&&ve.type==="number"&&pe.memoizedProps.value!=null&&qu(ve,"number",ve.value)}switch(et=pe?Le(pe):window,s){case"focusin":(m_(et)||et.contentEditable==="true")&&(Tc=et,Up=pe,rf=null);break;case"focusout":rf=Up=Tc=null;break;case"mousedown":zp=!0;break;case"contextmenu":case"mouseup":case"dragend":zp=!1,S_(Oe,c,ke);break;case"selectionchange":if(N3)break;case"keydown":case"keyup":S_(Oe,c,ke)}var wt;if(qt)e:{switch(s){case"compositionstart":var Rt="onCompositionStart";break e;case"compositionend":Rt="onCompositionEnd";break e;case"compositionupdate":Rt="onCompositionUpdate";break e}Rt=void 0}else Ec?yo(s,c)&&(Rt="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Rt="onCompositionStart");Rt&&(Os&&c.locale!=="ko"&&(Ec||Rt!=="onCompositionStart"?Rt==="onCompositionEnd"&&Ec&&(wt=$u()):(Cs=ke,Yu="value"in Cs?Cs.value:Cs.textContent,Ec=!0)),et=dd(pe,Rt),0<et.length&&(Rt=new Ds(Rt,s,null,c,ke),Oe.push({event:Rt,listeners:et}),wt?Rt.data=wt:(wt=wc(c),wt!==null&&(Rt.data=wt)))),(wt=Pa?y3(s,c):_3(s,c))&&(Rt=dd(pe,"onBeforeInput"),0<Rt.length&&(et=new Ds("onBeforeInput","beforeinput",null,c,ke),Oe.push({event:et,listeners:Rt}),et.data=wt)),f6(Oe,s,pe,c,ke)}Qb(Oe,l)})}function Nf(s,l,c){return{instance:s,listener:l,currentTarget:c}}function dd(s,l){for(var c=l+"Capture",d=[];s!==null;){var v=s,_=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||_===null||(v=cs(s,c),v!=null&&d.unshift(Nf(s,v,_)),v=cs(s,l),v!=null&&d.push(Nf(s,v,_))),s.tag===3)return d;s=s.return}return[]}function p6(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Zb(s,l,c,d,v){for(var _=l._reactName,C=[];c!==null&&c!==d;){var V=c,ae=V.alternate,pe=V.stateNode;if(V=V.tag,ae!==null&&ae===d)break;V!==5&&V!==26&&V!==27||pe===null||(ae=pe,v?(pe=cs(c,_),pe!=null&&C.unshift(Nf(c,pe,ae))):v||(pe=cs(c,_),pe!=null&&C.push(Nf(c,pe,ae)))),c=c.return}C.length!==0&&s.push({event:l,listeners:C})}var g6=/\r\n?/g,x6=/\u0000|\uFFFD/g;function ew(s){return(typeof s=="string"?s:""+s).replace(g6,`
`).replace(x6,"")}function tw(s,l){return l=ew(l),ew(s)===l}function sr(s,l,c,d,v,_){switch(c){case"children":typeof d=="string"?l==="body"||l==="textarea"&&d===""||ea(s,d):(typeof d=="number"||typeof d=="bigint")&&l!=="body"&&ea(s,""+d);break;case"className":xa(s,"class",d);break;case"tabIndex":xa(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":xa(s,c,d);break;case"style":Wu(s,d,_);break;case"data":if(l!=="object"){xa(s,"data",d);break}case"src":case"href":if(d===""&&(l!=="a"||c!=="href")){s.removeAttribute(c);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=xc(""+d),s.setAttribute(c,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(c==="formAction"?(l!=="input"&&sr(s,l,"name",v.name,v,null),sr(s,l,"formEncType",v.formEncType,v,null),sr(s,l,"formMethod",v.formMethod,v,null),sr(s,l,"formTarget",v.formTarget,v,null)):(sr(s,l,"encType",v.encType,v,null),sr(s,l,"method",v.method,v,null),sr(s,l,"target",v.target,v,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(c);break}d=xc(""+d),s.setAttribute(c,d);break;case"onClick":d!=null&&(s.onclick=os);break;case"onScroll":d!=null&&Nt("scroll",s);break;case"onScrollEnd":d!=null&&Nt("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}c=xc(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""+d):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":d===!0?s.setAttribute(c,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(c,d):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(c,d):s.removeAttribute(c);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(c):s.setAttribute(c,d);break;case"popover":Nt("beforetoggle",s),Nt("toggle",s),Cn(s,"popover",d);break;case"xlinkActuate":Hr(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Hr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Hr(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Hr(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Hr(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Hr(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Hr(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Hr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Hr(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Cn(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=dh.get(c)||c,Cn(s,c,d))}}function d1(s,l,c,d,v,_){switch(c){case"style":Wu(s,d,_);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(n(61));if(c=d.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"children":typeof d=="string"?ea(s,d):(typeof d=="number"||typeof d=="bigint")&&ea(s,""+d);break;case"onScroll":d!=null&&Nt("scroll",s);break;case"onScrollEnd":d!=null&&Nt("scrollend",s);break;case"onClick":d!=null&&(s.onclick=os);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Kt.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(v=c.endsWith("Capture"),l=c.slice(2,v?c.length-7:void 0),_=s[Q]||null,_=_!=null?_[c]:null,typeof _=="function"&&s.removeEventListener(l,_,v),typeof d=="function")){typeof _!="function"&&_!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(l,d,v);break e}c in s?s[c]=d:d===!0?s.setAttribute(c,""):Cn(s,c,d)}}}function _n(s,l,c){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Nt("error",s),Nt("load",s);var d=!1,v=!1,_;for(_ in c)if(c.hasOwnProperty(_)){var C=c[_];if(C!=null)switch(_){case"src":d=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:sr(s,l,_,C,c,null)}}v&&sr(s,l,"srcSet",c.srcSet,c,null),d&&sr(s,l,"src",c.src,c,null);return;case"input":Nt("invalid",s);var V=_=C=v=null,ae=null,pe=null;for(d in c)if(c.hasOwnProperty(d)){var ke=c[d];if(ke!=null)switch(d){case"name":v=ke;break;case"type":C=ke;break;case"checked":ae=ke;break;case"defaultChecked":pe=ke;break;case"value":_=ke;break;case"defaultValue":V=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(n(137,l));break;default:sr(s,l,d,ke,c,null)}}uh(s,_,V,ae,pe,C,v,!1);return;case"select":Nt("invalid",s),d=C=_=null;for(v in c)if(c.hasOwnProperty(v)&&(V=c[v],V!=null))switch(v){case"value":_=V;break;case"defaultValue":C=V;break;case"multiple":d=V;default:sr(s,l,v,V,c,null)}l=_,c=C,s.multiple=!!d,l!=null?Xi(s,!!d,l,!1):c!=null&&Xi(s,!!d,c,!0);return;case"textarea":Nt("invalid",s),_=v=d=null;for(C in c)if(c.hasOwnProperty(C)&&(V=c[C],V!=null))switch(C){case"value":d=V;break;case"defaultValue":v=V;break;case"children":_=V;break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(n(91));break;default:sr(s,l,C,V,c,null)}Yi(s,d,v,_);return;case"option":for(ae in c)if(c.hasOwnProperty(ae)&&(d=c[ae],d!=null))switch(ae){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:sr(s,l,ae,d,c,null)}return;case"dialog":Nt("beforetoggle",s),Nt("toggle",s),Nt("cancel",s),Nt("close",s);break;case"iframe":case"object":Nt("load",s);break;case"video":case"audio":for(d=0;d<kf.length;d++)Nt(kf[d],s);break;case"image":Nt("error",s),Nt("load",s);break;case"details":Nt("toggle",s);break;case"embed":case"source":case"link":Nt("error",s),Nt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in c)if(c.hasOwnProperty(pe)&&(d=c[pe],d!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:sr(s,l,pe,d,c,null)}return;default:if(gc(l)){for(ke in c)c.hasOwnProperty(ke)&&(d=c[ke],d!==void 0&&d1(s,l,ke,d,c,void 0));return}}for(V in c)c.hasOwnProperty(V)&&(d=c[V],d!=null&&sr(s,l,V,d,c,null))}function v6(s,l,c,d){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,_=null,C=null,V=null,ae=null,pe=null,ke=null;for(we in c){var Oe=c[we];if(c.hasOwnProperty(we)&&Oe!=null)switch(we){case"checked":break;case"value":break;case"defaultValue":ae=Oe;default:d.hasOwnProperty(we)||sr(s,l,we,null,d,Oe)}}for(var ve in d){var we=d[ve];if(Oe=c[ve],d.hasOwnProperty(ve)&&(we!=null||Oe!=null))switch(ve){case"type":_=we;break;case"name":v=we;break;case"checked":pe=we;break;case"defaultChecked":ke=we;break;case"value":C=we;break;case"defaultValue":V=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(n(137,l));break;default:we!==Oe&&sr(s,l,ve,we,d,Oe)}}pc(s,C,V,ae,pe,ke,_,v);return;case"select":we=C=V=ve=null;for(_ in c)if(ae=c[_],c.hasOwnProperty(_)&&ae!=null)switch(_){case"value":break;case"multiple":we=ae;default:d.hasOwnProperty(_)||sr(s,l,_,null,d,ae)}for(v in d)if(_=d[v],ae=c[v],d.hasOwnProperty(v)&&(_!=null||ae!=null))switch(v){case"value":ve=_;break;case"defaultValue":V=_;break;case"multiple":C=_;default:_!==ae&&sr(s,l,v,_,d,ae)}l=V,c=C,d=we,ve!=null?Xi(s,!!c,ve,!1):!!d!=!!c&&(l!=null?Xi(s,!!c,l,!0):Xi(s,!!c,c?[]:"",!1));return;case"textarea":we=ve=null;for(V in c)if(v=c[V],c.hasOwnProperty(V)&&v!=null&&!d.hasOwnProperty(V))switch(V){case"value":break;case"children":break;default:sr(s,l,V,null,d,v)}for(C in d)if(v=d[C],_=c[C],d.hasOwnProperty(C)&&(v!=null||_!=null))switch(C){case"value":ve=v;break;case"defaultValue":we=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(n(91));break;default:v!==_&&sr(s,l,C,v,d,_)}fh(s,ve,we);return;case"option":for(var Je in c)if(ve=c[Je],c.hasOwnProperty(Je)&&ve!=null&&!d.hasOwnProperty(Je))switch(Je){case"selected":s.selected=!1;break;default:sr(s,l,Je,null,d,ve)}for(ae in d)if(ve=d[ae],we=c[ae],d.hasOwnProperty(ae)&&ve!==we&&(ve!=null||we!=null))switch(ae){case"selected":s.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:sr(s,l,ae,ve,d,we)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var lt in c)ve=c[lt],c.hasOwnProperty(lt)&&ve!=null&&!d.hasOwnProperty(lt)&&sr(s,l,lt,null,d,ve);for(pe in d)if(ve=d[pe],we=c[pe],d.hasOwnProperty(pe)&&ve!==we&&(ve!=null||we!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,l));break;default:sr(s,l,pe,ve,d,we)}return;default:if(gc(l)){for(var ir in c)ve=c[ir],c.hasOwnProperty(ir)&&ve!==void 0&&!d.hasOwnProperty(ir)&&d1(s,l,ir,void 0,d,ve);for(ke in d)ve=d[ke],we=c[ke],!d.hasOwnProperty(ke)||ve===we||ve===void 0&&we===void 0||d1(s,l,ke,ve,d,we);return}}for(var ue in c)ve=c[ue],c.hasOwnProperty(ue)&&ve!=null&&!d.hasOwnProperty(ue)&&sr(s,l,ue,null,d,ve);for(Oe in d)ve=d[Oe],we=c[Oe],!d.hasOwnProperty(Oe)||ve===we||ve==null&&we==null||sr(s,l,Oe,ve,d,we)}function rw(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function y6(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,c=performance.getEntriesByType("resource"),d=0;d<c.length;d++){var v=c[d],_=v.transferSize,C=v.initiatorType,V=v.duration;if(_&&V&&rw(C)){for(C=0,V=v.responseEnd,d+=1;d<c.length;d++){var ae=c[d],pe=ae.startTime;if(pe>V)break;var ke=ae.transferSize,Oe=ae.initiatorType;ke&&rw(Oe)&&(ae=ae.responseEnd,C+=ke*(ae<V?1:(V-pe)/(ae-pe)))}if(--d,l+=8*(_+C)/(v.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var m1=null,p1=null;function md(s){return s.nodeType===9?s:s.ownerDocument}function nw(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function aw(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function g1(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var x1=null;function _6(){var s=window.event;return s&&s.type==="popstate"?s===x1?!1:(x1=s,!0):(x1=null,!1)}var sw=typeof setTimeout=="function"?setTimeout:void 0,b6=typeof clearTimeout=="function"?clearTimeout:void 0,iw=typeof Promise=="function"?Promise:void 0,w6=typeof queueMicrotask=="function"?queueMicrotask:typeof iw<"u"?function(s){return iw.resolve(null).then(s).catch(E6)}:sw;function E6(s){setTimeout(function(){throw s})}function xl(s){return s==="head"}function lw(s,l){var c=l,d=0;do{var v=c.nextSibling;if(s.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"||c==="/&"){if(d===0){s.removeChild(v),Qc(l);return}d--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")d++;else if(c==="html")Cf(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,Cf(c);for(var _=c.firstChild;_;){var C=_.nextSibling,V=_.nodeName;_[ge]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&_.rel.toLowerCase()==="stylesheet"||c.removeChild(_),_=C}}else c==="body"&&Cf(s.ownerDocument.body);c=v}while(c);Qc(l)}function ow(s,l){var c=s;s=0;do{var d=c.nextSibling;if(c.nodeType===1?l?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(l?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),d&&d.nodeType===8)if(c=d.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=d}while(c)}function v1(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var c=l;switch(l=l.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":v1(c),Be(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function T6(s,l,c,d){for(;s.nodeType===1;){var v=c;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[ge])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var _=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=Ha(s.nextSibling),s===null)break}return null}function S6(s,l,c){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Ha(s.nextSibling),s===null))return null;return s}function cw(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Ha(s.nextSibling),s===null))return null;return s}function y1(s){return s.data==="$?"||s.data==="$~"}function _1(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function A6(s,l){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||c.readyState!=="loading")l();else{var d=function(){l(),c.removeEventListener("DOMContentLoaded",d)};c.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function Ha(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var b1=null;function uw(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(l===0)return Ha(s.nextSibling);l--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||l++}s=s.nextSibling}return null}function fw(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(l===0)return s;l--}else c!=="/$"&&c!=="/&"||l++}s=s.previousSibling}return null}function hw(s,l,c){switch(l=md(c),s){case"html":if(s=l.documentElement,!s)throw Error(n(452));return s;case"head":if(s=l.head,!s)throw Error(n(453));return s;case"body":if(s=l.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Cf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Be(s)}var qa=new Map,dw=new Set;function pd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ei=se.d;se.d={f:k6,r:N6,D:C6,C:R6,L:I6,m:D6,X:F6,S:O6,M:j6};function k6(){var s=Ei.f(),l=id();return s||l}function N6(s){var l=Xe(s);l!==null&&l.tag===5&&l.type==="form"?R2(l):Ei.r(s)}var Yc=typeof document>"u"?null:document;function mw(s,l,c){var d=Yc;if(d&&typeof l=="string"&&l){var v=Zn(l);v='link[rel="'+s+'"][href="'+v+'"]',typeof c=="string"&&(v+='[crossorigin="'+c+'"]'),dw.has(v)||(dw.add(v),s={rel:s,crossOrigin:c,href:l},d.querySelector(v)===null&&(l=d.createElement("link"),_n(l,"link",s),Ze(l),d.head.appendChild(l)))}}function C6(s){Ei.D(s),mw("dns-prefetch",s,null)}function R6(s,l){Ei.C(s,l),mw("preconnect",s,l)}function I6(s,l,c){Ei.L(s,l,c);var d=Yc;if(d&&s&&l){var v='link[rel="preload"][as="'+Zn(l)+'"]';l==="image"&&c&&c.imageSrcSet?(v+='[imagesrcset="'+Zn(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(v+='[imagesizes="'+Zn(c.imageSizes)+'"]')):v+='[href="'+Zn(s)+'"]';var _=v;switch(l){case"style":_=$c(s);break;case"script":_=Kc(s)}qa.has(_)||(s=x({rel:"preload",href:l==="image"&&c&&c.imageSrcSet?void 0:s,as:l},c),qa.set(_,s),d.querySelector(v)!==null||l==="style"&&d.querySelector(Rf(_))||l==="script"&&d.querySelector(If(_))||(l=d.createElement("link"),_n(l,"link",s),Ze(l),d.head.appendChild(l)))}}function D6(s,l){Ei.m(s,l);var c=Yc;if(c&&s){var d=l&&typeof l.as=="string"?l.as:"script",v='link[rel="modulepreload"][as="'+Zn(d)+'"][href="'+Zn(s)+'"]',_=v;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Kc(s)}if(!qa.has(_)&&(s=x({rel:"modulepreload",href:s},l),qa.set(_,s),c.querySelector(v)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(If(_)))return}d=c.createElement("link"),_n(d,"link",s),Ze(d),c.head.appendChild(d)}}}function O6(s,l,c){Ei.S(s,l,c);var d=Yc;if(d&&s){var v=We(d).hoistableStyles,_=$c(s);l=l||"default";var C=v.get(_);if(!C){var V={loading:0,preload:null};if(C=d.querySelector(Rf(_)))V.loading=5;else{s=x({rel:"stylesheet",href:s,"data-precedence":l},c),(c=qa.get(_))&&w1(s,c);var ae=C=d.createElement("link");Ze(ae),_n(ae,"link",s),ae._p=new Promise(function(pe,ke){ae.onload=pe,ae.onerror=ke}),ae.addEventListener("load",function(){V.loading|=1}),ae.addEventListener("error",function(){V.loading|=2}),V.loading|=4,gd(C,l,d)}C={type:"stylesheet",instance:C,count:1,state:V},v.set(_,C)}}}function F6(s,l){Ei.X(s,l);var c=Yc;if(c&&s){var d=We(c).hoistableScripts,v=Kc(s),_=d.get(v);_||(_=c.querySelector(If(v)),_||(s=x({src:s,async:!0},l),(l=qa.get(v))&&E1(s,l),_=c.createElement("script"),Ze(_),_n(_,"link",s),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},d.set(v,_))}}function j6(s,l){Ei.M(s,l);var c=Yc;if(c&&s){var d=We(c).hoistableScripts,v=Kc(s),_=d.get(v);_||(_=c.querySelector(If(v)),_||(s=x({src:s,async:!0,type:"module"},l),(l=qa.get(v))&&E1(s,l),_=c.createElement("script"),Ze(_),_n(_,"link",s),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},d.set(v,_))}}function pw(s,l,c,d){var v=(v=oe.current)?pd(v):null;if(!v)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(l=$c(c.href),c=We(v).hoistableStyles,d=c.get(l),d||(d={type:"style",instance:null,count:0,state:null},c.set(l,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=$c(c.href);var _=We(v).hoistableStyles,C=_.get(s);if(C||(v=v.ownerDocument||v,C={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,C),(_=v.querySelector(Rf(s)))&&!_._p&&(C.instance=_,C.state.loading=5),qa.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},qa.set(s,c),_||P6(v,s,c,C.state))),l&&d===null)throw Error(n(528,""));return C}if(l&&d!==null)throw Error(n(529,""));return null;case"script":return l=c.async,c=c.src,typeof c=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Kc(c),c=We(v).hoistableScripts,d=c.get(l),d||(d={type:"script",instance:null,count:0,state:null},c.set(l,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function $c(s){return'href="'+Zn(s)+'"'}function Rf(s){return'link[rel="stylesheet"]['+s+"]"}function gw(s){return x({},s,{"data-precedence":s.precedence,precedence:null})}function P6(s,l,c,d){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?d.loading=1:(l=s.createElement("link"),d.preload=l,l.addEventListener("load",function(){return d.loading|=1}),l.addEventListener("error",function(){return d.loading|=2}),_n(l,"link",c),Ze(l),s.head.appendChild(l))}function Kc(s){return'[src="'+Zn(s)+'"]'}function If(s){return"script[async]"+s}function xw(s,l,c){if(l.count++,l.instance===null)switch(l.type){case"style":var d=s.querySelector('style[data-href~="'+Zn(c.href)+'"]');if(d)return l.instance=d,Ze(d),d;var v=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),Ze(d),_n(d,"style",v),gd(d,c.precedence,s),l.instance=d;case"stylesheet":v=$c(c.href);var _=s.querySelector(Rf(v));if(_)return l.state.loading|=4,l.instance=_,Ze(_),_;d=gw(c),(v=qa.get(v))&&w1(d,v),_=(s.ownerDocument||s).createElement("link"),Ze(_);var C=_;return C._p=new Promise(function(V,ae){C.onload=V,C.onerror=ae}),_n(_,"link",d),l.state.loading|=4,gd(_,c.precedence,s),l.instance=_;case"script":return _=Kc(c.src),(v=s.querySelector(If(_)))?(l.instance=v,Ze(v),v):(d=c,(v=qa.get(_))&&(d=x({},c),E1(d,v)),s=s.ownerDocument||s,v=s.createElement("script"),Ze(v),_n(v,"link",d),s.head.appendChild(v),l.instance=v);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(d=l.instance,l.state.loading|=4,gd(d,c.precedence,s));return l.instance}function gd(s,l,c){for(var d=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=d.length?d[d.length-1]:null,_=v,C=0;C<d.length;C++){var V=d[C];if(V.dataset.precedence===l)_=V;else if(_!==v)break}_?_.parentNode.insertBefore(s,_.nextSibling):(l=c.nodeType===9?c.head:c,l.insertBefore(s,l.firstChild))}function w1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function E1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var xd=null;function vw(s,l,c){if(xd===null){var d=new Map,v=xd=new Map;v.set(c,d)}else v=xd,d=v.get(c),d||(d=new Map,v.set(c,d));if(d.has(s))return d;for(d.set(s,null),c=c.getElementsByTagName(s),v=0;v<c.length;v++){var _=c[v];if(!(_[ge]||_[K]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var C=_.getAttribute(l)||"";C=s+C;var V=d.get(C);V?V.push(_):d.set(C,[_])}}return d}function yw(s,l,c){s=s.ownerDocument||s,s.head.insertBefore(c,l==="title"?s.querySelector("head > title"):null)}function M6(s,l,c){if(c===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function _w(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function L6(s,l,c,d){if(c.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var v=$c(d.href),_=l.querySelector(Rf(v));if(_){l=_._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=vd.bind(s),l.then(s,s)),c.state.loading|=4,c.instance=_,Ze(_);return}_=l.ownerDocument||l,d=gw(d),(v=qa.get(v))&&w1(d,v),_=_.createElement("link"),Ze(_);var C=_;C._p=new Promise(function(V,ae){C.onload=V,C.onerror=ae}),_n(_,"link",d),c.instance=_}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,l),(l=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=vd.bind(s),l.addEventListener("load",c),l.addEventListener("error",c))}}var T1=0;function B6(s,l){return s.stylesheets&&s.count===0&&_d(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var d=setTimeout(function(){if(s.stylesheets&&_d(s,s.stylesheets),s.unsuspend){var _=s.unsuspend;s.unsuspend=null,_()}},6e4+l);0<s.imgBytes&&T1===0&&(T1=62500*y6());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&_d(s,s.stylesheets),s.unsuspend)){var _=s.unsuspend;s.unsuspend=null,_()}},(s.imgBytes>T1?50:800)+l);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(d),clearTimeout(v)}}:null}function vd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)_d(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var yd=null;function _d(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,yd=new Map,l.forEach(V6,s),yd=null,vd.call(s))}function V6(s,l){if(!(l.state.loading&4)){var c=yd.get(s);if(c)var d=c.get(null);else{c=new Map,yd.set(s,c);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<v.length;_++){var C=v[_];(C.nodeName==="LINK"||C.getAttribute("media")!=="not all")&&(c.set(C.dataset.precedence,C),d=C)}d&&c.set(null,d)}v=l.instance,C=v.getAttribute("data-precedence"),_=c.get(C)||d,_===d&&c.set(null,v),c.set(C,v),this.count++,d=vd.bind(this),v.addEventListener("load",d),v.addEventListener("error",d),_?_.parentNode.insertBefore(v,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),l.state.loading|=4}}var Df={$$typeof:N,Provider:null,Consumer:null,_currentValue:Ee,_currentValue2:Ee,_threadCount:0};function U6(s,l,c,d,v,_,C,V,ae){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oa(0),this.hiddenUpdates=Oa(null),this.identifierPrefix=d,this.onUncaughtError=v,this.onCaughtError=_,this.onRecoverableError=C,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ae,this.incompleteTransitions=new Map}function bw(s,l,c,d,v,_,C,V,ae,pe,ke,Oe){return s=new U6(s,l,c,C,ae,pe,ke,Oe,V),l=1,_===!0&&(l|=24),_=ya(3,null,null,l),s.current=_,_.stateNode=s,l=ng(),l.refCount++,s.pooledCache=l,l.refCount++,_.memoizedState={element:d,isDehydrated:c,cache:l},lg(_),s}function ww(s){return s?(s=kc,s):kc}function Ew(s,l,c,d,v,_){v=ww(v),d.context===null?d.context=v:d.pendingContext=v,d=il(l),d.payload={element:c},_=_===void 0?null:_,_!==null&&(d.callback=_),c=ll(s,d,l),c!==null&&(sa(c,s,l),uf(c,s,l))}function Tw(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<l?c:l}}function S1(s,l){Tw(s,l),(s=s.alternate)&&Tw(s,l)}function Sw(s){if(s.tag===13||s.tag===31){var l=wo(s,67108864);l!==null&&sa(l,s,67108864),S1(s,67108864)}}function Aw(s){if(s.tag===13||s.tag===31){var l=Ta();l=si(l);var c=wo(s,l);c!==null&&sa(c,s,l),S1(s,l)}}var bd=!0;function z6(s,l,c,d){var v=ne.T;ne.T=null;var _=se.p;try{se.p=2,A1(s,l,c,d)}finally{se.p=_,ne.T=v}}function H6(s,l,c,d){var v=ne.T;ne.T=null;var _=se.p;try{se.p=8,A1(s,l,c,d)}finally{se.p=_,ne.T=v}}function A1(s,l,c,d){if(bd){var v=k1(d);if(v===null)h1(s,l,d,wd,c),Nw(s,d);else if(G6(v,s,l,c,d))d.stopPropagation();else if(Nw(s,d),l&4&&-1<q6.indexOf(s)){for(;v!==null;){var _=Xe(v);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var C=qn(_.pendingLanes);if(C!==0){var V=_;for(V.pendingLanes|=2,V.entangledLanes|=2;C;){var ae=1<<31-mr(C);V.entanglements[1]|=ae,C&=~ae}Ms(_),(Gt&6)===0&&(ad=Ht()+500,Af(0))}}break;case 31:case 13:V=wo(_,2),V!==null&&sa(V,_,2),id(),S1(_,2)}if(_=k1(d),_===null&&h1(s,l,d,wd,c),_===v)break;v=_}v!==null&&d.stopPropagation()}else h1(s,l,d,null,c)}}function k1(s){return s=Fa(s),N1(s)}var wd=null;function N1(s){if(wd=null,s=Ue(s),s!==null){var l=i(s);if(l===null)s=null;else{var c=l.tag;if(c===13){if(s=o(l),s!==null)return s;s=null}else if(c===31){if(s=u(l),s!==null)return s;s=null}else if(c===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return wd=s,null}function kw(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(en()){case kn:return 2;case Jn:return 8;case Yt:case on:return 32;case dt:return 268435456;default:return 32}default:return 32}}var C1=!1,vl=null,yl=null,_l=null,Of=new Map,Ff=new Map,bl=[],q6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Nw(s,l){switch(s){case"focusin":case"focusout":vl=null;break;case"dragenter":case"dragleave":yl=null;break;case"mouseover":case"mouseout":_l=null;break;case"pointerover":case"pointerout":Of.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ff.delete(l.pointerId)}}function jf(s,l,c,d,v,_){return s===null||s.nativeEvent!==_?(s={blockedOn:l,domEventName:c,eventSystemFlags:d,nativeEvent:_,targetContainers:[v]},l!==null&&(l=Xe(l),l!==null&&Sw(l)),s):(s.eventSystemFlags|=d,l=s.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),s)}function G6(s,l,c,d,v){switch(l){case"focusin":return vl=jf(vl,s,l,c,d,v),!0;case"dragenter":return yl=jf(yl,s,l,c,d,v),!0;case"mouseover":return _l=jf(_l,s,l,c,d,v),!0;case"pointerover":var _=v.pointerId;return Of.set(_,jf(Of.get(_)||null,s,l,c,d,v)),!0;case"gotpointercapture":return _=v.pointerId,Ff.set(_,jf(Ff.get(_)||null,s,l,c,d,v)),!0}return!1}function Cw(s){var l=Ue(s.target);if(l!==null){var c=i(l);if(c!==null){if(l=c.tag,l===13){if(l=o(c),l!==null){s.blockedOn=l,J(s.priority,function(){Aw(c)});return}}else if(l===31){if(l=u(c),l!==null){s.blockedOn=l,J(s.priority,function(){Aw(c)});return}}else if(l===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ed(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var c=k1(s.nativeEvent);if(c===null){c=s.nativeEvent;var d=new c.constructor(c.type,c);Xu=d,c.target.dispatchEvent(d),Xu=null}else return l=Xe(c),l!==null&&Sw(l),s.blockedOn=c,!1;l.shift()}return!0}function Rw(s,l,c){Ed(s)&&c.delete(l)}function W6(){C1=!1,vl!==null&&Ed(vl)&&(vl=null),yl!==null&&Ed(yl)&&(yl=null),_l!==null&&Ed(_l)&&(_l=null),Of.forEach(Rw),Ff.forEach(Rw)}function Td(s,l){s.blockedOn===l&&(s.blockedOn=null,C1||(C1=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,W6)))}var Sd=null;function Iw(s){Sd!==s&&(Sd=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Sd===s&&(Sd=null);for(var l=0;l<s.length;l+=3){var c=s[l],d=s[l+1],v=s[l+2];if(typeof d!="function"){if(N1(d||c)===null)continue;break}var _=Xe(c);_!==null&&(s.splice(l,3),l-=3,kg(_,{pending:!0,data:v,method:c.method,action:d},d,v))}}))}function Qc(s){function l(ae){return Td(ae,s)}vl!==null&&Td(vl,s),yl!==null&&Td(yl,s),_l!==null&&Td(_l,s),Of.forEach(l),Ff.forEach(l);for(var c=0;c<bl.length;c++){var d=bl[c];d.blockedOn===s&&(d.blockedOn=null)}for(;0<bl.length&&(c=bl[0],c.blockedOn===null);)Cw(c),c.blockedOn===null&&bl.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(d=0;d<c.length;d+=3){var v=c[d],_=c[d+1],C=v[Q]||null;if(typeof _=="function")C||Iw(c);else if(C){var V=null;if(_&&_.hasAttribute("formAction")){if(v=_,C=_[Q]||null)V=C.formAction;else if(N1(v)!==null)continue}else V=C.action;typeof V=="function"?c[d+1]=V:(c.splice(d,3),d-=3),Iw(c)}}}function Dw(){function s(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(C){return v=C})},focusReset:"manual",scroll:"manual"})}function l(){v!==null&&(v(),v=null),d||setTimeout(c,20)}function c(){if(!d&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(c,100),function(){d=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),v!==null&&(v(),v=null)}}}function R1(s){this._internalRoot=s}Ad.prototype.render=R1.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(n(409));var c=l.current,d=Ta();Ew(c,d,s,l,null,null)},Ad.prototype.unmount=R1.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;Ew(s.current,2,null,s,null,null),id(),l[te]=null}};function Ad(s){this._internalRoot=s}Ad.prototype.unstable_scheduleHydration=function(s){if(s){var l=B();s={blockedOn:null,target:s,priority:l};for(var c=0;c<bl.length&&l!==0&&l<bl[c].priority;c++);bl.splice(c,0,s),c===0&&Cw(s)}};var Ow=e.version;if(Ow!=="19.2.1")throw Error(n(527,Ow,"19.2.1"));se.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=h(l),s=s!==null?p(s):null,s=s===null?null:s.stateNode,s};var X6={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kd.isDisabled&&kd.supportsFiber)try{Mt=kd.inject(X6),or=kd}catch{}}return Mf.createRoot=function(s,l){if(!a(s))throw Error(n(299));var c=!1,d="",v=V2,_=U2,C=z2;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(d=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(_=l.onCaughtError),l.onRecoverableError!==void 0&&(C=l.onRecoverableError)),l=bw(s,1,!1,null,null,c,d,null,v,_,C,Dw),s[te]=l.current,f1(s),new R1(l)},Mf.hydrateRoot=function(s,l,c){if(!a(s))throw Error(n(299));var d=!1,v="",_=V2,C=U2,V=z2,ae=null;return c!=null&&(c.unstable_strictMode===!0&&(d=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onUncaughtError!==void 0&&(_=c.onUncaughtError),c.onCaughtError!==void 0&&(C=c.onCaughtError),c.onRecoverableError!==void 0&&(V=c.onRecoverableError),c.formState!==void 0&&(ae=c.formState)),l=bw(s,1,!0,l,c??null,d,v,ae,_,C,V,Dw),l.context=ww(null),c=l.current,d=Ta(),d=si(d),v=il(d),v.callback=null,ll(c,v,d),c=d,l.current.lanes=c,ri(l,c),Ms(l),s[te]=l.current,f1(s),new Ad(l)},Mf.version="19.2.1",Mf}var Hw;function nR(){if(Hw)return O1.exports;Hw=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),O1.exports=rR(),O1.exports}var aR=nR();const sR=YS(aR);var qw="popstate";function iR(t={}){function e(a,i){let{pathname:o="/",search:u="",hash:f=""}=ac(a.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),vx("",{pathname:o,search:u,hash:f},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(a,i){let o=a.document.querySelector("base"),u="";if(o&&o.getAttribute("href")){let f=a.location.href,h=f.indexOf("#");u=h===-1?f:f.slice(0,h)}return u+"#"+(typeof i=="string"?i:c0(i))}function n(a,i){Ra(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return oR(e,r,n,t)}function Sr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ra(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function lR(){return Math.random().toString(36).substring(2,10)}function Gw(t,e){return{usr:t.state,key:t.key,idx:e}}function vx(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ac(e):e,state:r,key:e&&e.key||n||lR()}}function c0({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ac(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function oR(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,u="POP",f=null,h=p();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function p(){return(o.state||{idx:null}).idx}function x(){u="POP";let E=p(),k=E==null?null:E-h;h=E,f&&f({action:u,location:T.location,delta:k})}function y(E,k){u="PUSH";let I=vx(T.location,E,k);r&&r(I,E),h=p()+1;let N=Gw(I,h),z=T.createHref(I);try{o.pushState(N,"",z)}catch(H){if(H instanceof DOMException&&H.name==="DataCloneError")throw H;a.location.assign(z)}i&&f&&f({action:u,location:T.location,delta:1})}function b(E,k){u="REPLACE";let I=vx(T.location,E,k);r&&r(I,E),h=p();let N=Gw(I,h),z=T.createHref(I);o.replaceState(N,"",z),i&&f&&f({action:u,location:T.location,delta:0})}function w(E){return cR(E)}let T={get action(){return u},get location(){return t(a,o)},listen(E){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(qw,x),f=E,()=>{a.removeEventListener(qw,x),f=null}},createHref(E){return e(a,E)},createURL:w,encodeLocation(E){let k=w(E);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:y,replace:b,go(E){return o.go(E)}};return T}function cR(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Sr(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:c0(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function $S(t,e,r="/"){return uR(t,e,r,!1)}function uR(t,e,r,n){let a=typeof e=="string"?ac(e):e,i=Oi(a.pathname||"/",r);if(i==null)return null;let o=KS(t);fR(o);let u=null;for(let f=0;u==null&&f<o.length;++f){let h=wR(i);u=_R(o[f],h,n)}return u}function KS(t,e=[],r=[],n="",a=!1){let i=(o,u,f=a,h)=>{let p={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&f)return;Sr(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let x=Ni([n,p.relativePath]),y=r.concat(p);o.children&&o.children.length>0&&(Sr(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),KS(o.children,e,y,x,f)),!(o.path==null&&!o.index)&&e.push({path:x,score:vR(x,o.index),routesMeta:y})};return t.forEach((o,u)=>{if(o.path===""||!o.path?.includes("?"))i(o,u);else for(let f of QS(o.path))i(o,u,!0,f)}),e}function QS(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=QS(n.join("/")),u=[];return u.push(...o.map(f=>f===""?i:[i,f].join("/"))),a&&u.push(...o),u.map(f=>t.startsWith("/")&&f===""?"/":f)}function fR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:yR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var hR=/^:[\w-]+$/,dR=3,mR=2,pR=1,gR=10,xR=-2,Ww=t=>t==="*";function vR(t,e){let r=t.split("/"),n=r.length;return r.some(Ww)&&(n+=xR),e&&(n+=mR),r.filter(a=>!Ww(a)).reduce((a,i)=>a+(hR.test(i)?dR:i===""?pR:gR),n)}function yR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function _R(t,e,r=!1){let{routesMeta:n}=t,a={},i="/",o=[];for(let u=0;u<n.length;++u){let f=n[u],h=u===n.length-1,p=i==="/"?e:e.slice(i.length)||"/",x=fm({path:f.relativePath,caseSensitive:f.caseSensitive,end:h},p),y=f.route;if(!x&&h&&r&&!n[n.length-1].route.index&&(x=fm({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!x)return null;Object.assign(a,x.params),o.push({params:a,pathname:Ni([i,x.pathname]),pathnameBase:kR(Ni([i,x.pathnameBase])),route:y}),x.pathnameBase!=="/"&&(i=Ni([i,x.pathnameBase]))}return o}function fm(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=bR(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((h,{paramName:p,isOptional:x},y)=>{if(p==="*"){let w=u[y]||"";o=i.slice(0,i.length-w.length).replace(/(.)\/+$/,"$1")}const b=u[y];return x&&!b?h[p]=void 0:h[p]=(b||"").replace(/%2F/g,"/"),h},{}),pathname:i,pathnameBase:o,pattern:t}}function bR(t,e=!1,r=!0){Ra(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,f)=>(n.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function wR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ra(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Oi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}var ER=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,TR=t=>ER.test(t);function SR(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?ac(t):t,i;if(r)if(TR(r))i=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Ra(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${r}`)}r.startsWith("/")?i=Xw(r.substring(1),"/"):i=Xw(r,e)}else i=e;return{pathname:i,search:NR(n),hash:CR(a)}}function Xw(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function M1(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function AR(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function hv(t){let e=AR(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function dv(t,e,r,n=!1){let a;typeof t=="string"?a=ac(t):(a={...t},Sr(!a.pathname||!a.pathname.includes("?"),M1("?","pathname","search",a)),Sr(!a.pathname||!a.pathname.includes("#"),M1("#","pathname","hash",a)),Sr(!a.search||!a.search.includes("#"),M1("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,u;if(o==null)u=r;else{let x=e.length-1;if(!n&&o.startsWith("..")){let y=o.split("/");for(;y[0]==="..";)y.shift(),x-=1;a.pathname=y.join("/")}u=x>=0?e[x]:"/"}let f=SR(a,u),h=o&&o!=="/"&&o.endsWith("/"),p=(i||o===".")&&r.endsWith("/");return!f.pathname.endsWith("/")&&(h||p)&&(f.pathname+="/"),f}var Ni=t=>t.join("/").replace(/\/\/+/g,"/"),kR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),NR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,CR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function RR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function IR(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var JS=["POST","PUT","PATCH","DELETE"];new Set(JS);var DR=["GET",...JS];new Set(DR);var ku=ee.createContext(null);ku.displayName="DataRouter";var Km=ee.createContext(null);Km.displayName="DataRouterState";ee.createContext(!1);var ZS=ee.createContext({isTransitioning:!1});ZS.displayName="ViewTransition";var OR=ee.createContext(new Map);OR.displayName="Fetchers";var FR=ee.createContext(null);FR.displayName="Await";var ts=ee.createContext(null);ts.displayName="Navigation";var O0=ee.createContext(null);O0.displayName="Location";var Js=ee.createContext({outlet:null,matches:[],isDataRoute:!1});Js.displayName="Route";var mv=ee.createContext(null);mv.displayName="RouteError";function jR(t,{relative:e}={}){Sr(Nu(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=ee.useContext(ts),{hash:a,pathname:i,search:o}=F0(t,{relative:e}),u=i;return r!=="/"&&(u=i==="/"?r:Ni([r,i])),n.createHref({pathname:u,search:o,hash:a})}function Nu(){return ee.useContext(O0)!=null}function eo(){return Sr(Nu(),"useLocation() may be used only in the context of a <Router> component."),ee.useContext(O0).location}var e4="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function t4(t){ee.useContext(ts).static||ee.useLayoutEffect(t)}function Qm(){let{isDataRoute:t}=ee.useContext(Js);return t?YR():PR()}function PR(){Sr(Nu(),"useNavigate() may be used only in the context of a <Router> component.");let t=ee.useContext(ku),{basename:e,navigator:r}=ee.useContext(ts),{matches:n}=ee.useContext(Js),{pathname:a}=eo(),i=JSON.stringify(hv(n)),o=ee.useRef(!1);return t4(()=>{o.current=!0}),ee.useCallback((f,h={})=>{if(Ra(o.current,e4),!o.current)return;if(typeof f=="number"){r.go(f);return}let p=dv(f,JSON.parse(i),a,h.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Ni([e,p.pathname])),(h.replace?r.replace:r.push)(p,h.state,h)},[e,r,i,a,t])}ee.createContext(null);function F0(t,{relative:e}={}){let{matches:r}=ee.useContext(Js),{pathname:n}=eo(),a=JSON.stringify(hv(r));return ee.useMemo(()=>dv(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function MR(t,e){return r4(t,e)}function r4(t,e,r,n,a){Sr(Nu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=ee.useContext(ts),{matches:o}=ee.useContext(Js),u=o[o.length-1],f=u?u.params:{},h=u?u.pathname:"/",p=u?u.pathnameBase:"/",x=u&&u.route;{let I=x&&x.path||"";n4(h,!x||I.endsWith("*")||I.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${I}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${I}"> to <Route path="${I==="/"?"*":`${I}/*`}">.`)}let y=eo(),b;if(e){let I=typeof e=="string"?ac(e):e;Sr(p==="/"||I.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${I.pathname}" was given in the \`location\` prop.`),b=I}else b=y;let w=b.pathname||"/",T=w;if(p!=="/"){let I=p.replace(/^\//,"").split("/");T="/"+w.replace(/^\//,"").split("/").slice(I.length).join("/")}let E=$S(t,{pathname:T});Ra(x||E!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Ra(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let k=zR(E&&E.map(I=>Object.assign({},I,{params:Object.assign({},f,I.params),pathname:Ni([p,i.encodeLocation?i.encodeLocation(I.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?p:Ni([p,i.encodeLocation?i.encodeLocation(I.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:I.pathnameBase])})),o,r,n,a);return e&&k?ee.createElement(O0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},k):k}function LR(){let t=XR(),e=RR(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=ee.createElement(ee.Fragment,null,ee.createElement("p",null," Hey developer "),ee.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ee.createElement("code",{style:i},"ErrorBoundary")," or"," ",ee.createElement("code",{style:i},"errorElement")," prop on your route.")),ee.createElement(ee.Fragment,null,ee.createElement("h2",null,"Unexpected Application Error!"),ee.createElement("h3",{style:{fontStyle:"italic"}},e),r?ee.createElement("pre",{style:a},r):null,o)}var BR=ee.createElement(LR,null),VR=class extends ee.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?ee.createElement(Js.Provider,{value:this.props.routeContext},ee.createElement(mv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function UR({routeContext:t,match:e,children:r}){let n=ee.useContext(ku);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),ee.createElement(Js.Provider,{value:t},r)}function zR(t,e=[],r=null,n=null,a=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,o=r?.errors;if(o!=null){let p=i.findIndex(x=>x.route.id&&o?.[x.route.id]!==void 0);Sr(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,p+1))}let u=!1,f=-1;if(r)for(let p=0;p<i.length;p++){let x=i[p];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(f=p),x.route.id){let{loaderData:y,errors:b}=r,w=x.route.loader&&!y.hasOwnProperty(x.route.id)&&(!b||b[x.route.id]===void 0);if(x.route.lazy||w){u=!0,f>=0?i=i.slice(0,f+1):i=[i[0]];break}}}let h=r&&n?(p,x)=>{n(p,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:IR(r.matches),errorInfo:x})}:void 0;return i.reduceRight((p,x,y)=>{let b,w=!1,T=null,E=null;r&&(b=o&&x.route.id?o[x.route.id]:void 0,T=x.route.errorElement||BR,u&&(f<0&&y===0?(n4("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,E=null):f===y&&(w=!0,E=x.route.hydrateFallbackElement||null)));let k=e.concat(i.slice(0,y+1)),I=()=>{let N;return b?N=T:w?N=E:x.route.Component?N=ee.createElement(x.route.Component,null):x.route.element?N=x.route.element:N=p,ee.createElement(UR,{match:x,routeContext:{outlet:p,matches:k,isDataRoute:r!=null},children:N})};return r&&(x.route.ErrorBoundary||x.route.errorElement||y===0)?ee.createElement(VR,{location:r.location,revalidation:r.revalidation,component:T,error:b,children:I(),routeContext:{outlet:null,matches:k,isDataRoute:!0},onError:h}):I()},null)}function pv(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function HR(t){let e=ee.useContext(ku);return Sr(e,pv(t)),e}function qR(t){let e=ee.useContext(Km);return Sr(e,pv(t)),e}function GR(t){let e=ee.useContext(Js);return Sr(e,pv(t)),e}function gv(t){let e=GR(t),r=e.matches[e.matches.length-1];return Sr(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function WR(){return gv("useRouteId")}function XR(){let t=ee.useContext(mv),e=qR("useRouteError"),r=gv("useRouteError");return t!==void 0?t:e.errors?.[r]}function YR(){let{router:t}=HR("useNavigate"),e=gv("useNavigate"),r=ee.useRef(!1);return t4(()=>{r.current=!0}),ee.useCallback(async(a,i={})=>{Ra(r.current,e4),r.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...i}))},[t,e])}var Yw={};function n4(t,e,r){!e&&!Yw[t]&&(Yw[t]=!0,Ra(!1,r))}ee.memo($R);function $R({routes:t,future:e,state:r,unstable_onError:n}){return r4(t,void 0,r,n,e)}function Nd({to:t,replace:e,state:r,relative:n}){Sr(Nu(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=ee.useContext(ts);Ra(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=ee.useContext(Js),{pathname:o}=eo(),u=Qm(),f=dv(t,hv(i),o,n==="path"),h=JSON.stringify(f);return ee.useEffect(()=>{u(JSON.parse(h),{replace:e,state:r,relative:n})},[u,h,n,e,r]),null}function Uf(t){Sr(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function KR({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:i=!1,unstable_useTransitions:o}){Sr(!Nu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),f=ee.useMemo(()=>({basename:u,navigator:a,static:i,unstable_useTransitions:o,future:{}}),[u,a,i,o]);typeof r=="string"&&(r=ac(r));let{pathname:h="/",search:p="",hash:x="",state:y=null,key:b="default"}=r,w=ee.useMemo(()=>{let T=Oi(h,u);return T==null?null:{location:{pathname:T,search:p,hash:x,state:y,key:b},navigationType:n}},[u,h,p,x,y,b,n]);return Ra(w!=null,`<Router basename="${u}"> is not able to match the URL "${h}${p}${x}" because it does not start with the basename, so the <Router> won't render anything.`),w==null?null:ee.createElement(ts.Provider,{value:f},ee.createElement(O0.Provider,{children:e,value:w}))}function QR({children:t,location:e}){return MR(yx(t),e)}function yx(t,e=[]){let r=[];return ee.Children.forEach(t,(n,a)=>{if(!ee.isValidElement(n))return;let i=[...e,a];if(n.type===ee.Fragment){r.push.apply(r,yx(n.props.children,i));return}Sr(n.type===Uf,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Sr(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=yx(n.props.children,i)),r.push(o)}),r}var Zd="get",em="application/x-www-form-urlencoded";function Jm(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function JR(t){return Jm(t)&&t.tagName.toLowerCase()==="button"}function ZR(t){return Jm(t)&&t.tagName.toLowerCase()==="form"}function e5(t){return Jm(t)&&t.tagName.toLowerCase()==="input"}function t5(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function r5(t,e){return t.button===0&&(!e||e==="_self")&&!t5(t)}var Cd=null;function n5(){if(Cd===null)try{new FormData(document.createElement("form"),0),Cd=!1}catch{Cd=!0}return Cd}var a5=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function L1(t){return t!=null&&!a5.has(t)?(Ra(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${em}"`),null):t}function s5(t,e){let r,n,a,i,o;if(ZR(t)){let u=t.getAttribute("action");n=u?Oi(u,e):null,r=t.getAttribute("method")||Zd,a=L1(t.getAttribute("enctype"))||em,i=new FormData(t)}else if(JR(t)||e5(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||u.getAttribute("action");if(n=f?Oi(f,e):null,r=t.getAttribute("formmethod")||u.getAttribute("method")||Zd,a=L1(t.getAttribute("formenctype"))||L1(u.getAttribute("enctype"))||em,i=new FormData(u,t),!n5()){let{name:h,type:p,value:x}=t;if(p==="image"){let y=h?`${h}.`:"";i.append(`${y}x`,"0"),i.append(`${y}y`,"0")}else h&&i.append(h,x)}}else{if(Jm(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Zd,n=null,a=em,o=t}return i&&a==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function xv(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function i5(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&Oi(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function l5(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function o5(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function c5(t,e,r){let n=await Promise.all(t.map(async a=>{let i=e.routes[a.route.id];if(i){let o=await l5(i,r);return o.links?o.links():[]}return[]}));return d5(n.flat(1).filter(o5).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function $w(t,e,r,n,a,i){let o=(f,h)=>r[h]?f.route.id!==r[h].route.id:!0,u=(f,h)=>r[h].pathname!==f.pathname||r[h].route.path?.endsWith("*")&&r[h].params["*"]!==f.params["*"];return i==="assets"?e.filter((f,h)=>o(f,h)||u(f,h)):i==="data"?e.filter((f,h)=>{let p=n.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(o(f,h)||u(f,h))return!0;if(f.route.shouldRevalidate){let x=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function u5(t,e,{includeHydrateFallback:r}={}){return f5(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function f5(t){return[...new Set(t)]}function h5(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function d5(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let i=JSON.stringify(h5(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}function a4(){let t=ee.useContext(ku);return xv(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function m5(){let t=ee.useContext(Km);return xv(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var vv=ee.createContext(void 0);vv.displayName="FrameworkContext";function s4(){let t=ee.useContext(vv);return xv(t,"You must render this element inside a <HydratedRouter> element"),t}function p5(t,e){let r=ee.useContext(vv),[n,a]=ee.useState(!1),[i,o]=ee.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:h,onMouseLeave:p,onTouchStart:x}=e,y=ee.useRef(null);ee.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let T=k=>{k.forEach(I=>{o(I.isIntersecting)})},E=new IntersectionObserver(T,{threshold:.5});return y.current&&E.observe(y.current),()=>{E.disconnect()}}},[t]),ee.useEffect(()=>{if(n){let T=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(T)}}},[n]);let b=()=>{a(!0)},w=()=>{a(!1),o(!1)};return r?t!=="intent"?[i,y,{}]:[i,y,{onFocus:Lf(u,b),onBlur:Lf(f,w),onMouseEnter:Lf(h,b),onMouseLeave:Lf(p,w),onTouchStart:Lf(x,b)}]:[!1,y,{}]}function Lf(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function g5({page:t,...e}){let{router:r}=a4(),n=ee.useMemo(()=>$S(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?ee.createElement(v5,{page:t,matches:n,...e}):null}function x5(t){let{manifest:e,routeModules:r}=s4(),[n,a]=ee.useState([]);return ee.useEffect(()=>{let i=!1;return c5(t,e,r).then(o=>{i||a(o)}),()=>{i=!0}},[t,e,r]),n}function v5({page:t,matches:e,...r}){let n=eo(),{manifest:a,routeModules:i}=s4(),{basename:o}=a4(),{loaderData:u,matches:f}=m5(),h=ee.useMemo(()=>$w(t,e,f,a,n,"data"),[t,e,f,a,n]),p=ee.useMemo(()=>$w(t,e,f,a,n,"assets"),[t,e,f,a,n]),x=ee.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let w=new Set,T=!1;if(e.forEach(k=>{let I=a.routes[k.route.id];!I||!I.hasLoader||(!h.some(N=>N.route.id===k.route.id)&&k.route.id in u&&i[k.route.id]?.shouldRevalidate||I.hasClientLoader?T=!0:w.add(k.route.id))}),w.size===0)return[];let E=i5(t,o,"data");return T&&w.size>0&&E.searchParams.set("_routes",e.filter(k=>w.has(k.route.id)).map(k=>k.route.id).join(",")),[E.pathname+E.search]},[o,u,n,a,h,e,t,i]),y=ee.useMemo(()=>u5(p,a),[p,a]),b=x5(p);return ee.createElement(ee.Fragment,null,x.map(w=>ee.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...r})),y.map(w=>ee.createElement("link",{key:w,rel:"modulepreload",href:w,...r})),b.map(({key:w,link:T})=>ee.createElement("link",{key:w,nonce:r.nonce,...T})))}function y5(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var i4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{i4&&(window.__reactRouterVersion="7.10.1")}catch{}function _5({basename:t,children:e,unstable_useTransitions:r,window:n}){let a=ee.useRef();a.current==null&&(a.current=iR({window:n,v5Compat:!0}));let i=a.current,[o,u]=ee.useState({action:i.action,location:i.location}),f=ee.useCallback(h=>{r===!1?u(h):ee.startTransition(()=>u(h))},[r]);return ee.useLayoutEffect(()=>i.listen(f),[i,f]),ee.createElement(KR,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:r===!0})}var l4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gu=ee.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:o,state:u,target:f,to:h,preventScrollReset:p,viewTransition:x,...y},b){let{basename:w,unstable_useTransitions:T}=ee.useContext(ts),E=typeof h=="string"&&l4.test(h),k,I=!1;if(typeof h=="string"&&E&&(k=h,i4))try{let M=new URL(window.location.href),O=h.startsWith("//")?new URL(M.protocol+h):new URL(h),j=Oi(O.pathname,w);O.origin===M.origin&&j!=null?h=j+O.search+O.hash:I=!0}catch{Ra(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=jR(h,{relative:a}),[z,H,q]=p5(n,y),A=T5(h,{replace:o,state:u,target:f,preventScrollReset:p,relative:a,viewTransition:x,unstable_useTransitions:T});function F(M){e&&e(M),M.defaultPrevented||A(M)}let R=ee.createElement("a",{...y,...q,href:k||N,onClick:I||i?e:F,ref:y5(b,H),target:f,"data-discover":!E&&r==="render"?"true":void 0});return z&&!E?ee.createElement(ee.Fragment,null,R,ee.createElement(g5,{page:N})):R});gu.displayName="Link";var b5=ee.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:o,viewTransition:u,children:f,...h},p){let x=F0(o,{relative:h.relative}),y=eo(),b=ee.useContext(Km),{navigator:w,basename:T}=ee.useContext(ts),E=b!=null&&C5(x)&&u===!0,k=w.encodeLocation?w.encodeLocation(x).pathname:x.pathname,I=y.pathname,N=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;r||(I=I.toLowerCase(),N=N?N.toLowerCase():null,k=k.toLowerCase()),N&&T&&(N=Oi(N,T)||N);const z=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let H=I===k||!a&&I.startsWith(k)&&I.charAt(z)==="/",q=N!=null&&(N===k||!a&&N.startsWith(k)&&N.charAt(k.length)==="/"),A={isActive:H,isPending:q,isTransitioning:E},F=H?e:void 0,R;typeof n=="function"?R=n(A):R=[n,H?"active":null,q?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let M=typeof i=="function"?i(A):i;return ee.createElement(gu,{...h,"aria-current":F,className:R,ref:p,style:M,to:o,viewTransition:u},typeof f=="function"?f(A):f)});b5.displayName="NavLink";var w5=ee.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:i,method:o=Zd,action:u,onSubmit:f,relative:h,preventScrollReset:p,viewTransition:x,...y},b)=>{let{unstable_useTransitions:w}=ee.useContext(ts),T=k5(),E=N5(u,{relative:h}),k=o.toLowerCase()==="get"?"get":"post",I=typeof u=="string"&&l4.test(u),N=z=>{if(f&&f(z),z.defaultPrevented)return;z.preventDefault();let H=z.nativeEvent.submitter,q=H?.getAttribute("formmethod")||o,A=()=>T(H||z.currentTarget,{fetcherKey:e,method:q,navigate:r,replace:a,state:i,relative:h,preventScrollReset:p,viewTransition:x});w&&r!==!1?ee.startTransition(()=>A()):A()};return ee.createElement("form",{ref:b,method:k,action:E,onSubmit:n?f:N,...y,"data-discover":!I&&t==="render"?"true":void 0})});w5.displayName="Form";function E5(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function o4(t){let e=ee.useContext(ku);return Sr(e,E5(t)),e}function T5(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:o,unstable_useTransitions:u}={}){let f=Qm(),h=eo(),p=F0(t,{relative:i});return ee.useCallback(x=>{if(r5(x,e)){x.preventDefault();let y=r!==void 0?r:c0(h)===c0(p),b=()=>f(t,{replace:y,state:n,preventScrollReset:a,relative:i,viewTransition:o});u?ee.startTransition(()=>b()):b()}},[h,f,p,r,n,e,t,a,i,o,u])}var S5=0,A5=()=>`__${String(++S5)}__`;function k5(){let{router:t}=o4("useSubmit"),{basename:e}=ee.useContext(ts),r=WR(),n=t.fetch,a=t.navigate;return ee.useCallback(async(i,o={})=>{let{action:u,method:f,encType:h,formData:p,body:x}=s5(i,e);if(o.navigate===!1){let y=o.fetcherKey||A5();await n(y,r,o.action||u,{preventScrollReset:o.preventScrollReset,formData:p,body:x,formMethod:o.method||f,formEncType:o.encType||h,flushSync:o.flushSync})}else await a(o.action||u,{preventScrollReset:o.preventScrollReset,formData:p,body:x,formMethod:o.method||f,formEncType:o.encType||h,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[n,a,e,r])}function N5(t,{relative:e}={}){let{basename:r}=ee.useContext(ts),n=ee.useContext(Js);Sr(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...F0(t||".",{relative:e})},o=eo();if(t==null){i.search=o.search;let u=new URLSearchParams(i.search),f=u.getAll("index");if(f.some(p=>p==="")){u.delete("index"),f.filter(x=>x).forEach(x=>u.append("index",x));let p=u.toString();i.search=p?`?${p}`:""}}return(!t||t===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:Ni([r,i.pathname])),c0(i)}function C5(t,{relative:e}={}){let r=ee.useContext(ZS);Sr(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=o4("useViewTransitionState"),a=F0(t,{relative:e});if(!r.isTransitioning)return!1;let i=Oi(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Oi(r.nextLocation.pathname,n)||r.nextLocation.pathname;return fm(a.pathname,o)!=null||fm(a.pathname,i)!=null}const R5=()=>{};var Kw={};const c4=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},I5=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const i=t[r++];e[n++]=String.fromCharCode((a&31)<<6|i&63)}else if(a>239&&a<365){const i=t[r++],o=t[r++],u=t[r++],f=((a&7)<<18|(i&63)<<12|(o&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(i&63)<<6|o&63)}}return e.join("")},u4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const i=t[a],o=a+1<t.length,u=o?t[a+1]:0,f=a+2<t.length,h=f?t[a+2]:0,p=i>>2,x=(i&3)<<4|u>>4;let y=(u&15)<<2|h>>6,b=h&63;f||(b=64,o||(y=64)),n.push(r[p],r[x],r[y],r[b])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(c4(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):I5(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const i=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const h=a<t.length?r[t.charAt(a)]:64;++a;const x=a<t.length?r[t.charAt(a)]:64;if(++a,i==null||u==null||h==null||x==null)throw new D5;const y=i<<2|u>>4;if(n.push(y),h!==64){const b=u<<4&240|h>>2;if(n.push(b),x!==64){const w=h<<6&192|x;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class D5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const O5=function(t){const e=c4(t);return u4.encodeByteArray(e,!0)},hm=function(t){return O5(t).replace(/\./g,"")},f4=function(t){try{return u4.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function F5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const j5=()=>F5().__FIREBASE_DEFAULTS__,P5=()=>{if(typeof process>"u"||typeof Kw>"u")return;const t=Kw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},M5=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&f4(t[1]);return e&&JSON.parse(e)},Zm=()=>{try{return R5()||j5()||P5()||M5()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},h4=t=>Zm()?.emulatorHosts?.[t],L5=t=>{const e=h4(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},d4=()=>Zm()?.config,m4=t=>Zm()?.[`_${t}`];class B5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function Cu(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function p4(t){return(await fetch(t,{credentials:"include"})).ok}function V5(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[hm(JSON.stringify(r)),hm(JSON.stringify(o)),""].join(".")}const $f={};function U5(){const t={prod:[],emulator:[]};for(const e of Object.keys($f))$f[e]?t.emulator.push(e):t.prod.push(e);return t}function z5(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Qw=!1;function g4(t,e){if(typeof window>"u"||typeof document>"u"||!Cu(window.location.host)||$f[t]===e||$f[t]||Qw)return;$f[t]=e;function r(y){return`__firebase__banner__${y}`}const n="__firebase__banner",i=U5().prod.length>0;function o(){const y=document.getElementById(n);y&&y.remove()}function u(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function f(y,b){y.setAttribute("width","24"),y.setAttribute("id",b),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function h(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{Qw=!0,o()},y}function p(y,b){y.setAttribute("id",b),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function x(){const y=z5(n),b=r("text"),w=document.getElementById(b)||document.createElement("span"),T=r("learnmore"),E=document.getElementById(T)||document.createElement("a"),k=r("preprendIcon"),I=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const N=y.element;u(N),p(E,T);const z=h();f(I,k),N.append(I,w,E,z),document.body.appendChild(N)}i?(w.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}function Vn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function H5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vn())}function q5(){const t=Zm()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function G5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function W5(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function X5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Y5(){const t=Vn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function $5(){return!q5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function K5(){try{return typeof indexedDB=="object"}catch{return!1}}function Q5(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(r){e(r)}})}const J5="FirebaseError";class Vi extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=J5,Object.setPrototypeOf(this,Vi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,j0.prototype.create)}}class j0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,i=this.errors[e],o=i?Z5(i,n):"Error",u=`${this.serviceName}: ${o} (${a}).`;return new Vi(a,u,n)}}function Z5(t,e){return t.replace(eI,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const eI=/\{\$([^}]+)}/g;function tI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xo(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const i=t[a],o=e[a];if(Jw(i)&&Jw(o)){if(!Xo(i,o))return!1}else if(i!==o)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function Jw(t){return t!==null&&typeof t=="object"}function P0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function rI(t,e){const r=new nI(t,e);return r.subscribe.bind(r)}class nI{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");aI(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=B1),a.error===void 0&&(a.error=B1),a.complete===void 0&&(a.complete=B1);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function aI(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function B1(){}function sn(t){return t&&t._delegate?t._delegate:t}class Yo{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const jo="[DEFAULT]";class sI{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new B5;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lI(e))try{this.getOrInitializeService({instanceIdentifier:jo})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:a});n.resolve(i)}catch{}}}}clearInstance(e=jo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=jo){return this.instances.has(e)}getOptions(e=jo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(i);n===u&&o.resolve(a)}return a}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const i=this.instances.get(n);return i&&e(i,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:iI(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=jo){return this.component?this.component.multipleInstances?e:jo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function iI(t){return t===jo?void 0:t}function lI(t){return t.instantiationMode==="EAGER"}class oI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new sI(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var It;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(It||(It={}));const cI={debug:It.DEBUG,verbose:It.VERBOSE,info:It.INFO,warn:It.WARN,error:It.ERROR,silent:It.SILENT},uI=It.INFO,fI={[It.DEBUG]:"log",[It.VERBOSE]:"log",[It.INFO]:"info",[It.WARN]:"warn",[It.ERROR]:"error"},hI=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=fI[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class yv{constructor(e){this.name=e,this._logLevel=uI,this._logHandler=hI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in It))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,It.DEBUG,...e),this._logHandler(this,It.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,It.VERBOSE,...e),this._logHandler(this,It.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,It.INFO,...e),this._logHandler(this,It.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,It.WARN,...e),this._logHandler(this,It.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,It.ERROR,...e),this._logHandler(this,It.ERROR,...e)}}const dI=(t,e)=>e.some(r=>t instanceof r);let Zw,eE;function mI(){return Zw||(Zw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pI(){return eE||(eE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const x4=new WeakMap,_x=new WeakMap,v4=new WeakMap,V1=new WeakMap,_v=new WeakMap;function gI(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(Fl(t.result)),a()},o=()=>{n(t.error),a()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&x4.set(r,t)}).catch(()=>{}),_v.set(e,t),e}function xI(t){if(_x.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),a()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});_x.set(t,e)}let bx={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return _x.get(t);if(e==="objectStoreNames")return t.objectStoreNames||v4.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Fl(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function vI(t){bx=t(bx)}function yI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(U1(this),e,...r);return v4.set(n,e.sort?e.sort():[e]),Fl(n)}:pI().includes(t)?function(...e){return t.apply(U1(this),e),Fl(x4.get(this))}:function(...e){return Fl(t.apply(U1(this),e))}}function _I(t){return typeof t=="function"?yI(t):(t instanceof IDBTransaction&&xI(t),dI(t,mI())?new Proxy(t,bx):t)}function Fl(t){if(t instanceof IDBRequest)return gI(t);if(V1.has(t))return V1.get(t);const e=_I(t);return e!==t&&(V1.set(t,e),_v.set(e,t)),e}const U1=t=>_v.get(t);function bI(t,e,{blocked:r,upgrade:n,blocking:a,terminated:i}={}){const o=indexedDB.open(t,e),u=Fl(o);return n&&o.addEventListener("upgradeneeded",f=>{n(Fl(o.result),f.oldVersion,f.newVersion,Fl(o.transaction),f)}),r&&o.addEventListener("blocked",f=>r(f.oldVersion,f.newVersion,f)),u.then(f=>{i&&f.addEventListener("close",()=>i()),a&&f.addEventListener("versionchange",h=>a(h.oldVersion,h.newVersion,h))}).catch(()=>{}),u}const wI=["get","getKey","getAll","getAllKeys","count"],EI=["put","add","delete","clear"],z1=new Map;function tE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(z1.get(e))return z1.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=EI.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||wI.includes(r)))return;const i=async function(o,...u){const f=this.transaction(o,a?"readwrite":"readonly");let h=f.store;return n&&(h=h.index(u.shift())),(await Promise.all([h[r](...u),a&&f.done]))[0]};return z1.set(e,i),i}vI(t=>({...t,get:(e,r,n)=>tE(e,r)||t.get(e,r,n),has:(e,r)=>!!tE(e,r)||t.has(e,r)}));class TI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(SI(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function SI(t){return t.getComponent()?.type==="VERSION"}const wx="@firebase/app",rE="0.14.6";const Fi=new yv("@firebase/app"),AI="@firebase/app-compat",kI="@firebase/analytics-compat",NI="@firebase/analytics",CI="@firebase/app-check-compat",RI="@firebase/app-check",II="@firebase/auth",DI="@firebase/auth-compat",OI="@firebase/database",FI="@firebase/data-connect",jI="@firebase/database-compat",PI="@firebase/functions",MI="@firebase/functions-compat",LI="@firebase/installations",BI="@firebase/installations-compat",VI="@firebase/messaging",UI="@firebase/messaging-compat",zI="@firebase/performance",HI="@firebase/performance-compat",qI="@firebase/remote-config",GI="@firebase/remote-config-compat",WI="@firebase/storage",XI="@firebase/storage-compat",YI="@firebase/firestore",$I="@firebase/ai",KI="@firebase/firestore-compat",QI="firebase",JI="12.6.0";const Ex="[DEFAULT]",ZI={[wx]:"fire-core",[AI]:"fire-core-compat",[NI]:"fire-analytics",[kI]:"fire-analytics-compat",[RI]:"fire-app-check",[CI]:"fire-app-check-compat",[II]:"fire-auth",[DI]:"fire-auth-compat",[OI]:"fire-rtdb",[FI]:"fire-data-connect",[jI]:"fire-rtdb-compat",[PI]:"fire-fn",[MI]:"fire-fn-compat",[LI]:"fire-iid",[BI]:"fire-iid-compat",[VI]:"fire-fcm",[UI]:"fire-fcm-compat",[zI]:"fire-perf",[HI]:"fire-perf-compat",[qI]:"fire-rc",[GI]:"fire-rc-compat",[WI]:"fire-gcs",[XI]:"fire-gcs-compat",[YI]:"fire-fst",[KI]:"fire-fst-compat",[$I]:"fire-vertex","fire-js":"fire-js",[QI]:"fire-js-all"};const dm=new Map,eD=new Map,Tx=new Map;function nE(t,e){try{t.container.addComponent(e)}catch(r){Fi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function xu(t){const e=t.name;if(Tx.has(e))return Fi.debug(`There were multiple attempts to register component ${e}.`),!1;Tx.set(e,t);for(const r of dm.values())nE(r,t);for(const r of eD.values())nE(r,t);return!0}function bv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function _s(t){return t==null?!1:t.settings!==void 0}const tD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},jl=new j0("app","Firebase",tD);class rD{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Yo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw jl.create("app-deleted",{appName:this._name})}}const Ru=JI;function y4(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:Ex,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw jl.create("bad-app-name",{appName:String(a)});if(r||(r=d4()),!r)throw jl.create("no-options");const i=dm.get(a);if(i){if(Xo(r,i.options)&&Xo(n,i.config))return i;throw jl.create("duplicate-app",{appName:a})}const o=new oI(a);for(const f of Tx.values())o.addComponent(f);const u=new rD(r,n,o);return dm.set(a,u),u}function _4(t=Ex){const e=dm.get(t);if(!e&&t===Ex&&d4())return y4();if(!e)throw jl.create("no-app",{appName:t});return e}function Pl(t,e,r){let n=ZI[t]??t;r&&(n+=`-${r}`);const a=n.match(/\s|\//),i=e.match(/\s|\//);if(a||i){const o=[`Unable to register library "${n}" with version "${e}":`];a&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Fi.warn(o.join(" "));return}xu(new Yo(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const nD="firebase-heartbeat-database",aD=1,u0="firebase-heartbeat-store";let H1=null;function b4(){return H1||(H1=bI(nD,aD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(u0)}catch(r){console.warn(r)}}}}).catch(t=>{throw jl.create("idb-open",{originalErrorMessage:t.message})})),H1}async function sD(t){try{const r=(await b4()).transaction(u0),n=await r.objectStore(u0).get(w4(t));return await r.done,n}catch(e){if(e instanceof Vi)Fi.warn(e.message);else{const r=jl.create("idb-get",{originalErrorMessage:e?.message});Fi.warn(r.message)}}}async function aE(t,e){try{const n=(await b4()).transaction(u0,"readwrite");await n.objectStore(u0).put(e,w4(t)),await n.done}catch(r){if(r instanceof Vi)Fi.warn(r.message);else{const n=jl.create("idb-set",{originalErrorMessage:r?.message});Fi.warn(n.message)}}}function w4(t){return`${t.name}!${t.options.appId}`}const iD=1024,lD=30;class oD{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new uD(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=sE();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(a=>a.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>lD){const a=fD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Fi.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=sE(),{heartbeatsToSend:r,unsentEntries:n}=cD(this._heartbeatsCache.heartbeats),a=hm(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Fi.warn(e),""}}}function sE(){return new Date().toISOString().substring(0,10)}function cD(t,e=iD){const r=[];let n=t.slice();for(const a of t){const i=r.find(o=>o.agent===a.agent);if(i){if(i.dates.push(a.date),iE(r)>e){i.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),iE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class uD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return K5()?Q5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await sD(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return aE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return aE(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function iE(t){return hm(JSON.stringify({version:2,heartbeats:t})).length}function fD(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}function hD(t){xu(new Yo("platform-logger",e=>new TI(e),"PRIVATE")),xu(new Yo("heartbeat",e=>new oD(e),"PRIVATE")),Pl(wx,rE,t),Pl(wx,rE,"esm2020"),Pl("fire-js","")}hD("");var lE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ml,E4;(function(){var t;function e(A,F){function R(){}R.prototype=F.prototype,A.F=F.prototype,A.prototype=new R,A.prototype.constructor=A,A.D=function(M,O,j){for(var L=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)L[Ne-2]=arguments[Ne];return F.prototype[O].apply(M,L)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(A,F,R){R||(R=0);const M=Array(16);if(typeof F=="string")for(var O=0;O<16;++O)M[O]=F.charCodeAt(R++)|F.charCodeAt(R++)<<8|F.charCodeAt(R++)<<16|F.charCodeAt(R++)<<24;else for(O=0;O<16;++O)M[O]=F[R++]|F[R++]<<8|F[R++]<<16|F[R++]<<24;F=A.g[0],R=A.g[1],O=A.g[2];let j=A.g[3],L;L=F+(j^R&(O^j))+M[0]+3614090360&4294967295,F=R+(L<<7&4294967295|L>>>25),L=j+(O^F&(R^O))+M[1]+3905402710&4294967295,j=F+(L<<12&4294967295|L>>>20),L=O+(R^j&(F^R))+M[2]+606105819&4294967295,O=j+(L<<17&4294967295|L>>>15),L=R+(F^O&(j^F))+M[3]+3250441966&4294967295,R=O+(L<<22&4294967295|L>>>10),L=F+(j^R&(O^j))+M[4]+4118548399&4294967295,F=R+(L<<7&4294967295|L>>>25),L=j+(O^F&(R^O))+M[5]+1200080426&4294967295,j=F+(L<<12&4294967295|L>>>20),L=O+(R^j&(F^R))+M[6]+2821735955&4294967295,O=j+(L<<17&4294967295|L>>>15),L=R+(F^O&(j^F))+M[7]+4249261313&4294967295,R=O+(L<<22&4294967295|L>>>10),L=F+(j^R&(O^j))+M[8]+1770035416&4294967295,F=R+(L<<7&4294967295|L>>>25),L=j+(O^F&(R^O))+M[9]+2336552879&4294967295,j=F+(L<<12&4294967295|L>>>20),L=O+(R^j&(F^R))+M[10]+4294925233&4294967295,O=j+(L<<17&4294967295|L>>>15),L=R+(F^O&(j^F))+M[11]+2304563134&4294967295,R=O+(L<<22&4294967295|L>>>10),L=F+(j^R&(O^j))+M[12]+1804603682&4294967295,F=R+(L<<7&4294967295|L>>>25),L=j+(O^F&(R^O))+M[13]+4254626195&4294967295,j=F+(L<<12&4294967295|L>>>20),L=O+(R^j&(F^R))+M[14]+2792965006&4294967295,O=j+(L<<17&4294967295|L>>>15),L=R+(F^O&(j^F))+M[15]+1236535329&4294967295,R=O+(L<<22&4294967295|L>>>10),L=F+(O^j&(R^O))+M[1]+4129170786&4294967295,F=R+(L<<5&4294967295|L>>>27),L=j+(R^O&(F^R))+M[6]+3225465664&4294967295,j=F+(L<<9&4294967295|L>>>23),L=O+(F^R&(j^F))+M[11]+643717713&4294967295,O=j+(L<<14&4294967295|L>>>18),L=R+(j^F&(O^j))+M[0]+3921069994&4294967295,R=O+(L<<20&4294967295|L>>>12),L=F+(O^j&(R^O))+M[5]+3593408605&4294967295,F=R+(L<<5&4294967295|L>>>27),L=j+(R^O&(F^R))+M[10]+38016083&4294967295,j=F+(L<<9&4294967295|L>>>23),L=O+(F^R&(j^F))+M[15]+3634488961&4294967295,O=j+(L<<14&4294967295|L>>>18),L=R+(j^F&(O^j))+M[4]+3889429448&4294967295,R=O+(L<<20&4294967295|L>>>12),L=F+(O^j&(R^O))+M[9]+568446438&4294967295,F=R+(L<<5&4294967295|L>>>27),L=j+(R^O&(F^R))+M[14]+3275163606&4294967295,j=F+(L<<9&4294967295|L>>>23),L=O+(F^R&(j^F))+M[3]+4107603335&4294967295,O=j+(L<<14&4294967295|L>>>18),L=R+(j^F&(O^j))+M[8]+1163531501&4294967295,R=O+(L<<20&4294967295|L>>>12),L=F+(O^j&(R^O))+M[13]+2850285829&4294967295,F=R+(L<<5&4294967295|L>>>27),L=j+(R^O&(F^R))+M[2]+4243563512&4294967295,j=F+(L<<9&4294967295|L>>>23),L=O+(F^R&(j^F))+M[7]+1735328473&4294967295,O=j+(L<<14&4294967295|L>>>18),L=R+(j^F&(O^j))+M[12]+2368359562&4294967295,R=O+(L<<20&4294967295|L>>>12),L=F+(R^O^j)+M[5]+4294588738&4294967295,F=R+(L<<4&4294967295|L>>>28),L=j+(F^R^O)+M[8]+2272392833&4294967295,j=F+(L<<11&4294967295|L>>>21),L=O+(j^F^R)+M[11]+1839030562&4294967295,O=j+(L<<16&4294967295|L>>>16),L=R+(O^j^F)+M[14]+4259657740&4294967295,R=O+(L<<23&4294967295|L>>>9),L=F+(R^O^j)+M[1]+2763975236&4294967295,F=R+(L<<4&4294967295|L>>>28),L=j+(F^R^O)+M[4]+1272893353&4294967295,j=F+(L<<11&4294967295|L>>>21),L=O+(j^F^R)+M[7]+4139469664&4294967295,O=j+(L<<16&4294967295|L>>>16),L=R+(O^j^F)+M[10]+3200236656&4294967295,R=O+(L<<23&4294967295|L>>>9),L=F+(R^O^j)+M[13]+681279174&4294967295,F=R+(L<<4&4294967295|L>>>28),L=j+(F^R^O)+M[0]+3936430074&4294967295,j=F+(L<<11&4294967295|L>>>21),L=O+(j^F^R)+M[3]+3572445317&4294967295,O=j+(L<<16&4294967295|L>>>16),L=R+(O^j^F)+M[6]+76029189&4294967295,R=O+(L<<23&4294967295|L>>>9),L=F+(R^O^j)+M[9]+3654602809&4294967295,F=R+(L<<4&4294967295|L>>>28),L=j+(F^R^O)+M[12]+3873151461&4294967295,j=F+(L<<11&4294967295|L>>>21),L=O+(j^F^R)+M[15]+530742520&4294967295,O=j+(L<<16&4294967295|L>>>16),L=R+(O^j^F)+M[2]+3299628645&4294967295,R=O+(L<<23&4294967295|L>>>9),L=F+(O^(R|~j))+M[0]+4096336452&4294967295,F=R+(L<<6&4294967295|L>>>26),L=j+(R^(F|~O))+M[7]+1126891415&4294967295,j=F+(L<<10&4294967295|L>>>22),L=O+(F^(j|~R))+M[14]+2878612391&4294967295,O=j+(L<<15&4294967295|L>>>17),L=R+(j^(O|~F))+M[5]+4237533241&4294967295,R=O+(L<<21&4294967295|L>>>11),L=F+(O^(R|~j))+M[12]+1700485571&4294967295,F=R+(L<<6&4294967295|L>>>26),L=j+(R^(F|~O))+M[3]+2399980690&4294967295,j=F+(L<<10&4294967295|L>>>22),L=O+(F^(j|~R))+M[10]+4293915773&4294967295,O=j+(L<<15&4294967295|L>>>17),L=R+(j^(O|~F))+M[1]+2240044497&4294967295,R=O+(L<<21&4294967295|L>>>11),L=F+(O^(R|~j))+M[8]+1873313359&4294967295,F=R+(L<<6&4294967295|L>>>26),L=j+(R^(F|~O))+M[15]+4264355552&4294967295,j=F+(L<<10&4294967295|L>>>22),L=O+(F^(j|~R))+M[6]+2734768916&4294967295,O=j+(L<<15&4294967295|L>>>17),L=R+(j^(O|~F))+M[13]+1309151649&4294967295,R=O+(L<<21&4294967295|L>>>11),L=F+(O^(R|~j))+M[4]+4149444226&4294967295,F=R+(L<<6&4294967295|L>>>26),L=j+(R^(F|~O))+M[11]+3174756917&4294967295,j=F+(L<<10&4294967295|L>>>22),L=O+(F^(j|~R))+M[2]+718787259&4294967295,O=j+(L<<15&4294967295|L>>>17),L=R+(j^(O|~F))+M[9]+3951481745&4294967295,A.g[0]=A.g[0]+F&4294967295,A.g[1]=A.g[1]+(O+(L<<21&4294967295|L>>>11))&4294967295,A.g[2]=A.g[2]+O&4294967295,A.g[3]=A.g[3]+j&4294967295}n.prototype.v=function(A,F){F===void 0&&(F=A.length);const R=F-this.blockSize,M=this.C;let O=this.h,j=0;for(;j<F;){if(O==0)for(;j<=R;)a(this,A,j),j+=this.blockSize;if(typeof A=="string"){for(;j<F;)if(M[O++]=A.charCodeAt(j++),O==this.blockSize){a(this,M),O=0;break}}else for(;j<F;)if(M[O++]=A[j++],O==this.blockSize){a(this,M),O=0;break}}this.h=O,this.o+=F},n.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var F=1;F<A.length-8;++F)A[F]=0;F=this.o*8;for(var R=A.length-8;R<A.length;++R)A[R]=F&255,F/=256;for(this.v(A),A=Array(16),F=0,R=0;R<4;++R)for(let M=0;M<32;M+=8)A[F++]=this.g[R]>>>M&255;return A};function i(A,F){var R=u;return Object.prototype.hasOwnProperty.call(R,A)?R[A]:R[A]=F(A)}function o(A,F){this.h=F;const R=[];let M=!0;for(let O=A.length-1;O>=0;O--){const j=A[O]|0;M&&j==F||(R[O]=j,M=!1)}this.g=R}var u={};function f(A){return-128<=A&&A<128?i(A,function(F){return new o([F|0],F<0?-1:0)}):new o([A|0],A<0?-1:0)}function h(A){if(isNaN(A)||!isFinite(A))return x;if(A<0)return E(h(-A));const F=[];let R=1;for(let M=0;A>=R;M++)F[M]=A/R|0,R*=4294967296;return new o(F,0)}function p(A,F){if(A.length==0)throw Error("number format error: empty string");if(F=F||10,F<2||36<F)throw Error("radix out of range: "+F);if(A.charAt(0)=="-")return E(p(A.substring(1),F));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const R=h(Math.pow(F,8));let M=x;for(let j=0;j<A.length;j+=8){var O=Math.min(8,A.length-j);const L=parseInt(A.substring(j,j+O),F);O<8?(O=h(Math.pow(F,O)),M=M.j(O).add(h(L))):(M=M.j(R),M=M.add(h(L)))}return M}var x=f(0),y=f(1),b=f(16777216);t=o.prototype,t.m=function(){if(T(this))return-E(this).m();let A=0,F=1;for(let R=0;R<this.g.length;R++){const M=this.i(R);A+=(M>=0?M:4294967296+M)*F,F*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(w(this))return"0";if(T(this))return"-"+E(this).toString(A);const F=h(Math.pow(A,6));var R=this;let M="";for(;;){const O=z(R,F).g;R=k(R,O.j(F));let j=((R.g.length>0?R.g[0]:R.h)>>>0).toString(A);if(R=O,w(R))return j+M;for(;j.length<6;)j="0"+j;M=j+M}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function w(A){if(A.h!=0)return!1;for(let F=0;F<A.g.length;F++)if(A.g[F]!=0)return!1;return!0}function T(A){return A.h==-1}t.l=function(A){return A=k(this,A),T(A)?-1:w(A)?0:1};function E(A){const F=A.g.length,R=[];for(let M=0;M<F;M++)R[M]=~A.g[M];return new o(R,~A.h).add(y)}t.abs=function(){return T(this)?E(this):this},t.add=function(A){const F=Math.max(this.g.length,A.g.length),R=[];let M=0;for(let O=0;O<=F;O++){let j=M+(this.i(O)&65535)+(A.i(O)&65535),L=(j>>>16)+(this.i(O)>>>16)+(A.i(O)>>>16);M=L>>>16,j&=65535,L&=65535,R[O]=L<<16|j}return new o(R,R[R.length-1]&-2147483648?-1:0)};function k(A,F){return A.add(E(F))}t.j=function(A){if(w(this)||w(A))return x;if(T(this))return T(A)?E(this).j(E(A)):E(E(this).j(A));if(T(A))return E(this.j(E(A)));if(this.l(b)<0&&A.l(b)<0)return h(this.m()*A.m());const F=this.g.length+A.g.length,R=[];for(var M=0;M<2*F;M++)R[M]=0;for(M=0;M<this.g.length;M++)for(let O=0;O<A.g.length;O++){const j=this.i(M)>>>16,L=this.i(M)&65535,Ne=A.i(O)>>>16,_e=A.i(O)&65535;R[2*M+2*O]+=L*_e,I(R,2*M+2*O),R[2*M+2*O+1]+=j*_e,I(R,2*M+2*O+1),R[2*M+2*O+1]+=L*Ne,I(R,2*M+2*O+1),R[2*M+2*O+2]+=j*Ne,I(R,2*M+2*O+2)}for(A=0;A<F;A++)R[A]=R[2*A+1]<<16|R[2*A];for(A=F;A<2*F;A++)R[A]=0;return new o(R,0)};function I(A,F){for(;(A[F]&65535)!=A[F];)A[F+1]+=A[F]>>>16,A[F]&=65535,F++}function N(A,F){this.g=A,this.h=F}function z(A,F){if(w(F))throw Error("division by zero");if(w(A))return new N(x,x);if(T(A))return F=z(E(A),F),new N(E(F.g),E(F.h));if(T(F))return F=z(A,E(F)),new N(E(F.g),F.h);if(A.g.length>30){if(T(A)||T(F))throw Error("slowDivide_ only works with positive integers.");for(var R=y,M=F;M.l(A)<=0;)R=H(R),M=H(M);var O=q(R,1),j=q(M,1);for(M=q(M,2),R=q(R,2);!w(M);){var L=j.add(M);L.l(A)<=0&&(O=O.add(R),j=L),M=q(M,1),R=q(R,1)}return F=k(A,O.j(F)),new N(O,F)}for(O=x;A.l(F)>=0;){for(R=Math.max(1,Math.floor(A.m()/F.m())),M=Math.ceil(Math.log(R)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),j=h(R),L=j.j(F);T(L)||L.l(A)>0;)R-=M,j=h(R),L=j.j(F);w(j)&&(j=y),O=O.add(j),A=k(A,L)}return new N(O,A)}t.B=function(A){return z(this,A).h},t.and=function(A){const F=Math.max(this.g.length,A.g.length),R=[];for(let M=0;M<F;M++)R[M]=this.i(M)&A.i(M);return new o(R,this.h&A.h)},t.or=function(A){const F=Math.max(this.g.length,A.g.length),R=[];for(let M=0;M<F;M++)R[M]=this.i(M)|A.i(M);return new o(R,this.h|A.h)},t.xor=function(A){const F=Math.max(this.g.length,A.g.length),R=[];for(let M=0;M<F;M++)R[M]=this.i(M)^A.i(M);return new o(R,this.h^A.h)};function H(A){const F=A.g.length+1,R=[];for(let M=0;M<F;M++)R[M]=A.i(M)<<1|A.i(M-1)>>>31;return new o(R,A.h)}function q(A,F){const R=F>>5;F%=32;const M=A.g.length-R,O=[];for(let j=0;j<M;j++)O[j]=F>0?A.i(j+R)>>>F|A.i(j+R+1)<<32-F:A.i(j+R);return new o(O,A.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,E4=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=p,Ml=o}).apply(typeof lE<"u"?lE:typeof self<"u"?self:typeof window<"u"?window:{});var Rd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var T4,zf,S4,tm,Sx,A4,k4,N4;(function(){var t,e=Object.defineProperty;function r(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof Rd=="object"&&Rd];for(var S=0;S<g.length;++S){var D=g[S];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var n=r(this);function a(g,S){if(S)e:{var D=n;g=g.split(".");for(var X=0;X<g.length-1;X++){var fe=g[X];if(!(fe in D))break e;D=D[fe]}g=g[g.length-1],X=D[g],S=S(X),S!=X&&S!=null&&e(D,g,{configurable:!0,writable:!0,value:S})}}a("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(g){return g||function(S){var D=[],X;for(X in S)Object.prototype.hasOwnProperty.call(S,X)&&D.push([X,S[X]]);return D}});var i=i||{},o=this||self;function u(g){var S=typeof g;return S=="object"&&g!=null||S=="function"}function f(g,S,D){return g.call.apply(g.bind,arguments)}function h(g,S,D){return h=f,h.apply(null,arguments)}function p(g,S){var D=Array.prototype.slice.call(arguments,1);return function(){var X=D.slice();return X.push.apply(X,arguments),g.apply(this,X)}}function x(g,S){function D(){}D.prototype=S.prototype,g.Z=S.prototype,g.prototype=new D,g.prototype.constructor=g,g.Ob=function(X,fe,be){for(var Ge=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)Ge[yt-2]=arguments[yt];return S.prototype[fe].apply(X,Ge)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function b(g){const S=g.length;if(S>0){const D=Array(S);for(let X=0;X<S;X++)D[X]=g[X];return D}return[]}function w(g,S){for(let X=1;X<arguments.length;X++){const fe=arguments[X];var D=typeof fe;if(D=D!="object"?D:fe?Array.isArray(fe)?"array":D:"null",D=="array"||D=="object"&&typeof fe.length=="number"){D=g.length||0;const be=fe.length||0;g.length=D+be;for(let Ge=0;Ge<be;Ge++)g[D+Ge]=fe[Ge]}else g.push(fe)}}class T{constructor(S,D){this.i=S,this.j=D,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function E(g){o.setTimeout(()=>{throw g},0)}function k(){var g=A;let S=null;return g.g&&(S=g.g,g.g=g.g.next,g.g||(g.h=null),S.next=null),S}class I{constructor(){this.h=this.g=null}add(S,D){const X=N.get();X.set(S,D),this.h?this.h.next=X:this.g=X,this.h=X}}var N=new T(()=>new z,g=>g.reset());class z{constructor(){this.next=this.g=this.h=null}set(S,D){this.h=S,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let H,q=!1,A=new I,F=()=>{const g=Promise.resolve(void 0);H=()=>{g.then(R)}};function R(){for(var g;g=k();){try{g.h.call(g.g)}catch(D){E(D)}var S=N;S.j(g),S.h<100&&(S.h++,g.next=S.g,S.g=g)}q=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(g,S){this.type=g,this.g=this.target=S,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,S=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const D=()=>{};o.addEventListener("test",D,S),o.removeEventListener("test",D,S)}catch{}return g})();function L(g){return/^[\s\xa0]*$/.test(g)}function Ne(g,S){O.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,S)}x(Ne,O),Ne.prototype.init=function(g,S){const D=this.type=g.type,X=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=S,S=g.relatedTarget,S||(D=="mouseover"?S=g.fromElement:D=="mouseout"&&(S=g.toElement)),this.relatedTarget=S,X?(this.clientX=X.clientX!==void 0?X.clientX:X.pageX,this.clientY=X.clientY!==void 0?X.clientY:X.pageY,this.screenX=X.screenX||0,this.screenY=X.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&Ne.Z.h.call(this)},Ne.prototype.h=function(){Ne.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var _e="closure_listenable_"+(Math.random()*1e6|0),ne=0;function se(g,S,D,X,fe){this.listener=g,this.proxy=null,this.src=S,this.type=D,this.capture=!!X,this.ha=fe,this.key=++ne,this.da=this.fa=!1}function Ee(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function ie(g,S,D){for(const X in g)S.call(D,g[X],X,g)}function Ve(g,S){for(const D in g)S.call(void 0,g[D],D,g)}function U(g){const S={};for(const D in g)S[D]=g[D];return S}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function G(g,S){let D,X;for(let fe=1;fe<arguments.length;fe++){X=arguments[fe];for(D in X)g[D]=X[D];for(let be=0;be<P.length;be++)D=P[be],Object.prototype.hasOwnProperty.call(X,D)&&(g[D]=X[D])}}function Y(g){this.src=g,this.g={},this.h=0}Y.prototype.add=function(g,S,D,X,fe){const be=g.toString();g=this.g[be],g||(g=this.g[be]=[],this.h++);const Ge=oe(g,S,X,fe);return Ge>-1?(S=g[Ge],D||(S.fa=!1)):(S=new se(S,this.src,be,!!X,fe),S.fa=D,g.push(S)),S};function Z(g,S){const D=S.type;if(D in g.g){var X=g.g[D],fe=Array.prototype.indexOf.call(X,S,void 0),be;(be=fe>=0)&&Array.prototype.splice.call(X,fe,1),be&&(Ee(S),g.g[D].length==0&&(delete g.g[D],g.h--))}}function oe(g,S,D,X){for(let fe=0;fe<g.length;++fe){const be=g[fe];if(!be.da&&be.listener==S&&be.capture==!!D&&be.ha==X)return fe}return-1}var ye="closure_lm_"+(Math.random()*1e6|0),Fe={};function Te(g,S,D,X,fe){if(Array.isArray(S)){for(let be=0;be<S.length;be++)Te(g,S[be],D,X,fe);return null}return D=tt(D),g&&g[_e]?g.J(S,D,u(X)?!!X.capture:!1,fe):De(g,S,D,!1,X,fe)}function De(g,S,D,X,fe,be){if(!S)throw Error("Invalid event type");const Ge=u(fe)?!!fe.capture:!!fe;let yt=Ce(g);if(yt||(g[ye]=yt=new Y(g)),D=yt.add(S,D,X,Ge,be),D.proxy)return D;if(X=rt(),D.proxy=X,X.src=g,X.listener=D,g.addEventListener)j||(fe=Ge),fe===void 0&&(fe=!1),g.addEventListener(S.toString(),X,fe);else if(g.attachEvent)g.attachEvent(ce(S.toString()),X);else if(g.addListener&&g.removeListener)g.addListener(X);else throw Error("addEventListener and attachEvent are unavailable.");return D}function rt(){function g(D){return S.call(g.src,g.listener,D)}const S=ze;return g}function re(g,S,D,X,fe){if(Array.isArray(S))for(var be=0;be<S.length;be++)re(g,S[be],D,X,fe);else X=u(X)?!!X.capture:!!X,D=tt(D),g&&g[_e]?(g=g.i,be=String(S).toString(),be in g.g&&(S=g.g[be],D=oe(S,D,X,fe),D>-1&&(Ee(S[D]),Array.prototype.splice.call(S,D,1),S.length==0&&(delete g.g[be],g.h--)))):g&&(g=Ce(g))&&(S=g.g[S.toString()],g=-1,S&&(g=oe(S,D,X,fe)),(D=g>-1?S[g]:null)&&ft(D))}function ft(g){if(typeof g!="number"&&g&&!g.da){var S=g.src;if(S&&S[_e])Z(S.i,g);else{var D=g.type,X=g.proxy;S.removeEventListener?S.removeEventListener(D,X,g.capture):S.detachEvent?S.detachEvent(ce(D),X):S.addListener&&S.removeListener&&S.removeListener(X),(D=Ce(S))?(Z(D,g),D.h==0&&(D.src=null,S[ye]=null)):Ee(g)}}}function ce(g){return g in Fe?Fe[g]:Fe[g]="on"+g}function ze(g,S){if(g.da)g=!0;else{S=new Ne(S,this);const D=g.listener,X=g.ha||g.src;g.fa&&ft(g),g=D.call(X,S)}return g}function Ce(g){return g=g[ye],g instanceof Y?g:null}var je="__closure_events_fn_"+(Math.random()*1e9>>>0);function tt(g){return typeof g=="function"?g:(g[je]||(g[je]=function(S){return g.handleEvent(S)}),g[je])}function nt(){M.call(this),this.i=new Y(this),this.M=this,this.G=null}x(nt,M),nt.prototype[_e]=!0,nt.prototype.removeEventListener=function(g,S,D,X){re(this,g,S,D,X)};function ht(g,S){var D,X=g.G;if(X)for(D=[];X;X=X.G)D.push(X);if(g=g.M,X=S.type||S,typeof S=="string")S=new O(S,g);else if(S instanceof O)S.target=S.target||g;else{var fe=S;S=new O(X,g),G(S,fe)}fe=!0;let be,Ge;if(D)for(Ge=D.length-1;Ge>=0;Ge--)be=S.g=D[Ge],fe=fr(be,X,!0,S)&&fe;if(be=S.g=g,fe=fr(be,X,!0,S)&&fe,fe=fr(be,X,!1,S)&&fe,D)for(Ge=0;Ge<D.length;Ge++)be=S.g=D[Ge],fe=fr(be,X,!1,S)&&fe}nt.prototype.N=function(){if(nt.Z.N.call(this),this.i){var g=this.i;for(const S in g.g){const D=g.g[S];for(let X=0;X<D.length;X++)Ee(D[X]);delete g.g[S],g.h--}}this.G=null},nt.prototype.J=function(g,S,D,X){return this.i.add(String(g),S,!1,D,X)},nt.prototype.K=function(g,S,D,X){return this.i.add(String(g),S,!0,D,X)};function fr(g,S,D,X){if(S=g.i.g[String(S)],!S)return!0;S=S.concat();let fe=!0;for(let be=0;be<S.length;++be){const Ge=S[be];if(Ge&&!Ge.da&&Ge.capture==D){const yt=Ge.listener,Pr=Ge.ha||Ge.src;Ge.fa&&Z(g.i,Ge),fe=yt.call(Pr,X)!==!1&&fe}}return fe&&!X.defaultPrevented}function da(g,S){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=h(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:o.setTimeout(g,S||0)}function Hn(g){g.g=da(()=>{g.g=null,g.i&&(g.i=!1,Hn(g))},g.l);const S=g.h;g.h=null,g.m.apply(null,S)}class Ht extends M{constructor(S,D){super(),this.m=S,this.l=D,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:Hn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function en(g){M.call(this),this.h=g,this.g={}}x(en,M);var kn=[];function Jn(g){ie(g.g,function(S,D){this.g.hasOwnProperty(D)&&ft(S)},g),g.g={}}en.prototype.N=function(){en.Z.N.call(this),Jn(this)},en.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Yt=o.JSON.stringify,on=o.JSON.parse,dt=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function Pt(){}function tn(){}var Mt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function or(){O.call(this,"d")}x(or,O);function cn(){O.call(this,"c")}x(cn,O);var mr={},ns=null;function as(){return ns=ns||new nt}mr.Ia="serverreachability";function oo(g){O.call(this,mr.Ia,g)}x(oo,O);function ma(g){const S=as();ht(S,new oo(S))}mr.STAT_EVENT="statevent";function ti(g,S){O.call(this,mr.STAT_EVENT,g),this.stat=S}x(ti,O);function Cr(g){const S=as();ht(S,new ti(S,g))}mr.Ja="timingevent";function qn(g,S){O.call(this,mr.Ja,g),this.size=S}x(qn,O);function Da(g,S){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},S)}function pa(){this.g=!0}pa.prototype.ua=function(){this.g=!1};function Uu(g,S,D,X,fe,be){g.info(function(){if(g.g)if(be){var Ge="",yt=be.split("&");for(let qt=0;qt<yt.length;qt++){var Pr=yt[qt].split("=");if(Pr.length>1){const br=Pr[0];Pr=Pr[1];const Pa=br.split("_");Ge=Pa.length>=2&&Pa[1]=="type"?Ge+(br+"="+Pr+"&"):Ge+(br+"=redacted&")}}}else Ge=null;else Ge=be;return"XMLHTTP REQ ("+X+") [attempt "+fe+"]: "+S+`
`+D+`
`+Ge})}function mc(g,S,D,X,fe,be,Ge){g.info(function(){return"XMLHTTP RESP ("+X+") [ attempt "+fe+"]: "+S+`
`+D+`
`+be+" "+Ge})}function Oa(g,S,D,X){g.info(function(){return"XMLHTTP TEXT ("+S+"): "+zu(g,D)+(X?" "+X:"")})}function ri(g,S){g.info(function(){return"TIMEOUT: "+S})}pa.prototype.info=function(){};function zu(g,S){if(!g.g)return S;if(!S)return null;try{const be=JSON.parse(S);if(be){for(g=0;g<be.length;g++)if(Array.isArray(be[g])){var D=be[g];if(!(D.length<2)){var X=D[1];if(Array.isArray(X)&&!(X.length<1)){var fe=X[0];if(fe!="noop"&&fe!="stop"&&fe!="close")for(let Ge=1;Ge<X.length;Ge++)X[Ge]=""}}}}return Yt(be)}catch{return S}}var ni={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ai={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},co;function si(){}x(si,Pt),si.prototype.g=function(){return new XMLHttpRequest},co=new si;function ss(g){return encodeURIComponent(String(g))}function B(g){var S=1;g=g.split(":");const D=[];for(;S>0&&g.length;)D.push(g.shift()),S--;return g.length&&D.push(g.join(":")),D}function J(g,S,D,X){this.j=g,this.i=S,this.l=D,this.S=X||1,this.V=new en(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new W}function W(){this.i=null,this.g="",this.h=!1}var K={},Q={};function te(g,S,D){g.M=1,g.A=uo(Hr(S)),g.u=D,g.R=!0,de(g,null)}function de(g,S){g.F=Date.now(),ge(g),g.B=Hr(g.A);var D=g.B,X=g.S;Array.isArray(X)||(X=[String(X)]),gc(D.i,"t",X),g.C=0,D=g.j.L,g.h=new W,g.g=bh(g.j,D?S:null,!g.u),g.P>0&&(g.O=new Ht(h(g.Y,g,g.g),g.P)),S=g.V,D=g.g,X=g.ba;var fe="readystatechange";Array.isArray(fe)||(fe&&(kn[0]=fe.toString()),fe=kn);for(let be=0;be<fe.length;be++){const Ge=Te(D,fe[be],X||S.handleEvent,!1,S.h||S);if(!Ge)break;S.g[Ge.key]=Ge}S=g.J?U(g.J):{},g.u?(g.v||(g.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,S)):(g.v="GET",g.g.ea(g.B,g.v,null,S)),ma(),Uu(g.i,g.v,g.B,g.l,g.S,g.u)}J.prototype.ba=function(g){g=g.target;const S=this.O;S&&us(g)==3?S.j():this.Y(g)},J.prototype.Y=function(g){try{if(g==this.g)e:{const yt=us(this.g),Pr=this.g.ya(),qt=this.g.ca();if(!(yt<3)&&(yt!=3||this.g&&(this.h.h||this.g.la()||gn(this.g)))){this.K||yt!=4||Pr==7||(Pr==8||qt<=0?ma(3):ma(2)),Ue(this);var S=this.g.ca();this.X=S;var D=Ae(this);if(this.o=S==200,mc(this.i,this.v,this.B,this.l,this.S,yt,S),this.o){if(this.U&&!this.L){t:{if(this.g){var X,fe=this.g;if((X=fe.g?fe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!L(X)){var be=X;break t}}be=null}if(g=be)Oa(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,We(this,g);else{this.o=!1,this.m=3,Cr(12),Le(this),Xe(this);break e}}if(this.R){g=!0;let br;for(;!this.K&&this.C<D.length;)if(br=xe(this,D),br==Q){yt==4&&(this.m=4,Cr(14),g=!1),Oa(this.i,this.l,null,"[Incomplete Response]");break}else if(br==K){this.m=4,Cr(15),Oa(this.i,this.l,D,"[Invalid Chunk]"),g=!1;break}else Oa(this.i,this.l,br,null),We(this,br);if(me(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),yt!=4||D.length!=0||this.h.h||(this.m=1,Cr(16),g=!1),this.o=this.o&&g,!g)Oa(this.i,this.l,D,"[Invalid Chunked Response]"),Le(this),Xe(this);else if(D.length>0&&!this.W){this.W=!0;var Ge=this.j;Ge.g==this&&Ge.aa&&!Ge.P&&(Ge.j.info("Great, no buffering proxy detected. Bytes received: "+D.length),Ju(Ge),Ge.P=!0,Cr(11))}}else Oa(this.i,this.l,D,null),We(this,D);yt==4&&Le(this),this.o&&!this.K&&(yt==4?xh(this.j,this):(this.o=!1,ge(this)))}else li(this.g),S==400&&D.indexOf("Unknown SID")>0?(this.m=3,Cr(12)):(this.m=0,Cr(13)),Le(this),Xe(this)}}}catch{}finally{}};function Ae(g){if(!me(g))return g.g.la();const S=gn(g.g);if(S==="")return"";let D="";const X=S.length,fe=us(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return Le(g),Xe(g),"";g.h.i=new o.TextDecoder}for(let be=0;be<X;be++)g.h.h=!0,D+=g.h.i.decode(S[be],{stream:!(fe&&be==X-1)});return S.length=0,g.h.g+=D,g.C=0,g.h.g}function me(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function xe(g,S){var D=g.C,X=S.indexOf(`
`,D);return X==-1?Q:(D=Number(S.substring(D,X)),isNaN(D)?K:(X+=1,X+D>S.length?Q:(S=S.slice(X,X+D),g.C=X+D,S)))}J.prototype.cancel=function(){this.K=!0,Le(this)};function ge(g){g.T=Date.now()+g.H,Be(g,g.H)}function Be(g,S){if(g.D!=null)throw Error("WatchDog timer not null");g.D=Da(h(g.aa,g),S)}function Ue(g){g.D&&(o.clearTimeout(g.D),g.D=null)}J.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(ri(this.i,this.B),this.M!=2&&(ma(),Cr(17)),Le(this),this.m=2,Xe(this)):Be(this,this.T-g)};function Xe(g){g.j.I==0||g.K||xh(g.j,g)}function Le(g){Ue(g);var S=g.O;S&&typeof S.dispose=="function"&&S.dispose(),g.O=null,Jn(g.V),g.g&&(S=g.g,g.g=null,S.abort(),S.dispose())}function We(g,S){try{var D=g.j;if(D.I!=0&&(D.g==g||Nn(D.h,g))){if(!g.L&&Nn(D.h,g)&&D.I==3){try{var X=D.Ba.g.parse(S)}catch{X=null}if(Array.isArray(X)&&X.length==3){var fe=X;if(fe[0]==0){e:if(!D.v){if(D.g)if(D.g.F+3e3<g.F)bc(D),Zi(D);else break e;vo(D),Cr(18)}}else D.xa=fe[1],0<D.xa-D.K&&fe[2]<37500&&D.F&&D.A==0&&!D.C&&(D.C=Da(h(D.Va,D),6e3));cr(D.h)<=1&&D.ta&&(D.ta=void 0)}else Ds(D,11)}else if((g.L||D.g==g)&&bc(D),!L(S))for(fe=D.Ba.g.parse(S),S=0;S<fe.length;S++){let qt=fe[S];const br=qt[0];if(!(br<=D.K))if(D.K=br,qt=qt[1],D.I==2)if(qt[0]=="c"){D.M=qt[1],D.ba=qt[2];const Pa=qt[3];Pa!=null&&(D.ka=Pa,D.j.info("VER="+D.ka));const Os=qt[4];Os!=null&&(D.za=Os,D.j.info("SVER="+D.za));const fs=qt[5];fs!=null&&typeof fs=="number"&&fs>0&&(X=1.5*fs,D.O=X,D.j.info("backChannelRequestTimeoutMs_="+X)),X=D;const hs=g.g;if(hs){const yo=hs.g?hs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yo){var be=X.h;be.g||yo.indexOf("spdy")==-1&&yo.indexOf("quic")==-1&&yo.indexOf("h2")==-1||(be.j=be.l,be.g=new Set,be.h&&(is(be,be.h),be.h=null))}if(X.G){const wc=hs.g?hs.g.getResponseHeader("X-HTTP-Session-Id"):null;wc&&(X.wa=wc,Qt(X.J,X.G,wc))}}D.I=3,D.l&&D.l.ra(),D.aa&&(D.T=Date.now()-g.F,D.j.info("Handshake RTT: "+D.T+"ms")),X=D;var Ge=g;if(X.na=_h(X,X.L?X.ba:null,X.W),Ge.L){ls(X.h,Ge);var yt=Ge,Pr=X.O;Pr&&(yt.H=Pr),yt.D&&(Ue(yt),ge(yt)),X.g=Ge}else ph(X);D.i.length>0&&Is(D)}else qt[0]!="stop"&&qt[0]!="close"||Ds(D,7);else D.I==3&&(qt[0]=="stop"||qt[0]=="close"?qt[0]=="stop"?Ds(D,7):Ku(D):qt[0]!="noop"&&D.l&&D.l.qa(qt),D.A=0)}}ma(4)}catch{}}var Ze=class{constructor(g,S){this.g=g,this.map=S}};function $t(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Kt(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function cr(g){return g.h?1:g.g?g.g.size:0}function Nn(g,S){return g.h?g.h==S:g.g?g.g.has(S):!1}function is(g,S){g.g?g.g.add(S):g.h=S}function ls(g,S){g.h&&g.h==S?g.h=null:g.g&&g.g.has(S)&&g.g.delete(S)}$t.prototype.cancel=function(){if(this.i=ga(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function ga(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let S=g.i;for(const D of g.g.values())S=S.concat(D.G);return S}return b(g.i)}var Gi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cn(g,S){if(g){g=g.split("&");for(let D=0;D<g.length;D++){const X=g[D].indexOf("=");let fe,be=null;X>=0?(fe=g[D].substring(0,X),be=g[D].substring(X+1)):fe=g[D],S(fe,be?decodeURIComponent(be.replace(/\+/g," ")):"")}}}function xa(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;g instanceof xa?(this.l=g.l,un(this,g.j),this.o=g.o,this.g=g.g,Wi(this,g.u),this.h=g.h,Hu(this,dh(g.i)),this.m=g.m):g&&(S=String(g).match(Gi))?(this.l=!1,un(this,S[1]||"",!0),this.o=ks(S[2]||""),this.g=ks(S[3]||"",!0),Wi(this,S[4]),this.h=ks(S[5]||"",!0),Hu(this,S[6]||"",!0),this.m=ks(S[7]||"")):(this.l=!1,this.i=new Yi(null,this.l))}xa.prototype.toString=function(){const g=[];var S=this.j;S&&g.push(fo(S,pc,!0),":");var D=this.g;return(D||S=="file")&&(g.push("//"),(S=this.o)&&g.push(fo(S,pc,!0),"@"),g.push(ss(D).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.u,D!=null&&g.push(":",String(D))),(D=this.h)&&(this.g&&D.charAt(0)!="/"&&g.push("/"),g.push(fo(D,D.charAt(0)=="/"?qu:uh,!0))),(D=this.i.toString())&&g.push("?",D),(D=this.m)&&g.push("#",fo(D,fh)),g.join("")},xa.prototype.resolve=function(g){const S=Hr(this);let D=!!g.j;D?un(S,g.j):D=!!g.o,D?S.o=g.o:D=!!g.g,D?S.g=g.g:D=g.u!=null;var X=g.h;if(D)Wi(S,g.u);else if(D=!!g.h){if(X.charAt(0)!="/")if(this.g&&!this.h)X="/"+X;else{var fe=S.h.lastIndexOf("/");fe!=-1&&(X=S.h.slice(0,fe+1)+X)}if(fe=X,fe==".."||fe==".")X="";else if(fe.indexOf("./")!=-1||fe.indexOf("/.")!=-1){X=fe.lastIndexOf("/",0)==0,fe=fe.split("/");const be=[];for(let Ge=0;Ge<fe.length;){const yt=fe[Ge++];yt=="."?X&&Ge==fe.length&&be.push(""):yt==".."?((be.length>1||be.length==1&&be[0]!="")&&be.pop(),X&&Ge==fe.length&&be.push("")):(be.push(yt),X=!0)}X=be.join("/")}else X=fe}return D?S.h=X:D=g.i.toString()!=="",D?Hu(S,dh(g.i)):D=!!g.m,D&&(S.m=g.m),S};function Hr(g){return new xa(g)}function un(g,S,D){g.j=D?ks(S,!0):S,g.j&&(g.j=g.j.replace(/:$/,""))}function Wi(g,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);g.u=S}else g.u=null}function Hu(g,S,D){S instanceof Yi?(g.i=S,xc(g.i,g.l)):(D||(S=fo(S,Xi)),g.i=new Yi(S,g.l))}function Qt(g,S,D){g.i.set(S,D)}function uo(g){return Qt(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function ks(g,S){return g?S?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function fo(g,S,D){return typeof g=="string"?(g=encodeURI(g).replace(S,Zn),D&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function Zn(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var pc=/[#\/\?@]/g,uh=/[#\?:]/g,qu=/[#\?]/g,Xi=/[#\?@]/g,fh=/#/g;function Yi(g,S){this.h=this.g=null,this.i=g||null,this.j=!!S}function ea(g){g.g||(g.g=new Map,g.h=0,g.i&&Cn(g.i,function(S,D){g.add(decodeURIComponent(S.replace(/\+/g," ")),D)}))}t=Yi.prototype,t.add=function(g,S){ea(this),this.i=null,g=$i(this,g);let D=this.g.get(g);return D||this.g.set(g,D=[]),D.push(S),this.h+=1,this};function hh(g,S){ea(g),S=$i(g,S),g.g.has(S)&&(g.i=null,g.h-=g.g.get(S).length,g.g.delete(S))}function Gu(g,S){return ea(g),S=$i(g,S),g.g.has(S)}t.forEach=function(g,S){ea(this),this.g.forEach(function(D,X){D.forEach(function(fe){g.call(S,fe,X,this)},this)},this)};function Wu(g,S){ea(g);let D=[];if(typeof S=="string")Gu(g,S)&&(D=D.concat(g.g.get($i(g,S))));else for(g=Array.from(g.g.values()),S=0;S<g.length;S++)D=D.concat(g[S]);return D}t.set=function(g,S){return ea(this),this.i=null,g=$i(this,g),Gu(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[S]),this.h+=1,this},t.get=function(g,S){return g?(g=Wu(this,g),g.length>0?String(g[0]):S):S};function gc(g,S,D){hh(g,S),D.length>0&&(g.i=null,g.g.set($i(g,S),b(D)),g.h+=D.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],S=Array.from(this.g.keys());for(let X=0;X<S.length;X++){var D=S[X];const fe=ss(D);D=Wu(this,D);for(let be=0;be<D.length;be++){let Ge=fe;D[be]!==""&&(Ge+="="+ss(D[be])),g.push(Ge)}}return this.i=g.join("&")};function dh(g){const S=new Yi;return S.i=g.i,g.g&&(S.g=new Map(g.g),S.h=g.h),S}function $i(g,S){return S=String(S),g.j&&(S=S.toLowerCase()),S}function xc(g,S){S&&!g.j&&(ea(g),g.i=null,g.g.forEach(function(D,X){const fe=X.toLowerCase();X!=fe&&(hh(this,X),gc(this,fe,D))},g)),g.j=S}function os(g,S){const D=new pa;if(o.Image){const X=new Image;X.onload=p(Fa,D,"TestLoadImage: loaded",!0,S,X),X.onerror=p(Fa,D,"TestLoadImage: error",!1,S,X),X.onabort=p(Fa,D,"TestLoadImage: abort",!1,S,X),X.ontimeout=p(Fa,D,"TestLoadImage: timeout",!1,S,X),o.setTimeout(function(){X.ontimeout&&X.ontimeout()},1e4),X.src=g}else S(!1)}function Xu(g,S){const D=new pa,X=new AbortController,fe=setTimeout(()=>{X.abort(),Fa(D,"TestPingServer: timeout",!1,S)},1e4);fetch(g,{signal:X.signal}).then(be=>{clearTimeout(fe),be.ok?Fa(D,"TestPingServer: ok",!0,S):Fa(D,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(fe),Fa(D,"TestPingServer: error",!1,S)})}function Fa(g,S,D,X,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),X(D)}catch{}}function Ki(){this.g=new dt}function Ns(g){this.i=g.Sb||null,this.h=g.ab||!1}x(Ns,Pt),Ns.prototype.g=function(){return new ho(this.i,this.h)};function ho(g,S){nt.call(this),this.H=g,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(ho,nt),t=ho.prototype,t.open=function(g,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=S,this.readyState=1,cs(this)},t.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(S.body=g),(this.H||o).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Qi(this)),this.readyState=0},t.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,cs(this)),this.g&&(this.readyState=3,cs(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;vc(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function vc(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}t.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var S=g.value?g.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!g.done}))&&(this.response=this.responseText+=S)}g.done?Qi(this):cs(this),this.readyState==3&&vc(this)}},t.Oa=function(g){this.g&&(this.response=this.responseText=g,Qi(this))},t.Na=function(g){this.g&&(this.response=g,Qi(this))},t.ga=function(){this.g&&Qi(this)};function Qi(g){g.readyState=4,g.l=null,g.j=null,g.B=null,cs(g)}t.setRequestHeader=function(g,S){this.A.append(g,S)},t.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],S=this.h.entries();for(var D=S.next();!D.done;)D=D.value,g.push(D[0]+": "+D[1]),D=S.next();return g.join(`\r
`)};function cs(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(ho.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function ja(g){let S="";return ie(g,function(D,X){S+=X,S+=":",S+=D,S+=`\r
`}),S}function mo(g,S,D){e:{for(X in D){var X=!1;break e}X=!0}X||(D=ja(D),typeof g=="string"?D!=null&&ss(D):Qt(g,S,D))}function nr(g){nt.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(nr,nt);var Cs=/^https?$/i,Yu=["POST","PUT"];t=nr.prototype,t.Fa=function(g){this.H=g},t.ea=function(g,S,D,X){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);S=S?S.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():co.g(),this.g.onreadystatechange=y(h(this.Ca,this));try{this.B=!0,this.g.open(S,String(g),!0),this.B=!1}catch(be){po(this,be);return}if(g=D||"",D=new Map(this.headers),X)if(Object.getPrototypeOf(X)===Object.prototype)for(var fe in X)D.set(fe,X[fe]);else if(typeof X.keys=="function"&&typeof X.get=="function")for(const be of X.keys())D.set(be,X.get(be));else throw Error("Unknown input type for opt_headers: "+String(X));X=Array.from(D.keys()).find(be=>be.toLowerCase()=="content-type"),fe=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(Yu,S,void 0)>=0)||X||fe||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[be,Ge]of D)this.g.setRequestHeader(be,Ge);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(be){po(this,be)}};function po(g,S){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=S,g.o=5,$u(g),ii(g)}function $u(g){g.A||(g.A=!0,ht(g,"complete"),ht(g,"error"))}t.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,ht(this,"complete"),ht(this,"abort"),ii(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ii(this,!0)),nr.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?go(this):this.Xa())},t.Xa=function(){go(this)};function go(g){if(g.h&&typeof i<"u"){if(g.v&&us(g)==4)setTimeout(g.Ca.bind(g),0);else if(ht(g,"readystatechange"),us(g)==4){g.h=!1;try{const be=g.ca();e:switch(be){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var D;if(!(D=S)){var X;if(X=be===0){let Ge=String(g.D).match(Gi)[1]||null;!Ge&&o.self&&o.self.location&&(Ge=o.self.location.protocol.slice(0,-1)),X=!Cs.test(Ge?Ge.toLowerCase():"")}D=X}if(D)ht(g,"complete"),ht(g,"success");else{g.o=6;try{var fe=us(g)>2?g.g.statusText:""}catch{fe=""}g.l=fe+" ["+g.ca()+"]",$u(g)}}finally{ii(g)}}}}function ii(g,S){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const D=g.g;g.g=null,S||ht(g,"ready");try{D.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function us(g){return g.g?g.g.readyState:0}t.ca=function(){try{return us(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(g){if(this.g){var S=this.g.responseText;return g&&S.indexOf(g)==0&&(S=S.substring(g.length)),on(S)}};function gn(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function li(g){const S={};g=(g.g&&us(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let X=0;X<g.length;X++){if(L(g[X]))continue;var D=B(g[X]);const fe=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const be=S[fe]||[];S[fe]=be,be.push(D)}Ve(S,function(X){return X.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Rs(g,S,D){return D&&D.internalChannelParams&&D.internalChannelParams[g]||S}function Ji(g){this.za=0,this.i=[],this.j=new pa,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Rs("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Rs("baseRetryDelayMs",5e3,g),this.Za=Rs("retryDelaySeedMs",1e4,g),this.Ta=Rs("forwardChannelMaxRetries",2,g),this.va=Rs("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new $t(g&&g.concurrentRequestLimit),this.Ba=new Ki,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Ji.prototype,t.ka=8,t.I=1,t.connect=function(g,S,D,X){Cr(0),this.W=g,this.H=S||{},D&&X!==void 0&&(this.H.OSID=D,this.H.OAID=X),this.F=this.X,this.J=_h(this,null,this.W),Is(this)};function Ku(g){if(yc(g),g.I==3){var S=g.V++,D=Hr(g.J);if(Qt(D,"SID",g.M),Qt(D,"RID",S),Qt(D,"TYPE","terminate"),xo(g,D),S=new J(g,g.j,S),S.M=2,S.A=uo(Hr(D)),D=!1,o.navigator&&o.navigator.sendBeacon)try{D=o.navigator.sendBeacon(S.A.toString(),"")}catch{}!D&&o.Image&&(new Image().src=S.A,D=!0),D||(S.g=bh(S.j,null),S.g.ea(S.A)),S.F=Date.now(),ge(S)}yh(g)}function Zi(g){g.g&&(Ju(g),g.g.cancel(),g.g=null)}function yc(g){Zi(g),g.v&&(o.clearTimeout(g.v),g.v=null),bc(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function Is(g){if(!Kt(g.h)&&!g.m){g.m=!0;var S=g.Ea;H||F(),q||(H(),q=!0),A.add(S,g),g.D=0}}function _c(g,S){return cr(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=S.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=Da(h(g.Ea,g,S),vh(g,g.D)),g.D++,!0)}t.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const fe=new J(this,this.j,g);let be=this.o;if(this.U&&(be?(be=U(be),G(be,this.U)):be=this.U),this.u!==null||this.R||(fe.J=be,be=null),this.S)e:{for(var S=0,D=0;D<this.i.length;D++){t:{var X=this.i[D];if("__data__"in X.map&&(X=X.map.__data__,typeof X=="string")){X=X.length;break t}X=void 0}if(X===void 0)break;if(S+=X,S>4096){S=D;break e}if(S===4096||D===this.i.length-1){S=D+1;break e}}S=1e3}else S=1e3;S=mh(this,fe,S),D=Hr(this.J),Qt(D,"RID",g),Qt(D,"CVER",22),this.G&&Qt(D,"X-HTTP-Session-Id",this.G),xo(this,D),be&&(this.R?S="headers="+ss(ja(be))+"&"+S:this.u&&mo(D,this.u,be)),is(this.h,fe),this.Ra&&Qt(D,"TYPE","init"),this.S?(Qt(D,"$req",S),Qt(D,"SID","null"),fe.U=!0,te(fe,D,null)):te(fe,D,S),this.I=2}}else this.I==3&&(g?Qu(this,g):this.i.length==0||Kt(this.h)||Qu(this))};function Qu(g,S){var D;S?D=S.l:D=g.V++;const X=Hr(g.J);Qt(X,"SID",g.M),Qt(X,"RID",D),Qt(X,"AID",g.K),xo(g,X),g.u&&g.o&&mo(X,g.u,g.o),D=new J(g,g.j,D,g.D+1),g.u===null&&(D.J=g.o),S&&(g.i=S.G.concat(g.i)),S=mh(g,D,1e3),D.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),is(g.h,D),te(D,X,S)}function xo(g,S){g.H&&ie(g.H,function(D,X){Qt(S,X,D)}),g.l&&ie({},function(D,X){Qt(S,X,D)})}function mh(g,S,D){D=Math.min(g.i.length,D);const X=g.l?h(g.l.Ka,g.l,g):null;e:{var fe=g.i;let yt=-1;for(;;){const Pr=["count="+D];yt==-1?D>0?(yt=fe[0].g,Pr.push("ofs="+yt)):yt=0:Pr.push("ofs="+yt);let qt=!0;for(let br=0;br<D;br++){var be=fe[br].g;const Pa=fe[br].map;if(be-=yt,be<0)yt=Math.max(0,fe[br].g-100),qt=!1;else try{be="req"+be+"_"||"";try{var Ge=Pa instanceof Map?Pa:Object.entries(Pa);for(const[Os,fs]of Ge){let hs=fs;u(fs)&&(hs=Yt(fs)),Pr.push(be+Os+"="+encodeURIComponent(hs))}}catch(Os){throw Pr.push(be+"type="+encodeURIComponent("_badmap")),Os}}catch{X&&X(Pa)}}if(qt){Ge=Pr.join("&");break e}}Ge=void 0}return g=g.i.splice(0,D),S.G=g,Ge}function ph(g){if(!g.g&&!g.v){g.Y=1;var S=g.Da;H||F(),q||(H(),q=!0),A.add(S,g),g.A=0}}function vo(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=Da(h(g.Da,g),vh(g,g.A)),g.A++,!0)}t.Da=function(){if(this.v=null,gh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=Da(h(this.Wa,this),g)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Cr(10),Zi(this),gh(this))};function Ju(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function gh(g){g.g=new J(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var S=Hr(g.na);Qt(S,"RID","rpc"),Qt(S,"SID",g.M),Qt(S,"AID",g.K),Qt(S,"CI",g.F?"0":"1"),!g.F&&g.ia&&Qt(S,"TO",g.ia),Qt(S,"TYPE","xmlhttp"),xo(g,S),g.u&&g.o&&mo(S,g.u,g.o),g.O&&(g.g.H=g.O);var D=g.g;g=g.ba,D.M=1,D.A=uo(Hr(S)),D.u=null,D.R=!0,de(D,g)}t.Va=function(){this.C!=null&&(this.C=null,Zi(this),vo(this),Cr(19))};function bc(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function xh(g,S){var D=null;if(g.g==S){bc(g),Ju(g),g.g=null;var X=2}else if(Nn(g.h,S))D=S.G,ls(g.h,S),X=1;else return;if(g.I!=0){if(S.o)if(X==1){D=S.u?S.u.length:0,S=Date.now()-S.F;var fe=g.D;X=as(),ht(X,new qn(X,D)),Is(g)}else ph(g);else if(fe=S.m,fe==3||fe==0&&S.X>0||!(X==1&&_c(g,S)||X==2&&vo(g)))switch(D&&D.length>0&&(S=g.h,S.i=S.i.concat(D)),fe){case 1:Ds(g,5);break;case 4:Ds(g,10);break;case 3:Ds(g,6);break;default:Ds(g,2)}}}function vh(g,S){let D=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(D*=2),D*S}function Ds(g,S){if(g.j.info("Error code "+S),S==2){var D=h(g.bb,g),X=g.Ua;const fe=!X;X=new xa(X||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||un(X,"https"),uo(X),fe?os(X.toString(),D):Xu(X.toString(),D)}else Cr(2);g.I=0,g.l&&g.l.pa(S),yh(g),yc(g)}t.bb=function(g){g?(this.j.info("Successfully pinged google.com"),Cr(2)):(this.j.info("Failed to ping google.com"),Cr(1))};function yh(g){if(g.I=0,g.ja=[],g.l){const S=ga(g.h);(S.length!=0||g.i.length!=0)&&(w(g.ja,S),w(g.ja,g.i),g.h.i.length=0,b(g.i),g.i.length=0),g.l.oa()}}function _h(g,S,D){var X=D instanceof xa?Hr(D):new xa(D);if(X.g!="")S&&(X.g=S+"."+X.g),Wi(X,X.u);else{var fe=o.location;X=fe.protocol,S=S?S+"."+fe.hostname:fe.hostname,fe=+fe.port;const be=new xa(null);X&&un(be,X),S&&(be.g=S),fe&&Wi(be,fe),D&&(be.h=D),X=be}return D=g.G,S=g.wa,D&&S&&Qt(X,D,S),Qt(X,"VER",g.ka),xo(g,X),X}function bh(g,S,D){if(S&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=g.Aa&&!g.ma?new nr(new Ns({ab:D})):new nr(g.ma),S.Fa(g.L),S}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function wh(){}t=wh.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function el(){}el.prototype.g=function(g,S){return new Gn(g,S)};function Gn(g,S){nt.call(this),this.g=new Ji(S),this.l=g,this.h=S&&S.messageUrlParams||null,g=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(g?g["X-WebChannel-Content-Type"]=S.messageContentType:g={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(g?g["X-WebChannel-Client-Profile"]=S.sa:g={"X-WebChannel-Client-Profile":S.sa}),this.g.U=g,(g=S&&S.Qb)&&!L(g)&&(this.g.u=g),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!L(S)&&(this.g.G=S,g=this.h,g!==null&&S in g&&(g=this.h,S in g&&delete g[S])),this.j=new oi(this)}x(Gn,nt),Gn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Gn.prototype.close=function(){Ku(this.g)},Gn.prototype.o=function(g){var S=this.g;if(typeof g=="string"){var D={};D.__data__=g,g=D}else this.v&&(D={},D.__data__=Yt(g),g=D);S.i.push(new Ze(S.Ya++,g)),S.I==3&&Is(S)},Gn.prototype.N=function(){this.g.l=null,delete this.j,Ku(this.g),delete this.g,Gn.Z.N.call(this)};function Eh(g){or.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var S=g.__sm__;if(S){e:{for(const D in S){g=D;break e}g=void 0}(this.i=g)&&(g=this.i,S=S!==null&&g in S?S[g]:void 0),this.data=S}else this.data=g}x(Eh,or);function Th(){cn.call(this),this.status=1}x(Th,cn);function oi(g){this.g=g}x(oi,wh),oi.prototype.ra=function(){ht(this.g,"a")},oi.prototype.qa=function(g){ht(this.g,new Eh(g))},oi.prototype.pa=function(g){ht(this.g,new Th)},oi.prototype.oa=function(){ht(this.g,"b")},el.prototype.createWebChannel=el.prototype.g,Gn.prototype.send=Gn.prototype.o,Gn.prototype.open=Gn.prototype.m,Gn.prototype.close=Gn.prototype.close,N4=function(){return new el},k4=function(){return as()},A4=mr,Sx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ni.NO_ERROR=0,ni.TIMEOUT=8,ni.HTTP_ERROR=6,tm=ni,ai.COMPLETE="complete",S4=ai,tn.EventType=Mt,Mt.OPEN="a",Mt.CLOSE="b",Mt.ERROR="c",Mt.MESSAGE="d",nt.prototype.listen=nt.prototype.J,zf=tn,nr.prototype.listenOnce=nr.prototype.K,nr.prototype.getLastError=nr.prototype.Ha,nr.prototype.getLastErrorCode=nr.prototype.ya,nr.prototype.getStatus=nr.prototype.ca,nr.prototype.getResponseJson=nr.prototype.La,nr.prototype.getResponseText=nr.prototype.la,nr.prototype.send=nr.prototype.ea,nr.prototype.setWithCredentials=nr.prototype.Fa,T4=nr}).apply(typeof Rd<"u"?Rd:typeof self<"u"?self:typeof window<"u"?window:{});const oE="@firebase/firestore",cE="4.9.2";let On=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};On.UNAUTHENTICATED=new On(null),On.GOOGLE_CREDENTIALS=new On("google-credentials-uid"),On.FIRST_PARTY=new On("first-party-uid"),On.MOCK_USER=new On("mock-user");let Iu="12.3.0";const $o=new yv("@firebase/firestore");function tu(){return $o.logLevel}function Qe(t,...e){if($o.logLevel<=It.DEBUG){const r=e.map(wv);$o.debug(`Firestore (${Iu}): ${t}`,...r)}}function ji(t,...e){if($o.logLevel<=It.ERROR){const r=e.map(wv);$o.error(`Firestore (${Iu}): ${t}`,...r)}}function vu(t,...e){if($o.logLevel<=It.WARN){const r=e.map(wv);$o.warn(`Firestore (${Iu}): ${t}`,...r)}}function wv(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function ut(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,C4(t,n,r)}function C4(t,e,r){let n=`FIRESTORE (${Iu}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ji(n),new Error(n)}function Xt(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||C4(e,a,n)}function vt(t,e){return t}const Ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends Vi{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ci{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class R4{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class dD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(On.UNAUTHENTICATED)))}shutdown(){}}class mD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class pD{constructor(e){this.t=e,this.currentUser=On.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Xt(this.o===void 0,42304);let n=this.i;const a=f=>this.i!==n?(n=this.i,r(f)):Promise.resolve();let i=new Ci;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ci,e.enqueueRetryable((()=>a(this.currentUser)))};const o=()=>{const f=i;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},u=f=>{Qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((f=>u(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(Qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ci)}}),0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(Qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Xt(typeof n.accessToken=="string",31837,{l:n}),new R4(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Xt(e===null||typeof e=="string",2055,{h:e}),new On(e)}}class gD{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=On.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class xD{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new gD(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(On.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class uE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vD{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_s(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Xt(this.o===void 0,3512);const n=i=>{i.error!=null&&Qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Qe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>n(i)))};const a=i=>{Qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>a(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?a(i):Qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new uE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Xt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new uE(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function yD(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class Ev{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=yD(40);for(let i=0;i<a.length;++i)n.length<20&&a[i]<r&&(n+=e.charAt(a[i]%62))}return n}}function Dt(t,e){return t<e?-1:t>e?1:0}function Ax(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const a=t.charAt(n),i=e.charAt(n);if(a!==i)return q1(a)===q1(i)?Dt(a,i):q1(a)?1:-1}return Dt(t.length,e.length)}const _D=55296,bD=57343;function q1(t){const e=t.charCodeAt(0);return e>=_D&&e<=bD}function yu(t,e,r){return t.length===e.length&&t.every(((n,a)=>r(n,e[a])))}const fE="__name__";class Us{constructor(e,r,n){r===void 0?r=0:r>e.length&&ut(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ut(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Us.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Us?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const i=Us.compareSegments(e.get(a),r.get(a));if(i!==0)return i}return Dt(e.length,r.length)}static compareSegments(e,r){const n=Us.isNumericId(e),a=Us.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?Us.extractNumericId(e).compare(Us.extractNumericId(r)):Ax(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ml.fromString(e.substring(4,e.length-2))}}class dr extends Us{construct(e,r,n){return new dr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new $e(Ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((a=>a.length>0)))}return new dr(r)}static emptyPath(){return new dr([])}}const wD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Tn extends Us{construct(e,r,n){return new Tn(e,r,n)}static isValidIdentifier(e){return wD.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Tn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fE}static keyField(){return new Tn([fE])}static fromServerFormat(e){const r=[];let n="",a=0;const i=()=>{if(n.length===0)throw new $e(Ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new $e(Ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new $e(Ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,a+=2}else u==="`"?(o=!o,a++):u!=="."||o?(n+=u,a++):(i(),a++)}if(i(),o)throw new $e(Ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Tn(r)}static emptyPath(){return new Tn([])}}class it{constructor(e){this.path=e}static fromPath(e){return new it(dr.fromString(e))}static fromName(e){return new it(dr.fromString(e).popFirst(5))}static empty(){return new it(dr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&dr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return dr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new it(new dr(e.slice()))}}function I4(t,e,r){if(!r)throw new $e(Ie.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ED(t,e,r,n){if(e===!0&&n===!0)throw new $e(Ie.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function hE(t){if(!it.isDocumentKey(t))throw new $e(Ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function dE(t){if(it.isDocumentKey(t))throw new $e(Ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function D4(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function ep(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ut(12329,{type:typeof t})}function $n(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $e(Ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=ep(t);throw new $e(Ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function Zr(t,e){const r={typeString:t};return e&&(r.value=e),r}function M0(t,e){if(!D4(t))throw new $e(Ie.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const a=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(a&&typeof o!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(i!==void 0&&o!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new $e(Ie.INVALID_ARGUMENT,r);return!0}const mE=-62135596800,pE=1e6;class vr{static now(){return vr.fromMillis(Date.now())}static fromDate(e){return vr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*pE);return new vr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<mE)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/pE}_compareTo(e){return this.seconds===e.seconds?Dt(this.nanoseconds,e.nanoseconds):Dt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:vr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(M0(e,vr._jsonSchema))return new vr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-mE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}vr._jsonSchemaVersion="firestore/timestamp/1.0",vr._jsonSchema={type:Zr("string",vr._jsonSchemaVersion),seconds:Zr("number"),nanoseconds:Zr("number")};class gt{static fromTimestamp(e){return new gt(e)}static min(){return new gt(new vr(0,0))}static max(){return new gt(new vr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const f0=-1;function TD(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=gt.fromTimestamp(n===1e9?new vr(r+1,0):new vr(r,n));return new Ul(a,it.empty(),e)}function SD(t){return new Ul(t.readTime,t.key,f0)}class Ul{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ul(gt.min(),it.empty(),f0)}static max(){return new Ul(gt.max(),it.empty(),f0)}}function AD(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=it.comparator(t.documentKey,e.documentKey),r!==0?r:Dt(t.largestBatchId,e.largestBatchId))}const kD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ND{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Du(t){if(t.code!==Ie.FAILED_PRECONDITION||t.message!==kD)throw t;Qe("LocalStore","Unexpectedly lost primary lease")}class Pe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ut(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Pe(((n,a)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,a)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,a)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof Pe?r:Pe.resolve(r)}catch(r){return Pe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):Pe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):Pe.reject(r)}static resolve(e){return new Pe(((r,n)=>{r(e)}))}static reject(e){return new Pe(((r,n)=>{n(e)}))}static waitFor(e){return new Pe(((r,n)=>{let a=0,i=0,o=!1;e.forEach((u=>{++a,u.next((()=>{++i,o&&i===a&&r()}),(f=>n(f)))})),o=!0,i===a&&r()}))}static or(e){let r=Pe.resolve(!1);for(const n of e)r=r.next((a=>a?Pe.resolve(a):n()));return r}static forEach(e,r){const n=[];return e.forEach(((a,i)=>{n.push(r.call(this,a,i))})),this.waitFor(n)}static mapArray(e,r){return new Pe(((n,a)=>{const i=e.length,o=new Array(i);let u=0;for(let f=0;f<i;f++){const h=f;r(e[h]).next((p=>{o[h]=p,++u,u===i&&n(o)}),(p=>a(p)))}}))}static doWhile(e,r){return new Pe(((n,a)=>{const i=()=>{e()===!0?r().next((()=>{i()}),a):n()};i()}))}}function CD(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Ou(t){return t.name==="IndexedDbTransactionError"}class tp{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}tp.ce=-1;const Tv=-1;function rp(t){return t==null}function mm(t){return t===0&&1/t==-1/0}function RD(t){return typeof t=="number"&&Number.isInteger(t)&&!mm(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const O4="";function ID(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=gE(e)),e=DD(t.get(r),e);return gE(e)}function DD(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const i=t.charAt(a);switch(i){case"\0":r+="";break;case O4:r+="";break;default:r+=i}}return r}function gE(t){return t+O4+""}function xE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function to(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function F4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Nr{constructor(e,r){this.comparator=e,this.root=r||wn.EMPTY}insert(e,r){return new Nr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,wn.BLACK,null,null))}remove(e){return new Nr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Id(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Id(this.root,e,this.comparator,!1)}getReverseIterator(){return new Id(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Id(this.root,e,this.comparator,!0)}}class Id{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&a&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class wn{constructor(e,r,n,a,i){this.key=e,this.value=r,this.color=n??wn.RED,this.left=a??wn.EMPTY,this.right=i??wn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,i){return new wn(e??this.key,r??this.value,n??this.color,a??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const i=n(e,a.key);return a=i<0?a.copy(null,null,null,a.left.insert(e,r,n),null):i===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return wn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return wn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ut(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ut(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ut(27949);return e+(this.isRed()?0:1)}}wn.EMPTY=null,wn.RED=!0,wn.BLACK=!1;wn.EMPTY=new class{constructor(){this.size=0}get key(){throw ut(57766)}get value(){throw ut(16141)}get color(){throw ut(16727)}get left(){throw ut(29726)}get right(){throw ut(36894)}copy(e,r,n,a,i){return this}insert(e,r,n){return new wn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class an{constructor(e){this.comparator=e,this.data=new Nr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new vE(this.data.getIterator())}getIteratorFrom(e){return new vE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof an)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,i=n.getNext().key;if(this.comparator(a,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new an(this.comparator);return r.data=e,r}}class vE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ca{constructor(e){this.fields=e,e.sort(Tn.comparator)}static empty(){return new Ca([])}unionWith(e){let r=new an(Tn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ca(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return yu(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}class j4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class An{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(a){try{return atob(a)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new j4("Invalid base64 string: "+i):i}})(e);return new An(r)}static fromUint8Array(e){const r=(function(a){let i="";for(let o=0;o<a.length;++o)i+=String.fromCharCode(a[o]);return i})(e);return new An(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Dt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}An.EMPTY_BYTE_STRING=new An("");const OD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zl(t){if(Xt(!!t,39018),typeof t=="string"){let e=0;const r=OD.exec(t);if(Xt(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Vr(t.seconds),nanos:Vr(t.nanos)}}function Vr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Hl(t){return typeof t=="string"?An.fromBase64String(t):An.fromUint8Array(t)}const P4="server_timestamp",M4="__type__",L4="__previous_value__",B4="__local_write_time__";function Sv(t){return(t?.mapValue?.fields||{})[M4]?.stringValue===P4}function np(t){const e=t.mapValue.fields[L4];return Sv(e)?np(e):e}function h0(t){const e=zl(t.mapValue.fields[B4].timestampValue);return new vr(e.seconds,e.nanos)}class FD{constructor(e,r,n,a,i,o,u,f,h,p){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=h,this.isUsingEmulator=p}}const pm="(default)";class d0{constructor(e,r){this.projectId=e,this.database=r||pm}static empty(){return new d0("","")}get isDefaultDatabase(){return this.database===pm}isEqual(e){return e instanceof d0&&e.projectId===this.projectId&&e.database===this.database}}const V4="__type__",jD="__max__",Dd={mapValue:{}},U4="__vector__",gm="value";function ql(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Sv(t)?4:MD(t)?9007199254740991:PD(t)?10:11:ut(28295,{value:t})}function Ks(t,e){if(t===e)return!0;const r=ql(t);if(r!==ql(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return h0(t).isEqual(h0(e));case 3:return(function(a,i){if(typeof a.timestampValue=="string"&&typeof i.timestampValue=="string"&&a.timestampValue.length===i.timestampValue.length)return a.timestampValue===i.timestampValue;const o=zl(a.timestampValue),u=zl(i.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,i){return Hl(a.bytesValue).isEqual(Hl(i.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,i){return Vr(a.geoPointValue.latitude)===Vr(i.geoPointValue.latitude)&&Vr(a.geoPointValue.longitude)===Vr(i.geoPointValue.longitude)})(t,e);case 2:return(function(a,i){if("integerValue"in a&&"integerValue"in i)return Vr(a.integerValue)===Vr(i.integerValue);if("doubleValue"in a&&"doubleValue"in i){const o=Vr(a.doubleValue),u=Vr(i.doubleValue);return o===u?mm(o)===mm(u):isNaN(o)&&isNaN(u)}return!1})(t,e);case 9:return yu(t.arrayValue.values||[],e.arrayValue.values||[],Ks);case 10:case 11:return(function(a,i){const o=a.mapValue.fields||{},u=i.mapValue.fields||{};if(xE(o)!==xE(u))return!1;for(const f in o)if(o.hasOwnProperty(f)&&(u[f]===void 0||!Ks(o[f],u[f])))return!1;return!0})(t,e);default:return ut(52216,{left:t})}}function m0(t,e){return(t.values||[]).find((r=>Ks(r,e)))!==void 0}function _u(t,e){if(t===e)return 0;const r=ql(t),n=ql(e);if(r!==n)return Dt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Dt(t.booleanValue,e.booleanValue);case 2:return(function(i,o){const u=Vr(i.integerValue||i.doubleValue),f=Vr(o.integerValue||o.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1})(t,e);case 3:return yE(t.timestampValue,e.timestampValue);case 4:return yE(h0(t),h0(e));case 5:return Ax(t.stringValue,e.stringValue);case 6:return(function(i,o){const u=Hl(i),f=Hl(o);return u.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(i,o){const u=i.split("/"),f=o.split("/");for(let h=0;h<u.length&&h<f.length;h++){const p=Dt(u[h],f[h]);if(p!==0)return p}return Dt(u.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(i,o){const u=Dt(Vr(i.latitude),Vr(o.latitude));return u!==0?u:Dt(Vr(i.longitude),Vr(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return _E(t.arrayValue,e.arrayValue);case 10:return(function(i,o){const u=i.fields||{},f=o.fields||{},h=u[gm]?.arrayValue,p=f[gm]?.arrayValue,x=Dt(h?.values?.length||0,p?.values?.length||0);return x!==0?x:_E(h,p)})(t.mapValue,e.mapValue);case 11:return(function(i,o){if(i===Dd.mapValue&&o===Dd.mapValue)return 0;if(i===Dd.mapValue)return 1;if(o===Dd.mapValue)return-1;const u=i.fields||{},f=Object.keys(u),h=o.fields||{},p=Object.keys(h);f.sort(),p.sort();for(let x=0;x<f.length&&x<p.length;++x){const y=Ax(f[x],p[x]);if(y!==0)return y;const b=_u(u[f[x]],h[p[x]]);if(b!==0)return b}return Dt(f.length,p.length)})(t.mapValue,e.mapValue);default:throw ut(23264,{he:r})}}function yE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Dt(t,e);const r=zl(t),n=zl(e),a=Dt(r.seconds,n.seconds);return a!==0?a:Dt(r.nanos,n.nanos)}function _E(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const i=_u(r[a],n[a]);if(i)return i}return Dt(r.length,n.length)}function bu(t){return kx(t)}function kx(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=zl(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return Hl(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return it.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",a=!0;for(const i of r.values||[])a?a=!1:n+=",",n+=kx(i);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let a="{",i=!0;for(const o of n)i?i=!1:a+=",",a+=`${o}:${kx(r.fields[o])}`;return a+"}"})(t.mapValue):ut(61005,{value:t})}function rm(t){switch(ql(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=np(t);return e?16+rm(e):16;case 5:return 2*t.stringValue.length;case 6:return Hl(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,i)=>a+rm(i)),0)})(t.arrayValue);case 10:case 11:return(function(n){let a=0;return to(n.fields,((i,o)=>{a+=i.length+rm(o)})),a})(t.mapValue);default:throw ut(13486,{value:t})}}function bE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Nx(t){return!!t&&"integerValue"in t}function Av(t){return!!t&&"arrayValue"in t}function wE(t){return!!t&&"nullValue"in t}function EE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function nm(t){return!!t&&"mapValue"in t}function PD(t){return(t?.mapValue?.fields||{})[V4]?.stringValue===U4}function Kf(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return to(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=Kf(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Kf(t.arrayValue.values[r]);return e}return{...t}}function MD(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===jD}class ca{constructor(e){this.value=e}static empty(){return new ca({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!nm(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kf(r)}setAll(e){let r=Tn.emptyPath(),n={},a=[];e.forEach(((o,u)=>{if(!r.isImmediateParentOf(u)){const f=this.getFieldsMap(r);this.applyChanges(f,n,a),n={},a=[],r=u.popLast()}o?n[u.lastSegment()]=Kf(o):a.push(u.lastSegment())}));const i=this.getFieldsMap(r);this.applyChanges(i,n,a)}delete(e){const r=this.field(e.popLast());nm(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ks(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];nm(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){to(r,((a,i)=>e[a]=i));for(const a of n)delete e[a]}clone(){return new ca(Kf(this.value))}}function z4(t){const e=[];return to(t.fields,((r,n)=>{const a=new Tn([r]);if(nm(n)){const i=z4(n.mapValue).fields;if(i.length===0)e.push(a);else for(const o of i)e.push(a.child(o))}else e.push(a)})),new Ca(e)}class Pn{constructor(e,r,n,a,i,o,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=i,this.data=o,this.documentState=u}static newInvalidDocument(e){return new Pn(e,0,gt.min(),gt.min(),gt.min(),ca.empty(),0)}static newFoundDocument(e,r,n,a){return new Pn(e,1,r,gt.min(),n,a,0)}static newNoDocument(e,r){return new Pn(e,2,r,gt.min(),gt.min(),ca.empty(),0)}static newUnknownDocument(e,r){return new Pn(e,3,r,gt.min(),gt.min(),ca.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(gt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ca.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ca.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=gt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class xm{constructor(e,r){this.position=e,this.inclusive=r}}function TE(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const i=e[a],o=t.position[a];if(i.field.isKeyField()?n=it.comparator(it.fromName(o.referenceValue),r.key):n=_u(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function SE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ks(t.position[r],e.position[r]))return!1;return!0}class p0{constructor(e,r="asc"){this.field=e,this.dir=r}}function LD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class H4{}class Jr extends H4{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new VD(e,r,n):r==="array-contains"?new HD(e,n):r==="in"?new qD(e,n):r==="not-in"?new GD(e,n):r==="array-contains-any"?new WD(e,n):new Jr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new UD(e,n):new zD(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(_u(r,this.value)):r!==null&&ql(this.value)===ql(r)&&this.matchesComparison(_u(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ut(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class As extends H4{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new As(e,r)}matches(e){return q4(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function q4(t){return t.op==="and"}function G4(t){return BD(t)&&q4(t)}function BD(t){for(const e of t.filters)if(e instanceof As)return!1;return!0}function Cx(t){if(t instanceof Jr)return t.field.canonicalString()+t.op.toString()+bu(t.value);if(G4(t))return t.filters.map((e=>Cx(e))).join(",");{const e=t.filters.map((r=>Cx(r))).join(",");return`${t.op}(${e})`}}function W4(t,e){return t instanceof Jr?(function(n,a){return a instanceof Jr&&n.op===a.op&&n.field.isEqual(a.field)&&Ks(n.value,a.value)})(t,e):t instanceof As?(function(n,a){return a instanceof As&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((i,o,u)=>i&&W4(o,a.filters[u])),!0):!1})(t,e):void ut(19439)}function X4(t){return t instanceof Jr?(function(r){return`${r.field.canonicalString()} ${r.op} ${bu(r.value)}`})(t):t instanceof As?(function(r){return r.op.toString()+" {"+r.getFilters().map(X4).join(" ,")+"}"})(t):"Filter"}class VD extends Jr{constructor(e,r,n){super(e,r,n),this.key=it.fromName(n.referenceValue)}matches(e){const r=it.comparator(e.key,this.key);return this.matchesComparison(r)}}class UD extends Jr{constructor(e,r){super(e,"in",r),this.keys=Y4("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class zD extends Jr{constructor(e,r){super(e,"not-in",r),this.keys=Y4("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function Y4(t,e){return(e.arrayValue?.values||[]).map((r=>it.fromName(r.referenceValue)))}class HD extends Jr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Av(r)&&m0(r.arrayValue,this.value)}}class qD extends Jr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&m0(this.value.arrayValue,r)}}class GD extends Jr{constructor(e,r){super(e,"not-in",r)}matches(e){if(m0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!m0(this.value.arrayValue,r)}}class WD extends Jr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Av(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>m0(this.value.arrayValue,n)))}}class XD{constructor(e,r=null,n=[],a=[],i=null,o=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=i,this.startAt=o,this.endAt=u,this.Te=null}}function AE(t,e=null,r=[],n=[],a=null,i=null,o=null){return new XD(t,e,r,n,a,i,o)}function kv(t){const e=vt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>Cx(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(i){return i.field.canonicalString()+i.dir})(n))).join(","),rp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>bu(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>bu(n))).join(",")),e.Te=r}return e.Te}function Nv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!LD(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!W4(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!SE(t.startAt,e.startAt)&&SE(t.endAt,e.endAt)}function Rx(t){return it.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Fu{constructor(e,r=null,n=[],a=[],i=null,o="F",u=null,f=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function YD(t,e,r,n,a,i,o,u){return new Fu(t,e,r,n,a,i,o,u)}function ap(t){return new Fu(t)}function kE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function $4(t){return t.collectionGroup!==null}function Qf(t){const e=vt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new an(Tn.comparator);return o.filters.forEach((f=>{f.getFlattenedFilters().forEach((h=>{h.isInequality()&&(u=u.add(h.field))}))})),u})(e).forEach((i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new p0(i,n))})),r.has(Tn.keyField().canonicalString())||e.Ie.push(new p0(Tn.keyField(),n))}return e.Ie}function Hs(t){const e=vt(t);return e.Ee||(e.Ee=$D(e,Qf(t))),e.Ee}function $D(t,e){if(t.limitType==="F")return AE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const i=a.dir==="desc"?"asc":"desc";return new p0(a.field,i)}));const r=t.endAt?new xm(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new xm(t.startAt.position,t.startAt.inclusive):null;return AE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Ix(t,e){const r=t.filters.concat([e]);return new Fu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Dx(t,e,r){return new Fu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function sp(t,e){return Nv(Hs(t),Hs(e))&&t.limitType===e.limitType}function K4(t){return`${kv(Hs(t))}|lt:${t.limitType}`}function ru(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((a=>X4(a))).join(", ")}]`),rp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((a=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(a))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((a=>bu(a))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((a=>bu(a))).join(",")),`Target(${n})`})(Hs(t))}; limitType=${t.limitType})`}function ip(t,e){return e.isFoundDocument()&&(function(n,a){const i=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):it.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)})(t,e)&&(function(n,a){for(const i of Qf(n))if(!i.field.isKeyField()&&a.data.field(i.field)===null)return!1;return!0})(t,e)&&(function(n,a){for(const i of n.filters)if(!i.matches(a))return!1;return!0})(t,e)&&(function(n,a){return!(n.startAt&&!(function(o,u,f){const h=TE(o,u,f);return o.inclusive?h<=0:h<0})(n.startAt,Qf(n),a)||n.endAt&&!(function(o,u,f){const h=TE(o,u,f);return o.inclusive?h>=0:h>0})(n.endAt,Qf(n),a))})(t,e)}function KD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Q4(t){return(e,r)=>{let n=!1;for(const a of Qf(t)){const i=QD(a,e,r);if(i!==0)return i;n=n||a.field.isKeyField()}return 0}}function QD(t,e,r){const n=t.field.isKeyField()?it.comparator(e.key,r.key):(function(i,o,u){const f=o.data.field(i),h=u.data.field(i);return f!==null&&h!==null?_u(f,h):ut(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ut(19790,{direction:t.dir})}}class sc{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,i]of n)if(this.equalsFn(a,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<a.length;i++)if(this.equalsFn(a[i][0],e))return void(a[i]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){to(this.inner,((r,n)=>{for(const[a,i]of n)e(a,i)}))}isEmpty(){return F4(this.inner)}size(){return this.innerSize}}const JD=new Nr(it.comparator);function Pi(){return JD}const J4=new Nr(it.comparator);function Hf(...t){let e=J4;for(const r of t)e=e.insert(r.key,r);return e}function Z4(t){let e=J4;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function Mo(){return Jf()}function eA(){return Jf()}function Jf(){return new sc((t=>t.toString()),((t,e)=>t.isEqual(e)))}const ZD=new Nr(it.comparator),e8=new an(it.comparator);function Ot(...t){let e=e8;for(const r of t)e=e.add(r);return e}const t8=new an(Dt);function r8(){return t8}function Cv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:mm(e)?"-0":e}}function tA(t){return{integerValue:""+t}}function n8(t,e){return RD(e)?tA(e):Cv(t,e)}class lp{constructor(){this._=void 0}}function a8(t,e,r){return t instanceof vm?(function(a,i){const o={fields:{[M4]:{stringValue:P4},[B4]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return i&&Sv(i)&&(i=np(i)),i&&(o.fields[L4]=i),{mapValue:o}})(r,e):t instanceof g0?nA(t,e):t instanceof x0?aA(t,e):(function(a,i){const o=rA(a,i),u=NE(o)+NE(a.Ae);return Nx(o)&&Nx(a.Ae)?tA(u):Cv(a.serializer,u)})(t,e)}function s8(t,e,r){return t instanceof g0?nA(t,e):t instanceof x0?aA(t,e):r}function rA(t,e){return t instanceof ym?(function(n){return Nx(n)||(function(i){return!!i&&"doubleValue"in i})(n)})(e)?e:{integerValue:0}:null}class vm extends lp{}class g0 extends lp{constructor(e){super(),this.elements=e}}function nA(t,e){const r=sA(e);for(const n of t.elements)r.some((a=>Ks(a,n)))||r.push(n);return{arrayValue:{values:r}}}class x0 extends lp{constructor(e){super(),this.elements=e}}function aA(t,e){let r=sA(e);for(const n of t.elements)r=r.filter((a=>!Ks(a,n)));return{arrayValue:{values:r}}}class ym extends lp{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function NE(t){return Vr(t.integerValue||t.doubleValue)}function sA(t){return Av(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function i8(t,e){return t.field.isEqual(e.field)&&(function(n,a){return n instanceof g0&&a instanceof g0||n instanceof x0&&a instanceof x0?yu(n.elements,a.elements,Ks):n instanceof ym&&a instanceof ym?Ks(n.Ae,a.Ae):n instanceof vm&&a instanceof vm})(t.transform,e.transform)}class l8{constructor(e,r){this.version=e,this.transformResults=r}}class Kn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Kn}static exists(e){return new Kn(void 0,e)}static updateTime(e){return new Kn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function am(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class op{}function iA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new cp(t.key,Kn.none()):new L0(t.key,t.data,Kn.none());{const r=t.data,n=ca.empty();let a=new an(Tn.comparator);for(let i of e.fields)if(!a.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),a=a.add(i)}return new ro(t.key,n,new Ca(a.toArray()),Kn.none())}}function o8(t,e,r){t instanceof L0?(function(a,i,o){const u=a.value.clone(),f=RE(a.fieldTransforms,i,o.transformResults);u.setAll(f),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(t,e,r):t instanceof ro?(function(a,i,o){if(!am(a.precondition,i))return void i.convertToUnknownDocument(o.version);const u=RE(a.fieldTransforms,i,o.transformResults),f=i.data;f.setAll(lA(a)),f.setAll(u),i.convertToFoundDocument(o.version,f).setHasCommittedMutations()})(t,e,r):(function(a,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,r)}function Zf(t,e,r,n){return t instanceof L0?(function(i,o,u,f){if(!am(i.precondition,o))return u;const h=i.value.clone(),p=IE(i.fieldTransforms,f,o);return h.setAll(p),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(t,e,r,n):t instanceof ro?(function(i,o,u,f){if(!am(i.precondition,o))return u;const h=IE(i.fieldTransforms,f,o),p=o.data;return p.setAll(lA(i)),p.setAll(h),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),u===null?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((x=>x.field)))})(t,e,r,n):(function(i,o,u){return am(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u})(t,e,r)}function c8(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),i=rA(n.transform,a||null);i!=null&&(r===null&&(r=ca.empty()),r.set(n.field,i))}return r||null}function CE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&yu(n,a,((i,o)=>i8(i,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class L0 extends op{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ro extends op{constructor(e,r,n,a,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function lA(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function RE(t,e,r){const n=new Map;Xt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let a=0;a<r.length;a++){const i=t[a],o=i.transform,u=e.data.field(i.field);n.set(i.field,s8(o,u,r[a]))}return n}function IE(t,e,r){const n=new Map;for(const a of t){const i=a.transform,o=r.data.field(a.field);n.set(a.field,a8(i,o,e))}return n}class cp extends op{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class u8 extends op{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class f8{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const i=this.mutations[a];i.key.isEqual(e.key)&&o8(i,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Zf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Zf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=eA();return this.mutations.forEach((a=>{const i=e.get(a.key),o=i.overlayedDocument;let u=this.applyToLocalView(o,i.mutatedFields);u=r.has(a.key)?null:u;const f=iA(o,u);f!==null&&n.set(a.key,f),o.isValidDocument()||o.convertToNoDocument(gt.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Ot())}isEqual(e){return this.batchId===e.batchId&&yu(this.mutations,e.mutations,((r,n)=>CE(r,n)))&&yu(this.baseMutations,e.baseMutations,((r,n)=>CE(r,n)))}}class Rv{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Xt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return ZD})();const i=e.mutations;for(let o=0;o<i.length;o++)a=a.insert(i[o].key,n[o].version);return new Rv(e,r,n,a)}}class h8{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class d8{constructor(e,r){this.count=e,this.unchangedNames=r}}var $r,jt;function m8(t){switch(t){case Ie.OK:return ut(64938);case Ie.CANCELLED:case Ie.UNKNOWN:case Ie.DEADLINE_EXCEEDED:case Ie.RESOURCE_EXHAUSTED:case Ie.INTERNAL:case Ie.UNAVAILABLE:case Ie.UNAUTHENTICATED:return!1;case Ie.INVALID_ARGUMENT:case Ie.NOT_FOUND:case Ie.ALREADY_EXISTS:case Ie.PERMISSION_DENIED:case Ie.FAILED_PRECONDITION:case Ie.ABORTED:case Ie.OUT_OF_RANGE:case Ie.UNIMPLEMENTED:case Ie.DATA_LOSS:return!0;default:return ut(15467,{code:t})}}function oA(t){if(t===void 0)return ji("GRPC error has no .code"),Ie.UNKNOWN;switch(t){case $r.OK:return Ie.OK;case $r.CANCELLED:return Ie.CANCELLED;case $r.UNKNOWN:return Ie.UNKNOWN;case $r.DEADLINE_EXCEEDED:return Ie.DEADLINE_EXCEEDED;case $r.RESOURCE_EXHAUSTED:return Ie.RESOURCE_EXHAUSTED;case $r.INTERNAL:return Ie.INTERNAL;case $r.UNAVAILABLE:return Ie.UNAVAILABLE;case $r.UNAUTHENTICATED:return Ie.UNAUTHENTICATED;case $r.INVALID_ARGUMENT:return Ie.INVALID_ARGUMENT;case $r.NOT_FOUND:return Ie.NOT_FOUND;case $r.ALREADY_EXISTS:return Ie.ALREADY_EXISTS;case $r.PERMISSION_DENIED:return Ie.PERMISSION_DENIED;case $r.FAILED_PRECONDITION:return Ie.FAILED_PRECONDITION;case $r.ABORTED:return Ie.ABORTED;case $r.OUT_OF_RANGE:return Ie.OUT_OF_RANGE;case $r.UNIMPLEMENTED:return Ie.UNIMPLEMENTED;case $r.DATA_LOSS:return Ie.DATA_LOSS;default:return ut(39323,{code:t})}}(jt=$r||($r={}))[jt.OK=0]="OK",jt[jt.CANCELLED=1]="CANCELLED",jt[jt.UNKNOWN=2]="UNKNOWN",jt[jt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",jt[jt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",jt[jt.NOT_FOUND=5]="NOT_FOUND",jt[jt.ALREADY_EXISTS=6]="ALREADY_EXISTS",jt[jt.PERMISSION_DENIED=7]="PERMISSION_DENIED",jt[jt.UNAUTHENTICATED=16]="UNAUTHENTICATED",jt[jt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",jt[jt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",jt[jt.ABORTED=10]="ABORTED",jt[jt.OUT_OF_RANGE=11]="OUT_OF_RANGE",jt[jt.UNIMPLEMENTED=12]="UNIMPLEMENTED",jt[jt.INTERNAL=13]="INTERNAL",jt[jt.UNAVAILABLE=14]="UNAVAILABLE",jt[jt.DATA_LOSS=15]="DATA_LOSS";function p8(){return new TextEncoder}const g8=new Ml([4294967295,4294967295],0);function DE(t){const e=p8().encode(t),r=new E4;return r.update(e),new Uint8Array(r.digest())}function OE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ml([r,n],0),new Ml([a,i],0)]}class Iv{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new qf(`Invalid padding: ${r}`);if(n<0)throw new qf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new qf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new qf(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Ml.fromNumber(this.ge)}ye(e,r,n){let a=e.add(r.multiply(Ml.fromNumber(n)));return a.compare(g8)===1&&(a=new Ml([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=DE(e),[n,a]=OE(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,a,i);if(!this.we(o))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Iv(i,a,r);return n.forEach((u=>o.insert(u))),o}insert(e){if(this.ge===0)return;const r=DE(e),[n,a]=OE(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,a,i);this.Se(o)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class qf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class up{constructor(e,r,n,a,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,B0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new up(gt.min(),a,new Nr(Dt),Pi(),Ot())}}class B0{constructor(e,r,n,a,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new B0(n,r,Ot(),Ot(),Ot())}}class sm{constructor(e,r,n,a){this.be=e,this.removedTargetIds=r,this.key=n,this.De=a}}class cA{constructor(e,r){this.targetId=e,this.Ce=r}}class uA{constructor(e,r,n=An.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class FE{constructor(){this.ve=0,this.Fe=jE(),this.Me=An.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Ot(),r=Ot(),n=Ot();return this.Fe.forEach(((a,i)=>{switch(i){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:ut(38017,{changeType:i})}})),new B0(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=jE()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Xt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class x8{constructor(e){this.Ge=e,this.ze=new Map,this.je=Pi(),this.Je=Od(),this.He=Od(),this.Ye=new Nr(Dt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ut(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,a)=>{this.rt(a)&&r(a)}))}st(e){const r=e.targetId,n=e.Ce.count,a=this.ot(r);if(a){const i=a.target;if(Rx(i))if(n===0){const o=new it(i.path);this.et(r,o,Pn.newNoDocument(o,gt.min()))}else Xt(n===1,20013,{expectedCount:n});else{const o=this._t(r);if(o!==n){const u=this.ut(e),f=u?this.ct(u,e,o):1;if(f!==0){this.it(r);const h=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,h)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:i=0}=r;let o,u;try{o=Hl(n).toUint8Array()}catch(f){if(f instanceof j4)return vu("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new Iv(o,a,i)}catch(f){return vu(f instanceof qf?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.ge===0?null:u}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let a=0;return n.forEach((i=>{const o=this.Ge.ht(),u=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(u)||(this.et(r,i,null),a++)})),a}Tt(e){const r=new Map;this.ze.forEach(((i,o)=>{const u=this.ot(o);if(u){if(i.current&&Rx(u.target)){const f=new it(u.target.path);this.It(f).has(o)||this.Et(o,f)||this.et(o,f,Pn.newNoDocument(f,e))}i.Be&&(r.set(o,i.ke()),i.qe())}}));let n=Ot();this.He.forEach(((i,o)=>{let u=!0;o.forEachWhile((f=>{const h=this.ot(f);return!h||h.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const a=new up(e,r,this.Ye,this.je,n);return this.je=Pi(),this.Je=Od(),this.He=Od(),this.Ye=new Nr(Dt),a}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,r)?a.Qe(r,1):a.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new FE,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new an(Dt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new an(Dt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Qe("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new FE),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Od(){return new Nr(it.comparator)}function jE(){return new Nr(it.comparator)}const v8={asc:"ASCENDING",desc:"DESCENDING"},y8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_8={and:"AND",or:"OR"};class b8{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Ox(t,e){return t.useProto3Json||rp(e)?e:{value:e}}function _m(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function w8(t,e){return _m(t,e.toTimestamp())}function qs(t){return Xt(!!t,49232),gt.fromTimestamp((function(r){const n=zl(r);return new vr(n.seconds,n.nanos)})(t))}function Dv(t,e){return Fx(t,e).canonicalString()}function Fx(t,e){const r=(function(a){return new dr(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?r:r.child(e)}function hA(t){const e=dr.fromString(t);return Xt(xA(e),10190,{key:e.toString()}),e}function jx(t,e){return Dv(t.databaseId,e.path)}function G1(t,e){const r=hA(e);if(r.get(1)!==t.databaseId.projectId)throw new $e(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new $e(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new it(mA(r))}function dA(t,e){return Dv(t.databaseId,e)}function E8(t){const e=hA(t);return e.length===4?dr.emptyPath():mA(e)}function Px(t){return new dr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function mA(t){return Xt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function PE(t,e,r){return{name:jx(t,e),fields:r.value.mapValue.fields}}function T8(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ut(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],i=(function(h,p){return h.useProto3Json?(Xt(p===void 0||typeof p=="string",58123),An.fromBase64String(p||"")):(Xt(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),An.fromUint8Array(p||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&(function(h){const p=h.code===void 0?Ie.UNKNOWN:oA(h.code);return new $e(p,h.message||"")})(o);r=new uA(n,a,i,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=G1(t,n.document.name),i=qs(n.document.updateTime),o=n.document.createTime?qs(n.document.createTime):gt.min(),u=new ca({mapValue:{fields:n.document.fields}}),f=Pn.newFoundDocument(a,i,o,u),h=n.targetIds||[],p=n.removedTargetIds||[];r=new sm(h,p,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=G1(t,n.document),i=n.readTime?qs(n.readTime):gt.min(),o=Pn.newNoDocument(a,i),u=n.removedTargetIds||[];r=new sm([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=G1(t,n.document),i=n.removedTargetIds||[];r=new sm([],i,a,null)}else{if(!("filter"in e))return ut(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:i}=n,o=new d8(a,i),u=n.targetId;r=new cA(u,o)}}return r}function S8(t,e){let r;if(e instanceof L0)r={update:PE(t,e.key,e.value)};else if(e instanceof cp)r={delete:jx(t,e.key)};else if(e instanceof ro)r={update:PE(t,e.key,e.data),updateMask:F8(e.fieldMask)};else{if(!(e instanceof u8))return ut(16599,{Vt:e.type});r={verify:jx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(i,o){const u=o.transform;if(u instanceof vm)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof g0)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof x0)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof ym)return{fieldPath:o.field.canonicalString(),increment:u.Ae};throw ut(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(a,i){return i.updateTime!==void 0?{updateTime:w8(a,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ut(27497)})(t,e.precondition)),r}function A8(t,e){return t&&t.length>0?(Xt(e!==void 0,14353),t.map((r=>(function(a,i){let o=a.updateTime?qs(a.updateTime):qs(i);return o.isEqual(gt.min())&&(o=qs(i)),new l8(o,a.transformResults||[])})(r,e)))):[]}function k8(t,e){return{documents:[dA(t,e.path)]}}function N8(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=dA(t,a);const i=(function(h){if(h.length!==0)return gA(As.create(h,"and"))})(e.filters);i&&(r.structuredQuery.where=i);const o=(function(h){if(h.length!==0)return h.map((p=>(function(y){return{field:nu(y.field),direction:I8(y.dir)}})(p)))})(e.orderBy);o&&(r.structuredQuery.orderBy=o);const u=Ox(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:r,parent:a}}function C8(t){let e=E8(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Xt(n===1,65062);const p=r.from[0];p.allDescendants?a=p.collectionId:e=e.child(p.collectionId)}let i=[];r.where&&(i=(function(x){const y=pA(x);return y instanceof As&&G4(y)?y.getFilters():[y]})(r.where));let o=[];r.orderBy&&(o=(function(x){return x.map((y=>(function(w){return new p0(au(w.field),(function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(y)))})(r.orderBy));let u=null;r.limit&&(u=(function(x){let y;return y=typeof x=="object"?x.value:x,rp(y)?null:y})(r.limit));let f=null;r.startAt&&(f=(function(x){const y=!!x.before,b=x.values||[];return new xm(b,y)})(r.startAt));let h=null;return r.endAt&&(h=(function(x){const y=!x.before,b=x.values||[];return new xm(b,y)})(r.endAt)),YD(e,a,o,i,u,"F",f,h)}function R8(t,e){const r=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ut(28987,{purpose:a})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function pA(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=au(r.unaryFilter.field);return Jr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=au(r.unaryFilter.field);return Jr.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=au(r.unaryFilter.field);return Jr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=au(r.unaryFilter.field);return Jr.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ut(61313);default:return ut(60726)}})(t):t.fieldFilter!==void 0?(function(r){return Jr.create(au(r.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ut(58110);default:return ut(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return As.create(r.compositeFilter.filters.map((n=>pA(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ut(1026)}})(r.compositeFilter.op))})(t):ut(30097,{filter:t})}function I8(t){return v8[t]}function D8(t){return y8[t]}function O8(t){return _8[t]}function nu(t){return{fieldPath:t.canonicalString()}}function au(t){return Tn.fromServerFormat(t.fieldPath)}function gA(t){return t instanceof Jr?(function(r){if(r.op==="=="){if(EE(r.value))return{unaryFilter:{field:nu(r.field),op:"IS_NAN"}};if(wE(r.value))return{unaryFilter:{field:nu(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(EE(r.value))return{unaryFilter:{field:nu(r.field),op:"IS_NOT_NAN"}};if(wE(r.value))return{unaryFilter:{field:nu(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:nu(r.field),op:D8(r.op),value:r.value}}})(t):t instanceof As?(function(r){const n=r.getFilters().map((a=>gA(a)));return n.length===1?n[0]:{compositeFilter:{op:O8(r.op),filters:n}}})(t):ut(54877,{filter:t})}function F8(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function xA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Rl{constructor(e,r,n,a,i=gt.min(),o=gt.min(),u=An.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new Rl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Rl(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Rl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Rl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class j8{constructor(e){this.yt=e}}function P8(t){const e=C8({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Dx(e,e.limit,"L"):e}class M8{constructor(){this.Cn=new L8}addToCollectionParentIndex(e,r){return this.Cn.add(r),Pe.resolve()}getCollectionParents(e,r){return Pe.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Pe.resolve()}deleteFieldIndex(e,r){return Pe.resolve()}deleteAllFieldIndexes(e){return Pe.resolve()}createTargetIndexes(e,r){return Pe.resolve()}getDocumentsMatchingTarget(e,r){return Pe.resolve(null)}getIndexType(e,r){return Pe.resolve(0)}getFieldIndexes(e,r){return Pe.resolve([])}getNextCollectionGroupToUpdate(e){return Pe.resolve(null)}getMinOffset(e,r){return Pe.resolve(Ul.min())}getMinOffsetFromCollectionGroup(e,r){return Pe.resolve(Ul.min())}updateCollectionGroup(e,r,n){return Pe.resolve()}updateIndexEntries(e,r){return Pe.resolve()}}class L8{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new an(dr.comparator),i=!a.has(n);return this.index[r]=a.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new an(dr.comparator)).toArray()}}const ME={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},vA=41943040;class la{static withCacheSize(e){return new la(e,la.DEFAULT_COLLECTION_PERCENTILE,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}la.DEFAULT_COLLECTION_PERCENTILE=10,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,la.DEFAULT=new la(vA,la.DEFAULT_COLLECTION_PERCENTILE,la.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),la.DISABLED=new la(-1,0,0);class wu{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new wu(0)}static cr(){return new wu(-1)}}const LE="LruGarbageCollector",B8=1048576;function BE([t,e],[r,n]){const a=Dt(t,r);return a===0?Dt(e,n):a}class V8{constructor(e){this.Ir=e,this.buffer=new an(BE),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();BE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class U8{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Qe(LE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Ou(r)?Qe(LE,"Ignoring IndexedDB error during garbage collection: ",r):await Du(r)}await this.Vr(3e5)}))}}class z8{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return Pe.resolve(tp.ce);const n=new V8(r);return this.mr.forEachTarget(e,(a=>n.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>n.Ar(a))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Qe("LruGarbageCollector","Garbage collection skipped; disabled"),Pe.resolve(ME)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Qe("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ME):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,a,i,o,u,f,h;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(Qe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),a=this.params.maximumSequenceNumbersToCollect):a=x,o=Date.now(),this.nthSequenceNumber(e,a)))).next((x=>(n=x,u=Date.now(),this.removeTargets(e,n,r)))).next((x=>(i=x,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((x=>(h=Date.now(),tu()<=It.DEBUG&&Qe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-p}ms
	Determined least recently used ${a} in `+(u-o)+`ms
	Removed ${i} targets in `+(f-u)+`ms
	Removed ${x} documents in `+(h-f)+`ms
Total Duration: ${h-p}ms`),Pe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:i,documentsRemoved:x}))))}}function H8(t,e){return new z8(t,e)}class q8{constructor(){this.changes=new sc((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Pn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Pe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class G8{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}class W8{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,r)))).next((a=>(n!==null&&Zf(n.mutation,a,Ca.empty(),vr.now()),a)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Ot()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Ot()){const a=Mo();return this.populateOverlays(e,a,r).next((()=>this.computeViews(e,r,a,n).next((i=>{let o=Hf();return i.forEach(((u,f)=>{o=o.insert(u,f.overlayedDocument)})),o}))))}getOverlayedDocuments(e,r){const n=Mo();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Ot())))}populateOverlays(e,r,n){const a=[];return n.forEach((i=>{r.has(i)||a.push(i)})),this.documentOverlayCache.getOverlays(e,a).next((i=>{i.forEach(((o,u)=>{r.set(o,u)}))}))}computeViews(e,r,n,a){let i=Pi();const o=Jf(),u=(function(){return Jf()})();return r.forEach(((f,h)=>{const p=n.get(h.key);a.has(h.key)&&(p===void 0||p.mutation instanceof ro)?i=i.insert(h.key,h):p!==void 0?(o.set(h.key,p.mutation.getFieldMask()),Zf(p.mutation,h,p.mutation.getFieldMask(),vr.now())):o.set(h.key,Ca.empty())})),this.recalculateAndSaveOverlays(e,i).next((f=>(f.forEach(((h,p)=>o.set(h,p))),r.forEach(((h,p)=>u.set(h,new G8(p,o.get(h)??null)))),u)))}recalculateAndSaveOverlays(e,r){const n=Jf();let a=new Nr(((o,u)=>o-u)),i=Ot();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((o=>{for(const u of o)u.keys().forEach((f=>{const h=r.get(f);if(h===null)return;let p=n.get(f)||Ca.empty();p=u.applyToLocalView(h,p),n.set(f,p);const x=(a.get(u.batchId)||Ot()).add(f);a=a.insert(u.batchId,x)}))})).next((()=>{const o=[],u=a.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),h=f.key,p=f.value,x=eA();p.forEach((y=>{if(!i.has(y)){const b=iA(r.get(y),n.get(y));b!==null&&x.set(y,b),i=i.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,x))}return Pe.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,a){return(function(o){return it.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):$4(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next((i=>{const o=a-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-i.size):Pe.resolve(Mo());let u=f0,f=i;return o.next((h=>Pe.forEach(h,((p,x)=>(u<x.largestBatchId&&(u=x.largestBatchId),i.get(p)?Pe.resolve():this.remoteDocumentCache.getEntry(e,p).next((y=>{f=f.insert(p,y)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,f,h,Ot()))).next((p=>({batchId:u,changes:Z4(p)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new it(r)).next((n=>{let a=Hf();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const i=r.collectionGroup;let o=Hf();return this.indexManager.getCollectionParents(e,i).next((u=>Pe.forEach(u,(f=>{const h=(function(x,y){return new Fu(y,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(r,f.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,n,a).next((p=>{p.forEach(((x,y)=>{o=o.insert(x,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,r,n,a){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,a)))).next((o=>{i.forEach(((f,h)=>{const p=h.getKey();o.get(p)===null&&(o=o.insert(p,Pn.newInvalidDocument(p)))}));let u=Hf();return o.forEach(((f,h)=>{const p=i.get(f);p!==void 0&&Zf(p.mutation,h,Ca.empty(),vr.now()),ip(r,h)&&(u=u.insert(f,h))})),u}))}}class X8{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Pe.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(a){return{id:a.id,version:a.version,createTime:qs(a.createTime)}})(r)),Pe.resolve()}getNamedQuery(e,r){return Pe.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(a){return{name:a.name,query:P8(a.bundledQuery),readTime:qs(a.readTime)}})(r)),Pe.resolve()}}class Y8{constructor(){this.overlays=new Nr(it.comparator),this.qr=new Map}getOverlay(e,r){return Pe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Mo();return Pe.forEach(r,(a=>this.getOverlay(e,a).next((i=>{i!==null&&n.set(a,i)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((a,i)=>{this.St(e,r,i)})),Pe.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.qr.get(n);return a!==void 0&&(a.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(n)),Pe.resolve()}getOverlaysForCollection(e,r,n){const a=Mo(),i=r.length+1,o=new it(r.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const f=u.getNext().value,h=f.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===i&&f.largestBatchId>n&&a.set(f.getKey(),f)}return Pe.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let i=new Nr(((h,p)=>h-p));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let p=i.get(h.largestBatchId);p===null&&(p=Mo(),i=i.insert(h.largestBatchId,p)),p.set(h.getKey(),h)}}const u=Mo(),f=i.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((h,p)=>u.set(h,p))),!(u.size()>=a)););return Pe.resolve(u)}St(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const o=this.qr.get(a.largestBatchId).delete(n.key);this.qr.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new h8(r,n));let i=this.qr.get(r);i===void 0&&(i=Ot(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}class $8{constructor(){this.sessionToken=An.EMPTY_BYTE_STRING}getSessionToken(e){return Pe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Pe.resolve()}}class Ov{constructor(){this.Qr=new an(hn.$r),this.Ur=new an(hn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new hn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new hn(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new it(new dr([])),n=new hn(r,e),a=new hn(r,e+1),i=[];return this.Ur.forEachInRange([n,a],(o=>{this.Gr(o),i.push(o.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new it(new dr([])),n=new hn(r,e),a=new hn(r,e+1);let i=Ot();return this.Ur.forEachInRange([n,a],(o=>{i=i.add(o.key)})),i}containsKey(e){const r=new hn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class hn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return it.comparator(e.key,r.key)||Dt(e.Yr,r.Yr)}static Kr(e,r){return Dt(e.Yr,r.Yr)||it.comparator(e.key,r.key)}}class K8{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new an(hn.$r)}checkEmpty(e){return Pe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new f8(i,r,n,a);this.mutationQueue.push(o);for(const u of a)this.Zr=this.Zr.add(new hn(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Pe.resolve(o)}lookupMutationBatch(e,r){return Pe.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.ei(n),i=a<0?0:a;return Pe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Pe.resolve(this.mutationQueue.length===0?Tv:this.tr-1)}getAllMutationBatches(e){return Pe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new hn(r,0),a=new hn(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,a],(o=>{const u=this.Xr(o.Yr);i.push(u)})),Pe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new an(Dt);return r.forEach((a=>{const i=new hn(a,0),o=new hn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],(u=>{n=n.add(u.Yr)}))})),Pe.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let i=n;it.isDocumentKey(i)||(i=i.child(""));const o=new hn(new it(i),0);let u=new an(Dt);return this.Zr.forEachWhile((f=>{const h=f.key.path;return!!n.isPrefixOf(h)&&(h.length===a&&(u=u.add(f.Yr)),!0)}),o),Pe.resolve(this.ti(u))}ti(e){const r=[];return e.forEach((n=>{const a=this.Xr(n);a!==null&&r.push(a)})),r}removeMutationBatch(e,r){Xt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Pe.forEach(r.mutations,(a=>{const i=new hn(a.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new hn(r,0),a=this.Zr.firstAfterOrEqual(n);return Pe.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Pe.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}class Q8{constructor(e){this.ri=e,this.docs=(function(){return new Nr(it.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),i=a?a.size:0,o=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Pe.resolve(n?n.document.mutableCopy():Pn.newInvalidDocument(r))}getEntries(e,r){let n=Pi();return r.forEach((a=>{const i=this.docs.get(a);n=n.insert(a,i?i.document.mutableCopy():Pn.newInvalidDocument(a))})),Pe.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let i=Pi();const o=r.path,u=new it(o.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:h,value:{document:p}}=f.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||AD(SD(p),n)<=0||(a.has(p.key)||ip(r,p))&&(i=i.insert(p.key,p.mutableCopy()))}return Pe.resolve(i)}getAllFromCollectionGroup(e,r,n,a){ut(9500)}ii(e,r){return Pe.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new J8(this)}getSize(e){return Pe.resolve(this.size)}}class J8 extends q8{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?r.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(n)})),Pe.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}class Z8{constructor(e){this.persistence=e,this.si=new sc((r=>kv(r)),Nv),this.lastRemoteSnapshotVersion=gt.min(),this.highestTargetId=0,this.oi=0,this._i=new Ov,this.targetCount=0,this.ai=wu.ur()}forEachTarget(e,r){return this.si.forEach(((n,a)=>r(a))),Pe.resolve()}getLastRemoteSnapshotVersion(e){return Pe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Pe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Pe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Pe.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new wu(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Pe.resolve()}updateTargetData(e,r){return this.Pr(r),Pe.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Pe.resolve()}removeTargets(e,r,n){let a=0;const i=[];return this.si.forEach(((o,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)})),Pe.waitFor(i).next((()=>a))}getTargetCount(e){return Pe.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Pe.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Pe.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const a=this.persistence.referenceDelegate,i=[];return a&&r.forEach((o=>{i.push(a.markPotentiallyOrphaned(e,o))})),Pe.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Pe.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Pe.resolve(n)}containsKey(e,r){return Pe.resolve(this._i.containsKey(r))}}class yA{constructor(e,r){this.ui={},this.overlays={},this.ci=new tp(0),this.li=!1,this.li=!0,this.hi=new $8,this.referenceDelegate=e(this),this.Pi=new Z8(this),this.indexManager=new M8,this.remoteDocumentCache=(function(a){return new Q8(a)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new j8(r),this.Ii=new X8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new Y8,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new K8(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Qe("MemoryPersistence","Starting transaction:",e);const a=new eO(this.ci.next());return this.referenceDelegate.Ei(),n(a).next((i=>this.referenceDelegate.di(a).next((()=>i)))).toPromise().then((i=>(a.raiseOnCommittedEvent(),i)))}Ai(e,r){return Pe.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class eO extends ND{constructor(e){super(),this.currentSequenceNumber=e}}class Fv{constructor(e){this.persistence=e,this.Ri=new Ov,this.Vi=null}static mi(e){return new Fv(e)}get fi(){if(this.Vi)return this.Vi;throw ut(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Pe.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Pe.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Pe.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((a=>this.fi.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((a=>{a.forEach((i=>this.fi.add(i.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Pe.forEach(this.fi,(n=>{const a=it.fromPath(n);return this.gi(e,a).next((i=>{i||r.removeEntry(a,gt.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return Pe.or([()=>Pe.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class bm{constructor(e,r){this.persistence=e,this.pi=new sc((n=>ID(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=H8(this,r)}static mi(e,r){return new bm(e,r)}Ei(){}di(e){return Pe.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((a=>n+a))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return Pe.forEach(this.pi,((n,a)=>this.br(e,n,a).next((i=>i?Pe.resolve():r(a)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),i=a.newChangeBuffer();return a.ii(e,(o=>this.br(e,o,r).next((u=>{u||(n++,i.removeEntry(o,gt.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Pe.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Pe.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Pe.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Pe.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=rm(e.data.value)),r}br(e,r,n){return Pe.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.pi.get(r);return Pe.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class jv{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=a}static As(e,r){let n=Ot(),a=Ot();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:a=a.add(i.doc.key)}return new jv(e,r.fromCache,n,a)}}class tO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class rO{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return $5()?8:CD(Vn())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,a){const i={result:null};return this.ys(e,r).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ws(e,r,a,n).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new tO;return this.Ss(e,r,o).next((u=>{if(i.result=u,this.Vs)return this.bs(e,r,o,u.size)}))})).next((()=>i.result))}bs(e,r,n,a){return n.documentReadCount<this.fs?(tu()<=It.DEBUG&&Qe("QueryEngine","SDK will not create cache indexes for query:",ru(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Pe.resolve()):(tu()<=It.DEBUG&&Qe("QueryEngine","Query:",ru(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.gs*a?(tu()<=It.DEBUG&&Qe("QueryEngine","The SDK decides to create cache indexes for query:",ru(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hs(r))):Pe.resolve())}ys(e,r){if(kE(r))return Pe.resolve(null);let n=Hs(r);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(r.limit!==null&&a===1&&(r=Dx(r,null,"F"),n=Hs(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const o=Ot(...i);return this.ps.getDocuments(e,o).next((u=>this.indexManager.getMinOffset(e,n).next((f=>{const h=this.Ds(r,u);return this.Cs(r,h,o,f.readTime)?this.ys(e,Dx(r,null,"F")):this.vs(e,h,r,f)}))))})))))}ws(e,r,n,a){return kE(r)||a.isEqual(gt.min())?Pe.resolve(null):this.ps.getDocuments(e,n).next((i=>{const o=this.Ds(r,i);return this.Cs(r,o,n,a)?Pe.resolve(null):(tu()<=It.DEBUG&&Qe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),ru(r)),this.vs(e,o,r,TD(a,f0)).next((u=>u)))}))}Ds(e,r){let n=new an(Q4(e));return r.forEach(((a,i)=>{ip(e,i)&&(n=n.add(i))})),n}Cs(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(a)>0)}Ss(e,r,n){return tu()<=It.DEBUG&&Qe("QueryEngine","Using full collection scan to execute query:",ru(r)),this.ps.getDocumentsMatchingQuery(e,r,Ul.min(),n)}vs(e,r,n,a){return this.ps.getDocumentsMatchingQuery(e,n,a).next((i=>(r.forEach((o=>{i=i.insert(o.key,o)})),i)))}}const Pv="LocalStore",nO=3e8;class aO{constructor(e,r,n,a){this.persistence=e,this.Fs=r,this.serializer=a,this.Ms=new Nr(Dt),this.xs=new sc((i=>kv(i)),Nv),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new W8(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function sO(t,e,r,n){return new aO(t,e,r,n)}async function _A(t,e){const r=vt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next((i=>(a=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((i=>{const o=[],u=[];let f=Ot();for(const h of a){o.push(h.batchId);for(const p of h.mutations)f=f.add(p.key)}for(const h of i){u.push(h.batchId);for(const p of h.mutations)f=f.add(p.key)}return r.localDocuments.getDocuments(n,f).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:u})))}))}))}function iO(t,e){const r=vt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,f,h,p){const x=h.batch,y=x.keys();let b=Pe.resolve();return y.forEach((w=>{b=b.next((()=>p.getEntry(f,w))).next((T=>{const E=h.docVersions.get(w);Xt(E!==null,48541),T.version.compareTo(E)<0&&(x.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),p.addEntry(T)))}))})),b.next((()=>u.mutationQueue.removeMutationBatch(f,x)))})(r,n,e,i).next((()=>i.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let f=Ot();for(let h=0;h<u.mutationResults.length;++h)u.mutationResults[h].transformResults.length>0&&(f=f.add(u.batch.mutations[h].key));return f})(e)))).next((()=>r.localDocuments.getDocuments(n,a)))}))}function bA(t){const e=vt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function lO(t,e){const r=vt(t),n=e.snapshotVersion;let a=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=r.Ns.newChangeBuffer({trackRemovals:!0});a=r.Ms;const u=[];e.targetChanges.forEach(((p,x)=>{const y=a.get(x);if(!y)return;u.push(r.Pi.removeMatchingKeys(i,p.removedDocuments,x).next((()=>r.Pi.addMatchingKeys(i,p.addedDocuments,x))));let b=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(x)!==null?b=b.withResumeToken(An.EMPTY_BYTE_STRING,gt.min()).withLastLimboFreeSnapshotVersion(gt.min()):p.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(p.resumeToken,n)),a=a.insert(x,b),(function(T,E,k){return T.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=nO?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0})(y,b,p)&&u.push(r.Pi.updateTargetData(i,b))}));let f=Pi(),h=Ot();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(i,p))})),u.push(oO(i,o,e.documentUpdates).next((p=>{f=p.ks,h=p.qs}))),!n.isEqual(gt.min())){const p=r.Pi.getLastRemoteSnapshotVersion(i).next((x=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n)));u.push(p)}return Pe.waitFor(u).next((()=>o.apply(i))).next((()=>r.localDocuments.getLocalViewOfDocuments(i,f,h))).next((()=>f))})).then((i=>(r.Ms=a,i)))}function oO(t,e,r){let n=Ot(),a=Ot();return r.forEach((i=>n=n.add(i))),e.getEntries(t,n).next((i=>{let o=Pi();return r.forEach(((u,f)=>{const h=i.get(u);f.isFoundDocument()!==h.isFoundDocument()&&(a=a.add(u)),f.isNoDocument()&&f.version.isEqual(gt.min())?(e.removeEntry(u,f.readTime),o=o.insert(u,f)):!h.isValidDocument()||f.version.compareTo(h.version)>0||f.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(f),o=o.insert(u,f)):Qe(Pv,"Ignoring outdated watch update for ",u,". Current version:",h.version," Watch version:",f.version)})),{ks:o,qs:a}}))}function cO(t,e){const r=vt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=Tv),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function uO(t,e){const r=vt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return r.Pi.getTargetData(n,e).next((i=>i?(a=i,Pe.resolve(a)):r.Pi.allocateTargetId(n).next((o=>(a=new Rl(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=r.Ms.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function Mx(t,e,r){const n=vt(t),a=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,(o=>n.persistence.referenceDelegate.removeTarget(o,a)))}catch(o){if(!Ou(o))throw o;Qe(Pv,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(a.target)}function VE(t,e,r){const n=vt(t);let a=gt.min(),i=Ot();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(f,h,p){const x=vt(f),y=x.xs.get(p);return y!==void 0?Pe.resolve(x.Ms.get(y)):x.Pi.getTargetData(h,p)})(n,o,Hs(e)).next((u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,u.targetId).next((f=>{i=f}))})).next((()=>n.Fs.getDocumentsMatchingQuery(o,e,r?a:gt.min(),r?i:Ot()))).next((u=>(fO(n,KD(e),u),{documents:u,Qs:i})))))}function fO(t,e,r){let n=t.Os.get(e)||gt.min();r.forEach(((a,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)})),t.Os.set(e,n)}class UE{constructor(){this.activeTargetIds=r8()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class hO{constructor(){this.Mo=new UE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new UE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class dO{Oo(e){}shutdown(){}}const zE="ConnectivityMonitor";class HE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Qe(zE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Qe(zE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Fd=null;function Lx(){return Fd===null?Fd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Fd++,"0x"+Fd.toString(16)}const W1="RestConnection",mO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class pO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${a}`,this.Wo=this.databaseId.database===pm?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Go(e,r,n,a,i){const o=Lx(),u=this.zo(e,r.toUriEncodedString());Qe(W1,`Sending RPC '${e}' ${o}:`,u,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,i);const{host:h}=new URL(u),p=Cu(h);return this.Jo(e,u,f,n,p).then((x=>(Qe(W1,`Received RPC '${e}' ${o}: `,x),x)),(x=>{throw vu(W1,`RPC '${e}' ${o} failed with error: `,x,"url: ",u,"request:",n),x}))}Ho(e,r,n,a,i,o){return this.Go(e,r,n,a,i)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Iu})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((a,i)=>e[i]=a)),n&&n.headers.forEach(((a,i)=>e[i]=a))}zo(e,r){const n=mO[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}class gO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const In="WebChannelConnection";class xO extends pO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,a,i){const o=Lx();return new Promise(((u,f)=>{const h=new T4;h.setWithCredentials(!0),h.listenOnce(S4.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case tm.NO_ERROR:const x=h.getResponseJson();Qe(In,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(x)),u(x);break;case tm.TIMEOUT:Qe(In,`RPC '${e}' ${o} timed out`),f(new $e(Ie.DEADLINE_EXCEEDED,"Request time out"));break;case tm.HTTP_ERROR:const y=h.getStatus();if(Qe(In,`RPC '${e}' ${o} failed with status:`,y,"response text:",h.getResponseText()),y>0){let b=h.getResponseJson();Array.isArray(b)&&(b=b[0]);const w=b?.error;if(w&&w.status&&w.message){const T=(function(k){const I=k.toLowerCase().replace(/_/g,"-");return Object.values(Ie).indexOf(I)>=0?I:Ie.UNKNOWN})(w.status);f(new $e(T,w.message))}else f(new $e(Ie.UNKNOWN,"Server responded with status "+h.getStatus()))}else f(new $e(Ie.UNAVAILABLE,"Connection failed."));break;default:ut(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Qe(In,`RPC '${e}' ${o} completed.`)}}));const p=JSON.stringify(a);Qe(In,`RPC '${e}' ${o} sending request:`,a),h.send(r,"POST",p,n,15)}))}T_(e,r,n){const a=Lx(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=N4(),u=k4(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(f.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,r,n),f.encodeInitMessageHeaders=!0;const p=i.join("");Qe(In,`Creating RPC '${e}' stream ${a}: ${p}`,f);const x=o.createWebChannel(p,f);this.I_(x);let y=!1,b=!1;const w=new gO({Yo:E=>{b?Qe(In,`Not sending because RPC '${e}' stream ${a} is closed:`,E):(y||(Qe(In,`Opening RPC '${e}' stream ${a} transport.`),x.open(),y=!0),Qe(In,`RPC '${e}' stream ${a} sending:`,E),x.send(E))},Zo:()=>x.close()}),T=(E,k,I)=>{E.listen(k,(N=>{try{I(N)}catch(z){setTimeout((()=>{throw z}),0)}}))};return T(x,zf.EventType.OPEN,(()=>{b||(Qe(In,`RPC '${e}' stream ${a} transport opened.`),w.o_())})),T(x,zf.EventType.CLOSE,(()=>{b||(b=!0,Qe(In,`RPC '${e}' stream ${a} transport closed`),w.a_(),this.E_(x))})),T(x,zf.EventType.ERROR,(E=>{b||(b=!0,vu(In,`RPC '${e}' stream ${a} transport errored. Name:`,E.name,"Message:",E.message),w.a_(new $e(Ie.UNAVAILABLE,"The operation could not be completed")))})),T(x,zf.EventType.MESSAGE,(E=>{if(!b){const k=E.data[0];Xt(!!k,16349);const I=k,N=I?.error||I[0]?.error;if(N){Qe(In,`RPC '${e}' stream ${a} received error:`,N);const z=N.status;let H=(function(F){const R=$r[F];if(R!==void 0)return oA(R)})(z),q=N.message;H===void 0&&(H=Ie.INTERNAL,q="Unknown error status: "+z+" with message "+N.message),b=!0,w.a_(new $e(H,q)),x.close()}else Qe(In,`RPC '${e}' stream ${a} received:`,k),w.u_(k)}})),T(u,A4.STAT_EVENT,(E=>{E.stat===Sx.PROXY?Qe(In,`RPC '${e}' stream ${a} detected buffering proxy`):E.stat===Sx.NOPROXY&&Qe(In,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function X1(){return typeof document<"u"?document:null}function fp(t){return new b8(t,!0)}class wA{constructor(e,r,n=1e3,a=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=a,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,r-n);a>0&&Qe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const qE="PersistentStream";class EA{constructor(e,r,n,a,i,o,u,f){this.Mi=e,this.S_=n,this.b_=a,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new wA(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Ie.RESOURCE_EXHAUSTED?(ji(r.toString()),ji("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===r&&this.G_(n,a)}),(n=>{e((()=>{const a=new $e(Ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Qe(qE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(Qe(qE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class vO extends EA{constructor(e,r,n,a,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,o),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=T8(this.serializer,e),n=(function(i){if(!("targetChange"in i))return gt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?gt.min():o.readTime?qs(o.readTime):gt.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=Px(this.serializer),r.addTarget=(function(i,o){let u;const f=o.target;if(u=Rx(f)?{documents:k8(i,f)}:{query:N8(i,f).ft},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=fA(i,o.resumeToken);const h=Ox(i,o.expectedCount);h!==null&&(u.expectedCount=h)}else if(o.snapshotVersion.compareTo(gt.min())>0){u.readTime=_m(i,o.snapshotVersion.toTimestamp());const h=Ox(i,o.expectedCount);h!==null&&(u.expectedCount=h)}return u})(this.serializer,e);const n=R8(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=Px(this.serializer),r.removeTarget=e,this.q_(r)}}class yO extends EA{constructor(e,r,n,a,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Xt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Xt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Xt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=A8(e.writeResults,e.commitTime),n=qs(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=Px(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>S8(this.serializer,n)))};this.q_(r)}}class _O{}class bO extends _O{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new $e(Ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Go(e,Fx(r,n),a,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new $e(Ie.UNKNOWN,i.toString())}))}Ho(e,r,n,a,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.Ho(e,Fx(r,n),a,o,u,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $e(Ie.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class wO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ji(r),this.aa=!1):Qe("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ko="RemoteStore";class EO{constructor(e,r,n,a,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((o=>{n.enqueueAndForget((async()=>{ic(this)&&(Qe(Ko,"Restarting streams for network reachability change."),await(async function(f){const h=vt(f);h.Ea.add(4),await V0(h),h.Ra.set("Unknown"),h.Ea.delete(4),await hp(h)})(this))}))})),this.Ra=new wO(n,a)}}async function hp(t){if(ic(t))for(const e of t.da)await e(!0)}async function V0(t){for(const e of t.da)await e(!1)}function TA(t,e){const r=vt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Vv(r)?Bv(r):ju(r).O_()&&Lv(r,e))}function Mv(t,e){const r=vt(t),n=ju(r);r.Ia.delete(e),n.O_()&&SA(r,e),r.Ia.size===0&&(n.O_()?n.L_():ic(r)&&r.Ra.set("Unknown"))}function Lv(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(gt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}ju(t).Y_(e)}function SA(t,e){t.Va.Ue(e),ju(t).Z_(e)}function Bv(t){t.Va=new x8({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ju(t).start(),t.Ra.ua()}function Vv(t){return ic(t)&&!ju(t).x_()&&t.Ia.size>0}function ic(t){return vt(t).Ea.size===0}function AA(t){t.Va=void 0}async function TO(t){t.Ra.set("Online")}async function SO(t){t.Ia.forEach(((e,r)=>{Lv(t,e)}))}async function AO(t,e){AA(t),Vv(t)?(t.Ra.ha(e),Bv(t)):t.Ra.set("Unknown")}async function kO(t,e,r){if(t.Ra.set("Online"),e instanceof uA&&e.state===2&&e.cause)try{await(async function(a,i){const o=i.cause;for(const u of i.targetIds)a.Ia.has(u)&&(await a.remoteSyncer.rejectListen(u,o),a.Ia.delete(u),a.Va.removeTarget(u))})(t,e)}catch(n){Qe(Ko,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await wm(t,n)}else if(e instanceof sm?t.Va.Ze(e):e instanceof cA?t.Va.st(e):t.Va.tt(e),!r.isEqual(gt.min()))try{const n=await bA(t.localStore);r.compareTo(n)>=0&&await(function(i,o){const u=i.Va.Tt(o);return u.targetChanges.forEach(((f,h)=>{if(f.resumeToken.approximateByteSize()>0){const p=i.Ia.get(h);p&&i.Ia.set(h,p.withResumeToken(f.resumeToken,o))}})),u.targetMismatches.forEach(((f,h)=>{const p=i.Ia.get(f);if(!p)return;i.Ia.set(f,p.withResumeToken(An.EMPTY_BYTE_STRING,p.snapshotVersion)),SA(i,f);const x=new Rl(p.target,f,h,p.sequenceNumber);Lv(i,x)})),i.remoteSyncer.applyRemoteEvent(u)})(t,r)}catch(n){Qe(Ko,"Failed to raise snapshot:",n),await wm(t,n)}}async function wm(t,e,r){if(!Ou(e))throw e;t.Ea.add(1),await V0(t),t.Ra.set("Offline"),r||(r=()=>bA(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Qe(Ko,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await hp(t)}))}function kA(t,e){return e().catch((r=>wm(t,r,e)))}async function dp(t){const e=vt(t),r=Gl(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Tv;for(;NO(e);)try{const a=await cO(e.localStore,n);if(a===null){e.Ta.length===0&&r.L_();break}n=a.batchId,CO(e,a)}catch(a){await wm(e,a)}NA(e)&&CA(e)}function NO(t){return ic(t)&&t.Ta.length<10}function CO(t,e){t.Ta.push(e);const r=Gl(t);r.O_()&&r.X_&&r.ea(e.mutations)}function NA(t){return ic(t)&&!Gl(t).x_()&&t.Ta.length>0}function CA(t){Gl(t).start()}async function RO(t){Gl(t).ra()}async function IO(t){const e=Gl(t);for(const r of t.Ta)e.ea(r.mutations)}async function DO(t,e,r){const n=t.Ta.shift(),a=Rv.from(n,e,r);await kA(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await dp(t)}async function OO(t,e){e&&Gl(t).X_&&await(async function(n,a){if((function(o){return m8(o)&&o!==Ie.ABORTED})(a.code)){const i=n.Ta.shift();Gl(n).B_(),await kA(n,(()=>n.remoteSyncer.rejectFailedWrite(i.batchId,a))),await dp(n)}})(t,e),NA(t)&&CA(t)}async function GE(t,e){const r=vt(t);r.asyncQueue.verifyOperationInProgress(),Qe(Ko,"RemoteStore received new credentials");const n=ic(r);r.Ea.add(3),await V0(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await hp(r)}async function FO(t,e){const r=vt(t);e?(r.Ea.delete(2),await hp(r)):e||(r.Ea.add(2),await V0(r),r.Ra.set("Unknown"))}function ju(t){return t.ma||(t.ma=(function(r,n,a){const i=vt(r);return i.sa(),new vO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(t.datastore,t.asyncQueue,{Xo:TO.bind(null,t),t_:SO.bind(null,t),r_:AO.bind(null,t),H_:kO.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Vv(t)?Bv(t):t.Ra.set("Unknown")):(await t.ma.stop(),AA(t))}))),t.ma}function Gl(t){return t.fa||(t.fa=(function(r,n,a){const i=vt(r);return i.sa(),new yO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:RO.bind(null,t),r_:OO.bind(null,t),ta:IO.bind(null,t),na:DO.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await dp(t)):(await t.fa.stop(),t.Ta.length>0&&(Qe(Ko,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class Uv{constructor(e,r,n,a,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=i,this.deferred=new Ci,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,i){const o=Date.now()+n,u=new Uv(e,r,o,a,i);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $e(Ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zv(t,e){if(ji("AsyncQueue",`${e}: ${t}`),Ou(t))return new $e(Ie.UNAVAILABLE,`${e}: ${t}`);throw t}class ou{static emptySet(e){return new ou(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||it.comparator(r.key,n.key):(r,n)=>it.comparator(r.key,n.key),this.keyedMap=Hf(),this.sortedSet=new Nr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ou)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,i=n.getNext().key;if(!a.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ou;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}class WE{constructor(){this.ga=new Nr(it.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ut(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class Eu{constructor(e,r,n,a,i,o,u,f,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,a,i){const o=[];return r.forEach((u=>{o.push({type:0,doc:u})})),new Eu(e,r,ou.emptySet(r),o,n,a,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}class jO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class PO{constructor(){this.queries=XE(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const a=vt(r),i=a.queries;a.queries=XE(),i.forEach(((o,u)=>{for(const f of u.Sa)f.onError(n)}))})(this,new $e(Ie.ABORTED,"Firestore shutting down"))}}function XE(){return new sc((t=>K4(t)),sp)}async function Hv(t,e){const r=vt(t);let n=3;const a=e.query;let i=r.queries.get(a);i?!i.ba()&&e.Da()&&(n=2):(i=new jO,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(a,!0);break;case 1:i.wa=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(o){const u=zv(o,`Initialization of query '${ru(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&Gv(r)}async function qv(t,e){const r=vt(t),n=e.query;let a=3;const i=r.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?a=e.Da()?0:1:!i.ba()&&e.Da()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function MO(t,e){const r=vt(t);let n=!1;for(const a of e){const i=a.query,o=r.queries.get(i);if(o){for(const u of o.Sa)u.Fa(a)&&(n=!0);o.wa=a}}n&&Gv(r)}function LO(t,e,r){const n=vt(t),a=n.queries.get(e);if(a)for(const i of a.Sa)i.onError(r);n.queries.delete(e)}function Gv(t){t.Ca.forEach((e=>{e.next()}))}var Bx,YE;(YE=Bx||(Bx={})).Ma="default",YE.Cache="cache";class Wv{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new Eu(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=Eu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Bx.Cache}}class RA{constructor(e){this.key=e}}class IA{constructor(e){this.key=e}}class BO{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Ot(),this.mutatedKeys=Ot(),this.eu=Q4(e),this.tu=new ou(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new WE,a=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,o=a,u=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,h=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((p,x)=>{const y=a.get(p),b=ip(this.query,x)?x:null,w=!!y&&this.mutatedKeys.has(y.key),T=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let E=!1;y&&b?y.data.isEqual(b.data)?w!==T&&(n.track({type:3,doc:b}),E=!0):this.su(y,b)||(n.track({type:2,doc:b}),E=!0,(f&&this.eu(b,f)>0||h&&this.eu(b,h)<0)&&(u=!0)):!y&&b?(n.track({type:0,doc:b}),E=!0):y&&!b&&(n.track({type:1,doc:y}),E=!0,(f||h)&&(u=!0)),E&&(b?(o=o.add(b),i=T?i.add(p):i.delete(p)):(o=o.delete(p),i=i.delete(p)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),i=i.delete(p.key),n.track({type:1,doc:p})}return{tu:o,iu:n,Cs:u,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((p,x)=>(function(b,w){const T=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ut(20277,{Rt:E})}};return T(b)-T(w)})(p.type,x.type)||this.eu(p.doc,x.doc))),this.ou(n),a=a??!1;const u=r&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,h=f!==this.Za;return this.Za=f,o.length!==0||h?{snapshot:new Eu(this.query,e.tu,i,o,e.mutatedKeys,f===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new WE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Ot(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new IA(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new RA(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=Ot();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return Eu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Xv="SyncEngine";class VO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class UO{constructor(e){this.key=e,this.hu=!1}}class zO{constructor(e,r,n,a,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new sc((u=>K4(u)),sp),this.Iu=new Map,this.Eu=new Set,this.du=new Nr(it.comparator),this.Au=new Map,this.Ru=new Ov,this.Vu={},this.mu=new Map,this.fu=wu.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function HO(t,e,r=!0){const n=MA(t);let a;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.lu()):a=await DA(n,e,r,!0),a}async function qO(t,e){const r=MA(t);await DA(r,e,!0,!1)}async function DA(t,e,r,n){const a=await uO(t.localStore,Hs(e)),i=a.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let u;return n&&(u=await GO(t,e,i,o==="current",a.resumeToken)),t.isPrimaryClient&&r&&TA(t.remoteStore,a),u}async function GO(t,e,r,n,a){t.pu=(x,y,b)=>(async function(T,E,k,I){let N=E.view.ru(k);N.Cs&&(N=await VE(T.localStore,E.query,!1).then((({documents:A})=>E.view.ru(A,N))));const z=I&&I.targetChanges.get(E.targetId),H=I&&I.targetMismatches.get(E.targetId)!=null,q=E.view.applyChanges(N,T.isPrimaryClient,z,H);return KE(T,E.targetId,q.au),q.snapshot})(t,x,y,b);const i=await VE(t.localStore,e,!0),o=new BO(e,i.Qs),u=o.ru(i.documents),f=B0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),h=o.applyChanges(u,t.isPrimaryClient,f);KE(t,r,h.au);const p=new VO(e,r,o);return t.Tu.set(e,p),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),h.snapshot}async function WO(t,e,r){const n=vt(t),a=n.Tu.get(e),i=n.Iu.get(a.targetId);if(i.length>1)return n.Iu.set(a.targetId,i.filter((o=>!sp(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Mx(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),r&&Mv(n.remoteStore,a.targetId),Vx(n,a.targetId)})).catch(Du)):(Vx(n,a.targetId),await Mx(n.localStore,a.targetId,!0))}async function XO(t,e){const r=vt(t),n=r.Tu.get(e),a=r.Iu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Mv(r.remoteStore,n.targetId))}async function YO(t,e,r){const n=t9(t);try{const a=await(function(o,u){const f=vt(o),h=vr.now(),p=u.reduce(((b,w)=>b.add(w.key)),Ot());let x,y;return f.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let w=Pi(),T=Ot();return f.Ns.getEntries(b,p).next((E=>{w=E,w.forEach(((k,I)=>{I.isValidDocument()||(T=T.add(k))}))})).next((()=>f.localDocuments.getOverlayedDocuments(b,w))).next((E=>{x=E;const k=[];for(const I of u){const N=c8(I,x.get(I.key).overlayedDocument);N!=null&&k.push(new ro(I.key,N,z4(N.value.mapValue),Kn.exists(!0)))}return f.mutationQueue.addMutationBatch(b,h,k,u)})).next((E=>{y=E;const k=E.applyToLocalDocumentSet(x,T);return f.documentOverlayCache.saveOverlays(b,E.batchId,k)}))})).then((()=>({batchId:y.batchId,changes:Z4(x)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(o,u,f){let h=o.Vu[o.currentUser.toKey()];h||(h=new Nr(Dt)),h=h.insert(u,f),o.Vu[o.currentUser.toKey()]=h})(n,a.batchId,r),await U0(n,a.changes),await dp(n.remoteStore)}catch(a){const i=zv(a,"Failed to persist write");r.reject(i)}}async function OA(t,e){const r=vt(t);try{const n=await lO(r.localStore,e);e.targetChanges.forEach(((a,i)=>{const o=r.Au.get(i);o&&(Xt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?o.hu=!0:a.modifiedDocuments.size>0?Xt(o.hu,14607):a.removedDocuments.size>0&&(Xt(o.hu,42227),o.hu=!1))})),await U0(r,n,e)}catch(n){await Du(n)}}function $E(t,e,r){const n=vt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Tu.forEach(((i,o)=>{const u=o.view.va(e);u.snapshot&&a.push(u.snapshot)})),(function(o,u){const f=vt(o);f.onlineState=u;let h=!1;f.queries.forEach(((p,x)=>{for(const y of x.Sa)y.va(u)&&(h=!0)})),h&&Gv(f)})(n.eventManager,e),a.length&&n.Pu.H_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function $O(t,e,r){const n=vt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Au.get(e),i=a&&a.key;if(i){let o=new Nr(it.comparator);o=o.insert(i,Pn.newNoDocument(i,gt.min()));const u=Ot().add(i),f=new up(gt.min(),new Map,new Nr(Dt),o,u);await OA(n,f),n.du=n.du.remove(i),n.Au.delete(e),Yv(n)}else await Mx(n.localStore,e,!1).then((()=>Vx(n,e,r))).catch(Du)}async function KO(t,e){const r=vt(t),n=e.batch.batchId;try{const a=await iO(r.localStore,e);jA(r,n,null),FA(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await U0(r,a)}catch(a){await Du(a)}}async function QO(t,e,r){const n=vt(t);try{const a=await(function(o,u){const f=vt(o);return f.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let p;return f.mutationQueue.lookupMutationBatch(h,u).next((x=>(Xt(x!==null,37113),p=x.keys(),f.mutationQueue.removeMutationBatch(h,x)))).next((()=>f.mutationQueue.performConsistencyCheck(h))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(h,p,u))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,p))).next((()=>f.localDocuments.getDocuments(h,p)))}))})(n.localStore,e);jA(n,e,r),FA(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await U0(n,a)}catch(a){await Du(a)}}function FA(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function jA(t,e,r){const n=vt(t);let a=n.Vu[n.currentUser.toKey()];if(a){const i=a.get(e);i&&(r?i.reject(r):i.resolve(),a=a.remove(e)),n.Vu[n.currentUser.toKey()]=a}}function Vx(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||PA(t,n)}))}function PA(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Mv(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Yv(t))}function KE(t,e,r){for(const n of r)n instanceof RA?(t.Ru.addReference(n.key,e),JO(t,n)):n instanceof IA?(Qe(Xv,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||PA(t,n.key)):ut(19791,{wu:n})}function JO(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Qe(Xv,"New document in limbo: "+r),t.Eu.add(n),Yv(t))}function Yv(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new it(dr.fromString(e)),n=t.fu.next();t.Au.set(n,new UO(r)),t.du=t.du.insert(r,n),TA(t.remoteStore,new Rl(Hs(ap(r.path)),n,"TargetPurposeLimboResolution",tp.ce))}}async function U0(t,e,r){const n=vt(t),a=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,f)=>{o.push(n.pu(f,e,r).then((h=>{if((h||r)&&n.isPrimaryClient){const p=h?!h.fromCache:r?.targetChanges.get(f.targetId)?.current;n.sharedClientState.updateQueryState(f.targetId,p?"current":"not-current")}if(h){a.push(h);const p=jv.As(f.targetId,h);i.push(p)}})))})),await Promise.all(o),n.Pu.H_(a),await(async function(f,h){const p=vt(f);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>Pe.forEach(h,(y=>Pe.forEach(y.Es,(b=>p.persistence.referenceDelegate.addReference(x,y.targetId,b))).next((()=>Pe.forEach(y.ds,(b=>p.persistence.referenceDelegate.removeReference(x,y.targetId,b)))))))))}catch(x){if(!Ou(x))throw x;Qe(Pv,"Failed to update sequence numbers: "+x)}for(const x of h){const y=x.targetId;if(!x.fromCache){const b=p.Ms.get(y),w=b.snapshotVersion,T=b.withLastLimboFreeSnapshotVersion(w);p.Ms=p.Ms.insert(y,T)}}})(n.localStore,i))}async function ZO(t,e){const r=vt(t);if(!r.currentUser.isEqual(e)){Qe(Xv,"User change. New user:",e.toKey());const n=await _A(r.localStore,e);r.currentUser=e,(function(i,o){i.mu.forEach((u=>{u.forEach((f=>{f.reject(new $e(Ie.CANCELLED,o))}))})),i.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await U0(r,n.Ls)}}function e9(t,e){const r=vt(t),n=r.Au.get(e);if(n&&n.hu)return Ot().add(n.key);{let a=Ot();const i=r.Iu.get(e);if(!i)return a;for(const o of i){const u=r.Tu.get(o);a=a.unionWith(u.view.nu)}return a}}function MA(t){const e=vt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=OA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=e9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$O.bind(null,e),e.Pu.H_=MO.bind(null,e.eventManager),e.Pu.yu=LO.bind(null,e.eventManager),e}function t9(t){const e=vt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=KO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=QO.bind(null,e),e}class Em{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=fp(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return sO(this.persistence,new rO,e.initialUser,this.serializer)}Cu(e){return new yA(Fv.mi,this.serializer)}Du(e){return new hO}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Em.provider={build:()=>new Em};class r9 extends Em{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Xt(this.persistence.referenceDelegate instanceof bm,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new U8(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?la.withCacheSize(this.cacheSizeBytes):la.DEFAULT;return new yA((n=>bm.mi(n,r)),this.serializer)}}class Ux{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>$E(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=ZO.bind(null,this.syncEngine),await FO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new PO})()}createDatastore(e){const r=fp(e.databaseInfo.databaseId),n=(function(i){return new xO(i)})(e.databaseInfo);return(function(i,o,u,f){return new bO(i,o,u,f)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,a,i,o,u){return new EO(n,a,i,o,u)})(this.localStore,this.datastore,e.asyncQueue,(r=>$E(this.syncEngine,r,0)),(function(){return HE.v()?new HE:new dO})())}createSyncEngine(e,r){return(function(a,i,o,u,f,h,p){const x=new zO(a,i,o,u,f,h);return p&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){const n=vt(r);Qe(Ko,"RemoteStore shutting down."),n.Ea.add(5),await V0(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Ux.provider={build:()=>new Ux};class $v{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ji("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}const Wl="FirestoreClient";class n9{constructor(e,r,n,a,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=On.UNAUTHENTICATED,this.clientId=Ev.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async o=>{Qe(Wl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(Qe(Wl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ci;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=zv(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Y1(t,e){t.asyncQueue.verifyOperationInProgress(),Qe(Wl,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async a=>{n.isEqual(a)||(await _A(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function QE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await a9(t);Qe(Wl,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>GE(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,a)=>GE(e.remoteStore,a))),t._onlineComponents=e}async function a9(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Qe(Wl,"Using user provided OfflineComponentProvider");try{await Y1(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(a){return a.name==="FirebaseError"?a.code===Ie.FAILED_PRECONDITION||a.code===Ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(r))throw r;vu("Error using user provided cache. Falling back to memory cache: "+r),await Y1(t,new Em)}}else Qe(Wl,"Using default OfflineComponentProvider"),await Y1(t,new r9(void 0));return t._offlineComponents}async function LA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Qe(Wl,"Using user provided OnlineComponentProvider"),await QE(t,t._uninitializedComponentsProvider._online)):(Qe(Wl,"Using default OnlineComponentProvider"),await QE(t,new Ux))),t._onlineComponents}function s9(t){return LA(t).then((e=>e.syncEngine))}async function Tm(t){const e=await LA(t),r=e.eventManager;return r.onListen=HO.bind(null,e.syncEngine),r.onUnlisten=WO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=qO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=XO.bind(null,e.syncEngine),r}function i9(t,e,r={}){const n=new Ci;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,u,f,h){const p=new $v({next:y=>{p.Nu(),o.enqueueAndForget((()=>qv(i,x)));const b=y.docs.has(u);!b&&y.fromCache?h.reject(new $e(Ie.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&y.fromCache&&f&&f.source==="server"?h.reject(new $e(Ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(y)},error:y=>h.reject(y)}),x=new Wv(ap(u.path),p,{includeMetadataChanges:!0,qa:!0});return Hv(i,x)})(await Tm(t),t.asyncQueue,e,r,n))),n.promise}function l9(t,e,r={}){const n=new Ci;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,u,f,h){const p=new $v({next:y=>{p.Nu(),o.enqueueAndForget((()=>qv(i,x))),y.fromCache&&f.source==="server"?h.reject(new $e(Ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(y)},error:y=>h.reject(y)}),x=new Wv(u,p,{includeMetadataChanges:!0,qa:!0});return Hv(i,x)})(await Tm(t),t.asyncQueue,e,r,n))),n.promise}function BA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const JE=new Map;const VA="firestore.googleapis.com",ZE=!0;class eT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new $e(Ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=VA,this.ssl=ZE}else this.host=e.host,this.ssl=e.ssl??ZE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=vA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<B8)throw new $e(Ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ED("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=BA(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new $e(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new $e(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new $e(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class mp{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new eT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $e(Ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $e(Ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new eT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new dD;switch(n.type){case"firstParty":return new xD(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new $e(Ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=JE.get(r);n&&(Qe("ComponentProvider","Removing Datastore"),JE.delete(r),n.terminate())})(this),Promise.resolve()}}function o9(t,e,r,n={}){t=$n(t,mp);const a=Cu(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},u=`${e}:${r}`;a&&(p4(`https://${u}`),g4("Firestore",!0)),i.host!==VA&&i.host!==u&&vu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...i,host:u,ssl:a,emulatorOptions:n};if(!Xo(f,o)&&(t._setSettings(f),n.mockUserToken)){let h,p;if(typeof n.mockUserToken=="string")h=n.mockUserToken,p=On.MOCK_USER;else{h=V5(n.mockUserToken,t._app?.options.projectId);const x=n.mockUserToken.sub||n.mockUserToken.user_id;if(!x)throw new $e(Ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new On(x)}t._authCredentials=new mD(new R4(h,p))}}class no{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new no(this.firestore,e,this._query)}}class Or{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ll(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Or(this.firestore,e,this._key)}toJSON(){return{type:Or._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(M0(r,Or._jsonSchema))return new Or(e,n||null,new it(dr.fromString(r.referencePath)))}}Or._jsonSchemaVersion="firestore/documentReference/1.0",Or._jsonSchema={type:Zr("string",Or._jsonSchemaVersion),referencePath:Zr("string")};class Ll extends no{constructor(e,r,n){super(e,r,ap(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Or(this.firestore,null,new it(e))}withConverter(e){return new Ll(this.firestore,e,this._path)}}function Wt(t,e,...r){if(t=sn(t),I4("collection","path",e),t instanceof mp){const n=dr.fromString(e,...r);return dE(n),new Ll(t,null,n)}{if(!(t instanceof Or||t instanceof Ll))throw new $e(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(dr.fromString(e,...r));return dE(n),new Ll(t.firestore,null,n)}}function Tt(t,e,...r){if(t=sn(t),arguments.length===1&&(e=Ev.newId()),I4("doc","path",e),t instanceof mp){const n=dr.fromString(e,...r);return hE(n),new Or(t,null,new it(n))}{if(!(t instanceof Or||t instanceof Ll))throw new $e(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(dr.fromString(e,...r));return hE(n),new Or(t.firestore,t instanceof Ll?t.converter:null,new it(n))}}const tT="AsyncQueue";class rT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new wA(this,"async_queue_retry"),this._c=()=>{const n=X1();n&&Qe(tT,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=X1();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=X1();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new Ci;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ou(e))throw e;Qe(tT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,ji("INTERNAL UNHANDLED ERROR: ",nT(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const a=Uv.createAndSchedule(this,e,r,n,(i=>this.hc(i)));return this.tc.push(a),a}uc(){this.nc&&ut(47125,{Pc:nT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function nT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function aT(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const i of n)if(i in a&&typeof a[i]=="function")return!0;return!1})(t,["next","error","complete"])}class Qs extends mp{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new rT,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rT(e),this._firestoreClient=void 0,await e}}}function c9(t,e){const r=typeof t=="object"?t:_4(),n=typeof t=="string"?t:pm,a=bv(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const i=L5("firestore");i&&o9(a,...i)}return a}function z0(t){if(t._terminated)throw new $e(Ie.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||u9(t),t._firestoreClient}function u9(t){const e=t._freezeSettings(),r=(function(a,i,o,u){return new FD(a,i,o,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,BA(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new n9(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(a){const i=a?._online.build();return{_offline:a?._offline.build(i),_online:i}})(t._componentsProvider))}class Qa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qa(An.fromBase64String(e))}catch(r){throw new $e(Ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Qa(An.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Qa._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(M0(e,Qa._jsonSchema))return Qa.fromBase64String(e.bytes)}}Qa._jsonSchemaVersion="firestore/bytes/1.0",Qa._jsonSchema={type:Zr("string",Qa._jsonSchemaVersion),bytes:Zr("string")};class H0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new $e(Ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Kv{constructor(e){this._methodName=e}}class Gs{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new $e(Ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new $e(Ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Dt(this._lat,e._lat)||Dt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Gs._jsonSchemaVersion}}static fromJSON(e){if(M0(e,Gs._jsonSchema))return new Gs(e.latitude,e.longitude)}}Gs._jsonSchemaVersion="firestore/geoPoint/1.0",Gs._jsonSchema={type:Zr("string",Gs._jsonSchemaVersion),latitude:Zr("number"),longitude:Zr("number")};class Ws{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==a[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ws._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(M0(e,Ws._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new Ws(e.vectorValues);throw new $e(Ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ws._jsonSchemaVersion="firestore/vectorValue/1.0",Ws._jsonSchema={type:Zr("string",Ws._jsonSchemaVersion),vectorValues:Zr("object")};const f9=/^__.*__$/;class h9{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ro(e,this.data,this.fieldMask,r,this.fieldTransforms):new L0(e,this.data,r,this.fieldTransforms)}}class UA{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new ro(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function zA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ut(40011,{Ac:t})}}class Qv{constructor(e,r,n,a,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Qv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Sm(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(zA(this.Ac)&&f9.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class d9{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||fp(e)}Cc(e,r,n,a=!1){return new Qv({Ac:e,methodName:r,Dc:n,path:Tn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function q0(t){const e=t._freezeSettings(),r=fp(t._databaseId);return new d9(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Jv(t,e,r,n,a,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,r,a);Zv("Data must be an object, but it was:",o,n);const u=GA(n,o);let f,h;if(i.merge)f=new Ca(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const p=[];for(const x of i.mergeFields){const y=zx(e,x,r);if(!o.contains(y))throw new $e(Ie.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);XA(p,y)||p.push(y)}f=new Ca(p),h=o.fieldTransforms.filter((x=>f.covers(x.field)))}else f=null,h=o.fieldTransforms;return new h9(new ca(u),f,h)}class pp extends Kv{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof pp}}function HA(t,e,r,n){const a=t.Cc(1,e,r);Zv("Data must be an object, but it was:",a,n);const i=[],o=ca.empty();to(n,((f,h)=>{const p=ey(e,f,r);h=sn(h);const x=a.yc(p);if(h instanceof pp)i.push(p);else{const y=G0(h,x);y!=null&&(i.push(p),o.set(p,y))}}));const u=new Ca(i);return new UA(o,u,a.fieldTransforms)}function qA(t,e,r,n,a,i){const o=t.Cc(1,e,r),u=[zx(e,n,r)],f=[a];if(i.length%2!=0)throw new $e(Ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)u.push(zx(e,i[y])),f.push(i[y+1]);const h=[],p=ca.empty();for(let y=u.length-1;y>=0;--y)if(!XA(h,u[y])){const b=u[y];let w=f[y];w=sn(w);const T=o.yc(b);if(w instanceof pp)h.push(b);else{const E=G0(w,T);E!=null&&(h.push(b),p.set(b,E))}}const x=new Ca(h);return new UA(p,x,o.fieldTransforms)}function m9(t,e,r,n=!1){return G0(r,t.Cc(n?4:3,e))}function G0(t,e){if(WA(t=sn(t)))return Zv("Unsupported field value:",e,t),GA(t,e);if(t instanceof Kv)return(function(n,a){if(!zA(a.Ac))throw a.Sc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(a);i&&a.fieldTransforms.push(i)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,a){const i=[];let o=0;for(const u of n){let f=G0(u,a.wc(o));f==null&&(f={nullValue:"NULL_VALUE"}),i.push(f),o++}return{arrayValue:{values:i}}})(t,e)}return(function(n,a){if((n=sn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return n8(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=vr.fromDate(n);return{timestampValue:_m(a.serializer,i)}}if(n instanceof vr){const i=new vr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:_m(a.serializer,i)}}if(n instanceof Gs)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Qa)return{bytesValue:fA(a.serializer,n._byteString)};if(n instanceof Or){const i=a.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw a.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Dv(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Ws)return(function(o,u){return{mapValue:{fields:{[V4]:{stringValue:U4},[gm]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw u.Sc("VectorValues must only contain numeric values.");return Cv(u.serializer,h)}))}}}}}})(n,a);throw a.Sc(`Unsupported field value: ${ep(n)}`)})(t,e)}function GA(t,e){const r={};return F4(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):to(t,((n,a)=>{const i=G0(a,e.mc(n));i!=null&&(r[n]=i)})),{mapValue:{fields:r}}}function WA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof vr||t instanceof Gs||t instanceof Qa||t instanceof Or||t instanceof Kv||t instanceof Ws)}function Zv(t,e,r){if(!WA(r)||!D4(r)){const n=ep(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function zx(t,e,r){if((e=sn(e))instanceof H0)return e._internalPath;if(typeof e=="string")return ey(t,e);throw Sm("Field path arguments must be of type string or ",t,!1,void 0,r)}const p9=new RegExp("[~\\*/\\[\\]]");function ey(t,e,r){if(e.search(p9)>=0)throw Sm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new H0(...e.split("."))._internalPath}catch{throw Sm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Sm(t,e,r,n,a){const i=n&&!n.isEmpty(),o=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(i||o)&&(f+=" (found",i&&(f+=` in field ${n}`),o&&(f+=` in document ${a}`),f+=")"),new $e(Ie.INVALID_ARGUMENT,u+t+f)}function XA(t,e){return t.some((r=>r.isEqual(e)))}class YA{constructor(e,r,n,a,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Or(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new g9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(gp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class g9 extends YA{data(){return super.data()}}function gp(t,e){return typeof e=="string"?ey(t,e):e instanceof H0?e._internalPath:e._delegate._internalPath}function $A(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $e(Ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ty{}class KA extends ty{}function Hx(t,e,...r){let n=[];e instanceof ty&&n.push(e),n=n.concat(r),(function(i){const o=i.filter((f=>f instanceof ry)).length,u=i.filter((f=>f instanceof xp)).length;if(o>1||o>0&&u>0)throw new $e(Ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const a of n)t=a._apply(t);return t}class xp extends KA{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new xp(e,r,n)}_apply(e){const r=this._parse(e);return JA(e._query,r),new no(e.firestore,e.converter,Ix(e._query,r))}_parse(e){const r=q0(e.firestore);return(function(i,o,u,f,h,p,x){let y;if(h.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new $e(Ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){iT(x,p);const w=[];for(const T of x)w.push(sT(f,i,T));y={arrayValue:{values:w}}}else y=sT(f,i,x)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||iT(x,p),y=m9(u,o,x,p==="in"||p==="not-in");return Jr.create(h,p,y)})(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function QA(t,e,r){const n=e,a=gp("where",t);return xp._create(a,n,r)}class ry extends ty{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new ry(e,r)}_parse(e){const r=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return r.length===1?r[0]:As.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:((function(a,i){let o=a;const u=i.getFlattenedFilters();for(const f of u)JA(o,f),o=Ix(o,f)})(e._query,r),new no(e.firestore,e.converter,Ix(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ny extends KA{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new ny(e,r)}_apply(e){const r=(function(a,i,o){if(a.startAt!==null)throw new $e(Ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new $e(Ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new p0(i,o)})(e._query,this._field,this._direction);return new no(e.firestore,e.converter,(function(a,i){const o=a.explicitOrderBy.concat([i]);return new Fu(a.path,a.collectionGroup,o,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,r))}}function x9(t,e="asc"){const r=e,n=gp("orderBy",t);return ny._create(n,r)}function sT(t,e,r){if(typeof(r=sn(r))=="string"){if(r==="")throw new $e(Ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!$4(e)&&r.indexOf("/")!==-1)throw new $e(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(dr.fromString(r));if(!it.isDocumentKey(n))throw new $e(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return bE(t,new it(n))}if(r instanceof Or)return bE(t,r._key);throw new $e(Ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ep(r)}.`)}function iT(t,e){if(!Array.isArray(t)||t.length===0)throw new $e(Ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function JA(t,e){const r=(function(a,i){for(const o of a)for(const u of o.getFlattenedFilters())if(i.indexOf(u.op)>=0)return u.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(r!==null)throw r===e.op?new $e(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $e(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class v9{convertValue(e,r="none"){switch(ql(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Vr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Hl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ut(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return to(e,((a,i)=>{n[a]=this.convertValue(i,r)})),n}convertVectorValue(e){const r=e.fields?.[gm].arrayValue?.values?.map((n=>Vr(n.doubleValue)));return new Ws(r)}convertGeoPoint(e){return new Gs(Vr(e.latitude),Vr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=np(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(h0(e));default:return null}}convertTimestamp(e){const r=zl(e);return new vr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=dr.fromString(e);Xt(xA(n),9688,{name:e});const a=new d0(n.get(1),n.get(3)),i=new it(n.popFirst(5));return a.isEqual(r)||ji(`Document ${i} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}function ay(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Gf{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bo extends YA{constructor(e,r,n,a,i,o){super(e,r,n,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new im(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(gp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new $e(Ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Bo._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Bo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Bo._jsonSchema={type:Zr("string",Bo._jsonSchemaVersion),bundleSource:Zr("string","DocumentSnapshot"),bundleName:Zr("string"),bundle:Zr("string")};class im extends Bo{data(e={}){return super.data(e)}}class Vo{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new Gf(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new im(this._firestore,this._userDataWriter,n.key,n,new Gf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new $e(Ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(a,i){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map((u=>{const f=new im(a._firestore,a._userDataWriter,u.doc.key,u.doc,new Gf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:o++}}))}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((u=>i||u.type!==3)).map((u=>{const f=new im(a._firestore,a._userDataWriter,u.doc.key,u.doc,new Gf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let h=-1,p=-1;return u.type!==0&&(h=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),p=o.indexOf(u.doc.key)),{type:y9(u.type),doc:f,oldIndex:h,newIndex:p}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new $e(Ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Vo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ev.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach((i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),a.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function y9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ut(61501,{type:t})}}function _9(t){t=$n(t,Or);const e=$n(t.firestore,Qs);return i9(z0(e),t._key).then((r=>ZA(e,t,r)))}Vo._jsonSchemaVersion="firestore/querySnapshot/1.0",Vo._jsonSchema={type:Zr("string",Vo._jsonSchemaVersion),bundleSource:Zr("string","QuerySnapshot"),bundleName:Zr("string"),bundle:Zr("string")};class sy extends v9{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qa(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Or(this.firestore,null,r)}}function Sl(t){t=$n(t,no);const e=$n(t.firestore,Qs),r=z0(e),n=new sy(e);return $A(t._query),l9(r,t._query).then((a=>new Vo(e,n,t,a)))}function Uo(t,e,r){t=$n(t,Or);const n=$n(t.firestore,Qs),a=ay(t.converter,e,r);return W0(n,[Jv(q0(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,Kn.none())])}function oa(t,e,r,...n){t=$n(t,Or);const a=$n(t.firestore,Qs),i=q0(a);let o;return o=typeof(e=sn(e))=="string"||e instanceof H0?qA(i,"updateDoc",t._key,e,r,n):HA(i,"updateDoc",t._key,e),W0(a,[o.toMutation(t._key,Kn.exists(!0))])}function Am(t){return W0($n(t.firestore,Qs),[new cp(t._key,Kn.none())])}function Ti(t,e){const r=$n(t.firestore,Qs),n=Tt(t),a=ay(t.converter,e);return W0(r,[Jv(q0(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,Kn.exists(!1))]).then((()=>n))}function Tr(t,...e){t=sn(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||aT(e[n])||(r=e[n++]);const a={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(aT(e[n])){const f=e[n];e[n]=f.next?.bind(f),e[n+1]=f.error?.bind(f),e[n+2]=f.complete?.bind(f)}let i,o,u;if(t instanceof Or)o=$n(t.firestore,Qs),u=ap(t._key.path),i={next:f=>{e[n]&&e[n](ZA(o,t,f))},error:e[n+1],complete:e[n+2]};else{const f=$n(t,no);o=$n(f.firestore,Qs),u=f._query;const h=new sy(o);i={next:p=>{e[n]&&e[n](new Vo(o,h,f,p))},error:e[n+1],complete:e[n+2]},$A(t._query)}return(function(h,p,x,y){const b=new $v(y),w=new Wv(p,b,x);return h.asyncQueue.enqueueAndForget((async()=>Hv(await Tm(h),w))),()=>{b.Nu(),h.asyncQueue.enqueueAndForget((async()=>qv(await Tm(h),w)))}})(z0(o),u,a,i)}function W0(t,e){return(function(n,a){const i=new Ci;return n.asyncQueue.enqueueAndForget((async()=>YO(await s9(n),a,i))),i.promise})(z0(t),e)}function ZA(t,e,r){const n=r.docs.get(e._key),a=new sy(t);return new Bo(t,a,e._key,n,new Gf(r.hasPendingWrites,r.fromCache),e.converter)}class b9{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=q0(e)}set(e,r,n){this._verifyNotCommitted();const a=$1(e,this._firestore),i=ay(a.converter,r,n),o=Jv(this._dataReader,"WriteBatch.set",a._key,i,a.converter!==null,n);return this._mutations.push(o.toMutation(a._key,Kn.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const i=$1(e,this._firestore);let o;return o=typeof(r=sn(r))=="string"||r instanceof H0?qA(this._dataReader,"WriteBatch.update",i._key,r,n,a):HA(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,Kn.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=$1(e,this._firestore);return this._mutations=this._mutations.concat(new cp(r._key,Kn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new $e(Ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function $1(t,e){if((t=sn(t)).firestore!==e)throw new $e(Ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function qx(t){return z0(t=$n(t,Qs)),new b9(t,(e=>W0(t,e)))}(function(e,r=!0){(function(a){Iu=a})(Ru),xu(new Yo("firestore",((n,{instanceIdentifier:a,options:i})=>{const o=n.getProvider("app").getImmediate(),u=new Qs(new pD(n.getProvider("auth-internal")),new vD(o,n.getProvider("app-check-internal")),(function(h,p){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new $e(Ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new d0(h.options.projectId,p)})(o,a),o);return i={useFetchStreams:r,...i},u._setSettings(i),u}),"PUBLIC").setMultipleInstances(!0)),Pl(oE,cE,e),Pl(oE,cE,"esm2020")})();function ek(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const w9=ek,tk=new j0("auth","Firebase",ek());const km=new yv("@firebase/auth");function E9(t,...e){km.logLevel<=It.WARN&&km.warn(`Auth (${Ru}): ${t}`,...e)}function lm(t,...e){km.logLevel<=It.ERROR&&km.error(`Auth (${Ru}): ${t}`,...e)}function Mi(t,...e){throw iy(t,...e)}function Xs(t,...e){return iy(t,...e)}function rk(t,e,r){const n={...w9(),[e]:r};return new j0("auth","Firebase",n).create(e,{appName:t.name})}function Bl(t){return rk(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function iy(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return tk.create(t,...e)}function pt(t,e,...r){if(!t)throw iy(e,...r)}function Si(t){const e="INTERNAL ASSERTION FAILED: "+t;throw lm(e),new Error(e)}function Li(t,e){t||Si(e)}function Gx(){return typeof self<"u"&&self.location?.href||""}function T9(){return lT()==="http:"||lT()==="https:"}function lT(){return typeof self<"u"&&self.location?.protocol||null}function S9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(T9()||W5()||"connection"in navigator)?navigator.onLine:!0}function A9(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class X0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Li(r>e,"Short delay should be less than long delay!"),this.isMobile=H5()||X5()}get(){return S9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function ly(t,e){Li(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class nk{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Si("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Si("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Si("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const k9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const N9=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],C9=new X0(3e4,6e4);function vp(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Pu(t,e,r,n,a={}){return ak(t,a,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const u=P0({key:t.config.apiKey,...o}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:f,...i};return G5()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&Cu(t.emulatorConfig.host)&&(h.credentials="include"),nk.fetch()(await ik(t,t.config.apiHost,r,u),h)})}async function ak(t,e,r){t._canInitEmulator=!1;const n={...k9,...e};try{const a=new R9(t),i=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw jd(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const u=i.ok?o.errorMessage:o.error.message,[f,h]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw jd(t,"credential-already-in-use",o);if(f==="EMAIL_EXISTS")throw jd(t,"email-already-in-use",o);if(f==="USER_DISABLED")throw jd(t,"user-disabled",o);const p=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw rk(t,p,h);Mi(t,p)}}catch(a){if(a instanceof Vi)throw a;Mi(t,"network-request-failed",{message:String(a)})}}async function sk(t,e,r,n,a={}){const i=await Pu(t,e,r,n,a);return"mfaPendingCredential"in i&&Mi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function ik(t,e,r,n){const a=`${e}${r}?${n}`,i=t,o=i.config.emulator?ly(t.config,a):`${t.config.apiScheme}://${a}`;return N9.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class R9{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Xs(this.auth,"network-request-failed")),C9.get())})}}function jd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=Xs(t,e,n);return a.customData._tokenResponse=r,a}async function I9(t,e){return Pu(t,"POST","/v1/accounts:delete",e)}async function Nm(t,e){return Pu(t,"POST","/v1/accounts:lookup",e)}function e0(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function D9(t,e=!1){const r=sn(t),n=await r.getIdToken(e),a=oy(n);pt(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const i=typeof a.firebase=="object"?a.firebase:void 0,o=i?.sign_in_provider;return{claims:a,token:n,authTime:e0(K1(a.auth_time)),issuedAtTime:e0(K1(a.iat)),expirationTime:e0(K1(a.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function K1(t){return Number(t)*1e3}function oy(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return lm("JWT malformed, contained fewer than 3 sections"),null;try{const a=f4(r);return a?JSON.parse(a):(lm("Failed to decode base64 JWT payload"),null)}catch(a){return lm("Caught error parsing JWT payload as JSON",a?.toString()),null}}function oT(t){const e=oy(t);return pt(e,"internal-error"),pt(typeof e.exp<"u","internal-error"),pt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function v0(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Vi&&O9(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function O9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class F9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Wx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=e0(this.lastLoginAt),this.creationTime=e0(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Cm(t){const e=t.auth,r=await t.getIdToken(),n=await v0(t,Nm(e,{idToken:r}));pt(n?.users.length,e,"internal-error");const a=n.users[0];t._notifyReloadListener(a);const i=a.providerUserInfo?.length?lk(a.providerUserInfo):[],o=P9(t.providerData,i),u=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!o?.length,h=u?f:!1,p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new Wx(a.createdAt,a.lastLoginAt),isAnonymous:h};Object.assign(t,p)}async function j9(t){const e=sn(t);await Cm(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function P9(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function lk(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function M9(t,e){const r=await ak(t,{},async()=>{const n=P0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:i}=t.config,o=await ik(t,a,"/v1/token",`key=${i}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:n};return t.emulatorConfig&&Cu(t.emulatorConfig.host)&&(f.credentials="include"),nk.fetch()(o,f)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function L9(t,e){return Pu(t,"POST","/v2/accounts:revokeToken",vp(t,e))}class cu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pt(e.idToken,"internal-error"),pt(typeof e.idToken<"u","internal-error"),pt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):oT(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){pt(e.length!==0,"internal-error");const r=oT(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(pt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:i}=await M9(e,r);this.updateTokensAndExpiration(n,a,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:i}=r,o=new cu;return n&&(pt(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),a&&(pt(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),i&&(pt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new cu,this.toJSON())}_performRefresh(){return Si("not implemented")}}function El(t,e){pt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class bs{constructor({uid:e,auth:r,stsTokenManager:n,...a}){this.providerId="firebase",this.proactiveRefresh=new F9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Wx(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await v0(this,this.stsTokenManager.getToken(this.auth,e));return pt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return D9(this,e)}reload(){return j9(this)}_assign(e){this!==e&&(pt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new bs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){pt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Cm(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_s(this.auth.app))return Promise.reject(Bl(this.auth));const e=await this.getIdToken();return await v0(this,I9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,a=r.email??void 0,i=r.phoneNumber??void 0,o=r.photoURL??void 0,u=r.tenantId??void 0,f=r._redirectEventId??void 0,h=r.createdAt??void 0,p=r.lastLoginAt??void 0,{uid:x,emailVerified:y,isAnonymous:b,providerData:w,stsTokenManager:T}=r;pt(x&&T,e,"internal-error");const E=cu.fromJSON(this.name,T);pt(typeof x=="string",e,"internal-error"),El(n,e.name),El(a,e.name),pt(typeof y=="boolean",e,"internal-error"),pt(typeof b=="boolean",e,"internal-error"),El(i,e.name),El(o,e.name),El(u,e.name),El(f,e.name),El(h,e.name),El(p,e.name);const k=new bs({uid:x,auth:e,email:a,emailVerified:y,displayName:n,isAnonymous:b,photoURL:o,phoneNumber:i,tenantId:u,stsTokenManager:E,createdAt:h,lastLoginAt:p});return w&&Array.isArray(w)&&(k.providerData=w.map(I=>({...I}))),f&&(k._redirectEventId=f),k}static async _fromIdTokenResponse(e,r,n=!1){const a=new cu;a.updateFromServerResponse(r);const i=new bs({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await Cm(i),i}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];pt(a.localId!==void 0,"internal-error");const i=a.providerUserInfo!==void 0?lk(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!i?.length,u=new cu;u.updateFromIdToken(n);const f=new bs({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:o}),h={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:i,metadata:new Wx(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!i?.length};return Object.assign(f,h),f}}const cT=new Map;function Ai(t){Li(t instanceof Function,"Expected a class definition");let e=cT.get(t);return e?(Li(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,cT.set(t,e),e)}class ok{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}ok.type="NONE";const uT=ok;function om(t,e,r){return`firebase:${t}:${e}:${r}`}class uu{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:i}=this.auth;this.fullUserKey=om(this.userKey,a.apiKey,i),this.fullPersistenceKey=om("persistence",a.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Nm(this.auth,{idToken:e}).catch(()=>{});return r?bs._fromGetAccountInfoResponse(this.auth,r,e):null}return bs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new uu(Ai(uT),e,n);const a=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=a[0]||Ai(uT);const o=om(n,e.config.apiKey,e.name);let u=null;for(const h of r)try{const p=await h._get(o);if(p){let x;if(typeof p=="string"){const y=await Nm(e,{idToken:p}).catch(()=>{});if(!y)break;x=await bs._fromGetAccountInfoResponse(e,y,p)}else x=bs._fromJSON(e,p);h!==i&&(u=x),i=h;break}}catch{}const f=a.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!f.length?new uu(i,e,n):(i=f[0],u&&await i._set(o,u.toJSON()),await Promise.all(r.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new uu(i,e,n))}}function fT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(hk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ck(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mk(e))return"Blackberry";if(pk(e))return"Webos";if(uk(e))return"Safari";if((e.includes("chrome/")||fk(e))&&!e.includes("edge/"))return"Chrome";if(dk(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function ck(t=Vn()){return/firefox\//i.test(t)}function uk(t=Vn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function fk(t=Vn()){return/crios\//i.test(t)}function hk(t=Vn()){return/iemobile/i.test(t)}function dk(t=Vn()){return/android/i.test(t)}function mk(t=Vn()){return/blackberry/i.test(t)}function pk(t=Vn()){return/webos/i.test(t)}function cy(t=Vn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function B9(t=Vn()){return cy(t)&&!!window.navigator?.standalone}function V9(){return Y5()&&document.documentMode===10}function gk(t=Vn()){return cy(t)||dk(t)||pk(t)||mk(t)||/windows phone/i.test(t)||hk(t)}function xk(t,e=[]){let r;switch(t){case"Browser":r=fT(Vn());break;case"Worker":r=`${fT(Vn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Ru}/${n}`}class U9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,u)=>{try{const f=e(i);o(f)}catch(f){u(f)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function z9(t,e={}){return Pu(t,"GET","/v2/passwordPolicy",vp(t,e))}const H9=6;class q9{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??H9,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class G9{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hT(this),this.idTokenSubscription=new hT(this),this.beforeStateQueue=new U9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=tk,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ai(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await uu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Nm(this,{idToken:e}),n=await bs._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(_s(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=n?._redirectEventId,u=await this.tryRedirectSignIn(e);(!i||i===o)&&u?.user&&(n=u.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return pt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Cm(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=A9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_s(this.app))return Promise.reject(Bl(this));const r=e?sn(e):null;return r&&pt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&pt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _s(this.app)?Promise.reject(Bl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _s(this.app)?Promise.reject(Bl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ai(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await z9(this),r=new q9(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new j0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await L9(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ai(e)||this._popupRedirectResolver;pt(r,this,"argument-error"),this.redirectPersistenceManager=await uu.create(this,[Ai(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(pt(u,this,"internal-error"),u.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const f=e.addObserver(r,n,a);return()=>{o=!0,f()}}else{const f=e.addObserver(r);return()=>{o=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(_s(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&E9(`Error while retrieving App Check token: ${e.error}`),e?.token}}function yp(t){return sn(t)}class hT{constructor(e){this.auth=e,this.observer=null,this.addObserver=rI(r=>this.observer=r)}get next(){return pt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let uy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function W9(t){uy=t}function X9(t){return uy.loadJS(t)}function Y9(){return uy.gapiScript}function $9(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function K9(t,e){const r=bv(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),i=r.getOptions();if(Xo(i,e??{}))return a;Mi(a,"already-initialized")}return r.initialize({options:e})}function Q9(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Ai);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function J9(t,e,r){const n=yp(t);pt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,i=vk(e),{host:o,port:u}=Z9(e),f=u===null?"":`:${u}`,h={url:`${i}//${o}${f}/`},p=Object.freeze({host:o,port:u,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){pt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),pt(Xo(h,n.config.emulator)&&Xo(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,Cu(o)?(p4(`${i}//${o}${f}`),g4("Auth",!0)):eF()}function vk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Z9(t){const e=vk(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const i=a[1];return{host:i,port:dT(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:dT(o)}}}function dT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function eF(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class yk{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Si("not implemented")}_getIdTokenResponse(e){return Si("not implemented")}_linkToIdToken(e,r){return Si("not implemented")}_getReauthenticationResolver(e){return Si("not implemented")}}async function fu(t,e){return sk(t,"POST","/v1/accounts:signInWithIdp",vp(t,e))}const tF="http://localhost";class Qo extends yk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Qo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Mi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,...i}=r;if(!n||!a)return null;const o=new Qo(n,a);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return fu(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,fu(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,fu(e,r)}buildRequest(){const e={requestUri:tF,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=P0(r)}return e}}class _k{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Y0 extends _k{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Al extends Y0{constructor(){super("facebook.com")}static credential(e){return Qo._fromParams({providerId:Al.PROVIDER_ID,signInMethod:Al.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Al.credentialFromTaggedObject(e)}static credentialFromError(e){return Al.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Al.credential(e.oauthAccessToken)}catch{return null}}}Al.FACEBOOK_SIGN_IN_METHOD="facebook.com";Al.PROVIDER_ID="facebook.com";class kl extends Y0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Qo._fromParams({providerId:kl.PROVIDER_ID,signInMethod:kl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return kl.credentialFromTaggedObject(e)}static credentialFromError(e){return kl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return kl.credential(r,n)}catch{return null}}}kl.GOOGLE_SIGN_IN_METHOD="google.com";kl.PROVIDER_ID="google.com";class Nl extends Y0{constructor(){super("github.com")}static credential(e){return Qo._fromParams({providerId:Nl.PROVIDER_ID,signInMethod:Nl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Nl.credentialFromTaggedObject(e)}static credentialFromError(e){return Nl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Nl.credential(e.oauthAccessToken)}catch{return null}}}Nl.GITHUB_SIGN_IN_METHOD="github.com";Nl.PROVIDER_ID="github.com";class Cl extends Y0{constructor(){super("twitter.com")}static credential(e,r){return Qo._fromParams({providerId:Cl.PROVIDER_ID,signInMethod:Cl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Cl.credentialFromTaggedObject(e)}static credentialFromError(e){return Cl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Cl.credential(r,n)}catch{return null}}}Cl.TWITTER_SIGN_IN_METHOD="twitter.com";Cl.PROVIDER_ID="twitter.com";async function rF(t,e){return sk(t,"POST","/v1/accounts:signUp",vp(t,e))}class Xl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const i=await bs._fromIdTokenResponse(e,n,a),o=mT(n);return new Xl({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=mT(n);return new Xl({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function mT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function nF(t){if(_s(t.app))return Promise.reject(Bl(t));const e=yp(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Xl({user:e.currentUser,providerId:null,operationType:"signIn"});const r=await rF(e,{returnSecureToken:!0}),n=await Xl._fromIdTokenResponse(e,"signIn",r,!0);return await e._updateCurrentUser(n.user),n}class Rm extends Vi{constructor(e,r,n,a){super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,Rm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new Rm(e,r,n,a)}}function bk(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Rm._fromErrorAndOperation(t,i,e,n):i})}async function aF(t,e,r=!1){const n=await v0(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Xl._forOperation(t,"link",n)}async function sF(t,e,r=!1){const{auth:n}=t;if(_s(n.app))return Promise.reject(Bl(n));const a="reauthenticate";try{const i=await v0(t,bk(n,a,e,t),r);pt(i.idToken,n,"internal-error");const o=oy(i.idToken);pt(o,n,"internal-error");const{sub:u}=o;return pt(t.uid===u,n,"user-mismatch"),Xl._forOperation(t,a,i)}catch(i){throw i?.code==="auth/user-not-found"&&Mi(n,"user-mismatch"),i}}async function iF(t,e,r=!1){if(_s(t.app))return Promise.reject(Bl(t));const n="signIn",a=await bk(t,n,e),i=await Xl._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(i.user),i}function lF(t,e,r,n){return sn(t).onIdTokenChanged(e,r,n)}function oF(t,e,r){return sn(t).beforeAuthStateChanged(e,r)}function cF(t,e,r,n){return sn(t).onAuthStateChanged(e,r,n)}const Im="__sak";class wk{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Im,"1"),this.storage.removeItem(Im),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const uF=1e3,fF=10;class Ek extends wk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=gk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,u,f)=>{this.notifyListeners(o,f)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);V9()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,fF):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},uF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ek.type="LOCAL";const hF=Ek;class Tk extends wk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Tk.type="SESSION";const Sk=Tk;function dF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class _p{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new _p(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:i}=r.data,o=this.handlersMap[a];if(!o?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(o).map(async h=>h(r.origin,i)),f=await dF(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:f})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}_p.receivers=[];function fy(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class mF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let i,o;return new Promise((u,f)=>{const h=fy("",20);a.port1.start();const p=setTimeout(()=>{f(new Error("unsupported_event"))},n);o={messageChannel:a,onMessage(x){const y=x;if(y.data.eventId===h)switch(y.data.status){case"ack":clearTimeout(p),i=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),u(y.data.response);break;default:clearTimeout(p),clearTimeout(i),f(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Ys(){return window}function pF(t){Ys().location.href=t}function Ak(){return typeof Ys().WorkerGlobalScope<"u"&&typeof Ys().importScripts=="function"}async function gF(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function xF(){return navigator?.serviceWorker?.controller||null}function vF(){return Ak()?self:null}const kk="firebaseLocalStorageDb",yF=1,Dm="firebaseLocalStorage",Nk="fbase_key";class $0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function bp(t,e){return t.transaction([Dm],e?"readwrite":"readonly").objectStore(Dm)}function _F(){const t=indexedDB.deleteDatabase(kk);return new $0(t).toPromise()}function Xx(){const t=indexedDB.open(kk,yF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Dm,{keyPath:Nk})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Dm)?e(n):(n.close(),await _F(),e(await Xx()))})})}async function pT(t,e,r){const n=bp(t,!0).put({[Nk]:e,value:r});return new $0(n).toPromise()}async function bF(t,e){const r=bp(t,!1).get(e),n=await new $0(r).toPromise();return n===void 0?null:n.value}function gT(t,e){const r=bp(t,!0).delete(e);return new $0(r).toPromise()}const wF=800,EF=3;class Ck{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Xx(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>EF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ak()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=_p._getInstance(vF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await gF(),!this.activeServiceWorker)return;this.sender=new mF(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||xF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Xx();return await pT(e,Im,"1"),await gT(e,Im),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>pT(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>bF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>gT(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const i=bp(a,!1).getAll();return new $0(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:i}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(i)&&(this.notifyListeners(a,i),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),wF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Ck.type="LOCAL";const TF=Ck;new X0(3e4,6e4);function SF(t,e){return e?Ai(e):(pt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class hy extends yk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return fu(e,this._buildIdpRequest())}_linkToIdToken(e,r){return fu(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return fu(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function AF(t){return iF(t.auth,new hy(t),t.bypassAuthState)}function kF(t){const{auth:e,user:r}=t;return pt(r,e,"internal-error"),sF(r,new hy(t),t.bypassAuthState)}async function NF(t){const{auth:e,user:r}=t;return pt(r,e,"internal-error"),aF(r,new hy(t),t.bypassAuthState)}class Rk{constructor(e,r,n,a,i=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:i,error:o,type:u}=e;if(o){this.reject(o);return}const f={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return AF;case"linkViaPopup":case"linkViaRedirect":return NF;case"reauthViaPopup":case"reauthViaRedirect":return kF;default:Mi(this.auth,"internal-error")}}resolve(e){Li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Li(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const CF=new X0(2e3,1e4);class iu extends Rk{constructor(e,r,n,a,i){super(e,r,a,i),this.provider=n,this.authWindow=null,this.pollId=null,iu.currentPopupAction&&iu.currentPopupAction.cancel(),iu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return pt(e,this.auth,"internal-error"),e}async onExecution(){Li(this.filter.length===1,"Popup operations only handle one event");const e=fy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Xs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Xs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,iu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Xs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,CF.get())};e()}}iu.currentPopupAction=null;const RF="pendingRedirect",cm=new Map;class IF extends Rk{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=cm.get(this.auth._key());if(!e){try{const n=await DF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}cm.set(this.auth._key(),e)}return this.bypassAuthState||cm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function DF(t,e){const r=jF(e),n=FF(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function OF(t,e){cm.set(t._key(),e)}function FF(t){return Ai(t._redirectPersistence)}function jF(t){return om(RF,t.config.apiKey,t.name)}async function PF(t,e,r=!1){if(_s(t.app))return Promise.reject(Bl(t));const n=yp(t),a=SF(n,e),o=await new IF(n,a,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}const MF=600*1e3;class LF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!BF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!Ik(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Xs(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=MF&&this.cachedEventUids.clear(),this.cachedEventUids.has(xT(e))}saveEventToCache(e){this.cachedEventUids.add(xT(e)),this.lastProcessedEventTime=Date.now()}}function xT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Ik({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function BF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ik(t);default:return!1}}async function VF(t,e={}){return Pu(t,"GET","/v1/projects",e)}const UF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zF=/^https?/;async function HF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await VF(t);for(const r of e)try{if(qF(r))return}catch{}Mi(t,"unauthorized-domain")}function qF(t){const e=Gx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!zF.test(r))return!1;if(UF.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}const GF=new X0(3e4,6e4);function vT(){const t=Ys().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function WF(t){return new Promise((e,r)=>{function n(){vT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{vT(),r(Xs(t,"network-request-failed"))},timeout:GF.get()})}if(Ys().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ys().gapi?.load)n();else{const a=$9("iframefcb");return Ys()[a]=()=>{gapi.load?n():r(Xs(t,"network-request-failed"))},X9(`${Y9()}?onload=${a}`).catch(i=>r(i))}}).catch(e=>{throw um=null,e})}let um=null;function XF(t){return um=um||WF(t),um}const YF=new X0(5e3,15e3),$F="__/auth/iframe",KF="emulator/auth/iframe",QF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},JF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ZF(t){const e=t.config;pt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?ly(e,KF):`https://${t.config.authDomain}/${$F}`,n={apiKey:e.apiKey,appName:t.name,v:Ru},a=JF.get(t.config.apiHost);a&&(n.eid=a);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${P0(n).slice(1)}`}async function ej(t){const e=await XF(t),r=Ys().gapi;return pt(r,t,"internal-error"),e.open({where:document.body,url:ZF(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:QF,dontclear:!0},n=>new Promise(async(a,i)=>{await n.restyle({setHideOnLeave:!1});const o=Xs(t,"network-request-failed"),u=Ys().setTimeout(()=>{i(o)},YF.get());function f(){Ys().clearTimeout(u),a(n)}n.ping(f).then(f,()=>{i(o)})}))}const tj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rj=500,nj=600,aj="_blank",sj="http://localhost";class yT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function ij(t,e,r,n=rj,a=nj){const i=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const f={...tj,width:n.toString(),height:a.toString(),top:i,left:o},h=Vn().toLowerCase();r&&(u=fk(h)?aj:r),ck(h)&&(e=e||sj,f.scrollbars="yes");const p=Object.entries(f).reduce((y,[b,w])=>`${y}${b}=${w},`,"");if(B9(h)&&u!=="_self")return lj(e||"",u),new yT(null);const x=window.open(e||"",u,p);pt(x,t,"popup-blocked");try{x.focus()}catch{}return new yT(x)}function lj(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const oj="__/auth/handler",cj="emulator/auth/handler",uj=encodeURIComponent("fac");async function _T(t,e,r,n,a,i){pt(t.config.authDomain,t,"auth-domain-config-required"),pt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Ru,eventId:a};if(e instanceof _k){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",tI(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,x]of Object.entries({}))o[p]=x}if(e instanceof Y0){const p=e.getScopes().filter(x=>x!=="");p.length>0&&(o.scopes=p.join(","))}t.tenantId&&(o.tid=t.tenantId);const u=o;for(const p of Object.keys(u))u[p]===void 0&&delete u[p];const f=await t._getAppCheckToken(),h=f?`#${uj}=${encodeURIComponent(f)}`:"";return`${fj(t)}?${P0(u).slice(1)}${h}`}function fj({config:t}){return t.emulator?ly(t,cj):`https://${t.authDomain}/${oj}`}const Q1="webStorageSupport";class hj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Sk,this._completeRedirectFn=PF,this._overrideRedirectResult=OF}async _openPopup(e,r,n,a){Li(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await _T(e,r,n,Gx(),a);return ij(e,i,fy())}async _openRedirect(e,r,n,a){await this._originValidation(e);const i=await _T(e,r,n,Gx(),a);return pF(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:i}=this.eventManagers[r];return a?Promise.resolve(a):(Li(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await ej(e),n=new LF(e);return r.register("authEvent",a=>(pt(a?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Q1,{type:Q1},a=>{const i=a?.[0]?.[Q1];i!==void 0&&r(!!i),Mi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=HF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return gk()||uk()||cy()}}const dj=hj;var bT="@firebase/auth",wT="1.11.1";class mj{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){pt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function pj(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function gj(t){xu(new Yo("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=n.options;pt(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:o,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xk(t)},h=new G9(n,a,i,f);return Q9(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),xu(new Yo("auth-internal",e=>{const r=yp(e.getProvider("auth").getImmediate());return(n=>new mj(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Pl(bT,wT,pj(t)),Pl(bT,wT,"esm2020")}const xj=300,vj=m4("authIdTokenMaxAge")||xj;let ET=null;const yj=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>vj)return;const a=r?.token;ET!==a&&(ET=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function _j(t=_4()){const e=bv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=K9(t,{popupRedirectResolver:dj,persistence:[TF,hF,Sk]}),n=m4("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=yj(i.toString());oF(r,o,()=>o(r.currentUser)),lF(r,u=>o(u))}}const a=h4("auth");return a&&J9(r,`http://${a}`),r}function bj(){return document.getElementsByTagName("head")?.[0]??document}W9({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const i=Xs("internal-error");i.customData=a,r(i)},n.type="text/javascript",n.charset="UTF-8",bj().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});gj("Browser");const wj=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ej=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),TT=t=>{const e=Ej(t);return e.charAt(0).toUpperCase()+e.slice(1)},Dk=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),Tj=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var Sj={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Aj=ee.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...u},f)=>ee.createElement("svg",{ref:f,...Sj,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:Dk("lucide",a),...!i&&!Tj(u)&&{"aria-hidden":"true"},...u},[...o.map(([h,p])=>ee.createElement(h,p)),...Array.isArray(i)?i:[i]]));const Ye=(t,e)=>{const r=ee.forwardRef(({className:n,...a},i)=>ee.createElement(Aj,{ref:i,iconNode:e,className:Dk(`lucide-${wj(TT(t))}`,`lucide-${t}`,n),...a}));return r.displayName=TT(t),r};const kj=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Nj=Ye("archive",kj);const Cj=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],dy=Ye("arrow-down",Cj);const Rj=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ok=Ye("arrow-left",Rj);const Ij=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Dj=Ye("arrow-right",Ij);const Oj=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Fj=Ye("arrow-up",Oj);const jj=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],Pj=Ye("bold",jj);const Mj=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],my=Ye("calculator",Mj);const Lj=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Fk=Ye("calendar",Lj);const Bj=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],wp=Ye("camera",Bj);const Vj=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Uj=Ye("chevron-down",Vj);const zj=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Hj=Ye("chevron-left",zj);const qj=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],jk=Ye("chevron-right",qj);const Gj=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Ep=Ye("circle-check-big",Gj);const Wj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Yx=Ye("circle-question-mark",Wj);const Xj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Yj=Ye("circle-x",Xj);const $j=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Pk=Ye("clock-3",$j);const Kj=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Qj=Ye("clock",Kj);const Jj=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],Zj=Ye("cloud-upload",Jj);const eP=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],tP=Ye("credit-card",eP);const rP=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],$x=Ye("crown",rP);const nP=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],aP=Ye("database",nP);const sP=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],py=Ye("dollar-sign",sP);const iP=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],lP=Ye("download",iP);const oP=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Il=Ye("external-link",oP);const cP=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Mk=Ye("file-spreadsheet",cP);const uP=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Lk=Ye("file-text",uP);const fP=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],hP=Ye("file-up",fP);const dP=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ST=Ye("folder",dP);const mP=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],pP=Ye("funnel",mP);const gP=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],J1=Ye("heart",gP);const xP=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],K0=Ye("image",xP);const vP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],lc=Ye("info",vP);const yP=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],_P=Ye("italic",yP);const bP=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Bk=Ye("key",bP);const wP=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Om=Ye("link",wP);const EP=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],TP=Ye("list-checks",EP);const SP=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],AP=Ye("lock",SP);const kP=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Vk=Ye("log-out",kP);const NP=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],Uk=Ye("megaphone",NP);const CP=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],AT=Ye("message-square",CP);const RP=[["path",{d:"M5 12h14",key:"1ays0h"}]],gy=Ye("minus",RP);const IP=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],kT=Ye("music",IP);const DP=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],zk=Ye("package",DP);const OP=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],xy=Ye("pen-line",OP);const FP=[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]],vy=Ye("plane",FP);const jP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Yl=Ye("plus",jP);const PP=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],MP=Ye("refresh-ccw",PP);const LP=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],BP=Ye("refresh-cw",LP);const VP=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],NT=Ye("rocket",VP);const UP=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],zP=Ye("rotate-ccw",UP);const HP=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Ui=Ye("save",HP);const qP=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],Q0=Ye("scale",qP);const GP=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],WP=Ye("school",GP);const XP=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],yy=Ye("search",XP);const YP=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Hk=Ye("settings",YP);const $P=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],qk=Ye("shield",$P);const KP=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],Fm=Ye("shopping-bag",KP);const QP=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],Tp=Ye("shopping-cart",QP);const JP=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Gk=Ye("square-check-big",JP);const ZP=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],J0=Ye("tag",ZP);const eM=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]],tM=Ye("text-align-end",eM);const rM=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]],nM=Ye("text-align-center",rM);const aM=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],sM=Ye("text-align-start",aM);const iM=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],Sp=Ye("ticket",iM);const lM=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Z0=Ye("trash-2",lM);const oM=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],_y=Ye("triangle-alert",oM);const cM=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],Ap=Ye("truck",cM);const uM=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Z1=Ye("type",uM);const fM=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],hM=Ye("underline",fM);const dM=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],by=Ye("upload",dM);const mM=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],wy=Ye("user",mM);const pM=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],gM=Ye("users",pM);const xM=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],vM=Ye("volume-2",xM);const yM=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],_M=Ye("volume-x",yM);const bM=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ua=Ye("x",bM);const wM=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],jm=Ye("zap",wM);const EM=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],TM=Ye("zoom-in",EM);const SM=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],AM=Ye("zoom-out",SM);function kM({users:t,onLogin:e}){const[r,n]=ee.useState(""),[a,i]=ee.useState(""),o=h=>{h.preventDefault(),e(r,a)},f="PLUS ULTRA  GO BEYOND  PLUS ULTRA  GO BEYOND  ".repeat(4);return m.jsxs("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[m.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"radial-gradient(#ffffff 1px, transparent 1px)",backgroundSize:"20px 20px"}}),m.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-32 flex justify-center pointer-events-none overflow-hidden select-none opacity-10",children:m.jsxs("div",{className:"animate-scroll-down whitespace-nowrap text-8xl font-black text-slate-100 tracking-tighter",style:{writingMode:"vertical-rl"},children:[m.jsx("span",{children:f}),m.jsx("span",{children:f})]})}),m.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-32 flex justify-center pointer-events-none overflow-hidden select-none opacity-10",children:m.jsxs("div",{className:"animate-scroll-up whitespace-nowrap text-8xl font-black text-slate-100 tracking-tighter",style:{writingMode:"vertical-rl"},children:[m.jsx("span",{children:f}),m.jsx("span",{children:f})]})}),m.jsx("style",{jsx:!0,children:`
        @keyframes scroll-up {
          0% { transform: translateY(0); }
          100% { transform: translateY(-50%); }
        }
        
        @keyframes scroll-down {
          0% { transform: translateY(-50%); }
          100% { transform: translateY(0); }
        }

        .animate-scroll-up {
          /* 1.  50s */
          animation: scroll-up 50s linear infinite;
          /* 2.   GPU  () */
          will-change: transform;
        }

        .animate-scroll-down {
          /* 1.  50s */
          animation: scroll-down 50s linear infinite;
          /* 2.   */
          will-change: transform;
        }
      `}),m.jsxs("form",{onSubmit:o,className:`\r
          bg-white w-full max-w-md p-8 rounded-lg \r
          border-4 border-slate-900 \r
          shadow-[8px_8px_0px_0px_#FACC15] \r
          relative overflow-hidden z-10\r
        `,children:[m.jsx("div",{className:"absolute top-0 left-0 w-full h-1/4 bg-red-600 transform -skew-y-3 -mt-8 opacity-10"}),m.jsxs("div",{className:"text-center mb-8 relative z-10",children:[m.jsx("div",{className:"inline-block p-4 bg-slate-900 rounded-full text-yellow-400 mb-4 border-2 border-yellow-400",children:m.jsx(qk,{size:36})}),m.jsx("h1",{className:"text-3xl font-black italic text-slate-900 tracking-wider",children:""}),m.jsx("p",{className:"text-slate-500 text-sm mt-1 font-bold",children:"U.A. ACADEMY LOGIN"})]}),m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{children:[m.jsxs("label",{className:"text-slate-900 text-sm font-black italic block mb-1 flex items-center gap-1",children:[m.jsx(wy,{size:16}),"  (Your ID)"]}),m.jsxs("select",{className:`\r
                w-full border-2 border-slate-900 rounded-lg px-3 py-2.5 \r
                bg-slate-50 text-slate-800 font-bold \r
                focus:outline-none focus:ring-4 focus:ring-yellow-400 \r
                transition-all appearance-none\r
              `,value:r,onChange:h=>n(h.target.value),required:!0,children:[m.jsx("option",{value:"",children:"..."}),t.map(h=>m.jsx("option",{value:h.id,children:h.name},h.id))]})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-slate-900 text-sm font-black italic block mb-1 flex items-center gap-1",children:[m.jsx(AP,{size:16}),"  (Password)"]}),m.jsx("input",{type:"password",value:a,onChange:h=>i(h.target.value),placeholder:"",className:`\r
                w-full border-2 border-slate-900 rounded-lg px-3 py-2 \r
                bg-slate-50 text-slate-900 font-bold \r
                focus:outline-none focus:ring-4 focus:ring-yellow-400 \r
                placeholder-slate-400 transition-all\r
              `,required:!0}),m.jsx("span",{className:"text-xs text-slate-500 font-medium mt-1",children:" 4  0 "})]}),m.jsxs("button",{type:"submit",className:`\r
              w-full py-3 mt-4 text-xl \r
              bg-red-600 text-white font-black italic \r
              rounded-lg border-2 border-red-800\r
              shadow-[4px_4px_0px_0px_rgba(15,23,42,1)]\r
              hover:bg-red-700 \r
              disabled:opacity-50 disabled:shadow-none\r
              transition-all transform active:translate-y-0.5 active:translate-x-0.5 active:shadow-none\r
            `,disabled:!r||!a,children:[m.jsx(Dj,{size:20,className:"inline mr-2"})," (LOGIN!)"]})]})]})]})}var NM="firebase",CM="12.6.0";Pl(NM,CM,"app");console.log("FB KEY =","AIzaSyD97NjWJOV7NPgAzEEgzX7U31yXkq6L0VI");const RM={apiKey:"AIzaSyD97NjWJOV7NPgAzEEgzX7U31yXkq6L0VI",authDomain:"my-shopping-cart-be7df.firebaseapp.com",projectId:"my-shopping-cart-be7df",storageBucket:"my-shopping-cart-be7df.firebasestorage.app",messagingSenderId:"968807957116",appId:"1:968807957116:web:b4d0c85cc06c9afed53ff9",measurementId:"G-M4E24RKXL0"},Wk=y4(RM),Ke=c9(Wk),ex=_j(Wk);var Ja=function(t,e){return Number(t.toFixed(e))},IM=function(t,e){return e},Er=function(t,e,r){r&&typeof r=="function"&&r(t,e)},DM=function(t){return-Math.cos(t*Math.PI)/2+.5},OM=function(t){return t},FM=function(t){return t*t},jM=function(t){return t*(2-t)},PM=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},MM=function(t){return t*t*t},LM=function(t){return--t*t*t+1},BM=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},VM=function(t){return t*t*t*t},UM=function(t){return 1- --t*t*t*t},zM=function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},HM=function(t){return t*t*t*t*t},qM=function(t){return 1+--t*t*t*t*t},GM=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},Xk={easeOut:DM,linear:OM,easeInQuad:FM,easeOutQuad:jM,easeInOutQuad:PM,easeInCubic:MM,easeOutCubic:LM,easeInOutCubic:BM,easeInQuart:VM,easeOutQuart:UM,easeInOutQuart:zM,easeInQuint:HM,easeOutQuint:qM,easeInOutQuint:GM},Yk=function(t){typeof t=="number"&&cancelAnimationFrame(t)},ys=function(t){t.mounted&&(Yk(t.animation),t.animate=!1,t.animation=null,t.velocity=null)};function $k(t,e,r,n){if(t.mounted){var a=new Date().getTime(),i=1;ys(t),t.animation=function(){if(!t.mounted)return Yk(t.animation);var o=new Date().getTime()-a,u=o/r,f=Xk[e],h=f(u);o>=r?(n(i),t.animation=null):t.animation&&(n(h),requestAnimationFrame(t.animation))},requestAnimationFrame(t.animation)}}function WM(t){var e=t.scale,r=t.positionX,n=t.positionY;return!(Number.isNaN(e)||Number.isNaN(r)||Number.isNaN(n))}function ao(t,e,r,n){var a=WM(e);if(!(!t.mounted||!a)){var i=t.setTransformState,o=t.transformState,u=o.scale,f=o.positionX,h=o.positionY,p=e.scale-u,x=e.positionX-f,y=e.positionY-h;r===0?i(e.scale,e.positionX,e.positionY):$k(t,n,r,function(b){var w=u+p*b,T=f+x*b,E=h+y*b;i(w,T,E)})}}function XM(t,e,r){var n=t.offsetWidth,a=t.offsetHeight,i=e.offsetWidth,o=e.offsetHeight,u=i*r,f=o*r,h=n-u,p=a-f;return{wrapperWidth:n,wrapperHeight:a,newContentWidth:u,newDiffWidth:h,newContentHeight:f,newDiffHeight:p}}var YM=function(t,e,r,n,a,i,o){var u=t>e?r*(o?1:.5):0,f=n>a?i*(o?1:.5):0,h=t-e-u,p=u,x=n-a-f,y=f;return{minPositionX:h,maxPositionX:p,minPositionY:x,maxPositionY:y}},Ey=function(t,e){var r=t.wrapperComponent,n=t.contentComponent,a=t.setup.centerZoomedOut;if(!r||!n)throw new Error("Components are not mounted");var i=XM(r,n,e),o=i.wrapperWidth,u=i.wrapperHeight,f=i.newContentWidth,h=i.newDiffWidth,p=i.newContentHeight,x=i.newDiffHeight,y=YM(o,f,h,u,p,x,!!a);return y},Kx=function(t,e,r,n){return n?t<e?Ja(e,2):t>r?Ja(r,2):Ja(t,2):Ja(t,2)},zo=function(t,e){var r=Ey(t,e);return t.bounds=r,r};function eh(t,e,r,n,a,i,o){var u=r.minPositionX,f=r.minPositionY,h=r.maxPositionX,p=r.maxPositionY,x=0,y=0;o&&(x=a,y=i);var b=Kx(t,u-x,h+x,n),w=Kx(e,f-y,p+y,n);return{x:b,y:w}}function kp(t,e,r,n,a,i){var o=t.transformState,u=o.scale,f=o.positionX,h=o.positionY,p=n-u;if(typeof e!="number"||typeof r!="number")return console.error("Mouse X and Y position were not provided!"),{x:f,y:h};var x=f-e*p,y=h-r*p,b=eh(x,y,a,i,0,0,null);return b}function th(t,e,r,n,a){var i=a?n:0,o=e-i;return!Number.isNaN(r)&&t>=r?r:!Number.isNaN(e)&&t<=o?o:t}var CT=function(t,e){var r=t.setup.panning.excluded,n=t.isInitialized,a=t.wrapperComponent,i=e.target,o="shadowRoot"in i&&"composedPath"in e,u=o?e.composedPath().some(function(p){return p instanceof Element?a?.contains(p):!1}):a?.contains(i),f=n&&i&&u;if(!f)return!1;var h=Np(i,r);return!h},RT=function(t){var e=t.isInitialized,r=t.isPanning,n=t.setup,a=n.panning.disabled,i=e&&r&&!a;return!!i},$M=function(t,e){var r=t.transformState,n=r.positionX,a=r.positionY;t.isPanning=!0;var i=e.clientX,o=e.clientY;t.startCoords={x:i-n,y:o-a}},KM=function(t,e){var r=e.touches,n=t.transformState,a=n.positionX,i=n.positionY;t.isPanning=!0;var o=r.length===1;if(o){var u=r[0].clientX,f=r[0].clientY;t.startCoords={x:u-a,y:f-i}}};function QM(t){var e=t.transformState,r=e.positionX,n=e.positionY,a=e.scale,i=t.setup,o=i.disabled,u=i.limitToBounds,f=i.centerZoomedOut,h=t.wrapperComponent;if(!(o||!h||!t.bounds)){var p=t.bounds,x=p.maxPositionX,y=p.minPositionX,b=p.maxPositionY,w=p.minPositionY,T=r>x||r<y,E=n>b||n<w,k=r>x?h.offsetWidth:t.setup.minPositionX||0,I=n>b?h.offsetHeight:t.setup.minPositionY||0,N=kp(t,k,I,a,t.bounds,u||f),z=N.x,H=N.y;return{scale:a,positionX:T?z:r,positionY:E?H:n}}}function Kk(t,e,r,n,a){var i=t.setup.limitToBounds,o=t.wrapperComponent,u=t.bounds,f=t.transformState,h=f.scale,p=f.positionX,x=f.positionY;if(!(o===null||u===null||e===p&&r===x)){var y=eh(e,r,u,i,n,a,o),b=y.x,w=y.y;t.setTransformState(h,b,w)}}var JM=function(t,e,r){var n=t.startCoords,a=t.transformState,i=t.setup.panning,o=i.lockAxisX,u=i.lockAxisY,f=a.positionX,h=a.positionY;if(!n)return{x:f,y:h};var p=e-n.x,x=r-n.y,y=o?f:p,b=u?h:x;return{x:y,y:b}},$l=function(t,e){var r=t.setup,n=t.transformState,a=n.scale,i=r.minScale,o=r.disablePadding;return e>0&&a>=i&&!o?e:0},ZM=function(t){var e=t.mounted,r=t.setup,n=r.disabled,a=r.velocityAnimation,i=t.transformState.scale,o=a.disabled,u=!o||i>1||!n||e;return!!u},eL=function(t){var e=t.mounted,r=t.velocity,n=t.bounds,a=t.setup,i=a.disabled,o=a.velocityAnimation,u=t.transformState.scale,f=o.disabled,h=!f||u>1||!i||e;return!(!h||!r||!n)};function tL(t,e){var r=t.setup.velocityAnimation,n=r.equalToMove,a=r.animationTime,i=r.sensitivity;return n?a*e*i:a}function IT(t,e,r,n,a,i,o,u,f,h){if(a){if(e>o&&r>o){var p=o+(t-o)*h;return p>f?f:p<o?o:p}if(e<i&&r<i){var p=i+(t-i)*h;return p<u?u:p>i?i:p}}return n?e:Kx(t,i,o,a)}function rL(t,e){var r=1;return e?Math.min(r,t.offsetWidth/window.innerWidth):r}function nL(t,e){var r=ZM(t);if(r){var n=t.lastMousePosition,a=t.velocityTime,i=t.setup,o=t.wrapperComponent,u=i.velocityAnimation.equalToMove,f=Date.now();if(n&&a&&o){var h=rL(o,u),p=e.x-n.x,x=e.y-n.y,y=p/h,b=x/h,w=f-a,T=p*p+x*x,E=Math.sqrt(T)/w;t.velocity={velocityX:y,velocityY:b,total:E}}t.lastMousePosition=e,t.velocityTime=f}}function aL(t){var e=t.velocity,r=t.bounds,n=t.setup,a=t.wrapperComponent,i=eL(t);if(!(!i||!e||!r||!a)){var o=e.velocityX,u=e.velocityY,f=e.total,h=r.maxPositionX,p=r.minPositionX,x=r.maxPositionY,y=r.minPositionY,b=n.limitToBounds,w=n.alignmentAnimation,T=n.zoomAnimation,E=n.panning,k=E.lockAxisY,I=E.lockAxisX,N=T.animationType,z=w.sizeX,H=w.sizeY,q=w.velocityAlignmentTime,A=q,F=tL(t,f),R=Math.max(F,A),M=$l(t,z),O=$l(t,H),j=M*a.offsetWidth/100,L=O*a.offsetHeight/100,Ne=h+j,_e=p-j,ne=x+L,se=y-L,Ee=t.transformState,ie=new Date().getTime();$k(t,N,R,function(Ve){var U=t.transformState,P=U.scale,G=U.positionX,Y=U.positionY,Z=new Date().getTime()-ie,oe=Z/A,ye=Xk[w.animationType],Fe=1-ye(Math.min(1,oe)),Te=1-Ve,De=G+o*Te,rt=Y+u*Te,re=IT(De,Ee.positionX,G,I,b,p,h,_e,Ne,Fe),ft=IT(rt,Ee.positionY,Y,k,b,y,x,se,ne,Fe);(G!==De||Y!==rt)&&t.setTransformState(P,re,ft)})}}function DT(t,e){var r=t.transformState.scale;ys(t),zo(t,r),window.TouchEvent!==void 0&&e instanceof TouchEvent?KM(t,e):$M(t,e)}function Ty(t,e){var r=t.transformState.scale,n=t.setup,a=n.minScale,i=n.alignmentAnimation,o=i.disabled,u=i.sizeX,f=i.sizeY,h=i.animationTime,p=i.animationType,x=o||r<a||!u&&!f;if(!x){var y=QM(t);y&&ao(t,y,e??h,p)}}function OT(t,e,r){var n=t.startCoords,a=t.setup,i=a.alignmentAnimation,o=i.sizeX,u=i.sizeY;if(n){var f=JM(t,e,r),h=f.x,p=f.y,x=$l(t,o),y=$l(t,u);nL(t,{x:h,y:p}),Kk(t,h,p,x,y)}}function sL(t){if(t.isPanning){var e=t.setup.panning.velocityDisabled,r=t.velocity,n=t.wrapperComponent,a=t.contentComponent;t.isPanning=!1,t.animate=!1,t.animation=null;var i=n?.getBoundingClientRect(),o=a?.getBoundingClientRect(),u=i?.width||0,f=i?.height||0,h=o?.width||0,p=o?.height||0,x=u<h||f<p,y=!e&&r&&r?.total>.1&&x;y?aL(t):Ty(t)}}function Sy(t,e,r,n){var a=t.setup,i=a.minScale,o=a.maxScale,u=a.limitToBounds,f=th(Ja(e,2),i,o,0,!1),h=zo(t,f),p=kp(t,r,n,f,h,u),x=p.x,y=p.y;return{scale:f,positionX:x,positionY:y}}function Qk(t,e,r){var n=t.transformState.scale,a=t.wrapperComponent,i=t.setup,o=i.minScale,u=i.limitToBounds,f=i.zoomAnimation,h=f.disabled,p=f.animationTime,x=f.animationType,y=h||n>=o;if((n>=1||u)&&Ty(t),!(y||!a||!t.mounted)){var b=e||a.offsetWidth/2,w=r||a.offsetHeight/2,T=Sy(t,o,b,w);T&&ao(t,T,p,x)}}var Vl=function(){return Vl=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Vl.apply(this,arguments)};function FT(t,e,r){for(var n=0,a=e.length,i;n<a;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}var Pd={scale:1,positionX:0,positionY:0},Bf={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},Qx={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},Jk=function(t){var e,r,n,a;return{previousScale:(e=t.initialScale)!==null&&e!==void 0?e:Pd.scale,scale:(r=t.initialScale)!==null&&r!==void 0?r:Pd.scale,positionX:(n=t.initialPositionX)!==null&&n!==void 0?n:Pd.positionX,positionY:(a=t.initialPositionY)!==null&&a!==void 0?a:Pd.positionY}},jT=function(t){var e=Vl({},Bf);return Object.keys(t).forEach(function(r){var n=typeof t[r]<"u",a=typeof Bf[r]<"u";if(a&&n){var i=Object.prototype.toString.call(Bf[r]),o=i==="[object Object]",u=i==="[object Array]";o?e[r]=Vl(Vl({},Bf[r]),t[r]):u?e[r]=FT(FT([],Bf[r],!0),t[r]):e[r]=t[r]}}),e},Zk=function(t,e,r){var n=t.transformState.scale,a=t.wrapperComponent,i=t.setup,o=i.maxScale,u=i.minScale,f=i.zoomAnimation,h=i.smooth,p=f.size;if(!a)throw new Error("Wrapper is not mounted");var x=h?n*Math.exp(e*r):n+e*r,y=th(Ja(x,3),u,o,p,!1);return y};function eN(t,e,r,n,a){var i=t.wrapperComponent,o=t.transformState,u=o.scale,f=o.positionX,h=o.positionY;if(!i)return console.error("No WrapperComponent found");var p=i.offsetWidth,x=i.offsetHeight,y=(p/2-f)/u,b=(x/2-h)/u,w=Zk(t,e,r),T=Sy(t,w,y,b);if(!T)return console.error("Error during zoom event. New transformation state was not calculated.");ao(t,T,n,a)}function tN(t,e,r,n){var a=t.setup,i=t.wrapperComponent,o=a.limitToBounds,u=Jk(t.props),f=t.transformState,h=f.scale,p=f.positionX,x=f.positionY;if(i){var y=Ey(t,u.scale),b=eh(u.positionX,u.positionY,y,o,0,0,i),w={scale:u.scale,positionX:b.x,positionY:b.y};h===u.scale&&p===u.positionX&&x===u.positionY||(n?.(),ao(t,w,e,r))}}function iL(t,e,r,n){var a=t.getBoundingClientRect(),i=e.getBoundingClientRect(),o=r.getBoundingClientRect(),u=i.x*n.scale,f=i.y*n.scale;return{x:(a.x-o.x+u)/n.scale,y:(a.y-o.y+f)/n.scale}}function lL(t,e,r){var n=t.wrapperComponent,a=t.contentComponent,i=t.transformState,o=t.setup,u=o.limitToBounds,f=o.minScale,h=o.maxScale;if(!n||!a)return i;var p=n.getBoundingClientRect(),x=e.getBoundingClientRect(),y=iL(e,n,a,i),b=y.x,w=y.y,T=x.width/i.scale,E=x.height/i.scale,k=n.offsetWidth/T,I=n.offsetHeight/E,N=th(r||Math.min(k,I),f,h,0,!1),z=(p.width-T*N)/2,H=(p.height-E*N)/2,q=(p.left-b)*N+z,A=(p.top-w)*N+H,F=Ey(t,N),R=eh(q,A,F,u,0,0,n),M=R.x,O=R.y;return{positionX:M,positionY:O,scale:N}}var oL=function(t){return function(e,r,n){e===void 0&&(e=.5),r===void 0&&(r=300),n===void 0&&(n="easeOut"),eN(t,1,e,r,n)}},cL=function(t){return function(e,r,n){e===void 0&&(e=.5),r===void 0&&(r=300),n===void 0&&(n="easeOut"),eN(t,-1,e,r,n)}},uL=function(t){return function(e,r,n,a,i){a===void 0&&(a=300),i===void 0&&(i="easeOut");var o=t.transformState,u=o.positionX,f=o.positionY,h=o.scale,p=t.wrapperComponent,x=t.contentComponent,y=t.setup.disabled;if(!(y||!p||!x)){var b={positionX:Number.isNaN(e)?u:e,positionY:Number.isNaN(r)?f:r,scale:Number.isNaN(n)?h:n};ao(t,b,a,i)}}},fL=function(t){return function(e,r){e===void 0&&(e=200),r===void 0&&(r="easeOut"),tN(t,e,r)}},hL=function(t){return function(e,r,n){r===void 0&&(r=200),n===void 0&&(n="easeOut");var a=t.transformState,i=t.wrapperComponent,o=t.contentComponent;if(i&&o){var u=rN(e||a.scale,i,o);ao(t,u,r,n)}}},dL=function(t){return function(e,r,n,a){n===void 0&&(n=600),a===void 0&&(a="easeOut"),ys(t);var i=t.wrapperComponent,o=typeof e=="string"?document.getElementById(e):e;if(i&&o&&i.contains(o)){var u=lL(t,o,r);ao(t,u,n,a)}}},Jx=function(t){return{instance:t,zoomIn:oL(t),zoomOut:cL(t),setTransform:uL(t),resetTransform:fL(t),centerView:hL(t),zoomToElement:dL(t)}},mL=function(t){return{instance:t,state:t.transformState}},hr=function(t){var e={};return Object.assign(e,mL(t)),Object.assign(e,Jx(t)),e},tx=!1;function rx(){try{var t={get passive(){return tx=!0,!1}};return t}catch{return tx=!1,tx}}var Md=".".concat(Qx.wrapperClass),Np=function(t,e){return e.some(function(r){return t.matches("".concat(Md," ").concat(r,", ").concat(Md," .").concat(r,", ").concat(Md," ").concat(r," *, ").concat(Md," .").concat(r," *"))})},Zx=function(t){t&&clearTimeout(t)},pL=function(t,e,r){return"translate(".concat(t,"px, ").concat(e,"px) scale(").concat(r,")")},rN=function(t,e,r){var n=r.offsetWidth*t,a=r.offsetHeight*t,i=(e.offsetWidth-n)/2,o=(e.offsetHeight-a)/2;return{scale:t,positionX:i,positionY:o}};function gL(t){return function(e){t.forEach(function(r){typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var xL=function(t,e){var r=t.setup.wheel,n=r.disabled,a=r.wheelDisabled,i=r.touchPadDisabled,o=r.excluded,u=t.isInitialized,f=t.isPanning,h=e.target,p=u&&!f&&!n&&h;if(!p||a&&!e.ctrlKey||i&&e.ctrlKey)return!1;var x=Np(h,o);return!x},vL=function(t){return t?t.deltaY<0?1:-1:0};function yL(t,e){var r=vL(t),n=IM(e,r);return n}function nN(t,e,r){var n=e.getBoundingClientRect(),a=0,i=0;if("clientX"in t)a=(t.clientX-n.left)/r,i=(t.clientY-n.top)/r;else{var o=t.touches[0];a=(o.clientX-n.left)/r,i=(o.clientY-n.top)/r}return(Number.isNaN(a)||Number.isNaN(i))&&console.error("No mouse or touch offset found"),{x:a,y:i}}var _L=function(t,e,r,n,a){var i=t.transformState.scale,o=t.wrapperComponent,u=t.setup,f=u.maxScale,h=u.minScale,p=u.zoomAnimation,x=u.disablePadding,y=p.size,b=p.disabled;if(!o)throw new Error("Wrapper is not mounted");var w=i+e*r,T=n?!1:!b,E=th(Ja(w,3),h,f,y,T&&!x);return E},bL=function(t,e){var r=t.previousWheelEvent,n=t.transformState.scale,a=t.setup,i=a.maxScale,o=a.minScale;return r?n<i||n>o||Math.sign(r.deltaY)!==Math.sign(e.deltaY)||r.deltaY>0&&r.deltaY<e.deltaY||r.deltaY<0&&r.deltaY>e.deltaY||Math.sign(r.deltaY)!==Math.sign(e.deltaY):!1},wL=function(t,e){var r=t.setup.pinch,n=r.disabled,a=r.excluded,i=t.isInitialized,o=e.target,u=i&&!n&&o;if(!u)return!1;var f=Np(o,a);return!f},EL=function(t){var e=t.setup.pinch.disabled,r=t.isInitialized,n=t.pinchStartDistance,a=r&&!e&&n;return!!a},TL=function(t,e,r){var n=r.getBoundingClientRect(),a=t.touches,i=Ja(a[0].clientX-n.left,5),o=Ja(a[0].clientY-n.top,5),u=Ja(a[1].clientX-n.left,5),f=Ja(a[1].clientY-n.top,5);return{x:(i+u)/2/e,y:(o+f)/2/e}},aN=function(t){return Math.sqrt(Math.pow(t.touches[0].pageX-t.touches[1].pageX,2)+Math.pow(t.touches[0].pageY-t.touches[1].pageY,2))},SL=function(t,e){var r=t.pinchStartScale,n=t.pinchStartDistance,a=t.setup,i=a.maxScale,o=a.minScale,u=a.zoomAnimation,f=a.disablePadding,h=u.size,p=u.disabled;if(!r||n===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return t.transformState.scale;var x=e/n,y=x*r;return th(Ja(y,2),o,i,h,!p&&!f)},AL=160,kL=100,NL=function(t,e){var r=t.props,n=r.onWheelStart,a=r.onZoomStart;t.wheelStopEventTimer||(ys(t),Er(hr(t),e,n),Er(hr(t),e,a))},CL=function(t,e){var r=t.props,n=r.onWheel,a=r.onZoom,i=t.contentComponent,o=t.setup,u=t.transformState,f=u.scale,h=o.limitToBounds,p=o.centerZoomedOut,x=o.zoomAnimation,y=o.wheel,b=o.disablePadding,w=o.smooth,T=x.size,E=x.disabled,k=y.step,I=y.smoothStep;if(!i)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var N=yL(e,null),z=w?I*Math.abs(e.deltaY):k,H=_L(t,N,z,!e.ctrlKey);if(f!==H){var q=zo(t,H),A=nN(e,i,f),F=E||T===0||p||b,R=h&&F,M=kp(t,A.x,A.y,H,q,R),O=M.x,j=M.y;t.previousWheelEvent=e,t.setTransformState(H,O,j),Er(hr(t),e,n),Er(hr(t),e,a)}},RL=function(t,e){var r=t.props,n=r.onWheelStop,a=r.onZoomStop;Zx(t.wheelAnimationTimer),t.wheelAnimationTimer=setTimeout(function(){t.mounted&&(Qk(t,e.x,e.y),t.wheelAnimationTimer=null)},kL);var i=bL(t,e);i&&(Zx(t.wheelStopEventTimer),t.wheelStopEventTimer=setTimeout(function(){t.mounted&&(t.wheelStopEventTimer=null,Er(hr(t),e,n),Er(hr(t),e,a))},AL))},sN=function(t){for(var e=0,r=0,n=0;n<2;n+=1)e+=t.touches[n].clientX,r+=t.touches[n].clientY;var a=e/2,i=r/2;return{x:a,y:i}},IL=function(t,e){var r=aN(e);t.pinchStartDistance=r,t.lastDistance=r,t.pinchStartScale=t.transformState.scale,t.isPanning=!1;var n=sN(e);t.pinchLastCenterX=n.x,t.pinchLastCenterY=n.y,ys(t)},DL=function(t,e){var r=t.contentComponent,n=t.pinchStartDistance,a=t.wrapperComponent,i=t.transformState.scale,o=t.setup,u=o.limitToBounds,f=o.centerZoomedOut,h=o.zoomAnimation,p=o.alignmentAnimation,x=h.disabled,y=h.size;if(!(n===null||!r)){var b=TL(e,i,r);if(!(!Number.isFinite(b.x)||!Number.isFinite(b.y))){var w=aN(e),T=SL(t,w),E=sN(e),k=E.x-(t.pinchLastCenterX||0),I=E.y-(t.pinchLastCenterY||0);if(!(T===i&&k===0&&I===0)){t.pinchLastCenterX=E.x,t.pinchLastCenterY=E.y;var N=zo(t,T),z=x||y===0||f,H=u&&z,q=kp(t,b.x,b.y,T,N,H),A=q.x,F=q.y;t.pinchMidpoint=b,t.lastDistance=w;var R=p.sizeX,M=p.sizeY,O=$l(t,R),j=$l(t,M),L=A+k,Ne=F+I,_e=eh(L,Ne,N,u,O,j,a),ne=_e.x,se=_e.y;t.setTransformState(T,ne,se)}}}},OL=function(t){var e=t.pinchMidpoint;t.velocity=null,t.lastDistance=null,t.pinchMidpoint=null,t.pinchStartScale=null,t.pinchStartDistance=null,Qk(t,e?.x,e?.y)},iN=function(t,e){var r=t.props.onZoomStop,n=t.setup.doubleClick.animationTime;Zx(t.doubleClickStopEventTimer),t.doubleClickStopEventTimer=setTimeout(function(){t.doubleClickStopEventTimer=null,Er(hr(t),e,r)},n)},FL=function(t,e){var r=t.props,n=r.onZoomStart,a=r.onZoom,i=t.setup.doubleClick,o=i.animationTime,u=i.animationType;Er(hr(t),e,n),tN(t,o,u,function(){return Er(hr(t),e,a)}),iN(t,e)};function jL(t,e){return t==="toggle"?e===1?1:-1:t==="zoomOut"?-1:1}function PL(t,e){var r=t.setup,n=t.doubleClickStopEventTimer,a=t.transformState,i=t.contentComponent,o=a.scale,u=t.props,f=u.onZoomStart,h=u.onZoom,p=r.doubleClick,x=p.disabled,y=p.mode,b=p.step,w=p.animationTime,T=p.animationType;if(!x&&!n){if(y==="reset")return FL(t,e);if(!i)return console.error("No ContentComponent found");var E=jL(y,t.transformState.scale),k=Zk(t,E,b);if(o!==k){Er(hr(t),e,f);var I=nN(e,i,o),N=Sy(t,k,I.x,I.y);if(!N)return console.error("Error during zoom event. New transformation state was not calculated.");Er(hr(t),e,h),ao(t,N,w,T),iN(t,e)}}}var ML=function(t,e){var r=t.isInitialized,n=t.setup,a=t.wrapperComponent,i=n.doubleClick,o=i.disabled,u=i.excluded,f=e.target,h=a?.contains(f),p=r&&f&&h&&!o;if(!p)return!1;var x=Np(f,u);return!x},LL=(function(){function t(e){var r=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){r.initializeWindowEvents()},this.unmount=function(){r.cleanupWindowEvents()},this.update=function(n){r.props=n,zo(r,r.transformState.scale),r.setup=jT(n)},this.initializeWindowEvents=function(){var n,a,i=rx(),o=(n=r.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,u=o?.defaultView;(a=r.wrapperComponent)===null||a===void 0||a.addEventListener("wheel",r.onWheelPanning,i),u?.addEventListener("mousedown",r.onPanningStart,i),u?.addEventListener("mousemove",r.onPanning,i),u?.addEventListener("mouseup",r.onPanningStop,i),o?.addEventListener("mouseleave",r.clearPanning,i),u?.addEventListener("keyup",r.setKeyUnPressed,i),u?.addEventListener("keydown",r.setKeyPressed,i)},this.cleanupWindowEvents=function(){var n,a,i=rx(),o=(n=r.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,u=o?.defaultView;u?.removeEventListener("mousedown",r.onPanningStart,i),u?.removeEventListener("mousemove",r.onPanning,i),u?.removeEventListener("mouseup",r.onPanningStop,i),o?.removeEventListener("mouseleave",r.clearPanning,i),u?.removeEventListener("keyup",r.setKeyUnPressed,i),u?.removeEventListener("keydown",r.setKeyPressed,i),document.removeEventListener("mouseleave",r.clearPanning,i),ys(r),(a=r.observer)===null||a===void 0||a.disconnect()},this.handleInitializeWrapperEvents=function(n){var a=rx();n.addEventListener("wheel",r.onWheelZoom,a),n.addEventListener("dblclick",r.onDoubleClick,a),n.addEventListener("touchstart",r.onTouchPanningStart,a),n.addEventListener("touchmove",r.onTouchPanning,a),n.addEventListener("touchend",r.onTouchPanningStop,a)},this.handleInitialize=function(n,a){var i=!1,o=r.setup.centerOnInit,u=function(f,h){for(var p=0,x=f;p<x.length;p++){var y=x[p];if(y.target===h)return!0}return!1};r.applyTransformation(),r.onInitCallbacks.forEach(function(f){f(hr(r))}),r.observer=new ResizeObserver(function(f){if(u(f,n)||u(f,a))if(o&&!i){var h=a.offsetWidth,p=a.offsetHeight;(h>0||p>0)&&(i=!0,r.setCenter())}else ys(r),zo(r,r.transformState.scale),Ty(r,0)}),r.observer.observe(n),r.observer.observe(a)},this.onWheelZoom=function(n){var a=r.setup.disabled;if(!a){var i=xL(r,n);if(i){var o=r.isPressingKeys(r.setup.wheel.activationKeys);o&&(NL(r,n),CL(r,n),RL(r,n))}}},this.onWheelPanning=function(n){var a=r.setup,i=a.disabled,o=a.wheel,u=a.panning;if(!(!r.wrapperComponent||!r.contentComponent||i||!o.wheelDisabled||u.disabled||!u.wheelPanning||n.ctrlKey)){n.preventDefault(),n.stopPropagation();var f=r.transformState,h=f.positionX,p=f.positionY,x=h-n.deltaX,y=p-n.deltaY,b=u.lockAxisX?h:x,w=u.lockAxisY?p:y,T=r.setup.alignmentAnimation,E=T.sizeX,k=T.sizeY,I=$l(r,E),N=$l(r,k);b===h&&w===p||Kk(r,b,w,I,N)}},this.onPanningStart=function(n){var a=r.setup.disabled,i=r.props.onPanningStart;if(!a){var o=CT(r,n);if(o){var u=r.isPressingKeys(r.setup.panning.activationKeys);u&&(n.button===0&&!r.setup.panning.allowLeftClickPan||n.button===1&&!r.setup.panning.allowMiddleClickPan||n.button===2&&!r.setup.panning.allowRightClickPan||(n.preventDefault(),n.stopPropagation(),ys(r),DT(r,n),Er(hr(r),n,i)))}}},this.onPanning=function(n){var a=r.setup.disabled,i=r.props.onPanning;if(!a){var o=RT(r);if(o){var u=r.isPressingKeys(r.setup.panning.activationKeys);u&&(n.preventDefault(),n.stopPropagation(),OT(r,n.clientX,n.clientY),Er(hr(r),n,i))}}},this.onPanningStop=function(n){var a=r.props.onPanningStop;r.isPanning&&(sL(r),Er(hr(r),n,a))},this.onPinchStart=function(n){var a=r.setup.disabled,i=r.props,o=i.onPinchingStart,u=i.onZoomStart;if(!a){var f=wL(r,n);f&&(IL(r,n),ys(r),Er(hr(r),n,o),Er(hr(r),n,u))}},this.onPinch=function(n){var a=r.setup.disabled,i=r.props,o=i.onPinching,u=i.onZoom;if(!a){var f=EL(r);f&&(n.preventDefault(),n.stopPropagation(),DL(r,n),Er(hr(r),n,o),Er(hr(r),n,u))}},this.onPinchStop=function(n){var a=r.props,i=a.onPinchingStop,o=a.onZoomStop;r.pinchStartScale&&(OL(r),Er(hr(r),n,i),Er(hr(r),n,o))},this.onTouchPanningStart=function(n){var a=r.setup.disabled,i=r.props.onPanningStart;if(!a){var o=CT(r,n);if(o){var u=r.lastTouch&&+new Date-r.lastTouch<200&&n.touches.length===1;if(!u){r.lastTouch=+new Date,ys(r);var f=n.touches,h=f.length===1,p=f.length===2;h&&(ys(r),DT(r,n),Er(hr(r),n,i)),p&&r.onPinchStart(n)}}}},this.onTouchPanning=function(n){var a=r.setup.disabled,i=r.props.onPanning;if(r.isPanning&&n.touches.length===1){if(a)return;var o=RT(r);if(!o)return;n.preventDefault(),n.stopPropagation();var u=n.touches[0];OT(r,u.clientX,u.clientY),Er(hr(r),n,i)}else n.touches.length>1&&r.onPinch(n)},this.onTouchPanningStop=function(n){r.onPanningStop(n),r.onPinchStop(n)},this.onDoubleClick=function(n){var a=r.setup.disabled;if(!a){var i=ML(r,n);i&&PL(r,n)}},this.clearPanning=function(n){r.isPanning&&r.onPanningStop(n)},this.setKeyPressed=function(n){r.pressedKeys[n.key]=!0},this.setKeyUnPressed=function(n){r.pressedKeys[n.key]=!1},this.isPressingKeys=function(n){return n.length?!!n.find(function(a){return r.pressedKeys[a]}):!0},this.setTransformState=function(n,a,i){var o=r.props.onTransformed;if(!Number.isNaN(n)&&!Number.isNaN(a)&&!Number.isNaN(i)){n!==r.transformState.scale&&(r.transformState.previousScale=r.transformState.scale,r.transformState.scale=n),r.transformState.positionX=a,r.transformState.positionY=i,r.applyTransformation();var u=hr(r);r.onChangeCallbacks.forEach(function(f){return f(u)}),Er(u,{scale:n,positionX:a,positionY:i},o)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(r.wrapperComponent&&r.contentComponent){var n=rN(r.transformState.scale,r.wrapperComponent,r.contentComponent);r.setTransformState(n.scale,n.positionX,n.positionY)}},this.handleTransformStyles=function(n,a,i){return r.props.customTransform?r.props.customTransform(n,a,i):pL(n,a,i)},this.applyTransformation=function(){if(!(!r.mounted||!r.contentComponent)){var n=r.transformState,a=n.scale,i=n.positionX,o=n.positionY,u=r.handleTransformStyles(i,o,a);r.contentComponent.style.transform=u}},this.getContext=function(){return hr(r)},this.onChange=function(n){return r.onChangeCallbacks.has(n)||r.onChangeCallbacks.add(n),function(){r.onChangeCallbacks.delete(n)}},this.onInit=function(n){return r.onInitCallbacks.has(n)||r.onInitCallbacks.add(n),function(){r.onInitCallbacks.delete(n)}},this.init=function(n,a){r.cleanupWindowEvents(),r.wrapperComponent=n,r.contentComponent=a,zo(r,r.transformState.scale),r.handleInitializeWrapperEvents(n),r.handleInitialize(n,a),r.initializeWindowEvents(),r.isInitialized=!0;var i=hr(r);Er(i,void 0,r.props.onInit)},this.props=e,this.setup=jT(this.props),this.transformState=Jk(this.props)}return t})(),Ay=$s.createContext(null),BL=function(t,e){return typeof t=="function"?t(e):t},VL=$s.forwardRef(function(t,e){var r=ee.useRef(new LL(t)).current,n=BL(t.children,Jx(r));return ee.useImperativeHandle(e,function(){return Jx(r)},[r]),ee.useEffect(function(){r.update(t)},[r,t]),$s.createElement(Ay.Provider,{value:r},n)});$s.forwardRef(function(t,e){var r=ee.useRef(null),n=ee.useContext(Ay);return ee.useEffect(function(){return n.onChange(function(a){if(r.current){var i=0,o=0;r.current.style.transform=n.handleTransformStyles(i,o,1/a.instance.transformState.scale)}})},[n]),$s.createElement("div",Vl({},t,{ref:gL([r,e])}))});function UL(t,e){e===void 0&&(e={});var r=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}var zL=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,PT={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};UL(zL);var HL=function(t){var e=t.children,r=t.wrapperClass,n=r===void 0?"":r,a=t.contentClass,i=a===void 0?"":a,o=t.wrapperStyle,u=t.contentStyle,f=t.wrapperProps,h=f===void 0?{}:f,p=t.contentProps,x=p===void 0?{}:p,y=ee.useContext(Ay),b=y.init,w=y.cleanupWindowEvents,T=ee.useRef(null),E=ee.useRef(null);return ee.useEffect(function(){var k=T.current,I=E.current;return k!==null&&I!==null&&b&&b?.(k,I),function(){w?.()}},[]),$s.createElement("div",Vl({},h,{ref:T,className:"".concat(Qx.wrapperClass," ").concat(PT.wrapper," ").concat(n),style:o}),$s.createElement("div",Vl({},x,{ref:E,className:"".concat(Qx.contentClass," ").concat(PT.content," ").concat(i),style:u}),e))};const xs=({isOpen:t,onClose:e,title:r,children:n})=>(ee.useEffect(()=>{const a=i=>{i.key==="Escape"&&e()};return t&&window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t,e]),t?m.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/90 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:m.jsxs("div",{className:`\r
            bg-white w-full max-w-lg rounded-lg overflow-hidden relative \r
            border-4 border-slate-900 \r
            shadow-[8px_8px_0px_0px_#FACC15] \r
            animate-in zoom-in-95 duration-300\r
        `,onClick:a=>a.stopPropagation(),children:[m.jsxs("div",{className:"bg-slate-900 p-4 border-b-4 border-slate-900 flex justify-between items-center relative overflow-hidden",children:[m.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-slate-800 rotate-45 transform translate-x-10 -translate-y-10"}),m.jsxs("div",{className:"flex items-center gap-2 relative z-10",children:[m.jsx(jm,{className:"text-yellow-400 fill-yellow-400",size:24}),m.jsx("h3",{className:"text-xl font-black italic tracking-wider text-yellow-400 uppercase transform -skew-x-6",children:r})]}),m.jsx("button",{onClick:e,className:`\r
                    relative z-10 \r
                    bg-red-600 hover:bg-red-700 text-white \r
                    p-1.5 rounded border-2 border-white \r
                    transition-transform hover:scale-110 active:scale-95\r
                    shadow-lg\r
                `,children:m.jsx(ua,{size:20,strokeWidth:3})})]}),m.jsx("div",{className:"p-6 max-h-[80vh] overflow-y-auto bg-white",children:n}),m.jsxs("div",{className:"h-2 bg-yellow-400 border-t-2 border-slate-900 flex",children:[m.jsx("div",{className:"w-1/3 bg-red-600 border-r-2 border-slate-900"}),m.jsx("div",{className:"w-1/3 bg-white border-r-2 border-slate-900"}),m.jsx("div",{className:"w-1/3 bg-blue-600"})]})]})}):null);function qL({currentUser:t,onSubmit:e,onCancel:r}){const[n,a]=ee.useState(t?.name||""),i=o=>{if(o.preventDefault(),!n.trim())return alert("");if(n.trim()===t?.name)return alert("");e(n)};return m.jsxs("form",{onSubmit:i,className:"space-y-4 font-sans text-slate-800",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-black text-slate-700 mb-1",children:" (Nickname)"}),m.jsxs("div",{className:"relative",children:[m.jsx(J0,{size:16,className:"absolute left-3 top-3 text-slate-400"}),m.jsx("input",{type:"text",value:n,onChange:o=>a(o.target.value),className:"w-full border-2 border-slate-900 rounded p-2 pl-9 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 text-slate-900",placeholder:"",autoFocus:!0})]}),m.jsx("p",{className:"text-xs text-slate-400 mt-1 pl-1",children:"* "})]}),m.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-slate-100",children:[m.jsxs("button",{type:"button",onClick:r,className:"px-4 py-2 rounded border-2 border-slate-300 text-slate-600 font-bold hover:bg-slate-100 transition-all",children:[m.jsx(ua,{size:16,className:"inline mr-1"})," "]}),m.jsxs("button",{type:"submit",className:"px-4 py-2 bg-slate-900 text-yellow-400 rounded font-black border-2 border-slate-900 hover:bg-slate-800 shadow-[2px_2px_0px_0px_#FACC15] active:translate-y-0.5 active:shadow-none transition-all",children:[m.jsx(Ui,{size:16,className:"inline mr-1"})," "]})]})]})}const GL=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=500,u=500;let f=a.width,h=a.height;f>h?f>o&&(h*=o/f,f=o):h>u&&(f*=u/h,h=u),i.width=f,i.height=h,i.getContext("2d").drawImage(a,0,0,f,h),e(i.toDataURL("image/jpeg",.7))}}});function WL({currentUser:t,onSubmit:e}){const[r,n]=ee.useState(t?.avatar||""),[a,i]=ee.useState(null),o=async f=>{f.target.files&&f.target.files[0]&&i(await GL(f.target.files[0]))},u=()=>{const f=a||r;f&&e(f)};return m.jsxs("div",{className:"space-y-6",children:[m.jsx("div",{className:"flex justify-center mb-4",children:m.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden border-4 border-orange-100 shadow-md",children:m.jsx("img",{src:a||r||t?.avatar,className:"w-full h-full object-cover",alt:"avatar",onError:f=>f.target.src=`https://api.dicebear.com/7.x/avataaars/svg?seed=${t?.name}&backgroundColor=ffdfbf`})})}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-stone-600 text-sm font-bold flex items-center gap-2",children:[m.jsx(K0,{size:16})," "]}),m.jsx("input",{type:"text",className:"border border-stone-200 rounded-lg px-3 py-2 text-sm",placeholder:"",value:r,onChange:f=>{n(f.target.value),i(null)}})]}),m.jsxs("div",{className:"relative",children:[m.jsx("div",{className:"absolute inset-0 flex items-center",children:m.jsx("span",{className:"w-full border-t border-stone-200"})}),m.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:m.jsx("span",{className:"bg-white px-2 text-stone-400",children:""})})]}),m.jsxs("div",{className:"flex flex-col gap-2",children:[m.jsxs("label",{className:"text-stone-600 text-sm font-bold flex items-center gap-2",children:[m.jsx(by,{size:16})," "]}),m.jsx("input",{type:"file",accept:"image/*",onChange:o,className:"block w-full text-sm text-stone-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-bold file:bg-orange-50 file:text-orange-600 hover:file:bg-orange-100 cursor-pointer"})]})]}),m.jsx("button",{className:"w-full py-2 bg-orange-400 text-white rounded-lg font-bold hover:bg-orange-500",onClick:u,children:""})]})}function XL({onSubmit:t}){const[e,r]=ee.useState("");return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsx("label",{className:"text-stone-600 text-sm font-bold tracking-wide",children:""}),m.jsx("input",{type:"password",className:"border border-stone-200 rounded-lg px-3 py-2",placeholder:"",value:e,onChange:n=>r(n.target.value)})]}),m.jsx("button",{className:"w-full py-2 bg-orange-400 text-white rounded-lg font-bold hover:bg-orange-500 disabled:opacity-50",onClick:()=>t(e),disabled:!e,children:""})]})}const YL=["https://pbs.twimg.com/media/G8MiWocaEAAYWbC?format=jpg&name=large","https://pbs.twimg.com/media/G8MiYLNbIAA_YJg?format=jpg&name=large","https://pbs.twimg.com/media/G8MiZktakAAvzHC?format=jpg&name=large","https://pbs.twimg.com/media/G8Mis25acAAqfys?format=jpg&name=large","https://pbs.twimg.com/media/G8MivlbakAA4A73?format=jpg&name=large","https://pbs.twimg.com/media/G8MixoiaAAAyEGE?format=jpg&name=large","https://pbs.twimg.com/media/G8Mi4L9b0AAPNmS?format=jpg&name=large","https://pbs.twimg.com/media/G8Mi6X_bwAAkrMd?format=jpg&name=large","https://pbs.twimg.com/media/G8MjC5vbgAE_hJg?format=jpg&name=large","https://pbs.twimg.com/media/G8MjIZ0bwAAEAhT?format=jpg&name=large"],Ld=250;function $L({currentUser:t,onImageClick:e}){const[r,n]=ee.useState([]),[a,i]=ee.useState({exchangeRate:.23,totalShippingJPY:0,status:"",secondPayment:{weights:{},boxWeight:0}}),[o,u]=ee.useState(!0);ee.useEffect(()=>{u(!0);const b=Tt(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),w=Tr(b,T=>{if(T.exists()){const E=T.data(),I=(E.orders||[]).sort((N,z)=>{const H=N.buyer.localeCompare(z.buyer);return H!==0?H:N.id-z.id});n(I),i({exchangeRate:.24,totalShippingJPY:0,status:"",secondPayment:{weights:{},boxWeight:0},...E.settings})}u(!1)});return()=>w()},[]);const f=ee.useMemo(()=>r.reduce((b,w)=>w.isBought?b+w.quantity:b,0),[r]),h=ee.useMemo(()=>f>0?a.totalShippingJPY/f:0,[f,a.totalShippingJPY]),p=parseFloat(a.secondPayment?.boxWeight||0),x=f>0?p*Ld/f:0,y=ee.useMemo(()=>{const b={};return r.forEach(w=>{if(b[w.buyer]||(b[w.buyer]={items:[],totalItemPriceJPY:0,totalShippingShareJPY:0,totalSecondPayTWD:0,count:0}),w.isBought){const T=w.price*w.quantity,E=h*w.quantity,k=parseFloat(a.secondPayment?.weights?.[w.name]||0),N=(k*Ld+x)*w.quantity;b[w.buyer].items.push({...w,weight:k,secondPaySubtotal:N}),b[w.buyer].totalItemPriceJPY+=T,b[w.buyer].totalShippingShareJPY+=E,b[w.buyer].totalSecondPayTWD+=N,b[w.buyer].count+=w.quantity}}),b},[r,h,a.secondPayment,x]);return o?m.jsx("div",{className:"p-10 text-center font-bold text-slate-500 uppercase tracking-widest italic animate-pulse",children:"Scanning Intel..."}):m.jsxs("div",{className:"space-y-8 pb-20",children:[m.jsx("div",{className:"bg-slate-900 text-yellow-400 p-6 rounded-xl border-4 border-slate-900 shadow-[8px_8px_0px_0px_#0f172a] relative overflow-hidden",children:m.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-3xl font-black italic mb-2",children:"JS ONLINE "}),m.jsxs("div",{className:"space-y-1 font-bold text-white text-sm",children:[m.jsxs("p",{className:"flex items-center gap-2",children:[m.jsx(Pk,{size:16,className:"text-yellow-400"})," 12/17 11:00  12/21 16:00"]}),m.jsxs("a",{href:"https://jumpshop-online.com/collections/jf2026",target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 underline hover:text-yellow-300",children:[m.jsx(Il,{size:16})," "]})]})]}),m.jsx("div",{className:"bg-white p-4 rounded-lg border-4 border-slate-700 text-slate-900 w-full md:w-auto shadow-lg",children:m.jsxs("div",{className:"flex flex-col gap-3",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"font-black text-xs uppercase bg-slate-200 px-1 rounded tracking-tighter",children:"Mission Status"}),m.jsx("span",{className:"font-black text-purple-600 italic uppercase",children:a.status})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] font-black text-slate-500 block uppercase tracking-tighter",children:"Exchange Rate"}),m.jsxs("div",{className:"flex items-center font-black",children:[m.jsx(py,{size:14,className:"text-slate-400"}),m.jsx("span",{children:a.exchangeRate})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] font-black text-slate-500 block uppercase tracking-tighter",children:"Total PCS"}),m.jsxs("div",{className:"flex items-center font-black text-slate-900",children:[m.jsx(Ap,{size:14,className:"text-slate-400 mr-1"}),m.jsx("span",{children:f})]})]})]})]})})]})}),m.jsxs("div",{className:"bg-white p-4 rounded-xl border-2 border-slate-200",children:[m.jsxs("h4",{className:"font-black text-sm text-slate-500 mb-3 flex items-center gap-2",children:[m.jsx(wp,{size:16}),"  ()"]}),m.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:YL.map((b,w)=>m.jsx("div",{onClick:()=>e(b),className:"w-20 h-20 shrink-0 bg-white rounded border border-slate-300 overflow-hidden hover:scale-105 transition-transform cursor-pointer relative group shadow-sm",children:m.jsx("img",{src:b,alt:`Item ${w}`,className:"w-full h-full object-cover"})},w))})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(y).map(([b,w])=>{const T=w.totalItemPriceJPY+w.totalShippingShareJPY,E=Math.ceil(T*a.exchangeRate),k=E+Math.round(w.totalSecondPayTWD);return m.jsxs("div",{className:"bg-white rounded-xl border-4 border-slate-900 p-5 shadow-[4px_4px_0px_0px_#6b21a8] relative overflow-hidden group hover:-translate-y-1 transition-transform",children:[m.jsxs("div",{className:"flex justify-between items-start mb-4 border-b-2 border-slate-100 pb-2",children:[m.jsx("h3",{className:"text-2xl font-black italic text-slate-900 tracking-tighter",children:b}),m.jsxs("div",{className:"text-right",children:[m.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Grand Total"}),m.jsxs("span",{className:"text-3xl font-black text-purple-600",children:["NT$ ",k.toLocaleString()]})]})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-1 text-sm font-bold text-slate-600",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsxs("span",{children:[" (",w.count,")"]}),m.jsxs("span",{children:["",w.totalItemPriceJPY.toLocaleString()]})]}),m.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[m.jsx("span",{children:""}),m.jsxs("span",{children:["",w.totalShippingShareJPY.toFixed(0)]})]}),m.jsxs("div",{className:"flex justify-between text-slate-900 border-t border-slate-100 pt-1",children:[m.jsx("span",{children:""}),m.jsxs("span",{className:"font-black",children:["NT$ ",E.toLocaleString()]})]})]}),m.jsxs("div",{className:"bg-blue-50/50 p-2 rounded-lg border border-blue-100 space-y-1",children:[m.jsxs("div",{className:"flex justify-between text-sm font-black text-blue-800",children:[m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(vy,{size:14})," "]}),m.jsxs("span",{children:["NT$ ",Math.round(w.totalSecondPayTWD).toLocaleString()]})]}),m.jsx("p",{className:"text-[9px] text-blue-400 leading-tight",children:" + "})]})]}),m.jsxs("div",{className:"mt-4 space-y-2",children:[m.jsxs("details",{className:"group/detail border-t border-slate-100 pt-2",children:[m.jsxs("summary",{className:"text-[11px] font-black text-slate-500 cursor-pointer hover:text-slate-900 list-none flex justify-between items-center uppercase tracking-tighter",children:[m.jsx("span",{children:" ()"}),m.jsx(dy,{size:12,className:"group-open/detail:rotate-180 transition-transform"})]}),m.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-y-auto pr-1",children:w.items.map((I,N)=>m.jsxs("div",{className:"flex justify-between text-[11px] font-bold text-slate-600 bg-slate-50 p-1.5 rounded border border-slate-100",children:[m.jsxs("span",{className:"truncate w-2/3",children:[I.ip," ",I.name," x",I.quantity]}),m.jsxs("span",{className:"font-mono",children:["",I.price*I.quantity]})]},N))})]}),m.jsxs("details",{className:"group/weight border-t border-slate-100 pt-2",children:[m.jsxs("summary",{className:"text-[11px] font-black text-blue-500 cursor-pointer hover:text-blue-700 list-none flex justify-between items-center uppercase tracking-tighter",children:[m.jsx("span",{children:" ()"}),m.jsx(Q0,{size:12,className:"group-open/weight:rotate-180 transition-transform"})]}),m.jsxs("div",{className:"mt-2 space-y-1 bg-blue-50/30 p-2 rounded-lg border border-blue-100",children:[w.items.map((I,N)=>m.jsxs("div",{className:"flex justify-between text-[10px] font-bold text-blue-600/80",children:[m.jsxs("span",{className:"truncate w-2/3",children:[I.name," (",I.weight,"kg)"]}),m.jsxs("span",{className:"font-mono",children:["NT$ ",Math.round(I.secondPaySubtotal)]})]},N)),m.jsxs("div",{className:"flex justify-between text-[10px] font-black text-blue-400 border-t border-blue-100 mt-1 pt-1 italic",children:[m.jsx("span",{children:" ()"}),m.jsxs("span",{children:["NT$ ",x.toFixed(1)]})]})]})]})]})]},b)})}),m.jsxs("div",{className:"max-w-xl mx-auto bg-slate-100 p-4 rounded-xl border-2 border-dashed border-slate-300 flex items-start gap-3",children:[m.jsx(lc,{size:20,className:"text-slate-400 shrink-0 mt-1"}),m.jsxs("div",{className:"text-[12px] font-bold text-slate-500 leading-relaxed",children:[m.jsx("p",{className:"text-slate-900 uppercase tracking-widest mb-1",children:"Calculation Protocol:"}),m.jsx("p",{children:"1.  = ( + )   ()"}),m.jsxs("p",{children:["2.  = [(  ",Ld,") + (  ",Ld," / )]  "]}),m.jsx("p",{children:"3.  =  + "})]})]})]})}const KL=["https://pbs.twimg.com/media/G8MiWocaEAAYWbC?format=jpg&name=large","https://pbs.twimg.com/media/G8MiYLNbIAA_YJg?format=jpg&name=large","https://pbs.twimg.com/media/G8MiZktakAAvzHC?format=jpg&name=large"],Bd=250;function QL({currentUser:t,onImageClick:e}){const[r,n]=ee.useState([]),[a,i]=ee.useState({exchangeRate:.207,totalShippingJPY:0,status:"",secondPayment:{weights:{},boxWeight:0}}),[o,u]=ee.useState(!0),[f,h]=ee.useState("");ee.useEffect(()=>{u(!0);const E=Tt(Ke,"artifacts","default-app-id","public","data","jf26_post_calc_data","main"),k=Tr(E,I=>{if(I.exists()){const N=I.data(),H=(N.orders||[]).sort((q,A)=>q.buyer.localeCompare(A.buyer));n(H),i({exchangeRate:.207,totalShippingJPY:0,status:"",secondPayment:{weights:{},boxWeight:0},...N.settings})}u(!1)});return()=>k()},[]);const p=ee.useMemo(()=>r.reduce((E,k)=>k.isBought?E+k.quantity:E,0),[r]),x=ee.useMemo(()=>p>0?a.totalShippingJPY/p:0,[p,a.totalShippingJPY]),y=parseFloat(a.secondPayment?.boxWeight||0),b=p>0?y*Bd/p:0,w=ee.useMemo(()=>{const E={};return r.forEach(k=>{if(E[k.buyer]||(E[k.buyer]={items:[],totalItemPriceJPY:0,totalShippingShareJPY:0,totalSecondPayTWD:0,count:0}),k.isBought){const I=k.price*k.quantity,N=x*k.quantity,z=parseFloat(a.secondPayment?.weights?.[k.name]||0),q=(z*Bd+b)*k.quantity;E[k.buyer].items.push({...k,weight:z,secondPaySubtotal:q}),E[k.buyer].totalItemPriceJPY+=I,E[k.buyer].totalShippingShareJPY+=N,E[k.buyer].totalSecondPayTWD+=q,E[k.buyer].count+=k.quantity}}),E},[r,x,a.secondPayment,b]),T=ee.useMemo(()=>Object.entries(w).filter(([E])=>E.toLowerCase().includes(f.toLowerCase())),[w,f]);return o?m.jsx("div",{className:"p-10 text-center font-bold text-slate-500 italic animate-pulse",children:"Syncing Post-Order Intel..."}):m.jsxs("div",{className:"space-y-8 pb-20",children:[m.jsx("div",{className:"bg-indigo-900 text-white p-6 rounded-xl border-4 border-slate-900 shadow-[8px_8px_0px_0px_#0f172a] relative overflow-hidden",children:m.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-3xl font-black italic mb-2",children:"JF26 "}),m.jsxs("div",{className:"space-y-1 font-bold text-white text-sm",children:[m.jsxs("p",{className:"flex items-center gap-2",children:[m.jsx(Pk,{size:16,className:"text-yellow-400"})," 12/22 09:00 "]}),m.jsxs("a",{href:"https://jumpshop-online.com/collections/jsol%EF%BD%B0jf2026",target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 underline hover:text-yellow-300 transition-colors",children:[m.jsx(Il,{size:16})," "]})]})]}),m.jsx("div",{className:"bg-white p-4 rounded-lg border-4 border-slate-700 text-slate-900 w-full md:w-auto shadow-lg",children:m.jsxs("div",{className:"flex flex-col gap-3",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsx("span",{className:"font-black text-xs uppercase bg-slate-200 px-1 rounded tracking-tighter text-slate-800",children:"Mission Status"}),m.jsx("span",{className:"font-black text-indigo-600 italic uppercase",children:a.status})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] font-black text-slate-400 block uppercase tracking-tighter",children:"Exchange Rate"}),m.jsxs("div",{className:"flex items-center font-black text-indigo-600",children:[m.jsx(py,{size:14}),m.jsx("span",{children:a.exchangeRate})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"text-[10px] font-black text-slate-400 block uppercase tracking-tighter",children:"Total Items"}),m.jsxs("div",{className:"flex items-center font-black text-slate-900",children:[m.jsx(Ap,{size:14,className:"text-slate-400 mr-1"}),m.jsx("span",{children:p})]})]})]})]})})]})}),m.jsxs("div",{className:"bg-white p-4 rounded-xl border-2 border-slate-200",children:[m.jsxs("h4",{className:"font-black text-sm text-slate-500 mb-3 flex items-center gap-2",children:[m.jsx(wp,{size:16})," "]}),m.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:KL.map((E,k)=>m.jsx("div",{onClick:()=>e(E),className:"w-20 h-20 shrink-0 rounded border border-slate-300 overflow-hidden hover:scale-105 transition-transform cursor-pointer shadow-sm",children:m.jsx("img",{src:E,alt:"Item",className:"w-full h-full object-cover"})},k))})]}),m.jsxs("div",{className:"flex bg-white rounded-xl border-4 border-slate-900 overflow-hidden shadow-[4px_4px_0px_0px_#0f172a]",children:[m.jsx("div",{className:"p-3 bg-slate-100 border-r-4 border-slate-900 text-slate-900",children:m.jsx(yy,{size:20,strokeWidth:3})}),m.jsx("input",{className:"w-full p-3 font-bold outline-none text-lg",placeholder:"...",value:f,onChange:E=>h(E.target.value)})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:T.map(([E,k])=>{const I=k.totalItemPriceJPY+k.totalShippingShareJPY,N=Math.ceil(I*a.exchangeRate),z=N+Math.round(k.totalSecondPayTWD);return m.jsxs("div",{className:"bg-white rounded-xl border-4 border-slate-900 p-5 shadow-[4px_4px_0px_0px_#4f46e5] relative overflow-hidden group hover:-translate-y-1 transition-transform",children:[m.jsxs("div",{className:"flex justify-between items-start mb-4 border-b-2 border-slate-100 pb-2",children:[m.jsx("h3",{className:"text-2xl font-black italic text-slate-900 tracking-tighter",children:E}),m.jsxs("div",{className:"text-right",children:[m.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Grand Total"}),m.jsxs("span",{className:"text-3xl font-black text-indigo-600",children:["NT$ ",z.toLocaleString()]})]})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"space-y-1 text-sm font-bold text-slate-600",children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsxs("span",{children:[" (",k.count,")"]}),m.jsxs("span",{children:["",k.totalItemPriceJPY.toLocaleString()]})]}),m.jsxs("div",{className:"flex justify-between text-xs text-slate-400 font-medium",children:[m.jsx("span",{children:""}),m.jsxs("span",{children:["",k.totalShippingShareJPY.toFixed(0)]})]}),m.jsxs("div",{className:"flex justify-between text-slate-900 border-t border-slate-100 pt-1",children:[m.jsx("span",{children:""}),m.jsxs("span",{className:"font-black",children:["NT$ ",N.toLocaleString()]})]})]}),m.jsxs("div",{className:"bg-indigo-50 p-2 rounded-lg border border-indigo-100 space-y-1",children:[m.jsxs("div",{className:"flex justify-between text-sm font-black text-indigo-800",children:[m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(vy,{size:14})," "]}),m.jsxs("span",{children:["NT$ ",Math.round(k.totalSecondPayTWD).toLocaleString()]})]}),m.jsx("p",{className:"text-[9px] text-indigo-400 leading-tight italic",children:" + "})]})]}),m.jsxs("div",{className:"mt-4 space-y-2",children:[m.jsxs("details",{className:"group/detail border-t border-slate-100 pt-2",children:[m.jsxs("summary",{className:"text-[11px] font-black text-slate-500 cursor-pointer hover:text-slate-900 list-none flex justify-between items-center uppercase tracking-tighter",children:[m.jsx("span",{children:" ()"}),m.jsx(dy,{size:12,className:"group-open/detail:rotate-180 transition-transform"})]}),m.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-y-auto pr-1",children:k.items.map((H,q)=>m.jsxs("div",{className:"flex justify-between text-[11px] font-bold text-slate-600 bg-slate-50 p-1.5 rounded border border-slate-100",children:[m.jsxs("span",{className:"truncate w-2/3",children:[H.name," x",H.quantity]}),m.jsxs("span",{className:"font-mono",children:["",H.price*H.quantity]})]},q))})]}),m.jsxs("details",{className:"group/weight border-t border-slate-100 pt-2",children:[m.jsxs("summary",{className:"text-[11px] font-black text-indigo-500 cursor-pointer hover:text-indigo-700 list-none flex justify-between items-center uppercase tracking-tighter",children:[m.jsx("span",{children:" ()"}),m.jsx(Q0,{size:12,className:"group-open/weight:rotate-180 transition-transform"})]}),m.jsxs("div",{className:"mt-2 space-y-1 bg-indigo-50/30 p-2 rounded-lg border border-indigo-100",children:[k.items.map((H,q)=>m.jsxs("div",{className:"flex justify-between text-[10px] font-bold text-indigo-600/80",children:[m.jsxs("span",{className:"truncate w-2/3",children:[H.name," (",H.weight||0,"kg)"]}),m.jsxs("span",{className:"font-mono",children:["NT$ ",Math.round(H.secondPaySubtotal)]})]},q)),m.jsxs("div",{className:"flex justify-between text-[10px] font-black text-indigo-400 border-t border-indigo-100 mt-1 pt-1 italic",children:[m.jsx("span",{children:" ()"}),m.jsxs("span",{children:["NT$ ",b.toFixed(1)]})]})]})]})]})]},E)})}),m.jsxs("div",{className:"max-w-xl mx-auto bg-slate-100 p-4 rounded-xl border-2 border-dashed border-slate-300 flex items-start gap-3",children:[m.jsx(lc,{size:20,className:"text-slate-400 shrink-0 mt-1"}),m.jsxs("div",{className:"text-[12px] font-bold text-slate-500 leading-relaxed",children:[m.jsx("p",{className:"text-slate-900 uppercase tracking-widest mb-1 font-black underline",children:"Calculation Protocol (Post-Order):"}),m.jsx("p",{children:"1.  = ( + )  "}),m.jsxs("p",{children:["2.  = [(  ",Bd,") + (  ",Bd," / )]  "]}),m.jsx("p",{children:"3.  =  + "})]})]})]})}const lN={titi:"",xiaomei:"",heng:"",baobao:"",yeye:"",Sjie:"S",qiaoyu:"",teacher:"",ann:"",Aurora:"Aurora"},Vd=250;function JL({currentUser:t}){const[e,r]=ee.useState("vendors"),[n,a]=ee.useState(!1),[i,o]=ee.useState(null),[u,f]=ee.useState(null),[h,p]=ee.useState(0),[x,y]=ee.useState(0),[b,w]=ee.useState(0),T=h+x+b,E=t?.id==="yeye",k=t?.isMember;ee.useEffect(()=>{if(!t?.id)return;const N=lN[t.id]||t.name,z=Tr(Tt(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),A=>{if(A.exists()){const F=A.data(),R=F.orders||[],M=F.settings||{},O=M.secondPayment||{weights:{},boxWeight:0},j=R.reduce((se,Ee)=>Ee.isBought?se+Ee.quantity:se,0),L=j>0?M.totalShippingJPY/j:0,Ne=j>0?parseFloat(O.boxWeight||0)*Vd/j:0,ne=R.filter(se=>se.buyer===N&&se.isBought).reduce((se,Ee)=>{let ie=0;if(Ee.paymentStatus!==""){const Ve=Number(Ee.price)*Number(Ee.quantity)+L*Ee.quantity;ie+=Math.ceil(Ve*(M.exchangeRate||.24))}if(Ee.shippingPaymentStatus!==""){const Ve=parseFloat(O.weights[Ee.name]||0);ie+=Math.ceil(Ve*Vd*Ee.quantity+Ne*Ee.quantity)}return se+ie},0);p(ne)}}),H=Tr(Wt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders"),async A=>{const F=await _9(Tt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_settings","main")),R=F.exists()?F.data():{totalDomesticShipping:0,exchangeRate:.24},M=A.docs.map(Ne=>Ne.data());let O=0;M.forEach(Ne=>Ne.items?.forEach(_e=>{_e.status==="WON"&&(O+=Number(_e.qty))}));const j=O>0?R.totalDomesticShipping/O:0;let L=0;M.forEach(Ne=>Ne.items?.forEach(_e=>{const ne=_e.assignments?.find(se=>se.user===N);if(_e.status==="WON"&&ne){const se=Number(ne.qty);L+=Number(_e.price)*se+j*se}})),y(Math.ceil(L*(R.exchangeRate||.24)))}),q=Tr(Tt(Ke,"artifacts","default-app-id","public","data","jf26_post_calc_data","main"),A=>{if(A.exists()){const F=A.data(),R=F.orders||[],M=F.settings||{},O=M.secondPayment||{weights:{},boxWeight:0},j=R.reduce((se,Ee)=>Ee.isBought?se+Ee.quantity:se,0),L=j>0?M.totalShippingJPY/j:0,Ne=j>0?parseFloat(O.boxWeight||0)*Vd/j:0,ne=R.filter(se=>se.buyer===N&&se.isBought).reduce((se,Ee)=>{let ie=0;if(Ee.paymentStatus!==""){const Ve=Number(Ee.price)*Number(Ee.quantity)+L*Ee.quantity;ie+=Math.ceil(Ve*(M.exchangeRate||.207))}if(Ee.shippingPaymentStatus!==""){const Ve=parseFloat(O.weights[Ee.name]||0);ie+=Math.ceil(Ve*Vd*Ee.quantity+Ne*Ee.quantity)}return se+ie},0);w(ne)}});return()=>{z(),H(),q()}},[t]);const I=()=>{localStorage.removeItem("app_user_id"),window.location.reload()};return m.jsxs("div",{className:"min-h-screen bg-slate-50 font-sans pb-20 selection:bg-yellow-400 selection:text-black",children:[m.jsx("header",{className:"sticky top-0 z-30 bg-slate-900 border-b-4 border-yellow-400 px-4 py-3 shadow-md",children:m.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-0",children:[m.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[m.jsx(gu,{to:"/home",className:"flex items-center gap-2 bg-yellow-400 px-4 py-1.5 rounded transform -skew-x-12 border-2 border-yellow-600 hover:scale-105 transition-transform group",children:m.jsx(Ok,{size:20,className:"text-slate-900 transform skew-x-12 group-hover:-translate-x-1 transition-transform",strokeWidth:3})}),m.jsx("h1",{className:"text-2xl font-black italic tracking-tight text-white",children:"JF26 "})]}),m.jsxs("div",{className:"flex items-center justify-end gap-2 sm:gap-4 w-full sm:w-auto",children:[t&&m.jsx(ZL,{amount:T}),m.jsxs("div",{className:"relative",children:[m.jsxs("button",{onClick:()=>a(!n),className:`w-10 h-10 rounded-full bg-slate-800 border-2 ${k?"border-purple-500":"border-yellow-400"} shadow-lg overflow-hidden`,children:[m.jsx("img",{src:t?.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${t?.name}`,alt:"avatar",className:"w-full h-full object-cover"}),k&&m.jsx("div",{className:"absolute -top-1 -right-1 bg-purple-600 rounded-full p-0.5 border border-white",children:m.jsx($x,{size:8,className:"text-white fill-white"})})]}),n&&m.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-xl border-2 border-slate-900 py-1 z-50 animate-in fade-in slide-in-from-top-2 text-slate-700",children:[m.jsxs("button",{onClick:()=>{a(!1),o("changeName")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 font-bold",children:[m.jsx(J0,{size:16})," "]}),m.jsxs("button",{onClick:()=>{a(!1),o("changeAvatar")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 font-bold",children:[m.jsx(wp,{size:16})," "]}),m.jsxs("button",{onClick:()=>{a(!1),o("changePwd")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 font-bold",children:[m.jsx(Bk,{size:16})," "]}),E&&m.jsx("div",{className:"border-t border-slate-100 mt-1",children:m.jsxs(gu,{to:"/admin/dashboard",className:"block px-4 py-2 text-sm text-blue-700 font-black hover:bg-blue-50 flex items-center gap-2",onClick:()=>a(!1),children:[m.jsx(Hk,{size:16})," "]})}),m.jsx("div",{className:"border-t-2 border-slate-100 my-1"}),m.jsxs("button",{onClick:I,className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2 font-black",children:[m.jsx(Vk,{size:16})," "]})]})]})]})]})}),m.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[m.jsxs("div",{className:"text-center mb-8 relative",children:[m.jsxs("div",{className:"inline-block relative",children:[m.jsx("h2",{className:"text-5xl font-black text-slate-900 italic transform -skew-x-6 z-10 relative",children:"JUMP FESTA 2026"}),m.jsx("div",{className:"absolute -bottom-2 -right-4 w-[110%] h-6 bg-yellow-400 -z-0 transform -skew-x-6"})]}),m.jsxs("p",{className:"text-slate-500 font-bold mt-4 flex items-center justify-center gap-2",children:[m.jsx(NT,{size:18,className:"text-slate-900"})," ..."]}),m.jsxs("div",{className:"flex justify-start sm:justify-center gap-3 text-xs sm:text-sm font-black mt-6 overflow-x-auto pb-4 no-scrollbar px-2",children:[m.jsxs("a",{href:"https://www.jumpfesta.com/maker/",target:"_blank",rel:"noreferrer",className:"shrink-0 px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 transition-all rounded flex items-center gap-1 whitespace-nowrap flex-nowrap",children:["JF26  ",m.jsx(Il,{size:14,className:"shrink-0"})]}),m.jsxs("a",{href:"https://jumpcs.shueisha.co.jp/shop/pages/jumpfesta.aspx",target:"_blank",rel:"noreferrer",className:"shrink-0 px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 transition-all rounded flex items-center gap-1 whitespace-nowrap flex-nowrap",children:["JCS ",m.jsx(Il,{size:14,className:"shrink-0"})]}),m.jsxs("a",{href:"https://docs.google.com/spreadsheets/d/1zfT-MMN-DwIRamibiAQUyp4lJLGBoxS3Rpeb1aVJLK8/edit?usp=sharing",target:"_blank",rel:"noreferrer",className:"shrink-0 px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 transition-all rounded flex items-center gap-1 whitespace-nowrap flex-nowrap",children:["JF26  ",m.jsx(Il,{size:14,className:"shrink-0"})]}),m.jsxs("a",{href:"https://forms.gle/VsHvAvraVQp4dHaK8",target:"_blank",rel:"noreferrer",className:"shrink-0 px-4 py-1.5 bg-yellow-400 border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 transition-all rounded text-slate-900 flex items-center gap-1 whitespace-nowrap flex-nowrap",children:["JF26  ",m.jsx(Il,{size:14,className:"shrink-0"})]})]})]}),m.jsx("nav",{className:"max-w-xl mx-auto mb-8 px-4",children:m.jsx("div",{className:"bg-white p-1 rounded-lg shadow-sm border-2 border-slate-200 flex justify-around gap-1",children:[{id:"vendors",label:"",icon:NT},{id:"js_pre",label:"JS ",icon:Tp},{id:"js_post",label:"JS ",icon:Fm},{id:"jcs_lottery",label:"JCS ",icon:Sp}].map(N=>{const z=N.icon,H=e===N.id;return m.jsxs("button",{onClick:()=>r(N.id),className:`flex-1 flex flex-col items-center justify-center gap-1 py-2 px-0.5 sm:px-4 rounded font-black transition-all border-2 ${H?"bg-slate-900 border-slate-900 text-yellow-400 shadow-md transform -translate-y-1":"bg-transparent border-transparent text-slate-500 hover:bg-slate-100"}`,children:[m.jsx(z,{size:20,className:H?"animate-pulse":""}),m.jsx("span",{className:"text-[11px] sm:text-sm whitespace-nowrap",children:N.label})]},N.id)})})}),m.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e==="vendors"&&m.jsx(t7,{currentUser:t}),e==="js_pre"&&m.jsx($L,{currentUser:t,isAdmin:E,onImageClick:f}),e==="js_post"&&m.jsx(QL,{currentUser:t,isAdmin:E,onImageClick:f}),e==="jcs_lottery"&&m.jsx(e7,{currentUser:t,isAdmin:E})]})]}),u&&m.jsx("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-0 animate-in fade-in duration-200",children:m.jsx(VL,{initialScale:1,centerOnInit:!0,children:({zoomIn:N,zoomOut:z,resetTransform:H})=>m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"absolute top-4 right-4 z-[110] flex items-center gap-2 bg-slate-900/80 p-2 rounded-full border border-slate-700 shadow-xl",children:[m.jsx("button",{onClick:()=>N(),className:"p-2 text-white hover:text-yellow-400",children:m.jsx(TM,{size:20})}),m.jsx("button",{onClick:()=>z(),className:"p-2 text-white hover:text-yellow-400",children:m.jsx(AM,{size:20})}),m.jsx("button",{onClick:()=>H(),className:"p-2 text-white hover:text-yellow-400",children:m.jsx(zP,{size:20})}),m.jsx("div",{className:"w-px h-6 bg-slate-600 mx-1"}),m.jsx("button",{onClick:()=>f(null),className:"p-2 text-white hover:text-red-400",children:m.jsx(ua,{size:20})})]}),m.jsx(HL,{wrapperClass:"!w-screen !h-screen",contentClass:"!w-screen !h-screen flex items-center justify-center",children:m.jsx("img",{src:u,alt:"Preview",className:"max-w-full max-h-full object-contain"})})]})})})]})}function ZL({amount:t}){return m.jsxs("div",{className:"relative group border-r border-slate-700 mr-1 pr-2 sm:mr-2 sm:pr-4 flex w-full items-center justify-end gap-3 sm:w-auto sm:flex-col sm:items-end sm:gap-0",children:[m.jsxs("button",{className:"focus:outline-none group/btn flex items-center gap-2 sm:mb-1 sm:gap-1.5",onClick:()=>alert(" JS JCS "),children:[m.jsx("span",{className:"text-[16px] sm:text-base text-slate-400 font-bold whitespace-nowrap pt-0.5",children:""}),m.jsx(Yx,{className:"text-yellow-500",size:14})]}),m.jsxs("div",{className:"text-yellow-400 font-black drop-shadow-sm text-right flex items-center",children:[m.jsx("span",{className:"text-xs mr-1 text-yellow-200 mt-1",children:"NT$"}),m.jsx("span",{className:"text-xl font-mono",children:t.toLocaleString()})]})]})}function e7({currentUser:t,isAdmin:e}){const[r,n]=ee.useState([]),[a,i]=ee.useState({totalDomesticShipping:0,exchangeRate:.24}),o=lN[t?.id]||t?.name||"";ee.useEffect(()=>{const f=Tr(Wt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders"),p=>{const y=p.docs.map(w=>({id:w.id,...w.data()})).sort((w,T)=>{const E=parseInt(w.id.replace("order_",""))||0,k=parseInt(T.id.replace("order_",""))||0;return E-k}),b=Array.from({length:10},(w,T)=>{const E=`order_${T+1}`;return y.find(I=>I.id===E)||{id:E,items:[]}});n(b)}),h=Tr(Tt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_settings","main"),p=>{p.exists()&&i(p.data())});return()=>{f(),h()}},[]);const u=f=>f==="WON"?"bg-green-100 text-green-700 border-green-200":f==="LOST"?"bg-slate-100 text-slate-400 border-slate-200 grayscale opacity-70":"bg-white text-slate-900 border-slate-200";return m.jsxs("div",{children:[m.jsx("div",{className:"bg-slate-900 text-yellow-400 p-6 rounded-xl border-4 border-yellow-400 shadow-[8px_8px_0px_0px_#0f172a] mb-10",children:m.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-3xl font-black italic mb-2",children:"JCS "}),m.jsxs("div",{className:"flex gap-4 text-sm font-bold text-white/80",children:[m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(lc,{size:14})," :",a.exchangeRate||.24]}),m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(Ap,{size:14})," (): ",Number(a.totalDomesticShipping).toLocaleString()]})]})]}),m.jsx("div",{className:"bg-yellow-400 text-slate-900 px-4 py-2 rounded font-black border-2 border-yellow-600 rotate-2 text-xs sm:text-sm",children:""})]})}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:r.map(f=>{const h=e?f.items||[]:(f.items||[]).filter(x=>x.assignments?.some(y=>y.user===o));if(!e&&h.length===0)return null;const p=h.reduce((x,y)=>{const b=y.assignments?.find(T=>T.user===o),w=e?y.qty:b?.qty||0;return x+Number(y.price)*w},0);return m.jsxs("div",{className:"bg-white rounded-xl border-4 border-slate-900 overflow-hidden shadow-[4px_4px_0px_0px_#6b21a8]",children:[m.jsxs("div",{className:"bg-slate-900 text-white px-4 py-3 flex justify-between items-center",children:[m.jsxs("h4",{className:"font-black italic text-lg flex items-center gap-2",children:[m.jsx(Sp,{size:20,className:"text-purple-400"}),"ORDER #",f.id.replace("order_","")]}),m.jsxs("div",{className:"text-xs font-mono text-yellow-400 font-bold",children:["",p.toLocaleString()]})]}),m.jsx("div",{className:"p-4 min-h-[120px]",children:m.jsxs("div",{className:"space-y-3 text-slate-700",children:[h.map((x,y)=>{const b=x.assignments?.find(T=>T.user===o),w=e?x.qty:b?.qty||0;return m.jsx("div",{className:`p-2 rounded border-2 ${u(x.status)}`,children:m.jsxs("div",{className:"flex justify-between items-start",children:[m.jsxs("div",{children:[m.jsx("div",{className:"font-bold text-sm",children:x.name}),m.jsxs("div",{className:"text-[10px] opacity-75",children:["",x.price," x ",w,e&&x.assignments?.length>0&&m.jsxs("span",{className:"ml-1 text-purple-600 font-black",children:["(",x.assignments.map(T=>`${T.user}${T.qty}`).join(","),")"]})]})]}),m.jsxs("div",{className:"text-right",children:[m.jsxs("div",{className:"font-black",children:["",x.price*w]}),x.status==="WON"?m.jsx(Ep,{size:16,className:"text-green-600 inline ml-1"}):x.status==="LOST"?m.jsx(Yj,{size:16,className:"text-slate-400 inline ml-1"}):m.jsx(Qj,{size:16,className:"text-slate-400 inline ml-1"})]})]})},y)}),m.jsxs("div",{className:"pt-2 border-t border-dashed border-slate-200 text-right",children:[m.jsx("span",{className:"text-[10px] font-black text-slate-400 mr-2 uppercase",children:"Subtotal"}),m.jsxs("span",{className:"font-black text-slate-900 font-mono italic",children:[" NT$ ",Math.ceil(p*a.exchangeRate).toLocaleString()]})]})]})})]},f.id)})})]})}function t7({currentUser:t}){const[e,r]=ee.useState([]),[n,a]=ee.useState(""),[i,o]=ee.useState(null);ee.useEffect(()=>{const h=Tr(Wt(Ke,"artifacts","default-app-id","public","data","jf26_vendors"),p=>{const x=p.docs.map(y=>({id:y.id,...y.data()}));r(x.sort((y,b)=>(y.order||0)-(b.order||0)))});return()=>h()},[]);const u=async h=>{if(!t?.id)return;const p=new Date().toISOString(),x=`vendor_${h.id}`;localStorage.setItem(`read_${t.id}_${x}`,p),await Uo(Tt(Ke,"artifacts","default-app-id","public","data","users",t.id),{readHistory:{[x]:p}},{merge:!0})},f=e.filter(h=>(h.name||"").toLowerCase().includes(n.toLowerCase())||(Array.isArray(h.products)?h.products.some(p=>p.toLowerCase().includes(n.toLowerCase())):!1));return m.jsxs("div",{children:[m.jsxs("div",{className:"mb-10 w-full h-12 rounded-xl border-4 border-slate-900 bg-white shadow-[4px_4px_0px_0px_#0f172a] flex items-center overflow-hidden",children:[m.jsx("div",{className:"pl-4 pr-2 text-slate-900",children:m.jsx(yy,{size:24,strokeWidth:3})}),m.jsx("input",{type:"text",placeholder:"  IP...",className:"w-full h-full border-none outline-none font-bold text-lg px-2",value:n,onChange:h=>a(h.target.value)})]}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(h=>m.jsxs("div",{onClick:()=>u(h),className:"bg-white rounded-xl border-4 border-slate-900 p-5 shadow-[8px_8px_0px_0px_#FACC15] hover:-translate-y-1 transition-all relative cursor-pointer group",children:[m.jsx("h3",{className:"font-black text-2xl text-slate-900 leading-tight italic border-b-2 pb-2 mb-4",children:h.name}),m.jsx("div",{className:"flex flex-wrap gap-2 mb-4 h-20 overflow-hidden",children:(h.products||[]).map((p,x)=>m.jsx("span",{className:"bg-yellow-50 text-slate-900 text-[10px] font-bold px-2 py-1 border-2 border-slate-200",children:p},x))}),m.jsxs("div",{className:"flex gap-2",children:[h.preOrder?.url&&m.jsx("a",{href:h.preOrder.url,target:"_blank",rel:"noreferrer",className:"flex-1 py-2 bg-yellow-400 text-slate-900 text-center font-black rounded border-2 border-slate-900 text-xs",children:""}),h.postOrder?.url&&m.jsx("a",{href:h.postOrder.url,target:"_blank",rel:"noreferrer",className:"flex-1 py-2 bg-blue-500 text-white text-center font-black rounded border-2 border-slate-900 text-xs",children:""})]})]},h.id))})]})}function r7(){const[t,e]=ee.useState(!1),[r,n]=ee.useState(!0),a=ee.useRef(null),i="4sNrzUoSLQY",o=`https://www.youtube.com/embed/${i}?autoplay=1&mute=1&loop=1&playlist=${i}&controls=1&enablejsapi=1`,u=()=>{if(!a.current)return;const f=r?"unMute":"mute";a.current.contentWindow.postMessage(JSON.stringify({event:"command",func:f,args:[]}),"*"),n(!r)};return m.jsx("div",{className:`
                fixed bottom-4 z-[9999] transition-all duration-300
                ${t?"left-4":"left-1/2 -translate-x-1/2 md:left-4 md:translate-x-0"}
                ${t?"w-12 h-12":"w-80"}
            `,children:m.jsxs("div",{className:"bg-slate-900 border-4 border-yellow-400 rounded-xl shadow-[4px_4px_0px_0px_#000] overflow-hidden flex flex-col h-full",children:[m.jsx("div",{style:{display:t?"none":"block",height:"180px"},children:m.jsx("iframe",{ref:a,width:"100%",height:"100%",src:o,title:"YouTube music player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})}),t?m.jsx("button",{onClick:()=>e(!1),className:"w-full h-full flex items-center justify-center text-yellow-400 hover:bg-slate-800 bg-slate-900",children:m.jsx(kT,{size:20,className:"animate-pulse"})}):m.jsxs("div",{className:"p-3 bg-slate-900",children:[m.jsxs("div",{className:"flex justify-between items-center mb-1",children:[m.jsxs("span",{className:"text-[10px] font-black text-yellow-400 flex items-center gap-1",children:[m.jsx(kT,{size:12})," BGM PLAYER"]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("button",{onClick:u,className:`hover:text-yellow-400 transition-colors ${r?"text-slate-400":"text-yellow-400"}`,title:r?"":"",children:r?m.jsx(_M,{size:16}):m.jsx(vM,{size:16})}),m.jsx("button",{onClick:()=>e(!0),className:"text-slate-400 hover:text-white",children:m.jsx(gy,{size:16})})]})]}),m.jsx("div",{className:"text-[10px] text-slate-400 text-center truncate px-1",children:r?" ":":   | "})]})]})})}const n7=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=800,u=800;let f=a.width,h=a.height;f>h?f>o&&(h*=o/f,f=o):h>u&&(f*=u/h,h=u),i.width=f,i.height=h,i.getContext("2d").drawImage(a,0,0,f,h),e(i.toDataURL("image/jpeg",.7))}}});function a7({onSubmit:t,onCancel:e,initialData:r=null}){const[n,a]=ee.useState(r?.title||""),[i,o]=ee.useState(()=>r?.images?.filter(I=>I.startsWith("http"))?.join(", ")||""),[u,f]=ee.useState(r?.url||""),[h,p]=ee.useState(r?.note||""),[x,y]=ee.useState(()=>r?.images?.filter(I=>I.startsWith("data:"))||[]),b=async I=>{if(I.target.files){const q=5-(i.split(",").map(R=>R.trim()).filter(R=>R).length+x.length);if(q<=0){alert(" 5 "),I.target.value=null;return}const A=Array.from(I.target.files).slice(0,q),F=await Promise.all(A.map(R=>n7(R)));y(R=>[...R,...F]),I.target.value=null}},w=I=>{y(N=>N.filter((z,H)=>H!==I))},T=()=>{if(!n)return alert("");const N=[...i.split(",").map(z=>z.trim()).filter(z=>z),...x];t({title:n,images:N,url:u,note:h})},E=x.length+i.split(",").map(I=>I.trim()).filter(I=>I).length,k=!!r;return m.jsxs("form",{onSubmit:I=>{I.preventDefault(),T()},className:"flex flex-col gap-4 text-slate-800",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(AT,{size:16}),"  ()"]}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",placeholder:" ",value:n,onChange:I=>a(I.target.value),required:!0})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(K0,{size:16}),"  ()"]}),m.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 text-sm h-16 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",placeholder:"",value:i,onChange:I=>o(I.target.value)})]}),m.jsxs("div",{className:"flex flex-col gap-2 p-3 border-2 border-dashed border-slate-300 rounded-lg bg-slate-100",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 flex items-center justify-between",children:[m.jsxs("span",{children:[m.jsx(by,{size:16,className:"inline mr-1"}),"  ( ",E," / 5)"]}),E>=5&&m.jsx("span",{className:"text-red-600 font-bold",children:""})]}),m.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:b,disabled:E>=5,className:"block w-full text-sm text-slate-700 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-2 file:border-red-800 file:text-xs file:font-black file:bg-red-600 file:text-white hover:file:bg-red-700 cursor-pointer disabled:opacity-50"}),x.length>0&&m.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 pb-4",children:x.map((I,N)=>m.jsxs("div",{className:"relative shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 border-slate-900 shadow",children:[m.jsx("img",{src:I,className:"w-full h-full object-cover",alt:"preview"}),m.jsx("button",{type:"button",onClick:()=>w(N),className:"absolute top-0 right-0 bg-red-600 text-white rounded-full p-1 transform translate-x-1/3 -translate-y-1/3 border-2 border-white hover:bg-red-700 transition-all",children:m.jsx(ua,{size:12})})]},N))})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(Il,{size:16}),"  ()"]}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:u,onChange:I=>f(I.target.value),placeholder:"https://www.amazon.co.jp/..."})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(AT,{size:16})," / ()"]}),m.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 h-24 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",maxLength:500,value:h,onChange:I=>p(I.target.value),placeholder:" M  8000"})]}),m.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[m.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[m.jsx(ua,{size:16,className:"inline mr-1"})," "]}),m.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-red-600 text-white border-2 border-red-800 hover:bg-red-700 font-black italic shadow-[2px_2px_0px_0px_rgba(153,27,27,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[m.jsx(Ui,{size:16,className:"inline mr-1"})," ",k?"":""]})]})]})}function s7({onSubmit:t,onCancel:e}){const[r,n]=ee.useState(""),[a,i]=ee.useState(""),[o,u]=ee.useState(""),[f,h]=ee.useState(""),[p,x]=ee.useState([{id:Date.now(),name:"",price:"",quantity:1,url:""}]),y=()=>{x([...p,{id:Date.now(),name:"",price:"",quantity:1,url:""}])},b=E=>{p.length>1&&x(p.filter(k=>k.id!==E))},w=(E,k,I)=>{x(p.map(N=>N.id===E?{...N,[k]:I}:N))},T=E=>{if(E.preventDefault(),!r.trim())return alert(" IP ");if(!o.trim())return alert("");const k=p.filter(I=>I.name.trim()&&I.price);if(k.length===0)return alert("");t({ipName:r,type:a,sourceUrl:o,note:f,items:k})};return m.jsxs("form",{onSubmit:T,className:"space-y-5 font-sans text-slate-800",children:[m.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200",children:[m.jsxs("h4",{className:"font-black italic text-lg text-slate-900 border-b-2 border-slate-300 pb-2 mb-3 flex items-center gap-2",children:[m.jsx(lc,{size:20,className:"text-blue-600"}),"  (INFO)"]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" IP /  ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:" ...",value:r,onChange:E=>n(E.target.value)})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsxs("div",{className:"flex gap-3",children:[m.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg p-2 text-center font-black transition-all ${a===""?"bg-slate-900 text-yellow-400 border-slate-900 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[m.jsx("input",{type:"radio",className:"hidden",value:"",checked:a==="",onChange:()=>i("")})," "]}),m.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg p-2 text-center font-black transition-all ${a===""?"bg-green-600 text-white border-green-800 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[m.jsx("input",{type:"radio",className:"hidden",value:"",checked:a==="",onChange:()=>i("")})," "]})]})]}),m.jsxs("div",{children:[m.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" /  ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsxs("div",{className:"relative",children:[m.jsx(Om,{size:16,className:"absolute left-3 top-3 text-slate-400"}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 pl-9 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:"...",value:o,onChange:E=>u(E.target.value)})]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-black text-slate-700 mb-1",children:" ()"}),m.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-medium placeholder:font-normal h-20",placeholder:"...",value:f,onChange:E=>h(E.target.value)})]})]})]}),m.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border-2 border-slate-300",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4",children:[m.jsxs("h4",{className:"font-black italic text-lg text-slate-900 transform -skew-x-3 flex items-center gap-2",children:[m.jsx(Tp,{size:20,className:"text-red-600"}),"  (ITEMS)"]}),m.jsx("button",{type:"button",onClick:y,className:"text-xs font-black px-3 py-1.5 bg-yellow-400 text-slate-900 rounded border-2 border-slate-900 hover:bg-yellow-500 transition-all shadow-sm",children:"+ "})]}),m.jsx("div",{className:"space-y-3",children:p.map((E,k)=>m.jsxs("div",{className:"bg-white p-3 rounded-lg border-2 border-slate-900 relative shadow-[2px_2px_0px_0px_rgba(15,23,42,1)] animate-in fade-in slide-in-from-bottom-1",children:[m.jsxs("div",{className:"flex justify-between items-center mb-2 border-b border-dashed border-slate-200 pb-1",children:[m.jsxs("span",{className:"text-xs font-black text-slate-400 italic",children:["ITEM #",k+1]}),p.length>1&&m.jsx("button",{type:"button",onClick:()=>b(E.id),className:"text-red-400 hover:text-red-600",children:m.jsx(ua,{size:16})})]}),m.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[m.jsxs("div",{className:"col-span-8",children:[m.jsxs("label",{className:"text-[10px] font-bold text-slate-500",children:[" ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsx("input",{className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm font-bold focus:border-slate-900 focus:ring-0",placeholder:" S",value:E.name,onChange:I=>w(E.id,"name",I.target.value)})]}),m.jsxs("div",{className:"col-span-4",children:[m.jsxs("label",{className:"text-[10px] font-bold text-slate-500",children:[" ",m.jsx("span",{className:"text-red-500",children:"*"})]}),m.jsx("input",{type:"number",className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm font-black text-red-600 focus:border-slate-900 focus:ring-0",placeholder:"",value:E.price,onChange:I=>w(E.id,"price",I.target.value)})]}),m.jsxs("div",{className:"col-span-4 sm:col-span-3",children:[m.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),m.jsxs("div",{className:"flex items-center",children:[m.jsx("button",{type:"button",onClick:()=>w(E.id,"quantity",Math.max(1,E.quantity-1)),className:"bg-slate-200 p-1 rounded-l border-y-2 border-l-2 border-slate-200 hover:bg-slate-300",children:m.jsx(gy,{size:12})}),m.jsx("input",{type:"number",className:"w-full text-center border-y-2 border-slate-200 p-1 text-sm font-bold h-[30px]",value:E.quantity,onChange:I=>w(E.id,"quantity",Math.max(1,parseInt(I.target.value)||1))}),m.jsx("button",{type:"button",onClick:()=>w(E.id,"quantity",E.quantity+1),className:"bg-slate-200 p-1 rounded-r border-y-2 border-r-2 border-slate-200 hover:bg-slate-300",children:m.jsx(Yl,{size:12})})]})]}),m.jsxs("div",{className:"col-span-8 sm:col-span-9",children:[m.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:" ()"}),m.jsx("input",{className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm text-slate-500 focus:border-slate-900 focus:ring-0",placeholder:"http://...",value:E.url,onChange:I=>w(E.id,"url",I.target.value)})]})]})]},E.id))})]}),m.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:[m.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[m.jsx(ua,{size:16,className:"inline mr-1"})," "]}),m.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-purple-600 text-white border-2 border-purple-800 hover:bg-purple-700 font-black italic shadow-[4px_4px_0px_0px_rgba(76,29,149,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[m.jsx(Ui,{size:16,className:"inline mr-1"})," "]})]})]})}function i7({group:t,currentOrder:e,onSubmit:r}){const[n,a]=ee.useState(()=>{const p={};return t.items.forEach(x=>{const y=e?.items?.find(b=>b.itemId==x.id||b.name?.trim()===x.name?.trim()&&(b.spec?.trim()||"")===(x.spec?.trim()||""));p[x.id]=y?y.quantity:0}),p}),i=(p,x)=>{const y=parseInt(x)||0,b=t.items.find(T=>T.id===p);let w=Math.max(0,y);b?.limit&&w>b.limit&&(w=b.limit),a(T=>({...T,[p]:w}))},o=()=>{const p=t.items.map(x=>({itemId:x.id||x.name,name:x.name,spec:x.spec,price:x.price,image:x.image,quantity:n[x.id]||0})).filter(x=>x.quantity>0);if(p.length===0){e?confirm(" 0()")&&r([]):alert("");return}r(p)},u=t.items.reduce((p,x)=>{const y=Number(x.price)||0,b=n[x.id]||0;return p+y*b},0),f=Number(t.shippingFee||0),h=Math.round((u+f)*t.exchangeRate);return m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg border-2 border-yellow-400 text-sm font-bold text-slate-800",children:[m.jsxs("p",{className:"flex items-center gap-2",children:[m.jsx(jm,{size:16,className:"text-red-600"}),""]}),m.jsxs("ul",{className:"mt-1 ml-1 list-disc list-inside text-xs font-medium text-slate-600 space-y-0.5",children:[m.jsxs("li",{children:["",t.exchangeRate]}),m.jsxs("li",{children:[" ",f.toLocaleString()]}),m.jsxs("li",{children:["",t.deadline]})]})]}),m.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border-2 border-slate-200",children:[m.jsx("h4",{className:"font-black italic text-lg text-slate-900 border-b border-slate-300 pb-3 mb-3",children:""}),m.jsx("div",{className:"space-y-4",children:t.items.map(p=>{const x=n[p.id]||0,y=p.limit&&x>=p.limit;return m.jsxs("div",{className:"flex items-center justify-between border-b-2 border-slate-100 pb-4 last:border-0 bg-white p-3 rounded-lg shadow-sm",children:[m.jsxs("div",{className:"flex items-start gap-3 flex-1 overflow-hidden",children:[m.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-100 border-2 border-slate-900 shrink-0 overflow-hidden flex items-center justify-center shadow-md",children:p.image?m.jsx("img",{src:p.image,alt:p.spec,className:"w-full h-full object-cover"}):m.jsx(K0,{size:20,className:"text-slate-400"})}),m.jsxs("div",{className:"min-w-0 pt-1",children:[m.jsx("div",{className:"font-black italic text-slate-900 truncate",children:p.name}),m.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 mt-1 flex-wrap",children:[p.spec&&m.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full font-bold",children:p.spec}),m.jsxs("span",{className:"text-red-600 font-black flex items-center gap-0.5",children:["",p.price]}),p.limit&&m.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:[" (: ",p.limit,")"]}),y&&m.jsx("span",{className:"text-red-600 font-black text-xs",children:" (MAX!)"})]})]})]}),m.jsxs("div",{className:"flex items-center gap-1 pl-2 shrink-0",children:[m.jsx("button",{type:"button",className:"w-8 h-8 rounded-full bg-slate-100 hover:bg-slate-200 font-bold text-slate-900 flex items-center justify-center border-2 border-slate-900 transition-colors shadow-[1px_1px_0px_0px_rgba(15,23,42,1)] active:shadow-none active:translate-y-0.5 active:translate-x-0.5",onClick:()=>i(p.id,x-1),children:m.jsx(gy,{size:16})}),m.jsx("input",{type:"number",className:"w-10 text-center font-black italic text-lg border-none focus:ring-2 focus:ring-yellow-400 p-0 bg-transparent text-slate-900",value:x,onChange:b=>i(p.id,b.target.value),min:"0",max:p.limit||999}),m.jsx("button",{type:"button",className:`w-8 h-8 rounded-full font-bold flex items-center justify-center border-2 border-slate-900 transition-colors shadow-[1px_1px_0px_0px_rgba(15,23,42,1)] active:shadow-none active:translate-y-0.5 active:translate-x-0.5 ${y?"bg-slate-300 text-slate-600 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,onClick:()=>i(p.id,x+1),disabled:y,children:m.jsx(Yl,{size:16})})]})]},p.id)})})]}),m.jsxs("div",{className:"bg-slate-800 text-white p-4 rounded-lg border-2 border-yellow-400 shadow-md",children:[m.jsx("h4",{className:"text-xl font-black italic text-yellow-400 mb-2",children:" (Summary)"}),m.jsxs("p",{className:"flex justify-between font-bold text-white border-b border-slate-600 pb-1 text-base",children:[m.jsx("span",{children:" (Goods JPY)"}),m.jsxs("span",{className:"font-mono text-xl text-red-400",children:[" ",u.toLocaleString()]})]}),f>0&&m.jsxs("p",{className:"flex justify-between text-sm pt-1 text-slate-300",children:[m.jsx("span",{children:" (Shipping JPY)"}),m.jsxs("span",{className:"font-mono",children:[" ",f.toLocaleString()]})]}),m.jsxs("p",{className:"flex justify-between pt-2 border-t border-slate-600 mt-2 font-black text-xl italic",children:[m.jsx("span",{children:" (NT$)"}),m.jsxs("span",{className:"font-mono text-2xl text-yellow-400",children:["NT$ ",h.toLocaleString()]})]})]}),m.jsx("div",{className:"pt-4 sticky bottom-0 bg-white/90 backdrop-blur-sm pb-2 border-t-2 border-yellow-400 mt-4",children:m.jsxs("button",{type:"button",className:"w-full py-3 bg-red-600 text-white rounded-lg font-black italic text-xl hover:bg-red-700 transition-all shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] active:translate-y-1 active:shadow-none active:translate-x-1 border-2 border-slate-900",onClick:o,children:[m.jsx(Ep,{size:20,className:"inline mr-2"}),u===0&&e?"":e?"":" (PLUS ULTRA!)"]})})]})}var Pm={};Pm.version="0.18.5";var oN=1252,l7=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ky={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ny=function(t){l7.indexOf(t)!=-1&&(oN=ky[0]=t)};function o7(){Ny(1252)}var ws=function(t){Ny(t)};function Cy(){ws(1200),o7()}function MT(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function c7(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function cN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Wf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?c7(t.slice(2)):e==254&&r==255?cN(t.slice(2)):e==65279?t.slice(1):t},Ud=function(e){return String.fromCharCode(e)},LT=function(e){return String.fromCharCode(e)},y0,Dl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function _0(t){for(var e="",r=0,n=0,a=0,i=0,o=0,u=0,f=0,h=0;h<t.length;)r=t.charCodeAt(h++),i=r>>2,n=t.charCodeAt(h++),o=(r&3)<<4|n>>4,a=t.charCodeAt(h++),u=(n&15)<<2|a>>6,f=a&63,isNaN(n)?u=f=64:isNaN(a)&&(f=64),e+=Dl.charAt(i)+Dl.charAt(o)+Dl.charAt(u)+Dl.charAt(f);return e}function Ia(t){var e="",r=0,n=0,a=0,i=0,o=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)i=Dl.indexOf(t.charAt(h++)),o=Dl.indexOf(t.charAt(h++)),r=i<<2|o>>4,e+=String.fromCharCode(r),u=Dl.indexOf(t.charAt(h++)),n=(o&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),f=Dl.indexOf(t.charAt(h++)),a=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(a));return e}var St=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),zi=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Kl(t){return St?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function BT(t){return St?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ka=function(e){return St?zi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Cp(t){if(typeof ArrayBuffer>"u")return ka(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function so(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function u7(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Ry(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Ry(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var mn=St?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:zi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function f7(t){for(var e=[],r=0,n=t.length+250,a=Kl(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=t.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|u>>6&15|(o&3)<<4,a[r++]=128|u&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Kl(65535),n=65530)}return e.push(a.slice(0,r)),mn(e)}var Qn=/\u0000/g,Xf=/[\u0001-\u0006]/g;function hu(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Es(t,e){var r=""+t;return r.length>=e?r:Dr("0",e-r.length)+r}function Iy(t,e){var r=""+t;return r.length>=e?r:Dr(" ",e-r.length)+r}function Mm(t,e){var r=""+t;return r.length>=e?r:r+Dr(" ",e-r.length)}function h7(t,e){var r=""+Math.round(t);return r.length>=e?r:Dr("0",e-r.length)+r}function d7(t,e){var r=""+t;return r.length>=e?r:Dr("0",e-r.length)+r}var VT=Math.pow(2,32);function Jc(t,e){if(t>VT||t<-VT)return h7(t,e);var r=Math.round(t);return d7(r,e)}function Lm(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var UT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],nx=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function m7(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},zT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},p7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Bm(t,e,r){for(var n=t<0?-1:1,a=t*n,i=0,o=1,u=0,f=1,h=0,p=0,x=Math.floor(a);h<e&&(x=Math.floor(a),u=x*o+i,p=x*h+f,!(a-x<5e-8));)a=1/(a-x),i=o,o=u,f=h,h=p;if(p>e&&(h>e?(p=f,u=i):(p=h,u=o)),!r)return[0,n*u,p];var y=Math.floor(n*u/p);return[y,n*u-y*p,p]}function Lo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),i=0,o=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=b7(f,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=i,u}var uN=new Date(1899,11,31,0,0,0),g7=uN.getTime(),x7=new Date(1900,2,1,0,0,0);function fN(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=x7&&(r+=1440*60*1e3),(r-(g7+(t.getTimezoneOffset()-uN.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Dy(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function v7(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function y7(t){var e=t<0?12:11,r=Dy(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function _7(t){var e=Dy(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function b0(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=y7(t):e===10?r=t.toFixed(10).substr(0,12):r=_7(t),Dy(v7(r.toUpperCase()))}function Jo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):b0(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return es(14,fN(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function b7(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function w7(t,e,r,n){var a="",i=0,o=0,u=r.y,f,h=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,h=2;break;default:f=u%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:f=r.m,h=e.length;break;case 3:return nx[r.m-1][1];case 5:return nx[r.m-1][0];default:return nx[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,h=e.length;break;case 3:return UT[r.q][0];default:return UT[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Es(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(a=Es(i,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:f=u,h=1;break}var p=h>0?Es(f,h):"";return p}function Ol(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var hN=/%/g;function E7(t,e,r){var n=e.replace(hN,""),a=e.length-n.length;return Ri(t,n,r*Math.pow(10,2*a))+Dr("%",a)}function T7(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ri(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function dN(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+dN(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,p){return f+h+p.substr(0,(a+i)%a)+"."+p.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var mN=/# (\?+)( ?)\/( ?)(\d+)/;function S7(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),i=Math.floor(a/n),o=a-i*n,u=n;return r+(i===0?"":""+i)+" "+(o===0?Dr(" ",t[1].length+1+t[4].length):Iy(o,t[1].length)+t[2]+"/"+t[3]+Es(u,t[4].length))}function A7(t,e,r){return r+(e===0?"":""+e)+Dr(" ",t[1].length+2+t[4].length)}var pN=/^#*0*\.([0#]+)/,gN=/\).*[0#]/,xN=/\(###\) ###\\?-####/;function Xn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function HT(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function qT(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function k7(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function N7(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Wa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(gN)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wa("n",n,r):"("+Wa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return T7(t,e,r);if(e.indexOf("%")!==-1)return E7(t,e,r);if(e.indexOf("E")!==-1)return dN(e,r);if(e.charCodeAt(0)===36)return"$"+Wa(t,e.substr(e.charAt(1)==" "?2:1),r);var a,i,o,u,f=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+Jc(f,e.length);if(e.match(/^[#?]+$/))return a=Jc(r,0),a==="0"&&(a=""),a.length>e.length?a:Xn(e.substr(0,e.length-a.length))+a;if(i=e.match(mN))return S7(i,f,h);if(e.match(/^#+0+$/))return h+Jc(f,e.length-e.indexOf("0"));if(i=e.match(pN))return a=HT(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Xn(i[1])).replace(/\.$/,"."+Xn(i[1])).replace(/\.(\d*)$/,function(w,T){return"."+T+Dr("0",Xn(i[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+HT(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+Ol(Jc(f,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wa(t,e,-r):Ol(""+(Math.floor(r)+k7(r,i[1].length)))+"."+Es(qT(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Wa(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=hu(Wa(t,e.replace(/[\\-]/g,""),r)),o=0,hu(hu(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<a.length?a.charAt(o++):w==="0"?"0":""}));if(e.match(xN))return a=Wa(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=Bm(f,Math.pow(10,o)-1,!1),a=""+h,p=Ri("n",i[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+i[2]+"/"+i[3],p=Mm(u[2],o),p.length<i[4].length&&(p=Xn(i[4].substr(i[4].length-p.length))+p),a+=p,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=Bm(f,Math.pow(10,o)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Iy(u[1],o)+i[2]+"/"+i[3]+Mm(u[2],o):Dr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=Jc(r,0),e.length<=a.length?a:Xn(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var x=e.indexOf(".")-o,y=e.length-a.length-x;return Xn(e.substr(0,x)+a+e.substr(e.length-y))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=qT(r,i[1].length),r<0?"-"+Wa(t,e,-r):Ol(N7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Es(0,3-w.length):"")+w})+"."+Es(o,i[1].length);switch(e){case"###,##0.00":return Wa(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var b=Ol(Jc(f,0));return b!=="0"?h+b:"";case"###,###.00":return Wa(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Wa(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function C7(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ri(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function R7(t,e,r){var n=e.replace(hN,""),a=e.length-n.length;return Ri(t,n,r*Math.pow(10,2*a))+Dr("%",a)}function vN(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+vN(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,h,p){return f+h+p.substr(0,(a+i)%a)+"."+p.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Bs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(gN)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Bs("n",n,r):"("+Bs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return C7(t,e,r);if(e.indexOf("%")!==-1)return R7(t,e,r);if(e.indexOf("E")!==-1)return vN(e,r);if(e.charCodeAt(0)===36)return"$"+Bs(t,e.substr(e.charAt(1)==" "?2:1),r);var a,i,o,u,f=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+Es(f,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:Xn(e.substr(0,e.length-a.length))+a;if(i=e.match(mN))return A7(i,f,h);if(e.match(/^#+0+$/))return h+Es(f,e.length-e.indexOf("0"));if(i=e.match(pN))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Xn(i[1])).replace(/\.$/,"."+Xn(i[1])),a=a.replace(/\.(\d*)$/,function(w,T){return"."+T+Dr("0",Xn(i[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return h+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return h+Ol(""+f);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Bs(t,e,-r):Ol(""+r)+"."+Dr("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Bs(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=hu(Bs(t,e.replace(/[\\-]/g,""),r)),o=0,hu(hu(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<a.length?a.charAt(o++):w==="0"?"0":""}));if(e.match(xN))return a=Bs(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=Bm(f,Math.pow(10,o)-1,!1),a=""+h,p=Ri("n",i[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+i[2]+"/"+i[3],p=Mm(u[2],o),p.length<i[4].length&&(p=Xn(i[4].substr(i[4].length-p.length))+p),a+=p,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=Bm(f,Math.pow(10,o)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Iy(u[1],o)+i[2]+"/"+i[3]+Mm(u[2],o):Dr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:Xn(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var x=e.indexOf(".")-o,y=e.length-a.length-x;return Xn(e.substr(0,x)+a+e.substr(e.length-y))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Bs(t,e,-r):Ol(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?Es(0,3-w.length):"")+w})+"."+Es(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var b=Ol(""+f);return b!=="0"?h+b:"";default:if(e.match(/\.[0#?]*$/))return Bs(t,e.slice(0,e.lastIndexOf(".")),r)+Xn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ri(t,e,r){return(r|0)===r?Bs(t,e,r):Wa(t,e,r)}function I7(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var yN=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Lm(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(yN))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function D7(t,e,r,n){for(var a=[],i="",o=0,u="",f="t",h,p,x,y="H";o<t.length;)switch(u=t.charAt(o)){case"G":if(!Lm(t,o))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(x=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(x);a[a.length]={t:"t",v:i},++o;break;case"\\":var b=t.charAt(++o),w=b==="("||b===")"?b:"t";a[a.length]={t:w,v:b},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(h==null&&(h=Lo(e,r,t.charAt(o+1)==="2"),h==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},f=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=Lo(e,r),h==null))return"";for(i=u;++o<t.length&&t.charAt(o).toLowerCase()===u;)i+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),a[a.length]={t:u,v:i},f=u;break;case"A":case"a":case"":var T={t:u,v:u};if(h==null&&(h=Lo(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(T.v=h.H>=12?"P":"A"),T.t="T",y="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(T.v=h.H>=12?"PM":"AM"),T.t="T",o+=5,y="h"):t.substr(o,5).toUpperCase()==="/"?(h!=null&&(T.v=h.H>=12?"":""),T.t="T",o+=5,y="h"):(T.t="t",++o),h==null&&T.t==="T")return"";a[a.length]=T,f=u;break;case"[":for(i=u;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(yN)){if(h==null&&(h=Lo(e,r),h==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mu(t)||(a[a.length]={t:"t",v:i}));break;case".":if(h!=null){for(i=u;++o<t.length&&(u=t.charAt(o))==="0";)i+=u;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=u;++o<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(o))>-1;)i+=u;a[a.length]={t:"n",v:i};break;case"?":for(i=u;t.charAt(++o)===u;)i+=u;a[a.length]={t:u,v:i},f=u;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=u;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:u,v:u},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++o;break}var E=0,k=0,I;for(o=a.length-1,f="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=y,f="h",E<1&&(E=1);break;case"s":(I=a[o].v.match(/\.0+$/))&&(k=Math.max(k,I[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":f=a[o].t;break;case"m":f==="s"&&(a[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[o].v.match(/[Hh]/)&&(E=1),E<2&&a[o].v.match(/[Mm]/)&&(E=2),E<3&&a[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var N="",z;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=w7(a[o].t.charCodeAt(0),a[o].v,h,k),a[o].t="t";break;case"n":case"?":for(z=o+1;a[z]!=null&&((u=a[z].t)==="?"||u==="D"||(u===" "||u==="t")&&a[z+1]!=null&&(a[z+1].t==="?"||a[z+1].t==="t"&&a[z+1].v==="/")||a[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[z].v==="/"||a[z].v===" "&&a[z+1]!=null&&a[z+1].t=="?"));)a[o].v+=a[z].v,a[z]={v:"",t:";"},++z;N+=a[o].v,o=z-1;break;case"G":a[o].t="t",a[o].v=Jo(e,r);break}var H="",q,A;if(N.length>0){N.charCodeAt(0)==40?(q=e<0&&N.charCodeAt(0)===45?-e:e,A=Ri("n",N,q)):(q=e<0&&n>1?-e:e,A=Ri("n",N,q),q<0&&a[0]&&a[0].t=="t"&&(A=A.substr(1),a[0].v="-"+a[0].v)),z=A.length-1;var F=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){F=o;break}var R=a.length;if(F===a.length&&A.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(z>=a[o].v.length-1?(z-=a[o].v.length,a[o].v=A.substr(z+1,a[o].v.length)):z<0?a[o].v="":(a[o].v=A.substr(0,z+1),z=-1),a[o].t="t",R=o);z>=0&&R<a.length&&(a[R].v=A.substr(0,z+1)+a[R].v)}else if(F!==a.length&&A.indexOf("E")===-1){for(z=A.indexOf(".")-1,o=F;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(p=a[o].v.indexOf(".")>-1&&o===F?a[o].v.indexOf(".")-1:a[o].v.length-1,H=a[o].v.substr(p+1);p>=0;--p)z>=0&&(a[o].v.charAt(p)==="0"||a[o].v.charAt(p)==="#")&&(H=A.charAt(z--)+H);a[o].v=H,a[o].t="t",R=o}for(z>=0&&R<a.length&&(a[R].v=A.substr(0,z+1)+a[R].v),z=A.indexOf(".")+1,o=F;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==F)){for(p=a[o].v.indexOf(".")>-1&&o===F?a[o].v.indexOf(".")+1:0,H=a[o].v.substr(0,p);p<a[o].v.length;++p)z<A.length&&(H+=A.charAt(z++));a[o].v=H,a[o].t="t",R=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(q=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=Ri(a[o].t,a[o].v,q),a[o].t="t");var M="";for(o=0;o!==a.length;++o)a[o]!=null&&(M+=a[o].v);return M}var GT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function WT(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function O7(t,e){var r=I7(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(GT),u=r[1].match(GT);return WT(e,o)?[n,r[0]]:WT(e,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,i]}function es(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ot)[t],n==null&&(n=r.table&&r.table[zT[t]]||ot[zT[t]]),n==null&&(n=p7[t]||"General");break}if(Lm(n,0))return Jo(e,r);e instanceof Date&&(e=fN(e,r.date1904));var a=O7(n,e);if(Lm(a[1]))return Jo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return D7(a[1],e,r,a[0])}function Ii(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ot[r]==null){e<0&&(e=r);continue}if(ot[r]==t){e=r;break}}e<0&&(e=391)}return ot[e]=t,e}function Rp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ii(t[e],e)}function Lu(){ot=m7()}var F7={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},_N=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function j7(t){var e=typeof t=="number"?ot[t]:t;return e=e.replace(_N,"(\\d+)"),new RegExp("^"+e+"$")}function P7(t,e,r){var n=-1,a=-1,i=-1,o=-1,u=-1,f=-1;(e.match(_N)||[]).forEach(function(x,y){var b=parseInt(r[y+1],10);switch(x.toLowerCase().charAt(0)){case"y":n=b;break;case"d":i=b;break;case"h":o=b;break;case"s":f=b;break;case"m":o>=0?u=b:a=b;break}}),f>=0&&u==-1&&a>=0&&(u=a,a=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&u==-1&&f==-1?h:n==-1&&a==-1&&i==-1?p:h+"T"+p}var M7=(function(){var t={};t.version="1.2.0";function e(){for(var A=0,F=new Array(256),R=0;R!=256;++R)A=R,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,F[R]=A;return typeof Int32Array<"u"?new Int32Array(F):F}var r=e();function n(A){var F=0,R=0,M=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)O[M]=A[M];for(M=0;M!=256;++M)for(R=A[M],F=256+M;F<4096;F+=256)R=O[F]=R>>>8^A[R&255];var j=[];for(M=1;M!=16;++M)j[M-1]=typeof Int32Array<"u"?O.subarray(M*256,M*256+256):O.slice(M*256,M*256+256);return j}var a=n(r),i=a[0],o=a[1],u=a[2],f=a[3],h=a[4],p=a[5],x=a[6],y=a[7],b=a[8],w=a[9],T=a[10],E=a[11],k=a[12],I=a[13],N=a[14];function z(A,F){for(var R=F^-1,M=0,O=A.length;M<O;)R=R>>>8^r[(R^A.charCodeAt(M++))&255];return~R}function H(A,F){for(var R=F^-1,M=A.length-15,O=0;O<M;)R=N[A[O++]^R&255]^I[A[O++]^R>>8&255]^k[A[O++]^R>>16&255]^E[A[O++]^R>>>24]^T[A[O++]]^w[A[O++]]^b[A[O++]]^y[A[O++]]^x[A[O++]]^p[A[O++]]^h[A[O++]]^f[A[O++]]^u[A[O++]]^o[A[O++]]^i[A[O++]]^r[A[O++]];for(M+=15;O<M;)R=R>>>8^r[(R^A[O++])&255];return~R}function q(A,F){for(var R=F^-1,M=0,O=A.length,j=0,L=0;M<O;)j=A.charCodeAt(M++),j<128?R=R>>>8^r[(R^j)&255]:j<2048?(R=R>>>8^r[(R^(192|j>>6&31))&255],R=R>>>8^r[(R^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,L=A.charCodeAt(M++)&1023,R=R>>>8^r[(R^(240|j>>8&7))&255],R=R>>>8^r[(R^(128|j>>2&63))&255],R=R>>>8^r[(R^(128|L>>6&15|(j&3)<<4))&255],R=R>>>8^r[(R^(128|L&63))&255]):(R=R>>>8^r[(R^(224|j>>12&15))&255],R=R>>>8^r[(R^(128|j>>6&63))&255],R=R>>>8^r[(R^(128|j&63))&255]);return~R}return t.table=r,t.bstr=z,t.buf=H,t.str=q,t})(),st=(function(){var e={};e.version="1.2.1";function r(B,J){for(var W=B.split("/"),K=J.split("/"),Q=0,te=0,de=Math.min(W.length,K.length);Q<de;++Q){if(te=W[Q].length-K[Q].length)return te;if(W[Q]!=K[Q])return W[Q]<K[Q]?-1:1}return W.length-K.length}function n(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:n(B.slice(0,-1));var J=B.lastIndexOf("/");return J===-1?B:B.slice(0,J+1)}function a(B){if(B.charAt(B.length-1)=="/")return a(B.slice(0,-1));var J=B.lastIndexOf("/");return J===-1?B:B.slice(J+1)}function i(B,J){typeof J=="string"&&(J=new Date(J));var W=J.getHours();W=W<<6|J.getMinutes(),W=W<<5|J.getSeconds()>>>1,B.write_shift(2,W);var K=J.getFullYear()-1980;K=K<<4|J.getMonth()+1,K=K<<5|J.getDate(),B.write_shift(2,K)}function o(B){var J=B.read_shift(2)&65535,W=B.read_shift(2)&65535,K=new Date,Q=W&31;W>>>=5;var te=W&15;W>>>=4,K.setMilliseconds(0),K.setFullYear(W+1980),K.setMonth(te-1),K.setDate(Q);var de=J&31;J>>>=5;var Ae=J&63;return J>>>=6,K.setHours(J),K.setMinutes(Ae),K.setSeconds(de<<1),K}function u(B){En(B,0);for(var J={},W=0;B.l<=B.length-4;){var K=B.read_shift(2),Q=B.read_shift(2),te=B.l+Q,de={};switch(K){case 21589:W=B.read_shift(1),W&1&&(de.mtime=B.read_shift(4)),Q>5&&(W&2&&(de.atime=B.read_shift(4)),W&4&&(de.ctime=B.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}B.l=te,J[K]=de}return J}var f;function h(){return f||(f={})}function p(B,J){if(B[0]==80&&B[1]==75)return ma(B,J);if((B[0]|32)==109&&(B[1]|32)==105)return ri(B,J);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var W=3,K=512,Q=0,te=0,de=0,Ae=0,me=0,xe=[],ge=B.slice(0,512);En(ge,0);var Be=x(ge);switch(W=Be[0],W){case 3:K=512;break;case 4:K=4096;break;case 0:if(Be[1]==0)return ma(B,J);default:throw new Error("Major Version: Expected 3 or 4 saw "+W)}K!==512&&(ge=B.slice(0,K),En(ge,28));var Ue=B.slice(0,K);y(ge,W);var Xe=ge.read_shift(4,"i");if(W===3&&Xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Xe);ge.l+=4,de=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),Ae=ge.read_shift(4,"i"),Q=ge.read_shift(4,"i"),me=ge.read_shift(4,"i"),te=ge.read_shift(4,"i");for(var Le=-1,We=0;We<109&&(Le=ge.read_shift(4,"i"),!(Le<0));++We)xe[We]=Le;var Ze=b(B,K);E(me,te,Ze,K,xe);var $t=I(Ze,de,xe,K);$t[de].name="!Directory",Q>0&&Ae!==L&&($t[Ae].name="!MiniFAT"),$t[xe[0]].name="!FAT",$t.fat_addrs=xe,$t.ssz=K;var Kt={},cr=[],Nn=[],is=[];N(de,$t,Ze,cr,Q,Kt,Nn,Ae),w(Nn,is,cr),cr.shift();var ls={FileIndex:Nn,FullPaths:is};return J&&J.raw&&(ls.raw={header:Ue,sectors:Ze}),ls}function x(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(Ne,"Header Signature: "),B.l+=16;var J=B.read_shift(2,"u");return[B.read_shift(2,"u"),J]}function y(B,J){var W=9;switch(B.l+=2,W=B.read_shift(2)){case 9:if(J!=3)throw new Error("Sector Shift: Expected 9 saw "+W);break;case 12:if(J!=4)throw new Error("Sector Shift: Expected 12 saw "+W);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+W)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function b(B,J){for(var W=Math.ceil(B.length/J)-1,K=[],Q=1;Q<W;++Q)K[Q-1]=B.slice(Q*J,(Q+1)*J);return K[W-1]=B.slice(W*J),K}function w(B,J,W){for(var K=0,Q=0,te=0,de=0,Ae=0,me=W.length,xe=[],ge=[];K<me;++K)xe[K]=ge[K]=K,J[K]=W[K];for(;Ae<ge.length;++Ae)K=ge[Ae],Q=B[K].L,te=B[K].R,de=B[K].C,xe[K]===K&&(Q!==-1&&xe[Q]!==Q&&(xe[K]=xe[Q]),te!==-1&&xe[te]!==te&&(xe[K]=xe[te])),de!==-1&&(xe[de]=K),Q!==-1&&K!=xe[K]&&(xe[Q]=xe[K],ge.lastIndexOf(Q)<Ae&&ge.push(Q)),te!==-1&&K!=xe[K]&&(xe[te]=xe[K],ge.lastIndexOf(te)<Ae&&ge.push(te));for(K=1;K<me;++K)xe[K]===K&&(te!==-1&&xe[te]!==te?xe[K]=xe[te]:Q!==-1&&xe[Q]!==Q&&(xe[K]=xe[Q]));for(K=1;K<me;++K)if(B[K].type!==0){if(Ae=K,Ae!=xe[Ae])do Ae=xe[Ae],J[K]=J[Ae]+"/"+J[K];while(Ae!==0&&xe[Ae]!==-1&&Ae!=xe[Ae]);xe[K]=-1}for(J[0]+="/",K=1;K<me;++K)B[K].type!==2&&(J[K]+="/")}function T(B,J,W){for(var K=B.start,Q=B.size,te=[],de=K;W&&Q>0&&de>=0;)te.push(J.slice(de*j,de*j+j)),Q-=j,de=Po(W,de*4);return te.length===0?Se(0):mn(te).slice(0,B.size)}function E(B,J,W,K,Q){var te=L;if(B===L){if(J!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var de=W[B],Ae=(K>>>2)-1;if(!de)return;for(var me=0;me<Ae&&(te=Po(de,me*4))!==L;++me)Q.push(te);E(Po(de,K-4),J-1,W,K,Q)}}function k(B,J,W,K,Q){var te=[],de=[];Q||(Q=[]);var Ae=K-1,me=0,xe=0;for(me=J;me>=0;){Q[me]=!0,te[te.length]=me,de.push(B[me]);var ge=W[Math.floor(me*4/K)];if(xe=me*4&Ae,K<4+xe)throw new Error("FAT boundary crossed: "+me+" 4 "+K);if(!B[ge])break;me=Po(B[ge],xe)}return{nodes:te,data:aS([de])}}function I(B,J,W,K){var Q=B.length,te=[],de=[],Ae=[],me=[],xe=K-1,ge=0,Be=0,Ue=0,Xe=0;for(ge=0;ge<Q;++ge)if(Ae=[],Ue=ge+J,Ue>=Q&&(Ue-=Q),!de[Ue]){me=[];var Le=[];for(Be=Ue;Be>=0;){Le[Be]=!0,de[Be]=!0,Ae[Ae.length]=Be,me.push(B[Be]);var We=W[Math.floor(Be*4/K)];if(Xe=Be*4&xe,K<4+Xe)throw new Error("FAT boundary crossed: "+Be+" 4 "+K);if(!B[We]||(Be=Po(B[We],Xe),Le[Be]))break}te[Ue]={nodes:Ae,data:aS([me])}}return te}function N(B,J,W,K,Q,te,de,Ae){for(var me=0,xe=K.length?2:0,ge=J[B].data,Be=0,Ue=0,Xe;Be<ge.length;Be+=128){var Le=ge.slice(Be,Be+128);En(Le,64),Ue=Le.read_shift(2),Xe=By(Le,0,Ue-xe),K.push(Xe);var We={name:Xe,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},Ze=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);Ze!==0&&(We.ct=z(Le,Le.l-8));var $t=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);$t!==0&&(We.mt=z(Le,Le.l-8)),We.start=Le.read_shift(4,"i"),We.size=Le.read_shift(4,"i"),We.size<0&&We.start<0&&(We.size=We.type=0,We.start=L,We.name=""),We.type===5?(me=We.start,Q>0&&me!==L&&(J[me].name="!StreamData")):We.size>=4096?(We.storage="fat",J[We.start]===void 0&&(J[We.start]=k(W,We.start,J.fat_addrs,J.ssz)),J[We.start].name=We.name,We.content=J[We.start].data.slice(0,We.size)):(We.storage="minifat",We.size<0?We.size=0:me!==L&&We.start!==L&&J[me]&&(We.content=T(We,J[me].data,(J[Ae]||{}).data))),We.content&&En(We.content,0),te[Xe]=We,de.push(We)}}function z(B,J){return new Date((Aa(B,J+4)/1e7*Math.pow(2,32)+Aa(B,J)/1e7-11644473600)*1e3)}function H(B,J){return h(),p(f.readFileSync(B),J)}function q(B,J){var W=J&&J.type;switch(W||St&&Buffer.isBuffer(B)&&(W="buffer"),W||"base64"){case"file":return H(B,J);case"base64":return p(ka(Ia(B)),J);case"binary":return p(ka(B),J)}return p(B,J)}function A(B,J){var W=J||{},K=W.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=K+"/",B.FileIndex[0]={name:K,type:5}),W.CLSID&&(B.FileIndex[0].clsid=W.CLSID),F(B)}function F(B){var J="Sh33tJ5";if(!st.find(B,"/"+J)){var W=Se(4);W[0]=55,W[1]=W[3]=50,W[2]=54,B.FileIndex.push({name:J,type:2,content:W,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+J),R(B)}}function R(B,J){A(B);for(var W=!1,K=!1,Q=B.FullPaths.length-1;Q>=0;--Q){var te=B.FileIndex[Q];switch(te.type){case 0:K?W=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:K=!0,isNaN(te.R*te.L*te.C)&&(W=!0),te.R>-1&&te.L>-1&&te.R==te.L&&(W=!0);break;default:W=!0;break}}if(!(!W&&!J)){var de=new Date(1987,1,19),Ae=0,me=Object.create?Object.create(null):{},xe=[];for(Q=0;Q<B.FullPaths.length;++Q)me[B.FullPaths[Q]]=!0,B.FileIndex[Q].type!==0&&xe.push([B.FullPaths[Q],B.FileIndex[Q]]);for(Q=0;Q<xe.length;++Q){var ge=n(xe[Q][0]);K=me[ge],K||(xe.push([ge,{name:a(ge).replace("/",""),type:1,clsid:ne,ct:de,mt:de,content:null}]),me[ge]=!0)}for(xe.sort(function(Xe,Le){return r(Xe[0],Le[0])}),B.FullPaths=[],B.FileIndex=[],Q=0;Q<xe.length;++Q)B.FullPaths[Q]=xe[Q][0],B.FileIndex[Q]=xe[Q][1];for(Q=0;Q<xe.length;++Q){var Be=B.FileIndex[Q],Ue=B.FullPaths[Q];if(Be.name=a(Ue).replace("/",""),Be.L=Be.R=Be.C=-(Be.color=1),Be.size=Be.content?Be.content.length:0,Be.start=0,Be.clsid=Be.clsid||ne,Q===0)Be.C=xe.length>1?1:-1,Be.size=0,Be.type=5;else if(Ue.slice(-1)=="/"){for(Ae=Q+1;Ae<xe.length&&n(B.FullPaths[Ae])!=Ue;++Ae);for(Be.C=Ae>=xe.length?-1:Ae,Ae=Q+1;Ae<xe.length&&n(B.FullPaths[Ae])!=n(Ue);++Ae);Be.R=Ae>=xe.length?-1:Ae,Be.type=1}else n(B.FullPaths[Q+1]||"")==n(Ue)&&(Be.R=Q+1),Be.type=2}}}function M(B,J){var W=J||{};if(W.fileType=="mad")return zu(B,W);switch(R(B),W.fileType){case"zip":return Cr(B,W)}var K=(function(Xe){for(var Le=0,We=0,Ze=0;Ze<Xe.FileIndex.length;++Ze){var $t=Xe.FileIndex[Ze];if($t.content){var Kt=$t.content.length;Kt>0&&(Kt<4096?Le+=Kt+63>>6:We+=Kt+511>>9)}}for(var cr=Xe.FullPaths.length+3>>2,Nn=Le+7>>3,is=Le+127>>7,ls=Nn+We+cr+is,ga=ls+127>>7,Gi=ga<=109?0:Math.ceil((ga-109)/127);ls+ga+Gi+127>>7>ga;)Gi=++ga<=109?0:Math.ceil((ga-109)/127);var Cn=[1,Gi,ga,is,cr,We,Le,0];return Xe.FileIndex[0].size=Le<<6,Cn[7]=(Xe.FileIndex[0].start=Cn[0]+Cn[1]+Cn[2]+Cn[3]+Cn[4]+Cn[5])+(Cn[6]+7>>3),Cn})(B),Q=Se(K[7]<<9),te=0,de=0;{for(te=0;te<8;++te)Q.write_shift(1,_e[te]);for(te=0;te<8;++te)Q.write_shift(2,0);for(Q.write_shift(2,62),Q.write_shift(2,3),Q.write_shift(2,65534),Q.write_shift(2,9),Q.write_shift(2,6),te=0;te<3;++te)Q.write_shift(2,0);for(Q.write_shift(4,0),Q.write_shift(4,K[2]),Q.write_shift(4,K[0]+K[1]+K[2]+K[3]-1),Q.write_shift(4,0),Q.write_shift(4,4096),Q.write_shift(4,K[3]?K[0]+K[1]+K[2]-1:L),Q.write_shift(4,K[3]),Q.write_shift(-4,K[1]?K[0]-1:L),Q.write_shift(4,K[1]),te=0;te<109;++te)Q.write_shift(-4,te<K[2]?K[1]+te:-1)}if(K[1])for(de=0;de<K[1];++de){for(;te<236+de*127;++te)Q.write_shift(-4,te<K[2]?K[1]+te:-1);Q.write_shift(-4,de===K[1]-1?L:de+1)}var Ae=function(Xe){for(de+=Xe;te<de-1;++te)Q.write_shift(-4,te+1);Xe&&(++te,Q.write_shift(-4,L))};for(de=te=0,de+=K[1];te<de;++te)Q.write_shift(-4,se.DIFSECT);for(de+=K[2];te<de;++te)Q.write_shift(-4,se.FATSECT);Ae(K[3]),Ae(K[4]);for(var me=0,xe=0,ge=B.FileIndex[0];me<B.FileIndex.length;++me)ge=B.FileIndex[me],ge.content&&(xe=ge.content.length,!(xe<4096)&&(ge.start=de,Ae(xe+511>>9)));for(Ae(K[6]+7>>3);Q.l&511;)Q.write_shift(-4,se.ENDOFCHAIN);for(de=te=0,me=0;me<B.FileIndex.length;++me)ge=B.FileIndex[me],ge.content&&(xe=ge.content.length,!(!xe||xe>=4096)&&(ge.start=de,Ae(xe+63>>6)));for(;Q.l&511;)Q.write_shift(-4,se.ENDOFCHAIN);for(te=0;te<K[4]<<2;++te){var Be=B.FullPaths[te];if(!Be||Be.length===0){for(me=0;me<17;++me)Q.write_shift(4,0);for(me=0;me<3;++me)Q.write_shift(4,-1);for(me=0;me<12;++me)Q.write_shift(4,0);continue}ge=B.FileIndex[te],te===0&&(ge.start=ge.size?ge.start-1:L);var Ue=te===0&&W.root||ge.name;if(xe=2*(Ue.length+1),Q.write_shift(64,Ue,"utf16le"),Q.write_shift(2,xe),Q.write_shift(1,ge.type),Q.write_shift(1,ge.color),Q.write_shift(-4,ge.L),Q.write_shift(-4,ge.R),Q.write_shift(-4,ge.C),ge.clsid)Q.write_shift(16,ge.clsid,"hex");else for(me=0;me<4;++me)Q.write_shift(4,0);Q.write_shift(4,ge.state||0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,ge.start),Q.write_shift(4,ge.size),Q.write_shift(4,0)}for(te=1;te<B.FileIndex.length;++te)if(ge=B.FileIndex[te],ge.size>=4096)if(Q.l=ge.start+1<<9,St&&Buffer.isBuffer(ge.content))ge.content.copy(Q,Q.l,0,ge.size),Q.l+=ge.size+511&-512;else{for(me=0;me<ge.size;++me)Q.write_shift(1,ge.content[me]);for(;me&511;++me)Q.write_shift(1,0)}for(te=1;te<B.FileIndex.length;++te)if(ge=B.FileIndex[te],ge.size>0&&ge.size<4096)if(St&&Buffer.isBuffer(ge.content))ge.content.copy(Q,Q.l,0,ge.size),Q.l+=ge.size+63&-64;else{for(me=0;me<ge.size;++me)Q.write_shift(1,ge.content[me]);for(;me&63;++me)Q.write_shift(1,0)}if(St)Q.l=Q.length;else for(;Q.l<Q.length;)Q.write_shift(1,0);return Q}function O(B,J){var W=B.FullPaths.map(function(me){return me.toUpperCase()}),K=W.map(function(me){var xe=me.split("/");return xe[xe.length-(me.slice(-1)=="/"?2:1)]}),Q=!1;J.charCodeAt(0)===47?(Q=!0,J=W[0].slice(0,-1)+J):Q=J.indexOf("/")!==-1;var te=J.toUpperCase(),de=Q===!0?W.indexOf(te):K.indexOf(te);if(de!==-1)return B.FileIndex[de];var Ae=!te.match(Xf);for(te=te.replace(Qn,""),Ae&&(te=te.replace(Xf,"!")),de=0;de<W.length;++de)if((Ae?W[de].replace(Xf,"!"):W[de]).replace(Qn,"")==te||(Ae?K[de].replace(Xf,"!"):K[de]).replace(Qn,"")==te)return B.FileIndex[de];return null}var j=64,L=-2,Ne="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:L,FREESECT:-1,HEADER_SIGNATURE:Ne,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ee(B,J,W){h();var K=M(B,W);f.writeFileSync(J,K)}function ie(B){for(var J=new Array(B.length),W=0;W<B.length;++W)J[W]=String.fromCharCode(B[W]);return J.join("")}function Ve(B,J){var W=M(B,J);switch(J&&J.type||"buffer"){case"file":return h(),f.writeFileSync(J.filename,W),W;case"binary":return typeof W=="string"?W:ie(W);case"base64":return _0(typeof W=="string"?W:ie(W));case"buffer":if(St)return Buffer.isBuffer(W)?W:zi(W);case"array":return typeof W=="string"?ka(W):W}return W}var U;function P(B){try{var J=B.InflateRaw,W=new J;if(W._processChunk(new Uint8Array([3,0]),W._finishFlushFlag),W.bytesRead)U=B;else throw new Error("zlib does not expose bytesRead")}catch(K){console.error("cannot use native zlib: "+(K.message||K))}}function G(B,J){if(!U)return as(B,J);var W=U.InflateRaw,K=new W,Q=K._processChunk(B.slice(B.l),K._finishFlushFlag);return B.l+=K.bytesRead,Q}function Y(B){return U?U.deflateRawSync(B):dt(B)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ye=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Fe(B){var J=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(J>>16|J>>8|J)&255}for(var Te=typeof Uint8Array<"u",De=Te?new Uint8Array(256):[],rt=0;rt<256;++rt)De[rt]=Fe(rt);function re(B,J){var W=De[B&255];return J<=8?W>>>8-J:(W=W<<8|De[B>>8&255],J<=16?W>>>16-J:(W=W<<8|De[B>>16&255],W>>>24-J))}function ft(B,J){var W=J&7,K=J>>>3;return(B[K]|(W<=6?0:B[K+1]<<8))>>>W&3}function ce(B,J){var W=J&7,K=J>>>3;return(B[K]|(W<=5?0:B[K+1]<<8))>>>W&7}function ze(B,J){var W=J&7,K=J>>>3;return(B[K]|(W<=4?0:B[K+1]<<8))>>>W&15}function Ce(B,J){var W=J&7,K=J>>>3;return(B[K]|(W<=3?0:B[K+1]<<8))>>>W&31}function je(B,J){var W=J&7,K=J>>>3;return(B[K]|(W<=1?0:B[K+1]<<8))>>>W&127}function tt(B,J,W){var K=J&7,Q=J>>>3,te=(1<<W)-1,de=B[Q]>>>K;return W<8-K||(de|=B[Q+1]<<8-K,W<16-K)||(de|=B[Q+2]<<16-K,W<24-K)||(de|=B[Q+3]<<24-K),de&te}function nt(B,J,W){var K=J&7,Q=J>>>3;return K<=5?B[Q]|=(W&7)<<K:(B[Q]|=W<<K&255,B[Q+1]=(W&7)>>8-K),J+3}function ht(B,J,W){var K=J&7,Q=J>>>3;return W=(W&1)<<K,B[Q]|=W,J+1}function fr(B,J,W){var K=J&7,Q=J>>>3;return W<<=K,B[Q]|=W&255,W>>>=8,B[Q+1]=W,J+8}function da(B,J,W){var K=J&7,Q=J>>>3;return W<<=K,B[Q]|=W&255,W>>>=8,B[Q+1]=W&255,B[Q+2]=W>>>8,J+16}function Hn(B,J){var W=B.length,K=2*W>J?2*W:J+5,Q=0;if(W>=J)return B;if(St){var te=BT(K);if(B.copy)B.copy(te);else for(;Q<B.length;++Q)te[Q]=B[Q];return te}else if(Te){var de=new Uint8Array(K);if(de.set)de.set(B);else for(;Q<W;++Q)de[Q]=B[Q];return de}return B.length=K,B}function Ht(B){for(var J=new Array(B),W=0;W<B;++W)J[W]=0;return J}function en(B,J,W){var K=1,Q=0,te=0,de=0,Ae=0,me=B.length,xe=Te?new Uint16Array(32):Ht(32);for(te=0;te<32;++te)xe[te]=0;for(te=me;te<W;++te)B[te]=0;me=B.length;var ge=Te?new Uint16Array(me):Ht(me);for(te=0;te<me;++te)xe[Q=B[te]]++,K<Q&&(K=Q),ge[te]=0;for(xe[0]=0,te=1;te<=K;++te)xe[te+16]=Ae=Ae+xe[te-1]<<1;for(te=0;te<me;++te)Ae=B[te],Ae!=0&&(ge[te]=xe[Ae+16]++);var Be=0;for(te=0;te<me;++te)if(Be=B[te],Be!=0)for(Ae=re(ge[te],K)>>K-Be,de=(1<<K+4-Be)-1;de>=0;--de)J[Ae|de<<Be]=Be&15|te<<4;return K}var kn=Te?new Uint16Array(512):Ht(512),Jn=Te?new Uint16Array(32):Ht(32);if(!Te){for(var Yt=0;Yt<512;++Yt)kn[Yt]=0;for(Yt=0;Yt<32;++Yt)Jn[Yt]=0}(function(){for(var B=[],J=0;J<32;J++)B.push(5);en(B,Jn,32);var W=[];for(J=0;J<=143;J++)W.push(8);for(;J<=255;J++)W.push(9);for(;J<=279;J++)W.push(7);for(;J<=287;J++)W.push(8);en(W,kn,288)})();var on=(function(){for(var J=Te?new Uint8Array(32768):[],W=0,K=0;W<ye.length-1;++W)for(;K<ye[W+1];++K)J[K]=W;for(;K<32768;++K)J[K]=29;var Q=Te?new Uint8Array(259):[];for(W=0,K=0;W<oe.length-1;++W)for(;K<oe[W+1];++K)Q[K]=W;function te(Ae,me){for(var xe=0;xe<Ae.length;){var ge=Math.min(65535,Ae.length-xe),Be=xe+ge==Ae.length;for(me.write_shift(1,+Be),me.write_shift(2,ge),me.write_shift(2,~ge&65535);ge-- >0;)me[me.l++]=Ae[xe++]}return me.l}function de(Ae,me){for(var xe=0,ge=0,Be=Te?new Uint16Array(32768):[];ge<Ae.length;){var Ue=Math.min(65535,Ae.length-ge);if(Ue<10){for(xe=nt(me,xe,+(ge+Ue==Ae.length)),xe&7&&(xe+=8-(xe&7)),me.l=xe/8|0,me.write_shift(2,Ue),me.write_shift(2,~Ue&65535);Ue-- >0;)me[me.l++]=Ae[ge++];xe=me.l*8;continue}xe=nt(me,xe,+(ge+Ue==Ae.length)+2);for(var Xe=0;Ue-- >0;){var Le=Ae[ge];Xe=(Xe<<5^Le)&32767;var We=-1,Ze=0;if((We=Be[Xe])&&(We|=ge&-32768,We>ge&&(We-=32768),We<ge))for(;Ae[We+Ze]==Ae[ge+Ze]&&Ze<250;)++Ze;if(Ze>2){Le=Q[Ze],Le<=22?xe=fr(me,xe,De[Le+1]>>1)-1:(fr(me,xe,3),xe+=5,fr(me,xe,De[Le-23]>>5),xe+=3);var $t=Le<8?0:Le-4>>2;$t>0&&(da(me,xe,Ze-oe[Le]),xe+=$t),Le=J[ge-We],xe=fr(me,xe,De[Le]>>3),xe-=3;var Kt=Le<4?0:Le-2>>1;Kt>0&&(da(me,xe,ge-We-ye[Le]),xe+=Kt);for(var cr=0;cr<Ze;++cr)Be[Xe]=ge&32767,Xe=(Xe<<5^Ae[ge])&32767,++ge;Ue-=Ze-1}else Le<=143?Le=Le+48:xe=ht(me,xe,1),xe=fr(me,xe,De[Le]),Be[Xe]=ge&32767,++ge}xe=fr(me,xe,0)-1}return me.l=(xe+7)/8|0,me.l}return function(me,xe){return me.length<8?te(me,xe):de(me,xe)}})();function dt(B){var J=Se(50+Math.floor(B.length*1.1)),W=on(B,J);return J.slice(0,W)}var Pt=Te?new Uint16Array(32768):Ht(32768),tn=Te?new Uint16Array(32768):Ht(32768),Mt=Te?new Uint16Array(128):Ht(128),or=1,cn=1;function mr(B,J){var W=Ce(B,J)+257;J+=5;var K=Ce(B,J)+1;J+=5;var Q=ze(B,J)+4;J+=4;for(var te=0,de=Te?new Uint8Array(19):Ht(19),Ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],me=1,xe=Te?new Uint8Array(8):Ht(8),ge=Te?new Uint8Array(8):Ht(8),Be=de.length,Ue=0;Ue<Q;++Ue)de[Z[Ue]]=te=ce(B,J),me<te&&(me=te),xe[te]++,J+=3;var Xe=0;for(xe[0]=0,Ue=1;Ue<=me;++Ue)ge[Ue]=Xe=Xe+xe[Ue-1]<<1;for(Ue=0;Ue<Be;++Ue)(Xe=de[Ue])!=0&&(Ae[Ue]=ge[Xe]++);var Le=0;for(Ue=0;Ue<Be;++Ue)if(Le=de[Ue],Le!=0){Xe=De[Ae[Ue]]>>8-Le;for(var We=(1<<7-Le)-1;We>=0;--We)Mt[Xe|We<<Le]=Le&7|Ue<<3}var Ze=[];for(me=1;Ze.length<W+K;)switch(Xe=Mt[je(B,J)],J+=Xe&7,Xe>>>=3){case 16:for(te=3+ft(B,J),J+=2,Xe=Ze[Ze.length-1];te-- >0;)Ze.push(Xe);break;case 17:for(te=3+ce(B,J),J+=3;te-- >0;)Ze.push(0);break;case 18:for(te=11+je(B,J),J+=7;te-- >0;)Ze.push(0);break;default:Ze.push(Xe),me<Xe&&(me=Xe);break}var $t=Ze.slice(0,W),Kt=Ze.slice(W);for(Ue=W;Ue<286;++Ue)$t[Ue]=0;for(Ue=K;Ue<30;++Ue)Kt[Ue]=0;return or=en($t,Pt,286),cn=en(Kt,tn,30),J}function ns(B,J){if(B[0]==3&&!(B[1]&3))return[Kl(J),2];for(var W=0,K=0,Q=BT(J||1<<18),te=0,de=Q.length>>>0,Ae=0,me=0;(K&1)==0;){if(K=ce(B,W),W+=3,K>>>1)K>>1==1?(Ae=9,me=5):(W=mr(B,W),Ae=or,me=cn);else{W&7&&(W+=8-(W&7));var xe=B[W>>>3]|B[(W>>>3)+1]<<8;if(W+=32,xe>0)for(!J&&de<te+xe&&(Q=Hn(Q,te+xe),de=Q.length);xe-- >0;)Q[te++]=B[W>>>3],W+=8;continue}for(;;){!J&&de<te+32767&&(Q=Hn(Q,te+32767),de=Q.length);var ge=tt(B,W,Ae),Be=K>>>1==1?kn[ge]:Pt[ge];if(W+=Be&15,Be>>>=4,(Be>>>8&255)===0)Q[te++]=Be;else{if(Be==256)break;Be-=257;var Ue=Be<8?0:Be-4>>2;Ue>5&&(Ue=0);var Xe=te+oe[Be];Ue>0&&(Xe+=tt(B,W,Ue),W+=Ue),ge=tt(B,W,me),Be=K>>>1==1?Jn[ge]:tn[ge],W+=Be&15,Be>>>=4;var Le=Be<4?0:Be-2>>1,We=ye[Be];for(Le>0&&(We+=tt(B,W,Le),W+=Le),!J&&de<Xe&&(Q=Hn(Q,Xe+100),de=Q.length);te<Xe;)Q[te]=Q[te-We],++te}}}return J?[Q,W+7>>>3]:[Q.slice(0,te),W+7>>>3]}function as(B,J){var W=B.slice(B.l||0),K=ns(W,J);return B.l+=K[1],K[0]}function oo(B,J){if(B)typeof console<"u"&&console.error(J);else throw new Error(J)}function ma(B,J){var W=B;En(W,0);var K=[],Q=[],te={FileIndex:K,FullPaths:Q};A(te,{root:J.root});for(var de=W.length-4;(W[de]!=80||W[de+1]!=75||W[de+2]!=5||W[de+3]!=6)&&de>=0;)--de;W.l=de+4,W.l+=4;var Ae=W.read_shift(2);W.l+=6;var me=W.read_shift(4);for(W.l=me,de=0;de<Ae;++de){W.l+=20;var xe=W.read_shift(4),ge=W.read_shift(4),Be=W.read_shift(2),Ue=W.read_shift(2),Xe=W.read_shift(2);W.l+=8;var Le=W.read_shift(4),We=u(W.slice(W.l+Be,W.l+Be+Ue));W.l+=Be+Ue+Xe;var Ze=W.l;W.l=Le+4,ti(W,xe,ge,te,We),W.l=Ze}return te}function ti(B,J,W,K,Q){B.l+=2;var te=B.read_shift(2),de=B.read_shift(2),Ae=o(B);if(te&8257)throw new Error("Unsupported ZIP encryption");for(var me=B.read_shift(4),xe=B.read_shift(4),ge=B.read_shift(4),Be=B.read_shift(2),Ue=B.read_shift(2),Xe="",Le=0;Le<Be;++Le)Xe+=String.fromCharCode(B[B.l++]);if(Ue){var We=u(B.slice(B.l,B.l+Ue));(We[21589]||{}).mt&&(Ae=We[21589].mt),((Q||{})[21589]||{}).mt&&(Ae=Q[21589].mt)}B.l+=Ue;var Ze=B.slice(B.l,B.l+xe);switch(de){case 8:Ze=G(B,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var $t=!1;te&8&&(me=B.read_shift(4),me==134695760&&(me=B.read_shift(4),$t=!0),xe=B.read_shift(4),ge=B.read_shift(4)),xe!=J&&oo($t,"Bad compressed size: "+J+" != "+xe),ge!=W&&oo($t,"Bad uncompressed size: "+W+" != "+ge),ai(K,Xe,Ze,{unsafe:!0,mt:Ae})}function Cr(B,J){var W=J||{},K=[],Q=[],te=Se(1),de=W.compression?8:0,Ae=0,me=0,xe=0,ge=0,Be=0,Ue=B.FullPaths[0],Xe=Ue,Le=B.FileIndex[0],We=[],Ze=0;for(me=1;me<B.FullPaths.length;++me)if(Xe=B.FullPaths[me].slice(Ue.length),Le=B.FileIndex[me],!(!Le.size||!Le.content||Xe=="Sh33tJ5")){var $t=ge,Kt=Se(Xe.length);for(xe=0;xe<Xe.length;++xe)Kt.write_shift(1,Xe.charCodeAt(xe)&127);Kt=Kt.slice(0,Kt.l),We[Be]=M7.buf(Le.content,0);var cr=Le.content;de==8&&(cr=Y(cr)),te=Se(30),te.write_shift(4,67324752),te.write_shift(2,20),te.write_shift(2,Ae),te.write_shift(2,de),Le.mt?i(te,Le.mt):te.write_shift(4,0),te.write_shift(-4,We[Be]),te.write_shift(4,cr.length),te.write_shift(4,Le.content.length),te.write_shift(2,Kt.length),te.write_shift(2,0),ge+=te.length,K.push(te),ge+=Kt.length,K.push(Kt),ge+=cr.length,K.push(cr),te=Se(46),te.write_shift(4,33639248),te.write_shift(2,0),te.write_shift(2,20),te.write_shift(2,Ae),te.write_shift(2,de),te.write_shift(4,0),te.write_shift(-4,We[Be]),te.write_shift(4,cr.length),te.write_shift(4,Le.content.length),te.write_shift(2,Kt.length),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(4,0),te.write_shift(4,$t),Ze+=te.l,Q.push(te),Ze+=Kt.length,Q.push(Kt),++Be}return te=Se(22),te.write_shift(4,101010256),te.write_shift(2,0),te.write_shift(2,0),te.write_shift(2,Be),te.write_shift(2,Be),te.write_shift(4,Ze),te.write_shift(4,ge),te.write_shift(2,0),mn([mn(K),mn(Q),te])}var qn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Da(B,J){if(B.ctype)return B.ctype;var W=B.name||"",K=W.match(/\.([^\.]+)$/);return K&&qn[K[1]]||J&&(K=(W=J).match(/[\.\\]([^\.\\])+$/),K&&qn[K[1]])?qn[K[1]]:"application/octet-stream"}function pa(B){for(var J=_0(B),W=[],K=0;K<J.length;K+=76)W.push(J.slice(K,K+76));return W.join(`\r
`)+`\r
`}function Uu(B){var J=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var ge=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});J=J.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),J.charAt(0)==`
`&&(J="=0D"+J.slice(1)),J=J.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var W=[],K=J.split(`\r
`),Q=0;Q<K.length;++Q){var te=K[Q];if(te.length==0){W.push("");continue}for(var de=0;de<te.length;){var Ae=76,me=te.slice(de,de+Ae);me.charAt(Ae-1)=="="?Ae--:me.charAt(Ae-2)=="="?Ae-=2:me.charAt(Ae-3)=="="&&(Ae-=3),me=te.slice(de,de+Ae),de+=Ae,de<te.length&&(me+="="),W.push(me)}}return W.join(`\r
`)}function mc(B){for(var J=[],W=0;W<B.length;++W){for(var K=B[W];W<=B.length&&K.charAt(K.length-1)=="=";)K=K.slice(0,K.length-1)+B[++W];J.push(K)}for(var Q=0;Q<J.length;++Q)J[Q]=J[Q].replace(/[=][0-9A-Fa-f]{2}/g,function(te){return String.fromCharCode(parseInt(te.slice(1),16))});return ka(J.join(`\r
`))}function Oa(B,J,W){for(var K="",Q="",te="",de,Ae=0;Ae<10;++Ae){var me=J[Ae];if(!me||me.match(/^\s*$/))break;var xe=me.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":K=xe[2].trim();break;case"content-type":te=xe[2].trim();break;case"content-transfer-encoding":Q=xe[2].trim();break}}switch(++Ae,Q.toLowerCase()){case"base64":de=ka(Ia(J.slice(Ae).join("")));break;case"quoted-printable":de=mc(J.slice(Ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Q)}var ge=ai(B,K.slice(W.length),de,{unsafe:!0});te&&(ge.ctype=te)}function ri(B,J){if(ie(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var W=J&&J.root||"",K=(St&&Buffer.isBuffer(B)?B.toString("binary"):ie(B)).split(`\r
`),Q=0,te="";for(Q=0;Q<K.length;++Q)if(te=K[Q],!!/^Content-Location:/i.test(te)&&(te=te.slice(te.indexOf("file")),W||(W=te.slice(0,te.lastIndexOf("/")+1)),te.slice(0,W.length)!=W))for(;W.length>0&&(W=W.slice(0,W.length-1),W=W.slice(0,W.lastIndexOf("/")+1),te.slice(0,W.length)!=W););var de=(K[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var Ae="--"+(de[1]||""),me=[],xe=[],ge={FileIndex:me,FullPaths:xe};A(ge);var Be,Ue=0;for(Q=0;Q<K.length;++Q){var Xe=K[Q];Xe!==Ae&&Xe!==Ae+"--"||(Ue++&&Oa(ge,K.slice(Be,Q),W),Be=Q)}return ge}function zu(B,J){var W=J||{},K=W.boundary||"SheetJS";K="------="+K;for(var Q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+K.slice(2)+'"',"","",""],te=B.FullPaths[0],de=te,Ae=B.FileIndex[0],me=1;me<B.FullPaths.length;++me)if(de=B.FullPaths[me].slice(te.length),Ae=B.FileIndex[me],!(!Ae.size||!Ae.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ze){return"_x"+Ze.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ze){return"_u"+Ze.charCodeAt(0).toString(16)+"_"});for(var xe=Ae.content,ge=St&&Buffer.isBuffer(xe)?xe.toString("binary"):ie(xe),Be=0,Ue=Math.min(1024,ge.length),Xe=0,Le=0;Le<=Ue;++Le)(Xe=ge.charCodeAt(Le))>=32&&Xe<128&&++Be;var We=Be>=Ue*4/5;Q.push(K),Q.push("Content-Location: "+(W.root||"file:///C:/SheetJS/")+de),Q.push("Content-Transfer-Encoding: "+(We?"quoted-printable":"base64")),Q.push("Content-Type: "+Da(Ae,de)),Q.push(""),Q.push(We?Uu(ge):pa(ge))}return Q.push(K+`--\r
`),Q.join(`\r
`)}function ni(B){var J={};return A(J,B),J}function ai(B,J,W,K){var Q=K&&K.unsafe;Q||A(B);var te=!Q&&st.find(B,J);if(!te){var de=B.FullPaths[0];J.slice(0,de.length)==de?de=J:(de.slice(-1)!="/"&&(de+="/"),de=(de+J).replace("//","/")),te={name:a(J),type:2},B.FileIndex.push(te),B.FullPaths.push(de),Q||st.utils.cfb_gc(B)}return te.content=W,te.size=W?W.length:0,K&&(K.CLSID&&(te.clsid=K.CLSID),K.mt&&(te.mt=K.mt),K.ct&&(te.ct=K.ct)),te}function co(B,J){A(B);var W=st.find(B,J);if(W){for(var K=0;K<B.FileIndex.length;++K)if(B.FileIndex[K]==W)return B.FileIndex.splice(K,1),B.FullPaths.splice(K,1),!0}return!1}function si(B,J,W){A(B);var K=st.find(B,J);if(K){for(var Q=0;Q<B.FileIndex.length;++Q)if(B.FileIndex[Q]==K)return B.FileIndex[Q].name=a(W),B.FullPaths[Q]=W,!0}return!1}function ss(B){R(B,!0)}return e.find=O,e.read=q,e.parse=p,e.write=Ve,e.writeFile=Ee,e.utils={cfb_new:ni,cfb_add:ai,cfb_del:co,cfb_mov:si,cfb_gc:ss,ReadShift:t0,CheckField:zN,prep_blob:En,bconcat:mn,use_zlib:P,_deflateRaw:dt,_inflateRaw:as,consts:se},e})();function L7(t){return typeof t=="string"?Cp(t):Array.isArray(t)?u7(t):t}function rh(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Cp(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?zs(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([L7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=so(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function B7(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function jr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function XT(t,e){for(var r=[],n=jr(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function Ip(t){for(var e=[],r=jr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Dp(t){for(var e=[],r=jr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function V7(t){for(var e=[],r=jr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Vm=new Date(1899,11,30,0,0,0);function ln(t,e){var r=t.getTime(),n=Vm.getTime()+(t.getTimezoneOffset()-Vm.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var bN=new Date,U7=Vm.getTime()+(bN.getTimezoneOffset()-Vm.getTimezoneOffset())*6e4,YT=bN.getTimezoneOffset();function Op(t){var e=new Date;return e.setTime(t*24*60*60*1e3+U7),e.getTimezoneOffset()!==YT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-YT)*6e4),e}function z7(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[i],10)}return e}var $T=new Date("2017-02-19T19:06:09.000Z"),wN=isNaN($T.getFullYear())?new Date("2/19/17"):$T,H7=wN.getFullYear()==2017;function yr(t,e){var r=new Date(t);if(H7)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(wN.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Zo(t,e){if(St&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return zs(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return zs(cN(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return zs(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return zs(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function _r(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=_r(t[r]));return e}function Dr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ts(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var q7=["january","february","march","april","may","june","july","august","september","october","november","december"];function Tu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&q7.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var G7=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],u=1;u<i.length;++u)o.push(a),o.push(i[u]);return o}})();function EN(t){return t?t.content&&t.type?Zo(t.content,!0):t.data?Wf(t.data):t.asNodeBuffer&&St?Wf(t.asNodeBuffer().toString("binary")):t.asBinary?Wf(t.asBinary()):t._data&&t._data.getContent?Wf(Zo(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function TN(t){if(!t)return null;if(t.data)return MT(t.data);if(t.asNodeBuffer&&St)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?MT(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function W7(t){return t&&t.name.slice(-4)===".bin"?TN(t):EN(t)}function $a(t,e){for(var r=t.FullPaths||jr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function Oy(t,e){var r=$a(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Kr(t,e,r){if(!r)return W7(Oy(t,e));if(!e)return null;try{return Kr(t,e)}catch{return null}}function Na(t,e,r){if(!r)return EN(Oy(t,e));if(!e)return null;try{return Na(t,e)}catch{return null}}function X7(t,e,r){return TN(Oy(t,e))}function KT(t){for(var e=t.FullPaths||jr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Et(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return St?n=zi(r):n=f7(r),st.utils.cfb_add(t,e,n)}st.utils.cfb_add(t,e,r)}else t.file(e,r)}function Fy(){return st.utils.cfb_new()}function SN(t,e){switch(e.type){case"base64":return st.read(t,{type:"base64"});case"binary":return st.read(t,{type:"binary"});case"buffer":case"array":return st.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Yf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var zr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Y7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,QT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,$7=/<[^>]*>/g,zn=zr.match(QT)?QT:$7,K7=/<\w*:/,Q7=/<(\/?)\w+:/;function mt(t,e,r){for(var n={},a=0,i=0;a!==t.length&&!((i=t.charCodeAt(a))===32||i===10||i===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var o=t.match(Y7),u=0,f="",h=0,p="",x="",y=1;if(o)for(h=0;h!=o.length;++h){for(x=o[h],i=0;i!=x.length&&x.charCodeAt(i)!==61;++i);for(p=x.slice(0,i).trim();x.charCodeAt(i+1)==32;)++i;for(y=(a=x.charCodeAt(i+1))==34||a==39?1:0,f=x.slice(i+1+y,x.length-y),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=f,n[p.toLowerCase()]=f;else{var b=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[b]&&p.slice(u-3,u)=="ext")continue;n[b]=f,n[b.toLowerCase()]=f}}return n}function Zs(t){return t.replace(Q7,"<$1")}var AN={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},jy=Ip(AN),Lt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(t,function(u,f){return AN[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,f){return String.fromCharCode(parseInt(f,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}})(),Py=/[&<>'"]/g,J7=/[\u0000-\u0008\u000b-\u001f]/g;function rr(t){var e=t+"";return e.replace(Py,function(r){return jy[r]}).replace(J7,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function JT(t){return rr(t).replace(/ /g,"_x0020_")}var kN=/[\u0000-\u001f]/g;function My(t){var e=t+"";return e.replace(Py,function(r){return jy[r]}).replace(/\n/g,"<br/>").replace(kN,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Z7(t){var e=t+"";return e.replace(Py,function(r){return jy[r]}).replace(kN,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var ZT=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function eB(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function xr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ax(t){for(var e="",r=0,n=0,a=0,i=0,o=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function eS(t){var e=Kl(2*t.length),r,n,a=1,i=0,o=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function tS(t){return zi(t,"binary").toString("utf8")}var zd="foo bar baz",lr=St&&(tS(zd)==ax(zd)&&tS||eS(zd)==ax(zd)&&eS)||ax,zs=St?function(t){return zi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},w0=(function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),NN=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}})(),tB=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),rB=/<\/?(?:vt:)?variant>/g,nB=/<(?:vt:)([^>]*)>([\s\S]*)</;function rS(t,e){var r=mt(t),n=t.match(tB(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace(rB,"").match(nB);o&&a.push({v:lr(o[2]),t:o[1]})}),a}var CN=/(^\s|\s$|\n)/;function Sn(t,e){return"<"+t+(e.match(CN)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function E0(t){return jr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function He(t,e,r){return"<"+t+(r!=null?E0(r):"")+(e!=null?(e.match(CN)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function ev(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function aB(t,e){switch(typeof t){case"string":var r=He("vt:lpwstr",rr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return He((t|0)==t?"vt:i4":"vt:r8",rr(String(t)));case"boolean":return He("vt:bool",t?"true":"false")}if(t instanceof Date)return He("vt:filetime",ev(t));throw new Error("Unable to serialize "+t)}function Ly(t){if(St&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return lr(so(Ry(t)));throw new Error("Bad input format: expected Buffer or string")}var T0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,nn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},oc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Sa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function sB(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,i=5;i>=0;--i)a=a*256+t[e+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function iB(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,i=0,o=n?-e:e;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(e)?26985:0);for(var u=0;u<=5;++u,i/=256)t[r+u]=i&255;t[r+6]=(a&15)<<4|i&15,t[r+7]=a>>4|n}var nS=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,i=t[0][n].length;a<i;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},aS=St?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:zi(e)})):nS(t)}:nS,sS=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(ki(t,a)));return n.join("").replace(Qn,"")},By=St?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Qn,""):sS(t,e,r)}:sS,iS=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},RN=St?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):iS(t,e,r)}:iS,lS=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(su(t,a)));return n.join("")},nh=St?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):lS(e,r,n)}:lS,IN=function(t,e){var r=Aa(t,e);return r>0?nh(t,e+4,e+4+r-1):""},DN=IN,ON=function(t,e){var r=Aa(t,e);return r>0?nh(t,e+4,e+4+r-1):""},FN=ON,jN=function(t,e){var r=2*Aa(t,e);return r>0?nh(t,e+4,e+4+r-1):""},PN=jN,MN=function(e,r){var n=Aa(e,r);return n>0?By(e,r+4,r+4+n):""},LN=MN,BN=function(t,e){var r=Aa(t,e);return r>0?nh(t,e+4,e+4+r):""},VN=BN,UN=function(t,e){return sB(t,e)},Um=UN,Vy=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};St&&(DN=function(e,r){if(!Buffer.isBuffer(e))return IN(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},FN=function(e,r){if(!Buffer.isBuffer(e))return ON(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},PN=function(e,r){if(!Buffer.isBuffer(e))return jN(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},LN=function(e,r){if(!Buffer.isBuffer(e))return MN(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},VN=function(e,r){if(!Buffer.isBuffer(e))return BN(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Um=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):UN(e,r)},Vy=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var su=function(t,e){return t[e]},ki=function(t,e){return t[e+1]*256+t[e]},lB=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Aa=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Po=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},oB=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function t0(t,e){var r="",n,a,i=[],o,u,f,h;switch(e){case"dbcs":if(h=this.l,St&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(ki(this,h)),h+=2;t*=2;break;case"utf8":r=nh(this,this.l,this.l+t);break;case"utf16le":t*=2,r=By(this,this.l,this.l+t);break;case"wstr":return t0.call(this,t,"dbcs");case"lpstr-ansi":r=DN(this,this.l),t=4+Aa(this,this.l);break;case"lpstr-cp":r=FN(this,this.l),t=4+Aa(this,this.l);break;case"lpwstr":r=PN(this,this.l),t=4+2*Aa(this,this.l);break;case"lpp4":t=4+Aa(this,this.l),r=LN(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Aa(this,this.l),r=VN(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=su(this,this.l+t++))!==0;)i.push(Ud(o));r=i.join("");break;case"_wstr":for(t=0,r="";(o=ki(this,this.l+t))!==0;)i.push(Ud(o)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",h=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return o=su(this,h),this.l=h+1,u=t0.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Ud(ki(this,h))),h+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(h)!==-1)return o=su(this,h),this.l=h+1,u=t0.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Ud(su(this,h))),h+=1}r=i.join("");break;default:switch(t){case 1:return n=su(this,this.l),this.l++,n;case 2:return n=(e==="i"?lB:ki)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Po:oB)(this,this.l),this.l+=4,n):(a=Aa(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=Um(this,this.l):a=Um([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=RN(this,this.l,t);break}}return this.l+=t,r}var cB=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},uB=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},fB=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function hB(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)fB(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,cB(this,e,this.l);break;case 8:if(n=8,r==="f"){iB(this,e,this.l);break}case 16:break;case-4:n=4,uB(this,e,this.l);break}return this.l+=n,this}function zN(t,e){var r=RN(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function En(t,e){t.l=e,t.read_shift=t0,t.chk=zN,t.write_shift=hB}function Un(t,e){t.l+=e}function Se(t){var e=Kl(t);return En(e,0),e}function Hi(t,e,r){if(t){var n,a,i;En(t,t.l||0);for(var o=t.length,u=0,f=0;t.l<o;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var h=R0[u]||R0[65535];for(n=t.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=t.read_shift(1))&127)<<7*a;f=t.l+i;var p=h.f&&h.f(t,i,r);if(t.l=f,e(p,h,u))return}}}function fa(){var t=[],e=St?256:2048,r=function(h){var p=Se(h);return En(p,0),p},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(h){return n&&h<n.length-n.l?n:(a(),n=r(Math.max(h+1,e)))},o=function(){return a(),mn(t)},u=function(h){a(),n=h,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:u,end:o,_bufs:t}}function Me(t,e,r,n){var a=+e,i;if(!isNaN(a)){n||(n=R0[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=t.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Vy(r)&&t.push(r)}}function r0(t,e,r){var n=_r(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function oS(t,e,r){var n=_r(t);return n.s=r0(n.s,e.s,r),n.e=r0(n.e,e.s,r),n}function n0(t,e){if(t.cRel&&t.c<0)for(t=_r(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=_r(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ct(t);return!t.cRel&&t.cRel!=null&&(r=pB(r)),!t.rRel&&t.rRel!=null&&(r=dB(r)),r}function sx(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Ar(t.s.c)+":"+(t.e.cRel?"":"$")+Ar(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ur(t.s.r)+":"+(t.e.rRel?"":"$")+Ur(t.e.r):n0(t.s,e.biff)+":"+n0(t.e,e.biff)}function Uy(t){return parseInt(mB(t),10)-1}function Ur(t){return""+(t+1)}function dB(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function mB(t){return t.replace(/\$(\d+)$/,"$1")}function zy(t){for(var e=gB(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Ar(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function pB(t){return t.replace(/^([A-Z])/,"$$$1")}function gB(t){return t.replace(/^\$([A-Z])/,"$1")}function xB(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function kr(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function ct(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ha(t){var e=t.indexOf(":");return e==-1?{s:kr(t),e:kr(t)}:{s:kr(t.slice(0,e)),e:kr(t.slice(e+1))}}function bt(t,e){return typeof e>"u"||typeof e=="number"?bt(t.s,t.e):(typeof t!="string"&&(t=ct(t)),typeof e!="string"&&(e=ct(e)),t==e?t:t+":"+e)}function Bt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=t.length;for(r=0;n<i&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<i&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===i||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=i&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function cS(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=es(t.z,r?ln(e):e)}catch{}try{return t.w=es((t.XF||{}).numFmtId||(r?14:0),r?ln(e):e)}catch{return""+e}}function Bi(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?qi[t.v]||t.v:e==null?cS(t,t.v):cS(t,e))}function io(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function HN(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,i=t||(a?[]:{}),o=0,u=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?kr(n.origin):n.origin;o=f.r,u=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var p=Bt(i["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),o==-1&&(h.e.r=o=p.e.r+1)}for(var x=0;x!=e.length;++x)if(e[x]){if(!Array.isArray(e[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=e[x].length;++y)if(!(typeof e[x][y]>"u")){var b={v:e[x][y]},w=o+x,T=u+y;if(h.s.r>w&&(h.s.r=w),h.s.c>T&&(h.s.c=T),h.e.r<w&&(h.e.r=w),h.e.c<T&&(h.e.c=T),e[x][y]&&typeof e[x][y]=="object"&&!Array.isArray(e[x][y])&&!(e[x][y]instanceof Date))b=e[x][y];else if(Array.isArray(b.v)&&(b.f=e[x][y][1],b.v=b.v[0]),b.v===null)if(b.f)b.t="n";else if(n.nullError)b.t="e",b.v=0;else if(n.sheetStubs)b.t="z";else continue;else typeof b.v=="number"?b.t="n":typeof b.v=="boolean"?b.t="b":b.v instanceof Date?(b.z=n.dateNF||ot[14],n.cellDates?(b.t="d",b.w=es(b.z,ln(b.v))):(b.t="n",b.v=ln(b.v),b.w=es(b.z,b.v))):b.t="s";if(a)i[w]||(i[w]=[]),i[w][T]&&i[w][T].z&&(b.z=i[w][T].z),i[w][T]=b;else{var E=ct({c:T,r:w});i[E]&&i[E].z&&(b.z=i[E].z),i[E]=b}}}return h.s.c<1e7&&(i["!ref"]=bt(h)),i}function Bu(t,e){return HN(null,t,e)}function vB(t){return t.read_shift(4,"i")}function Ss(t,e){return e||(e=Se(4)),e.write_shift(4,t),e}function Bn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function pn(t,e){var r=!1;return e==null&&(r=!0,e=Se(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function yB(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function _B(t,e){return e||(e=Se(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Hy(t,e){var r=t.l,n=t.read_shift(1),a=Bn(t),i=[],o={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)i.push(yB(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function bB(t,e){var r=!1;return e==null&&(r=!0,e=Se(15+4*t.t.length)),e.write_shift(1,0),pn(t.t,e),r?e.slice(0,e.l):e}var wB=Hy;function EB(t,e){var r=!1;return e==null&&(r=!0,e=Se(23+4*t.t.length)),e.write_shift(1,1),pn(t.t,e),e.write_shift(4,1),_B({},e),r?e.slice(0,e.l):e}function rs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function cc(t,e){return e==null&&(e=Se(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function uc(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function fc(t,e){return e==null&&(e=Se(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var TB=Bn,qN=pn;function qy(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function zm(t,e){var r=!1;return e==null&&(r=!0,e=Se(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var SB=Bn,tv=qy,Gy=zm;function Wy(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?Um([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Po(e,0)>>2;return r?a/100:a}function GN(t,e){e==null&&(e=Se(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function WN(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function AB(t,e){return e||(e=Se(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var hc=WN,Vu=AB;function Ln(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function ec(t,e){return(e||Se(8)).write_shift(8,t,"f")}function kB(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var h=Ho[a];h&&(e.rgb=A0(h));break;case 2:e.rgb=A0([o,u,f]);break;case 3:e.theme=a;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function Hm(t,e){if(e||(e=Se(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function NB(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function CB(t,e){e||(e=Se(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function XN(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function RB(t){return XN(t,1)}function IB(t){return XN(t,2)}var Xy=2,ia=3,Hd=11,uS=12,qm=19,qd=64,DB=65,OB=71,FB=4108,jB=4126,dn=80,YN=81,PB=[dn,YN],rv={1:{n:"CodePage",t:Xy},2:{n:"Category",t:dn},3:{n:"PresentationFormat",t:dn},4:{n:"ByteCount",t:ia},5:{n:"LineCount",t:ia},6:{n:"ParagraphCount",t:ia},7:{n:"SlideCount",t:ia},8:{n:"NoteCount",t:ia},9:{n:"HiddenCount",t:ia},10:{n:"MultimediaClipCount",t:ia},11:{n:"ScaleCrop",t:Hd},12:{n:"HeadingPairs",t:FB},13:{n:"TitlesOfParts",t:jB},14:{n:"Manager",t:dn},15:{n:"Company",t:dn},16:{n:"LinksUpToDate",t:Hd},17:{n:"CharacterCount",t:ia},19:{n:"SharedDoc",t:Hd},22:{n:"HyperlinksChanged",t:Hd},23:{n:"AppVersion",t:ia,p:"version"},24:{n:"DigSig",t:DB},26:{n:"ContentType",t:dn},27:{n:"ContentStatus",t:dn},28:{n:"Language",t:dn},29:{n:"Version",t:dn},255:{},2147483648:{n:"Locale",t:qm},2147483651:{n:"Behavior",t:qm},1919054434:{}},nv={1:{n:"CodePage",t:Xy},2:{n:"Title",t:dn},3:{n:"Subject",t:dn},4:{n:"Author",t:dn},5:{n:"Keywords",t:dn},6:{n:"Comments",t:dn},7:{n:"Template",t:dn},8:{n:"LastAuthor",t:dn},9:{n:"RevNumber",t:dn},10:{n:"EditTime",t:qd},11:{n:"LastPrinted",t:qd},12:{n:"CreatedDate",t:qd},13:{n:"ModifiedDate",t:qd},14:{n:"PageCount",t:ia},15:{n:"WordCount",t:ia},16:{n:"CharCount",t:ia},17:{n:"Thumbnail",t:OB},18:{n:"Application",t:dn},19:{n:"DocSecurity",t:ia},255:{},2147483648:{n:"Locale",t:qm},2147483651:{n:"Behavior",t:qm},1919054434:{}},fS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},MB=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function LB(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var BB=LB([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ho=_r(BB),qi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},$N={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},av={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Gd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Yy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function VB(t){var e=Yy();if(!t||!t.match)return e;var r={};if((t.match(zn)||[]).forEach(function(n){var a=mt(n);switch(a[0].replace(K7,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[av[a.ContentType]]!==void 0&&e[av[a.ContentType]].push(a.PartName);break}}),e.xmlns!==nn.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function KN(t,e){var r=V7(av),n=[],a;n[n.length]=zr,n[n.length]=He("Types",null,{xmlns:nn.CT,"xmlns:xsd":nn.xsd,"xmlns:xsi":nn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return He("Default",null,{Extension:f[0],ContentType:f[1]})}));var i=function(f){t[f]&&t[f].length>0&&(a=t[f][0],n[n.length]=He("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Gd[f][e.bookType]||Gd[f].xlsx}))},o=function(f){(t[f]||[]).forEach(function(h){n[n.length]=He("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Gd[f][e.bookType]||Gd[f].xlsx})})},u=function(f){(t[f]||[]).forEach(function(h){n[n.length]=He("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[f][0]})})};return i("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var At={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function S0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function a0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(zn)||[]).forEach(function(a){var i=mt(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var u=i.TargetMode==="External"?i.Target:Yf(i.Target,e);r[u]=o,n[i.Id]=o}}),r["!id"]=n,r}function du(t){var e=[zr,He("Relationships",null,{xmlns:nn.RELS})];return jr(t["!id"]).forEach(function(r){e[e.length]=He("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function tr(t,e,r,n,a,i){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[At.HLINK,At.XPATH,At.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var UB="application/vnd.oasis.opendocument.spreadsheet";function zB(t,e){for(var r=Ly(t),n,a;n=T0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=mt(n[0],!1),a.path=="/"&&a.type!==UB)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function HB(t){var e=[zr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function hS(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function qB(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function GB(t){var e=[zr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(hS(t[r][0],t[r][1])),e.push(qB("",t[r][0]));return e.push(hS("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function QN(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Pm.version+"</meta:generator></office:meta></office:document-meta>"}var Za=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],WB=(function(){for(var t=new Array(Za.length),e=0;e<Za.length;++e){var r=Za[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function JN(t){var e={};t=lr(t);for(var r=0;r<Za.length;++r){var n=Za[r],a=t.match(WB[r]);a!=null&&a.length>0&&(e[n[1]]=Lt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=yr(e[n[1]]))}return e}function ix(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=rr(e),n[n.length]=r?He(t,e,r):Sn(t,e))}function ZN(t,e){var r=e||{},n=[zr,He("cp:coreProperties",null,{"xmlns:cp":nn.CORE_PROPS,"xmlns:dc":nn.dc,"xmlns:dcterms":nn.dcterms,"xmlns:dcmitype":nn.dcmitype,"xmlns:xsi":nn.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&ix("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:ev(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&ix("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:ev(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Za.length;++i){var o=Za[i],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&ix(o[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var qo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],eC=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function tC(t,e,r,n){var a=[];if(typeof t=="string")a=rS(t,n);else for(var i=0;i<t.length;++i)a=a.concat(t[i].map(function(p){return{v:p}}));var o=typeof e=="string"?rS(e,n).map(function(p){return p.v}):e,u=0,f=0;if(o.length>0)for(var h=0;h!==a.length;h+=2){switch(f=+a[h+1].v,a[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=o.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=o.slice(u,u+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=o.slice(u,u+f);break}u+=f}}function XB(t,e,r){var n={};return e||(e={}),t=lr(t),qo.forEach(function(a){var i=(t.match(w0(a[0]))||[])[1];switch(a[2]){case"string":i&&(e[a[1]]=Lt(i));break;case"bool":e[a[1]]=i==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&tC(n.HeadingPairs,n.TitlesOfParts,e,r),e}function rC(t){var e=[],r=He;return t||(t={}),t.Application="SheetJS",e[e.length]=zr,e[e.length]=He("Properties",null,{xmlns:nn.EXT_PROPS,"xmlns:vt":nn.vt}),qo.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=rr(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+rr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var YB=/<[^>]+>[^<]*/g;function $B(t,e){var r={},n="",a=t.match(YB);if(a)for(var i=0;i!=a.length;++i){var o=a[i],u=mt(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Lt(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var f=o.split(">"),h=f[0].slice(4),p=f[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[n]=Lt(p);break;case"bool":r[n]=xr(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=yr(p);break;case"cy":case"error":r[n]=Lt(p);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,f)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function nC(t){var e=[zr,He("Properties",null,{xmlns:nn.CUST_PROPS,"xmlns:vt":nn.vt})];if(!t)return e.join("");var r=1;return jr(t).forEach(function(a){++r,e[e.length]=He("property",aB(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:rr(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var sv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},lx;function KB(t,e,r){lx||(lx=Ip(sv)),e=lx[e]||e,t[e]=r}function QB(t,e){var r=[];return jr(sv).map(function(n){for(var a=0;a<Za.length;++a)if(Za[a][1]==n)return Za[a];for(a=0;a<qo.length;++a)if(qo[a][1]==n)return qo[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Sn(sv[n[1]]||n[1],a))}}),He("DocumentProperties",r.join(""),{xmlns:Sa.o})}function JB(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&jr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<Za.length;++o)if(i==Za[o][1])return;for(o=0;o<qo.length;++o)if(i==qo[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var u=t[i],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),a.push(He(JT(i),u,{"dt:dt":f}))}}),e&&jr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=e[i],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),a.push(He(JT(i),o,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Sa.o+'">'+a.join("")+"</"+n+">"}function $y(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ZB(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var o=Se(8);return o.write_shift(4,n),o.write_shift(4,a),o}function aC(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function sC(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function iC(t,e,r){return e===31?sC(t):aC(t,e,r)}function iv(t,e,r){return iC(t,e,r===!1?0:4)}function eV(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return iC(t,e,0)}function tV(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Qn,""),t.l-a&2&&(t.l+=2)}return r}function rV(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Qn,"");return r}function nV(t){var e=t.l,r=Gm(t,YN);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Gm(t,ia);return[r,n]}function aV(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(nV(t));return r}function dS(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var i=t.read_shift(4),o=t.read_shift(4);n[i]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Qn,"").replace(Xf,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function lC(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function sV(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Gm(t,e,r){var n=t.read_shift(2),a,i=r||{};if(t.l+=2,e!==uS&&n!==e&&PB.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===uS?n:e){case 2:return a=t.read_shift(2,"i"),i.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return aC(t,n,4).replace(Qn,"");case 31:return sC(t);case 64:return $y(t);case 65:return lC(t);case 71:return sV(t);case 80:return iv(t,n,!i.raw).replace(Qn,"");case 81:return eV(t,n).replace(Qn,"");case 4108:return aV(t);case 4126:case 4127:return n==4127?tV(t):rV(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function mS(t,e){var r=Se(4),n=Se(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Se(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=ZB(e);break;case 31:case 80:for(n=Se(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return mn([r,n])}function pS(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),i=[],o=0,u=0,f=-1,h={};for(o=0;o!=a;++o){var p=t.read_shift(4),x=t.read_shift(4);i[o]=[p,x+r]}i.sort(function(I,N){return I[1]-N[1]});var y={};for(o=0;o!=a;++o){if(t.l!==i[o][1]){var b=!0;if(o>0&&e)switch(e[i[o-1][0]].t){case 2:t.l+2===i[o][1]&&(t.l+=2,b=!1);break;case 80:t.l<=i[o][1]&&(t.l=i[o][1],b=!1);break;case 4108:t.l<=i[o][1]&&(t.l=i[o][1],b=!1);break}if((!e||o==0)&&t.l<=i[o][1]&&(b=!1,t.l=i[o][1]),b)throw new Error("Read Error: Expected address "+i[o][1]+" at "+t.l+" :"+o)}if(e){var w=e[i[o][0]];if(y[w.n]=Gm(t,w.t,{raw:!0}),w.p==="version"&&(y[w.n]=String(y[w.n]>>16)+"."+("0000"+String(y[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(y[w.n]){case 0:y[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ws(u=y[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[w.n])}}else if(i[o][0]===1){if(u=y.CodePage=Gm(t,Xy),ws(u),f!==-1){var T=t.l;t.l=i[f][1],h=dS(t,u),t.l=T}}else if(i[o][0]===0){if(u===0){f=o,t.l=i[o+1][1];continue}h=dS(t,u)}else{var E=h[i[o][0]],k;switch(t[t.l]){case 65:t.l+=4,k=lC(t);break;case 30:t.l+=4,k=iv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,k=iv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,k=t.read_shift(4,"i");break;case 19:t.l+=4,k=t.read_shift(4);break;case 5:t.l+=4,k=t.read_shift(8,"f");break;case 11:t.l+=4,k=Br(t,4);break;case 64:t.l+=4,k=yr($y(t));break;default:throw new Error("unparsed value: "+t[t.l])}y[E]=k}}return t.l=r+n,y}var oC=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function iV(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function gS(t,e,r){var n=Se(8),a=[],i=[],o=8,u=0,f=Se(8),h=Se(8);if(f.write_shift(4,2),f.write_shift(4,1200),h.write_shift(4,1),i.push(f),a.push(h),o+=8+f.length,!e){h=Se(8),h.write_shift(4,0),a.unshift(h);var p=[Se(4)];for(p[0].write_shift(4,t.length),u=0;u<t.length;++u){var x=t[u][0];for(f=Se(8+2*(x.length+1)+(x.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,x.length+1),f.write_shift(0,x,"dbcs");f.l!=f.length;)f.write_shift(1,0);p.push(f)}f=mn(p),i.unshift(f),o+=8+f.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(oC.indexOf(t[u][0])>-1||eC.indexOf(t[u][0])>-1)&&t[u][1]!=null){var y=t[u][1],b=0;if(e){b=+e[t[u][0]];var w=r[b];if(w.p=="version"&&typeof y=="string"){var T=y.split(".");y=(+T[0]<<16)+(+T[1]||0)}f=mS(w.t,y)}else{var E=iV(y);E==-1&&(E=31,y=String(y)),f=mS(E,y)}i.push(f),h=Se(8),h.write_shift(4,e?b:2+u),a.push(h),o+=8+f.length}var k=8*(i.length+1);for(u=0;u<i.length;++u)a[u].write_shift(4,k),k+=i[u].length;return n.write_shift(4,o),n.write_shift(4,i.length),mn([n].concat(a).concat(i))}function xS(t,e,r){var n=t.content;if(!n)return{};En(n,0);var a,i,o,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),p=n.read_shift(16);if(p!==st.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(o=n.read_shift(16),f=n.read_shift(4));var x=pS(n,e),y={SystemIdentifier:h};for(var b in x)y[b]=x[b];if(y.FMTID=i,a===1)return y;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var w;try{w=pS(n,null)}catch{}for(b in w)y[b]=w[b];return y.FMTID=[i,o],y}function vS(t,e,r,n,a,i){var o=Se(a?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,st.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,a?68:48);var f=gS(t,r,n);if(u.push(f),a){var h=gS(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+f.length),u.push(h)}return mn(u)}function Tl(t,e){return t.read_shift(e),null}function lV(t,e){e||(e=Se(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function oV(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Br(t,e){return t.read_shift(e)===1}function Yn(t,e){return e||(e=Se(2)),e.write_shift(2,+!!t),e}function Qr(t){return t.read_shift(2,"u")}function Ka(t,e){return e||(e=Se(2)),e.write_shift(2,t),e}function cC(t,e){return oV(t,e,Qr)}function cV(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function uC(t,e,r){return r||(r=Se(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function ah(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?t.read_shift(n,a):"";return o}function uV(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,i=1+(r&1),o=0,u,f={};a&&(o=t.read_shift(2)),n&&(u=t.read_shift(4));var h=i==2?"dbcs-cont":"sbcs-cont",p=e===0?"":t.read_shift(e,h);return a&&(t.l+=4*o),n&&(t.l+=u),f.t=p,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function fV(t){var e=t.t||"",r=Se(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Se(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return mn(a)}function tc(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function sh(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):tc(t,n,r)}function dc(t,e,r){if(r.biff>5)return sh(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function fC(t,e,r){return r||(r=Se(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function hV(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function dV(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Qn,"");return n&&(t.l+=24),a}function mV(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(i>>1,"utf16le").replace(Qn,"");return r+o}function pV(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return dV(t);case"0303000000000000c000000000000046":return mV(t);default:throw new Error("Unsupported Moniker "+r)}}function Wd(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Qn,""):"";return r}function yS(t,e){e||(e=Se(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function gV(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var i,o,u,f,h="",p,x;a&16&&(i=Wd(t,r-t.l)),a&128&&(o=Wd(t,r-t.l)),(a&257)===257&&(u=Wd(t,r-t.l)),(a&257)===1&&(f=pV(t,r-t.l)),a&8&&(h=Wd(t,r-t.l)),a&32&&(p=t.read_shift(16)),a&64&&(x=$y(t)),t.l=r;var y=o||u||f||"";y&&h&&(y+="#"+h),y||(y="#"+h),a&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var b={Target:y};return p&&(b.guid=p),x&&(b.time=x),i&&(b.Tooltip=i),b}function xV(t){var e=Se(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(i==28)n=n.slice(1),yS(n,e);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),i&8&&yS(a>-1?n.slice(a+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)e.write_shift(1,n.charCodeAt(r+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function hC(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function dC(t,e){var r=hC(t);return r[3]=0,r}function ei(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function rc(t,e,r,n){return n||(n=Se(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function vV(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function yV(t,e,r){return e===0?"":dc(t,e,r)}function _V(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),i=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[a,i,o]}function mC(t){var e=t.read_shift(2),r=Wy(t);return[e,r]}function bV(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=ah(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,a}function Fp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function pC(t,e){return e||(e=Se(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function gC(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var wV=gC;function xC(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function EV(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function TV(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Dn(t){t.l+=2,t.l+=t.read_shift(2)}var SV={0:Dn,4:Dn,5:Dn,6:Dn,7:TV,8:Dn,9:Dn,10:Dn,11:Dn,12:Dn,13:EV,14:Dn,15:Dn,16:Dn,17:Dn,18:Dn,19:Dn,20:Dn,21:xC};function AV(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(SV[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Xd(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Ky(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Se(a);return i.write_shift(2,n),i.write_shift(2,e),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function kV(t,e){return e===0||t.read_shift(2),1200}function NV(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=dc(t,0,r);return t.read_shift(e+n-t.l),a}function CV(t,e){var r=!e||e.biff==8,n=Se(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function RV(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function IV(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=ah(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function DV(t,e){var r=!e||e.biff>=8?2:1,n=Se(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function OV(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),i=[],o=0;o!=a&&t.l<r;++o)i.push(uV(t));return i.Count=n,i.Unique=a,i}function FV(t,e){var r=Se(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=fV(t[a]);var i=mn([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function jV(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function PV(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function MV(t){var e=vV(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function LV(t){return t.read_shift(2),t.read_shift(4)}function _S(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function BV(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),u=t.read_shift(2),f=t.read_shift(2),h=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:u,Selected:f,TabRatio:h}}function VV(){var t=Se(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function UV(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function zV(t){var e=Se(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function HV(){}function qV(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=ah(t,0,r),n}function GV(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,i=Se(a);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function WV(t){var e=ei(t);return e.isst=t.read_shift(4),e}function XV(t,e,r,n){var a=Se(10);return rc(t,e,n,a),a.write_shift(4,r),a}function YV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=ei(t);r.biff==2&&t.l++;var i=sh(t,n-t.l,r);return a.val=i,a}function $V(t,e,r,n,a){var i=!a||a.biff==8,o=Se(8+ +i+(1+i)*r.length);return rc(t,e,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function KV(t,e,r){var n=t.read_shift(2),a=dc(t,0,r);return[n,a]}function QV(t,e,r,n){var a=r&&r.biff==5;n||(n=Se(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var JV=dc;function bS(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,i=t.read_shift(a),o=t.read_shift(a),u=t.read_shift(2),f=t.read_shift(2);return t.l=n,{s:{r:i,c:u},e:{r:o,c:f}}}function ZV(t,e){var r=e.biff==8||!e.biff?4:2,n=Se(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function eU(t){var e=t.read_shift(2),r=t.read_shift(2),n=mC(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function tU(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),i=[];t.l<r;)i.push(mC(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function rU(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function nU(t,e,r,n){var a={},i=t.read_shift(4),o=t.read_shift(4),u=t.read_shift(4),f=t.read_shift(2);return a.patternType=MB[u>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function aU(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=nU(t,e,n.fStyle,r),n}function wS(t,e,r,n){var a=r&&r.biff==5;n||(n=Se(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function sU(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function iU(t){var e=Se(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function ES(t,e,r){var n=ei(t);(r.biff==2||e==9)&&++t.l;var a=cV(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function lU(t,e,r,n,a,i){var o=Se(8);return rc(t,e,n,o),uC(r,i,o),o}function oU(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ei(t),a=Ln(t);return n.val=a,n}function cU(t,e,r,n){var a=Se(14);return rc(t,e,n,a),ec(r,a),a}var TS=yV;function uU(t,e,r){var n=t.l+e,a=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=tc(t,i),u=[];n>t.l;)u.push(sh(t));return[i,a,o,u]}function SS(t,e,r){var n=t.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=bV(t,e-2,r)),i.body=a||t.read_shift(e-2),typeof a=="string"&&(i.Name=a),i}var fU=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function AS(t,e,r){var n=t.l+e,a=t.read_shift(2),i=t.read_shift(1),o=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),f=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var h=tc(t,o,r);a&32&&(h=fU[h.charCodeAt(0)]);var p=n-t.l;r&&r.biff==2&&--p;var x=n==t.l||u===0||!(p>0)?[]:AG(t,p,r,u);return{chKey:i,Name:h,itab:f,rgce:x}}function vC(t,e,r){if(r.biff<8)return hU(t,e,r);for(var n=[],a=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(_V(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function hU(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=ah(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function dU(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),i=tc(t,n,r),o=tc(t,a,r);return[i,o]}function mU(t,e,r){var n=gC(t);t.l++;var a=t.read_shift(1);return e-=8,[kG(t,e,r),a,n]}function kS(t,e,r){var n=wV(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,TG(t,e,r)]}function pU(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function gU(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),u=dc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,o,i]}}function xU(t,e,r){return gU(t,e,r)}function vU(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Fp(t));return r}function yU(t){var e=Se(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)pC(t[r],e);return e}function _U(t,e,r){if(r&&r.biff<8)return wU(t,e,r);var n=xC(t),a=AV(t,e-22,n[1]);return{cmo:n,ft:a}}var bU={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function wU(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((bU[n]||Un)(t,e,r)),{cmo:[a,n,i],ft:o}}function EU(t,e,r){var n=t.l,a="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:o=hV(t,6,r);var u=t.read_shift(2);t.read_shift(2),Qr(t,2);var f=t.read_shift(2);t.l+=f;for(var h=1;h<t.lens.length-1;++h){if(t.l-n!=t.lens[h])throw new Error("TxO: bad continue record");var p=t[t.l],x=tc(t,t.lens[h+1]-t.lens[h]-1);if(a+=x,a.length>=(p?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function TU(t,e){var r=Fp(t);t.l+=16;var n=gV(t,e-24);return[r,n]}function SU(t){var e=Se(24),r=kr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return mn([e,xV(t[1])])}function AU(t,e){t.read_shift(2);var r=Fp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Qn,""),[r,n]}function kU(t){var e=t[1].Tooltip,r=Se(10+2*(e.length+1));r.write_shift(2,2048);var n=kr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function NU(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=fS[r]||r,r=t.read_shift(2),e[1]=fS[r]||r,e}function CU(t){return t||(t=Se(4)),t.write_shift(2,1),t.write_shift(2,1),t}function RU(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(dC(t));return r}function IU(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(dC(t));return r}function DU(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function yC(t,e,r){if(!r.cellStyles)return Un(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),u=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var h={s:a,e:i,w:o,ixfe:u,flags:f};return(r.biff>=5||!r.biff)&&(h.level=f>>8&7),h}function OU(t,e){var r=Se(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function FU(t,e){var r={};return e<32||(t.l+=16,r.header=Ln(t),r.footer=Ln(t),t.l+=2),r}function jU(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function PU(t){for(var e=Se(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var MU=ei,LU=cC,BU=sh;function VU(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function UU(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ei(t);++t.l;var a=dc(t,e-7,r);return n.t="str",n.val=a,n}function zU(t){var e=ei(t);++t.l;var r=Ln(t);return e.t="n",e.val=r,e}function HU(t,e,r){var n=Se(15);return ch(n,t,e),n.write_shift(8,r,"f"),n}function qU(t){var e=ei(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function GU(t,e,r){var n=Se(9);return ch(n,t,e),n.write_shift(2,r),n}function WU(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function XU(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function YU(t,e,r){var n=t.l+e,a=ei(t),i=t.read_shift(2),o=tc(t,i,r);return t.l=n,a.t="str",a.val=o,a}var $U=[2,3,48,49,131,139,140,245],lv=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Ip({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,f){var h=[],p=Kl(1);switch(f.type){case"base64":p=ka(Ia(u));break;case"binary":p=ka(u);break;case"buffer":case"array":p=u;break}En(p,0);var x=p.read_shift(1),y=!!(x&136),b=!1,w=!1;switch(x){case 2:break;case 3:break;case 48:b=!0,y=!0;break;case 49:b=!0,y=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var T=0,E=521;x==2&&(T=p.read_shift(2)),p.l+=3,x!=2&&(T=p.read_shift(4)),T>1048576&&(T=1e6),x!=2&&(E=p.read_shift(2));var k=p.read_shift(2),I=f.codepage||1252;x!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(I=t[p[p.l]]),p.l+=1,p.l+=2),w&&(p.l+=36);for(var N=[],z={},H=Math.min(p.length,x==2?521:E-10-(b?264:0)),q=w?32:11;p.l<H&&p[p.l]!=13;)switch(z={},z.name=y0.utils.decode(I,p.slice(p.l,p.l+q)).replace(/[\u0000\r\n].*$/g,""),p.l+=q,z.type=String.fromCharCode(p.read_shift(1)),x!=2&&!w&&(z.offset=p.read_shift(4)),z.len=p.read_shift(1),x==2&&(z.offset=p.read_shift(2)),z.dec=p.read_shift(1),z.name.length&&N.push(z),x!=2&&(p.l+=w?13:14),z.type){case"B":(!b||z.len!=8)&&f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(p[p.l]!==13&&(p.l=E-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=E;var A=0,F=0;for(h[0]=[],F=0;F!=N.length;++F)h[0][F]=N[F].name;for(;T-- >0;){if(p[p.l]===42){p.l+=k;continue}for(++p.l,h[++A]=[],F=0,F=0;F!=N.length;++F){var R=p.slice(p.l,p.l+N[F].len);p.l+=N[F].len,En(R,0);var M=y0.utils.decode(I,R);switch(N[F].type){case"C":M.trim().length&&(h[A][F]=M.replace(/\s+$/,""));break;case"D":M.length===8?h[A][F]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):h[A][F]=M;break;case"F":h[A][F]=parseFloat(M.trim());break;case"+":case"I":h[A][F]=w?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":h[A][F]=!0;break;case"N":case"F":h[A][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));h[A][F]="##MEMO##"+(w?parseInt(M.trim(),10):R.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(h[A][F]=+M||0);break;case"@":h[A][F]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":h[A][F]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":h[A][F]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[A][F]=-R.read_shift(-8,"f");break;case"B":if(b&&N[F].len==8){h[A][F]=R.read_shift(8,"f");break}case"G":case"P":R.l+=N[F].len;break;case"0":if(N[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[F].type)}}}if(x!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return f&&f.sheetRows&&(h=h.slice(0,f.sheetRows)),f.DBF=N,h}function n(u,f){var h=f||{};h.dateNF||(h.dateNF="yyyymmdd");var p=Bu(r(u,h),h);return p["!cols"]=h.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete h.DBF,p}function a(u,f){try{return io(n(u,f),f)}catch(h){if(f&&f.WTF)throw h}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,f){var h=f||{};if(+h.codepage>=0&&ws(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=fa(),x=$m(u,{header:1,raw:!0,cellDates:!0}),y=x[0],b=x.slice(1),w=u["!cols"]||[],T=0,E=0,k=0,I=1;for(T=0;T<y.length;++T){if(((w[T]||{}).DBF||{}).name){y[T]=w[T].DBF.name,++k;continue}if(y[T]!=null){if(++k,typeof y[T]=="number"&&(y[T]=y[T].toString(10)),typeof y[T]!="string")throw new Error("DBF Invalid column name "+y[T]+" |"+typeof y[T]+"|");if(y.indexOf(y[T])!==T){for(E=0;E<1024;++E)if(y.indexOf(y[T]+"_"+E)==-1){y[T]+="_"+E;break}}}}var N=Bt(u["!ref"]),z=[],H=[],q=[];for(T=0;T<=N.e.c-N.s.c;++T){var A="",F="",R=0,M=[];for(E=0;E<b.length;++E)b[E][T]!=null&&M.push(b[E][T]);if(M.length==0||y[T]==null){z[T]="?";continue}for(E=0;E<M.length;++E){switch(typeof M[E]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=M[E]instanceof Date?"D":"C";break;default:F="C"}R=Math.max(R,String(M[E]).length),A=A&&A!=F?"C":F}R>250&&(R=250),F=((w[T]||{}).DBF||{}).type,F=="C"&&w[T].DBF.len>R&&(R=w[T].DBF.len),A=="B"&&F=="N"&&(A="N",q[T]=w[T].DBF.dec,R=w[T].DBF.len),H[T]=A=="C"||F=="N"?R:i[A]||0,I+=H[T],z[T]=A}var O=p.next(32);for(O.write_shift(4,318902576),O.write_shift(4,b.length),O.write_shift(2,296+32*k),O.write_shift(2,I),T=0;T<4;++T)O.write_shift(4,0);for(O.write_shift(4,0|(+e[oN]||3)<<8),T=0,E=0;T<y.length;++T)if(y[T]!=null){var j=p.next(32),L=(y[T].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,L,"sbcs"),j.write_shift(1,z[T]=="?"?"C":z[T],"sbcs"),j.write_shift(4,E),j.write_shift(1,H[T]||i[z[T]]||0),j.write_shift(1,q[T]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),E+=H[T]||i[z[T]]||0}var Ne=p.next(264);for(Ne.write_shift(4,13),T=0;T<65;++T)Ne.write_shift(4,0);for(T=0;T<b.length;++T){var _e=p.next(I);for(_e.write_shift(1,0),E=0;E<y.length;++E)if(y[E]!=null)switch(z[E]){case"L":_e.write_shift(1,b[T][E]==null?63:b[T][E]?84:70);break;case"B":_e.write_shift(8,b[T][E]||0,"f");break;case"N":var ne="0";for(typeof b[T][E]=="number"&&(ne=b[T][E].toFixed(q[E]||0)),k=0;k<H[E]-ne.length;++k)_e.write_shift(1,32);_e.write_shift(1,ne,"sbcs");break;case"D":b[T][E]?(_e.write_shift(4,("0000"+b[T][E].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(b[T][E].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+b[T][E].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var se=String(b[T][E]!=null?b[T][E]:"").slice(0,H[E]);for(_e.write_shift(1,se,"sbcs"),k=0;k<H[E]-se.length;++k)_e.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}})(),_C=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+jr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,b){var w=t[b];return typeof w=="number"?LT(w):w},n=function(y,b,w){var T=b.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return T==59?y:LT(T)};t["|"]=254;function a(y,b){switch(b.type){case"base64":return i(Ia(y),b);case"binary":return i(y,b);case"buffer":return i(St&&Buffer.isBuffer(y)?y.toString("binary"):so(y),b);case"array":return i(Zo(y),b)}throw new Error("Unrecognized type "+b.type)}function i(y,b){var w=y.split(/[\n\r]+/),T=-1,E=-1,k=0,I=0,N=[],z=[],H=null,q={},A=[],F=[],R=[],M=0,O;for(+b.codepage>=0&&ws(+b.codepage);k!==w.length;++k){M=0;var j=w[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),L=j.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),Ne=L[0],_e;if(j.length>0)switch(Ne){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":L[1].charAt(0)=="P"&&z.push(j.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,se=!1,Ee=!1,ie=!1,Ve=-1,U=-1;for(I=1;I<L.length;++I)switch(L[I].charAt(0)){case"A":break;case"X":E=parseInt(L[I].slice(1))-1,se=!0;break;case"Y":for(T=parseInt(L[I].slice(1))-1,se||(E=0),O=N.length;O<=T;++O)N[O]=[];break;case"K":_e=L[I].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(Ts(_e))?isNaN(Tu(_e).getDate())||(_e=yr(_e)):(_e=Ts(_e),H!==null&&Mu(H)&&(_e=Op(_e))),ne=!0;break;case"E":ie=!0;var P=mu(L[I].slice(1),{r:T,c:E});N[T][E]=[N[T][E],P];break;case"S":Ee=!0,N[T][E]=[N[T][E],"S5S"];break;case"G":break;case"R":Ve=parseInt(L[I].slice(1))-1;break;case"C":U=parseInt(L[I].slice(1))-1;break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+j)}if(ne&&(N[T][E]&&N[T][E].length==2?N[T][E][0]=_e:N[T][E]=_e,H=null),Ee){if(ie)throw new Error("SYLK shared formula cannot have own formula");var G=Ve>-1&&N[Ve][U];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");N[T][E][1]=LC(G[1],{r:T-Ve,c:E-U})}break;case"F":var Y=0;for(I=1;I<L.length;++I)switch(L[I].charAt(0)){case"X":E=parseInt(L[I].slice(1))-1,++Y;break;case"Y":for(T=parseInt(L[I].slice(1))-1,O=N.length;O<=T;++O)N[O]=[];break;case"M":M=parseInt(L[I].slice(1))/20;break;case"F":break;case"G":break;case"P":H=z[parseInt(L[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=L[I].slice(1).split(" "),O=parseInt(R[0],10);O<=parseInt(R[1],10);++O)M=parseInt(R[2],10),F[O-1]=M===0?{hidden:!0}:{wch:M},Ql(F[O-1]);break;case"C":E=parseInt(L[I].slice(1))-1,F[E]||(F[E]={});break;case"R":T=parseInt(L[I].slice(1))-1,A[T]||(A[T]={}),M>0?(A[T].hpt=M,A[T].hpx=Au(M)):M===0&&(A[T].hidden=!0);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+j)}Y<1&&(H=null);break;default:if(b&&b.WTF)throw new Error("SYLK bad record "+j)}}return A.length>0&&(q["!rows"]=A),F.length>0&&(q["!cols"]=F),b&&b.sheetRows&&(N=N.slice(0,b.sheetRows)),[N,q]}function o(y,b){var w=a(y,b),T=w[0],E=w[1],k=Bu(T,b);return jr(E).forEach(function(I){k[I]=E[I]}),k}function u(y,b){return io(o(y,b),b)}function f(y,b,w,T){var E="C;Y"+(w+1)+";X"+(T+1)+";K";switch(y.t){case"n":E+=y.v||0,y.f&&!y.F&&(E+=";E"+r_(y.f,{r:w,c:T}));break;case"b":E+=y.v?"TRUE":"FALSE";break;case"e":E+=y.w||y.v;break;case"d":E+='"'+(y.w||y.v)+'"';break;case"s":E+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function h(y,b){b.forEach(function(w,T){var E="F;W"+(T+1)+" "+(T+1)+" ";w.hidden?E+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=k0(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=N0(w.wpx)),typeof w.wch=="number"&&(E+=Math.round(w.wch))),E.charAt(E.length-1)!=" "&&y.push(E)})}function p(y,b){b.forEach(function(w,T){var E="F;";w.hidden?E+="M0;":w.hpt?E+="M"+20*w.hpt+";":w.hpx&&(E+="M"+20*C0(w.hpx)+";"),E.length>2&&y.push(E+"R"+(T+1))})}function x(y,b){var w=["ID;PWXL;N;E"],T=[],E=Bt(y["!ref"]),k,I=Array.isArray(y),N=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),y["!cols"]&&h(w,y["!cols"]),y["!rows"]&&p(w,y["!rows"]),w.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var z=E.s.r;z<=E.e.r;++z)for(var H=E.s.c;H<=E.e.c;++H){var q=ct({r:z,c:H});k=I?(y[z]||[])[H]:y[q],!(!k||k.v==null&&(!k.f||k.F))&&T.push(f(k,y,z,H))}return w.join(N)+N+T.join(N)+N+"E"+N}return{to_workbook:u,to_sheet:o,from_sheet:x}})(),bC=(function(){function t(i,o){switch(o.type){case"base64":return e(Ia(i),o);case"binary":return e(i,o);case"buffer":return e(St&&Buffer.isBuffer(i)?i.toString("binary"):so(i),o);case"array":return e(Zo(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var u=i.split(`
`),f=-1,h=-1,p=0,x=[];p!==u.length;++p){if(u[p].trim()==="BOT"){x[++f]=[],h=0;continue}if(!(f<0)){var y=u[p].trim().split(","),b=y[0],w=y[1];++p;for(var T=u[p]||"";(T.match(/["]/g)||[]).length&1&&p<u.length-1;)T+=`
`+u[++p];switch(T=T.trim(),+b){case-1:if(T==="BOT"){x[++f]=[],h=0;continue}else if(T!=="EOD")throw new Error("Unrecognized DIF special command "+T);break;case 0:T==="TRUE"?x[f][h]=!0:T==="FALSE"?x[f][h]=!1:isNaN(Ts(w))?isNaN(Tu(w).getDate())?x[f][h]=w:x[f][h]=yr(w):x[f][h]=Ts(w),++h;break;case 1:T=T.slice(1,T.length-1),T=T.replace(/""/g,'"'),T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),x[f][h++]=T!==""?T:null;break}if(T==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function r(i,o){return Bu(t(i,o),o)}function n(i,o){return io(r(i,o),o)}var a=(function(){var i=function(f,h,p,x,y){f.push(h),f.push(p+","+x),f.push('"'+y.replace(/"/g,'""')+'"')},o=function(f,h,p,x){f.push(h+","+p),f.push(h==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(f){var h=[],p=Bt(f["!ref"]),x,y=Array.isArray(f);i(h,"TABLE",0,1,"sheetjs"),i(h,"VECTORS",0,p.e.r-p.s.r+1,""),i(h,"TUPLES",0,p.e.c-p.s.c+1,""),i(h,"DATA",0,0,"");for(var b=p.s.r;b<=p.e.r;++b){o(h,-1,0,"BOT");for(var w=p.s.c;w<=p.e.c;++w){var T=ct({r:b,c:w});if(x=y?(f[b]||[])[w]:f[T],!x){o(h,1,0,"");continue}switch(x.t){case"n":var E=x.w;!E&&x.v!=null&&(E=x.v),E==null?x.f&&!x.F?o(h,1,0,"="+x.f):o(h,1,0,""):o(h,0,E,"V");break;case"b":o(h,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=es(x.z||ot[14],ln(yr(x.v)))),o(h,0,x.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var k=`\r
`,I=h.join(k);return I}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),wC=(function(){function t(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,y){for(var b=x.split(`
`),w=-1,T=-1,E=0,k=[];E!==b.length;++E){var I=b[E].trim().split(":");if(I[0]==="cell"){var N=kr(I[1]);if(k.length<=N.r)for(w=k.length;w<=N.r;++w)k[w]||(k[w]=[]);switch(w=N.r,T=N.c,I[2]){case"t":k[w][T]=t(I[3]);break;case"v":k[w][T]=+I[3];break;case"vtf":var z=I[I.length-1];case"vtc":switch(I[3]){case"nl":k[w][T]=!!+I[4];break;default:k[w][T]=+I[4];break}I[2]=="vtf"&&(k[w][T]=[k[w][T],z])}}}return y&&y.sheetRows&&(k=k.slice(0,y.sheetRows)),k}function n(x,y){return Bu(r(x,y),y)}function a(x,y){return io(n(x,y),y)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function h(x){if(!x||!x["!ref"])return"";for(var y=[],b=[],w,T="",E=ha(x["!ref"]),k=Array.isArray(x),I=E.s.r;I<=E.e.r;++I)for(var N=E.s.c;N<=E.e.c;++N)if(T=ct({r:I,c:N}),w=k?(x[I]||[])[N]:x[T],!(!w||w.v==null||w.t==="z")){switch(b=["cell",T,"t"],w.t){case"s":case"str":b.push(e(w.v));break;case"n":w.f?(b[2]="vtf",b[3]="n",b[4]=w.v,b[5]=e(w.f)):(b[2]="v",b[3]=w.v);break;case"b":b[2]="vt"+(w.f?"f":"c"),b[3]="nl",b[4]=w.v?"1":"0",b[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var z=ln(yr(w.v));b[2]="vtc",b[3]="nd",b[4]=""+z,b[5]=w.w||es(w.z||ot[14],z);break;case"e":continue}y.push(b.join(":"))}return y.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function p(x){return[i,o,u,o,h(x),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:p}})(),Su=(function(){function t(p,x,y,b,w){w.raw?x[y][b]=p:p===""||(p==="TRUE"?x[y][b]=!0:p==="FALSE"?x[y][b]=!1:isNaN(Ts(p))?isNaN(Tu(p).getDate())?x[y][b]=p:x[y][b]=yr(p):x[y][b]=Ts(p))}function e(p,x){var y=x||{},b=[];if(!p||p.length===0)return b;for(var w=p.split(/[\r\n]/),T=w.length-1;T>=0&&w[T].length===0;)--T;for(var E=10,k=0,I=0;I<=T;++I)k=w[I].indexOf(" "),k==-1?k=w[I].length:k++,E=Math.max(E,k);for(I=0;I<=T;++I){b[I]=[];var N=0;for(t(w[I].slice(0,E).trim(),b,I,N,y),N=1;N<=(w[I].length-E)/10+1;++N)t(w[I].slice(E+(N-1)*10,E+N*10).trim(),b,I,N,y)}return y.sheetRows&&(b=b.slice(0,y.sheetRows)),b}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(p){for(var x={},y=!1,b=0,w=0;b<p.length;++b)(w=p.charCodeAt(b))==34?y=!y:!y&&w in r&&(x[w]=(x[w]||0)+1);w=[];for(b in x)Object.prototype.hasOwnProperty.call(x,b)&&w.push([x[b],b]);if(!w.length){x=n;for(b in x)Object.prototype.hasOwnProperty.call(x,b)&&w.push([x[b],b])}return w.sort(function(T,E){return T[0]-E[0]||n[T[1]]-n[E[1]]}),r[w.pop()[1]]||44}function i(p,x){var y=x||{},b="",w=y.dense?[]:{},T={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(b=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(b=p.charAt(4),p=p.slice(6)):b=a(p.slice(0,1024)):y&&y.FS?b=y.FS:b=a(p.slice(0,1024));var E=0,k=0,I=0,N=0,z=0,H=b.charCodeAt(0),q=!1,A=0,F=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var R=y.dateNF!=null?j7(y.dateNF):null;function M(){var O=p.slice(N,z),j={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)j.t="z";else if(y.raw)j.t="s",j.v=O;else if(O.trim().length===0)j.t="s",j.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(j.t="s",j.v=O.slice(2,-1).replace(/""/g,'"')):uq(O)?(j.t="n",j.f=O.slice(1)):(j.t="s",j.v=O);else if(O=="TRUE")j.t="b",j.v=!0;else if(O=="FALSE")j.t="b",j.v=!1;else if(!isNaN(I=Ts(O)))j.t="n",y.cellText!==!1&&(j.w=O),j.v=I;else if(!isNaN(Tu(O).getDate())||R&&O.match(R)){j.z=y.dateNF||ot[14];var L=0;R&&O.match(R)&&(O=P7(O,y.dateNF,O.match(R)||[]),L=1),y.cellDates?(j.t="d",j.v=yr(O,L)):(j.t="n",j.v=ln(yr(O,L))),y.cellText!==!1&&(j.w=es(j.z,j.v instanceof Date?ln(j.v):j.v)),y.cellNF||delete j.z}else j.t="s",j.v=O;if(j.t=="z"||(y.dense?(w[E]||(w[E]=[]),w[E][k]=j):w[ct({c:k,r:E})]=j),N=z+1,F=p.charCodeAt(N),T.e.c<k&&(T.e.c=k),T.e.r<E&&(T.e.r=E),A==H)++k;else if(k=0,++E,y.sheetRows&&y.sheetRows<=E)return!0}e:for(;z<p.length;++z)switch(A=p.charCodeAt(z)){case 34:F===34&&(q=!q);break;case H:case 10:case 13:if(!q&&M())break e;break}return z-N>0&&M(),w["!ref"]=bt(T),w}function o(p,x){return!(x&&x.PRN)||x.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?i(p,x):Bu(e(p,x),x)}function u(p,x){var y="",b=x.type=="string"?[0,0,0,0]:u_(p,x);switch(x.type){case"base64":y=Ia(p);break;case"binary":y=p;break;case"buffer":x.codepage==65001?y=p.toString("utf8"):x.codepage&&typeof y0<"u"||(y=St&&Buffer.isBuffer(p)?p.toString("binary"):so(p));break;case"array":y=Zo(p);break;case"string":y=p;break;default:throw new Error("Unrecognized type "+x.type)}return b[0]==239&&b[1]==187&&b[2]==191?y=lr(y.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?y=lr(y):x.type=="binary"&&typeof y0<"u",y.slice(0,19)=="socialcalc:version:"?wC.to_sheet(x.type=="string"?y:lr(y),x):o(y,x)}function f(p,x){return io(u(p,x),x)}function h(p){for(var x=[],y=Bt(p["!ref"]),b,w=Array.isArray(p),T=y.s.r;T<=y.e.r;++T){for(var E=[],k=y.s.c;k<=y.e.c;++k){var I=ct({r:T,c:k});if(b=w?(p[T]||[])[k]:p[I],!b||b.v==null){E.push("          ");continue}for(var N=(b.w||(Bi(b),b.w)||"").slice(0,10);N.length<10;)N+=" ";E.push(N+(k===0?" ":""))}x.push(E.join(""))}return x.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:h}})();function KU(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=_C.to_workbook(t,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Su.to_workbook(t,e)}}var Go=(function(){function t(P,G,Y){if(P){En(P,P.l||0);for(var Z=Y.Enum||Ve;P.l<P.length;){var oe=P.read_shift(2),ye=Z[oe]||Z[65535],Fe=P.read_shift(2),Te=P.l+Fe,De=ye.f&&ye.f(P,Fe,Y);if(P.l=Te,G(De,ye,oe))return}}}function e(P,G){switch(G.type){case"base64":return r(ka(Ia(P)),G);case"binary":return r(ka(P),G);case"buffer":case"array":return r(P,G)}throw"Unsupported type "+G.type}function r(P,G){if(!P)return P;var Y=G||{},Z=Y.dense?[]:{},oe="Sheet1",ye="",Fe=0,Te={},De=[],rt=[],re={s:{r:0,c:0},e:{r:0,c:0}},ft=Y.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)Y.Enum=Ve,t(P,function(je,tt,nt){switch(nt){case 0:Y.vers=je,je>=4096&&(Y.qpro=!0);break;case 6:re=je;break;case 204:je&&(ye=je);break;case 222:ye=je;break;case 15:case 51:Y.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:nt==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=Y.dateNF||ot[14],Y.cellDates&&(je[1].t="d",je[1].v=Op(je[1].v))),Y.qpro&&je[3]>Fe&&(Z["!ref"]=bt(re),Te[oe]=Z,De.push(oe),Z=Y.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},Fe=je[3],oe=ye||"Sheet"+(Fe+1),ye="");var ht=Y.dense?(Z[je[0].r]||[])[je[0].c]:Z[ct(je[0])];if(ht){ht.t=je[1].t,ht.v=je[1].v,je[1].z!=null&&(ht.z=je[1].z),je[1].f!=null&&(ht.f=je[1].f);break}Y.dense?(Z[je[0].r]||(Z[je[0].r]=[]),Z[je[0].r][je[0].c]=je[1]):Z[ct(je[0])]=je[1];break}},Y);else if(P[2]==26||P[2]==14)Y.Enum=U,P[2]==14&&(Y.qpro=!0,P.l=0),t(P,function(je,tt,nt){switch(nt){case 204:oe=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>Fe&&(Z["!ref"]=bt(re),Te[oe]=Z,De.push(oe),Z=Y.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},Fe=je[3],oe="Sheet"+(Fe+1)),ft>0&&je[0].r>=ft)break;Y.dense?(Z[je[0].r]||(Z[je[0].r]=[]),Z[je[0].r][je[0].c]=je[1]):Z[ct(je[0])]=je[1],re.e.c<je[0].c&&(re.e.c=je[0].c),re.e.r<je[0].r&&(re.e.r=je[0].r);break;case 27:je[14e3]&&(rt[je[14e3][0]]=je[14e3][1]);break;case 1537:rt[je[0]]=je[1],je[0]==Fe&&(oe=je[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(Z["!ref"]=bt(re),Te[ye||oe]=Z,De.push(ye||oe),!rt.length)return{SheetNames:De,Sheets:Te};for(var ce={},ze=[],Ce=0;Ce<rt.length;++Ce)Te[De[Ce]]?(ze.push(rt[Ce]||De[Ce]),ce[rt[Ce]]=Te[rt[Ce]]||Te[De[Ce]]):(ze.push(rt[Ce]),ce[rt[Ce]]={"!ref":"A1"});return{SheetNames:ze,Sheets:ce}}function n(P,G){var Y=G||{};if(+Y.codepage>=0&&ws(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=fa(),oe=Bt(P["!ref"]),ye=Array.isArray(P),Fe=[];qe(Z,0,i(1030)),qe(Z,6,f(oe));for(var Te=Math.min(oe.e.r,8191),De=oe.s.r;De<=Te;++De)for(var rt=Ur(De),re=oe.s.c;re<=oe.e.c;++re){De===oe.s.r&&(Fe[re]=Ar(re));var ft=Fe[re]+rt,ce=ye?(P[De]||[])[re]:P[ft];if(!(!ce||ce.t=="z"))if(ce.t=="n")(ce.v|0)==ce.v&&ce.v>=-32768&&ce.v<=32767?qe(Z,13,b(De,re,ce.v)):qe(Z,14,T(De,re,ce.v));else{var ze=Bi(ce);qe(Z,15,x(De,re,ze.slice(0,239)))}}return qe(Z,1),Z.end()}function a(P,G){var Y=G||{};if(+Y.codepage>=0&&ws(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=fa();qe(Z,0,o(P));for(var oe=0,ye=0;oe<P.SheetNames.length;++oe)(P.Sheets[P.SheetNames[oe]]||{})["!ref"]&&qe(Z,27,ie(P.SheetNames[oe],ye++));var Fe=0;for(oe=0;oe<P.SheetNames.length;++oe){var Te=P.Sheets[P.SheetNames[oe]];if(!(!Te||!Te["!ref"])){for(var De=Bt(Te["!ref"]),rt=Array.isArray(Te),re=[],ft=Math.min(De.e.r,8191),ce=De.s.r;ce<=ft;++ce)for(var ze=Ur(ce),Ce=De.s.c;Ce<=De.e.c;++Ce){ce===De.s.r&&(re[Ce]=Ar(Ce));var je=re[Ce]+ze,tt=rt?(Te[ce]||[])[Ce]:Te[je];if(!(!tt||tt.t=="z"))if(tt.t=="n")qe(Z,23,M(ce,Ce,Fe,tt.v));else{var nt=Bi(tt);qe(Z,22,A(ce,Ce,Fe,nt.slice(0,239)))}}++Fe}}return qe(Z,1),Z.end()}function i(P){var G=Se(2);return G.write_shift(2,P),G}function o(P){var G=Se(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var Y=0,Z=0,oe=0,ye=0;ye<P.SheetNames.length;++ye){var Fe=P.SheetNames[ye],Te=P.Sheets[Fe];if(!(!Te||!Te["!ref"])){++oe;var De=ha(Te["!ref"]);Y<De.e.r&&(Y=De.e.r),Z<De.e.c&&(Z=De.e.c)}}return Y>8191&&(Y=8191),G.write_shift(2,Y),G.write_shift(1,oe),G.write_shift(1,Z),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function u(P,G,Y){var Z={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&Y.qpro?(Z.s.c=P.read_shift(1),P.l++,Z.s.r=P.read_shift(2),Z.e.c=P.read_shift(1),P.l++,Z.e.r=P.read_shift(2),Z):(Z.s.c=P.read_shift(2),Z.s.r=P.read_shift(2),G==12&&Y.qpro&&(P.l+=2),Z.e.c=P.read_shift(2),Z.e.r=P.read_shift(2),G==12&&Y.qpro&&(P.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function f(P){var G=Se(8);return G.write_shift(2,P.s.c),G.write_shift(2,P.s.r),G.write_shift(2,P.e.c),G.write_shift(2,P.e.r),G}function h(P,G,Y){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(Z[0].c=P.read_shift(1),Z[3]=P.read_shift(1),Z[0].r=P.read_shift(2),P.l+=2):(Z[2]=P.read_shift(1),Z[0].c=P.read_shift(2),Z[0].r=P.read_shift(2)),Z}function p(P,G,Y){var Z=P.l+G,oe=h(P,G,Y);if(oe[1].t="s",Y.vers==20768){P.l++;var ye=P.read_shift(1);return oe[1].v=P.read_shift(ye,"utf8"),oe}return Y.qpro&&P.l++,oe[1].v=P.read_shift(Z-P.l,"cstr"),oe}function x(P,G,Y){var Z=Se(7+Y.length);Z.write_shift(1,255),Z.write_shift(2,G),Z.write_shift(2,P),Z.write_shift(1,39);for(var oe=0;oe<Z.length;++oe){var ye=Y.charCodeAt(oe);Z.write_shift(1,ye>=128?95:ye)}return Z.write_shift(1,0),Z}function y(P,G,Y){var Z=h(P,G,Y);return Z[1].v=P.read_shift(2,"i"),Z}function b(P,G,Y){var Z=Se(7);return Z.write_shift(1,255),Z.write_shift(2,G),Z.write_shift(2,P),Z.write_shift(2,Y,"i"),Z}function w(P,G,Y){var Z=h(P,G,Y);return Z[1].v=P.read_shift(8,"f"),Z}function T(P,G,Y){var Z=Se(13);return Z.write_shift(1,255),Z.write_shift(2,G),Z.write_shift(2,P),Z.write_shift(8,Y,"f"),Z}function E(P,G,Y){var Z=P.l+G,oe=h(P,G,Y);if(oe[1].v=P.read_shift(8,"f"),Y.qpro)P.l=Z;else{var ye=P.read_shift(2);z(P.slice(P.l,P.l+ye),oe),P.l+=ye}return oe}function k(P,G,Y){var Z=G&32768;return G&=-32769,G=(Z?P:0)+(G>=8192?G-16384:G),(Z?"":"$")+(Y?Ar(G):Ur(G))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(P,G){En(P,0);for(var Y=[],Z=0,oe="",ye="",Fe="",Te="";P.l<P.length;){var De=P[P.l++];switch(De){case 0:Y.push(P.read_shift(8,"f"));break;case 1:ye=k(G[0].c,P.read_shift(2),!0),oe=k(G[0].r,P.read_shift(2),!1),Y.push(ye+oe);break;case 2:{var rt=k(G[0].c,P.read_shift(2),!0),re=k(G[0].r,P.read_shift(2),!1);ye=k(G[0].c,P.read_shift(2),!0),oe=k(G[0].r,P.read_shift(2),!1),Y.push(rt+re+":"+ye+oe)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(P.read_shift(2));break;case 6:{for(var ft="";De=P[P.l++];)ft+=String.fromCharCode(De);Y.push('"'+ft.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:Te=Y.pop(),Fe=Y.pop(),Y.push(["AND","OR"][De-20]+"("+Fe+","+Te+")");break;default:if(De<32&&N[De])Te=Y.pop(),Fe=Y.pop(),Y.push(Fe+N[De]+Te);else if(I[De]){if(Z=I[De][1],Z==69&&(Z=P[P.l++]),Z>Y.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+Y.join("|")+"|");return}var ce=Y.slice(-Z);Y.length-=Z,Y.push(I[De][0]+"("+ce.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}Y.length==1?G[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function H(P){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=P.read_shift(2),G[3]=P[P.l++],G[0].c=P[P.l++],G}function q(P,G){var Y=H(P);return Y[1].t="s",Y[1].v=P.read_shift(G-4,"cstr"),Y}function A(P,G,Y,Z){var oe=Se(6+Z.length);oe.write_shift(2,P),oe.write_shift(1,Y),oe.write_shift(1,G),oe.write_shift(1,39);for(var ye=0;ye<Z.length;++ye){var Fe=Z.charCodeAt(ye);oe.write_shift(1,Fe>=128?95:Fe)}return oe.write_shift(1,0),oe}function F(P,G){var Y=H(P);Y[1].v=P.read_shift(2);var Z=Y[1].v>>1;if(Y[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return Y[1].v=Z,Y}function R(P,G){var Y=H(P),Z=P.read_shift(4),oe=P.read_shift(4),ye=P.read_shift(2);if(ye==65535)return Z===0&&oe===3221225472?(Y[1].t="e",Y[1].v=15):Z===0&&oe===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var Fe=ye&32768;return ye=(ye&32767)-16446,Y[1].v=(1-Fe*2)*(oe*Math.pow(2,ye+32)+Z*Math.pow(2,ye)),Y}function M(P,G,Y,Z){var oe=Se(14);if(oe.write_shift(2,P),oe.write_shift(1,Y),oe.write_shift(1,G),Z==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var ye=0,Fe=0,Te=0,De=0;return Z<0&&(ye=1,Z=-Z),Fe=Math.log2(Z)|0,Z/=Math.pow(2,Fe-31),De=Z>>>0,(De&2147483648)==0&&(Z/=2,++Fe,De=Z>>>0),Z-=De,De|=2147483648,De>>>=0,Z*=Math.pow(2,32),Te=Z>>>0,oe.write_shift(4,Te),oe.write_shift(4,De),Fe+=16383+(ye?32768:0),oe.write_shift(2,Fe),oe}function O(P,G){var Y=R(P);return P.l+=G-14,Y}function j(P,G){var Y=H(P),Z=P.read_shift(4);return Y[1].v=Z>>6,Y}function L(P,G){var Y=H(P),Z=P.read_shift(8,"f");return Y[1].v=Z,Y}function Ne(P,G){var Y=L(P);return P.l+=G-10,Y}function _e(P,G){return P[P.l+G-1]==0?P.read_shift(G,"cstr"):""}function ne(P,G){var Y=P[P.l++];Y>G-1&&(Y=G-1);for(var Z="";Z.length<Y;)Z+=String.fromCharCode(P[P.l++]);return Z}function se(P,G,Y){if(!(!Y.qpro||G<21)){var Z=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var oe=P.read_shift(G-21,"cstr");return[Z,oe]}}function Ee(P,G){for(var Y={},Z=P.l+G;P.l<Z;){var oe=P.read_shift(2);if(oe==14e3){for(Y[oe]=[0,""],Y[oe][0]=P.read_shift(2);P[P.l];)Y[oe][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return Y}function ie(P,G){var Y=Se(5+P.length);Y.write_shift(2,14e3),Y.write_shift(2,G);for(var Z=0;Z<P.length;++Z){var oe=P.charCodeAt(Z);Y[Y.l++]=oe>127?95:oe}return Y[Y.l++]=0,Y}var Ve={0:{n:"BOF",f:Qr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},U={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:q},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:L},40:{n:"FORMULA28",f:Ne},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}})();function QU(t){var e={},r=t.match(zn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=mt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=ky[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return e}var JU=(function(){var t=w0("t"),e=w0("rPr");function r(i){var o=i.match(t);if(!o)return{t:"s",v:""};var u={t:"s",v:Lt(o[1])},f=i.match(e);return f&&(u.s=QU(f[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(u){return u.v})}})(),ZU=(function(){var e=/(\r\n|\n)/g;function r(a,i,o){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),i.push('<span style="'+u.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),o.push("</"+f+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),ez=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,tz=/<(?:\w+:)?r>/,rz=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Qy(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Lt(lr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=lr(t),r&&(n.h=My(n.t))):t.match(tz)&&(n.r=lr(t),n.t=Lt(lr((t.replace(rz,"").match(ez)||[]).join("").replace(zn,""))),r&&(n.h=ZU(JU(n.r)))),n):{t:""}}var nz=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,az=/<(?:\w+:)?(?:si|sstItem)>/g,sz=/<\/(?:\w+:)?(?:si|sstItem)>/;function iz(t,e){var r=[],n="";if(!t)return r;var a=t.match(nz);if(a){n=a[2].replace(az,"").split(sz);for(var i=0;i!=n.length;++i){var o=Qy(n[i].trim(),e);o!=null&&(r[r.length]=o)}a=mt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var lz=/^\s|\s$|[\t\n\r]/;function EC(t,e){if(!e.bookSST)return"";var r=[zr];r[r.length]=He("sst",null,{xmlns:oc[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(lz)&&(i+=' xml:space="preserve"'),i+=">"+rr(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function oz(t){return[t.read_shift(4),t.read_shift(4)]}function cz(t,e){var r=[],n=!1;return Hi(t,function(i,o,u){switch(u){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function uz(t,e){return e||(e=Se(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var fz=bB;function hz(t){var e=fa();Me(e,159,uz(t));for(var r=0;r<t.length;++r)Me(e,19,fz(t[r]));return Me(e,160),e.end()}function TC(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Di(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function dz(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Di(t,4),e.U=Di(t,4),e.W=Di(t,4),e}function mz(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),i=[];a-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function pz(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(mz(t));return e}function gz(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function xz(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Di(t,4),e.U=Di(t,4),e.W=Di(t,4),e}function vz(t){var e=xz(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function SC(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function AC(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function yz(t){var e=Di(t);switch(e.Minor){case 2:return[e.Minor,_z(t)];case 3:return[e.Minor,bz()];case 4:return[e.Minor,wz(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function _z(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=SC(t,r),a=AC(t,t.length-t.l);return{t:"Std",h:n,v:a}}function bz(){throw new Error("File is password-protected: ECMA-376 Extensible")}function wz(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(zn,function(i){var o=mt(i);switch(Zs(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Ez(t,e){var r={},n=r.EncryptionVersionInfo=Di(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=SC(t,a),e-=a,r.EncryptionVerifier=AC(t,e),r}function Tz(t){var e={},r=e.EncryptionVersionInfo=Di(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Jy(t){var e=0,r,n=TC(t),a=n.length+1,i,o,u,f,h;for(r=Kl(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],u=(e&16384)===0?0:1,f=e<<1&32767,h=u|f,e=h^o;return e^52811}var kC=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,u){return n(o^u)},i=function(o){for(var u=e[o.length-1],f=104,h=o.length-1;h>=0;--h)for(var p=o[h],x=0;x!=7;++x)p&64&&(u^=r[f]),p*=2,--f;return u};return function(o){for(var u=TC(o),f=i(u),h=u.length,p=Kl(16),x=0;x!=16;++x)p[x]=0;var y,b,w;for((h&1)===1&&(y=f>>8,p[h]=a(t[0],y),--h,y=f&255,b=u[u.length-1],p[h]=a(b,y));h>0;)--h,y=f>>8,p[h]=a(u[h],y),--h,y=f&255,p[h]=a(u[h],y);for(h=15,w=15-u.length;w>0;)y=f>>8,p[h]=a(t[w],y),--h,--w,y=f&255,p[h]=a(u[h],y),--h,--w;return p}})(),Sz=function(t,e,r,n,a){a||(a=e),n||(n=kC(t));var i,o;for(i=0;i!=e.length;++i)o=e[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},Az=function(t){var e=0,r=kC(t);return function(n){var a=Sz("",n,e,r);return e=a[1],a[0]}};function kz(t,e,r,n){var a={key:Qr(t),verificationBytes:Qr(t)};return r.password&&(a.verifier=Jy(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Az(r.password)),a}function Nz(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Tz(t):n.Data=Ez(t,e),n}function Cz(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Nz(t,e-2,n):kz(t,r.biff>=8?e:e-2,r,n),n}var NC=(function(){function t(a,i){switch(i.type){case"base64":return e(Ia(a),i);case"binary":return e(a,i);case"buffer":return e(St&&Buffer.isBuffer(a)?a.toString("binary"):so(a),i);case"array":return e(Zo(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){var o=i||{},u=o.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(p,x){Array.isArray(u)&&(u[x]=[]);for(var y=/\\\w+\b/g,b=0,w,T=-1;w=y.exec(p);){switch(w[0]){case"\\cell":var E=p.slice(b,y.lastIndex-w[0].length);if(E[0]==" "&&(E=E.slice(1)),++T,E.length){var k={v:E,t:"s"};Array.isArray(u)?u[x][T]=k:u[ct({r:x,c:T})]=k}break}b=y.lastIndex}T>h.e.c&&(h.e.c=T)}),u["!ref"]=bt(h),u}function r(a,i){return io(t(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=Bt(a["!ref"]),u,f=Array.isArray(a),h=o.s.r;h<=o.e.r;++h){i.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)i.push("\\cellx"+(p+1));for(i.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var x=ct({r:h,c:p});u=f?(a[h]||[])[p]:a[x],!(!u||u.v==null&&(!u.f||u.F))&&(i.push(" "+(u.w||(Bi(u),u.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function Rz(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function A0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Iz(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),i=Math.min(e,r,n),o=a-i;if(o===0)return[0,0,e];var u=0,f=0,h=a+i;switch(f=o/(h>1?2-h:h),a){case e:u=((r-n)/o+6)%6;break;case r:u=(n-e)/o+2;break;case n:u=(e-r)/o+4;break}return[u/6,f,h/2]}function Dz(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],u=6*e,f;if(r!==0)switch(u|0){case 0:case 6:f=a*u,o[0]+=a,o[1]+=f;break;case 1:f=a*(2-u),o[0]+=f,o[1]+=a;break;case 2:f=a*(u-2),o[1]+=a,o[2]+=f;break;case 3:f=a*(4-u),o[1]+=f,o[2]+=a;break;case 4:f=a*(u-4),o[2]+=a,o[0]+=f;break;case 5:f=a*(6-u),o[2]+=f,o[0]+=a;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function Wm(t,e){if(e===0)return t;var r=Iz(Rz(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),A0(Dz(r))}var CC=6,Oz=15,Fz=1,Mn=CC;function k0(t){return Math.floor((t+Math.round(128/Mn)/256)*Mn)}function N0(t){return Math.floor((t-5)/Mn*100+.5)/100}function Xm(t){return Math.round((t*Mn+5)/Mn*256)/256}function ox(t){return Xm(N0(k0(t)))}function Zy(t){var e=Math.abs(t-ox(t)),r=Mn;if(e>.005)for(Mn=Fz;Mn<Oz;++Mn)Math.abs(t-ox(t))<=e&&(e=Math.abs(t-ox(t)),r=Mn);Mn=r}function Ql(t){t.width?(t.wpx=k0(t.width),t.wch=N0(t.wpx),t.MDW=Mn):t.wpx?(t.wch=N0(t.wpx),t.width=Xm(t.wch),t.MDW=Mn):typeof t.wch=="number"&&(t.width=Xm(t.wch),t.wpx=k0(t.width),t.MDW=Mn),t.customWidth&&delete t.customWidth}var jz=96,RC=jz;function C0(t){return t*96/RC}function Au(t){return t*RC/96}var Pz={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Mz(t,e,r,n){e.Borders=[];var a={},i=!1;(t[0].match(zn)||[]).forEach(function(o){var u=mt(o);switch(Zs(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=xr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=xr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in borders")}})}function Lz(t,e,r,n){e.Fills=[];var a={},i=!1;(t[0].match(zn)||[]).forEach(function(o){var u=mt(o);switch(Zs(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fills")}})}function Bz(t,e,r,n){e.Fonts=[];var a={},i=!1;(t[0].match(zn)||[]).forEach(function(o){var u=mt(o);switch(Zs(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=lr(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?xr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?xr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?xr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?xr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?xr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?xr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?xr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=ky[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=xr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var f=Ho[a.color.index];a.color.index==81&&(f=Ho[1]),f||(f=Ho[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Wm(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fonts")}})}function Vz(t,e,r){e.NumberFmt=[];for(var n=jr(ot),a=0;a<n.length;++a)e.NumberFmt[n[a]]=ot[n[a]];var i=t[0].match(zn);if(i)for(a=0;a<i.length;++a){var o=mt(i[a]);switch(Zs(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Lt(lr(o.formatCode)),f=parseInt(o.numFmtId,10);if(e.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=u}Ii(u,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Uz(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=He("numFmt",null,{numFmtId:n,formatCode:rr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=He("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Yd=["numFmtId","fillId","fontId","borderId","xfId"],$d=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function zz(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(zn)||[]).forEach(function(i){var o=mt(i),u=0;switch(Zs(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<Yd.length;++u)n[Yd[u]]&&(n[Yd[u]]=parseInt(n[Yd[u]],10));for(u=0;u<$d.length;++u)n[$d[u]]&&(n[$d[u]]=xr(n[$d[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};o.vertical&&(f.vertical=o.vertical),o.horizontal&&(f.horizontal=o.horizontal),o.textRotation!=null&&(f.textRotation=o.textRotation),o.indent&&(f.indent=o.indent),o.wrapText&&(f.wrapText=xr(o.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Hz(t){var e=[];return e[e.length]=He("cellXfs",null),t.forEach(function(r){e[e.length]=He("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=He("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var qz=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,h){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(e))&&Vz(x,p,h),(x=u.match(a))&&Bz(x,p,f,h),(x=u.match(n))&&Lz(x,p,f,h),(x=u.match(i))&&Mz(x,p,f,h),(x=u.match(r))&&zz(x,p,h),p}})();function IC(t,e){var r=[zr,He("styleSheet",null,{xmlns:oc[0],"xmlns:vt":nn.vt})],n;return t.SSF&&(n=Uz(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Hz(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Gz(t,e){var r=t.read_shift(2),n=Bn(t);return[r,n]}function Wz(t,e,r){r||(r=Se(6+4*e.length)),r.write_shift(2,t),pn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Xz(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=NB(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var u=t.read_shift(1);u>0&&(n.family=u);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=kB(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Bn(t),n}function Yz(t,e){e||(e=Se(153)),e.write_shift(2,t.sz*20),CB(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Hm(t.color,e);var n=0;return n=2,e.write_shift(1,n),pn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var $z=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],cx,Kz=Un;function NS(t,e){e||(e=Se(84)),cx||(cx=Ip($z));var r=cx[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Hm({auto:1},e),Hm({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Qz(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function DC(t,e,r){r||(r=Se(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Vf(t,e){return e||(e=Se(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Jz=Un;function Zz(t,e){return e||(e=Se(51)),e.write_shift(1,0),Vf(null,e),Vf(null,e),Vf(null,e),Vf(null,e),Vf(null,e),e.length>e.l?e.slice(0,e.l):e}function eH(t,e){return e||(e=Se(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),zm(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function tH(t,e,r){var n=Se(2052);return n.write_shift(4,t),zm(e,n),zm(r,n),n.length>n.l?n.slice(0,n.l):n}function rH(t,e,r){var n={};n.NumberFmt=[];for(var a in ot)n.NumberFmt[a]=ot[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Hi(t,function(f,h,p){switch(p){case 44:n.NumberFmt[f[0]]=f[1],Ii(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=Wm(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(p),o=!0;break;case 38:i.pop(),o=!1;break;default:if(h.T>0)i.push(p);else if(h.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}function nH(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Me(t,615,Ss(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Me(t,44,Wz(a,e[a]))}),Me(t,616))}}function aH(t){var e=1;Me(t,611,Ss(e)),Me(t,43,Yz({sz:12,color:{theme:1},name:"Calibri",family:2})),Me(t,612)}function sH(t){var e=2;Me(t,603,Ss(e)),Me(t,45,NS({patternType:"none"})),Me(t,45,NS({patternType:"gray125"})),Me(t,604)}function iH(t){var e=1;Me(t,613,Ss(e)),Me(t,46,Zz()),Me(t,614)}function lH(t){var e=1;Me(t,626,Ss(e)),Me(t,47,DC({numFmtId:0},65535)),Me(t,627)}function oH(t,e){Me(t,617,Ss(e.length)),e.forEach(function(r){Me(t,47,DC(r,0))}),Me(t,618)}function cH(t){var e=1;Me(t,619,Ss(e)),Me(t,48,eH({xfId:0,name:"Normal"})),Me(t,620)}function uH(t){var e=0;Me(t,505,Ss(e)),Me(t,506)}function fH(t){var e=0;Me(t,508,tH(e,"TableStyleMedium9","PivotStyleMedium4")),Me(t,509)}function hH(t,e){var r=fa();return Me(r,278),nH(r,t.SSF),aH(r),sH(r),iH(r),lH(r),oH(r,e.cellXfs),cH(r),uH(r),fH(r),Me(r,279),r.end()}var dH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function mH(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(zn)||[]).forEach(function(a){var i=mt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[dH.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function pH(){}function gH(){}var xH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,vH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yH=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function _H(t,e,r){e.themeElements={};var n;[["clrScheme",xH,mH],["fontScheme",vH,pH],["fmtScheme",yH,gH]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var bH=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function OC(t,e){(!t||t.length===0)&&(t=e_());var r,n={};if(!(r=t.match(bH)))throw new Error("themeElements not found in theme");return _H(r[0],n,e),n.raw=t,n}function e_(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[zr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function wH(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var o;try{o=SN(i,{type:"array"})}catch{return}var u=Na(o,"theme/theme/theme1.xml",!0);if(u)return OC(u,r)}}function EH(t){return t.read_shift(4)}function TH(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=SH(t,4);break;case 2:e.xclrValue=hC(t);break;case 3:e.xclrValue=EH(t);break;case 4:t.l+=4;break}return t.l+=8,e}function SH(t,e){return Un(t,e)}function AH(t,e){return Un(t,e)}function kH(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=TH(t);break;case 6:n[1]=AH(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function NH(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),i=[];a-- >0;)i.push(kH(t,r-t.l));return{ixfe:n,ext:i}}function CH(t,e){e.forEach(function(r){r[0]})}function RH(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Bn(t)}}function IH(t){var e=Se(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),pn(t.name,e),e.slice(0,e.l)}function DH(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function OH(t){var e=Se(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function FH(t,e){var r=Se(8+2*e.length);return r.write_shift(4,t),pn(e,r),r.slice(0,r.l)}function jH(t){return t.l+=4,t.read_shift(4)!=0}function PH(t,e){var r=Se(8);return r.write_shift(4,t),r.write_shift(4,1),r}function MH(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,u=2;return Hi(t,function(f,h,p){switch(p){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(x){u==1?n.Cell.push({type:n.Types[x[0]-1].name,index:x[1]}):u==0&&n.Value.push({type:n.Types[x[0]-1].name,index:x[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:i.push(p),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!h.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function LH(){var t=fa();return Me(t,332),Me(t,334,Ss(1)),Me(t,335,IH({name:"XLDAPR",version:12e4,flags:3496657072})),Me(t,336),Me(t,339,FH(1,"XLDAPR")),Me(t,52),Me(t,35,Ss(514)),Me(t,4096,Ss(0)),Me(t,4097,Ka(1)),Me(t,36),Me(t,53),Me(t,340),Me(t,337,PH(1)),Me(t,51,OH([[1,0]])),Me(t,338),Me(t,333),t.end()}function BH(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,i=2,o;return t.replace(zn,function(u){var f=mt(u);switch(Zs(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==f.name&&(o=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):i==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function FC(){var t=[zr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function VH(t){var e=[];if(!t)return e;var r=1;return(t.match(zn)||[]).forEach(function(n){var a=mt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function UH(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ct(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function zH(t,e,r){var n=[];return Hi(t,function(i,o,u){switch(u){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function HH(t,e,r,n){if(!t)return t;var a=n||{},i=!1;Hi(t,function(u,f,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},a)}function qH(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var lu=1024;function jC(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[He("xml",null,{"xmlns:v":Sa.v,"xmlns:o":Sa.o,"xmlns:x":Sa.x,"xmlns:mv":Sa.mv}).replace(/\/>/,">"),He("o:shapelayout",He("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),He("v:shapetype",[He("v:stroke",null,{joinstyle:"miter"}),He("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];lu<t*1e3;)lu+=1e3;return e.forEach(function(i){var o=kr(i[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?He("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=He("v:fill",f,u),p={on:"t",obscured:"t"};++lu,a=a.concat(["<v:shape"+E0({id:"_x0000_s"+lu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,He("v:shadow",null,p),He("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Sn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Sn("x:AutoFill","False"),Sn("x:Row",String(o.r)),Sn("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function CS(t,e,r,n){var a=Array.isArray(t),i;e.forEach(function(o){var u=kr(o.ref);if(a?(t[u.r]||(t[u.r]=[]),i=t[u.r][u.c]):i=t[o.ref],!i){i={t:"z"},a?t[u.r][u.c]=i:t[o.ref]=i;var f=Bt(t["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var h=bt(f);h!==t["!ref"]&&(t["!ref"]=h)}i.c||(i.c=[]);var p={a:o.author,t:o.t,r:o.r,T:r};o.h&&(p.h=o.h);for(var x=i.c.length-1;x>=0;--x){if(!r&&i.c[x].T)return;r&&!i.c[x].T&&i.c.splice(x,1)}if(r&&n){for(x=0;x<n.length;++x)if(p.a==n[x].id){p.a=n[x].name||p.a;break}}i.c.push(p)})}function GH(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=mt(u[0]),h={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},p=kr(f.ref);if(!(e.sheetRows&&e.sheetRows<=p.r)){var x=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!x&&!!x[1]&&Qy(x[1])||{r:"",t:"",h:""};h.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),h.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=y.h),n.push(h)}}}}),n}function PC(t){var e=[zr,He("comments",null,{xmlns:oc[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var i=rr(a.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(rr(f.a))),i.push(f.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)e.push(Sn("t",rr(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,u=1;u<i.length;++u)o+=`Reply:
    `+i[u]+`
`;e.push(Sn("t",rr(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function WH(t,e){var r=[],n=!1,a={},i=0;return t.replace(zn,function(u,f){var h=mt(u);switch(Zs(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=f+u.length;break;case"</text>":a.t=t.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return u}),r}function XH(t,e,r){var n=[zr,He("ThreadedComments",null,{xmlns:nn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?i=f.id:f.parentId=i,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(He("threadedComment",Sn("text",o.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function YH(t,e){var r=[],n=!1;return t.replace(zn,function(i){var o=mt(i);switch(Zs(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function $H(t){var e=[zr,He("personList",null,{xmlns:nn.TCMNT,"xmlns:x":oc[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(He("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function KH(t){var e={};e.iauthor=t.read_shift(4);var r=hc(t);return e.rfx=r.s,e.ref=ct(r.s),t.l+=16,e}function QH(t,e){return e==null&&(e=Se(36)),e.write_shift(4,t[1].iauthor),Vu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var JH=Bn;function ZH(t){return pn(t.slice(0,54))}function eq(t,e){var r=[],n=[],a={},i=!1;return Hi(t,function(u,f,h){switch(h){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function tq(t){var e=fa(),r=[];return Me(e,628),Me(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Me(e,632,ZH(a.a)))})}),Me(e,631),Me(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:kr(n[0]),e:kr(n[0])};Me(e,635,QH([i,a])),a.t&&a.t.length>0&&Me(e,637,EB(a)),Me(e,636),delete a.iauthor})}),Me(e,634),Me(e,629),e.end()}var rq="application/vnd.ms-office.vbaProject";function nq(t){var e=st.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");st.utils.cfb_add(e,a,t.FileIndex[n].content)}}),st.write(e)}function aq(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&st.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var MC=["xlsb","xlsm","xlam","biff8","xla"];function sq(){return{"!type":"dialog"}}function iq(){return{"!type":"dialog"}}function lq(){return{"!type":"macro"}}function oq(){return{"!type":"macro"}}var mu=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,i,o){var u=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var h=i.length>0?parseInt(i,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return u?p+=e.c:--p,f?h+=e.r:--h,a+(u?"":"$")+Ar(p)+(f?"":"$")+Ur(h)}return function(a,i){return e=i,a.replace(t,r)}})(),t_=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,r_=(function(){return function(e,r){return e.replace(t_,function(n,a,i,o,u,f){var h=zy(o)-(i?0:r.c),p=Uy(f)-(u?0:r.r),x=p==0?"":u?p+1:"["+p+"]",y=h==0?"":i?h+1:"["+h+"]";return a+"R"+x+"C"+y})}})();function LC(t,e){return t.replace(t_,function(r,n,a,i,o,u){return n+(a=="$"?a+i:Ar(zy(i)+e.c))+(o=="$"?o+u:Ur(Uy(u)+e.r))})}function cq(t,e,r){var n=ha(e),a=n.s,i=kr(r),o={r:i.r-a.r,c:i.c-a.c};return LC(t,o)}function uq(t){return t.length!=1}function RS(t){return t.replace(/_xlfn\./g,"")}function Yr(t){t.l+=1}function Jl(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function BC(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return VC(t);r.biff==12&&(n=4)}var a=t.read_shift(n),i=t.read_shift(n),o=Jl(t),u=Jl(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function VC(t){var e=Jl(t),r=Jl(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function fq(t,e,r){if(r.biff<8)return VC(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),i=Jl(t),o=Jl(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function UC(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return hq(t);var n=t.read_shift(r&&r.biff==12?4:2),a=Jl(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function hq(t){var e=Jl(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function dq(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function mq(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return pq(t);var a=t.read_shift(n>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,u=(i&32768)>>15;if(i&=16383,u==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:u}}function pq(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function gq(t,e,r){var n=(t[t.l++]&96)>>5,a=BC(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function xq(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=BC(t,i,r);return[n,a,o]}function vq(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function yq(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,a]}function _q(t,e,r){var n=(t[t.l++]&96)>>5,a=fq(t,e-1,r);return[n,a]}function bq(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function IS(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function wq(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function Eq(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Tq(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Sq(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Aq(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function zC(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function kq(t){return t.read_shift(2),zC(t)}function Nq(t){return t.read_shift(2),zC(t)}function Cq(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=UC(t,0,r);return[n,a]}function Rq(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=mq(t,0,r);return[n,a]}function Iq(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=UC(t,0,r);return[n,a,i]}function Dq(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[jG[a],GC[a],n]}function Oq(t,e,r){var n=t[t.l++],a=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Fq(t);return[a,(i[0]===0?GC:FG)[i[1]]]}function Fq(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function jq(t,e,r){t.l+=r&&r.biff==2?3:4}function Pq(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function Mq(t){return t.l++,qi[t.read_shift(1)]}function Lq(t){return t.l++,t.read_shift(2)}function Bq(t){return t.l++,t.read_shift(1)!==0}function Vq(t){return t.l++,Ln(t)}function Uq(t,e,r){return t.l++,ah(t,e-1,r)}function zq(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Br(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=qi[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Ln(t);break;case 2:r[1]=dc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Hq(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?hc:Fp)(t));return a}function qq(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var u=0;u!=a;++u)o[i][u]=zq(t,r.biff);return o}function Gq(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function Wq(t,e,r){if(r.biff==5)return Xq(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[n,a,i]}function Xq(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function Yq(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function $q(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function Kq(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function Qq(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,a]}var Jq=Un,Zq=Un,eG=Un;function ih(t,e,r){return t.l+=2,[dq(t)]}function n_(t){return t.l+=6,[]}var tG=ih,rG=n_,nG=n_,aG=ih;function HC(t){return t.l+=2,[Qr(t),t.read_shift(2)&1]}var sG=ih,iG=HC,lG=n_,oG=ih,cG=ih,uG=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function fG(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),o=uG[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:a,C:i}}function hG(t){return t.l+=2,[t.read_shift(4)]}function dG(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function mG(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function pG(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function gG(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function xG(t){return t.l+=4,[0,0]}var DS={1:{n:"PtgExp",f:Pq},2:{n:"PtgTbl",f:eG},3:{n:"PtgAdd",f:Yr},4:{n:"PtgSub",f:Yr},5:{n:"PtgMul",f:Yr},6:{n:"PtgDiv",f:Yr},7:{n:"PtgPower",f:Yr},8:{n:"PtgConcat",f:Yr},9:{n:"PtgLt",f:Yr},10:{n:"PtgLe",f:Yr},11:{n:"PtgEq",f:Yr},12:{n:"PtgGe",f:Yr},13:{n:"PtgGt",f:Yr},14:{n:"PtgNe",f:Yr},15:{n:"PtgIsect",f:Yr},16:{n:"PtgUnion",f:Yr},17:{n:"PtgRange",f:Yr},18:{n:"PtgUplus",f:Yr},19:{n:"PtgUminus",f:Yr},20:{n:"PtgPercent",f:Yr},21:{n:"PtgParen",f:Yr},22:{n:"PtgMissArg",f:Yr},23:{n:"PtgStr",f:Uq},26:{n:"PtgSheet",f:dG},27:{n:"PtgEndSheet",f:mG},28:{n:"PtgErr",f:Mq},29:{n:"PtgBool",f:Bq},30:{n:"PtgInt",f:Lq},31:{n:"PtgNum",f:Vq},32:{n:"PtgArray",f:bq},33:{n:"PtgFunc",f:Dq},34:{n:"PtgFuncVar",f:Oq},35:{n:"PtgName",f:Gq},36:{n:"PtgRef",f:Cq},37:{n:"PtgArea",f:gq},38:{n:"PtgMemArea",f:Yq},39:{n:"PtgMemErr",f:Jq},40:{n:"PtgMemNoMem",f:Zq},41:{n:"PtgMemFunc",f:$q},42:{n:"PtgRefErr",f:Kq},43:{n:"PtgAreaErr",f:vq},44:{n:"PtgRefN",f:Rq},45:{n:"PtgAreaN",f:_q},46:{n:"PtgMemAreaN",f:pG},47:{n:"PtgMemNoMemN",f:gG},57:{n:"PtgNameX",f:Wq},58:{n:"PtgRef3d",f:Iq},59:{n:"PtgArea3d",f:xq},60:{n:"PtgRefErr3d",f:Qq},61:{n:"PtgAreaErr3d",f:yq},255:{}},vG={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yG={1:{n:"PtgElfLel",f:HC},2:{n:"PtgElfRw",f:oG},3:{n:"PtgElfCol",f:tG},6:{n:"PtgElfRwV",f:cG},7:{n:"PtgElfColV",f:aG},10:{n:"PtgElfRadical",f:sG},11:{n:"PtgElfRadicalS",f:lG},13:{n:"PtgElfColS",f:rG},15:{n:"PtgElfColSV",f:nG},16:{n:"PtgElfRadicalLel",f:iG},25:{n:"PtgList",f:fG},29:{n:"PtgSxName",f:hG},255:{}},_G={0:{n:"PtgAttrNoop",f:xG},1:{n:"PtgAttrSemi",f:Aq},2:{n:"PtgAttrIf",f:Tq},4:{n:"PtgAttrChoose",f:wq},8:{n:"PtgAttrGoto",f:Eq},16:{n:"PtgAttrSum",f:jq},32:{n:"PtgAttrBaxcel",f:IS},33:{n:"PtgAttrBaxcel",f:IS},64:{n:"PtgAttrSpace",f:kq},65:{n:"PtgAttrSpaceSemi",f:Nq},128:{n:"PtgAttrIfError",f:Sq},255:{}};function lh(t,e,r,n){if(n.biff<8)return Un(t,e);for(var a=t.l+e,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=qq(t,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Hq(t,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=a-t.l,e!==0&&i.push(Un(t,e)),i}function oh(t,e,r){for(var n=t.l+e,a,i,o=[];n!=t.l;)e=n-t.l,i=t[t.l],a=DS[i]||DS[vG[i]],(i===24||i===25)&&(a=(i===24?yG:_G)[t[t.l+1]]),!a||!a.f?Un(t,e):o.push([a.n,a.f(t,e,r)]);return o}function bG(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var wG={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function EG(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function qC(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function OS(t,e,r){var n=qC(t,e,r);return n=="#REF"?n:EG(n,r)}function jn(t,e,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},u=[],f,h,p,x=0,y=0,b,w="";if(!t[0]||!t[0][0])return"";for(var T=-1,E="",k=0,I=t[0].length;k<I;++k){var N=t[0][k];switch(N[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),h=u.pop(),T>=0){switch(t[0][T][1][0]){case 0:E=Dr(" ",t[0][T][1][1]);break;case 1:E=Dr("\r",t[0][T][1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}h=h+E,T=-1}u.push(h+wG[N[0]]+f);break;case"PtgIsect":f=u.pop(),h=u.pop(),u.push(h+" "+f);break;case"PtgUnion":f=u.pop(),h=u.pop(),u.push(h+","+f);break;case"PtgRange":f=u.pop(),h=u.pop(),u.push(h+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=r0(N[1][1],o,a),u.push(n0(p,i));break;case"PtgRefN":p=r?r0(N[1][1],r,a):N[1][1],u.push(n0(p,i));break;case"PtgRef3d":x=N[1][1],p=r0(N[1][2],o,a),w=OS(n,x,a),u.push(w+"!"+n0(p,i));break;case"PtgFunc":case"PtgFuncVar":var z=N[1][0],H=N[1][1];z||(z=0),z&=127;var q=z==0?[]:u.slice(-z);u.length-=z,H==="User"&&(H=q.shift()),u.push(H+"("+q.join(",")+")");break;case"PtgBool":u.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(N[1]);break;case"PtgNum":u.push(String(N[1]));break;case"PtgStr":u.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(N[1]);break;case"PtgAreaN":b=oS(N[1][1],r?{s:r}:o,a),u.push(sx(b,a));break;case"PtgArea":b=oS(N[1][1],o,a),u.push(sx(b,a));break;case"PtgArea3d":x=N[1][1],b=N[1][2],w=OS(n,x,a),u.push(w+"!"+sx(b,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=N[1][2];var A=(n.names||[])[y-1]||(n[0]||[])[y],F=A?A.Name:"SH33TJSNAME"+String(y);F&&F.slice(0,6)=="_xlfn."&&!a.xlfn&&(F=F.slice(6)),u.push(F);break;case"PtgNameX":var R=N[1][1];y=N[1][2];var M;if(a.biff<=5)R<0&&(R=-R),n[R]&&(M=n[R][y]);else{var O="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][y]&&n[R][y].itab>0&&(O=n.SheetNames[n[R][y].itab-1]+"!"):O=n.SheetNames[y-1]+"!"),n[R]&&n[R][y])O+=n[R][y].Name;else if(n[0]&&n[0][y])O+=n[0][y].Name;else{var j=(qC(n,R,a)||"").split(";;");j[y-1]?O=j[y-1]:O+="SH33TJSERRX"}u.push(O);break}M||(M={Name:"SH33TJSERRY"}),u.push(M.Name);break;case"PtgParen":var L="(",Ne=")";if(T>=0){switch(E="",t[0][T][1][0]){case 2:L=Dr(" ",t[0][T][1][1])+L;break;case 3:L=Dr("\r",t[0][T][1][1])+L;break;case 4:Ne=Dr(" ",t[0][T][1][1])+Ne;break;case 5:Ne=Dr("\r",t[0][T][1][1])+Ne;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}T=-1}u.push(L+u.pop()+Ne);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:N[1][1],r:N[1][0]};var _e={c:r.c,r:r.r};if(n.sharedf[ct(p)]){var ne=n.sharedf[ct(p)];u.push(jn(ne,o,_e,n,a))}else{var se=!1;for(f=0;f!=n.arrayf.length;++f)if(h=n.arrayf[f],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){u.push(jn(h[1],o,_e,n,a)),se=!0;break}se||u.push(N[1])}break;case"PtgArray":u.push("{"+bG(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":T=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var Ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&T>=0&&Ee.indexOf(t[0][k][0])==-1){N=t[0][T];var ie=!0;switch(N[1][0]){case 4:ie=!1;case 0:E=Dr(" ",N[1][1]);break;case 5:ie=!1;case 1:E=Dr("\r",N[1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}u.push((ie?E:"")+u.pop()+(ie?"":E)),T=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function TG(t,e,r){var n=t.l+e,a=r.biff==2?1:2,i,o=t.read_shift(a);if(o==65535)return[[],Un(t,e-2)];var u=oh(t,o,r);return e!==o+a&&(i=lh(t,e-o-a,u,r)),t.l=n,[u,i]}function SG(t,e,r){var n=t.l+e,a=r.biff==2?1:2,i,o=t.read_shift(a);if(o==65535)return[[],Un(t,e-2)];var u=oh(t,o,r);return e!==o+a&&(i=lh(t,e-o-a,u,r)),t.l=n,[u,i]}function AG(t,e,r,n){var a=t.l+e,i=oh(t,n,r),o;return a!==t.l&&(o=lh(t,a-t.l,i,r)),[i,o]}function kG(t,e,r){var n=t.l+e,a,i=t.read_shift(2),o=oh(t,i,r);return i==65535?[[],Un(t,e-2)]:(e!==i+2&&(a=lh(t,n-i-2,o,r)),[o,a])}function NG(t){var e;if(ki(t,t.l+6)!==65535)return[Ln(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function CG(t){if(t==null){var e=Se(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return ec(t);return ec(0)}function ux(t,e,r){var n=t.l+e,a=ei(t);r.biff==2&&++t.l;var i=NG(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=SG(t,n-t.l,r);return{cell:a,val:i[0],formula:u,shared:o>>3&1,tt:i[1]}}function RG(t,e,r,n,a){var i=rc(e,r,a),o=CG(t.v),u=Se(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var h=Se(t.bf.length),p=0;p<t.bf.length;++p)h[p]=t.bf[p];var x=mn([i,o,u,h]);return x}function jp(t,e,r){var n=t.read_shift(4),a=oh(t,n,r),i=t.read_shift(4),o=i>0?lh(t,i,a,r):null;return[a,o]}var IG=jp,Pp=jp,DG=jp,OG=jp,FG={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},GC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},jG={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function FS(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function PG(t){var e="of:="+t.replace(t_,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function fx(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function MG(t){return t.replace(/\./,"!")}var s0={},pu={},i0=typeof Map<"u";function a_(t,e,r){var n=0,a=t.length;if(r){if(i0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=i0?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(i0?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function Mp(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Mn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=N0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Xm(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Wo(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function lo(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,i=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Ii(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=i;++a)if(t[a].numFmtId===n)return a;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function WC(t,e,r,n,a,i){try{n.cellNF&&(t.z=ot[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=yr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ot[e]==null&&Ii(F7[e]||"General",e),t.t==="e")t.w=t.w||qi[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=b0(t.v);else if(t.t==="d"){var o=ln(t.v);(o|0)===o?t.w=o.toString(10):t.w=b0(o)}else{if(t.v===void 0)return"";t.w=Jo(t.v,pu)}else t.t==="d"?t.w=es(e,ln(t.v),pu):t.w=es(e,t.v,pu)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Wm(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Wm(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&i.Fills)throw u}}}function LG(t,e,r){if(t&&t["!ref"]){var n=Bt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function BG(t,e){var r=Bt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=bt(r))}var VG=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,UG=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zG=/<(?:\w:)?hyperlink [^>]*>/mg,HG=/"(\w*:\w*)"/,qG=/<(?:\w:)?col\b[^>]*[\/]?>/g,GG=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,WG=/<(?:\w:)?pageMargins[^>]*\/>/g,XC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,XG=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,YG=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function $G(t,e,r,n,a,i,o){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",x=t.match(UG);x?(h=t.slice(0,x.index),p=t.slice(x.index+x[0].length)):h=p=t;var y=h.match(XC);y?s_(y[0],u,a,r):(y=h.match(XG))&&QG(y[0],y[1]||"",u,a,r);var b=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(b>0){var w=h.slice(b,b+50).match(HG);w&&BG(u,w[1])}var T=h.match(YG);T&&T[1]&&uW(T[1],a);var E=[];if(e.cellStyles){var k=h.match(qG);k&&sW(E,k)}x&&dW(x[1],u,e,f,i,o);var I=p.match(GG);I&&(u["!autofilter"]=lW(I[0]));var N=[],z=p.match(VG);if(z)for(b=0;b!=z.length;++b)N[b]=Bt(z[b].slice(z[b].indexOf('"')+1));var H=p.match(zG);H&&rW(u,H,n);var q=p.match(WG);if(q&&(u["!margins"]=nW(mt(q[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=bt(f)),e.sheetRows>0&&u["!ref"]){var A=Bt(u["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>f.e.r&&(A.e.r=f.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>f.e.c&&(A.e.c=f.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),u["!fullref"]=u["!ref"],u["!ref"]=bt(A))}return E.length>0&&(u["!cols"]=E),N.length>0&&(u["!merges"]=N),u}function KG(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+bt(t[r])+'"/>';return e+"</mergeCells>"}function s_(t,e,r,n){var a=mt(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Lt(lr(a.codeName)))}function QG(t,e,r,n,a){s_(t.slice(0,t.indexOf(">")),r,n,a)}function JG(t,e,r,n,a){var i=!1,o={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[r];try{e.Workbook&&(f=e.Workbook.Sheets[r].CodeName||f)}catch{}i=!0,o.codeName=zs(rr(f))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),u=(u||"")+He("outlinePr",null,h)}!i&&!u||(a[a.length]=He("sheetPr",u,o))}var ZG=["objects","scenarios","selectLockedCells","selectUnlockedCells"],eW=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function tW(t){var e={sheet:1};return ZG.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),eW.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Jy(t.password).toString(16).toUpperCase()),He("sheetProtection",null,e)}function rW(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var i=mt(lr(e[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+Lt(i.location))):(i.Target="#"+Lt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var u=Bt(i.ref),f=u.s.r;f<=u.e.r;++f)for(var h=u.s.c;h<=u.e.c;++h){var p=ct({c:h,r:f});n?(t[f]||(t[f]=[]),t[f][h]||(t[f][h]={t:"z",v:void 0}),t[f][h].l=i):(t[p]||(t[p]={t:"z",v:void 0}),t[p].l=i)}}}function nW(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function aW(t){return Wo(t),He("pageMargins",null,t)}function sW(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=mt(e[n],!0);a.hidden&&(a.hidden=xr(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Zy(a.width)),Ql(a);i<=o;)t[i++]=_r(a)}}function iW(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=He("col",null,Mp(a,n)));return r[r.length]="</cols>",r.join("")}function lW(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function oW(t,e,r,n){var a=typeof t.ref=="string"?t.ref:bt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=ha(a);o.s.r==o.e.r&&(o.e.r=ha(e["!ref"]).e.r,a=bt(o));for(var u=0;u<i.length;++u){var f=i[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),He("autoFilter",null,{ref:a})}var cW=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function uW(t,e){e.Views||(e.Views=[{}]),(t.match(cW)||[]).forEach(function(r,n){var a=mt(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),xr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function fW(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),He("sheetViews",He("sheetView",null,a),{})}function hW(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=qi[t.v];break;case"d":n&&n.cellDates?a=yr(t.v,-1).toISOString():(t=_r(t),t.t="n",a=""+(t.v=ln(yr(t.v)))),typeof t.z>"u"&&(t.z=ot[14]);break;default:a=t.v;break}var u=Sn("v",rr(a)),f={r:e},h=lo(n.cellXfs,t,n);switch(h!==0&&(f.s=h),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=Sn("v",""+a_(n.Strings,t.v,n.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var p=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=He("f",rr(t.f),p)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(f.cm=1),He("c",u,f)}var dW=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=w0("v"),o=w0("f");return function(f,h,p,x,y,b){for(var w=0,T="",E=[],k=[],I=0,N=0,z=0,H="",q,A,F=0,R=0,M,O,j=0,L=0,Ne=Array.isArray(b.CellXf),_e,ne=[],se=[],Ee=Array.isArray(h),ie=[],Ve={},U=!1,P=!!p.sheetStubs,G=f.split(e),Y=0,Z=G.length;Y!=Z;++Y){T=G[Y].trim();var oe=T.length;if(oe!==0){var ye=0;e:for(w=0;w<oe;++w)switch(T[w]){case">":if(T[w-1]!="/"){++w;break e}if(p&&p.cellStyles){if(A=mt(T.slice(ye,w),!0),F=A.r!=null?parseInt(A.r,10):F+1,R=-1,p.sheetRows&&p.sheetRows<F)continue;Ve={},U=!1,A.ht&&(U=!0,Ve.hpt=parseFloat(A.ht),Ve.hpx=Au(Ve.hpt)),A.hidden=="1"&&(U=!0,Ve.hidden=!0),A.outlineLevel!=null&&(U=!0,Ve.level=+A.outlineLevel),U&&(ie[F-1]=Ve)}break;case"<":ye=w;break}if(ye>=w)break;if(A=mt(T.slice(ye,w),!0),F=A.r!=null?parseInt(A.r,10):F+1,R=-1,!(p.sheetRows&&p.sheetRows<F)){x.s.r>F-1&&(x.s.r=F-1),x.e.r<F-1&&(x.e.r=F-1),p&&p.cellStyles&&(Ve={},U=!1,A.ht&&(U=!0,Ve.hpt=parseFloat(A.ht),Ve.hpx=Au(Ve.hpt)),A.hidden=="1"&&(U=!0,Ve.hidden=!0),A.outlineLevel!=null&&(U=!0,Ve.level=+A.outlineLevel),U&&(ie[F-1]=Ve)),E=T.slice(w).split(t);for(var Fe=0;Fe!=E.length&&E[Fe].trim().charAt(0)=="<";++Fe);for(E=E.slice(Fe),w=0;w!=E.length;++w)if(T=E[w].trim(),T.length!==0){if(k=T.match(r),I=w,N=0,z=0,T="<c "+(T.slice(0,1)=="<"?">":"")+T,k!=null&&k.length===2){for(I=0,H=k[1],N=0;N!=H.length&&!((z=H.charCodeAt(N)-64)<1||z>26);++N)I=26*I+z;--I,R=I}else++R;for(N=0;N!=T.length&&T.charCodeAt(N)!==62;++N);if(++N,A=mt(T.slice(0,N),!0),A.r||(A.r=ct({r:F-1,c:R})),H=T.slice(N),q={t:""},(k=H.match(i))!=null&&k[1]!==""&&(q.v=Lt(k[1])),p.cellFormula){if((k=H.match(o))!=null&&k[1]!==""){if(q.f=Lt(lr(k[1])).replace(/\r\n/g,`
`),p.xlfn||(q.f=RS(q.f)),k[0].indexOf('t="array"')>-1)q.F=(H.match(a)||[])[1],q.F.indexOf(":")>-1&&ne.push([Bt(q.F),q.F]);else if(k[0].indexOf('t="shared"')>-1){O=mt(k[0]);var Te=Lt(lr(k[1]));p.xlfn||(Te=RS(Te)),se[parseInt(O.si,10)]=[O,Te,A.r]}}else(k=H.match(/<f[^>]*\/>/))&&(O=mt(k[0]),se[O.si]&&(q.f=cq(se[O.si][1],se[O.si][2],A.r)));var De=kr(A.r);for(N=0;N<ne.length;++N)De.r>=ne[N][0].s.r&&De.r<=ne[N][0].e.r&&De.c>=ne[N][0].s.c&&De.c<=ne[N][0].e.c&&(q.F=ne[N][1])}if(A.t==null&&q.v===void 0)if(q.f||q.F)q.v=0,q.t="n";else if(P)q.t="z";else continue;else q.t=A.t||"n";switch(x.s.c>R&&(x.s.c=R),x.e.c<R&&(x.e.c=R),q.t){case"n":if(q.v==""||q.v==null){if(!P)continue;q.t="z"}else q.v=parseFloat(q.v);break;case"s":if(typeof q.v>"u"){if(!P)continue;q.t="z"}else M=s0[parseInt(q.v,10)],q.v=M.t,q.r=M.r,p.cellHTML&&(q.h=M.h);break;case"str":q.t="s",q.v=q.v!=null?lr(q.v):"",p.cellHTML&&(q.h=My(q.v));break;case"inlineStr":k=H.match(n),q.t="s",k!=null&&(M=Qy(k[1]))?(q.v=M.t,p.cellHTML&&(q.h=M.h)):q.v="";break;case"b":q.v=xr(q.v);break;case"d":p.cellDates?q.v=yr(q.v,1):(q.v=ln(yr(q.v,1)),q.t="n");break;case"e":(!p||p.cellText!==!1)&&(q.w=q.v),q.v=$N[q.v];break}if(j=L=0,_e=null,Ne&&A.s!==void 0&&(_e=b.CellXf[A.s],_e!=null&&(_e.numFmtId!=null&&(j=_e.numFmtId),p.cellStyles&&_e.fillId!=null&&(L=_e.fillId))),WC(q,j,L,p,y,b),p.cellDates&&Ne&&q.t=="n"&&Mu(ot[j])&&(q.t="d",q.v=Op(q.v)),A.cm&&p.xlmeta){var rt=(p.xlmeta.Cell||[])[+A.cm-1];rt&&rt.type=="XLDAPR"&&(q.D=!0)}if(Ee){var re=kr(A.r);h[re.r]||(h[re.r]=[]),h[re.r][re.c]=q}else h[A.r]=q}}}}ie.length>0&&(h["!rows"]=ie)}})();function mW(t,e,r,n){var a=[],i=[],o=Bt(t["!ref"]),u="",f,h="",p=[],x=0,y=0,b=t["!rows"],w=Array.isArray(t),T={r:h},E,k=-1;for(y=o.s.c;y<=o.e.c;++y)p[y]=Ar(y);for(x=o.s.r;x<=o.e.r;++x){for(i=[],h=Ur(x),y=o.s.c;y<=o.e.c;++y){f=p[y]+h;var I=w?(t[x]||[])[y]:t[f];I!==void 0&&(u=hW(I,f,t,e))!=null&&i.push(u)}(i.length>0||b&&b[x])&&(T={r:h},b&&b[x]&&(E=b[x],E.hidden&&(T.hidden=1),k=-1,E.hpx?k=C0(E.hpx):E.hpt&&(k=E.hpt),k>-1&&(T.ht=k,T.customHeight=1),E.level&&(T.outlineLevel=E.level)),a[a.length]=He("row",i.join(""),T))}if(b)for(;x<b.length;++x)b&&b[x]&&(T={r:x+1},E=b[x],E.hidden&&(T.hidden=1),k=-1,E.hpx?k=C0(E.hpx):E.hpt&&(k=E.hpt),k>-1&&(T.ht=k,T.customHeight=1),E.level&&(T.outlineLevel=E.level),a[a.length]=He("row","",T));return a.join("")}function YC(t,e,r,n){var a=[zr,He("worksheet",null,{xmlns:oc[0],"xmlns:r":nn.r})],i=r.SheetNames[t],o=0,u="",f=r.Sheets[i];f==null&&(f={});var h=f["!ref"]||"A1",p=Bt(h);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),h=bt(p)}n||(n={}),f["!comments"]=[];var x=[];JG(f,r,t,e,a),a[a.length]=He("dimension",null,{ref:h}),a[a.length]=fW(f,e,t,r),e.sheetFormat&&(a[a.length]=He("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=iW(f,f["!cols"])),a[o=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=mW(f,e),u.length>0&&(a[a.length]=u)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),f["!protect"]&&(a[a.length]=tW(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=oW(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=KG(f["!merges"]));var y=-1,b,w=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(T){T[1].Target&&(b={ref:T[0]},T[1].Target.charAt(0)!="#"&&(w=tr(n,-1,rr(T[1].Target).replace(/#.*$/,""),At.HLINK),b["r:id"]="rId"+w),(y=T[1].Target.indexOf("#"))>-1&&(b.location=rr(T[1].Target.slice(y+1))),T[1].Tooltip&&(b.tooltip=rr(T[1].Tooltip)),a[a.length]=He("hyperlink",null,b))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=aW(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=Sn("ignoredErrors",He("ignoredError",null,{numberStoredAsText:1,sqref:h}))),x.length>0&&(w=tr(n,-1,"../drawings/drawing"+(t+1)+".xml",At.DRAW),a[a.length]=He("drawing",null,{"r:id":"rId"+w}),f["!drawing"]=x),f["!comments"].length>0&&(w=tr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",At.VML),a[a.length]=He("legacyDrawing",null,{"r:id":"rId"+w}),f["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function pW(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function gW(t,e,r){var n=Se(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;a.hpx?i=C0(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var h={r:t,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var x=-1,y=-1,b=p<<10;b<p+1<<10;++b){h.c=b;var w=Array.isArray(r)?(r[h.r]||[])[h.c]:r[ct(h)];w&&(x<0&&(x=b),y=b)}x<0||(++u,n.write_shift(4,x),n.write_shift(4,y))}var T=n.l;return n.l=f,n.write_shift(4,u),n.l=T,n.length>n.l?n.slice(0,n.l):n}function xW(t,e,r,n){var a=gW(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Me(t,0,a)}var vW=hc,yW=Vu;function _W(){}function bW(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=TB(t),r}function wW(t,e,r){r==null&&(r=Se(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Hm({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),qN(t,r),r.slice(0,r.l)}function EW(t){var e=rs(t);return[e]}function TW(t,e,r){return r==null&&(r=Se(8)),cc(e,r)}function SW(t){var e=uc(t);return[e]}function AW(t,e,r){return r==null&&(r=Se(4)),fc(e,r)}function kW(t){var e=rs(t),r=t.read_shift(1);return[e,r,"b"]}function NW(t,e,r){return r==null&&(r=Se(9)),cc(e,r),r.write_shift(1,t.v?1:0),r}function CW(t){var e=uc(t),r=t.read_shift(1);return[e,r,"b"]}function RW(t,e,r){return r==null&&(r=Se(5)),fc(e,r),r.write_shift(1,t.v?1:0),r}function IW(t){var e=rs(t),r=t.read_shift(1);return[e,r,"e"]}function DW(t,e,r){return r==null&&(r=Se(9)),cc(e,r),r.write_shift(1,t.v),r}function OW(t){var e=uc(t),r=t.read_shift(1);return[e,r,"e"]}function FW(t,e,r){return r==null&&(r=Se(8)),fc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function jW(t){var e=rs(t),r=t.read_shift(4);return[e,r,"s"]}function PW(t,e,r){return r==null&&(r=Se(12)),cc(e,r),r.write_shift(4,e.v),r}function MW(t){var e=uc(t),r=t.read_shift(4);return[e,r,"s"]}function LW(t,e,r){return r==null&&(r=Se(8)),fc(e,r),r.write_shift(4,e.v),r}function BW(t){var e=rs(t),r=Ln(t);return[e,r,"n"]}function VW(t,e,r){return r==null&&(r=Se(16)),cc(e,r),ec(t.v,r),r}function $C(t){var e=uc(t),r=Ln(t);return[e,r,"n"]}function UW(t,e,r){return r==null&&(r=Se(12)),fc(e,r),ec(t.v,r),r}function zW(t){var e=rs(t),r=Wy(t);return[e,r,"n"]}function HW(t,e,r){return r==null&&(r=Se(12)),cc(e,r),GN(t.v,r),r}function qW(t){var e=uc(t),r=Wy(t);return[e,r,"n"]}function GW(t,e,r){return r==null&&(r=Se(8)),fc(e,r),GN(t.v,r),r}function WW(t){var e=rs(t),r=Hy(t);return[e,r,"is"]}function XW(t){var e=rs(t),r=Bn(t);return[e,r,"str"]}function YW(t,e,r){return r==null&&(r=Se(12+4*t.v.length)),cc(e,r),pn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function $W(t){var e=uc(t),r=Bn(t);return[e,r,"str"]}function KW(t,e,r){return r==null&&(r=Se(8+4*t.v.length)),fc(e,r),pn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function QW(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=t.read_shift(1),o=[a,i,"b"];if(r.cellFormula){t.l+=2;var u=Pp(t,n-t.l,r);o[3]=jn(u,null,a,r.supbooks,r)}else t.l=n;return o}function JW(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=t.read_shift(1),o=[a,i,"e"];if(r.cellFormula){t.l+=2;var u=Pp(t,n-t.l,r);o[3]=jn(u,null,a,r.supbooks,r)}else t.l=n;return o}function ZW(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=Ln(t),o=[a,i,"n"];if(r.cellFormula){t.l+=2;var u=Pp(t,n-t.l,r);o[3]=jn(u,null,a,r.supbooks,r)}else t.l=n;return o}function eX(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=Bn(t),o=[a,i,"str"];if(r.cellFormula){t.l+=2;var u=Pp(t,n-t.l,r);o[3]=jn(u,null,a,r.supbooks,r)}else t.l=n;return o}var tX=hc,rX=Vu;function nX(t,e){return e==null&&(e=Se(4)),e.write_shift(4,t),e}function aX(t,e){var r=t.l+e,n=hc(t),a=qy(t),i=Bn(t),o=Bn(t),u=Bn(t);t.l=r;var f={rfx:n,relId:a,loc:i,display:u};return o&&(f.Tooltip=o),f}function sX(t,e){var r=Se(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Vu({s:kr(t[0]),e:kr(t[0])},r),Gy("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return pn(a||"",r),pn(t[1].Tooltip||"",r),pn("",r),r.slice(0,r.l)}function iX(){}function lX(t,e,r){var n=t.l+e,a=WN(t),i=t.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var u=IG(t,n-t.l,r);o[1]=u}else t.l=n;return o}function oX(t,e,r){var n=t.l+e,a=hc(t),i=[a];if(r.cellFormula){var o=OG(t,n-t.l,r);i[1]=o,t.l=n}else t.l=n;return i}function cX(t,e,r){r==null&&(r=Se(18));var n=Mp(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var KC=["left","right","top","bottom","header","footer"];function uX(t){var e={};return KC.forEach(function(r){e[r]=Ln(t)}),e}function fX(t,e){return e==null&&(e=Se(48)),Wo(t),KC.forEach(function(r){ec(t[r],e)}),e}function hX(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function dX(t,e,r){r==null&&(r=Se(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function mX(t){var e=Se(24);return e.write_shift(4,4),e.write_shift(4,1),Vu(t,e),e}function pX(t,e){return e==null&&(e=Se(66)),e.write_shift(2,t.password?Jy(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function gX(){}function xX(){}function vX(t,e,r,n,a,i,o){if(!t)return t;var u=e||{};n||(n={"!id":{}});var f=u.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,y=!1,b,w,T,E,k,I,N,z,H,q=[];u.biff=12,u["!row"]=0;var A=0,F=!1,R=[],M={},O=u.supbooks||a.supbooks||[[]];if(O.sharedf=M,O.arrayf=R,O.SheetNames=a.SheetNames||a.Sheets.map(function(Ee){return Ee.name}),!u.supbooks&&(u.supbooks=O,a.Names))for(var j=0;j<a.Names.length;++j)O[0][j+1]=a.Names[j];var L=[],Ne=[],_e=!1;R0[16]={n:"BrtShortReal",f:$C};var ne;if(Hi(t,function(ie,Ve,U){if(!y)switch(U){case 148:h=ie;break;case 0:b=ie,u.sheetRows&&u.sheetRows<=b.r&&(y=!0),z=Ur(E=b.r),u["!row"]=b.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=Au(ie.hpt)),Ne[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:ie[2]},ie[2]){case"n":w.v=ie[1];break;case"s":N=s0[ie[1]],w.v=N.t,w.r=N.r;break;case"b":w.v=!!ie[1];break;case"e":w.v=ie[1],u.cellText!==!1&&(w.w=qi[w.v]);break;case"str":w.t="s",w.v=ie[1];break;case"is":w.t="s",w.v=ie[1].t;break}if((T=o.CellXf[ie[0].iStyleRef])&&WC(w,T.numFmtId,null,u,i,o),k=ie[0].c==-1?k+1:ie[0].c,u.dense?(f[E]||(f[E]=[]),f[E][k]=w):f[Ar(k)+z]=w,u.cellFormula){for(F=!1,A=0;A<R.length;++A){var P=R[A];b.r>=P[0].s.r&&b.r<=P[0].e.r&&k>=P[0].s.c&&k<=P[0].e.c&&(w.F=bt(P[0]),F=!0)}!F&&ie.length>3&&(w.f=ie[3])}if(p.s.r>b.r&&(p.s.r=b.r),p.s.c>k&&(p.s.c=k),p.e.r<b.r&&(p.e.r=b.r),p.e.c<k&&(p.e.c=k),u.cellDates&&T&&w.t=="n"&&Mu(ot[T.numFmtId])){var G=Lo(w.v);G&&(w.t="d",w.v=new Date(G.y,G.m-1,G.d,G.H,G.M,G.S,G.u))}ne&&(ne.type=="XLDAPR"&&(w.D=!0),ne=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;w={t:"z",v:void 0},k=ie[0].c==-1?k+1:ie[0].c,u.dense?(f[E]||(f[E]=[]),f[E][k]=w):f[Ar(k)+z]=w,p.s.r>b.r&&(p.s.r=b.r),p.s.c>k&&(p.s.c=k),p.e.r<b.r&&(p.e.r=b.r),p.e.c<k&&(p.e.c=k),ne&&(ne.type=="XLDAPR"&&(w.D=!0),ne=void 0);break;case 176:q.push(ie);break;case 49:ne=((u.xlmeta||{}).Cell||[])[ie-1];break;case 494:var Y=n["!id"][ie.relId];for(Y?(ie.Target=Y.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=Y):ie.relId==""&&(ie.Target="#"+ie.loc),E=ie.rfx.s.r;E<=ie.rfx.e.r;++E)for(k=ie.rfx.s.c;k<=ie.rfx.e.c;++k)u.dense?(f[E]||(f[E]=[]),f[E][k]||(f[E][k]={t:"z",v:void 0}),f[E][k].l=ie):(I=ct({c:k,r:E}),f[I]||(f[I]={t:"z",v:void 0}),f[I].l=ie);break;case 426:if(!u.cellFormula)break;R.push(ie),H=u.dense?f[E][k]:f[Ar(k)+z],H.f=jn(ie[1],p,{r:b.r,c:k},O,u),H.F=bt(ie[0]);break;case 427:if(!u.cellFormula)break;M[ct(ie[0].s)]=ie[1],H=u.dense?f[E][k]:f[Ar(k)+z],H.f=jn(ie[1],p,{r:b.r,c:k},O,u);break;case 60:if(!u.cellStyles)break;for(;ie.e>=ie.s;)L[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},_e||(_e=!0,Zy(ie.w/256)),Ql(L[ie.e+1]);break;case 161:f["!autofilter"]={ref:bt(ie)};break;case 476:f["!margins"]=ie;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ie.name&&(a.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(f["!outline"]={above:ie.above,left:ie.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ie.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!Ve.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+U.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(f["!ref"]=bt(h||p)),u.sheetRows&&f["!ref"]){var se=Bt(f["!ref"]);u.sheetRows<=+se.e.r&&(se.e.r=u.sheetRows-1,se.e.r>p.e.r&&(se.e.r=p.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>p.e.c&&(se.e.c=p.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),f["!fullref"]=f["!ref"],f["!ref"]=bt(se))}return q.length>0&&(f["!merges"]=q),L.length>0&&(f["!cols"]=L),Ne.length>0&&(f["!rows"]=Ne),f}function yX(t,e,r,n,a,i,o){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=_r(e),e.z=e.z||ot[14],e.v=ln(yr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r,c:n};switch(f.s=lo(a.cellXfs,e,a),e.l&&i["!links"].push([ct(f),e.l]),e.c&&i["!comments"].push([ct(f),e.c]),e.t){case"s":case"str":return a.bookSST?(u=a_(a.Strings,e.v,a.revStrings),f.t="s",f.v=u,o?Me(t,18,LW(e,f)):Me(t,7,PW(e,f))):(f.t="str",o?Me(t,17,KW(e,f)):Me(t,6,YW(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Me(t,13,GW(e,f)):Me(t,2,HW(e,f)):o?Me(t,16,UW(e,f)):Me(t,5,VW(e,f)),!0;case"b":return f.t="b",o?Me(t,15,RW(e,f)):Me(t,4,NW(e,f)),!0;case"e":return f.t="e",o?Me(t,14,FW(e,f)):Me(t,3,DW(e,f)),!0}return o?Me(t,12,AW(e,f)):Me(t,1,TW(e,f)),!0}function _X(t,e,r,n){var a=Bt(e["!ref"]||"A1"),i,o="",u=[];Me(t,145);var f=Array.isArray(e),h=a.e.r;e["!rows"]&&(h=Math.max(a.e.r,e["!rows"].length-1));for(var p=a.s.r;p<=h;++p){o=Ur(p),xW(t,e,a,p);var x=!1;if(p<=a.e.r)for(var y=a.s.c;y<=a.e.c;++y){p===a.s.r&&(u[y]=Ar(y)),i=u[y]+o;var b=f?(e[p]||[])[y]:e[i];if(!b){x=!1;continue}x=yX(t,b,p,y,n,e,x)}}Me(t,146)}function bX(t,e){!e||!e["!merges"]||(Me(t,177,nX(e["!merges"].length)),e["!merges"].forEach(function(r){Me(t,176,rX(r))}),Me(t,178))}function wX(t,e){!e||!e["!cols"]||(Me(t,390),e["!cols"].forEach(function(r,n){r&&Me(t,60,cX(n,r))}),Me(t,391))}function EX(t,e){!e||!e["!ref"]||(Me(t,648),Me(t,649,mX(Bt(e["!ref"]))),Me(t,650))}function TX(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=tr(r,-1,n[1].Target.replace(/#.*$/,""),At.HLINK);Me(t,494,sX(n,a))}}),delete e["!links"]}function SX(t,e,r,n){if(e["!comments"].length>0){var a=tr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",At.VML);Me(t,551,Gy("rId"+a)),e["!legacy"]=a}}function AX(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],i=typeof a.ref=="string"?a.ref:bt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=ha(i);u.s.r==u.e.r&&(u.e.r=ha(e["!ref"]).e.r,i=bt(u));for(var f=0;f<o.length;++f){var h=o[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+i;break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Me(t,161,Vu(Bt(i))),Me(t,162)}}function kX(t,e,r){Me(t,133),Me(t,137,dX(e,r)),Me(t,138),Me(t,134)}function NX(t,e){e["!protect"]&&Me(t,535,pX(e["!protect"]))}function CX(t,e,r,n){var a=fa(),i=r.SheetNames[t],o=r.Sheets[i]||{},u=i;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var f=Bt(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Me(a,129),(r.vbaraw||o["!outline"])&&Me(a,147,wW(u,o["!outline"])),Me(a,148,yW(f)),kX(a,o,r.Workbook),wX(a,o),_X(a,o,t,e),NX(a,o),AX(a,o,r,t),bX(a,o),TX(a,o,n),o["!margins"]&&Me(a,476,fX(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&EX(a,o),SX(a,o,t,n),Me(a,130),a.end()}function RX(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var a=Lt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,a,n]}function IX(t,e,r,n,a,i){var o=i||{"!type":"chart"};if(!t)return i;var u=0,f=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var y=RX(x);p.s.r=p.s.c=0,p.e.c=u,h=Ar(u),y[0].forEach(function(b,w){o[h+Ur(w)]={t:"n",v:b,z:y[1]},f=w}),p.e.r<f&&(p.e.r=f),++u}),u>0&&(o["!ref"]=bt(p)),o}function DX(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,u=t.match(XC);return u&&s_(u[0],i,a,r),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function OX(t,e){t.l+=10;var r=Bn(t);return{name:r}}function FX(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Hi(t,function(f,h,p){switch(p){case 550:i["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var i_=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],jX=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],PX=[],MX=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jS(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var i=e[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=xr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function PS(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=xr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function QC(t){PS(t.WBProps,i_),PS(t.CalcPr,MX),jS(t.WBView,jX),jS(t.Sheets,PX),pu.date1904=xr(t.WBProps.date1904)}function LX(t){return!t.Workbook||!t.Workbook.WBProps?"false":xr(t.Workbook.WBProps.date1904)?"true":"false"}var BX="][*?/\\".split("");function JC(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return BX.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function VX(t,e,r){t.forEach(function(n,a){JC(n);for(var i=0;i<a;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[a]&&e[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function UX(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];VX(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)LG(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var zX=/<\w+:workbook/;function HX(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(t.replace(zn,function(f,h){var p=mt(f);switch(Zs(p[0])){case"<?xml":break;case"<workbook":f.match(zX)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":i_.forEach(function(x){if(p[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=xr(p[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(p[x[0]],10);break;default:r.WBProps[x[0]]=p[x[0]]}}),p.codeName&&(r.WBProps.CodeName=lr(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Lt(lr(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=lr(p.name),p.comment&&(i.Comment=p.comment),p.localSheetId&&(i.Sheet=+p.localSheetId),xr(p.hidden||"0")&&(i.Hidden=!0),o=h+f.length;break;case"</definedName>":i.Ref=Lt(lr(t.slice(o,h))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return f}),oc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return QC(r),r}function ZC(t){var e=[zr];e[e.length]=He("workbook",null,{xmlns:oc[0],"xmlns:r":nn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(i_.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=He("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:rr(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=He("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=He("definedName",rr(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function qX(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=tv(t),r.name=Bn(t),r}function GX(t,e){return e||(e=Se(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Gy(t.strRelID,e),pn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function WX(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?Bn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function XX(t,e){e||(e=Se(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),qN(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function YX(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function $X(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),i=SB(t),o=DG(t,0,r),u=qy(t);t.l=n;var f={Name:i,Ptg:o};return a<268435455&&(f.Sheet=a),u&&(f.Comment=u),f}function KX(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],R0[16]={n:"BrtFRTArchID$",f:YX},Hi(t,function(f,h,p){switch(p){case 156:o.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=jn(f.Ptg,null,null,o,e),delete e.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([p,f]):o[0]=[p,f],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(f),o.XTI=o.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(p),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!h.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},e),QC(r),r.Names=i,r.supbooks=o,r}function QX(t,e){Me(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Me(t,156,GX(a))}Me(t,144)}function JX(t,e){e||(e=Se(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return pn("SheetJS",e),pn(Pm.version,e),pn(Pm.version,e),pn("7262",e),e.length>e.l?e.slice(0,e.l):e}function ZX(t,e){e||(e=Se(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function eY(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Me(t,135),Me(t,158,ZX(a)),Me(t,136))}}function tY(t,e){var r=fa();return Me(r,131),Me(r,128,JX()),Me(r,153,XX(t.Workbook&&t.Workbook.WBProps||null)),eY(r,t),QX(r,t),Me(r,132),r.end()}function rY(t,e,r){return e.slice(-4)===".bin"?KX(t,r):HX(t,r)}function nY(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?vX(t,n,r,a,i,o,u):$G(t,n,r,a,i,o,u)}function aY(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?FX(t,n,r,a,i):DX(t,n,r,a,i)}function sY(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?lq():oq()}function iY(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?sq():iq()}function lY(t,e,r,n){return e.slice(-4)===".bin"?rH(t,r,n):qz(t,r,n)}function oY(t,e,r){return OC(t,r)}function cY(t,e,r){return e.slice(-4)===".bin"?cz(t,r):iz(t,r)}function uY(t,e,r){return e.slice(-4)===".bin"?eq(t,r):GH(t,r)}function fY(t,e,r){return e.slice(-4)===".bin"?zH(t):VH(t)}function hY(t,e,r,n){return r.slice(-4)===".bin"?HH(t,e,r,n):void 0}function dY(t,e,r){return e.slice(-4)===".bin"?MH(t,e,r):BH(t,e,r)}function mY(t,e,r){return(e.slice(-4)===".bin"?tY:ZC)(t)}function pY(t,e,r,n,a){return(e.slice(-4)===".bin"?CX:YC)(t,r,n,a)}function gY(t,e,r){return(e.slice(-4)===".bin"?hH:IC)(t,r)}function xY(t,e,r){return(e.slice(-4)===".bin"?hz:EC)(t,r)}function vY(t,e,r){return(e.slice(-4)===".bin"?tq:PC)(t)}function yY(t){return(t.slice(-4)===".bin"?LH:FC)()}var e3=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,t3=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function gs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(e3),i,o,u,f;if(a)for(f=0;f!=a.length;++f)i=a[f].match(t3),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?u="xmlns"+i[1].slice(6):u=i[1].slice(o+1),n[u]=i[2].slice(1,i[2].length-1));return n}function _Y(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(e3),a,i,o,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(t3),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var l0;function bY(t,e){var r=l0[t]||Lt(t);return r==="General"?Jo(e):es(r,e)}function wY(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=xr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=yr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Lt(e)]=a}function EY(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||qi[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=b0(t.v):t.w=Jo(t.v):t.w=bY(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=l0[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Mu(n)){var a=Lo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function TY(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=Pz[n.Pattern]||n.Pattern)}t[e.ID]=e}function SY(t,e,r,n,a,i,o,u,f,h){var p="General",x=n.StyleID,y={};h=h||{};var b=[],w=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&o&&(x=o.StyleID);i[x]!==void 0&&(i[x].nf&&(p=i[x].nf),i[x].Interior&&b.push(i[x].Interior),!!i[x].Parent);)x=i[x].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=xr(t);break;case"String":n.t="s",n.r=ZT(Lt(t)),n.v=t.indexOf("<")>-1?Lt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(yr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Lt(t):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=$N[t],h.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=ZT(e||t));break}if(EY(n,p,h),h.cellFormula!==!1)if(n.Formula){var T=Lt(n.Formula);T.charCodeAt(0)==61&&(T=T.slice(1)),n.f=mu(T,a),delete n.Formula,n.ArrayRange=="RC"?n.F=mu("RC:RC",a):n.ArrayRange&&(n.F=mu(n.ArrayRange,a),f.push([Bt(n.F),n.F]))}else for(w=0;w<f.length;++w)a.r>=f[w][0].s.r&&a.r<=f[w][0].e.r&&a.c>=f[w][0].s.c&&a.c<=f[w][0].e.c&&(n.F=f[w][1]);h.cellStyles&&(b.forEach(function(E){!y.patternType&&E.patternType&&(y.patternType=E.patternType)}),n.s=y),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function AY(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function hx(t,e){var r=e||{};Lu();var n=Wf(Ly(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=lr(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=_r(r);return o.type="string",Su.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(tt){a.indexOf("<"+tt)>=0&&(i=!0)}),i)return f$(n,r);l0={"General Number":"General","General Date":ot[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ot[15],"Short Date":ot[14],"Long Time":ot[19],"Medium Time":ot[18],"Short Time":ot[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ot[2],Standard:ot[4],Percent:ot[10],Scientific:ot[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],h,p={},x=[],y=r.dense?[]:{},b="",w={},T={},E=gs('<Data ss:Type="String">'),k=0,I=0,N=0,z={s:{r:2e6,c:2e6},e:{r:0,c:0}},H={},q={},A="",F=0,R=[],M={},O={},j=0,L=[],Ne=[],_e={},ne=[],se,Ee=!1,ie=[],Ve=[],U={},P=0,G=0,Y={Sheets:[],WBProps:{date1904:!1}},Z={};T0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";u=T0.exec(n);)switch(u[3]=(oe=u[3]).toLowerCase()){case"data":if(oe=="data"){if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?SY(n.slice(k,u.index),A,E,f[f.length-1][0]=="comment"?_e:w,{c:I,r:N},H,ne[I],T,ie,r):(A="",E=gs(u[0]),k=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Ne.length>0&&(w.c=Ne),(!r.sheetRows||r.sheetRows>N)&&w.v!==void 0&&(r.dense?(y[N]||(y[N]=[]),y[N][I]=w):y[Ar(I)+Ur(N)]=w),w.HRef&&(w.l={Target:Lt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(P=I+(parseInt(w.MergeAcross,10)|0),G=N+(parseInt(w.MergeDown,10)|0),R.push({s:{c:I,r:N},e:{c:P,r:G}})),!r.sheetStubs)w.MergeAcross?I=P+1:++I;else if(w.MergeAcross||w.MergeDown){for(var ye=I;ye<=P;++ye)for(var Fe=N;Fe<=G;++Fe)(ye>I||Fe>N)&&(r.dense?(y[Fe]||(y[Fe]=[]),y[Fe][ye]={t:"z"}):y[Ar(ye)+Ur(Fe)]={t:"z"});I=P+1}else++I;else w=_Y(u[0]),w.Index&&(I=+w.Index-1),I<z.s.c&&(z.s.c=I),I>z.e.c&&(z.e.c=I),u[0].slice(-2)==="/>"&&++I,Ne=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(N<z.s.r&&(z.s.r=N),N>z.e.r&&(z.e.r=N),u[0].slice(-2)==="/>"&&(T=gs(u[0]),T.Index&&(N=+T.Index-1)),I=0,++N):(T=gs(u[0]),T.Index&&(N=+T.Index-1),U={},(T.AutoFitHeight=="0"||T.Height)&&(U.hpx=parseInt(T.Height,10),U.hpt=C0(U.hpx),Ve[N]=U),T.Hidden=="1"&&(U.hidden=!0,Ve[N]=U));break;case"worksheet":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));x.push(b),z.s.r<=z.e.r&&z.s.c<=z.e.c&&(y["!ref"]=bt(z),r.sheetRows&&r.sheetRows<=z.e.r&&(y["!fullref"]=y["!ref"],z.e.r=r.sheetRows-1,y["!ref"]=bt(z))),R.length&&(y["!merges"]=R),ne.length>0&&(y["!cols"]=ne),Ve.length>0&&(y["!rows"]=Ve),p[b]=y}else z={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=I=0,f.push([u[3],!1]),h=gs(u[0]),b=Lt(h.Name),y=r.dense?[]:{},R=[],ie=[],Ve=[],Z={name:b,Hidden:0},Y.Sheets.push(Z);break;case"table":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),ne=[],Ee=!1}break;case"style":u[1]==="/"?TY(H,q,r):q=gs(u[0]);break;case"numberformat":q.nf=Lt(gs(u[0]).Format||"General"),l0[q.nf]&&(q.nf=l0[q.nf]);for(var Te=0;Te!=392&&ot[Te]!=q.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(ot[Te]==null){Ii(q.nf,Te);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(se=gs(u[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!Ee&&se.wpx>10){Ee=!0,Mn=CC;for(var De=0;De<ne.length;++De)ne[De]&&Ql(ne[De])}Ee&&Ql(se),ne[se.Index-1||ne.length]=se;for(var rt=0;rt<+se.Span;++rt)ne[ne.length]=_r(se);break;case"namedrange":if(u[1]==="/")break;Y.Names||(Y.Names=[]);var re=mt(u[0]),ft={Name:re.Name,Ref:mu(re.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(ft.Sheet=Y.Sheets.length-1),Y.Names.push(ft);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?A+=n.slice(F,u.index):F=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;q.Interior=gs(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?KB(M,oe,n.slice(j,u.index)):j=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));AY(_e),Ne.push(_e)}else f.push([u[3],!1]),h=gs(u[0]),_e={a:h.Author};break;case"autofilter":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var ce=gs(u[0]);y["!autofilter"]={ref:mu(ce.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((h=f.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return US(n,r);var ze=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ze=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ze=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ze=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:ze=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(j,u.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else j=u.index+u[0].length;break;case"header":y["!margins"]||Wo(y["!margins"]={},"xlml"),isNaN(+mt(u[0]).Margin)||(y["!margins"].header=+mt(u[0]).Margin);break;case"footer":y["!margins"]||Wo(y["!margins"]={},"xlml"),isNaN(+mt(u[0]).Margin)||(y["!margins"].footer=+mt(u[0]).Margin);break;case"pagemargins":var Ce=mt(u[0]);y["!margins"]||Wo(y["!margins"]={},"xlml"),isNaN(+Ce.Top)||(y["!margins"].top=+Ce.Top),isNaN(+Ce.Left)||(y["!margins"].left=+Ce.Left),isNaN(+Ce.Right)||(y["!margins"].right=+Ce.Right),isNaN(+Ce.Bottom)||(y["!margins"].bottom=+Ce.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ze=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ze=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ze=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ze=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ze=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ze=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ze=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ze=!1}break;case"smarttags":break;default:ze=!1;break}if(ze||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?wY(O,oe,L,n.slice(j,u.index)):(L=u,j=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var je={};return!r.bookSheets&&!r.bookProps&&(je.Sheets=p),je.SheetNames=x,je.Workbook=Y,je.SSF=_r(ot),je.Props=M,je.Custprops=O,je}function ov(t,e){switch(o_(e=e||{}),e.type||"base64"){case"base64":return hx(Ia(t),e);case"binary":case"buffer":case"file":return hx(t,e);case"array":return hx(so(t),e)}}function kY(t,e){var r=[];return t.Props&&r.push(QB(t.Props,e)),t.Custprops&&r.push(JB(t.Props,t.Custprops)),r.join("")}function NY(){return""}function CY(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var i=[];i.push(He("NumberFormat",null,{"ss:Format":rr(ot[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(He("Style",i.join(""),o))}),He("Styles",r.join(""))}function r3(t){return He("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+r_(t.Ref,{r:0,c:0})})}function RY(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(r3(a)))}return He("Names",r.join(""))}function IY(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],o=0;o<a.length;++o){var u=a[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||i.push(r3(u)))}return i.join("")}function DY(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(He("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(He("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(He("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(He("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(Sn("ProtectContents","True")),t["!protect"].objects&&a.push(Sn("ProtectObjects","True")),t["!protect"].scenarios&&a.push(Sn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(Sn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(Sn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":He("WorksheetOptions",a.join(""),{xmlns:Sa.x})}function OY(t){return t.map(function(e){var r=eB(e.t||""),n=He("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return He("Comment",n,{"ss:Author":e.a})}).join("")}function FY(t,e,r,n,a,i,o){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+rr(r_(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var f=kr(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=rr(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=rr(t.l.Tooltip))),r["!merges"])for(var h=r["!merges"],p=0;p!=h.length;++p)h[p].s.c!=o.c||h[p].s.r!=o.r||(h[p].e.c>h[p].s.c&&(u["ss:MergeAcross"]=h[p].e.c-h[p].s.c),h[p].e.r>h[p].s.r&&(u["ss:MergeDown"]=h[p].e.r-h[p].s.r));var x="",y="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":x="Number",y=String(t.v);break;case"b":x="Boolean",y=t.v?"1":"0";break;case"e":x="Error",y=qi[t.v];break;case"d":x="DateTime",y=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||ot[14]);break;case"s":x="String",y=Z7(t.v||"");break}var b=lo(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+b),u["ss:Index"]=o.c+1;var w=t.v!=null?y:"",T=t.t=="z"?"":'<Data ss:Type="'+x+'">'+w+"</Data>";return(t.c||[]).length>0&&(T+=OY(t.c)),He("Cell",T,u)}function jY(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Au(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function PY(t,e,r,n){if(!t["!ref"])return"";var a=Bt(t["!ref"]),i=t["!merges"]||[],o=0,u=[];t["!cols"]&&t["!cols"].forEach(function(E,k){Ql(E);var I=!!E.width,N=Mp(k,E),z={"ss:Index":k+1};I&&(z["ss:Width"]=k0(N.width)),E.hidden&&(z["ss:Hidden"]="1"),u.push(He("Column",null,z))});for(var f=Array.isArray(t),h=a.s.r;h<=a.e.r;++h){for(var p=[jY(h,(t["!rows"]||[])[h])],x=a.s.c;x<=a.e.c;++x){var y=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>x)&&!(i[o].s.r>h)&&!(i[o].e.c<x)&&!(i[o].e.r<h)){(i[o].s.c!=x||i[o].s.r!=h)&&(y=!0);break}if(!y){var b={r:h,c:x},w=ct(b),T=f?(t[h]||[])[x]:t[w];p.push(FY(T,w,t,e,r,n,b))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function MY(t,e,r){var n=[],a=r.SheetNames[t],i=r.Sheets[a],o=i?IY(i,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?PY(i,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(DY(i,e,t,r)),n.join("")}function LY(t,e){e||(e={}),t.SSF||(t.SSF=_r(ot)),t.SSF&&(Lu(),Rp(t.SSF),e.revssf=Dp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],lo(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(kY(t,e)),r.push(NY()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(He("Worksheet",MY(n,e,t),{"ss:Name":rr(t.SheetNames[n])}));return r[2]=CY(t,e),r[3]=RY(t),zr+He("Workbook",r.join(""),{xmlns:Sa.ss,"xmlns:o":Sa.o,"xmlns:x":Sa.x,"xmlns:ss":Sa.ss,"xmlns:dt":Sa.dt,"xmlns:html":Sa.html})}function BY(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=RB(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=IB(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var VY=[60,1084,2066,2165,2175];function UY(t,e,r,n,a){var i=n,o=[],u=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}o.push(u),r.l+=i;for(var f=ki(r,r.l),h=cv[f],p=0;h!=null&&VY.indexOf(f)>-1;)i=ki(r,r.l+2),p=r.l+4,f==2066?p+=4:(f==2165||f==2175)&&(p+=12),u=r.slice(p,r.l+4+i),o.push(u),r.l+=4+i,h=cv[f=ki(r,r.l)];var x=mn(o);En(x,0);var y=0;x.lens=[];for(var b=0;b<o.length;++b)x.lens.push(y),y+=o[b].length;if(x.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+x.length+" < "+n;return e.f(x,x.length,a)}function Ls(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ot[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||qi[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=b0(t.v):t.w=Jo(t.v):t.w=es(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Mu(ot[n]||String(n))){var a=Lo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Kd(t,e,r){return{v:t,ixfe:e,t:r}}function zY(t,e){var r={opts:{}},n={},a=e.dense?[]:{},i={},o={},u=null,f=[],h="",p={},x,y="",b,w,T,E,k={},I=[],N,z,H=[],q=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},R=function(dt){return dt<8?Ho[dt]:dt<64&&q[dt-8]||Ho[dt]},M=function(dt,Pt,tn){var Mt=Pt.XF.data;if(!(!Mt||!Mt.patternType||!tn||!tn.cellStyles)){Pt.s={},Pt.s.patternType=Mt.patternType;var or;(or=A0(R(Mt.icvFore)))&&(Pt.s.fgColor={rgb:or}),(or=A0(R(Mt.icvBack)))&&(Pt.s.bgColor={rgb:or})}},O=function(dt,Pt,tn){if(!(U>1)&&!(tn.sheetRows&&dt.r>=tn.sheetRows)){if(tn.cellStyles&&Pt.XF&&Pt.XF.data&&M(dt,Pt,tn),delete Pt.ixfe,delete Pt.XF,x=dt,y=ct(dt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<o.s.r&&(o.s.r=dt.r),dt.c<o.s.c&&(o.s.c=dt.c),dt.r+1>o.e.r&&(o.e.r=dt.r+1),dt.c+1>o.e.c&&(o.e.c=dt.c+1),tn.cellFormula&&Pt.f){for(var Mt=0;Mt<I.length;++Mt)if(!(I[Mt][0].s.c>dt.c||I[Mt][0].s.r>dt.r)&&!(I[Mt][0].e.c<dt.c||I[Mt][0].e.r<dt.r)){Pt.F=bt(I[Mt][0]),(I[Mt][0].s.c!=dt.c||I[Mt][0].s.r!=dt.r)&&delete Pt.f,Pt.f&&(Pt.f=""+jn(I[Mt][1],o,dt,ie,j));break}}tn.dense?(a[dt.r]||(a[dt.r]=[]),a[dt.r][dt.c]=Pt):a[y]=Pt}},j={enc:!1,sbcch:0,snames:[],sharedf:k,arrayf:I,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(j.password=e.password);var L,Ne=[],_e=[],ne=[],se=[],Ee=!1,ie=[];ie.SheetNames=j.snames,ie.sharedf=j.sharedf,ie.arrayf=j.arrayf,ie.names=[],ie.XTI=[];var Ve=0,U=0,P=0,G=[],Y=[],Z;j.codepage=1200,ws(1200);for(var oe=!1;t.l<t.length-1;){var ye=t.l,Fe=t.read_shift(2);if(Fe===0&&Ve===10)break;var Te=t.l===t.length?0:t.read_shift(2),De=cv[Fe];if(De&&De.f){if(e.bookSheets&&Ve===133&&Fe!==133)break;if(Ve=Fe,De.r===2||De.r==12){var rt=t.read_shift(2);if(Te-=2,!j.enc&&rt!==Fe&&((rt&255)<<8|rt>>8)!==Fe)throw new Error("rt mismatch: "+rt+"!="+Fe);De.r==12&&(t.l+=10,Te-=10)}var re={};if(Fe===10?re=De.f(t,Te,j):re=UY(Fe,De,t,Te,j),U==0&&[9,521,1033,2057].indexOf(Ve)===-1)continue;switch(Fe){case 34:r.opts.Date1904=A.WBProps.date1904=re;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(j.enc||(t.l=0),j.enc=re,!e.password)throw new Error("File is password-protected");if(re.valid==null)throw new Error("Encryption scheme unsupported");if(!re.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=re;break;case 66:var ft=Number(re);switch(ft){case 21010:ft=1200;break;case 32768:ft=1e4;break;case 32769:ft=1252;break}ws(j.codepage=ft),oe=!0;break;case 317:j.rrtabid=re;break;case 25:j.winlocked=re;break;case 439:r.opts.RefreshAll=re;break;case 12:r.opts.CalcCount=re;break;case 16:r.opts.CalcDelta=re;break;case 17:r.opts.CalcIter=re;break;case 13:r.opts.CalcMode=re;break;case 14:r.opts.CalcPrecision=re;break;case 95:r.opts.CalcSaveRecalc=re;break;case 15:j.CalcRefMode=re;break;case 2211:r.opts.FullCalc=re;break;case 129:re.fDialog&&(a["!type"]="dialog"),re.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),re.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:H.push(re);break;case 430:ie.push([re]),ie[ie.length-1].XTI=[];break;case 35:case 547:ie[ie.length-1].push(re);break;case 24:case 536:Z={Name:re.Name,Ref:jn(re.rgce,o,null,ie,j)},re.itab>0&&(Z.Sheet=re.itab-1),ie.names.push(Z),ie[0]||(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].push(re),re.Name=="_xlnm._FilterDatabase"&&re.itab>0&&re.rgce&&re.rgce[0]&&re.rgce[0][0]&&re.rgce[0][0][0]=="PtgArea3d"&&(Y[re.itab-1]={ref:bt(re.rgce[0][0][1][2])});break;case 22:j.ExternCount=re;break;case 23:ie.length==0&&(ie[0]=[],ie[0].XTI=[]),ie[ie.length-1].XTI=ie[ie.length-1].XTI.concat(re),ie.XTI=ie.XTI.concat(re);break;case 2196:if(j.biff<8)break;Z!=null&&(Z.Comment=re[1]);break;case 18:a["!protect"]=re;break;case 19:re!==0&&j.WTF&&console.error("Password verifier: "+re);break;case 133:i[re.pos]=re,j.snames.push(re.name);break;case 10:{if(--U)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=bt(o),e.sheetRows&&e.sheetRows<=o.e.r){var ce=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=bt(o),o.e.r=ce}o.e.r++,o.e.c++}Ne.length>0&&(a["!merges"]=Ne),_e.length>0&&(a["!objects"]=_e),ne.length>0&&(a["!cols"]=ne),se.length>0&&(a["!rows"]=se),A.Sheets.push(F)}h===""?p=a:n[h]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[Fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[re.BIFFVer]||8),j.biffguess=re.BIFFVer==0,re.BIFFVer==0&&re.dt==4096&&(j.biff=5,oe=!0,ws(j.codepage=28591)),j.biff==8&&re.BIFFVer==0&&re.dt==16&&(j.biff=2),U++)break;if(a=e.dense?[]:{},j.biff<8&&!oe&&(oe=!0,ws(j.codepage=e.codepage||1252)),j.biff<5||re.BIFFVer==0&&re.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ze={pos:t.l-Te,name:h};i[ze.pos]=ze,j.snames.push(h)}else h=(i[ye]||{name:""}).name;re.dt==32&&(a["!type"]="chart"),re.dt==64&&(a["!type"]="macro"),Ne=[],_e=[],j.arrayf=I=[],ne=[],se=[],Ee=!1,F={Hidden:(i[ye]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[re.r]||[])[re.c]:a[ct({c:re.c,r:re.r})])&&++re.c,N={ixfe:re.ixfe,XF:H[re.ixfe]||{},v:re.val,t:"n"},P>0&&(N.z=G[N.ixfe>>8&63]),Ls(N,e,r.opts.Date1904),O({c:re.c,r:re.r},N,e);break;case 5:case 517:N={ixfe:re.ixfe,XF:H[re.ixfe],v:re.val,t:re.t},P>0&&(N.z=G[N.ixfe>>8&63]),Ls(N,e,r.opts.Date1904),O({c:re.c,r:re.r},N,e);break;case 638:N={ixfe:re.ixfe,XF:H[re.ixfe],v:re.rknum,t:"n"},P>0&&(N.z=G[N.ixfe>>8&63]),Ls(N,e,r.opts.Date1904),O({c:re.c,r:re.r},N,e);break;case 189:for(var Ce=re.c;Ce<=re.C;++Ce){var je=re.rkrec[Ce-re.c][0];N={ixfe:je,XF:H[je],v:re.rkrec[Ce-re.c][1],t:"n"},P>0&&(N.z=G[N.ixfe>>8&63]),Ls(N,e,r.opts.Date1904),O({c:Ce,r:re.r},N,e)}break;case 6:case 518:case 1030:{if(re.val=="String"){u=re;break}if(N=Kd(re.val,re.cell.ixfe,re.tt),N.XF=H[N.ixfe],e.cellFormula){var tt=re.formula;if(tt&&tt[0]&&tt[0][0]&&tt[0][0][0]=="PtgExp"){var nt=tt[0][0][1][0],ht=tt[0][0][1][1],fr=ct({r:nt,c:ht});k[fr]?N.f=""+jn(re.formula,o,re.cell,ie,j):N.F=((e.dense?(a[nt]||[])[ht]:a[fr])||{}).F}else N.f=""+jn(re.formula,o,re.cell,ie,j)}P>0&&(N.z=G[N.ixfe>>8&63]),Ls(N,e,r.opts.Date1904),O(re.cell,N,e),u=re}break;case 7:case 519:if(u)u.val=re,N=Kd(re,u.cell.ixfe,"s"),N.XF=H[N.ixfe],e.cellFormula&&(N.f=""+jn(u.formula,o,u.cell,ie,j)),P>0&&(N.z=G[N.ixfe>>8&63]),Ls(N,e,r.opts.Date1904),O(u.cell,N,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{I.push(re);var da=ct(re[0].s);if(b=e.dense?(a[re[0].s.r]||[])[re[0].s.c]:a[da],e.cellFormula&&b){if(!u||!da||!b)break;b.f=""+jn(re[1],o,re[0],ie,j),b.F=bt(re[0])}}break;case 1212:{if(!e.cellFormula)break;if(y){if(!u)break;k[ct(u.cell)]=re[0],b=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[ct(u.cell)],(b||{}).f=""+jn(re[0],o,x,ie,j)}}break;case 253:N=Kd(f[re.isst].t,re.ixfe,"s"),f[re.isst].h&&(N.h=f[re.isst].h),N.XF=H[N.ixfe],P>0&&(N.z=G[N.ixfe>>8&63]),Ls(N,e,r.opts.Date1904),O({c:re.c,r:re.r},N,e);break;case 513:e.sheetStubs&&(N={ixfe:re.ixfe,XF:H[re.ixfe],t:"z"},P>0&&(N.z=G[N.ixfe>>8&63]),Ls(N,e,r.opts.Date1904),O({c:re.c,r:re.r},N,e));break;case 190:if(e.sheetStubs)for(var Hn=re.c;Hn<=re.C;++Hn){var Ht=re.ixfe[Hn-re.c];N={ixfe:Ht,XF:H[Ht],t:"z"},P>0&&(N.z=G[N.ixfe>>8&63]),Ls(N,e,r.opts.Date1904),O({c:Hn,r:re.r},N,e)}break;case 214:case 516:case 4:N=Kd(re.val,re.ixfe,"s"),N.XF=H[N.ixfe],P>0&&(N.z=G[N.ixfe>>8&63]),Ls(N,e,r.opts.Date1904),O({c:re.c,r:re.r},N,e);break;case 0:case 512:U===1&&(o=re);break;case 252:f=re;break;case 1054:if(j.biff==4){G[P++]=re[1];for(var en=0;en<P+163&&ot[en]!=re[1];++en);en>=163&&Ii(re[1],P+163)}else Ii(re[1],re[0]);break;case 30:{G[P++]=re;for(var kn=0;kn<P+163&&ot[kn]!=re;++kn);kn>=163&&Ii(re,P+163)}break;case 229:Ne=Ne.concat(re);break;case 93:_e[re.cmo[0]]=j.lastobj=re;break;case 438:j.lastobj.TxO=re;break;case 127:j.lastobj.ImData=re;break;case 440:for(E=re[0].s.r;E<=re[0].e.r;++E)for(T=re[0].s.c;T<=re[0].e.c;++T)b=e.dense?(a[E]||[])[T]:a[ct({c:T,r:E})],b&&(b.l=re[1]);break;case 2048:for(E=re[0].s.r;E<=re[0].e.r;++E)for(T=re[0].s.c;T<=re[0].e.c;++T)b=e.dense?(a[E]||[])[T]:a[ct({c:T,r:E})],b&&b.l&&(b.l.Tooltip=re[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;b=e.dense?(a[re[0].r]||[])[re[0].c]:a[ct(re[0])];var Jn=_e[re[2]];b||(e.dense?(a[re[0].r]||(a[re[0].r]=[]),b=a[re[0].r][re[0].c]={t:"z"}):b=a[ct(re[0])]={t:"z"},o.e.r=Math.max(o.e.r,re[0].r),o.s.r=Math.min(o.s.r,re[0].r),o.e.c=Math.max(o.e.c,re[0].c),o.s.c=Math.min(o.s.c,re[0].c)),b.c||(b.c=[]),w={a:re[1],t:Jn.TxO.t},b.c.push(w)}break;case 2173:CH(H[re.ixfe],re.ext);break;case 125:{if(!j.cellStyles)break;for(;re.e>=re.s;)ne[re.e--]={width:re.w/256,level:re.level||0,hidden:!!(re.flags&1)},Ee||(Ee=!0,Zy(re.w/256)),Ql(ne[re.e+1])}break;case 520:{var Yt={};re.level!=null&&(se[re.r]=Yt,Yt.level=re.level),re.hidden&&(se[re.r]=Yt,Yt.hidden=!0),re.hpt&&(se[re.r]=Yt,Yt.hpt=re.hpt,Yt.hpx=Au(re.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Wo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Fe]]=re;break;case 161:a["!margins"]||Wo(a["!margins"]={}),a["!margins"].header=re.header,a["!margins"].footer=re.footer;break;case 574:re.RTL&&(A.Views[0].RTL=!0);break;case 146:q=re;break;case 2198:L=re;break;case 140:z=re;break;case 442:h?F.CodeName=re||F.name:A.WBProps.CodeName=re||"ThisWorkbook";break}}else De||console.error("Missing Info for XLS Record 0x"+Fe.toString(16)),t.l+=Te}return r.SheetNames=jr(i).sort(function(on,dt){return Number(on)-Number(dt)}).map(function(on){return i[on].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&Y.forEach(function(on,dt){r.Sheets[r.SheetNames[dt]]["!autofilter"]=on}),r.Strings=f,r.SSF=_r(ot),j.enc&&(r.Encryption=j.enc),L&&(r.Themes=L),r.Metadata={},z!==void 0&&(r.Metadata.Country=z),ie.names.length>0&&(A.Names=ie.names),r.Workbook=A,r}var o0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function HY(t,e,r){var n=st.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=xS(n,rv,o0.DSI);for(var i in a)e[i]=a[i]}catch(h){if(r.WTF)throw h}var o=st.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var u=xS(o,nv,o0.SI);for(var f in u)e[f]==null&&(e[f]=u[f])}catch(h){if(r.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(tC(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function qY(t,e){var r=[],n=[],a=[],i=0,o,u=XT(rv,"n"),f=XT(nv,"n");if(t.Props)for(o=jr(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(u,o[i])?r:Object.prototype.hasOwnProperty.call(f,o[i])?n:a).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=jr(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(u,o[i])?r:Object.prototype.hasOwnProperty.call(f,o[i])?n:a).push([o[i],t.Custprops[o[i]]]);var h=[];for(i=0;i<a.length;++i)oC.indexOf(a[i][0])>-1||eC.indexOf(a[i][0])>-1||a[i][1]!=null&&h.push(a[i]);n.length&&st.utils.cfb_add(e,"/SummaryInformation",vS(n,o0.SI,f,nv)),(r.length||h.length)&&st.utils.cfb_add(e,"/DocumentSummaryInformation",vS(r,o0.DSI,u,rv,h.length?h:null,o0.UDI))}function n3(t,e){e||(e={}),o_(e),Cy(),e.codepage&&Ny(e.codepage);var r,n;if(t.FullPaths){if(st.find(t,"/encryption"))throw new Error("File is password-protected");r=st.find(t,"!CompObj"),n=st.find(t,"/Workbook")||st.find(t,"/Book")}else{switch(e.type){case"base64":t=ka(Ia(t));break;case"binary":t=ka(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}En(t,0),n={content:t}}var a,i;if(r&&BY(r),e.bookProps&&!e.bookSheets)a={};else{var o=St?"buffer":"array";if(n&&n.content)a=zY(n.content,e);else if((i=st.find(t,"PerfectOffice_MAIN"))&&i.content)a=Go.to_workbook(i.content,(e.type=o,e));else if((i=st.find(t,"NativeContent_MAIN"))&&i.content)a=Go.to_workbook(i.content,(e.type=o,e));else throw(i=st.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&st.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=nq(t))}var u={};return t.FullPaths&&HY(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}function GY(t,e){var r=e||{},n=st.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return st.utils.cfb_add(n,a,a3(t,r)),r.biff==8&&(t.Props||t.Custprops)&&qY(t,n),r.biff==8&&t.vbaraw&&aq(n,st.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var R0={0:{f:pW},1:{f:EW},2:{f:zW},3:{f:IW},4:{f:kW},5:{f:BW},6:{f:XW},7:{f:jW},8:{f:eX},9:{f:ZW},10:{f:QW},11:{f:JW},12:{f:SW},13:{f:qW},14:{f:OW},15:{f:CW},16:{f:$C},17:{f:$W},18:{f:MW},19:{f:Hy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:$X},40:{},42:{},43:{f:Xz},44:{f:Gz},45:{f:Kz},46:{f:Jz},47:{f:Qz},48:{},49:{f:vB},50:{},51:{f:DH},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:yC},62:{f:WW},63:{f:UH},64:{f:gX},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Un,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:hX},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:bW},148:{f:vW,p:16},151:{f:iX},152:{},153:{f:WX},154:{},155:{},156:{f:qX},157:{},158:{},159:{T:1,f:oz},160:{T:-1},161:{T:1,f:hc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:tX},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:RH},336:{T:-1},337:{f:jH,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:tv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:vC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:lX},427:{f:oX},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:uX},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:_W},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:aX},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:tv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:JH},633:{T:1},634:{T:-1},635:{T:1,f:KH},636:{T:-1},637:{f:wB},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:OX},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xX},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},cv={6:{f:ux},10:{f:Tl},12:{f:Qr},13:{f:Qr},14:{f:Br},15:{f:Br},16:{f:Ln},17:{f:Br},18:{f:Br},19:{f:Qr},20:{f:TS},21:{f:TS},23:{f:vC},24:{f:AS},25:{f:Br},26:{},27:{},28:{f:xU},29:{},34:{f:Br},35:{f:SS},38:{f:Ln},39:{f:Ln},40:{f:Ln},41:{f:Ln},42:{f:Br},43:{f:Br},47:{f:Cz},49:{f:qV},51:{f:Qr},60:{},61:{f:BV},64:{f:Br},65:{f:HV},66:{f:Qr},77:{},80:{},81:{},82:{},85:{f:Qr},89:{},90:{},91:{},92:{f:NV},93:{f:_U},94:{},95:{f:Br},96:{},97:{},99:{f:Br},125:{f:yC},128:{f:sU},129:{f:RV},130:{f:Qr},131:{f:Br},132:{f:Br},133:{f:IV},134:{},140:{f:NU},141:{f:Qr},144:{},146:{f:IU},151:{},152:{},153:{},154:{},155:{},156:{f:Qr},157:{},158:{},160:{f:LU},161:{f:FU},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:tU},190:{f:rU},193:{f:Tl},197:{},198:{},199:{},200:{},201:{},202:{f:Br},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Qr},220:{},221:{f:Br},222:{},224:{f:aU},225:{f:kV},226:{f:Tl},227:{},229:{f:vU},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:OV},253:{f:WV},255:{f:jV},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:cC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Br},353:{f:Tl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:uU},431:{f:Br},432:{},433:{},434:{},437:{},438:{f:EU},439:{f:Br},440:{f:TU},441:{},442:{f:sh},443:{},444:{f:Qr},445:{},446:{},448:{f:Tl},449:{f:LV,r:2},450:{f:Tl},512:{f:bS},513:{f:MU},515:{f:oU},516:{f:YV},517:{f:ES},519:{f:BU},520:{f:PV},523:{},545:{f:kS},549:{f:_S},566:{},574:{f:UV},638:{f:eU},659:{},1048:{},1054:{f:KV},1084:{},1212:{f:mU},2048:{f:AU},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Xd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Tl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:DU,r:12},2173:{f:NH,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Br,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:dU,r:12},2197:{},2198:{f:wH,r:12},2199:{},2200:{},2201:{},2202:{f:pU,r:12},2203:{f:Tl},2204:{},2205:{},2206:{},2207:{},2211:{f:MV},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Qr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:jU},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:RU},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:bS},1:{},2:{f:qU},3:{f:zU},4:{f:UU},5:{f:ES},7:{f:WU},8:{},9:{f:Xd},11:{},22:{f:Qr},30:{f:JV},31:{},32:{},33:{f:kS},36:{},37:{f:_S},50:{f:XU},62:{},52:{},67:{},68:{f:Qr},69:{},86:{},126:{},127:{f:VU},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:YU},223:{},234:{},354:{},421:{},518:{f:ux},521:{f:Xd},536:{f:AS},547:{f:SS},561:{},579:{},1030:{f:ux},1033:{f:Xd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function qe(t,e,r,n){var a=e;if(!isNaN(a)){var i=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&Vy(r)&&t.push(r)}}function WY(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return qe(t,e,r,a);var i=e;if(!isNaN(i)){for(var o=r.parts||[],u=0,f=0,h=0;h+(o[u]||8224)<=8224;)h+=o[u]||8224,u++;var p=t.next(4);for(p.write_shift(2,i),p.write_shift(2,h),t.push(r.slice(f,f+h)),f+=h;f<a;){for(p=t.next(4),p.write_shift(2,60),h=0;h+(o[u]||8224)<=8224;)h+=o[u]||8224,u++;p.write_shift(2,h),t.push(r.slice(f,f+h)),f+=h}}}function ch(t,e,r){return t||(t=Se(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function XY(t,e,r,n){var a=Se(9);return ch(a,t,e),uC(r,n||"b",a),a}function YY(t,e,r){var n=Se(8+2*r.length);return ch(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function $Y(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?ln(yr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?qe(t,2,GU(r,n,a)):qe(t,3,HU(r,n,a));return;case"b":case"e":qe(t,5,XY(r,n,e.v,e.t));return;case"s":case"str":qe(t,4,YY(r,n,(e.v||"").slice(0,255)));return}qe(t,1,ch(null,r,n))}function KY(t,e,r,n){var a=Array.isArray(e),i=Bt(e["!ref"]||"A1"),o,u="",f=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=bt(i)}for(var h=i.s.r;h<=i.e.r;++h){u=Ur(h);for(var p=i.s.c;p<=i.e.c;++p){h===i.s.r&&(f[p]=Ar(p)),o=f[p]+u;var x=a?(e[h]||[])[p]:e[o];x&&$Y(t,x,h,p)}}}function QY(t,e){for(var r=e||{},n=fa(),a=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return qe(n,r.biff==4?1033:r.biff==3?521:9,Ky(t,16,r)),KY(n,t.Sheets[t.SheetNames[a]],a,r),qe(n,10),n.end()}function JY(t,e,r){qe(t,49,GV({sz:12,name:"Arial"},r))}function ZY(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&qe(t,1054,QV(a,e[a],r))})}function e$(t,e){var r=Se(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),qe(t,2151,r),r=Se(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),pC(Bt(e["!ref"]||"A1"),r),r.write_shift(4,4),qe(t,2152,r)}function t$(t,e){for(var r=0;r<16;++r)qe(t,224,wS({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){qe(t,224,wS(n,0,e))})}function r$(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];qe(t,440,SU(n)),n[1].Tooltip&&qe(t,2048,kU(n))}delete e["!links"]}function n$(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&qe(t,125,OU(Mp(a,n),a))})}}function a$(t,e,r,n,a){var i=16+lo(a.cellXfs,e,a);if(e.v==null&&!e.bf){qe(t,513,rc(r,n,i));return}if(e.bf)qe(t,6,RG(e,r,n,a,i));else switch(e.t){case"d":case"n":var o=e.t=="d"?ln(yr(e.v)):e.v;qe(t,515,cU(r,n,o,i));break;case"b":case"e":qe(t,517,lU(r,n,e.v,i,a,e.t));break;case"s":case"str":if(a.bookSST){var u=a_(a.Strings,e.v,a.revStrings);qe(t,253,XV(r,n,u,i))}else qe(t,516,$V(r,n,(e.v||"").slice(0,255),i,a));break;default:qe(t,513,rc(r,n,i))}}function s$(t,e,r){var n=fa(),a=r.SheetNames[t],i=r.Sheets[a]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[t]||{},f=Array.isArray(i),h=e.biff==8,p,x="",y=[],b=Bt(i["!ref"]||"A1"),w=h?65536:16384;if(b.e.c>255||b.e.r>=w){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");b.e.c=Math.min(b.e.c,255),b.e.r=Math.min(b.e.c,w-1)}qe(n,2057,Ky(r,16,e)),qe(n,13,Ka(1)),qe(n,12,Ka(100)),qe(n,15,Yn(!0)),qe(n,17,Yn(!1)),qe(n,16,ec(.001)),qe(n,95,Yn(!0)),qe(n,42,Yn(!1)),qe(n,43,Yn(!1)),qe(n,130,Ka(1)),qe(n,128,iU()),qe(n,131,Yn(!1)),qe(n,132,Yn(!1)),h&&n$(n,i["!cols"]),qe(n,512,ZV(b,e)),h&&(i["!links"]=[]);for(var T=b.s.r;T<=b.e.r;++T){x=Ur(T);for(var E=b.s.c;E<=b.e.c;++E){T===b.s.r&&(y[E]=Ar(E)),p=y[E]+x;var k=f?(i[T]||[])[E]:i[p];k&&(a$(n,k,T,E,e),h&&k.l&&i["!links"].push([p,k.l]))}}var I=u.CodeName||u.name||a;return h&&qe(n,574,zV((o.Views||[])[0])),h&&(i["!merges"]||[]).length&&qe(n,229,yU(i["!merges"])),h&&r$(n,i),qe(n,442,fC(I)),h&&e$(n,i),qe(n,10),n.end()}function i$(t,e,r){var n=fa(),a=(t||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},u=r.biff==8,f=r.biff==5;if(qe(n,2057,Ky(t,5,r)),r.bookType=="xla"&&qe(n,135),qe(n,225,u?Ka(1200):null),qe(n,193,lV(2)),f&&qe(n,191),f&&qe(n,192),qe(n,226),qe(n,92,CV("SheetJS",r)),qe(n,66,Ka(u?1200:1252)),u&&qe(n,353,Ka(0)),u&&qe(n,448),qe(n,317,PU(t.SheetNames.length)),u&&t.vbaraw&&qe(n,211),u&&t.vbaraw){var h=o.CodeName||"ThisWorkbook";qe(n,442,fC(h))}qe(n,156,Ka(17)),qe(n,25,Yn(!1)),qe(n,18,Yn(!1)),qe(n,19,Ka(0)),u&&qe(n,431,Yn(!1)),u&&qe(n,444,Ka(0)),qe(n,61,VV()),qe(n,64,Yn(!1)),qe(n,141,Ka(0)),qe(n,34,Yn(LX(t)=="true")),qe(n,14,Yn(!0)),u&&qe(n,439,Yn(!1)),qe(n,218,Ka(0)),JY(n,t,r),ZY(n,t.SSF,r),t$(n,r),u&&qe(n,352,Yn(!1));var p=n.end(),x=fa();u&&qe(x,140,CU()),u&&r.Strings&&WY(x,252,FV(r.Strings)),qe(x,10);var y=x.end(),b=fa(),w=0,T=0;for(T=0;T<t.SheetNames.length;++T)w+=(u?12:11)+(u?2:1)*t.SheetNames[T].length;var E=p.length+w+y.length;for(T=0;T<t.SheetNames.length;++T){var k=i[T]||{};qe(b,133,DV({pos:E,hs:k.Hidden||0,dt:0,name:t.SheetNames[T]},r)),E+=e[T].length}var I=b.end();if(w!=I.length)throw new Error("BS8 "+w+" != "+I.length);var N=[];return p.length&&N.push(p),I.length&&N.push(I),y.length&&N.push(y),mn(N)}function l$(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=_r(ot)),t&&t.SSF&&(Lu(),Rp(t.SSF),r.revssf=Dp(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,c_(r),r.cellXfs=[],lo(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=s$(a,r,t);return n.unshift(i$(t,n,r)),mn(n)}function a3(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=ha(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return l$(t,e);case 4:case 3:case 2:return QY(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function MS(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),o=a.index,u=i&&i.index||t.length,f=G7(t.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,x=0,y=0,b={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<f.length;++o){var T=f[o].trim(),E=T.slice(0,3).toLowerCase();if(E=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}p=0;continue}if(!(E!="<td"&&E!="<th")){var k=T.split(/<\/t[dh]>/i);for(u=0;u<k.length;++u){var I=k[u].trim();if(I.match(/<t[dh]/i)){for(var N=I,z=0;N.charAt(0)=="<"&&(z=N.indexOf(">"))>-1;)N=N.slice(z+1);for(var H=0;H<w.length;++H){var q=w[H];q.s.c==p&&q.s.r<h&&h<=q.e.r&&(p=q.e.c+1,H=-1)}var A=mt(I.slice(0,I.indexOf(">")));y=A.colspan?+A.colspan:1,((x=+A.rowspan)>1||y>1)&&w.push({s:{r:h,c:p},e:{r:h+(x||1)-1,c:p+y-1}});var F=A.t||A["data-t"]||"";if(!N.length){p+=y;continue}if(N=NN(N),b.s.r>h&&(b.s.r=h),b.e.r<h&&(b.e.r=h),b.s.c>p&&(b.s.c=p),b.e.c<p&&(b.e.c=p),!N.length){p+=y;continue}var R={t:"s",v:N};r.raw||!N.trim().length||F=="s"||(N==="TRUE"?R={t:"b",v:!0}:N==="FALSE"?R={t:"b",v:!1}:isNaN(Ts(N))?isNaN(Tu(N).getDate())||(R={t:"d",v:yr(N)},r.cellDates||(R={t:"n",v:ln(R.v)}),R.z=r.dateNF||ot[14]):R={t:"n",v:Ts(N)}),r.dense?(n[h]||(n[h]=[]),n[h][p]=R):n[ct({r:h,c:p})]=R,p+=y}}}}return n["!ref"]=bt(b),w.length&&(n["!merges"]=w),n}function o$(t,e,r,n){for(var a=t["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var u=0,f=0,h=0;h<a.length;++h)if(!(a[h].s.r>r||a[h].s.c>o)&&!(a[h].e.r<r||a[h].e.c<o)){if(a[h].s.r<r||a[h].s.c<o){u=-1;break}u=a[h].e.r-a[h].s.r+1,f=a[h].e.c-a[h].s.c+1;break}if(!(u<0)){var p=ct({r,c:o}),x=n.dense?(t[r]||[])[o]:t[p],y=x&&x.v!=null&&(x.h||My(x.w||(Bi(x),x.w)||""))||"",b={};u>1&&(b.rowspan=u),f>1&&(b.colspan=f),n.editable?y='<span contenteditable="true">'+y+"</span>":x&&(b["data-t"]=x&&x.t||"z",x.v!=null&&(b["data-v"]=x.v),x.z!=null&&(b["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+x.l.Target+'">'+y+"</a>")),b.id=(n.id||"sjs")+"-"+p,i.push(He("td",y,b))}}var w="<tr>";return w+i.join("")+"</tr>"}var c$='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',u$="</body></html>";function f$(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return io(MS(r[0],e),e);var n=h_();return r.forEach(function(a,i){d_(n,MS(a,e),"Sheet"+(i+1))}),n}function h$(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function s3(t,e){var r=e||{},n=r.header!=null?r.header:c$,a=r.footer!=null?r.footer:u$,i=[n],o=ha(t["!ref"]);r.dense=Array.isArray(t),i.push(h$(t,o,r));for(var u=o.s.r;u<=o.e.r;++u)i.push(o$(t,o,u,r));return i.push("</table>"+a),i.join("")}function i3(t,e,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?kr(n.origin):n.origin;a=o.r,i=o.c}var u=e.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var p=ha(t["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),a==-1&&(h.e.r=a=p.e.r+1)}var x=[],y=0,b=t["!rows"]||(t["!rows"]=[]),w=0,T=0,E=0,k=0,I=0,N=0;for(t["!cols"]||(t["!cols"]=[]);w<u.length&&T<f;++w){var z=u[w];if(LS(z)){if(n.display)continue;b[T]={hidden:!0}}var H=z.children;for(E=k=0;E<H.length;++E){var q=H[E];if(!(n.display&&LS(q))){var A=q.hasAttribute("data-v")?q.getAttribute("data-v"):q.hasAttribute("v")?q.getAttribute("v"):NN(q.innerHTML),F=q.getAttribute("data-z")||q.getAttribute("z");for(y=0;y<x.length;++y){var R=x[y];R.s.c==k+i&&R.s.r<T+a&&T+a<=R.e.r&&(k=R.e.c+1-i,y=-1)}N=+q.getAttribute("colspan")||1,((I=+q.getAttribute("rowspan")||1)>1||N>1)&&x.push({s:{r:T+a,c:k+i},e:{r:T+a+(I||1)-1,c:k+i+(N||1)-1}});var M={t:"s",v:A},O=q.getAttribute("data-t")||q.getAttribute("t")||"";A!=null&&(A.length==0?M.t=O||"z":n.raw||A.trim().length==0||O=="s"||(A==="TRUE"?M={t:"b",v:!0}:A==="FALSE"?M={t:"b",v:!1}:isNaN(Ts(A))?isNaN(Tu(A).getDate())||(M={t:"d",v:yr(A)},n.cellDates||(M={t:"n",v:ln(M.v)}),M.z=n.dateNF||ot[14]):M={t:"n",v:Ts(A)})),M.z===void 0&&F!=null&&(M.z=F);var j="",L=q.getElementsByTagName("A");if(L&&L.length)for(var Ne=0;Ne<L.length&&!(L[Ne].hasAttribute("href")&&(j=L[Ne].getAttribute("href"),j.charAt(0)!="#"));++Ne);j&&j.charAt(0)!="#"&&(M.l={Target:j}),n.dense?(t[T+a]||(t[T+a]=[]),t[T+a][k+i]=M):t[ct({c:k+i,r:T+a})]=M,h.e.c<k+i&&(h.e.c=k+i),k+=N}}++T}return x.length&&(t["!merges"]=(t["!merges"]||[]).concat(x)),h.e.r=Math.max(h.e.r,T-1+a),t["!ref"]=bt(h),T>=f&&(t["!fullref"]=bt((h.e.r=u.length-w+T-1+a,h))),t}function l3(t,e){var r=e||{},n=r.dense?[]:{};return i3(n,t,e)}function d$(t,e){return io(l3(t,e),e)}function LS(t){var e="",r=m$(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function m$(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function p$(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Lt(e.replace(/<[^>]*>/g,""));return[r]}var BS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function o3(t,e){var r=e||{},n=Ly(t),a=[],i,o,u={name:""},f="",h=0,p,x,y={},b=[],w=r.dense?[]:{},T,E,k={value:""},I="",N=0,z=[],H=-1,q=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,R={},M=[],O={},j=0,L=0,Ne=[],_e=1,ne=1,se=[],Ee={Names:[]},ie={},Ve=["",""],U=[],P={},G="",Y=0,Z=!1,oe=!1,ye=0;for(T0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");T=T0.exec(n);)switch(T[3]=T[3].replace(/_.*$/,"")){case"table":case"":T[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?w["!ref"]=bt(A):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(w["!fullref"]=w["!ref"],A.e.r=r.sheetRows-1,w["!ref"]=bt(A)),M.length&&(w["!merges"]=M),Ne.length&&(w["!rows"]=Ne),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),b.push(p.name),y[p.name]=w,oe=!1):T[0].charAt(T[0].length-2)!=="/"&&(p=mt(T[0],!1),H=q=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,w=r.dense?[]:{},M=[],Ne=[],oe=!0);break;case"table-row-group":T[1]==="/"?--F:++F;break;case"table-row":case"":if(T[1]==="/"){H+=_e,_e=1;break}if(x=mt(T[0],!1),x.?H=x.-1:H==-1&&(H=0),_e=+x["number-rows-repeated"]||1,_e<10)for(ye=0;ye<_e;++ye)F>0&&(Ne[H+ye]={level:F});q=-1;break;case"covered-table-cell":T[1]!=="/"&&++q,r.sheetStubs&&(r.dense?(w[H]||(w[H]=[]),w[H][q]={t:"z"}):w[ct({r:H,c:q})]={t:"z"}),I="",z=[];break;case"table-cell":case"":if(T[0].charAt(T[0].length-2)==="/")++q,k=mt(T[0],!1),ne=parseInt(k["number-columns-repeated"]||"1",10),E={t:"z",v:null},k.formula&&r.cellFormula!=!1&&(E.f=FS(Lt(k.formula))),(k.||k["value-type"])=="string"&&(E.t="s",E.v=Lt(k["string-value"]||""),r.dense?(w[H]||(w[H]=[]),w[H][q]=E):w[ct({r:H,c:q})]=E),q+=ne-1;else if(T[1]!=="/"){++q,I="",N=0,z=[],ne=1;var Fe=_e?H+_e-1:H;if(q>A.e.c&&(A.e.c=q),q<A.s.c&&(A.s.c=q),H<A.s.r&&(A.s.r=H),Fe>A.e.r&&(A.e.r=Fe),k=mt(T[0],!1),U=[],P={},E={t:k.||k["value-type"],v:null},r.cellFormula)if(k.formula&&(k.formula=Lt(k.formula)),k["number-matrix-columns-spanned"]&&k["number-matrix-rows-spanned"]&&(j=parseInt(k["number-matrix-rows-spanned"],10)||0,L=parseInt(k["number-matrix-columns-spanned"],10)||0,O={s:{r:H,c:q},e:{r:H+j-1,c:q+L-1}},E.F=bt(O),se.push([O,E.F])),k.formula)E.f=FS(k.formula);else for(ye=0;ye<se.length;++ye)H>=se[ye][0].s.r&&H<=se[ye][0].e.r&&q>=se[ye][0].s.c&&q<=se[ye][0].e.c&&(E.F=se[ye][1]);switch((k["number-columns-spanned"]||k["number-rows-spanned"])&&(j=parseInt(k["number-rows-spanned"],10)||0,L=parseInt(k["number-columns-spanned"],10)||0,O={s:{r:H,c:q},e:{r:H+j-1,c:q+L-1}},M.push(O)),k["number-columns-repeated"]&&(ne=parseInt(k["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=xr(k["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(k.value);break;case"percentage":E.t="n",E.v=parseFloat(k.value);break;case"currency":E.t="n",E.v=parseFloat(k.value);break;case"date":E.t="d",E.v=yr(k["date-value"]),r.cellDates||(E.t="n",E.v=ln(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=z7(k["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Op(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(k.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",k["string-value"]!=null&&(I=Lt(k["string-value"]),z=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(Z=!1,E.t==="s"&&(E.v=I||"",z.length&&(E.R=z),Z=N==0),ie.Target&&(E.l=ie),U.length>0&&(E.c=U,U=[]),I&&r.cellText!==!1&&(E.w=I),Z&&(E.t="z",delete E.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=H))for(var Te=0;Te<_e;++Te){if(ne=parseInt(k["number-columns-repeated"]||"1",10),r.dense)for(w[H+Te]||(w[H+Te]=[]),w[H+Te][q]=Te==0?E:_r(E);--ne>0;)w[H+Te][q+ne]=_r(E);else for(w[ct({r:H+Te,c:q})]=E;--ne>0;)w[ct({r:H+Te,c:q+ne})]=_r(E);A.e.c<=q&&(A.e.c=q)}ne=parseInt(k["number-columns-repeated"]||"1",10),q+=ne-1,ne=0,E={},I="",z=[]}ie={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(T[1]==="/"){if((i=a.pop())[0]!==T[3])throw"Bad state: "+i}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!0]);break;case"annotation":if(T[1]==="/"){if((i=a.pop())[0]!==T[3])throw"Bad state: "+i;P.t=I,z.length&&(P.R=z),P.a=G,U.push(P)}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!1]);G="",Y=0,I="",N=0,z=[];break;case"creator":T[1]==="/"?G=n.slice(Y,T.index):Y=T.index+T[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(T[1]==="/"){if((i=a.pop())[0]!==T[3])throw"Bad state: "+i}else T[0].charAt(T[0].length-2)!=="/"&&a.push([T[3],!1]);I="",N=0,z=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(T[1]==="/"){if(R[u.name]=f,(i=a.pop())[0]!==T[3])throw"Bad state: "+i}else T[0].charAt(T[0].length-2)!=="/"&&(f="",u=mt(T[0],!1),a.push([T[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=mt(T[0],!1),f+=BS[T[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=mt(T[0],!1),f+=BS[T[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(T[0].slice(-2)==="/>")break;if(T[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(h,T.index);break}else h=T.index+T[0].length;break;case"named-range":o=mt(T[0],!1),Ve=fx(o["cell-range-address"]);var De={Name:o.name,Ref:Ve[0]+"!"+Ve[1]};oe&&(De.Sheet=b.length),Ee.Names.push(De);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(T[1]==="/"&&(!k||!k["string-value"])){var rt=p$(n.slice(N,T.index));I=(I.length>0?I+`
`:"")+rt[0]}else mt(T[0],!1),N=T.index+T[0].length;break;case"s":break;case"database-range":if(T[1]==="/")break;try{Ve=fx(mt(T[0])["target-range-address"]),y[Ve[0]]["!autofilter"]={ref:Ve[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(T[1]!=="/"){if(ie=mt(T[0],!1),!ie.href)break;ie.Target=Lt(ie.href),delete ie.href,ie.Target.charAt(0)=="#"&&ie.Target.indexOf(".")>-1?(Ve=fx(ie.Target.slice(1)),ie.Target="#"+Ve[0]+"!"+Ve[1]):ie.Target.match(/^\.\.[\\\/]/)&&(ie.Target=ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(T[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(T)}}var re={Sheets:y,SheetNames:b,Workbook:Ee};return r.bookSheets&&delete re.Sheets,re}function VS(t,e){e=e||{},$a(t,"META-INF/manifest.xml")&&zB(Kr(t,"META-INF/manifest.xml"),e);var r=Na(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=o3(lr(r),e);return $a(t,"meta.xml")&&(n.Props=JN(Kr(t,"meta.xml"))),n}function US(t,e){return o3(t,e)}var g$=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+E0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return zr+e}})(),zS=(function(){var t=function(i){return rr(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,u){var f=[];f.push('      <table:table table:name="'+rr(o.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,p=0,x=ha(i["!ref"]||"A1"),y=i["!merges"]||[],b=0,w=Array.isArray(i);if(i["!cols"])for(p=0;p<=x.e.c;++p)f.push("        <table:table-column"+(i["!cols"][p]?' table:style-name="co'+i["!cols"][p].ods+'"':"")+`></table:table-column>
`);var T="",E=i["!rows"]||[];for(h=0;h<x.s.r;++h)T=E[h]?' table:style-name="ro'+E[h].ods+'"':"",f.push("        <table:table-row"+T+`></table:table-row>
`);for(;h<=x.e.r;++h){for(T=E[h]?' table:style-name="ro'+E[h].ods+'"':"",f.push("        <table:table-row"+T+`>
`),p=0;p<x.s.c;++p)f.push(e);for(;p<=x.e.c;++p){var k=!1,I={},N="";for(b=0;b!=y.length;++b)if(!(y[b].s.c>p)&&!(y[b].s.r>h)&&!(y[b].e.c<p)&&!(y[b].e.r<h)){(y[b].s.c!=p||y[b].s.r!=h)&&(k=!0),I["table:number-columns-spanned"]=y[b].e.c-y[b].s.c+1,I["table:number-rows-spanned"]=y[b].e.r-y[b].s.r+1;break}if(k){f.push(r);continue}var z=ct({r:h,c:p}),H=w?(i[h]||[])[p]:i[z];if(H&&H.f&&(I["table:formula"]=rr(PG(H.f)),H.F&&H.F.slice(0,z.length)==z)){var q=ha(H.F);I["table:number-matrix-columns-spanned"]=q.e.c-q.s.c+1,I["table:number-matrix-rows-spanned"]=q.e.r-q.s.r+1}if(!H){f.push(e);continue}switch(H.t){case"b":N=H.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=H.v?"true":"false";break;case"n":N=H.w||String(H.v||0),I["office:value-type"]="float",I["office:value"]=H.v||0;break;case"s":case"str":N=H.v==null?"":H.v,I["office:value-type"]="string";break;case"d":N=H.w||yr(H.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=yr(H.v).toISOString(),I["table:style-name"]="ce1";break;default:f.push(e);continue}var A=t(N);if(H.l&&H.l.Target){var F=H.l.Target;F=F.charAt(0)=="#"?"#"+MG(F.slice(1)):F,F.charAt(0)!="#"&&!F.match(/^\w+:/)&&(F="../"+F),A=He("text:a",A,{"xlink:href":F.replace(/&/g,"&amp;")})}f.push("          "+He("table:table-cell",He("text:p",A,{}),I)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var p=0;p<h["!cols"].length;++p)if(h["!cols"][p]){var x=h["!cols"][p];if(x.width==null&&x.wpx==null&&x.wch==null)continue;Ql(x),x.ods=u;var y=h["!cols"][p].wpx+"px";i.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),i.push(`  </style:style>
`),++u}}});var f=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var p=0;p<h["!rows"].length;++p)if(h["!rows"][p]){h["!rows"][p].ods=f;var x=h["!rows"][p].hpx+"px";i.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),i.push(`  </style:style>
`),++f}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,u){var f=[zr],h=E0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=E0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+h+p+`>
`),f.push(QN().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+h+`>
`),a(f,o),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)f.push(n(o.Sheets[o.SheetNames[x]],o,x));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function c3(t,e){if(e.bookType=="fods")return zS(t,e);var r=Fy(),n="",a=[],i=[];return n="mimetype",Et(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Et(r,n,zS(t,e)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Et(r,n,g$(t,e)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Et(r,n,zr+QN()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Et(r,n,GB(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Et(r,n,HB(a)),r}function nc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function uv(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):lr(so(t))}function x$(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):ka(zs(t))}function v$(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Zl(t){var e=t.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function HS(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function y$(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function _$(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)t[e+i]=a&255;t[e+15]|=r>=0?0:128}function I0(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function er(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Fr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function zt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=I0(t,r),i=a&7;a=Math.floor(a/8);var o=0,u;if(a==0)break;switch(i){case 0:{for(var f=r[0];t[r[0]++]>=128;);u=t.slice(f,r[0])}break;case 5:o=4,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=I0(t,r),u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var h={data:u,type:i};e[a]==null?e[a]=[h]:e[a].push(h)}return e}function bn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(er(n*8+a.type)),a.type==2&&e.push(er(a.data.length)),e.push(a.data))})}),Zl(e)}function l_(t,e){return t?.map(function(r){return e(r.data)})||[]}function Xa(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=I0(t,n),i=zt(t.slice(n[0],n[0]+a));n[0]+=a;var o={id:Fr(i[1][0].data),messages:[]};i[2].forEach(function(u){var f=zt(u.data),h=Fr(f[3][0].data);o.messages.push({meta:f,data:t.slice(n[0],n[0]+h)}),n[0]+=h}),(e=i[3])!=null&&e[0]&&(o.merge=Fr(i[3][0].data)>>>0>0),r.push(o)}return r}function Zc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:er(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:er(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:er(o.data.length)}],n[2].push({data:bn(o.meta),type:2})});var i=bn(n);e.push(er(i.length)),e.push(i),a.forEach(function(o){return e.push(o)})}),Zl(e)}function b$(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=I0(e,r),a=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=e[r[0]],u>1&&(o|=e[r[0]+1]<<8),u>2&&(o|=e[r[0]+2]<<16),u>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}a.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var f=0,h=0;if(i==1?(h=(e[r[0]]>>2&7)+4,f=(e[r[0]++]&224)<<3,f|=e[r[0]++]):(h=(e[r[0]++]>>2)+1,i==2?(f=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(f=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Zl(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(h>=f)for(a.push(a[0].slice(-f)),h-=f;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-f,-f+h))}}var p=Zl(a);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function Ya(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(b$(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Zl(e)}function eu(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var i=er(n),o=i.length;e.push(i),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Zl(e)}function w$(t,e,r,n){var a=nc(t),i=a.getUint32(4,!0),o=(n>1?12:8)+HS(i&(n>1?3470:398))*4,u=-1,f=-1,h=NaN,p=new Date(2001,0,1);i&512&&(u=a.getUint32(o,!0),o+=4),o+=HS(i&(n>1?12288:4096))*4,i&16&&(f=a.getUint32(o,!0),o+=4),i&32&&(h=a.getFloat64(o,!0),o+=8),i&64&&(p.setTime(p.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var x;switch(t[2]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:e[f]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(f>-1)x={t:"s",v:e[f]};else if(!isNaN(h))x={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return x}function E$(t,e,r){var n=nc(t),a=n.getUint32(8,!0),i=12,o=-1,u=-1,f=NaN,h=NaN,p=new Date(2001,0,1);a&1&&(f=y$(t,i),i+=16),a&2&&(h=n.getFloat64(i,!0),i+=8),a&4&&(p.setTime(p.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(u=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var x;switch(t[1]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:e[u]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(o>-1)x={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:x={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return x}function dx(t,e){var r=new Uint8Array(32),n=nc(r),a=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,_$(r,a,t.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),i|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,a)}function mx(t,e){var r=new Uint8Array(32),n=nc(r),a=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),i|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,a)}function T$(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return w$(t,e,r,t[0]);case 5:return E$(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Fn(t){var e=zt(t);return I0(e[1][0].data)}function qS(t,e){var r=zt(e.data),n=Fr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var u=zt(o.data),f=Fr(u[1][0].data)>>>0;switch(n){case 1:i[f]=uv(u[3][0].data);break;case 8:{var h=t[Fn(u[9][0].data)][0],p=zt(h.data),x=t[Fn(p[1][0].data)][0],y=Fr(x.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var b=zt(x.data);i[f]=b[3].map(function(w){return uv(w.data)}).join("")}break}}),i}function S$(t,e){var r,n,a,i,o,u,f,h,p,x,y,b,w,T,E=zt(t),k=Fr(E[1][0].data)>>>0,I=Fr(E[2][0].data)>>>0,N=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Fr(E[8][0].data)>0||!1,z,H;if((i=(a=E[7])==null?void 0:a[0])!=null&&i.data&&e!=0)z=(u=(o=E[7])==null?void 0:o[0])==null?void 0:u.data,H=(h=(f=E[6])==null?void 0:f[0])==null?void 0:h.data;else if((x=(p=E[4])==null?void 0:p[0])!=null&&x.data&&e!=1)z=(b=(y=E[4])==null?void 0:y[0])==null?void 0:b.data,H=(T=(w=E[3])==null?void 0:w[0])==null?void 0:T.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var q=N?4:1,A=nc(z),F=[],R=0;R<z.length/2;++R){var M=A.getUint16(R*2,!0);M<65535&&F.push([R,M])}if(F.length!=I)throw"Expected ".concat(I," cells, found ").concat(F.length);var O=[];for(R=0;R<F.length-1;++R)O[F[R][0]]=H.subarray(F[R][1]*q,F[R+1][1]*q);return F.length>=1&&(O[F[F.length-1][0]]=H.subarray(F[F.length-1][1]*q)),{R:k,cells:O}}function A$(t,e){var r,n=zt(e.data),a=(r=n?.[7])!=null&&r[0]?Fr(n[7][0].data)>>>0>0?1:0:-1,i=l_(n[5],function(o){return S$(o,a)});return{nrows:Fr(n[4][0].data)>>>0,data:i.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(f,h){if(o[u.R][h])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(h));o[u.R][h]=f}),o},[])}}function k$(t,e,r){var n,a=zt(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Fr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Fr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=bt(i);var o=zt(a[4][0].data),u=qS(t,t[Fn(o[4][0].data)][0]),f=(n=o[17])!=null&&n[0]?qS(t,t[Fn(o[17][0].data)][0]):[],h=zt(o[3][0].data),p=0;h[1].forEach(function(x){var y=zt(x.data),b=t[Fn(y[2][0].data)][0],w=Fr(b.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var T=A$(t,b);T.data.forEach(function(E,k){E.forEach(function(I,N){var z=ct({r:p+k,c:N}),H=T$(I,u,f);H&&(r[z]=H)})}),p+=T.nrows})}function N$(t,e){var r=zt(e.data),n={"!ref":"A1"},a=t[Fn(r[2][0].data)],i=Fr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return k$(t,a[0],n),n}function C$(t,e){var r,n=zt(e.data),a={name:(r=n[1])!=null&&r[0]?uv(n[1][0].data):"",sheets:[]},i=l_(n[2],Fn);return i.forEach(function(o){t[o].forEach(function(u){var f=Fr(u.meta[1][0].data);f==6e3&&a.sheets.push(N$(t,u))})}),a}function R$(t,e){var r=h_(),n=zt(e.data),a=l_(n[1],Fn);if(a.forEach(function(i){t[i].forEach(function(o){var u=Fr(o.meta[1][0].data);if(u==2){var f=C$(t,o);f.sheets.forEach(function(h,p){d_(r,h,p==0?f.name:f.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function px(t){var e,r,n,a,i={},o=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var h;try{h=Ya(f.content)}catch(x){return console.log("?? "+f.content.length+" "+(x.message||x))}var p;try{p=Xa(h)}catch(x){return console.log("## "+(x.message||x))}p.forEach(function(x){i[x.id]=x.messages,o.push(x.id)})}}),!o.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=i?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Fr(i[1][0].meta[1][0].data)==1&&i[1][0];if(u||o.forEach(function(f){i[f].forEach(function(h){var p=Fr(h.meta[1][0].data)>>>0;if(p==1)if(!u)u=h;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return R$(i,u)}function I$(t,e,r){var n,a,i,o;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&Fr(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,h=nc(t[7][0].data),p=0,x=[],y=nc(t[4][0].data),b=0,w=[],T=0;T<e.length;++T){if(e[T]==null){h.setUint16(T*2,65535,!0),y.setUint16(T*2,65535);continue}h.setUint16(T*2,p,!0),y.setUint16(T*2,b,!0);var E,k;switch(typeof e[T]){case"string":E=dx({t:"s",v:e[T]},r),k=mx({t:"s",v:e[T]},r);break;case"number":E=dx({t:"n",v:e[T]},r),k=mx({t:"n",v:e[T]},r);break;case"boolean":E=dx({t:"b",v:e[T]},r),k=mx({t:"b",v:e[T]},r);break;default:throw new Error("Unsupported value "+e[T])}x.push(E),p+=E.length,w.push(k),b+=k.length,++f}for(t[2][0].data=er(f);T<t[7][0].data.length/2;++T)h.setUint16(T*2,65535,!0),y.setUint16(T*2,65535,!0);return t[6][0].data=Zl(x),t[3][0].data=Zl(w),f}function D$(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ha(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(bt(n)));var i=$m(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(G){return G.forEach(function(Y){typeof Y=="string"&&o.push(Y)})});var u={},f=[],h=st.read(e.numbers,{type:"base64"});h.FileIndex.map(function(G,Y){return[G,h.FullPaths[Y]]}).forEach(function(G){var Y=G[0],Z=G[1];if(Y.type==2&&Y.name.match(/\.iwa/)){var oe=Y.content,ye=Ya(oe),Fe=Xa(ye);Fe.forEach(function(Te){f.push(Te.id),u[Te.id]={deps:[],location:Z,type:Fr(Te.messages[0].meta[1][0].data)}})}}),f.sort(function(G,Y){return G-Y});var p=f.filter(function(G){return G>1}).map(function(G){return[G,er(G)]});h.FileIndex.map(function(G,Y){return[G,h.FullPaths[Y]]}).forEach(function(G){var Y=G[0];if(G[1],!!Y.name.match(/\.iwa/)){var Z=Xa(Ya(Y.content));Z.forEach(function(oe){oe.messages.forEach(function(ye){p.forEach(function(Fe){oe.messages.some(function(Te){return Fr(Te.meta[1][0].data)!=11006&&v$(Te.data,Fe[1])})&&u[Fe[0]].deps.push(oe.id)})})})}});for(var x=st.find(h,u[1].location),y=Xa(Ya(x.content)),b,w=0;w<y.length;++w){var T=y[w];T.id==1&&(b=T)}var E=Fn(zt(b.messages[0].data)[1][0].data);for(x=st.find(h,u[E].location),y=Xa(Ya(x.content)),w=0;w<y.length;++w)T=y[w],T.id==E&&(b=T);for(E=Fn(zt(b.messages[0].data)[2][0].data),x=st.find(h,u[E].location),y=Xa(Ya(x.content)),w=0;w<y.length;++w)T=y[w],T.id==E&&(b=T);for(E=Fn(zt(b.messages[0].data)[2][0].data),x=st.find(h,u[E].location),y=Xa(Ya(x.content)),w=0;w<y.length;++w)T=y[w],T.id==E&&(b=T);var k=zt(b.messages[0].data);{k[6][0].data=er(n.e.r+1),k[7][0].data=er(n.e.c+1);var I=Fn(k[46][0].data),N=st.find(h,u[I].location),z=Xa(Ya(N.content));{for(var H=0;H<z.length&&z[H].id!=I;++H);if(z[H].id!=I)throw"Bad ColumnRowUIDMapArchive";var q=zt(z[H].messages[0].data);q[1]=[],q[2]=[],q[3]=[];for(var A=0;A<=n.e.c;++A){var F=[];F[1]=F[2]=[{type:0,data:er(A+420690)}],q[1].push({type:2,data:bn(F)}),q[2].push({type:0,data:er(A)}),q[3].push({type:0,data:er(A)})}q[4]=[],q[5]=[],q[6]=[];for(var R=0;R<=n.e.r;++R)F=[],F[1]=F[2]=[{type:0,data:er(R+726270)}],q[4].push({type:2,data:bn(F)}),q[5].push({type:0,data:er(R)}),q[6].push({type:0,data:er(R)});z[H].messages[0].data=bn(q)}N.content=eu(Zc(z)),N.size=N.content.length,delete k[46];var M=zt(k[4][0].data);{M[7][0].data=er(n.e.r+1);var O=zt(M[1][0].data),j=Fn(O[2][0].data);N=st.find(h,u[j].location),z=Xa(Ya(N.content));{if(z[0].id!=j)throw"Bad HeaderStorageBucket";var L=zt(z[0].messages[0].data);for(R=0;R<i.length;++R){var Ne=zt(L[2][0].data);Ne[1][0].data=er(R),Ne[4][0].data=er(i[R].length),L[2][R]={type:L[2][0].type,data:bn(Ne)}}z[0].messages[0].data=bn(L)}N.content=eu(Zc(z)),N.size=N.content.length;var _e=Fn(M[2][0].data);N=st.find(h,u[_e].location),z=Xa(Ya(N.content));{if(z[0].id!=_e)throw"Bad HeaderStorageBucket";for(L=zt(z[0].messages[0].data),A=0;A<=n.e.c;++A)Ne=zt(L[2][0].data),Ne[1][0].data=er(A),Ne[4][0].data=er(n.e.r+1),L[2][A]={type:L[2][0].type,data:bn(Ne)};z[0].messages[0].data=bn(L)}N.content=eu(Zc(z)),N.size=N.content.length;var ne=Fn(M[4][0].data);(function(){for(var G=st.find(h,u[ne].location),Y=Xa(Ya(G.content)),Z,oe=0;oe<Y.length;++oe){var ye=Y[oe];ye.id==ne&&(Z=ye)}var Fe=zt(Z.messages[0].data);{Fe[3]=[];var Te=[];o.forEach(function(re,ft){Te[1]=[{type:0,data:er(ft)}],Te[2]=[{type:0,data:er(1)}],Te[3]=[{type:2,data:x$(re)}],Fe[3].push({type:2,data:bn(Te)})})}Z.messages[0].data=bn(Fe);var De=Zc(Y),rt=eu(De);G.content=rt,G.size=G.content.length})();var se=zt(M[3][0].data);{var Ee=se[1][0];delete se[2];var ie=zt(Ee.data);{var Ve=Fn(ie[2][0].data);(function(){for(var G=st.find(h,u[Ve].location),Y=Xa(Ya(G.content)),Z,oe=0;oe<Y.length;++oe){var ye=Y[oe];ye.id==Ve&&(Z=ye)}var Fe=zt(Z.messages[0].data);{delete Fe[6],delete se[7];var Te=new Uint8Array(Fe[5][0].data);Fe[5]=[];for(var De=0,rt=0;rt<=n.e.r;++rt){var re=zt(Te);De+=I$(re,i[rt],o),re[1][0].data=er(rt),Fe[5].push({data:bn(re),type:2})}Fe[1]=[{type:0,data:er(n.e.c+1)}],Fe[2]=[{type:0,data:er(n.e.r+1)}],Fe[3]=[{type:0,data:er(De)}],Fe[4]=[{type:0,data:er(n.e.r+1)}]}Z.messages[0].data=bn(Fe);var ft=Zc(Y),ce=eu(ft);G.content=ce,G.size=G.content.length})()}Ee.data=bn(ie)}M[3][0].data=bn(se)}k[4][0].data=bn(M)}b.messages[0].data=bn(k);var U=Zc(y),P=eu(U);return x.content=P,x.size=x.content.length,h}function u3(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function o_(t){u3([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function c_(t){u3([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function O$(t){return At.WS.indexOf(t)>-1?"sheet":t==At.CS?"chart":t==At.DS?"dialog":t==At.MS?"macro":t&&t.length?t:"sheet"}function F$(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,O$(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function j$(t,e,r,n,a,i,o,u,f,h,p,x){try{i[n]=a0(Na(t,r,!0),e);var y=Kr(t,e),b;switch(u){case"sheet":b=nY(y,e,a,f,i[n],h,p,x);break;case"chart":if(b=aY(y,e,a,f,i[n],h,p,x),!b||!b["!drawel"])break;var w=Yf(b["!drawel"].Target,e),T=S0(w),E=qH(Na(t,w,!0),a0(Na(t,T,!0),w)),k=Yf(E,w),I=S0(k);b=IX(Na(t,k,!0),k,f,a0(Na(t,I,!0),k),h,b);break;case"macro":b=sY(y,e,a,f,i[n],h,p,x);break;case"dialog":b=iY(y,e,a,f,i[n],h,p,x);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=b;var N=[];i&&i[n]&&jr(i[n]).forEach(function(z){var H="";if(i[n][z].Type==At.CMNT){H=Yf(i[n][z].Target,e);var q=uY(Kr(t,H,!0),H,f);if(!q||!q.length)return;CS(b,q,!1)}i[n][z].Type==At.TCMNT&&(H=Yf(i[n][z].Target,e),N=N.concat(WH(Kr(t,H,!0),f)))}),N&&N.length&&CS(b,N,!0,f.people||[])}catch(z){if(f.WTF)throw z}}function Ga(t){return t.charAt(0)=="/"?t.slice(1):t}function P$(t,e){if(Lu(),e=e||{},o_(e),$a(t,"META-INF/manifest.xml")||$a(t,"objectdata.xml"))return VS(t,e);if($a(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof px<"u"){if(t.FileIndex)return px(t);var r=st.utils.cfb_new();return KT(t).forEach(function(Ne){Et(r,Ne,X7(t,Ne))}),px(r)}throw new Error("Unsupported NUMBERS file")}if(!$a(t,"[Content_Types].xml"))throw $a(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):$a(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=KT(t),a=VB(Na(t,"[Content_Types].xml")),i=!1,o,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Kr(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Kr(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},h={};if(!e.bookSheets&&!e.bookProps){if(s0=[],a.sst)try{s0=cY(Kr(t,Ga(a.sst)),a.sst,e)}catch(Ne){if(e.WTF)throw Ne}e.cellStyles&&a.themes.length&&(f=oY(Na(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(h=lY(Kr(t,Ga(a.style)),a.style,f,e))}a.links.map(function(Ne){try{var _e=a0(Na(t,S0(Ga(Ne))),Ne);return hY(Kr(t,Ga(Ne)),_e,Ne,e)}catch{}});var p=rY(Kr(t,Ga(a.workbooks[0])),a.workbooks[0],e),x={},y="";a.coreprops.length&&(y=Kr(t,Ga(a.coreprops[0]),!0),y&&(x=JN(y)),a.extprops.length!==0&&(y=Kr(t,Ga(a.extprops[0]),!0),y&&XB(y,x,e)));var b={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(y=Na(t,Ga(a.custprops[0]),!0),y&&(b=$B(y,e)));var w={};if((e.bookSheets||e.bookProps)&&(p.Sheets?o=p.Sheets.map(function(_e){return _e.name}):x.Worksheets&&x.SheetNames.length>0&&(o=x.SheetNames),e.bookProps&&(w.Props=x,w.Custprops=b),e.bookSheets&&typeof o<"u"&&(w.SheetNames=o),e.bookSheets?w.SheetNames:e.bookProps))return w;o={};var T={};e.bookDeps&&a.calcchain&&(T=fY(Kr(t,Ga(a.calcchain)),a.calcchain));var E=0,k={},I,N;{var z=p.Sheets;x.Worksheets=z.length,x.SheetNames=[];for(var H=0;H!=z.length;++H)x.SheetNames[H]=z[H].name}var q=i?"bin":"xml",A=a.workbooks[0].lastIndexOf("/"),F=(a.workbooks[0].slice(0,A+1)+"_rels/"+a.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");$a(t,F)||(F="xl/_rels/workbook."+q+".rels");var R=a0(Na(t,F,!0),F.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=dY(Kr(t,Ga(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=YH(Kr(t,Ga(a.people[0])),e)),R&&(R=F$(R,p.Sheets));var M=Kr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=x.Worksheets;++E){var O="sheet";if(R&&R[E]?(I="xl/"+R[E][1].replace(/[\/]?xl\//,""),$a(t,I)||(I=R[E][1]),$a(t,I)||(I=F.replace(/_rels\/.*$/,"")+R[E][1]),O=R[E][2]):(I="xl/worksheets/sheet"+(E+1-M)+"."+q,I=I.replace(/sheet0\./,"sheet.")),N=I.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(x.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var j=!1,L=0;L!=e.sheets.length;++L)typeof e.sheets[L]=="number"&&e.sheets[L]==E&&(j=1),typeof e.sheets[L]=="string"&&e.sheets[L].toLowerCase()==x.SheetNames[E].toLowerCase()&&(j=1);if(!j)continue e}}j$(t,I,N,x.SheetNames[E],E,k,o,O,e,p,f,h)}return w={Directory:a,Workbook:p,Props:x,Custprops:b,Deps:T,Sheets:o,SheetNames:x.SheetNames,Strings:s0,Styles:h,Themes:f,SSF:_r(ot)},e&&e.bookFiles&&(t.files?(w.keys=n,w.files=t.files):(w.keys=[],w.files={},t.FullPaths.forEach(function(Ne,_e){Ne=Ne.replace(/^Root Entry[\/]/,""),w.keys.push(Ne),w.files[Ne]=t.FileIndex[_e]}))),e&&e.bookVBA&&(a.vba.length>0?w.vbaraw=Kr(t,Ga(a.vba[0]),!0):a.defaults&&a.defaults.bin===rq&&(w.vbaraw=Kr(t,"xl/vbaProject.bin",!0))),w}function M$(t,e){var r=e||{},n="Workbook",a=st.find(t,n);try{if(n="/!DataSpaces/Version",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(dz(a.content),n="/!DataSpaces/DataSpaceMap",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=pz(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=gz(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);vz(a.content)}catch{}if(n="/EncryptionInfo",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=yz(a.content);if(n="/EncryptedPackage",a=st.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function L$(t,e){return e.bookType=="ods"?c3(t,e):e.bookType=="numbers"?D$(t,e):e.bookType=="xlsb"?B$(t,e):V$(t,e)}function B$(t,e){lu=1024,t&&!t.SSF&&(t.SSF=_r(ot)),t&&t.SSF&&(Lu(),Rp(t.SSF),e.revssf=Dp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,i0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=MC.indexOf(e.bookType)>-1,a=Yy();c_(e=e||{});var i=Fy(),o="",u=0;if(e.cellXfs=[],lo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Et(i,o,ZN(t.Props,e)),a.coreprops.push(o),tr(e.rels,2,o,At.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,Et(i,o,rC(t.Props)),a.extprops.push(o),tr(e.rels,3,o,At.EXT_PROPS),t.Custprops!==t.Props&&jr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Et(i,o,nC(t.Custprops)),a.custprops.push(o),tr(e.rels,4,o,At.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var p={"!id":{}},x=t.Sheets[t.SheetNames[u-1]],y=(x||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,Et(i,o,pY(u-1,o,e,t,p)),a.sheets.push(o),tr(e.wbrels,-1,"worksheets/sheet"+u+"."+r,At.WS[0])}if(x){var b=x["!comments"],w=!1,T="";b&&b.length>0&&(T="xl/comments"+u+"."+r,Et(i,T,vY(b,T)),a.comments.push(T),tr(p,-1,"../comments"+u+"."+r,At.CMNT),w=!0),x["!legacy"]&&w&&Et(i,"xl/drawings/vmlDrawing"+u+".vml",jC(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&Et(i,S0(o),du(p))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Et(i,o,xY(e.Strings,o,e)),a.strs.push(o),tr(e.wbrels,-1,"sharedStrings."+r,At.SST)),o="xl/workbook."+r,Et(i,o,mY(t,o)),a.workbooks.push(o),tr(e.rels,1,o,At.WB),o="xl/theme/theme1.xml",Et(i,o,e_(t.Themes,e)),a.themes.push(o),tr(e.wbrels,-1,"theme/theme1.xml",At.THEME),o="xl/styles."+r,Et(i,o,gY(t,o,e)),a.styles.push(o),tr(e.wbrels,-1,"styles."+r,At.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Et(i,o,t.vbaraw),a.vba.push(o),tr(e.wbrels,-1,"vbaProject.bin",At.VBA)),o="xl/metadata."+r,Et(i,o,yY(o)),a.metadata.push(o),tr(e.wbrels,-1,"metadata."+r,At.XLMETA),Et(i,"[Content_Types].xml",KN(a,e)),Et(i,"_rels/.rels",du(e.rels)),Et(i,"xl/_rels/workbook."+r+".rels",du(e.wbrels)),delete e.revssf,delete e.ssf,i}function V$(t,e){lu=1024,t&&!t.SSF&&(t.SSF=_r(ot)),t&&t.SSF&&(Lu(),Rp(t.SSF),e.revssf=Dp(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,i0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=MC.indexOf(e.bookType)>-1,a=Yy();c_(e=e||{});var i=Fy(),o="",u=0;if(e.cellXfs=[],lo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Et(i,o,ZN(t.Props,e)),a.coreprops.push(o),tr(e.rels,2,o,At.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&f.push(t.SheetNames[h]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,Et(i,o,rC(t.Props)),a.extprops.push(o),tr(e.rels,3,o,At.EXT_PROPS),t.Custprops!==t.Props&&jr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Et(i,o,nC(t.Custprops)),a.custprops.push(o),tr(e.rels,4,o,At.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var x={"!id":{}},y=t.Sheets[t.SheetNames[u-1]],b=(y||{})["!type"]||"sheet";switch(b){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,Et(i,o,YC(u-1,e,t,x)),a.sheets.push(o),tr(e.wbrels,-1,"worksheets/sheet"+u+"."+r,At.WS[0])}if(y){var w=y["!comments"],T=!1,E="";if(w&&w.length>0){var k=!1;w.forEach(function(I){I[1].forEach(function(N){N.T==!0&&(k=!0)})}),k&&(E="xl/threadedComments/threadedComment"+u+"."+r,Et(i,E,XH(w,p,e)),a.threadedcomments.push(E),tr(x,-1,"../threadedComments/threadedComment"+u+"."+r,At.TCMNT)),E="xl/comments"+u+"."+r,Et(i,E,PC(w)),a.comments.push(E),tr(x,-1,"../comments"+u+"."+r,At.CMNT),T=!0}y["!legacy"]&&T&&Et(i,"xl/drawings/vmlDrawing"+u+".vml",jC(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}x["!id"].rId1&&Et(i,S0(o),du(x))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Et(i,o,EC(e.Strings,e)),a.strs.push(o),tr(e.wbrels,-1,"sharedStrings."+r,At.SST)),o="xl/workbook."+r,Et(i,o,ZC(t)),a.workbooks.push(o),tr(e.rels,1,o,At.WB),o="xl/theme/theme1.xml",Et(i,o,e_(t.Themes,e)),a.themes.push(o),tr(e.wbrels,-1,"theme/theme1.xml",At.THEME),o="xl/styles."+r,Et(i,o,IC(t,e)),a.styles.push(o),tr(e.wbrels,-1,"styles."+r,At.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Et(i,o,t.vbaraw),a.vba.push(o),tr(e.wbrels,-1,"vbaProject.bin",At.VBA)),o="xl/metadata."+r,Et(i,o,FC()),a.metadata.push(o),tr(e.wbrels,-1,"metadata."+r,At.XLMETA),p.length>1&&(o="xl/persons/person.xml",Et(i,o,$H(p)),a.people.push(o),tr(e.wbrels,-1,"persons/person.xml",At.PEOPLE)),Et(i,"[Content_Types].xml",KN(a,e)),Et(i,"_rels/.rels",du(e.rels)),Et(i,"xl/_rels/workbook."+r+".rels",du(e.wbrels)),delete e.revssf,delete e.ssf,i}function u_(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ia(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function U$(t,e){return st.find(t,"EncryptedPackage")?M$(t,e):n3(t,e)}function z$(t,e){var r,n=t,a=e||{};return a.type||(a.type=St&&Buffer.isBuffer(t)?"buffer":"base64"),r=SN(n,a),P$(r,a)}function f3(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ov(t.slice(r),e);default:break e}return Su.to_workbook(t,e)}function H$(t,e){var r="",n=u_(t,e);switch(e.type){case"base64":r=Ia(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Zo(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=lr(r)),e.type="binary",f3(r,e)}function q$(t,e){var r=t;return e.type=="base64"&&(r=Ia(r)),r=y0.utils.decode(1200,r.slice(2),"str"),e.type="binary",f3(r,e)}function G$(t){return t.match(/[^\x00-\x7F]/)?zs(t):t}function gx(t,e,r,n){return n?(r.type="string",Su.to_workbook(t,r)):Su.to_workbook(e,r)}function Ym(t,e){Cy();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Ym(new Uint8Array(t),(r=_r(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),pu={},r.dateNF&&(pu.dateNF=r.dateNF),r.type||(r.type=St&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=St?"buffer":"binary",n=B7(t),typeof Uint8Array<"u"&&!St&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=G$(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=_r(r),r.type="array",Ym(Ry(n),r)}switch((a=u_(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return U$(st.read(n,r),r);break;case 9:if(a[1]<=8)return n3(n,r);break;case 60:return ov(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return KU(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return bC.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?z$(n,r):gx(t,n,r,i);case 239:return a[3]===60?ov(n,r):gx(t,n,r,i);case 255:if(a[1]===254)return q$(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Go.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Go.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return lv.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return NC.to_workbook(n,r);break;case 10:case 13:case 32:return H$(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return $U.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?lv.to_workbook(n,r):gx(t,n,r,i)}function h3(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return rh(e.file,st.write(t,{type:St?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return st.write(t,e)}function W$(t,e){var r=_r(e||{}),n=L$(t,r);return X$(n,r)}function X$(t,e){var r={},n=St?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?st.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(Cp(a))}return e.password&&typeof encrypt_agile<"u"?h3(encrypt_agile(a,e.password),e):e.type==="file"?rh(e.file,a):e.type=="string"?lr(a):a}function Y$(t,e){var r=e||{},n=GY(t,r);return h3(n,r)}function Vs(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return _0(zs(n));case"binary":return zs(n);case"string":return t;case"file":return rh(e.file,n,"utf8");case"buffer":return St?zi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Vs(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function $$(t,e){switch(e.type){case"base64":return _0(t);case"binary":return t;case"string":return t;case"file":return rh(e.file,t,"binary");case"buffer":return St?zi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Qd(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?_0(r):e.type=="string"?lr(r):r;case"file":return rh(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function d3(t,e){Cy(),UX(t);var r=_r(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=d3(t,r);return r.type="array",Cp(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Vs(LY(t,r),r);case"slk":case"sylk":return Vs(_C.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return Vs(s3(t.Sheets[t.SheetNames[a]],r),r);case"txt":return $$(p3(t.Sheets[t.SheetNames[a]],r),r);case"csv":return Vs(f_(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return Vs(bC.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return Qd(lv.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return Vs(Su.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return Vs(NC.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return Vs(wC.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return Vs(c3(t,r),r);case"wk1":return Qd(Go.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return Qd(Go.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Qd(a3(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Y$(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return W$(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function K$(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function m3(t,e,r){var n={};return n.type="file",n.file=e,K$(n),d3(t,n)}function Q$(t,e,r,n,a,i,o,u){var f=Ur(r),h=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,y=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!o||t[r])for(var b=e.s.c;b<=e.e.c;++b){var w=o?t[r][b]:t[n[b]+f];if(w===void 0||w.t===void 0){if(h===void 0)continue;i[b]!=null&&(y[i[b]]=h);continue}var T=w.v;switch(w.t){case"z":if(T==null)break;continue;case"e":T=T==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(i[b]!=null){if(T==null)if(w.t=="e"&&T===null)y[i[b]]=null;else if(h!==void 0)y[i[b]]=h;else if(p&&T===null)y[i[b]]=null;else continue;else y[i[b]]=p&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?T:Bi(w,T,u);T!=null&&(x=!1)}}return{row:y,isempty:x}}function $m(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},p=h.range!=null?h.range:t["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof p){case"string":f=Bt(p);break;case"number":f=Bt(t["!ref"]),f.s.r=p;break;default:f=p}n>0&&(a=0);var x=Ur(f.s.r),y=[],b=[],w=0,T=0,E=Array.isArray(t),k=f.s.r,I=0,N={};E&&!t[k]&&(t[k]=[]);var z=h.skipHidden&&t["!cols"]||[],H=h.skipHidden&&t["!rows"]||[];for(I=f.s.c;I<=f.e.c;++I)if(!(z[I]||{}).hidden)switch(y[I]=Ar(I),r=E?t[k][I]:t[y[I]+x],n){case 1:i[I]=I-f.s.c;break;case 2:i[I]=y[I];break;case 3:i[I]=h.header[I-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=Bi(r,null,h),T=N[o]||0,!T)N[o]=1;else{do u=o+"_"+T++;while(N[u]);N[o]=T,N[u]=1}i[I]=u}for(k=f.s.r+a;k<=f.e.r;++k)if(!(H[k]||{}).hidden){var q=Q$(t,f,k,y,n,i,E,h);(q.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(b[w++]=q.row)}return b.length=w,b}var GS=/"/g;function J$(t,e,r,n,a,i,o,u){for(var f=!0,h=[],p="",x=Ur(r),y=e.s.c;y<=e.e.c;++y)if(n[y]){var b=u.dense?(t[r]||[])[y]:t[n[y]+x];if(b==null)p="";else if(b.v!=null){f=!1,p=""+(u.rawNumbers&&b.t=="n"?b.v:Bi(b,null,u));for(var w=0,T=0;w!==p.length;++w)if((T=p.charCodeAt(w))===a||T===i||T===34||u.forceQuotes){p='"'+p.replace(GS,'""')+'"';break}p=="ID"&&(p='"ID"')}else b.f!=null&&!b.F?(f=!1,p="="+b.f,p.indexOf(",")>=0&&(p='"'+p.replace(GS,'""')+'"')):p="";h.push(p)}return u.blankrows===!1&&f?null:h.join(o)}function f_(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Bt(t["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),h=new RegExp((i=="|"?"\\|":i)+"+$"),p="",x=[];n.dense=Array.isArray(t);for(var y=n.skipHidden&&t["!cols"]||[],b=n.skipHidden&&t["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(y[w]||{}).hidden||(x[w]=Ar(w));for(var T=0,E=a.s.r;E<=a.e.r;++E)(b[E]||{}).hidden||(p=J$(t,a,E,x,o,f,i,n),p!=null&&(n.strip&&(p=p.replace(h,"")),(p||n.blankrows!==!1)&&r.push((T++?u:"")+p)));return delete n.dense,r.join("")}function p3(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=f_(t,e);return r}function Z$(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Bt(t["!ref"]),i="",o=[],u,f=[],h=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)o[u]=Ar(u);for(var p=a.s.r;p<=a.e.r;++p)for(i=Ur(p),u=a.s.c;u<=a.e.c;++u)if(e=o[u]+i,r=h?(t[p]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=e+"="+n}return f}function g3(t,e,r){var n=r||{},a=+!n.skipHeader,i=t||{},o=0,u=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?kr(n.origin):n.origin;o=f.r,u=f.c}var h,p={s:{c:0,r:0},e:{c:u,r:o+e.length-1+a}};if(i["!ref"]){var x=Bt(i["!ref"]);p.e.c=Math.max(p.e.c,x.e.c),p.e.r=Math.max(p.e.r,x.e.r),o==-1&&(o=x.e.r+1,p.e.r=o+e.length-1+a)}else o==-1&&(o=0,p.e.r=e.length-1+a);var y=n.header||[],b=0;e.forEach(function(T,E){jr(T).forEach(function(k){(b=y.indexOf(k))==-1&&(y[b=y.length]=k);var I=T[k],N="z",z="",H=ct({c:u+b,r:o+E+a});h=D0(i,H),I&&typeof I=="object"&&!(I instanceof Date)?i[H]=I:(typeof I=="number"?N="n":typeof I=="boolean"?N="b":typeof I=="string"?N="s":I instanceof Date?(N="d",n.cellDates||(N="n",I=ln(I)),z=n.dateNF||ot[14]):I===null&&n.nullError&&(N="e",I=0),h?(h.t=N,h.v=I,delete h.w,delete h.R,z&&(h.z=z)):i[H]=h={t:N,v:I},z&&(h.z=z))})}),p.e.c=Math.max(p.e.c,u+y.length-1);var w=Ur(o);if(a)for(b=0;b<y.length;++b)i[Ar(b+u)+w]={t:"s",v:y[b]};return i["!ref"]=bt(p),i}function eK(t,e){return g3(null,t,e)}function D0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=kr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?D0(t,ct(e)):D0(t,ct({r:e,c:r||0}))}function tK(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function h_(){return{SheetNames:[],Sheets:{}}}function d_(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=o+a)!=-1;++a);}if(JC(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function rK(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=tK(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function nK(t,e){return t.z=e,t}function x3(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function aK(t,e,r){return x3(t,"#"+e,r)}function sK(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function iK(t,e,r,n){for(var a=typeof e!="string"?e:Bt(e),i=typeof e=="string"?e:bt(e),o=a.s.r;o<=a.e.r;++o)for(var u=a.s.c;u<=a.e.c;++u){var f=D0(t,o,u);f.t="n",f.F=i,delete f.v,o==a.s.r&&u==a.s.c&&(f.f=r,n&&(f.D=!0))}return t}var vs={encode_col:Ar,encode_row:Ur,encode_cell:ct,encode_range:bt,decode_col:zy,decode_row:Uy,split_cell:xB,decode_cell:kr,decode_range:ha,format_cell:Bi,sheet_add_aoa:HN,sheet_add_json:g3,sheet_add_dom:i3,aoa_to_sheet:Bu,json_to_sheet:eK,table_to_sheet:l3,table_to_book:d$,sheet_to_csv:f_,sheet_to_txt:p3,sheet_to_json:$m,sheet_to_html:s3,sheet_to_formulae:Z$,sheet_to_row_object_array:$m,sheet_get_cell:D0,book_new:h_,book_append_sheet:d_,book_set_sheet_visibility:rK,cell_set_number_format:nK,cell_set_hyperlink:x3,cell_set_internal_link:aK,cell_add_comment:sK,sheet_set_array_formula:iK,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const lK="";function oK({group:t,orders:e,currentUser:r,onEdit:n}){const a=r?.name===lK,[i,o]=ee.useState(t.exchangeRate||.21),[u,f]=ee.useState(t.shippingFee||0);ee.useEffect(()=>{t.exchangeRate!==void 0&&o(t.exchangeRate),t.shippingFee!==void 0&&f(t.shippingFee)},[t]);const h=async()=>{if(a)try{await oa(Tt(Ke,"artifacts","default-app-id","public","data","groups",t.id),{exchangeRate:Number(i),shippingFee:Number(u)}),console.log("")}catch(T){console.error("",T),alert("")}},p=ee.useMemo(()=>e.map(T=>{const E=T.items.reduce((I,N)=>I+N.quantity,0),k=T.items.reduce((I,N)=>I+N.price*N.quantity,0);return{userId:T.userId,userName:T.userName,totalQty:E,totalAmount:k}}).sort((T,E)=>E.totalAmount-T.totalAmount),[e]),x=p.reduce((T,E)=>T+E.totalAmount,0),y=p.reduce((T,E)=>T+E.totalQty,0),b=y>0?u/y:0,w=()=>{const T=[];e.forEach(I=>{I.items.forEach(N=>{const z=N.price*N.quantity,H=b*N.quantity,q=z+H;T.push({:I.userName,:N.name,:N.spec||"-"," ()":N.price,:N.quantity," ()":z," ()":Math.round(H)," () ()":Math.round(q)," (NT$)":Math.round(q*i),:new Date(I.updatedAt).toLocaleString()})})});const E=vs.json_to_sheet(T),k=vs.book_new();vs.book_append_sheet(k,E,""),m3(k,`_${t.title}_${i}.xlsx`)};return m.jsxs("div",{className:"space-y-6 text-slate-800 font-sans",children:[m.jsxs("div",{className:"bg-slate-900 p-4 rounded-lg border-2 border-yellow-400 shadow-lg text-white",children:[m.jsxs("h4",{className:"font-black italic text-xl text-yellow-400 mb-3 transform -skew-x-3",children:[m.jsx(my,{size:20,className:"inline mr-2 fill-yellow-400 text-slate-900"})," "]}),m.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-bold text-slate-400 flex items-center gap-1",children:[m.jsx(py,{size:14,className:"text-red-500"}),"  (JPY  TWD)"]}),a?m.jsx("input",{type:"number",step:"0.001",value:i,onChange:T=>o(T.target.value),onBlur:h,className:"w-full px-3 py-1.5 rounded border-2 border-yellow-400 text-center font-black text-slate-900 focus:outline-none focus:ring-4 focus:ring-red-600 bg-yellow-100 shadow-md transition-all"}):m.jsx("span",{className:"font-mono text-2xl font-black text-yellow-400 bg-slate-800 px-3 py-1 rounded border border-yellow-400",children:i})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-bold text-slate-400 flex items-center gap-1",children:[m.jsx(Ap,{size:14,className:"text-red-500"}),"  (JPY)"]}),a?m.jsx("input",{type:"number",value:u,onChange:T=>f(T.target.value),onBlur:h,className:"w-full px-3 py-1.5 rounded border-2 border-yellow-400 text-center font-black text-slate-900 focus:outline-none focus:ring-4 focus:ring-red-600 bg-yellow-100 shadow-md transition-all"}):m.jsx("span",{className:"font-mono text-2xl font-black text-yellow-400 bg-slate-800 px-3 py-1 rounded border border-yellow-400",children:u})]})]})]}),m.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center bg-white p-4 rounded-lg border-2 border-slate-900 shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] gap-4 sm:gap-0",children:[m.jsxs("div",{className:"flex gap-6 text-sm font-bold",children:[m.jsxs("div",{children:[m.jsx("span",{className:"text-slate-500 block text-xs",children:""}),m.jsx("span",{className:"font-black text-3xl text-red-600 italic",children:y})]}),m.jsxs("div",{className:"border-l border-slate-200 pl-4",children:[m.jsx("span",{className:"text-slate-500 block text-xs",children:" ()"}),m.jsxs("div",{className:"flex flex-col leading-snug",children:[m.jsxs("span",{className:"font-black text-xl text-slate-900",children:["",(x+Number(u)).toLocaleString()]}),m.jsxs("span",{className:"text-sm text-yellow-600 font-black tracking-wider",children:[" NT$",Math.round((x+Number(u))*i).toLocaleString()]})]})]})]}),a&&m.jsxs("button",{onClick:w,className:"w-full sm:w-auto flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded border-2 border-green-800 text-sm font-black italic shadow-[2px_2px_0px_0px_rgba(20,83,45,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[m.jsx(Mk,{size:18})," EXCEL "]})]}),m.jsxs("div",{className:"border-2 border-slate-900 rounded-lg overflow-hidden shadow-lg bg-white",children:[m.jsxs("div",{className:"bg-slate-900 px-4 py-3 text-xs font-black text-yellow-400 flex justify-between uppercase",children:[m.jsx("span",{children:" ()"}),m.jsx("span",{className:"text-right",children:" (TWD)"})]}),m.jsxs("div",{className:"divide-y divide-slate-200 max-h-60 overflow-y-auto bg-white",children:[p.map(T=>{const E=Math.round(b*T.totalQty),k=T.totalAmount+E,I=Math.round(k*i);return m.jsxs("div",{className:"flex justify-between items-center px-4 py-3 text-sm hover:bg-slate-50 transition-colors",children:[m.jsxs("div",{className:"flex flex-col",children:[m.jsxs("span",{className:"font-black text-slate-900 flex items-center gap-1",children:[m.jsx(wy,{size:14,className:"text-red-600"})," ",T.userName]}),m.jsxs("span",{className:"text-slate-500 text-xs italic",children:[T.totalQty," "]})]}),m.jsxs("div",{className:"text-right",children:[m.jsxs("div",{className:"font-black text-lg text-slate-900 font-mono",children:["",k.toLocaleString()]}),m.jsxs("div",{className:"text-xs font-bold bg-yellow-400/30 text-slate-900 px-1.5 py-0.5 rounded inline-block mt-1 border border-yellow-400",children:[" NT$",I.toLocaleString()]}),Number(u)>0&&m.jsxs("span",{className:"text-[10px] text-slate-400 font-medium ml-1 block",children:["(",T.totalAmount," + ",E,")"]})]})]},T.userId)}),p.length===0&&m.jsx("div",{className:"p-4 text-center text-slate-300 text-sm italic",children:""})]})]}),m.jsx("div",{className:"h-2 bg-yellow-400 border-t-2 border-slate-900 mt-5"}),m.jsxs("div",{className:"space-y-6",children:[m.jsxs("h4",{className:"font-black italic text-lg text-slate-900 flex items-center gap-2 transform -skew-x-3",children:[m.jsx(lP,{size:20,className:"text-red-600"})," "]}),e.map(T=>{const E=r&&T.userId===r.id,k=T.items.reduce((q,A)=>q+A.price*A.quantity,0),I=T.items.reduce((q,A)=>q+A.quantity,0),N=Math.round(b*I),z=k+N,H=Math.round(z*i);return m.jsxs("div",{className:`bg-white rounded-lg border-4 ${E?"border-red-600 shadow-[4px_4px_0px_0px_#FACC15]":"border-slate-900 shadow-md"} transition-all`,children:[m.jsxs("div",{className:`px-5 py-3 border-b-2 flex justify-between items-center ${E?"bg-red-50 border-red-200":"bg-slate-50 border-slate-100"}`,children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-black ${E?"bg-red-600 text-white":"bg-slate-900 text-yellow-400"}`,children:T.userName.charAt(0)}),m.jsxs("div",{className:"flex flex-col",children:[m.jsxs("span",{className:`font-black italic text-sm ${E?"text-red-700":"text-slate-900"}`,children:[T.userName," ",E&&"(YOU)"]}),m.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:new Date(T.updatedAt).toLocaleDateString()})]})]}),E&&n&&m.jsxs("button",{onClick:n,className:"flex items-center gap-1 bg-white text-blue-600 text-xs font-black px-3 py-1.5 rounded border-2 border-slate-900 shadow-sm hover:bg-blue-50 transition-all italic",children:[m.jsx(xy,{size:14})," "]})]}),m.jsxs("div",{className:"p-5 bg-white",children:[m.jsx("ul",{className:"space-y-3",children:T.items.map((q,A)=>m.jsxs("li",{className:"flex justify-between items-start text-sm border-b border-dashed border-slate-200 last:border-0 pb-2 last:pb-0",children:[m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{className:"text-slate-900 font-black text-base",children:q.name}),q.spec&&m.jsxs("span",{className:"text-slate-500 text-xs italic",children:[": ",q.spec]})]}),m.jsxs("div",{className:"flex flex-col items-end",children:[m.jsxs("span",{className:"font-black font-mono text-xl text-red-600 italic",children:["x ",q.quantity]}),m.jsx("div",{className:"text-right",children:m.jsxs("span",{className:"text-xs text-slate-500",children:["",q.price]})})]})]},A))}),m.jsxs("div",{className:"mt-4 pt-3 border-t-2 border-slate-200 flex flex-col items-end",children:[m.jsxs("div",{className:"flex gap-4 text-xs text-slate-400 mb-1 font-bold",children:[m.jsxs("span",{children:[" ",k.toLocaleString()]}),m.jsx("span",{children:"+"}),m.jsxs("span",{children:[" ",N]})]}),m.jsxs("div",{className:"flex items-baseline gap-2",children:[m.jsx("span",{className:"text-slate-500 text-sm",children:"TOTAL JPY"}),m.jsxs("span",{className:"font-black text-slate-900 font-mono text-2xl",children:["",z.toLocaleString()]})]}),m.jsxs("div",{className:"text-lg font-black bg-yellow-400 text-slate-900 px-3 py-0.5 rounded mt-1 italic border-2 border-slate-900",children:[" NT$",H.toLocaleString()]})]})]})]},T.userId)})]})]})}const Jd=250;function v3({group:t,orders:e,currentUser:r,onUpdate:n,isReadOnly:a=!1}){const i=!a&&(r?.name===""||r?.id==="yeye"),[o,u]=ee.useState(t.secondPayment?.weights||{}),[f,h]=ee.useState(t.secondPayment?.boxWeight||0),[p,x]=ee.useState(t.secondPayment?.minChargeDiff||0),y=cK(()=>{const z=new Set;return e.forEach(H=>H.items?.forEach(q=>z.add(q.itemId))),t.items?.filter(H=>z.has(H.id))||[]},[t.items,e]),b=e.filter(z=>z.groupId===t.id);let w=0;b.forEach(z=>z.items.forEach(H=>w+=Number(H.quantity)||0));const T=new Set(b.map(z=>z.userId)).size,E=w>0?f*Jd/w:0,k=T>0?p/T:0,I=b.reduce((z,H)=>{let q=0,A=[];return H.items?.forEach(F=>{const R=parseFloat(o[F.itemId]||0),O=(R*Jd+E)*F.quantity;q+=O,A.push({name:F.name,qty:F.quantity,weight:R,subtotal:O})}),q+=k,z[H.userId]?(z[H.userId].details.push(...A),z[H.userId].total+=q):z[H.userId]={name:H.userName,details:A,total:q},z},{}),N=()=>{n({weights:o,boxWeight:f,minChargeDiff:p}),alert("")};return m.jsxs("div",{className:"space-y-6 max-h-[80vh] overflow-y-auto pr-2",children:[i&&m.jsxs("div",{className:"bg-white p-5 rounded-xl border-4 border-slate-900 shadow-[4px_4px_0px_0px_#000]",children:[m.jsxs("h3",{className:"font-black text-slate-900 mb-4 flex items-center gap-2 uppercase italic border-b-2 pb-2",children:[m.jsx(Q0,{size:20,className:"text-blue-600"})," Weight Control Panel"]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[m.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border-2 border-slate-200",children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1 uppercase",children:"/ (kg)"}),m.jsx("input",{type:"number",step:"0.01",className:"w-full bg-transparent font-mono font-bold text-lg outline-none",value:f,onChange:z=>h(z.target.value)})]}),m.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border-2 border-slate-200",children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1 uppercase",children:" (TWD)"}),m.jsx("input",{type:"number",className:"w-full bg-transparent font-mono font-bold text-lg outline-none",value:p,onChange:z=>x(z.target.value)})]})]}),m.jsx("p",{className:"text-[10px] font-black text-slate-400 mb-3 uppercase tracking-widest",children:"Individual Item Weights"}),m.jsx("div",{className:"space-y-3",children:y.map(z=>m.jsxs("div",{className:"flex items-center gap-3 bg-slate-50 p-2 rounded-lg border border-slate-200",children:[m.jsx("span",{className:"flex-1 text-xs font-bold text-slate-700 truncate",children:z.name}),m.jsxs("div",{className:"flex items-center gap-1 bg-white px-2 py-1 rounded border border-slate-300",children:[m.jsx("input",{type:"number",step:"0.001",placeholder:"0.000",className:"w-20 text-right font-mono font-black text-blue-600 outline-none",value:o[z.id]||"",onChange:H=>u({...o,[z.id]:H.target.value})}),m.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:"kg"})]})]},z.id))}),m.jsxs("button",{onClick:N,className:"w-full mt-6 py-3 bg-slate-900 text-yellow-400 rounded-xl font-black flex items-center justify-center gap-2 hover:bg-slate-800 shadow-[4px_4px_0px_0px_#ccc] transition-all active:translate-y-1 active:shadow-none",children:[m.jsx(Ui,{size:18})," SAVE SETTINGS"]})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-end",children:[m.jsxs("h3",{className:"font-black text-slate-900 flex items-center gap-2 italic",children:[m.jsx(my,{size:20,className:"text-red-600"})," "]}),a&&m.jsx("span",{className:"text-[10px] font-black text-blue-600 border-b-2 border-blue-600 pb-0.5",children:"READ ONLY MODE"})]}),Object.values(I).map((z,H)=>m.jsxs("div",{className:"bg-white border-2 border-slate-900 rounded-xl overflow-hidden shadow-sm",children:[m.jsxs("div",{className:"bg-slate-900 text-white px-4 py-2 flex justify-between items-center",children:[m.jsx("span",{className:"font-black italic uppercase tracking-tighter",children:z.name}),m.jsxs("span",{className:"font-mono font-black text-yellow-400",children:["Total: $",Math.round(z.total)]})]}),m.jsx("div",{className:"p-0",children:m.jsxs("table",{className:"w-full text-[11px] text-left",children:[m.jsx("thead",{className:"bg-slate-50 text-slate-400 font-bold uppercase border-b",children:m.jsxs("tr",{children:[m.jsx("th",{className:"p-2",children:"Item"}),m.jsx("th",{className:"p-2 text-center",children:"Qty"}),m.jsx("th",{className:"p-2 text-center",children:"Weight"}),m.jsx("th",{className:"p-2 text-right",children:"Subtotal"})]})}),m.jsxs("tbody",{className:"divide-y divide-slate-100",children:[z.details.map((q,A)=>m.jsxs("tr",{children:[m.jsx("td",{className:"p-2 font-bold text-slate-700",children:q.name}),m.jsx("td",{className:"p-2 text-center text-slate-500",children:q.qty}),m.jsxs("td",{className:"p-2 text-center font-mono text-slate-400",children:[q.weight,"kg"]}),m.jsxs("td",{className:"p-2 text-right font-mono font-bold",children:["$",Math.round(q.subtotal)]})]},A)),p>0&&m.jsxs("tr",{className:"bg-yellow-50/50",children:[m.jsx("td",{colSpan:3,className:"p-2 text-slate-500 italic",children:" (Person Share)"}),m.jsxs("td",{className:"p-2 text-right font-mono font-bold",children:["$",Math.round(k)]})]})]})]})})]},H))]}),a&&m.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border-2 border-dashed border-slate-300 flex items-start gap-3",children:[m.jsx(lc,{size:18,className:"text-slate-400 shrink-0 mt-0.5"}),m.jsxs("p",{className:"text-[10px] font-bold text-slate-500 leading-relaxed",children:["[(  ",Jd,") + (  ",Jd," / )]   + ( / ) "]})]})]})}function cK(t,e){const[r,n]=$s.useState(t);return $s.useEffect(()=>n(t()),e),r}function WS({images:t}){const[e,r]=ee.useState(0),n=Array.isArray(t)&&t.length>0?t:[];if(n.length===0)return m.jsx("div",{className:"w-full h-full flex items-center justify-center bg-stone-100 text-stone-300",children:m.jsx(K0,{size:24,className:"opacity-20"})});const a=o=>{o.stopPropagation(),r(u=>(u+1)%n.length)},i=o=>{o.stopPropagation(),r(u=>(u-1+n.length)%n.length)};return m.jsxs("div",{className:"relative w-full h-full bg-stone-100 group",children:[m.jsx("img",{src:n[e],alt:"product",className:"w-full h-full object-cover transition-transform duration-500 hover:scale-105"}),n.length>1&&m.jsxs(m.Fragment,{children:[m.jsx("button",{onClick:i,className:"absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white text-stone-600",children:m.jsx(Hj,{size:16})}),m.jsx("button",{onClick:a,className:"absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white text-stone-600",children:m.jsx(jk,{size:16})}),m.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1",children:n.map((o,u)=>m.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${u===e?"bg-orange-500":"bg-white/70"}`},u))})]})]})}function uK({currentUser:t,onLogout:e,onOpenModal:r}){const[n,a]=ee.useState(!1),i=t?.isMember,o=async()=>{if(t)if(t.isMember){if(t.memberValidUntil)window.confirm(`
`)&&(await oa(Tt(Ke,"artifacts","default-app-id","public","data","users",t.id),{memberValidUntil:null,memberCancelledAt:null}),alert(""));else if(window.confirm(`
 30 `)){const u=new Date;u.setDate(u.getDate()+30),await oa(Tt(Ke,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberValidUntil:u.toISOString(),memberCancelledAt:new Date().toISOString()}),alert(`
 ${u.toLocaleDateString()}`)}}else window.confirm(` PLUS ULTRA 
`)&&(await oa(Tt(Ke,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberSince:new Date().toISOString(),memberValidUntil:null,memberCancelledAt:null}),alert(""))};return m.jsxs("div",{className:"relative z-50",children:[m.jsxs("button",{onClick:()=>a(!n),className:`w-10 h-10 rounded-full bg-slate-800 border-2 ${i?"border-purple-500":"border-yellow-400"} shadow-lg overflow-hidden hover:scale-105 transition-all relative`,children:[m.jsx("img",{src:t?.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${t?.name}`,alt:"avatar",className:"w-full h-full object-cover"}),i&&m.jsx("div",{className:"absolute -top-1 -right-1 bg-purple-600 rounded-full p-0.5 border border-white",children:m.jsx($x,{size:8,className:"text-white fill-white"})})]}),n&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"fixed inset-0 z-[-1]",onClick:()=>a(!1)}),m.jsxs("div",{className:"absolute right-0 mt-2 w-60 bg-white rounded-lg shadow-xl border-2 border-slate-900 py-1 z-50 animate-in fade-in slide-in-from-top-2",children:[m.jsxs("div",{className:"px-3 py-2 border-b-2 border-slate-100 bg-slate-50",children:[m.jsxs("div",{className:"flex justify-between items-center mb-1",children:[m.jsxs("span",{className:"text-xs font-black text-slate-500 flex items-center gap-1",children:[m.jsx($x,{size:12,className:i?"text-purple-600 fill-purple-600":"text-slate-300"}),"PLUS "]}),i&&m.jsx("span",{className:"text-[10px] bg-purple-100 text-purple-700 px-1.5 rounded font-bold",children:"SUBSCRIBED"})]}),m.jsx("button",{onClick:o,className:`w-full text-xs font-bold py-1.5 rounded border-2 transition-all ${i&&t.memberValidUntil?"bg-green-100 text-green-700 border-green-300 hover:bg-green-200":i?"bg-white border-slate-300 text-slate-500 hover:bg-red-50 hover:text-red-500 hover:border-red-300":"bg-purple-600 border-purple-800 text-white hover:bg-purple-700"}`,children:i?t.memberValidUntil?"":"":" (NT$90/)"})]}),m.jsxs("button",{onClick:()=>{a(!1),r("changeName")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[m.jsx(J0,{size:16})," "]}),m.jsxs("button",{onClick:()=>{a(!1),r("changeAvatar")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[m.jsx(wp,{size:16})," "]}),m.jsxs("button",{onClick:()=>{a(!1),r("changePwd")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[m.jsx(Bk,{size:16})," "]}),t?.name===""&&m.jsx("div",{className:"border-t border-slate-100 mt-1",children:m.jsxs(gu,{to:"/admin/dashboard",className:"block px-4 py-2 text-sm text-blue-700 font-black hover:bg-blue-50 transition-colors flex items-center gap-2",onClick:()=>a(!1),children:[m.jsx(Hk,{size:16})," "]})}),m.jsx("div",{className:"border-t-2 border-slate-100 my-1"}),m.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2 font-black",children:[m.jsx(Vk,{size:16})," "]})]})]})]})}function fK({title:t="",user:e,children:r,onLogout:n,onOpenModal:a}){return m.jsx("header",{className:"sticky top-0 z-30 bg-slate-900 border-b-4 border-yellow-400 px-4 py-3 shadow-md",children:m.jsxs("div",{className:"max-w-5xl mx-auto flex flex-wrap items-center justify-between gap-y-3",children:[m.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto justify-center md:justify-start",children:[m.jsx("div",{className:"bg-yellow-400 p-2 rounded transform -skew-x-12 border-2 border-yellow-800",children:m.jsx(Fm,{size:24,className:"text-slate-900 transform skew-x-12"})}),m.jsx("h1",{className:"text-3xl md:text-2xl font-black italic tracking-tight text-white drop-shadow-md",children:t})]}),m.jsxs("div",{className:"flex items-center w-full md:w-auto md:flex-1 md:justify-end gap-2",children:[m.jsx("div",{className:"flex-1 min-w-0 md:flex-none",children:r}),m.jsxs("div",{className:"text-right hidden md:block shrink-0",children:[m.jsx("p",{className:"text-xs text-slate-400",children:"HERO NAME"}),m.jsx("p",{className:"font-bold text-white tracking-wide",children:e?.name})]}),m.jsx("div",{className:"shrink-0 ml-1",children:m.jsx(uK,{currentUser:e,onLogout:n,onOpenModal:a})})]})]})})}function hK({isMember:t,fee:e,amount:r,description:n}){const i=n||`

  ()
 `;return m.jsxs("div",{className:`\r
            relative group border-r border-slate-700 mr-1 pr-2 sm:mr-2 sm:pr-4\r
            flex w-full items-center justify-end gap-3   /*  */\r
            sm:w-auto sm:flex-col sm:items-end sm:gap-0  /*  */\r
        `,children:[m.jsxs("button",{type:"button",onClick:()=>alert(i),className:`\r
                    focus:outline-none group/btn\r
                    flex items-center gap-2              /*  */\r
                    sm:mb-1 sm:gap-1.5\r
                `,children:[m.jsx("span",{className:"text-[16px] sm:text-base text-slate-400 font-bold whitespace-nowrap pt-0.5",children:""}),m.jsxs("span",{className:"text-[10px] text-yellow-500 group-hover/btn:text-yellow-400 border-b border-dashed border-yellow-500/50 flex items-center gap-0.5 transition-colors",children:[m.jsx("span",{className:"hidden sm:inline",children:"?"}),m.jsx(Yx,{className:"block sm:hidden",size:14}),m.jsx(Yx,{className:"hidden sm:block",size:10})]})]}),m.jsxs("div",{className:"text-yellow-400 font-black drop-shadow-sm text-right flex items-center",children:[m.jsx("span",{className:"text-xs mr-1 text-yellow-200 mt-1",children:"NT$"}),m.jsx("span",{className:"text-xl sm:text-xl font-mono",children:t?`${e} + ${r.toLocaleString()}`:r.toLocaleString()})]}),m.jsx("div",{className:"absolute top-12 right-0 w-max bg-slate-800 text-white text-xs p-2 rounded border border-yellow-400 shadow-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 hidden sm:block whitespace-pre-wrap text-left",children:i})]})}const xx=["","","","","","","",""],dK=90;function mK({appUser:t,usersData:e,handleLogout:r}){const[n,a]=ee.useState([]),[i,o]=ee.useState([]),[u,f]=ee.useState([]),[h,p]=ee.useState([]),[x,y]=ee.useState(null),[b,w]=ee.useState(null),[T,E]=ee.useState(null),[k,I]=ee.useState("wishing"),[N,z]=ee.useState(""),[H,q]=ee.useState(""),[A,F]=ee.useState(""),[R,M]=ee.useState("<div>Loading...</div>"),O=15,[j,L]=ee.useState(1),[Ne,_e]=ee.useState(0),ne=i.find(ce=>ce.id===b)||null;ee.useEffect(()=>{const ce=Tr(Wt(Ke,"artifacts","default-app-id","public","data","wishes"),nt=>a(nt.docs.map(ht=>({id:ht.id,...ht.data()})))),ze=Tr(Wt(Ke,"artifacts","default-app-id","public","data","groups"),nt=>o(nt.docs.map(ht=>({id:ht.id,...ht.data()})))),Ce=Tr(Wt(Ke,"artifacts","default-app-id","public","data","orders"),nt=>f(nt.docs.map(ht=>({id:ht.id,...ht.data()})))),je=Tr(Wt(Ke,"artifacts","default-app-id","public","data","miscCharges"),nt=>p(nt.docs.map(ht=>({id:ht.id,...ht.data()})))),tt=Tr(Tt(Ke,"artifacts","default-app-id","public","data","system","bulletin"),nt=>{nt.exists()&&M(nt.data().content)});return()=>{ce(),ze(),Ce(),je(),tt()}},[]),ee.useEffect(()=>{L(1)},[k,N,H,A]);const se=(ce,ze)=>{const Ce=ce.updatedAt||ce.createdAt;if(!Ce)return!1;const je=`${ze}_${ce.id}`;let tt=t?.readHistory?.[je];if(!tt){const nt=`read_${t?.id}_${ze}_${ce.id}`;tt=localStorage.getItem(nt)}return tt?new Date(Ce)>new Date(tt):!0},Ee=async(ce,ze)=>{const Ce=new Date().toISOString(),je=`${ze}_${ce.id}`,tt=`read_${t?.id}_${ze}_${ce.id}`;if(localStorage.setItem(tt,Ce),_e(nt=>nt+1),t&&t.id)try{const nt=Tt(Ke,"artifacts","default-app-id","public","data","users",t.id);await Uo(nt,{readHistory:{[je]:Ce}},{merge:!0})}catch(nt){console.error("",nt)}},ie=async ce=>{t&&(await oa(Tt(Ke,"artifacts","default-app-id","public","data","users",t.id),{password:ce}),alert(""),y(null))},Ve=async ce=>{if(t)try{await oa(Tt(Ke,"artifacts","default-app-id","public","data","users",t.id),{name:ce}),alert(""),y(null)}catch{alert("")}},U=async ce=>{t&&(await oa(Tt(Ke,"artifacts","default-app-id","public","data","users",t.id),{avatar:ce}),alert(""),y(null))},P=async ce=>{try{T?await oa(Tt(Ke,"artifacts","default-app-id","public","data","wishes",T.id),{...ce,updatedAt:new Date().toISOString()}):await Ti(Wt(Ke,"artifacts","default-app-id","public","data","wishes"),{...ce,authorName:t.name,authorId:t.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),plusOnes:[]}),y(null),E(null)}catch{alert("")}},G=async ce=>{if(confirm(`${ce.title}`))try{await Am(Tt(Ke,"artifacts","default-app-id","public","data","wishes",ce.id))}catch(ze){console.error(ze)}},Y=async ce=>{if(!t)return;Ee(ce,"wish");const ze=ce.plusOnes||[],je=ze.includes(t.name)?ze.filter(tt=>tt!==t.name):[...ze,t.name];await oa(Tt(Ke,"artifacts","default-app-id","public","data","wishes",ce.id),{plusOnes:je})},Z=async ce=>{const ze={title:`[] ${ce.ipName}`,type:"",infoUrl:ce.sourceUrl,status:"",createdBy:t.name,createdById:t.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),exchangeRate:.21,shippingFee:0,deadline:"",items:ce.items.map(Ce=>({id:Ce.id,name:Ce.name,price:Ce.price,limit:Ce.quantity,image:"",spec:""})),note:ce.note,requestType:ce.type,secondPayment:{},paymentStatus:""};try{const Ce=await Ti(Wt(Ke,"artifacts","default-app-id","public","data","groups"),ze),je=ce.items.map(tt=>({itemId:tt.id,name:tt.name,price:tt.price,quantity:tt.quantity,image:""}));await Ti(Wt(Ke,"artifacts","default-app-id","public","data","orders"),{groupId:Ce.id,userId:t.id,userName:t.name,items:je,updatedAt:new Date().toISOString()}),y(null),alert("")}catch{alert("")}},oe=async(ce,ze)=>{const Ce=u.find(tt=>tt.groupId===ze&&tt.userId===t.id);if(ce.length===0){if(Ce)try{await Am(Tt(Ke,"artifacts","default-app-id","public","data","orders",Ce.id)),alert("")}catch{alert("")}y("viewOrders");return}const je={groupId:ze,userId:t.id,userName:t.name,items:ce,updatedAt:new Date().toISOString()};Ce?await oa(Tt(Ke,"artifacts","default-app-id","public","data","orders",Ce.id),je):await Ti(Wt(Ke,"artifacts","default-app-id","public","data","orders"),je),y("viewOrders")},ye=ee.useMemo(()=>{if(!u||!i||u.length===0||!t)return 0;const ce=u.reduce((Ce,je)=>{if(je.userId!==t.id)return Ce;const tt=i.find(fr=>fr.id===je.groupId);if(!tt)return Ce;const nt=u.filter(fr=>fr.groupId===tt.id);let ht=0;if(nt.forEach(fr=>fr.items.forEach(da=>ht+=Number(da.quantity)||0)),["","",""].includes(tt.status)){const fr=Number(tt.exchangeRate||0),da=Number(tt.shippingFee||0),Hn=ht>0?da/ht:0,Ht=(je.items||[]).reduce((dt,Pt)=>dt+(Number(Pt.quantity)||0),0),en=(je.items||[]).reduce((dt,Pt)=>dt+(Number(Pt.price)||0)*(Number(Pt.quantity)||0),0),kn=Hn*Ht,Jn=Math.round((en+kn)*fr);let Yt=0;if(tt.secondPayment){const Pt=tt.secondPayment.weights||{},tn=parseFloat(tt.secondPayment.boxWeight||0),Mt=parseFloat(tt.secondPayment.minChargeDiff||0),or=ht>0?tn*250/ht:0,cn=new Set(nt.map(ns=>ns.userId)),mr=cn.size>0?Mt/cn.size:0;je.items.forEach(ns=>{const as=parseFloat(Pt[ns.itemId]||0);Yt+=(as*250+or)*ns.quantity}),Yt+=mr}const on=tt.paymentStatus||"";if(on==="")return Ce+Jn;if(on==="")return Ce+Math.round(Yt);if(on==="+")return Ce+Jn+Math.round(Yt)}return Ce},0),ze=h.filter(Ce=>Ce.targetUserId===t.id&&(Ce.paymentStatus||"")==="").reduce((Ce,je)=>Ce+Number(je.amount||0),0);return ce+ze},[u,i,t,h]),{memberFeeSplit:Fe,isMember:Te}=ee.useMemo(()=>{if(!t||!e.length)return{memberFeeSplit:0,isMember:!1};const ce=e.filter(Ce=>Ce.isMember).length;return{memberFeeSplit:ce>0?Math.ceil(dK/ce):0,isMember:t.isMember}},[t,e]),De=ce=>{let ze=i.filter(Ce=>ce.includes(Ce.status));return(N||H)&&(ze=ze.filter(Ce=>{if(!Ce.deadline||Ce.deadline==="")return!1;const je=new Date(Ce.deadline).getTime(),tt=N?new Date(N).getTime():0,nt=H?new Date(H).getTime()+864e5:1/0;return je>=tt&&je<nt})),A&&(A===""?ze=ze.filter(Ce=>Ce.paymentStatus===""||Ce.paymentStatus===" "||Ce.paymentStatus==="+ "):ze=ze.filter(Ce=>(Ce.paymentStatus||"")===A)),ze.sort((Ce,je)=>(Ce.releaseDate||"9999-12-31").localeCompare(je.releaseDate||"9999-12-31"))},rt=k==="active"?De([""]):k==="completed"?De([""]):k==="shipping"?De([""]):k==="closed"?De([""]):[],re=Math.ceil(rt.length/O),ft=rt.slice((j-1)*O,j*O);return m.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-800 font-sans pb-20 selection:bg-yellow-400 selection:text-black",children:[m.jsx(fK,{user:t,onLogout:r,onOpenModal:ce=>y(ce),children:m.jsx(hK,{isMember:Te,fee:Fe,amount:ye})}),m.jsx("section",{className:"max-w-5xl mx-auto mt-6 px-4",children:m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[m.jsxs("div",{className:"md:col-span-3 bg-white rounded-lg shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] border-2 border-slate-900 overflow-hidden flex flex-col",children:[m.jsxs("div",{className:"bg-yellow-400 border-b-2 border-slate-900 p-3 flex items-center gap-2 text-slate-900 font-black italic transform -skew-x-6",children:[m.jsx(Uk,{size:24,className:"fill-slate-900"}),m.jsx("h2",{children:"ACADEMY NEWS"})]}),m.jsx("div",{className:"p-6 flex-1 prose prose-slate prose-sm max-w-none text-slate-700 font-medium",dangerouslySetInnerHTML:{__html:R}})]}),m.jsx("div",{className:"md:col-span-1",children:m.jsx(gu,{to:"/jf26",className:"block w-full h-full group hover:-translate-y-1 transition-all",children:m.jsxs("div",{className:"h-full bg-white p-2 rounded-xl border-4 border-slate-900 shadow-[4px_4px_0px_0px_#FACC15] overflow-hidden relative flex flex-col",children:[m.jsx("div",{className:"bg-slate-900 text-yellow-400 font-black text-center text-sm py-1 mb-1 italic",children:"JF26 "}),m.jsx("img",{src:"https://www.jumpfesta.com/assets/images/top_jumpfesta_pc@2x.webp",alt:"JF26",className:"w-full h-full object-cover rounded-lg border-2 border-slate-100"}),m.jsx("div",{className:"absolute top-2 right-2 bg-red-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full animate-pulse border border-white shadow-sm rotate-12",children:"HOT!"})]})})})]})}),m.jsx("nav",{className:"max-w-5xl mx-auto mt-8 px-4",children:m.jsx("div",{className:"bg-white p-1 rounded-lg shadow-sm border-2 border-slate-200 flex justify-around gap-1",children:[{id:"wishing",label:"",icon:J1},{id:"active",label:"",icon:jm},{id:"completed",label:"",icon:Ep},{id:"shipping",label:"",icon:vy},{id:"misc",label:"",icon:Lk},{id:"closed",label:"",icon:Nj}].map(ce=>m.jsxs("button",{onClick:()=>I(ce.id),className:`flex-1 flex flex-col items-center justify-center gap-1 py-2 rounded font-black transition-all border-2 ${k===ce.id?"bg-slate-900 border-slate-900 text-yellow-400 shadow-md transform -translate-y-1":"bg-transparent border-transparent text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:[m.jsx(ce.icon,{size:20,className:k===ce.id?"animate-pulse":""}),m.jsx("span",{className:"text-[11px] sm:text-sm whitespace-nowrap",children:ce.label})]},ce.id))})}),m.jsxs("main",{className:"max-w-5xl mx-auto px-4 py-8",children:[k==="wishing"&&m.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:[m.jsxs("div",{className:"mb-6 bg-white p-4 rounded-xl border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] flex items-start gap-4",children:[m.jsx("div",{className:"bg-red-100 p-2 rounded-lg border-2 border-red-600 shrink-0",children:m.jsx(J1,{size:20,className:"text-red-600 fill-red-600"})}),m.jsxs("div",{children:[m.jsx("h4",{className:"font-black text-xs uppercase tracking-tighter text-slate-400 mb-1 italic",children:"Wish Pool Briefing"}),m.jsx("p",{className:"text-sm font-bold text-slate-700 leading-relaxed",children:"+1"})]})]}),m.jsx("div",{className:"flex justify-end mb-6",children:m.jsxs("button",{onClick:()=>{E(null),y("wish")},className:"px-6 py-2 bg-red-600 text-white border-2 border-red-800 rounded font-black hover:bg-red-700 flex items-center gap-2 shadow-[2px_2px_0px_0px_rgba(153,27,27,1)] italic",children:[m.jsx(Yl,{size:20})," MAKE A WISH"]})}),m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(ce=>m.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 border-slate-200 hover:border-slate-900 hover:shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] transition-all flex flex-col relative",onClick:()=>Ee(ce,"wish"),children:[se(ce,"wish")&&m.jsx("div",{className:"absolute -top-3 -left-3 bg-red-600 text-white text-xs font-black px-2 py-1 shadow-md -rotate-12 z-10 border-2 border-white animate-bounce",children:"NEW!"}),m.jsx("div",{className:"mb-3 aspect-video bg-slate-100 rounded overflow-hidden",children:m.jsx(WS,{images:ce.images})}),m.jsx("h3",{className:"font-bold text-lg text-slate-900 line-clamp-2 mb-2",children:ce.title}),m.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[m.jsxs("span",{className:"bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded font-bold",children:["BY: ",ce.authorName]}),ce.url&&m.jsxs("a",{href:ce.url,target:"_blank",rel:"noreferrer",onClick:ze=>ze.stopPropagation(),className:"text-blue-600 font-bold text-xs hover:underline flex items-center gap-1",children:[m.jsx(Il,{size:10})," Link"]})]}),m.jsx("p",{className:"text-slate-600 text-sm mb-4 line-clamp-3 bg-slate-50 p-2 rounded",children:ce.note||""}),m.jsxs("div",{className:"pt-4 border-t border-slate-100 flex justify-between items-end mt-auto",children:[m.jsx("div",{className:"text-xs font-bold text-red-600",children:ce.plusOnes?.length>0&&m.jsxs("span",{className:"flex items-center gap-1",children:[m.jsx(J1,{size:10,className:"fill-red-600"})," ",ce.plusOnes.length," "]})}),m.jsxs("div",{className:"flex gap-2",children:[t?.id===ce.authorId&&m.jsx("button",{onClick:ze=>{ze.stopPropagation(),G(ce)},className:"text-slate-400 hover:text-red-600 p-1",children:m.jsx(Z0,{size:16})}),m.jsx("button",{onClick:ze=>{ze.stopPropagation(),Y(ce)},className:`px-3 py-1.5 rounded-full text-sm font-black border-2 transition-all ${ce.plusOnes?.includes(t?.name)?"bg-red-100 border-red-500 text-red-600":"bg-white text-slate-400 hover:border-slate-400"}`,children:"+1"})]})]})]},ce.id))})]}),k==="misc"&&m.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:m.jsx("div",{className:"bg-white rounded-lg shadow-sm border-2 border-slate-200 overflow-hidden",children:m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"w-full text-sm text-left font-bold min-w-[500px]",children:[m.jsx("thead",{className:"bg-slate-100 text-slate-700 border-b-2 border-slate-200",children:m.jsxs("tr",{children:[m.jsx("th",{className:"px-4 py-3 whitespace-nowrap",children:""}),m.jsx("th",{className:"px-4 py-3 whitespace-nowrap",children:""}),m.jsx("th",{className:"px-4 py-3 whitespace-nowrap",children:""}),m.jsx("th",{className:"px-4 py-3 text-right whitespace-nowrap",children:""}),m.jsx("th",{className:"px-4 py-3 text-center whitespace-nowrap",children:""})]})}),m.jsx("tbody",{children:h.filter(ce=>ce.targetUserId===t?.id||t?.name==="").sort((ce,ze)=>new Date(ze.createdAt)-new Date(ce.createdAt)).map(ce=>m.jsxs("tr",{className:`border-b ${(ce.paymentStatus||"")===""?"bg-green-50/50":"hover:bg-slate-50"}`,children:[m.jsx("td",{className:"px-4 py-3 text-slate-500 font-mono text-xs",children:new Date(ce.createdAt).toLocaleDateString()}),m.jsx("td",{className:"px-4 py-3",children:ce.title}),m.jsx("td",{className:"px-4 py-3 text-slate-400 text-xs truncate max-w-[120px]",children:ce.note||"-"}),m.jsxs("td",{className:`px-4 py-3 text-right ${(ce.paymentStatus||"")===""?"text-slate-400 line-through":""}`,children:["$",ce.amount]}),m.jsx("td",{className:"px-4 py-3 text-center",children:m.jsx("span",{className:`px-2 py-1 rounded text-[10px] ${(ce.paymentStatus||"")===""?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:ce.paymentStatus||""})})]},ce.id))})]})})})}),["active","completed","shipping","closed"].includes(k)&&m.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:[k==="active"&&m.jsxs("div",{className:"mb-6 bg-white p-4 rounded-xl border-2 border-slate-900 shadow-[4px_4px_0px_0px_#7c3aed] flex items-start gap-4",children:[m.jsx("div",{className:"bg-purple-100 p-2 rounded-lg border-2 border-purple-600 shrink-0",children:m.jsx(qk,{size:20,className:"text-purple-600 fill-purple-600"})}),m.jsxs("div",{className:"flex-1",children:[m.jsx("h4",{className:"font-black text-xs uppercase tracking-tighter text-slate-400 mb-1 italic",children:"Personal Request Protocol"}),m.jsx("p",{className:"text-sm font-bold text-slate-700 leading-relaxed",children:""})]})]}),m.jsxs("div",{className:"mb-6 bg-slate-200 p-3 rounded-lg flex flex-col lg:flex-row items-center gap-4 border-2 border-slate-300",children:[m.jsxs("div",{className:"flex items-center gap-2 text-slate-500 font-bold shrink-0",children:[m.jsx(yy,{size:18}),m.jsx("span",{className:"text-sm",children:""})]}),m.jsxs("div",{className:"flex flex-wrap items-center gap-2 flex-1 w-full font-bold",children:[m.jsx("input",{type:"date",className:"border-2 border-slate-300 rounded px-2 py-1 text-xs flex-1 min-w-[120px]",value:N,onChange:ce=>z(ce.target.value)}),m.jsx("span",{className:"text-slate-400",children:"~"}),m.jsx("input",{type:"date",className:"border-2 border-slate-300 rounded px-2 py-1 text-xs flex-1 min-w-[120px]",value:H,onChange:ce=>q(ce.target.value)}),m.jsxs("div",{className:"flex items-center gap-1 bg-white border-2 border-slate-300 rounded px-2 py-1 flex-1 min-w-[160px]",children:[m.jsx(pP,{size:14,className:"text-slate-400"}),m.jsxs("select",{className:"text-xs w-full bg-transparent outline-none cursor-pointer font-black",value:A,onChange:ce=>F(ce.target.value),children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"+",children:"+"}),m.jsx("option",{value:"",children:" / "})]})]}),(N||H||A)&&m.jsx("button",{onClick:()=>{z(""),q(""),F("")},className:"text-[10px] bg-slate-400 text-white px-3 py-2 rounded hover:bg-slate-500 transition-colors uppercase font-black",children:"Reset"})]})]}),k==="active"&&t?.name!==""&&m.jsx("div",{className:"flex justify-end mb-6",children:m.jsxs("button",{onClick:()=>y("createPersonalRequest"),className:"px-6 py-2 bg-purple-600 text-white rounded border-2 border-purple-800 font-black hover:bg-purple-700 flex items-center gap-2 shadow-[4px_4px_0px_0px_#4c1d95] italic",children:[m.jsx(jm,{size:18})," "]})}),m.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:ft.map(ce=>{const ze=!!u.find(Ce=>Ce.groupId===ce.id&&Ce.userId===t?.id);return m.jsxs("div",{className:`bg-white rounded-lg p-5 border-2 border-slate-900 flex flex-col relative ${k==="closed"?"opacity-75 grayscale-[0.5]":""}`,onClick:()=>k==="active"&&Ee(ce,"group"),children:[k==="active"&&se(ce,"group")&&m.jsx("div",{className:"absolute -top-3 -left-3 bg-red-600 text-white text-xs font-black px-2 py-1 shadow-md -rotate-12 z-10 border-2 border-white animate-bounce",children:"NEW!"}),m.jsxs("div",{className:"flex flex-col gap-1 mb-2",children:[m.jsxs("div",{className:"flex flex-wrap gap-1",children:[m.jsx("span",{className:`px-2 py-0.5 text-[10px] font-black rounded border ${ce.type===""?"bg-green-600 text-white border-green-800":ce.type===""?"bg-purple-600 text-white border-purple-800":"bg-yellow-400 text-slate-900 border-slate-900"}`,children:ce.type===""?" ":ce.type===""?" ":" "}),ce.paymentStatus&&ce.paymentStatus!==""&&m.jsxs("span",{className:`px-2 py-0.5 text-[10px] font-black rounded border flex items-center gap-1
                                                        ${ce.paymentStatus===""||ce.paymentStatus===" "||ce.paymentStatus==="+ "?"bg-slate-100 text-slate-500 border-slate-300":"bg-emerald-500 text-white border-emerald-700 shadow-[2px_2px_0px_0px_rgba(5,150,105,1)] animate-pulse"}`,children:[m.jsx(tP,{size:10})," ",ce.paymentStatus]})]}),m.jsx("h3",{className:"font-black text-base",children:ce.title})]}),m.jsx("div",{className:"mb-4 aspect-video bg-slate-100 rounded overflow-hidden",children:m.jsx(WS,{images:ce.images||[]})}),m.jsxs("div",{className:"space-y-2 text-sm text-slate-600 mb-6 flex-1 font-bold",children:[m.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1",children:[m.jsx("span",{children:""}),m.jsx("span",{className:"text-red-600",children:ce.deadline})]}),ce.releaseDate&&m.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1",children:[m.jsx("span",{children:""}),m.jsx("span",{className:"text-blue-600",children:ce.releaseDate})]}),ce.infoUrl&&m.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1",children:[m.jsx("span",{children:""}),m.jsx("a",{href:ce.infoUrl,target:"_blank",rel:"noreferrer",onClick:Ce=>Ce.stopPropagation(),className:"text-blue-600 hover:underline",children:"Link"})]}),ze&&k==="active"&&m.jsx("div",{className:"mt-2 bg-green-100 text-green-700 border border-green-300 px-2 py-1 rounded text-center text-xs font-black",children:" (ORDERED)"})]}),ce.status!==""&&m.jsxs("div",{className:"mb-4",children:[m.jsx("div",{className:"flex justify-between text-[10px] text-slate-400 mb-1 font-bold",children:xx.map(Ce=>m.jsx("span",{className:ce.trackingStatus===Ce?"text-blue-600":"",children:Ce},Ce))}),m.jsx("div",{className:"h-3 bg-slate-200 rounded-full flex border border-slate-300 overflow-hidden",children:xx.map((Ce,je)=>m.jsx("div",{className:`flex-1 border-r border-white last:border-0 ${je<=xx.indexOf(ce.trackingStatus||"")?"bg-blue-600":""}`},Ce))})]}),m.jsxs("div",{className:"flex gap-2 mt-auto",children:[k==="active"&&m.jsx("button",{className:`flex-1 px-4 py-2 rounded font-black text-white border-2 transition-all ${ze?"bg-green-600 border-green-800":"bg-red-600 border-red-800"}`,onClick:Ce=>{Ce.stopPropagation(),w(ce.id),y("joinGroup")},children:ze?"":""}),m.jsx("button",{className:`px-3 py-2 rounded font-bold border-2 flex-1 ${k==="active"?"bg-white border-slate-300 text-slate-600":"bg-slate-100 border-slate-300 text-slate-700"}`,onClick:Ce=>{Ce.stopPropagation(),w(ce.id),y("viewOrders")},children:""}),["shipping","closed"].includes(k)&&m.jsx("button",{className:"px-3 py-2 rounded font-bold border-2 bg-yellow-400 border-slate-900 text-slate-900 flex-1",onClick:Ce=>{Ce.stopPropagation(),w(ce.id),y("secondPayment")},children:""})]})]},ce.id)})}),re>1&&m.jsxs("div",{className:"flex justify-center items-center gap-2 mt-8",children:[m.jsx("button",{onClick:()=>L(ce=>Math.max(1,ce-1)),className:"px-3 py-1 rounded font-black border-2 border-slate-900 bg-white",children:"PREV"}),Array.from({length:re},(ce,ze)=>ze+1).map(ce=>m.jsx("button",{onClick:()=>L(ce),className:`w-8 h-8 rounded border-2 border-slate-900 font-black ${j===ce?"bg-slate-900 text-yellow-400":"bg-white"}`,children:ce},ce)),m.jsx("button",{onClick:()=>L(ce=>Math.min(re,ce+1)),className:"px-3 py-1 rounded font-black border-2 border-slate-900 bg-white",children:"NEXT"})]})]})]}),m.jsx(xs,{isOpen:x==="wish",onClose:()=>{y(null),E(null)},title:T?"":"",children:m.jsx(a7,{onSubmit:P,onCancel:()=>{y(null),E(null)},initialData:T})}),m.jsx(xs,{isOpen:x==="createPersonalRequest",onClose:()=>y(null),title:"",children:m.jsx(s7,{onSubmit:Z,onCancel:()=>y(null)})}),m.jsx(xs,{isOpen:x==="secondPayment",onClose:()=>y(null),title:"",children:ne&&m.jsx(v3,{group:ne,orders:u.filter(ce=>ce.groupId===ne?.id),currentUser:t,onUpdate:null,isReadOnly:!0})}),m.jsx(xs,{isOpen:x==="changeName",onClose:()=>y(null),title:"",children:m.jsx(qL,{currentUser:t,onSubmit:Ve,onCancel:()=>y(null)})}),m.jsx(xs,{isOpen:x==="changePwd",onClose:()=>y(null),title:"",children:m.jsx(XL,{onSubmit:ie})}),m.jsx(xs,{isOpen:x==="changeAvatar",onClose:()=>y(null),title:"",children:m.jsx(WL,{currentUser:t,onSubmit:U})}),m.jsx(xs,{isOpen:x==="joinGroup",onClose:()=>y(null),title:`${ne?.title}`,children:ne&&m.jsx(i7,{group:ne,currentOrder:u.find(ce=>ce.groupId===ne?.id&&ce.userId===t?.id),onSubmit:ce=>oe(ce,ne.id)})}),m.jsx(xs,{isOpen:x==="viewOrders",onClose:()=>y(null),title:`${ne?.title}`,children:ne&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:`mb-4 p-3 rounded-lg border-2 font-black text-center text-sm
                            ${ne.paymentStatus===""||!ne.paymentStatus?"bg-slate-50 border-slate-200 text-slate-400":ne.paymentStatus===""||ne.paymentStatus===" "||ne.paymentStatus==="+ "?"bg-blue-50 border-blue-200 text-blue-600":"bg-emerald-50 border-emerald-500 text-emerald-700 italic"}
                        `,children:ne.paymentStatus===""||!ne.paymentStatus?"  ()":ne.paymentStatus===""||ne.paymentStatus===" "||ne.paymentStatus==="+ "?" ":` ${ne.paymentStatus}`}),m.jsx(oK,{group:ne,orders:u.filter(ce=>ce.groupId===ne?.id),currentUser:t,onEdit:ne?.status===""?()=>y("joinGroup"):null})]})})]})}const pK=()=>{const[t,e]=ee.useState(!1),[r,n]=ee.useState([]),[a,i]=ee.useState([]),[o,u]=ee.useState(null),[f,h]=ee.useState(0),p=Qm(),x=["artifacts","default-app-id","public","data","backorders"],y=["artifacts","default-app-id","public","data","groups"],b=H=>n(q=>[...q,H]),w=async()=>{try{const H=Wt(Ke,...x),q=await Sl(H),A=new Set;q.forEach(F=>{const R=F.data();R.sheetCategory&&A.add(R.sheetCategory)}),i(Array.from(A).sort())}catch(H){console.error("",H)}},T=async()=>{try{const H=Wt(Ke,...y),q=await Sl(H);h(q.size)}catch(H){console.error(H)}};ee.useEffect(()=>{w(),T()},[]);const E=async H=>{if(window.confirm(` ${H}`)){e(!0),b(`  [${H}]...`);try{const q=Wt(Ke,...x),A=Hx(q,QA("sheetCategory","==",H)),F=await Sl(A),R=qx(Ke);F.forEach(M=>R.delete(M.ref)),await R.commit(),b(" "),w()}catch(q){b(` : ${q.message}`)}finally{e(!1)}}},k=H=>{const q=H.target.files[0];q&&(u(q),n([` ${q.name}`," "]))},I=async()=>{if(!o)return;e(!0),n(q=>[...q," ..."]);const H=new FileReader;H.onload=async q=>{try{const A=q.target.result,F=Ym(A,{type:"binary"});let R=F.SheetNames.filter(O=>O.includes(""));R.length===0&&(R=F.SheetNames),b(` : ${R.join(", ")}`);const M=[];if(R.forEach(O=>{const j=F.Sheets[O],L=vs.sheet_to_json(j,{header:1});let Ne=-1,_e={};for(let ne=0;ne<L.length;ne++)if(JSON.stringify(L[ne]).includes("")){Ne=ne,L[ne].forEach((se,Ee)=>{if(typeof se!="string")return;const ie=se.trim();ie.includes("")?_e.title=Ee:ie.includes("")?_e.type=Ee:ie.includes("")||ie.includes("")?_e.orderDate=Ee:ie.includes("")?_e.rate=Ee:ie.includes("")?_e.status=Ee:ie.includes("")?_e.payProgress=Ee:ie.includes("")?_e.payStatus=Ee:ie.includes("")&&(_e.link=Ee)});break}if(Ne!==-1)for(let ne=Ne+1;ne<L.length;ne++){const se=L[ne];if(!_e.title||!se[_e.title])continue;let Ee="";se[_e.status]&&String(se[_e.status]).includes("")&&(Ee="");let ie=se[_e.orderDate],Ve=se[_e.rate];const U={title:se[_e.title],type:se[_e.type]||"",orderDate:ie||"",rate:parseFloat(Ve)||0,status:Ee,paymentStatus:`${se[_e.payProgress]||""} ${se[_e.payStatus]||""}`.trim(),link:se[_e.link]||"",sheetCategory:O,createdAt:new Date().toISOString(),isArchived:Ee===""};Object.keys(U).forEach(P=>U[P]===void 0&&delete U[P]),M.push(U)}}),M.length===0)b(" ");else{const O=Wt(Ke,...x),j=500;let L=0;for(let Ne=0;Ne<M.length;Ne+=j){const _e=M.slice(Ne,Ne+j);await Promise.all(_e.map(async ne=>{await Ti(O,ne),L++}))}b(`  ${L}  backorders`),w(),u(null),document.getElementById("file_input").value=""}}catch(A){b(` : ${A.message}`)}finally{e(!1)}},H.readAsBinaryString(o)},N=async()=>{if(window.confirm(`backordersgroups
 Groups

`)){e(!0),b("  Groups...");try{const H=Wt(Ke,...x),q=await Sl(H);if(q.empty){b(" backorders "),e(!1);return}const A=Wt(Ke,...y);let F=0;const R=q.docs.map(async M=>{const O=M.data();let j=O.rate,L=O.orderDate;(j===0||!j)&&typeof O.orderDate=="number"&&O.orderDate<1&&(j=O.orderDate,L="");let Ne="2025-12-31T23:59";typeof L=="string"&&L.includes(".")&&(Ne=L.replace(/\./g,"-")+"T23:59");const _e={title:O.title,exchangeRate:Number(j)||0,deadline:Ne,status:"",trackingStatus:O.status||"",paymentStatus:O.paymentStatus||"",type:O.type||"",infoUrl:O.link||"",createdBy:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),sheetCategory:O.sheetCategory,images:[],items:[{id:1,name:O.title,spec:"",price:"0",image:""}]};await Ti(A,_e),F++});await Promise.all(R),b(`  ${F} `),T()}catch(H){console.error(H),b(` : ${H.message}`)}finally{e(!1)}}},z=async()=>{const H=prompt(`  (Groups)


 'DELETE' `);if(H!=="DELETE"){H!==null&&alert("");return}e(!0),b("  Groups ...");try{const q=Wt(Ke,...y),A=await Sl(q);if(A.empty){b(" Groups "),e(!1);return}const F=qx(Ke);let R=0;A.forEach(M=>{F.delete(M.ref),R++}),await F.commit(),b(`  Groups ${R} `),T()}catch(q){b(` : ${q.message}`)}finally{e(!1)}};return m.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:m.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:""}),m.jsx("button",{onClick:()=>p("/"),className:"px-4 py-2 bg-white border rounded shadow-sm hover:bg-gray-50",children:" "})]}),m.jsxs("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-blue-500",children:[m.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-2 flex items-center gap-2",children:[m.jsx(Zj,{}),"  1 Excel  (Backorders)"]}),m.jsxs("div",{className:"flex gap-4 items-end",children:[m.jsx("input",{id:"file_input",type:"file",accept:".xlsx, .xls",onChange:k,disabled:t,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),m.jsx("button",{onClick:I,disabled:!o||t,className:`px-6 py-2 rounded-lg font-bold text-white ${o?"bg-blue-600 hover:bg-blue-700":"bg-gray-400"}`,children:""})]})]}),m.jsxs("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-yellow-500",children:[m.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:" 2"}),m.jsx("div",{className:"bg-gray-50 rounded-md p-4 max-h-40 overflow-y-auto mb-4",children:a.length===0?m.jsx("p",{className:"text-sm text-gray-400",children:""}):m.jsx("ul",{className:"space-y-2",children:a.map(H=>m.jsxs("li",{className:"flex justify-between items-center text-sm",children:[m.jsx("span",{children:H}),m.jsxs("button",{onClick:()=>E(H),className:"text-red-600 hover:underline flex items-center gap-1",children:[m.jsx(Z0,{size:14})," "]})]},H))})})]}),m.jsx("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-green-500",children:m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("div",{children:[m.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[m.jsx(BP,{}),"  3 (Sync to Groups)"]}),m.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[" Groups  ",m.jsx("span",{className:"font-bold text-green-600",children:f})," "]})]}),m.jsx("button",{onClick:N,disabled:t||a.length===0,className:`px-6 py-3 rounded-lg font-bold text-white shadow-lg transition-transform transform active:scale-95 ${t||a.length===0?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:" "})]})}),m.jsx("div",{className:"bg-red-50 shadow rounded-lg p-6 border-2 border-red-200",children:m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsxs("div",{children:[m.jsxs("h3",{className:"text-lg font-bold text-red-700 flex items-center gap-2",children:[m.jsx(_y,{})," "]}),m.jsx("p",{className:"text-sm text-red-600 mt-1",children:" Groups "})]}),m.jsxs("button",{onClick:z,disabled:t||f===0,className:`px-4 py-2 rounded-lg font-bold text-white shadow transition-colors ${t||f===0?"bg-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700"}`,children:["  Groups (",f,")"]})]})}),m.jsx("div",{className:"bg-black text-green-400 p-4 rounded-lg shadow h-64 overflow-y-auto font-mono text-xs leading-5",children:r.length===0?"...":r.map((H,q)=>m.jsx("div",{className:"border-b border-gray-800 pb-1 mb-1 break-all",children:H},q))})]})})},gK=({onOpenSecondPay:t})=>{const[e,r]=ee.useState([]),[n,a]=ee.useState([]),[i,o]=ee.useState(null),[u,f]=ee.useState([]),[h,p]=ee.useState(!0),[x,y]=ee.useState(!1),[b,w]=ee.useState({}),T=["artifacts","default-app-id","public","data","groups"],E=["artifacts","default-app-id","public","data","users"],k=["artifacts","default-app-id","public","data","orders"],I=async()=>{p(!0);try{const U=Wt(Ke,...T),P=Hx(U,x9("createdAt","desc")),Y=(await Sl(P)).docs.map(ye=>({id:ye.id,...ye.data()}));if(r(Y),Y.length>0){const ye=Y[0].sheetCategory||"";w({[ye]:!0})}const Z=Wt(Ke,...E),oe=await Sl(Z);a(oe.docs.map(ye=>({id:ye.id,...ye.data()})))}catch(U){console.error("",U)}finally{p(!1)}};ee.useEffect(()=>{I()},[]);const N=(U,P)=>{navigator.clipboard.writeText(U),alert(`  ${P}  ID`)},z=()=>{try{const U=[[" ()"," ()"," ()"],["","A",1200]],P=vs.aoa_to_sheet(U),G=[[" ID ()"," ()","","",""],...n.map(oe=>[oe.id,oe.name,"","",1])],Y=vs.aoa_to_sheet(G),Z=vs.book_new();vs.book_append_sheet(Z,P,""),vs.book_append_sheet(Z,Y,""),m3(Z,`Template_${i.title}.xlsx`)}catch{alert(" ")}},H=U=>{const P=U.target.files[0];if(!P)return;const G=new FileReader;G.onload=Y=>{try{const Z=Y.target.result,oe=Ym(Z,{type:"binary"}),ye=oe.Sheets.,Te=vs.sheet_to_json(ye).map((ft,ce)=>({id:`item-${Date.now()}-${ce}`,name:String(ft[" ()"]||""),spec:String(ft[" ()"]||""),price:Number(ft[" ()"]||0)})),De=oe.Sheets.,rt=vs.sheet_to_json(De),re={};rt.forEach(ft=>{const ce=ft[" ID ()"],ze=n.find(Ce=>Ce.id===String(ce));if(ze&&ft.){re[ze.id]||(re[ze.id]={id:`temp-${Date.now()}-${ze.id}`,isNew:!0,userId:ze.id,userName:ze.name,items:[]});const Ce=Te.find(je=>je.name===String(ft.)&&je.spec===String(ft.||""));Ce&&re[ze.id].items.push({itemId:Ce.id,name:Ce.name,spec:Ce.spec,price:Ce.price,quantity:Number(ft.||1)})}}),o(ft=>({...ft,items:Te})),f(Object.values(re)),alert(" ")}catch{alert(" ")}},G.readAsBinaryString(P),U.target.value=null},q=async()=>{if(i){y(!0);try{const U=Tt(Ke,...T,i.id),{id:P,...G}=i;G.updatedAt=new Date().toISOString(),G.status=G.trackingStatus===""?"":G.trackingStatus===""?"":"",G.isArchived=G.status==="",await oa(U,G);const Y=Wt(Ke,...k),Z=u.map(async oe=>{const ye=oe.items?.reduce((De,rt)=>De+Number(rt.price)*Number(rt.quantity),0)||0,Fe=Math.ceil(ye*(i.exchangeRate||0)),Te={groupId:i.id,userId:oe.userId,userName:oe.userName,items:oe.items,totalJpy:ye,totalTwd:Fe,updatedAt:new Date().toISOString()};if(oe.isNew){const{isNew:De,id:rt,...re}=Te;return re.createdAt=new Date().toISOString(),Ti(Y,re)}else return oa(Tt(Ke,...k,oe.id),Te)});await Promise.all(Z),r(oe=>oe.map(ye=>ye.id===i.id?{...ye,...G}:ye)),alert(" ")}catch{alert(" ")}finally{y(!1)}}},A=async U=>{o(U),f([]);try{const P=Wt(Ke,...k),G=Hx(P,QA("groupId","==",U.id)),Y=await Sl(G);f(Y.docs.map(Z=>({id:Z.id,...Z.data()})))}catch(P){console.error("",P)}},F=U=>U.items?.reduce((P,G)=>P+Number(G.price)*Number(G.quantity),0)||0,R=(U,P,G)=>{const Y=[...i.items];Y[U][P]=G,o({...i,items:Y})},M=()=>o({...i,items:[...i.items||[],{id:Date.now(),name:"",spec:"",price:""}]}),O=U=>o({...i,items:i.items.filter((P,G)=>G!==U)}),j=()=>f([...u,{id:`temp-${Date.now()}`,isNew:!0,userId:"",userName:"",items:[]}]),L=async U=>{window.confirm("")&&(u[U].isNew||await Am(Tt(Ke,...k,u[U].id)),f(u.filter((P,G)=>G!==U)))},Ne=(U,P)=>{const G=n.find(Z=>Z.id===P),Y=[...u];Y[U].userId=P,Y[U].userName=G?G.name:"",f(Y)},_e=U=>{const P=[...u];P[U].items.push({itemId:"",name:"",quantity:1,price:0,spec:""}),f(P)},ne=(U,P,G,Y)=>{const Z=[...u];if(G==="itemId"){const oe=i.items.find(ye=>String(ye.id)===String(Y));oe&&(Z[U].items[P]={...Z[U].items[P],itemId:oe.id,name:oe.name,price:oe.price,spec:oe.spec||""})}else Z[U].items[P][G]=Y;f(Z)},se=(U,P)=>{const G=[...u];G[U].items=G[U].items.filter((Y,Z)=>Z!==P),f(G)},Ee=async U=>{window.confirm("")&&(await Am(Tt(Ke,...T,U)),o(null),I())},ie=U=>{w(P=>({...P,[U]:!P[U]}))},Ve=ee.useMemo(()=>{const U={};return e.forEach(P=>{const G=P.sheetCategory||"";U[G]||(U[G]=[]),U[G].push(P)}),Object.keys(U).sort().reduce((P,G)=>(P[G]=U[G],P),{})},[e]);return h?m.jsx("div",{className:"p-10 text-center font-bold text-slate-400 animate-pulse italic",children:"Syncing Base..."}):m.jsxs("div",{className:"flex h-[calc(100vh-160px)] bg-gray-100 overflow-hidden text-sm rounded-2xl border-4 border-slate-900 shadow-[8px_8px_0px_0px_#0f172a]",children:[m.jsxs("div",{className:"w-1/3 md:w-1/4 bg-white border-r-4 border-slate-900 flex flex-col shrink-0",children:[m.jsxs("div",{className:"p-4 border-b-4 border-slate-900 bg-slate-900 text-white font-black uppercase flex items-center gap-2",children:[m.jsx(ST,{size:18,className:"text-yellow-400"})," Mission List"]}),m.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 bg-slate-50",children:Object.entries(Ve).map(([U,P])=>m.jsxs("div",{className:"mb-1",children:[m.jsxs("button",{onClick:()=>ie(U),className:"w-full flex items-center gap-2 p-2 text-left font-black text-slate-700 transition-colors uppercase tracking-tight",children:[b[U]?m.jsx(Uj,{size:16}):m.jsx(jk,{size:16}),m.jsx(ST,{size:16,className:b[U]?"text-yellow-500 fill-yellow-500":"text-slate-400"}),m.jsx("span",{className:"truncate flex-1 text-[10px]",children:U})]}),b[U]&&P.map(G=>m.jsxs("div",{onClick:()=>A(G),className:`group ml-4 pl-4 pr-2 py-2.5 cursor-pointer border-l-4 transition-all flex justify-between items-center rounded-r-lg ${i?.id===G.id?"bg-blue-600 border-yellow-400 text-white shadow-md":"border-slate-200 hover:bg-slate-100"}`,children:[m.jsxs("div",{className:"truncate flex-1",children:[m.jsx("div",{className:"truncate font-bold leading-tight",children:G.title}),m.jsx("div",{className:`text-[9px] font-black uppercase ${i?.id===G.id?"text-blue-100":"text-slate-400"}`,children:G.trackingStatus})]}),m.jsx("button",{onClick:Y=>{Y.stopPropagation(),t(G.id)},className:`p-1.5 rounded transition-all ${i?.id===G.id?"text-yellow-400":"text-slate-400"}`,children:m.jsx(my,{size:16})})]},G.id))]},U))})]}),m.jsx("div",{className:"flex-1 flex flex-col h-full overflow-hidden bg-white",children:i?m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"p-4 bg-white border-b-4 border-slate-900 flex flex-col gap-4 z-10",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("h2",{className:"text-xl md:text-2xl font-black flex items-center gap-2 text-slate-900 italic uppercase break-all leading-tight",children:[m.jsx(xy,{size:24,className:"text-blue-600 shrink-0"})," ",i.title]}),m.jsxs("span",{className:"text-[10px] w-fit font-black bg-slate-100 px-2 py-0.5 rounded text-slate-500 border border-slate-200 uppercase tracking-widest",children:["Folder: ",i.sheetCategory||"Unclassified"]})]}),m.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-3 pt-3 border-t-2 border-slate-50",children:[m.jsxs("button",{onClick:z,className:"flex-1 md:flex-none px-4 py-2 bg-emerald-50 text-emerald-600 rounded-lg hover:bg-emerald-100 flex items-center justify-center gap-2 border-2 border-emerald-600 border-dashed font-black text-[10px] uppercase transition-all",children:[m.jsx(Fk,{size:14})," Download Template"]}),m.jsx("input",{type:"file",id:"excel-upload",className:"hidden",accept:".xlsx, .xls",onChange:H}),m.jsxs("label",{htmlFor:"excel-upload",className:"cursor-pointer flex-1 md:flex-none px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 flex items-center justify-center gap-2 border-2 border-blue-600 border-dashed font-black text-[10px] uppercase transition-all",children:[m.jsx(hP,{size:14})," Import Excel"]}),m.jsx("div",{className:"h-8 w-[2px] bg-slate-100 mx-1 hidden md:block"}),m.jsxs("button",{onClick:()=>Ee(i.id),className:"px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 flex items-center justify-center gap-2 shadow-[4px_4px_0px_0px_#000] font-black text-[10px] uppercase transition-all active:translate-y-0.5 active:shadow-none",children:[m.jsx(Z0,{size:14})," Delete Mission"]}),m.jsx("button",{onClick:q,disabled:x,className:"px-6 py-2 bg-slate-900 text-yellow-400 rounded-lg hover:bg-slate-800 flex items-center justify-center gap-2 shadow-[4px_4px_0px_0px_#000] font-black text-[10px] uppercase tracking-widest active:translate-y-0.5 active:shadow-none transition-all",children:x?"Saving...":m.jsxs(m.Fragment,{children:[m.jsx(Ui,{size:14})," Save Mission"]})})]})]}),m.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 bg-slate-50/50",children:m.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[m.jsxs("div",{className:"bg-white p-6 rounded-xl border-2 border-slate-900 shadow-sm",children:[m.jsxs("h3",{className:"text-sm font-black mb-4 text-slate-900 border-b-2 border-slate-100 pb-2 flex items-center gap-2 uppercase italic",children:[m.jsx(lc,{size:16,className:"text-blue-600"})," Basic Intel"]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[m.jsxs("div",{className:"md:col-span-2",children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest",children:"Mission Title"}),m.jsx("input",{type:"text",value:i.title,onChange:U=>o({...i,title:U.target.value}),className:"w-full border-2 border-slate-200 p-2 rounded-lg font-bold outline-none focus:border-slate-900"})]}),m.jsxs("div",{className:"md:col-span-2",children:[m.jsx("label",{className:"block text-[10px] font-black text-blue-600 mb-1 uppercase tracking-widest",children:"Folder Name"}),m.jsx("input",{list:"category-list",type:"text",value:i.sheetCategory||"",onChange:U=>o({...i,sheetCategory:U.target.value}),className:"w-full border-2 border-blue-200 p-2 rounded-lg font-bold bg-blue-50/50 outline-none"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest",children:"Tracking Status"}),m.jsx("select",{value:i.trackingStatus||"",onChange:U=>o({...i,trackingStatus:U.target.value}),className:"w-full border-2 border-slate-200 p-2 rounded-lg font-bold bg-white",children:["","","","","","","",""].map(U=>m.jsx("option",{value:U,children:U},U))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-emerald-600 mb-1 uppercase tracking-widest",children:"Payment Status"}),m.jsx("select",{value:i.paymentStatus||"",onChange:U=>o({...i,paymentStatus:U.target.value}),className:`w-full border-2 p-2 rounded-lg font-black bg-white transition-colors ${i.paymentStatus===""?"bg-emerald-600 border-slate-900 text-white shadow-[2px_2px_0px_0px_#000]":i.paymentStatus&&i.paymentStatus!==""?"border-emerald-500 text-emerald-600":"border-slate-200"}`,children:["","","","+",""].map(U=>m.jsx("option",{value:U,children:U},U))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest",children:"Rate"}),m.jsx("input",{type:"number",step:"0.001",value:i.exchangeRate,onChange:U=>o({...i,exchangeRate:Number(U.target.value)}),className:"w-full border-2 border-slate-200 p-2 rounded-lg font-mono font-bold"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-blue-600 mb-1 uppercase tracking-widest",children:"Shipping ()"}),m.jsx("input",{type:"number",value:i.shippingFee||0,onChange:U=>o({...i,shippingFee:Number(U.target.value)}),className:"w-full border-2 border-blue-100 p-2 rounded-lg font-mono font-bold bg-blue-50/30"})]})]})]}),m.jsxs("div",{className:"bg-white p-6 rounded-xl border-2 border-slate-900 shadow-sm",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4 border-b-2 border-slate-100 pb-2",children:[m.jsxs("h3",{className:"text-sm font-black text-slate-900 flex items-center gap-2 uppercase italic",children:[m.jsx(zk,{size:16,className:"text-blue-600"})," Items List"]}),m.jsx("button",{onClick:M,className:"px-3 py-1 bg-slate-900 text-white rounded-full text-[10px] font-black uppercase hover:bg-slate-700",children:"+ Add Item"})]}),m.jsx("div",{className:"space-y-2",children:i.items?.map((U,P)=>m.jsxs("div",{className:"flex gap-2 items-center bg-slate-50 p-2 rounded-lg border border-slate-100 group",children:[m.jsx("input",{type:"text",placeholder:"Name",value:U.name,onChange:G=>R(P,"name",G.target.value),className:"flex-1 p-1.5 border-2 border-transparent bg-transparent focus:bg-white rounded text-sm font-bold"}),m.jsx("input",{type:"text",placeholder:"Spec",value:U.spec,onChange:G=>R(P,"spec",G.target.value),className:"w-24 p-1.5 border-2 border-transparent bg-transparent focus:bg-white rounded text-sm font-bold"}),m.jsxs("div",{className:"flex items-center gap-1 bg-white px-2 py-1 rounded border border-slate-200",children:[m.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:""}),m.jsx("input",{type:"number",value:U.price,onChange:G=>R(P,"price",G.target.value),className:"w-16 text-sm font-black text-blue-600 outline-none text-right"})]}),m.jsx("button",{onClick:()=>O(P),className:"text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100",children:m.jsx(ua,{size:18})})]},P))})]}),m.jsxs("div",{className:"bg-white p-6 rounded-xl border-2 border-slate-900 shadow-sm relative overflow-hidden",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4 border-b-2 border-slate-100 pb-2",children:[m.jsxs("h3",{className:"text-sm font-black text-slate-900 flex items-center gap-2 uppercase italic relative z-10",children:[m.jsx(wy,{size:16,className:"text-blue-600"})," Hero Orders"]}),m.jsx("button",{onClick:j,className:"px-3 py-1 bg-blue-600 text-white rounded-full text-[10px] font-black uppercase shadow-sm relative z-10",children:"+ New Order"})]}),m.jsx("div",{className:"space-y-4 relative z-10",children:u.map((U,P)=>{const G=Math.ceil(F(U)*(i.exchangeRate||0));return m.jsxs("div",{className:"border-2 border-slate-200 rounded-xl p-4 bg-slate-50/50 hover:border-blue-200 transition-colors",children:[m.jsxs("div",{className:"flex justify-between items-center mb-3",children:[m.jsxs("div",{className:"flex items-center gap-2",children:[m.jsxs("select",{value:U.userId,onChange:Y=>Ne(P,Y.target.value),className:"p-1.5 border-2 border-slate-200 rounded-lg font-black text-blue-600 bg-white text-xs outline-none focus:border-blue-400",children:[m.jsx("option",{value:"",children:"-- Select Member --"}),n.map(Y=>m.jsx("option",{value:Y.id,children:Y.name},Y.id))]}),U.userId&&m.jsx("button",{onClick:()=>N(U.userId,U.userName),className:"p-1.5 text-slate-400 hover:text-blue-600 transition-all transform hover:scale-110",children:m.jsx(J0,{size:14})})]}),m.jsxs("div",{className:"text-right",children:[m.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-tighter",children:"Subtotal"}),m.jsxs("div",{className:"font-black text-red-600 italic text-lg",children:["NT$ ",G.toLocaleString()]})]})]}),m.jsxs("div",{className:"pl-4 border-l-4 border-slate-200 space-y-2",children:[U.items?.map((Y,Z)=>m.jsxs("div",{className:"flex gap-2 items-center",children:[m.jsxs("select",{value:Y.itemId,onChange:oe=>ne(P,Z,"itemId",oe.target.value),className:"flex-1 p-1.5 border border-slate-200 rounded bg-white text-xs font-bold",children:[m.jsx("option",{value:"",children:"-- Choose Item --"}),i.items?.map(oe=>m.jsxs("option",{value:oe.id,children:[oe.name," (",oe.price,")"]},oe.id))]}),m.jsxs("div",{className:"flex items-center gap-1 bg-slate-200 px-2 rounded",children:[m.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"x"}),m.jsx("input",{type:"number",value:Y.quantity,onChange:oe=>ne(P,Z,"quantity",oe.target.value),className:"w-10 p-1 bg-transparent text-center font-black text-slate-700 outline-none text-xs"})]}),m.jsx("button",{onClick:()=>se(P,Z),className:"text-slate-300 hover:text-red-500",children:m.jsx(ua,{size:16})})]},Z)),m.jsxs("button",{onClick:()=>_e(P),className:"text-[10px] font-black text-blue-500 hover:text-blue-700 uppercase flex items-center gap-1 mt-2",children:[m.jsx(Yl,{size:12})," Append Item"]})]}),m.jsx("div",{className:"text-right mt-3 pt-2 border-t border-slate-200",children:m.jsx("button",{onClick:()=>L(P),className:"text-[10px] font-bold text-slate-300 hover:text-red-400 transition-colors uppercase italic",children:"Remove Order Record"})})]},U.id)})})]})]})})]}):m.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-200 bg-slate-50/30 uppercase tracking-[0.2em]",children:[m.jsx(Tp,{size:100,strokeWidth:1,className:"mb-4 opacity-20 text-slate-400"}),m.jsx("p",{className:"text-xl font-black italic text-slate-300",children:"Select Mission"})]})})]})},xK=({initialContent:t,onChange:e})=>{const r=ee.useRef(null);ee.useEffect(()=>{r.current&&r.current.innerHTML!==t&&(r.current.innerHTML=t)},[t]);const n=(o,u=null)=>{document.execCommand(o,!1,u),r.current&&e(r.current.innerHTML)},a=[{name:"Black",value:"#000000"},{name:"Red",value:"#EF4444"},{name:"Orange",value:"#F97316"},{name:"Blue",value:"#3B82F6"}],i=({onClick:o,title:u,children:f})=>m.jsx("button",{type:"button",onClick:o,title:u,className:"p-1.5 hover:bg-slate-200 rounded text-slate-600 transition-colors",children:f});return m.jsxs("div",{className:"border-2 border-slate-900 rounded-lg overflow-hidden flex flex-col h-64 bg-white shadow-sm",children:[m.jsxs("div",{className:"bg-slate-50 border-b-2 border-slate-900 p-2 flex flex-wrap gap-1 items-center",children:[m.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[m.jsx(i,{onClick:()=>n("bold"),title:"",children:m.jsx(Pj,{size:14})}),m.jsx(i,{onClick:()=>n("italic"),title:"",children:m.jsx(_P,{size:14})}),m.jsx(i,{onClick:()=>n("underline"),title:"",children:m.jsx(hM,{size:14})})]}),m.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[m.jsx(i,{onClick:()=>n("justifyLeft"),title:"",children:m.jsx(sM,{size:14})}),m.jsx(i,{onClick:()=>n("justifyCenter"),title:"",children:m.jsx(nM,{size:14})}),m.jsx(i,{onClick:()=>n("justifyRight"),title:"",children:m.jsx(tM,{size:14})})]}),m.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[m.jsx(i,{onClick:()=>n("fontSize","5"),title:"",children:m.jsx(Z1,{size:16})}),m.jsx(i,{onClick:()=>n("fontSize","3"),title:"",children:m.jsx(Z1,{size:12})}),m.jsx(i,{onClick:()=>n("fontSize","1"),title:"",children:m.jsx(Z1,{size:10})})]}),m.jsx("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:a.map(o=>m.jsx("button",{type:"button",onClick:()=>n("foreColor",o.value),className:"w-5 h-5 rounded border border-slate-300 hover:scale-110 transition-transform",style:{backgroundColor:o.value},title:o.name},o.value))}),m.jsx(i,{onClick:()=>{const o=prompt(":","http://");o&&n("createLink",o)},title:"",children:m.jsx(Om,{size:14})})]}),m.jsx("div",{className:"flex-1 p-4 focus:outline-none overflow-y-auto prose prose-slate prose-sm max-w-none",contentEditable:!0,suppressContentEditableWarning:!0,ref:r,onInput:o=>e(o.currentTarget.innerHTML)})]})},vK=["","","","","","","",""],yK=250;function _K({currentUser:t}){const[e,r]=ee.useState([]),[n,a]=ee.useState({exchangeRate:.24,totalShippingJPY:0,status:"",intlShippingTWD:0,secondPayment:{weights:{},boxWeight:0,minChargeDiff:0}}),[i,o]=ee.useState(!0),[u,f]=ee.useState(!1);ee.useEffect(()=>{const w=Tt(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),T=Tr(w,E=>{if(E.exists()){const k=E.data(),N=(k.orders||[]).sort((z,H)=>z.buyer.localeCompare(H.buyer)||z.id-H.id);r(N),a({exchangeRate:.24,totalShippingJPY:0,status:"",intlShippingTWD:0,secondPayment:{weights:{},boxWeight:0,minChargeDiff:0},...k.settings})}o(!1)});return()=>T()},[]);const h=(w,T,E)=>{r(k=>k.map(I=>I.id===w?{...I,[T]:E}:I)),f(!0)},p=async()=>{try{await Uo(Tt(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),{orders:e,settings:n,updatedAt:new Date().toISOString(),updatedBy:t?.name||""}),f(!1),alert("JF26 ")}catch(w){alert(""+w.message)}},x=(w,T,E)=>{confirm(` ${w} ${E}`)&&(r(k=>k.map(I=>I.buyer===w?{...I,[T]:E}:I)),f(!0))},y=ee.useMemo(()=>{const w=new Set;return e.filter(T=>T.isBought&&!w.has(T.name)?(w.add(T.name),!0):!1)},[e]),b=ee.useMemo(()=>e.reduce((w,T)=>T.isBought?w+T.quantity:w,0),[e]);return i?m.jsx("div",{className:"p-10 text-center font-black text-slate-400 animate-pulse",children:" JF26 ..."}):m.jsxs("div",{className:"space-y-6 p-4",children:[m.jsxs("div",{className:"bg-white p-6 rounded-2xl border-4 border-slate-900 shadow-[6px_6px_0px_0px_#0f172a]",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase",children:""}),m.jsx("select",{value:n.status,onChange:w=>{a({...n,status:w.target.value}),f(!0)},className:"w-full font-bold border-2 border-slate-200 rounded-lg px-2 py-1.5 focus:border-yellow-400 outline-none bg-white",children:vK.map(w=>m.jsx("option",{value:w,children:w},w))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase",children:""}),m.jsx("input",{type:"number",step:"0.001",value:n.exchangeRate,onChange:w=>{a({...n,exchangeRate:parseFloat(w.target.value)||0}),f(!0)},className:"w-full font-mono font-bold border-2 border-slate-200 rounded-lg py-1.5 px-3"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase",children:" (JPY)"}),m.jsx("input",{type:"number",value:n.totalShippingJPY,onChange:w=>{a({...n,totalShippingJPY:parseFloat(w.target.value)||0}),f(!0)},className:"w-full font-mono font-bold border-2 border-slate-200 rounded-lg py-1.5 px-3"})]}),m.jsx("div",{className:"flex items-end",children:m.jsxs("button",{onClick:p,disabled:!u,className:`w-full flex items-center justify-center gap-2 py-2.5 rounded-xl font-black transition-all ${u?"bg-red-500 text-white shadow-[4px_4px_0px_0px_#7f1d1d] hover:-translate-y-1":"bg-slate-100 text-slate-300 cursor-not-allowed border-2 border-slate-200"}`,children:[m.jsx(Ui,{size:18})," "]})})]}),m.jsxs("div",{className:"border-t-2 border-slate-100 pt-6",children:[m.jsxs("h3",{className:"text-sm font-black mb-4 flex items-center gap-2 uppercase italic text-blue-600",children:[m.jsx(Q0,{size:18})," JF26  (1kg = ",yK,")"]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[m.jsx("div",{className:"space-y-4",children:m.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200",children:[m.jsx("label",{className:"block text-xs font-black text-slate-500 mb-2 uppercase",children:" (kg)"}),m.jsx("input",{type:"number",step:"0.01",value:n.secondPayment.boxWeight,onChange:w=>{a({...n,secondPayment:{...n.secondPayment,boxWeight:w.target.value}}),f(!0)},className:"w-full bg-white border-2 border-slate-200 rounded-lg p-2 font-mono font-black text-blue-600"}),m.jsxs("p",{className:"text-[9px] text-slate-400 mt-2 italic",children:["*  ",b," "]})]})}),m.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200 max-h-60 overflow-y-auto",children:[m.jsx("label",{className:"block text-xs font-black text-slate-500 mb-3 uppercase tracking-tighter",children:""}),m.jsx("div",{className:"space-y-2",children:y.map(w=>m.jsxs("div",{className:"flex items-center gap-2 bg-white p-2 rounded-lg border border-slate-200 group",children:[m.jsx("span",{className:"flex-1 text-[11px] font-bold truncate text-slate-600",title:w.name,children:w.name}),m.jsxs("div",{className:"flex items-center gap-1",children:[m.jsx("input",{type:"number",step:"0.001",placeholder:"0.000",value:n.secondPayment.weights[w.name]||"",onChange:T=>{const E={...n.secondPayment.weights,[w.name]:T.target.value};a({...n,secondPayment:{...n.secondPayment,weights:E}}),f(!0)},className:"w-20 text-right font-mono font-black text-blue-600 border-b border-slate-200 outline-none text-xs"}),m.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"kg"})]})]},w.id))})]})]})]})]}),m.jsxs("div",{className:"bg-slate-900 p-5 rounded-2xl border-4 border-slate-900 shadow-[6px_6px_0px_0px_#ccc]",children:[m.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[m.jsx(Gk,{className:"text-yellow-400",size:20}),m.jsx("h4",{className:"text-white font-black italic tracking-tighter",children:"HERO  ()"})]}),m.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3",children:Array.from(new Set(e.map(w=>w.buyer))).sort().map(w=>m.jsxs("div",{className:"bg-slate-800 border border-slate-700 p-2 rounded-xl flex flex-col gap-2 transition-all hover:border-slate-500",children:[m.jsx("div",{className:"text-yellow-400 font-black text-center border-b border-slate-700 pb-1 text-sm truncate px-1",children:w}),m.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[m.jsx("button",{onClick:()=>x(w,"paymentStatus",""),className:"text-[10px] bg-green-600 text-white py-1.5 rounded font-black hover:bg-green-500 active:scale-95 transition-all",children:""}),m.jsx("button",{onClick:()=>x(w,"shippingPaymentStatus",""),className:"text-[10px] bg-purple-600 text-white py-1.5 rounded font-black hover:bg-purple-500 active:scale-95 transition-all",children:""})]})]},w))}),m.jsxs("div",{className:"mt-4 flex items-center gap-2 text-[10px] text-slate-500 font-bold italic",children:[m.jsx(lc,{size:12})," "]})]}),m.jsx("div",{className:"bg-white border-4 border-slate-900 rounded-2xl overflow-hidden shadow-[8px_8px_0px_0px_#0f172a]",children:m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"w-full text-left border-collapse",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"bg-slate-900 text-white text-[10px] uppercase font-black tracking-widest",children:[m.jsx("th",{className:"p-4 w-24",children:""}),m.jsx("th",{className:"p-4",children:""}),m.jsx("th",{className:"p-4 text-center w-20",children:""}),m.jsx("th",{className:"p-4 text-right w-28",children:"()"}),m.jsx("th",{className:"p-4 text-center w-20",children:""}),m.jsx("th",{className:"p-4 text-center w-32",children:""}),m.jsx("th",{className:"p-4 text-center w-32",children:""}),m.jsx("th",{className:"p-4 text-center w-16",children:""})]})}),m.jsx("tbody",{className:"divide-y-2 divide-slate-100 font-bold text-sm",children:e.map(w=>m.jsxs("tr",{className:`hover:bg-slate-50 transition-colors ${!w.isBought&&"bg-red-50/50 opacity-60"}`,children:[m.jsx("td",{className:"p-4 font-black text-blue-600 italic",children:w.buyer}),m.jsx("td",{className:"p-4",children:m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{className:"text-[10px] text-slate-400 uppercase",children:w.ip}),m.jsx("span",{className:"truncate max-w-[220px]",children:w.name})]})}),m.jsx("td",{className:"p-4 text-center font-mono",children:w.quantity}),m.jsx("td",{className:"p-4",children:m.jsx("input",{type:"number",value:w.price,onChange:T=>h(w.id,"price",T.target.value),className:"w-full text-right font-mono bg-transparent border-b border-dashed border-slate-300 focus:border-slate-900 outline-none"})}),m.jsx("td",{className:"p-4 text-center",children:m.jsx("input",{type:"checkbox",checked:w.isBought,onChange:T=>h(w.id,"isBought",T.target.checked),className:"w-5 h-5 accent-slate-900"})}),m.jsx("td",{className:"p-4 text-center",children:m.jsxs("select",{value:w.paymentStatus||"",onChange:T=>h(w.id,"paymentStatus",T.target.value),className:`text-[10px] font-black border-2 rounded px-2 py-1 outline-none ${w.paymentStatus===""?"bg-green-100 border-green-500 text-green-700":"bg-white border-red-300 text-red-500"}`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"",children:""})]})}),m.jsx("td",{className:"p-4 text-center",children:m.jsxs("select",{value:w.shippingPaymentStatus||"",onChange:T=>h(w.id,"shippingPaymentStatus",T.target.value),className:`text-[10px] font-black border-2 rounded px-2 py-1 outline-none ${w.shippingPaymentStatus===""?"bg-purple-100 border-purple-500 text-purple-700":"bg-slate-50 border-slate-300 text-slate-400"}`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"",children:""})]})}),m.jsx("td",{className:"p-4 text-center",children:m.jsx("button",{onClick:()=>batchUpdatePrice(w.ip,w.name,w.price),className:"p-1.5 text-slate-400 hover:text-slate-900 hover:bg-slate-200 rounded",title:"",children:m.jsx(MP,{size:14})})})]},w.id))})]})})}),u&&m.jsxs("div",{className:"fixed bottom-6 right-6 flex items-center gap-3 bg-red-600 text-white px-6 py-4 rounded-2xl shadow-2xl border-4 border-white animate-bounce z-50",children:[m.jsx(_y,{size:24}),m.jsx("span",{className:"font-black uppercase tracking-widest",children:"Unsaved Changes!"})]})]})}const bK=["","","","","","","",""],XS={titi:"",xiaomei:"",heng:"",baobao:"",yeye:"",Sjie:"S",qiaoyu:"",teacher:"",ann:"",Aurora:"Aurora"};function wK({currentUser:t}){const[e,r]=ee.useState([]),[n,a]=ee.useState({exchangeRate:.207,totalShippingJPY:0,status:"",secondPayment:{weights:{},boxWeight:0}}),[i,o]=ee.useState(!0),[u,f]=ee.useState(!1),[h,p]=ee.useState({name:"",buyer:"",price:"",quantity:1,img:"",ip:"JF26"});ee.useEffect(()=>{const E=Tt(Ke,"artifacts","default-app-id","public","data","jf26_post_calc_data","main"),k=Tr(E,I=>{if(I.exists()){const N=I.data();r(N.orders||[]),a({exchangeRate:.207,totalShippingJPY:0,status:"",secondPayment:{weights:{},boxWeight:0},...N.settings})}o(!1)});return()=>k()},[]);const x=()=>{if(!h.name||!h.buyer||!h.price){alert("");return}const E={...h,id:Date.now(),price:Number(h.price),quantity:Number(h.quantity),isBought:!0,paymentStatus:"",shippingPaymentStatus:"",createdAt:new Date().toISOString()};r(k=>[...k,E]),p({...h,name:"",price:"",quantity:1,img:""}),f(!0)},y=(E,k,I)=>{r(N=>N.map(z=>z.id===E?{...z,[k]:I}:z)),f(!0)},b=async()=>{try{await Uo(Tt(Ke,"artifacts","default-app-id","public","data","jf26_post_calc_data","main"),{orders:e,settings:n,updatedAt:new Date().toISOString()}),f(!1),alert("")}catch(E){alert(""+E.message)}},w=(E,k,I)=>{r(N=>N.map(z=>z.buyer===E?{...z,[k]:I}:z)),f(!0)},T=ee.useMemo(()=>{const E=new Set;return e.filter(k=>k.isBought&&!E.has(k.name)&&E.add(k.name))},[e]);return ee.useMemo(()=>e.reduce((E,k)=>k.isBought?E+k.quantity:E,0),[e]),i?m.jsx("div",{className:"p-10 text-center font-black text-slate-400",children:"..."}):m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"bg-white p-6 rounded-2xl border-4 border-slate-900 shadow-[6px_6px_0px_0px_#4f46e5]",children:[m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase text-indigo-600",children:""}),m.jsx("select",{value:n.status,onChange:E=>{a({...n,status:E.target.value}),f(!0)},className:"w-full font-bold border-2 border-slate-200 rounded-lg p-2 bg-white",children:bK.map(E=>m.jsx("option",{value:E,children:E},E))})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase",children:""}),m.jsx("input",{type:"number",step:"0.001",value:n.exchangeRate,onChange:E=>{a({...n,exchangeRate:parseFloat(E.target.value)||0}),f(!0)},className:"w-full font-mono font-bold border-2 border-slate-200 rounded-lg p-2"})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase",children:" (JPY)"}),m.jsx("input",{type:"number",value:n.totalShippingJPY,onChange:E=>{a({...n,totalShippingJPY:parseFloat(E.target.value)||0}),f(!0)},className:"w-full font-mono font-bold border-2 border-slate-200 rounded-lg p-2"})]}),m.jsx("div",{className:"flex items-end",children:m.jsx("button",{onClick:b,disabled:!u,className:`w-full py-2.5 rounded-xl font-black transition-all ${u?"bg-indigo-600 text-white shadow-[4px_4px_0px_0px_#1e1b4b]":"bg-slate-100 text-slate-300"}`,children:""})})]}),m.jsxs("div",{className:"border-t-2 border-slate-100 pt-6",children:[m.jsxs("h3",{className:"text-sm font-black mb-4 flex items-center gap-2 uppercase italic text-indigo-600",children:[m.jsx(Q0,{size:18})," "]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[m.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200",children:[m.jsx("label",{className:"block text-xs font-black text-slate-500 mb-2 uppercase",children:" (kg)"}),m.jsx("input",{type:"number",step:"0.01",value:n.secondPayment.boxWeight,onChange:E=>{a({...n,secondPayment:{...n.secondPayment,boxWeight:E.target.value}}),f(!0)},className:"w-full border-2 border-slate-200 rounded-lg p-2 font-mono font-black"})]}),m.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200 max-h-40 overflow-y-auto",children:[m.jsx("label",{className:"block text-xs font-black text-slate-500 mb-3 uppercase",children:" (kg)"}),m.jsx("div",{className:"space-y-2",children:T.map((E,k)=>m.jsxs("div",{className:"flex items-center gap-2 bg-white p-2 rounded-lg border",children:[m.jsx("span",{className:"flex-1 text-[11px] font-bold truncate",children:E.name}),m.jsx("input",{type:"number",step:"0.001",value:n.secondPayment.weights[E.name]||"",onChange:I=>{const N={...n.secondPayment.weights,[E.name]:I.target.value};a({...n,secondPayment:{...n.secondPayment,weights:N}}),f(!0)},className:"w-16 text-right font-mono text-xs border-b"})]},k))})]})]})]})]}),m.jsxs("div",{className:"bg-indigo-50 p-4 rounded-2xl border-4 border-dashed border-indigo-300",children:[m.jsxs("h4",{className:"text-xs font-black text-indigo-600 mb-3 uppercase flex items-center gap-1",children:[m.jsx(Yl,{size:14})," "]}),m.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-3",children:[m.jsxs("select",{className:"p-2 border-2 border-slate-900 rounded-lg font-bold text-sm bg-white",value:h.buyer,onChange:E=>p({...h,buyer:E.target.value}),children:[m.jsx("option",{value:"",children:"--  --"}),Object.values(XS).map(E=>m.jsx("option",{value:E,children:E},E))]}),m.jsx("input",{placeholder:"",className:"p-2 border-2 border-slate-900 rounded-lg font-bold text-sm",value:h.name,onChange:E=>p({...h,name:E.target.value})}),m.jsx("input",{type:"number",placeholder:"",className:"p-2 border-2 border-slate-900 rounded-lg font-bold text-sm",value:h.price,onChange:E=>p({...h,price:E.target.value})}),m.jsx("input",{type:"number",placeholder:"",className:"p-2 border-2 border-slate-900 rounded-lg font-bold text-sm",value:h.quantity,onChange:E=>p({...h,quantity:E.target.value})}),m.jsx("input",{placeholder:"",className:"p-2 border-2 border-slate-900 rounded-lg font-bold text-sm",value:h.img,onChange:E=>p({...h,img:E.target.value})}),m.jsx("button",{onClick:x,className:"bg-indigo-600 text-white font-black rounded-lg border-2 border-slate-900 flex items-center justify-center gap-2 hover:bg-indigo-700 transition-all shadow-[2px_2px_0px_0px_#000]",children:""})]})]}),m.jsxs("div",{className:"bg-slate-900 p-5 rounded-2xl border-4 border-slate-900 shadow-[6px_6px_0px_0px_#ccc]",children:[m.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[m.jsx(Gk,{className:"text-yellow-400",size:20}),m.jsx("h4",{className:"text-white font-black italic",children:"HERO "})]}),m.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3",children:Array.from(new Set(e.map(E=>E.buyer))).sort().map(E=>m.jsxs("div",{className:"bg-slate-800 border border-slate-700 p-2 rounded-xl flex flex-col gap-2",children:[m.jsx("div",{className:"text-yellow-400 font-black text-center border-b border-slate-700 pb-1 text-sm",children:E}),m.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[m.jsx("button",{onClick:()=>w(E,"paymentStatus",""),className:"text-[10px] bg-green-600 text-white py-1 rounded font-black hover:bg-green-500 transition-colors",children:""}),m.jsx("button",{onClick:()=>w(E,"shippingPaymentStatus",""),className:"text-[10px] bg-purple-600 text-white py-1 rounded font-black hover:bg-purple-500 transition-colors",children:""})]})]},E))})]}),m.jsx("div",{className:"bg-white border-4 border-slate-900 rounded-2xl overflow-hidden shadow-[8px_8px_0px_0px_#0f172a]",children:m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"w-full text-left text-sm border-collapse",children:[m.jsx("thead",{className:"bg-slate-900 text-white text-[10px] font-black uppercase tracking-widest",children:m.jsxs("tr",{children:[m.jsx("th",{className:"p-4",children:""}),m.jsx("th",{className:"p-4",children:""}),m.jsx("th",{className:"p-4 text-center",children:""}),m.jsx("th",{className:"p-4 text-center",children:""}),m.jsx("th",{className:"p-4 text-center",children:""})]})}),m.jsx("tbody",{className:"font-bold divide-y-2 divide-slate-50",children:e.map(E=>m.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[m.jsx("td",{className:"p-4",children:m.jsx("select",{value:E.buyer,onChange:k=>y(E.id,"buyer",k.target.value),className:"bg-transparent font-black text-indigo-600 outline-none cursor-pointer",children:Object.values(XS).map(k=>m.jsx("option",{value:k,children:k},k))})}),m.jsx("td",{className:"p-4",children:m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("img",{src:E.img||"https://placehold.co/40x40?text=JF",className:"w-10 h-10 rounded border-2 border-slate-900 object-cover",alt:""}),m.jsxs("div",{children:[m.jsx("div",{className:"truncate w-40 text-slate-800",children:E.name}),m.jsxs("div",{className:"text-[10px] text-slate-400",children:["",E.price," x ",E.quantity]})]})]})}),m.jsx("td",{className:"p-4 text-center",children:m.jsxs("select",{value:E.paymentStatus,onChange:k=>y(E.id,"paymentStatus",k.target.value),className:`text-[10px] p-1 border-2 rounded font-black ${E.paymentStatus===""?"bg-green-50 border-green-500 text-green-700":"bg-white border-red-200 text-red-500"}`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"",children:""})]})}),m.jsx("td",{className:"p-4 text-center",children:m.jsxs("select",{value:E.shippingPaymentStatus,onChange:k=>y(E.id,"shippingPaymentStatus",k.target.value),className:`text-[10px] p-1 border-2 rounded font-black ${E.shippingPaymentStatus===""?"bg-purple-50 border-purple-500 text-purple-700":"bg-white border-slate-200 text-slate-400"}`,children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"",children:""})]})}),m.jsx("td",{className:"p-4 text-center",children:m.jsx("button",{onClick:()=>r(e.filter(k=>k.id!==E.id))||f(!0),className:"text-slate-300 hover:text-red-500 transition-colors",children:m.jsx(Z0,{size:16})})})]},E.id))})]})})}),u&&m.jsxs("div",{className:"fixed bottom-10 right-10 flex items-center gap-3 bg-red-600 text-white px-8 py-4 rounded-2xl shadow-2xl border-4 border-white animate-bounce z-50 font-black italic",children:[m.jsx(_y,{size:24})," UNSAVED CHANGES!"]})]})}const EK={titi:"",xiaomei:"",heng:"",baobao:"",yeye:"",Sjie:"S",qiaoyu:"",teacher:"",ann:"",Aurora:"Aurora"};function TK(){const[t,e]=ee.useState(Array.from({length:10},(h,p)=>({id:`order_${p+1}`,index:p+1}))),[r,n]=ee.useState({totalDomesticShipping:0,exchangeRate:.24}),[a,i]=ee.useState(null);ee.useEffect(()=>{const h=Tr(Wt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders"),x=>{const y={};x.docs.forEach(b=>{y[b.id]=b.data()}),e(b=>b.map(w=>({...w,...y[w.id]||{items:[]}})))}),p=Tr(Tt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_settings","main"),x=>{x.exists()&&n(x.data())});return()=>{h(),p()}},[]);const o=async()=>{try{await Uo(Tt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_settings","main"),r),alert("JCS ")}catch{alert("")}},u=async()=>{const h=prompt(" JCS Excel  (ID >  >  >  > )");if(h)try{const p=h.split(`
`).filter(b=>b.trim()!==""),x={};p.forEach(b=>{const[w,T,E,k,I]=b.split("	");if(!w||!T)return;const N=w.trim();x[N]||(x[N]={items:[]}),x[N].items.push({name:T.trim(),qty:parseInt(E)||1,price:parseInt(k)||0,status:(I||"PENDING").trim().toUpperCase(),assignedTo:""})});const y=qx(Ke);Object.entries(x).forEach(([b,w])=>{const T=Tt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders",b);y.set(T,w,{merge:!0})}),await y.commit(),alert("JCS ")}catch(p){alert(""+p.message)}},f=h=>h==="WON"?"bg-green-100 text-green-700 border-green-200":h==="LOST"?"bg-slate-100 text-slate-400 border-slate-200 grayscale opacity-70":"bg-white text-slate-900 border-slate-200";return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"bg-white p-6 rounded-2xl border-4 border-slate-900 shadow-[6px_6px_0px_0px_#0f172a] space-y-6",children:[m.jsxs("div",{className:"flex justify-between items-center border-b-2 pb-4",children:[m.jsxs("h2",{className:"text-2xl font-black italic text-slate-800 flex items-center gap-2",children:[m.jsx(Sp,{className:"text-purple-600"})," JCS "]}),m.jsxs("button",{onClick:u,className:"px-4 py-2 bg-slate-900 text-yellow-400 rounded-xl font-black flex items-center gap-2 hover:bg-slate-800 transition-all border-2 border-slate-900 shadow-[3px_3px_0px_0px_#ccc]",children:[m.jsx(aP,{size:18}),"  Excel"]})]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[m.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200",children:[m.jsx("label",{className:"block text-xs font-black text-slate-500 mb-2 uppercase",children:"JCS  (JPY)"}),m.jsx("input",{type:"number",className:"w-full font-mono font-bold border-2 border-slate-200 rounded-lg py-2 px-3 focus:border-purple-500 outline-none",value:r.totalDomesticShipping,onChange:h=>n({...r,totalDomesticShipping:Number(h.target.value)})})]}),m.jsxs("div",{className:"bg-yellow-50 p-4 rounded-xl border-2 border-yellow-200",children:[m.jsx("label",{className:"block text-xs font-black text-yellow-700 mb-2 uppercase",children:"JCS "}),m.jsx("input",{type:"number",step:"0.001",className:"w-full font-mono font-bold border-2 border-yellow-200 rounded-lg py-2 px-3 focus:border-yellow-500 outline-none bg-white text-yellow-800",value:r.exchangeRate||.24,onChange:h=>n({...r,exchangeRate:parseFloat(h.target.value)})})]})]}),m.jsx("div",{className:"flex justify-end pt-4 border-t-2 border-slate-100",children:m.jsxs("button",{onClick:o,className:"bg-purple-600 text-white px-8 py-3 rounded-xl font-black shadow-[4px_4px_0px_0px_#4c1d95] hover:-translate-y-1 hover:shadow-[6px_6px_0px_0px_#4c1d95] transition-all flex items-center gap-2",children:[m.jsx(Ui,{size:18})," "]})})]}),m.jsx(SK,{orders:t,onSave:async(h,p)=>{await Uo(Tt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders",h),{items:p},{merge:!0})}}),m.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(h=>m.jsxs("div",{className:"bg-white rounded-xl border-4 border-slate-900 overflow-hidden shadow-[4px_4px_0px_0px_#6b21a8]",children:[m.jsxs("div",{className:"bg-slate-900 text-white px-4 py-3 flex justify-between items-center",children:[m.jsxs("h4",{className:"font-black italic text-lg flex items-center gap-2",children:["ORDER #",h.index]}),m.jsxs("button",{onClick:()=>i(h),className:"text-xs bg-slate-700 px-2 py-1 rounded flex items-center gap-1 hover:bg-slate-600 transition-colors",children:[m.jsx(xy,{size:12})," "]})]}),m.jsx("div",{className:"p-4 min-h-[120px] space-y-2",children:h.items?.length>0?h.items.map((p,x)=>m.jsxs("div",{className:`p-2 rounded border-2 text-xs font-bold ${f(p.status)}`,children:[m.jsxs("div",{className:"flex justify-between",children:[m.jsx("span",{className:"truncate w-32",children:p.name}),m.jsxs("span",{children:["",p.price*p.qty]})]}),p.assignments?.length>0&&m.jsx("div",{className:"mt-1 pt-1 border-t border-dashed border-slate-300 flex flex-wrap gap-1",children:p.assignments.map((y,b)=>m.jsxs("span",{className:"bg-white/50 px-1 rounded text-[9px]",children:[y.user,": ",y.qty]},b))})]},x)):m.jsx("div",{className:"text-slate-300 text-center py-6",children:""})})]},h.id))}),m.jsx(xs,{isOpen:!!a,onClose:()=>i(null),title:` JCS  #${a?.index}`,children:a&&m.jsx(AK,{initialData:a,onSubmit:async h=>{await Uo(Tt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders",a.id),h),i(null)},onCancel:()=>i(null)})})]})}function SK({orders:t,onSave:e}){const r=t.flatMap(o=>(o.items||[]).map((u,f)=>({...u,orderId:o.id,orderIndex:o.index,originalIdx:f})).filter(u=>u.status==="WON")),n=(o,u,f=[])=>{const h=[...f,{user:"",qty:1}];i(o,u,h)},a=(o,u,f,h,p,x)=>{const y=[...x];y[f][h]=p,i(o,u,y)},i=(o,u,f)=>{const p=[...t.find(x=>x.id===o).items];p[u]={...p[u],assignments:f},e(o,p)};return r.length===0?null:m.jsxs("div",{className:"bg-purple-50 border-4 border-slate-900 rounded-2xl overflow-hidden shadow-[6px_6px_0px_0px_#0f172a]",children:[m.jsxs("div",{className:"bg-purple-600 text-white px-6 py-3 flex items-center gap-2",children:[m.jsx(Ep,{size:20}),m.jsx("h3",{className:"font-black italic",children:"JCS  ()"})]}),m.jsx("div",{className:"p-4 overflow-x-auto",children:m.jsxs("table",{className:"w-full text-left border-collapse",children:[m.jsx("thead",{children:m.jsxs("tr",{className:"text-xs uppercase font-black text-purple-700 border-b-2 border-purple-200",children:[m.jsx("th",{className:"py-2 px-2",children:""}),m.jsx("th",{className:"py-2 px-2",children:" ()"}),m.jsx("th",{className:"py-2 px-2",children:" ( / )"}),m.jsx("th",{className:"py-2 px-2",children:""})]})}),m.jsx("tbody",{className:"divide-y divide-purple-100",children:r.map((o,u)=>{const f=o.assignments?.reduce((p,x)=>p+(Number(x.qty)||0),0)||0,h=f>o.qty;return m.jsxs("tr",{className:"bg-white/50 hover:bg-white transition-colors text-sm",children:[m.jsxs("td",{className:"py-3 px-2 font-mono font-bold text-slate-400",children:["#",o.orderIndex]}),m.jsxs("td",{className:"py-3 px-2",children:[m.jsx("div",{className:"font-bold text-slate-800",children:o.name}),m.jsxs("div",{className:"text-[10px] text-slate-500",children:[": ",m.jsx("span",{className:"font-black",children:o.qty})," | : ",m.jsx("span",{className:h?"text-red-500":"text-green-600",children:f})]})]}),m.jsx("td",{className:"py-3 px-2",children:m.jsx("div",{className:"flex flex-wrap gap-2",children:o.assignments?.map((p,x)=>m.jsxs("div",{className:"flex items-center gap-1 bg-white border border-slate-300 rounded p-1 shadow-sm",children:[m.jsxs("select",{className:"text-xs font-bold border-none p-0 bg-transparent outline-none",value:p.user,onChange:y=>a(o.orderId,o.originalIdx,x,"user",y.target.value,o.assignments),children:[m.jsx("option",{value:"",children:""}),Object.values(EK).map(y=>m.jsx("option",{value:y,children:y},y))]}),m.jsx("input",{type:"number",className:"w-10 text-xs font-bold border-l pl-1 outline-none",value:p.qty,onChange:y=>a(o.orderId,o.originalIdx,x,"qty",parseInt(y.target.value),o.assignments)}),m.jsx("button",{onClick:()=>{const y=o.assignments.filter((b,w)=>w!==x);i(o.orderId,o.originalIdx,y)},className:"text-slate-300 hover:text-red-500",children:m.jsx(ua,{size:12})})]},x))})}),m.jsx("td",{className:"py-3 px-2 text-right",children:m.jsxs("button",{onClick:()=>n(o.orderId,o.originalIdx,o.assignments),className:"text-[10px] bg-slate-900 text-white px-2 py-1 rounded font-black hover:bg-purple-700 transition-colors flex items-center gap-1",children:[m.jsx(Yl,{size:12})," "]})})]},`${o.orderId}-${o.originalIdx}`)})})]})})]})}function AK({initialData:t,onSubmit:e,onCancel:r}){const[n,a]=ee.useState(t.items||[]),i=(o,u,f)=>{const h=[...n];h[o][u]=f,a(h)};return m.jsxs("form",{onSubmit:o=>{o.preventDefault(),e({items:n})},className:"space-y-4",children:[m.jsx("div",{className:"max-h-[50vh] overflow-y-auto space-y-3 p-1",children:n.map((o,u)=>m.jsxs("div",{className:"bg-slate-50 p-3 rounded border-2 border-slate-200 relative space-y-2",children:[m.jsx("button",{type:"button",onClick:()=>a(n.filter((f,h)=>h!==u)),className:"absolute top-1 right-1 text-slate-400 hover:text-red-500",children:m.jsx(ua,{size:16})}),m.jsx("input",{className:"w-full text-sm font-bold border rounded p-1",value:o.name,onChange:f=>i(u,"name",f.target.value),placeholder:"",required:!0}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[m.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:"QTY:"}),m.jsx("input",{type:"number",className:"w-full text-sm border rounded p-1 font-mono",value:o.qty,onChange:f=>i(u,"qty",parseInt(f.target.value))})]}),m.jsxs("div",{className:"flex-1 flex items-center gap-1",children:[m.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:"JPY:"}),m.jsx("input",{type:"number",className:"w-full text-sm border rounded p-1 font-mono",value:o.price,onChange:f=>i(u,"price",parseInt(f.target.value))})]})]}),m.jsx("div",{className:"flex gap-2",children:["PENDING","WON","LOST"].map(f=>m.jsx("button",{type:"button",onClick:()=>i(u,"status",f),className:`flex-1 py-1 rounded text-[10px] font-black border ${o.status===f?"bg-slate-900 text-white":"bg-white text-slate-400 border-slate-200"}`,children:f==="WON"?"":f==="LOST"?"":""},f))})]},u))}),m.jsx("button",{type:"button",onClick:()=>a([...n,{name:"",qty:1,price:0,status:"PENDING",assignments:[]}]),className:"w-full py-2 bg-slate-100 border-2 border-dashed border-slate-300 rounded font-bold text-slate-500 hover:bg-slate-200",children:"+ "}),m.jsxs("div",{className:"flex justify-end gap-2 border-t pt-4",children:[m.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded font-bold text-slate-500 border",children:""}),m.jsx("button",{type:"submit",className:"px-6 py-2 bg-slate-900 text-white rounded font-bold",children:""})]})]})}const kK=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=800,u=800;let f=a.width,h=a.height;f>h?f>o&&(h*=o/f,f=o):h>u&&(f*=u/h,h=u),i.width=f,i.height=h,i.getContext("2d").drawImage(a,0,0,f,h),e(i.toDataURL("image/jpeg",.7))}}});function NK({onSubmit:t,onCancel:e,initialData:r=null,submitLabel:n=""}){const[a,i]=ee.useState(r?.title||""),[o,u]=ee.useState(r?.type||""),[f,h]=ee.useState(()=>r?.images?.filter(M=>M.startsWith("http"))?.join(", ")||""),[p,x]=ee.useState(()=>r?.images?.filter(M=>M.startsWith("data:"))||[]),[y,b]=ee.useState(r?.infoUrl||""),[w,T]=ee.useState(()=>r?.deadline?r.deadline.slice(0,16):""),[E,k]=ee.useState(r?.releaseDate||""),[I,N]=ee.useState(r?.items||[{id:1,name:"",spec:"",price:"",limit:"",image:""}]),z=()=>N([...I,{id:Date.now(),name:"",spec:"",price:"",limit:"",image:""}]),H=(M,O,j)=>N(I.map(L=>L.id===M?{...L,[O]:j}:L)),q=M=>I.length>1?N(I.filter(O=>O.id!==M)):N([{id:Date.now(),name:"",spec:"",price:"",limit:"",image:""}]),A=(M,O)=>{const j=[...I];O==="up"&&M>0&&([j[M-1],j[M]]=[j[M],j[M-1]]),O==="down"&&M<j.length-1&&([j[M+1],j[M]]=[j[M],j[M+1]]),N(j)},F=async M=>{if(M.target.files){const O=Array.from(M.target.files),j=await Promise.all(O.map(L=>kK(L)));x(L=>[...L,...j]),M.target.value=null}},R=()=>{if(!a||!w)return alert("");const M=I.filter(j=>j.name&&j.price);if(M.length===0)return alert("/");const O=f.split(",").map(j=>j.trim()).filter(j=>j);t({title:a,type:o,images:[...O,...p],infoUrl:y,deadline:w,releaseDate:E,items:M})};return m.jsxs("form",{onSubmit:M=>{M.preventDefault(),R()},className:"space-y-4",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(zk,{size:16}),"  ()"]}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:a,onChange:M=>i(M.target.value),placeholder:" 6  BD ",required:!0})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(J0,{size:16})," "]}),m.jsxs("div",{className:"flex gap-2 text-xs sm:text-sm",children:[m.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg py-2 px-1 text-center font-black transition-all ${o===""?"bg-slate-900 text-yellow-400 border-slate-900 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[m.jsx("input",{type:"radio",className:"hidden",name:"groupType",value:"",checked:o==="",onChange:()=>u("")})," "]}),m.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg py-2 px-1 text-center font-black transition-all ${o===""?"bg-green-600 text-white border-green-800 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[m.jsx("input",{type:"radio",className:"hidden",name:"groupType",value:"",checked:o==="",onChange:()=>u("")})," "]})]})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(K0,{size:16}),"  ()"]}),m.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 text-sm h-16 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:f,onChange:M=>h(M.target.value),placeholder:" ()"})]}),m.jsxs("div",{className:"flex flex-col gap-2 p-3 border-2 border-dashed border-slate-300 rounded-lg bg-slate-100",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 flex items-center gap-2",children:[m.jsx(by,{size:16})," "]}),m.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:F,className:"block w-full text-sm text-slate-700 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-2 file:border-red-800 file:text-xs file:font-black file:bg-red-600 file:text-white hover:file:bg-red-700 cursor-pointer"}),p.length>0&&m.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 pb-4",children:p.map((M,O)=>m.jsxs("div",{className:"relative shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 border-slate-900 shadow",children:[m.jsx("img",{src:M,className:"w-full h-full object-cover",alt:"preview"}),m.jsx("button",{type:"button",onClick:()=>x(j=>j.filter((L,Ne)=>Ne!==O)),className:"absolute top-0 right-0 bg-red-600 text-white rounded-full p-1 transform translate-x-1/3 -translate-y-1/3 border-2 border-white hover:bg-red-700 transition-all",children:m.jsx(ua,{size:12})})]},O))})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(Om,{size:16})," / ()"]}),m.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:y,onChange:M=>b(M.target.value),placeholder:"https://shueisha.co.jp/..."})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[m.jsx(Fk,{size:16})," / ()"]}),m.jsx("input",{type:"datetime-local",className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:w,onChange:M=>T(M.target.value),required:!0})]}),m.jsxs("div",{className:"flex flex-col gap-1",children:[m.jsx("label",{className:"text-sm font-black italic text-slate-900 mb-1",children:" ()"}),m.jsx("input",{type:"date",className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:E,onChange:M=>k(M.target.value)})]})]}),m.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border-2 border-slate-300",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4 flex-wrap gap-2",children:[m.jsx("h4",{className:"font-black italic text-lg text-slate-900 transform -skew-x-3",children:o===""?" (ITEMS)":" (ITEMS)"}),m.jsx("button",{type:"button",onClick:z,className:"text-sm font-black px-3 py-1 bg-yellow-400 text-slate-900 rounded border-2 border-slate-900 hover:bg-yellow-500 transition-all",children:"+ "})]}),m.jsx("div",{className:"space-y-4",children:I.map((M,O)=>m.jsxs("div",{className:"bg-white p-3 rounded-lg border-2 border-slate-900 relative flex gap-3 items-start shadow-[2px_2px_0px_0px_rgba(15,23,42,1)]",children:[m.jsxs("div",{className:"flex flex-col gap-1 justify-center pt-1",children:[m.jsxs("span",{className:"text-xl font-black text-red-600 italic leading-none",children:[O+1,"."]}),m.jsx("button",{type:"button",onClick:()=>A(O,"up"),disabled:O===0,className:"text-slate-400 hover:text-blue-600 disabled:opacity-30 p-0.5",children:m.jsx(Fj,{size:16})}),m.jsx("button",{type:"button",onClick:()=>A(O,"down"),disabled:O===I.length-1,className:"text-slate-400 hover:text-blue-600 disabled:opacity-30 p-0.5",children:m.jsx(dy,{size:16})})]}),m.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-2",children:[m.jsx("div",{className:"col-span-12 sm:col-span-7",children:m.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm bg-slate-50 focus:bg-white focus:ring-2 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:"",value:M.name,onChange:j=>H(M.id,"name",j.target.value),required:!0})}),m.jsxs("div",{className:"col-span-12 sm:col-span-5 relative",children:[m.jsx("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-slate-400",children:m.jsx(Om,{size:14})}),m.jsx("input",{className:"w-full border-2 border-slate-300 p-2 pl-7 rounded text-sm text-slate-700 focus:ring-2 focus:ring-yellow-400",placeholder:"",value:M.image||"",onChange:j=>H(M.id,"image",j.target.value)}),M.image&&m.jsx("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 w-6 h-6 rounded border-2 border-slate-900 bg-slate-100 overflow-hidden shadow",children:m.jsx("img",{src:M.image,className:"w-full h-full object-cover",onError:j=>j.target.style.display="none"})})]}),m.jsx("div",{className:"col-span-6 sm:col-span-5",children:m.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400",placeholder:"",value:M.spec,onChange:j=>H(M.id,"spec",j.target.value)})}),m.jsx("div",{className:"col-span-3 sm:col-span-4",children:m.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400 font-black text-red-600",type:"number",placeholder:"",value:M.price,onChange:j=>H(M.id,"price",j.target.value),required:!0})}),m.jsx("div",{className:"col-span-3 sm:col-span-3",children:m.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400",type:"number",placeholder:"",value:M.limit,onChange:j=>H(M.id,"limit",j.target.value)})})]}),m.jsx("button",{type:"button",onClick:()=>q(M.id),className:"text-red-600 hover:text-red-800 p-1 mt-1 shrink-0",children:m.jsx(ua,{size:18})})]},M.id))})]}),m.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[m.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[m.jsx(ua,{size:16,className:"inline mr-1"})," "]}),m.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-slate-900 text-yellow-400 border-2 border-slate-900 hover:bg-slate-700 font-black italic shadow-[4px_4px_0px_0px_#FACC15] active:translate-y-0.5 active:shadow-none transition-all",children:[m.jsx(Ui,{size:16,className:"inline mr-1"})," ",n]})]})]})}function CK({currentUser:t}){const e=Qm(),[r,n]=ee.useState("groups"),[a,i]=ee.useState("pre_order"),[o,u]=ee.useState(""),[f,h]=ee.useState([]),[p,x]=ee.useState([]),[y,b]=ee.useState([]),[w,T]=ee.useState([]),[E,k]=ee.useState(!1),[I,N]=ee.useState({title:"",amount:"",targetUserId:"",paymentStatus:""}),[z,H]=ee.useState(null),q=t?.name===""||t?.id==="yeye",A=y.find(O=>O.id===z);if(ee.useEffect(()=>{if(!q)return;const O=Tr(Tt(Ke,"artifacts","default-app-id","public","data","system","bulletin"),ne=>{ne.exists()&&u(ne.data().content)}),j=Tr(Wt(Ke,"artifacts","default-app-id","public","data","miscCharges"),ne=>h(ne.docs.map(se=>({id:se.id,...se.data()})))),L=Tr(Wt(Ke,"artifacts","default-app-id","public","data","users"),ne=>x(ne.docs.map(se=>({id:se.id,...se.data()})))),Ne=Tr(Wt(Ke,"artifacts","default-app-id","public","data","groups"),ne=>b(ne.docs.map(se=>({id:se.id,...se.data()})))),_e=Tr(Wt(Ke,"artifacts","default-app-id","public","data","orders"),ne=>T(ne.docs.map(se=>({id:se.id,...se.data()}))));return()=>{O(),j(),L(),Ne(),_e()}},[q]),!q)return null;const F=async()=>{try{await oa(Tt(Ke,"artifacts","default-app-id","public","data","system","bulletin"),{content:o}),alert("")}catch{alert("")}},R=async()=>{if(!I.title||!I.amount||!I.targetUserId)return alert("");const O=p.find(j=>j.id===I.targetUserId);await Ti(Wt(Ke,"artifacts","default-app-id","public","data","miscCharges"),{...I,amount:Number(I.amount),targetUserName:O?.name||"Unknown",createdAt:new Date().toISOString()}),N({title:"",amount:"",targetUserId:"",paymentStatus:""})},M=()=>m.jsxs("div",{className:"space-y-8 animate-in fade-in slide-in-from-bottom-4",children:[m.jsx("div",{className:"flex flex-wrap justify-start gap-4 mb-4",children:[{id:"pre_order",label:"JS  ()",icon:Fm},{id:"post_order",label:"JS  ()",icon:Tp},{id:"jcs_lottery",label:"JCS ",icon:Sp}].map(O=>m.jsxs("button",{onClick:()=>i(O.id),className:`flex items-center gap-3 px-6 py-3 font-black italic text-base transition-all duration-200 rounded-xl border-4 ${a===O.id?"bg-slate-900 text-yellow-400 border-slate-900 shadow-[6px_6px_0px_0px_#FACC15]":"bg-white text-slate-400 border-slate-200 hover:border-slate-400 hover:text-slate-600"}`,children:[m.jsx(O.icon,{size:18}),O.label]},O.id))}),m.jsxs("div",{className:"bg-white/50 p-1 rounded-2xl",children:[a==="pre_order"&&m.jsx(_K,{currentUser:t}),a==="post_order"&&m.jsx(wK,{}),a==="jcs_lottery"&&m.jsx(TK,{})]})]});return m.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col font-sans",children:[m.jsx("header",{className:"bg-slate-900 text-white shadow-md z-50 sticky top-0",children:m.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center gap-4",children:[m.jsxs("div",{className:"flex items-center gap-4",children:[m.jsxs("button",{onClick:()=>e("/"),className:"text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[m.jsx(Ok,{size:20}),m.jsx("span",{className:"hidden sm:inline",children:""})]}),m.jsx("h1",{className:"text-xl font-black italic border-l border-gray-700 pl-4 text-yellow-400 tracking-tighter",children:"HERO OPS CENTER"})]}),m.jsx("nav",{className:"flex flex-wrap justify-center gap-2 bg-slate-800 p-1.5 rounded-xl",children:[{id:"groups",label:"",icon:TP},{id:"misc",label:"",icon:Lk},{id:"jf26_all",label:"JF26 ",icon:Fm},{id:"import",label:"Excel ",icon:Mk},{id:"bulletin",label:"",icon:Uk},{id:"users",label:"",icon:gM}].map(O=>m.jsxs("button",{onClick:()=>n(O.id),className:`flex items-center gap-2 px-5 py-2.5 rounded-lg text-sm font-black transition-all ${r===O.id?"bg-yellow-400 text-slate-900 shadow-lg scale-105":"text-gray-400 hover:text-white hover:bg-slate-700"}`,children:[m.jsx(O.icon,{size:16})," ",O.label]},O.id))})]})}),m.jsx("main",{className:"flex-1 p-4 sm:p-8",children:m.jsxs("div",{className:"max-w-7xl mx-auto",children:[r==="groups"&&m.jsxs("div",{className:"space-y-4",children:[m.jsxs("div",{className:"flex justify-between items-center",children:[m.jsx("h2",{className:"text-2xl font-black italic",children:""}),m.jsxs("button",{onClick:()=>k(!0),className:"px-6 py-2 bg-slate-900 text-white rounded font-black hover:bg-slate-700 shadow-[4px_4px_0px_0px_#FACC15] transition-all italic flex items-center gap-2",children:[m.jsx(Yl,{size:18}),""]})]}),m.jsx(gK,{onOpenSecondPay:H})]}),r==="jf26_all"&&m.jsx(M,{}),r==="misc"&&m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:"bg-white p-6 rounded-lg shadow border-4 border-slate-900",children:[m.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2 text-slate-700 italic",children:[m.jsx(Yl,{className:"text-green-600"})," "]}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:""}),m.jsxs("select",{className:"w-full border-2 border-slate-200 p-2 rounded font-bold",value:I.targetUserId,onChange:O=>N({...I,targetUserId:O.target.value}),children:[m.jsx("option",{value:"",children:"--  --"}),p.map(O=>m.jsx("option",{value:O.id,children:O.name},O.id))]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:""}),m.jsx("input",{type:"text",className:"w-full border-2 border-slate-200 p-2 rounded font-bold",placeholder:"/",value:I.title,onChange:O=>N({...I,title:O.target.value})})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:" (TWD)"}),m.jsx("input",{type:"number",className:"w-full border-2 border-slate-200 p-2 rounded font-bold",placeholder:"0",value:I.amount,onChange:O=>N({...I,amount:O.target.value})})]}),m.jsx("button",{onClick:R,className:"bg-slate-900 text-yellow-400 p-2.5 rounded font-black hover:bg-slate-800 transition-colors",children:""})]})]}),m.jsx("div",{className:"bg-white rounded-lg shadow border-4 border-slate-900 overflow-hidden",children:m.jsxs("table",{className:"w-full text-sm text-left font-bold",children:[m.jsx("thead",{className:"bg-slate-900 text-white border-b",children:m.jsxs("tr",{children:[m.jsx("th",{className:"px-4 py-3 italic",children:"DATE"}),m.jsx("th",{className:"px-4 py-3",children:"HERO"}),m.jsx("th",{className:"px-4 py-3",children:"TITLE"}),m.jsx("th",{className:"px-4 py-3 text-right",children:"AMOUNT"}),m.jsx("th",{className:"px-4 py-3 text-center",children:"STATUS"}),m.jsx("th",{className:"px-4 py-3 text-center",children:"ACTION"})]})}),m.jsx("tbody",{children:f.sort((O,j)=>new Date(j.createdAt)-new Date(O.createdAt)).map(O=>m.jsxs("tr",{className:"border-b hover:bg-slate-50",children:[m.jsx("td",{className:"px-4 py-3 text-slate-400 font-mono text-xs",children:new Date(O.createdAt).toLocaleDateString()}),m.jsx("td",{className:"px-4 py-3 text-blue-700",children:O.targetUserName}),m.jsx("td",{className:"px-4 py-3",children:O.title}),m.jsxs("td",{className:"px-4 py-3 text-right font-mono",children:["$",O.amount]}),m.jsx("td",{className:"px-4 py-3 text-center",children:m.jsxs("select",{className:`text-[10px] font-black border-2 rounded px-1.5 py-0.5 ${O.paymentStatus===""?"bg-green-100 text-green-700 border-green-300":"bg-red-100 text-red-700 border-red-300"}`,value:O.paymentStatus||"",onChange:j=>handleUpdateMiscStatus(O.id,j.target.value),children:[m.jsx("option",{value:"",children:""}),m.jsx("option",{value:"",children:""})]})}),m.jsx("td",{className:"px-4 py-3 text-center",children:m.jsx("button",{onClick:()=>handleDeleteMisc(O.id),className:"text-slate-300 hover:text-red-600 transition-colors",children:m.jsx(Z0,{size:16})})})]},O.id))})]})})]}),r==="bulletin"&&m.jsxs("div",{className:"bg-white p-6 rounded-xl border-4 border-slate-900",children:[m.jsxs("div",{className:"flex justify-between items-center mb-4 pb-2 border-b-2",children:[m.jsx("h2",{className:"text-xl font-black italic",children:""}),m.jsxs("button",{onClick:F,className:"px-4 py-2 rounded bg-slate-900 text-yellow-400 font-black flex items-center gap-2 shadow-[3px_3px_0px_0px_#ccc]",children:[m.jsx(Ui,{size:18}),""]})]}),m.jsx(xK,{initialContent:o,onChange:u})]}),r==="import"&&m.jsx(pK,{}),r==="users"&&m.jsx("div",{className:"p-20 text-center font-black text-slate-300",children:"..."})]})}),m.jsx(xs,{isOpen:E,onClose:()=>k(!1),title:"",children:m.jsx(NK,{onSubmit:async O=>{await Ti(Wt(Ke,"artifacts","default-app-id","public","data","groups"),{...O,createdAt:new Date().toISOString(),status:"",createdBy:""}),k(!1)},onCancel:()=>k(!1),submitLabel:""})}),m.jsx(xs,{isOpen:!!z,onClose:()=>H(null),title:"",children:A&&m.jsx(v3,{group:A,orders:w.filter(O=>O.groupId===A.id),currentUser:t,onUpdate:async O=>{await oa(Tt(Ke,"artifacts","default-app-id","public","data","groups",A.id),{secondPayment:O}),H(null)}})})]})}function RK(){const[t,e]=ee.useState(null),[r,n]=ee.useState(null),[a,i]=ee.useState(!0),[o,u]=ee.useState([]),f=ee.useCallback(()=>{n(null),localStorage.removeItem("app_user_id"),i(!1)},[]);ee.useEffect(()=>((async()=>{try{ex.currentUser||await nF(ex)}catch(x){console.error("Firebase ",x)}})(),cF(ex,x=>{e(x)})),[]),ee.useEffect(()=>{if(!t)return;const p=Tr(Wt(Ke,"artifacts","default-app-id","public","data","users"),b=>{const w=b.docs.map(T=>({id:T.id,...T.data()}));u(w)}),x=localStorage.getItem("app_user_id");let y=()=>{};return x?y=Tr(Tt(Ke,"artifacts","default-app-id","public","data","users",x),b=>{b.exists()?(n({id:b.id,...b.data()}),i(!1)):f()},()=>f()):i(!1),()=>{p(),y()}},[t,f]);const h=(p,x)=>{const y=typeof p=="object"&&p!==null?p.id:p,b=o.find(w=>w.id===y);b&&String(b.password).trim()===String(x).trim()?(localStorage.setItem("app_user_id",b.id),n(b),i(!1)):alert("")};return a?m.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-900 text-yellow-400",children:[m.jsx("div",{className:"flex items-center gap-2 mb-4 animate-bounce",children:m.jsx(WP,{size:80,className:"text-yellow-400 drop-shadow-[0_0_15px_rgba(250,204,21,0.5)]"})}),m.jsx("p",{className:"text-3xl font-black italic tracking-widest animate-pulse",children:"PLUS ULTRA..."})]}):m.jsx(_5,{children:m.jsxs("div",{className:"relative min-h-screen",children:[r&&m.jsx(r7,{}),m.jsxs(QR,{children:[m.jsx(Uf,{path:"/",element:r?m.jsx(Nd,{to:"/home",replace:!0}):m.jsx(kM,{users:o,onLogin:h})}),m.jsx(Uf,{path:"/home",element:r?m.jsx(mK,{appUser:r,usersData:o,handleLogout:f}):m.jsx(Nd,{to:"/",replace:!0})}),m.jsx(Uf,{path:"/jf26",element:r?m.jsx(JL,{currentUser:r}):m.jsx(Nd,{to:"/",replace:!0})}),m.jsx(Uf,{path:"/admin/dashboard",element:r?.name===""?m.jsx(CK,{currentUser:r}):m.jsx(Nd,{to:"/home",replace:!0})})]})]})})}sR.createRoot(document.getElementById("root")).render(m.jsx($s.StrictMode,{children:m.jsx(RK,{})}));
