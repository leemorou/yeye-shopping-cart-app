(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function jS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var S1={exports:{}},Mf={};var bb;function G6(){if(bb)return Mf;bb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,i){var o=null;if(i!==void 0&&(o=""+i),a.key!==void 0&&(o=""+a.key),"key"in a){i={};for(var u in a)u!=="key"&&(i[u]=a[u])}else i=a;return a=i.ref,{$$typeof:t,type:n,key:o,ref:a!==void 0?a:null,props:i}}return Mf.Fragment=e,Mf.jsx=r,Mf.jsxs=r,Mf}var Eb;function q6(){return Eb||(Eb=1,S1.exports=G6()),S1.exports}var p=q6(),A1={exports:{}},pt={};var Tb;function W6(){if(Tb)return pt;Tb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),y=Symbol.iterator;function w(Q){return Q===null||typeof Q!="object"?null:(Q=y&&Q[y]||Q["@@iterator"],typeof Q=="function"?Q:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,T={};function I(Q,L,J){this.props=Q,this.context=L,this.refs=T,this.updater=J||E}I.prototype.isReactComponent={},I.prototype.setState=function(Q,L){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,L,"setState")},I.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function R(){}R.prototype=I.prototype;function C(Q,L,J){this.props=Q,this.context=L,this.refs=T,this.updater=J||E}var G=C.prototype=new R;G.constructor=C,b(G,I.prototype),G.isPureReactComponent=!0;var V=Array.isArray;function H(){}var A={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function N(Q,L,J){var Y=J.ref;return{$$typeof:t,type:Q,key:L,ref:Y!==void 0?Y:null,props:J}}function M(Q,L){return N(Q.type,L,Q.props)}function F(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function j(Q){var L={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(J){return L[J]})}var P=/\/+/g;function be(Q,L){return typeof Q=="object"&&Q!==null&&Q.key!=null?j(""+Q.key):L.toString(36)}function ye(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(H,H):(Q.status="pending",Q.then(function(L){Q.status==="pending"&&(Q.status="fulfilled",Q.value=L)},function(L){Q.status==="pending"&&(Q.status="rejected",Q.reason=L)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function se(Q,L,J,Y,ne){var ue=typeof Q;(ue==="undefined"||ue==="boolean")&&(Q=null);var Te=!1;if(Q===null)Te=!0;else switch(ue){case"bigint":case"string":case"number":Te=!0;break;case"object":switch(Q.$$typeof){case t:case e:Te=!0;break;case m:return Te=Q._init,se(Te(Q._payload),L,J,Y,ne)}}if(Te)return ne=ne(Q),Te=Y===""?"."+be(Q,0):Y,V(ne)?(J="",Te!=null&&(J=Te.replace(P,"$&/")+"/"),se(ne,L,J,"",function(Fe){return Fe})):ne!=null&&(F(ne)&&(ne=M(ne,J+(ne.key==null||Q&&Q.key===ne.key?"":(""+ne.key).replace(P,"$&/")+"/")+Te)),L.push(ne)),1;Te=0;var Re=Y===""?".":Y+":";if(V(Q))for(var Ae=0;Ae<Q.length;Ae++)Y=Q[Ae],ue=Re+be(Y,Ae),Te+=se(Y,L,J,ue,ne);else if(Ae=w(Q),typeof Ae=="function")for(Q=Ae.call(Q),Ae=0;!(Y=Q.next()).done;)Y=Y.value,ue=Re+be(Y,Ae++),Te+=se(Y,L,J,ue,ne);else if(ue==="object"){if(typeof Q.then=="function")return se(ye(Q),L,J,Y,ne);throw L=String(Q),Error("Objects are not valid as a React child (found: "+(L==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":L)+"). If you meant to render a collection of children, use an array instead.")}return Te}function ce(Q,L,J){if(Q==null)return Q;var Y=[],ne=0;return se(Q,Y,"","",function(ue){return L.call(J,ue,ne++)}),Y}function le(Q){if(Q._status===-1){var L=Q._result;L=L(),L.then(function(J){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=J)},function(J){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=J)}),Q._status===-1&&(Q._status=0,Q._result=L)}if(Q._status===1)return Q._result.default;throw Q._result}var te=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var L=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(L))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)},_e={map:ce,forEach:function(Q,L,J){ce(Q,function(){L.apply(this,arguments)},J)},count:function(Q){var L=0;return ce(Q,function(){L++}),L},toArray:function(Q){return ce(Q,function(L){return L})||[]},only:function(Q){if(!F(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}};return pt.Activity=x,pt.Children=_e,pt.Component=I,pt.Fragment=r,pt.Profiler=a,pt.PureComponent=C,pt.StrictMode=n,pt.Suspense=f,pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,pt.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return A.H.useMemoCache(Q)}},pt.cache=function(Q){return function(){return Q.apply(null,arguments)}},pt.cacheSignal=function(){return null},pt.cloneElement=function(Q,L,J){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var Y=b({},Q.props),ne=Q.key;if(L!=null)for(ue in L.key!==void 0&&(ne=""+L.key),L)!D.call(L,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&L.ref===void 0||(Y[ue]=L[ue]);var ue=arguments.length-2;if(ue===1)Y.children=J;else if(1<ue){for(var Te=Array(ue),Re=0;Re<ue;Re++)Te[Re]=arguments[Re+2];Y.children=Te}return N(Q.type,ne,Y)},pt.createContext=function(Q){return Q={$$typeof:o,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:i,_context:Q},Q},pt.createElement=function(Q,L,J){var Y,ne={},ue=null;if(L!=null)for(Y in L.key!==void 0&&(ue=""+L.key),L)D.call(L,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(ne[Y]=L[Y]);var Te=arguments.length-2;if(Te===1)ne.children=J;else if(1<Te){for(var Re=Array(Te),Ae=0;Ae<Te;Ae++)Re[Ae]=arguments[Ae+2];ne.children=Re}if(Q&&Q.defaultProps)for(Y in Te=Q.defaultProps,Te)ne[Y]===void 0&&(ne[Y]=Te[Y]);return N(Q,ue,ne)},pt.createRef=function(){return{current:null}},pt.forwardRef=function(Q){return{$$typeof:u,render:Q}},pt.isValidElement=F,pt.lazy=function(Q){return{$$typeof:m,_payload:{_status:-1,_result:Q},_init:le}},pt.memo=function(Q,L){return{$$typeof:d,type:Q,compare:L===void 0?null:L}},pt.startTransition=function(Q){var L=A.T,J={};A.T=J;try{var Y=Q(),ne=A.S;ne!==null&&ne(J,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(H,te)}catch(ue){te(ue)}finally{L!==null&&J.types!==null&&(L.types=J.types),A.T=L}},pt.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},pt.use=function(Q){return A.H.use(Q)},pt.useActionState=function(Q,L,J){return A.H.useActionState(Q,L,J)},pt.useCallback=function(Q,L){return A.H.useCallback(Q,L)},pt.useContext=function(Q){return A.H.useContext(Q)},pt.useDebugValue=function(){},pt.useDeferredValue=function(Q,L){return A.H.useDeferredValue(Q,L)},pt.useEffect=function(Q,L){return A.H.useEffect(Q,L)},pt.useEffectEvent=function(Q){return A.H.useEffectEvent(Q)},pt.useId=function(){return A.H.useId()},pt.useImperativeHandle=function(Q,L,J){return A.H.useImperativeHandle(Q,L,J)},pt.useInsertionEffect=function(Q,L){return A.H.useInsertionEffect(Q,L)},pt.useLayoutEffect=function(Q,L){return A.H.useLayoutEffect(Q,L)},pt.useMemo=function(Q,L){return A.H.useMemo(Q,L)},pt.useOptimistic=function(Q,L){return A.H.useOptimistic(Q,L)},pt.useReducer=function(Q,L,J){return A.H.useReducer(Q,L,J)},pt.useRef=function(Q){return A.H.useRef(Q)},pt.useState=function(Q){return A.H.useState(Q)},pt.useSyncExternalStore=function(Q,L,J){return A.H.useSyncExternalStore(Q,L,J)},pt.useTransition=function(){return A.H.useTransition()},pt.version="19.2.1",pt}var Sb;function sv(){return Sb||(Sb=1,A1.exports=W6()),A1.exports}var re=sv();const Xs=jS(re);var k1={exports:{}},Pf={},C1={exports:{}},N1={};var Ab;function X6(){return Ab||(Ab=1,(function(t){function e(se,ce){var le=se.length;se.push(ce);e:for(;0<le;){var te=le-1>>>1,_e=se[te];if(0<a(_e,ce))se[te]=ce,se[le]=_e,le=te;else break e}}function r(se){return se.length===0?null:se[0]}function n(se){if(se.length===0)return null;var ce=se[0],le=se.pop();if(le!==ce){se[0]=le;e:for(var te=0,_e=se.length,Q=_e>>>1;te<Q;){var L=2*(te+1)-1,J=se[L],Y=L+1,ne=se[Y];if(0>a(J,le))Y<_e&&0>a(ne,J)?(se[te]=ne,se[Y]=le,te=Y):(se[te]=J,se[L]=le,te=L);else if(Y<_e&&0>a(ne,le))se[te]=ne,se[Y]=le,te=Y;else break e}}return ce}function a(se,ce){var le=se.sortIndex-ce.sortIndex;return le!==0?le:se.id-ce.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var f=[],d=[],m=1,x=null,y=3,w=!1,E=!1,b=!1,T=!1,I=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function G(se){for(var ce=r(d);ce!==null;){if(ce.callback===null)n(d);else if(ce.startTime<=se)n(d),ce.sortIndex=ce.expirationTime,e(f,ce);else break;ce=r(d)}}function V(se){if(b=!1,G(se),!E)if(r(f)!==null)E=!0,H||(H=!0,j());else{var ce=r(d);ce!==null&&ye(V,ce.startTime-se)}}var H=!1,A=-1,D=5,N=-1;function M(){return T?!0:!(t.unstable_now()-N<D)}function F(){if(T=!1,H){var se=t.unstable_now();N=se;var ce=!0;try{e:{E=!1,b&&(b=!1,R(A),A=-1),w=!0;var le=y;try{t:{for(G(se),x=r(f);x!==null&&!(x.expirationTime>se&&M());){var te=x.callback;if(typeof te=="function"){x.callback=null,y=x.priorityLevel;var _e=te(x.expirationTime<=se);if(se=t.unstable_now(),typeof _e=="function"){x.callback=_e,G(se),ce=!0;break t}x===r(f)&&n(f),G(se)}else n(f);x=r(f)}if(x!==null)ce=!0;else{var Q=r(d);Q!==null&&ye(V,Q.startTime-se),ce=!1}}break e}finally{x=null,y=le,w=!1}ce=void 0}}finally{ce?j():H=!1}}}var j;if(typeof C=="function")j=function(){C(F)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,be=P.port2;P.port1.onmessage=F,j=function(){be.postMessage(null)}}else j=function(){I(F,0)};function ye(se,ce){A=I(function(){se(t.unstable_now())},ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(se){se.callback=null},t.unstable_forceFrameRate=function(se){0>se||125<se?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<se?Math.floor(1e3/se):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_next=function(se){switch(y){case 1:case 2:case 3:var ce=3;break;default:ce=y}var le=y;y=ce;try{return se()}finally{y=le}},t.unstable_requestPaint=function(){T=!0},t.unstable_runWithPriority=function(se,ce){switch(se){case 1:case 2:case 3:case 4:case 5:break;default:se=3}var le=y;y=se;try{return ce()}finally{y=le}},t.unstable_scheduleCallback=function(se,ce,le){var te=t.unstable_now();switch(typeof le=="object"&&le!==null?(le=le.delay,le=typeof le=="number"&&0<le?te+le:te):le=te,se){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=le+_e,se={id:m++,callback:ce,priorityLevel:se,startTime:le,expirationTime:_e,sortIndex:-1},le>te?(se.sortIndex=le,e(d,se),r(f)===null&&se===r(d)&&(b?(R(A),A=-1):b=!0,ye(V,le-te))):(se.sortIndex=_e,e(f,se),E||w||(E=!0,H||(H=!0,j()))),se},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(se){var ce=y;return function(){var le=y;y=ce;try{return se.apply(this,arguments)}finally{y=le}}}})(N1)),N1}var kb;function Y6(){return kb||(kb=1,C1.exports=X6()),C1.exports}var R1={exports:{}},In={};var Cb;function $6(){if(Cb)return In;Cb=1;var t=sv();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(f,d,m){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:x==null?null:""+x,children:f,containerInfo:d,implementation:m}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return In.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,In.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return i(f,d,null,m)},In.flushSync=function(f){var d=o.T,m=n.p;try{if(o.T=null,n.p=2,f)return f()}finally{o.T=d,n.p=m,n.d.f()}},In.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},In.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},In.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,x=u(m,d.crossOrigin),y=typeof d.integrity=="string"?d.integrity:void 0,w=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:x,integrity:y,fetchPriority:w}):m==="script"&&n.d.X(f,{crossOrigin:x,integrity:y,fetchPriority:w,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},In.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=u(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},In.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,x=u(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:x,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},In.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=u(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},In.requestFormReset=function(f){n.d.r(f)},In.unstable_batchedUpdates=function(f,d){return f(d)},In.useFormState=function(f,d,m){return o.H.useFormState(f,d,m)},In.useFormStatus=function(){return o.H.useHostTransitionStatus()},In.version="19.2.1",In}var Nb;function K6(){if(Nb)return R1.exports;Nb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),R1.exports=$6(),R1.exports}var Rb;function Q6(){if(Rb)return Pf;Rb=1;var t=Y6(),e=sv(),r=K6();function n(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)l+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var l=s,c=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(c=l.return),s=l.return;while(s)}return l.tag===3?c:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function f(s){if(i(s)!==s)throw Error(n(188))}function d(s){var l=s.alternate;if(!l){if(l=i(s),l===null)throw Error(n(188));return l!==s?null:s}for(var c=s,h=l;;){var v=c.return;if(v===null)break;var _=v.alternate;if(_===null){if(h=v.return,h!==null){c=h;continue}break}if(v.child===_.child){for(_=v.child;_;){if(_===c)return f(v),s;if(_===h)return f(v),l;_=_.sibling}throw Error(n(188))}if(c.return!==h.return)c=v,h=_;else{for(var k=!1,z=v.child;z;){if(z===c){k=!0,c=v,h=_;break}if(z===h){k=!0,h=v,c=_;break}z=z.sibling}if(!k){for(z=_.child;z;){if(z===c){k=!0,c=_,h=v;break}if(z===h){k=!0,h=_,c=v;break}z=z.sibling}if(!k)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:l}function m(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=m(s),l!==null)return l;s=s.sibling}return null}var x=Object.assign,y=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),C=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),N=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function j(s){return s===null||typeof s!="object"?null:(s=F&&s[F]||s["@@iterator"],typeof s=="function"?s:null)}var P=Symbol.for("react.client.reference");function be(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===P?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case I:return"Profiler";case T:return"StrictMode";case V:return"Suspense";case H:return"SuspenseList";case N:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case E:return"Portal";case C:return s.displayName||"Context";case R:return(s._context.displayName||"Context")+".Consumer";case G:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case A:return l=s.displayName||null,l!==null?l:be(s.type)||"Memo";case D:l=s._payload,s=s._init;try{return be(s(l))}catch{}}return null}var ye=Array.isArray,se=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,le={pending:!1,data:null,method:null,action:null},te=[],_e=-1;function Q(s){return{current:s}}function L(s){0>_e||(s.current=te[_e],te[_e]=null,_e--)}function J(s,l){_e++,te[_e]=s.current,s.current=l}var Y=Q(null),ne=Q(null),ue=Q(null),Te=Q(null);function Re(s,l){switch(J(ue,l),J(ne,s),J(Y,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?qw(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=qw(l),s=Ww(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}L(Y),J(Y,s)}function Ae(){L(Y),L(ne),L(ue)}function Fe(s){s.memoizedState!==null&&J(Te,s);var l=Y.current,c=Ww(l,s.type);l!==c&&(J(ne,s),J(Y,c))}function st(s){ne.current===s&&(L(Y),L(ne)),Te.current===s&&(L(Te),If._currentValue=le)}var B,Xe;function Pe(s){if(B===void 0)try{throw Error()}catch(c){var l=c.stack.trim().match(/\n( *(at )?)/);B=l&&l[1]||"",Xe=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+B+s+Xe}var et=!1;function We(s,l){if(!s||et)return"";et=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(l){var De=function(){throw Error()};if(Object.defineProperty(De.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(De,[])}catch(Ee){var ve=Ee}Reflect.construct(s,[],De)}else{try{De.call()}catch(Ee){ve=Ee}s.call(De.prototype)}}else{try{throw Error()}catch(Ee){ve=Ee}(De=s())&&typeof De.catch=="function"&&De.catch(function(){})}}catch(Ee){if(Ee&&ve&&typeof Ee.stack=="string")return[Ee.stack,ve.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=h.DetermineComponentFrameRoot(),k=_[0],z=_[1];if(k&&z){var ae=k.split(`
`),pe=z.split(`
`);for(v=h=0;h<ae.length&&!ae[h].includes("DetermineComponentFrameRoot");)h++;for(;v<pe.length&&!pe[v].includes("DetermineComponentFrameRoot");)v++;if(h===ae.length||v===pe.length)for(h=ae.length-1,v=pe.length-1;1<=h&&0<=v&&ae[h]!==pe[v];)v--;for(;1<=h&&0<=v;h--,v--)if(ae[h]!==pe[v]){if(h!==1||v!==1)do if(h--,v--,0>v||ae[h]!==pe[v]){var Ce=`
`+ae[h].replace(" at new "," at ");return s.displayName&&Ce.includes("<anonymous>")&&(Ce=Ce.replace("<anonymous>",s.displayName)),Ce}while(1<=h&&0<=v);break}}}finally{et=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?Pe(c):""}function je(s,l){switch(s.tag){case 26:case 27:case 5:return Pe(s.type);case 16:return Pe("Lazy");case 13:return s.child!==l&&l!==null?Pe("Suspense Fallback"):Pe("Suspense");case 19:return Pe("SuspenseList");case 0:case 15:return We(s.type,!1);case 11:return We(s.type.render,!1);case 1:return We(s.type,!0);case 31:return Pe("Activity");default:return""}}function ht(s){try{var l="",c=null;do l+=je(s,c),c=s,s=s.return;while(s);return l}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var _t=Object.prototype.hasOwnProperty,Ft=t.unstable_scheduleCallback,Hr=t.unstable_cancelCallback,ns=t.unstable_shouldYield,Gn=t.unstable_requestPaint,zt=t.unstable_now,Gr=t.unstable_getCurrentPriorityLevel,nn=t.unstable_ImmediatePriority,qn=t.unstable_UserBlockingPriority,Xt=t.unstable_NormalPriority,Or=t.unstable_LowPriority,dt=t.unstable_IdlePriority,rr=t.log,an=t.unstable_setDisableYieldValue,Mt=null,or=null;function qr(s){if(typeof rr=="function"&&an(s),or&&typeof or.setStrictMode=="function")try{or.setStrictMode(Mt,s)}catch{}}var dr=Math.clz32?Math.clz32:so,uc=Math.log,Js=Math.LN2;function so(s){return s>>>=0,s===0?32:31-(uc(s)/Js|0)|0}var da=256,Zs=262144,kr=4194304;function Wn(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Da(s,l,c){var h=s.pendingLanes;if(h===0)return 0;var v=0,_=s.suspendedLanes,k=s.pingedLanes;s=s.warmLanes;var z=h&134217727;return z!==0?(h=z&~_,h!==0?v=Wn(h):(k&=z,k!==0?v=Wn(k):c||(c=z&~s,c!==0&&(v=Wn(c))))):(z=h&~_,z!==0?v=Wn(z):k!==0?v=Wn(k):c||(c=h&~s,c!==0&&(v=Wn(c)))),v===0?0:l!==0&&l!==v&&(l&_)===0&&(_=v&-v,c=l&-l,_>=c||_===32&&(c&4194048)!==0)?l:v}function ma(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function Vu(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fc(){var s=kr;return kr<<=1,(kr&62914560)===0&&(kr=4194304),s}function Oa(s){for(var l=[],c=0;31>c;c++)l.push(s);return l}function ei(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Uu(s,l,c,h,v,_){var k=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var z=s.entanglements,ae=s.expirationTimes,pe=s.hiddenUpdates;for(c=k&~c;0<c;){var Ce=31-dr(c),De=1<<Ce;z[Ce]=0,ae[Ce]=-1;var ve=pe[Ce];if(ve!==null)for(pe[Ce]=null,Ce=0;Ce<ve.length;Ce++){var Ee=ve[Ce];Ee!==null&&(Ee.lane&=-536870913)}c&=~De}h!==0&&ti(s,h,0),_!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=_&~(k&~l))}function ti(s,l,c){s.pendingLanes|=l,s.suspendedLanes&=~l;var h=31-dr(l);s.entangledLanes|=l,s.entanglements[h]=s.entanglements[h]|1073741824|c&261930}function ri(s,l){var c=s.entangledLanes|=l;for(s=s.entanglements;c;){var h=31-dr(c),v=1<<h;v&l|s[h]&l&&(s[h]|=l),c&=~v}}function io(s,l){var c=l&-l;return c=(c&42)!==0?1:ni(c),(c&(s.suspendedLanes|l))!==0?0:c}function ni(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function as(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function U(){var s=ce.p;return s!==0?s:(s=window.event,s===void 0?32:pb(s.type))}function Z(s,l){var c=ce.p;try{return ce.p=s,l()}finally{ce.p=c}}var q=Math.random().toString(36).slice(2),X="__reactFiber$"+q,K="__reactProps$"+q,ee="__reactContainer$"+q,de="__reactEvents$"+q,ke="__reactListeners$"+q,me="__reactHandles$"+q,xe="__reactResources$"+q,ge="__reactMarker$"+q;function Be(s){delete s[X],delete s[K],delete s[de],delete s[ke],delete s[me]}function Ve(s){var l=s[X];if(l)return l;for(var c=s.parentNode;c;){if(l=c[ee]||c[X]){if(c=l.alternate,l.child!==null||c!==null&&c.child!==null)for(s=Zw(s);s!==null;){if(c=s[X])return c;s=Zw(s)}return l}s=c,c=s.parentNode}return null}function qe(s){if(s=s[X]||s[ee]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function Le(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(n(33))}function Ge(s){var l=s[xe];return l||(l=s[xe]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Ze(s){s[ge]=!0}var Yt=new Set,$t={};function cr(s,l){Nn(s,l),Nn(s+"Capture",l)}function Nn(s,l){for($t[s]=l,s=0;s<l.length;s++)Yt.add(l[s])}var ss=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),is={},pa={};function zi(s){return _t.call(pa,s)?!0:_t.call(is,s)?!1:ss.test(s)?pa[s]=!0:(is[s]=!0,!1)}function Rn(s,l,c){if(zi(l))if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var h=l.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+c)}}function ga(s,l,c){if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+c)}}function Wr(s,l,c,h){if(h===null)s.removeAttribute(c);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(l,c,""+h)}}function fn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Hi(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function zu(s,l,c){var h=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var v=h.get,_=h.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return v.call(this)},set:function(k){c=""+k,_.call(this,k)}}),Object.defineProperty(s,l,{enumerable:h.enumerable}),{getValue:function(){return c},setValue:function(k){c=""+k},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function Kt(s){if(!s._valueTracker){var l=Hi(s)?"checked":"value";s._valueTracker=zu(s,l,""+s[l])}}function lo(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var c=l.getValue(),h="";return s&&(h=Hi(s)?s.checked?"true":"false":s.value),s=h,s!==c?(l.setValue(s),!0):!1}function Ts(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var oo=/[\n"\\]/g;function ea(s){return s.replace(oo,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function hc(s,l,c,h,v,_,k,z){s.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?s.type=k:s.removeAttribute("type"),l!=null?k==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+fn(l)):s.value!==""+fn(l)&&(s.value=""+fn(l)):k!=="submit"&&k!=="reset"||s.removeAttribute("value"),l!=null?Hu(s,k,fn(l)):c!=null?Hu(s,k,fn(c)):h!=null&&s.removeAttribute("value"),v==null&&_!=null&&(s.defaultChecked=!!_),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),z!=null&&typeof z!="function"&&typeof z!="symbol"&&typeof z!="boolean"?s.name=""+fn(z):s.removeAttribute("name")}function lh(s,l,c,h,v,_,k,z){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),l!=null||c!=null){if(!(_!=="submit"&&_!=="reset"||l!=null)){Kt(s);return}c=c!=null?""+fn(c):"",l=l!=null?""+fn(l):c,z||l===s.value||(s.value=l),s.defaultValue=l}h=h??v,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=z?s.checked:!!h,s.defaultChecked=!!h,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(s.name=k),Kt(s)}function Hu(s,l,c){l==="number"&&Ts(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Gi(s,l,c,h){if(s=s.options,l){l={};for(var v=0;v<c.length;v++)l["$"+c[v]]=!0;for(c=0;c<s.length;c++)v=l.hasOwnProperty("$"+s[c].value),s[c].selected!==v&&(s[c].selected=v),v&&h&&(s[c].defaultSelected=!0)}else{for(c=""+fn(c),l=null,v=0;v<s.length;v++){if(s[v].value===c){s[v].selected=!0,h&&(s[v].defaultSelected=!0);return}l!==null||s[v].disabled||(l=s[v])}l!==null&&(l.selected=!0)}}function oh(s,l,c){if(l!=null&&(l=""+fn(l),l!==s.value&&(s.value=l),c==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=c!=null?""+fn(c):""}function qi(s,l,c,h){if(l==null){if(h!=null){if(c!=null)throw Error(n(92));if(ye(h)){if(1<h.length)throw Error(n(93));h=h[0]}c=h}c==null&&(c=""),l=c}c=fn(l),s.defaultValue=c,h=s.textContent,h===c&&h!==""&&h!==null&&(s.value=h),Kt(s)}function ta(s,l){if(l){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=l;return}}s.textContent=l}var ch=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Gu(s,l,c){var h=l.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?h?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":h?s.setProperty(l,c):typeof c!="number"||c===0||ch.has(l)?l==="float"?s.cssFloat=c:s[l]=(""+c).trim():s[l]=c+"px"}function qu(s,l,c){if(l!=null&&typeof l!="object")throw Error(n(62));if(s=s.style,c!=null){for(var h in c)!c.hasOwnProperty(h)||l!=null&&l.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var v in l)h=l[v],l.hasOwnProperty(v)&&c[v]!==h&&Gu(s,v,h)}else for(var _ in l)l.hasOwnProperty(_)&&Gu(s,_,l[_])}function dc(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Wi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function mc(s){return Wi.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function ls(){}var Wu=null;function Fa(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Xi=null,Ss=null;function co(s){var l=qe(s);if(l&&(s=l.stateNode)){var c=s[K]||null;e:switch(s=l.stateNode,l.type){case"input":if(hc(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),l=c.name,c.type==="radio"&&l!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+ea(""+l)+'"][type="radio"]'),l=0;l<c.length;l++){var h=c[l];if(h!==s&&h.form===s.form){var v=h[K]||null;if(!v)throw Error(n(90));hc(h,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(l=0;l<c.length;l++)h=c[l],h.form===s.form&&lo(h)}break e;case"textarea":oh(s,c.value,c.defaultValue);break e;case"select":l=c.value,l!=null&&Gi(s,!!c.multiple,l,!1)}}}var pc=!1;function Yi(s,l,c){if(pc)return s(l,c);pc=!0;try{var h=s(l);return h}finally{if(pc=!1,(Xi!==null||Ss!==null)&&(nd(),Xi&&(l=Xi,s=Ss,Ss=Xi=null,co(l),s)))for(l=0;l<s.length;l++)co(s[l])}}function os(s,l){var c=s.stateNode;if(c===null)return null;var h=c[K]||null;if(h===null)return null;c=h[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,l,typeof c));return c}var Ma=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uo=!1;if(Ma)try{var nr={};Object.defineProperty(nr,"passive",{get:function(){uo=!0}}),window.addEventListener("test",nr,nr),window.removeEventListener("test",nr,nr)}catch{uo=!1}var As=null,Xu=null,fo=null;function Yu(){if(fo)return fo;var s,l=Xu,c=l.length,h,v="value"in As?As.value:As.textContent,_=v.length;for(s=0;s<c&&l[s]===v[s];s++);var k=c-s;for(h=1;h<=k&&l[c-h]===v[_-h];h++);return fo=v.slice(s,1<h?1-h:void 0)}function ho(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function ai(){return!0}function cs(){return!1}function vn(s){function l(c,h,v,_,k){this._reactName=c,this._targetInst=v,this.type=h,this.nativeEvent=_,this.target=k,this.currentTarget=null;for(var z in s)s.hasOwnProperty(z)&&(c=s[z],this[z]=c?c(_):_[z]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?ai:cs,this.isPropagationStopped=cs,this}return x(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ai)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ai)},persist:function(){},isPersistent:ai}),l}var si={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ks=vn(si),$i=x({},si,{view:0,detail:0}),$u=vn($i),Ki,gc,Cs,xc=x({},$i,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qi,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Cs&&(Cs&&s.type==="mousemove"?(Ki=s.screenX-Cs.screenX,gc=s.screenY-Cs.screenY):gc=Ki=0,Cs=s),Ki)},movementY:function(s){return"movementY"in s?s.movementY:gc}}),Ku=vn(xc),mo=x({},xc,{dataTransfer:0}),fh=vn(mo),hh=x({},$i,{relatedTarget:0}),po=vn(hh),Qu=x({},si,{animationName:0,elapsedTime:0,pseudoElement:0}),dh=vn(Qu),vc=x({},si,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),mh=vn(vc),ph=x({},si,{data:0}),Ns=vn(ph),gh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yh(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=vh[s])?!!l[s]:!1}function Qi(){return yh}var Xn=x({},$i,{key:function(s){if(s.key){var l=gh[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=ho(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?xh[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qi,charCode:function(s){return s.type==="keypress"?ho(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ho(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),_h=vn(Xn),wh=x({},xc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ii=vn(wh),g=x({},$i,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qi}),S=vn(g),O=x({},si,{propertyName:0,elapsedTime:0,pseudoElement:0}),W=vn(O),fe=x({},xc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),we=vn(fe),He=x({},si,{newState:0,oldState:0}),xt=vn(He),Fr=[9,13,27,32],Ht=Ma&&"CompositionEvent"in window,_r=null;Ma&&"documentMode"in document&&(_r=document.documentMode);var Pa=Ma&&"TextEvent"in window&&!_r,Rs=Ma&&(!Ht||_r&&8<_r&&11>=_r),us=" ",fs=!1;function go(s,l){switch(s){case"keyup":return Fr.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yc(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var _c=!1;function m3(s,l){switch(s){case"compositionend":return yc(l);case"keypress":return l.which!==32?null:(fs=!0,us);case"textInput":return s=l.data,s===us&&fs?null:s;default:return null}}function p3(s,l){if(_c)return s==="compositionend"||!Ht&&go(s,l)?(s=Yu(),fo=Xu=As=null,_c=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Rs&&l.locale!=="ko"?null:l.data;default:return null}}var g3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function r_(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!g3[s.type]:l==="textarea"}function n_(s,l,c,h){Xi?Ss?Ss.push(h):Ss=[h]:Xi=h,l=ud(l,"onChange"),0<l.length&&(c=new ks("onChange","change",null,c,h),s.push({event:c,listeners:l}))}var Ju=null,Zu=null;function x3(s){Bw(s,0)}function bh(s){var l=Le(s);if(lo(l))return s}function a_(s,l){if(s==="change")return l}var s_=!1;if(Ma){var Dp;if(Ma){var Op="oninput"in document;if(!Op){var i_=document.createElement("div");i_.setAttribute("oninput","return;"),Op=typeof i_.oninput=="function"}Dp=Op}else Dp=!1;s_=Dp&&(!document.documentMode||9<document.documentMode)}function l_(){Ju&&(Ju.detachEvent("onpropertychange",o_),Zu=Ju=null)}function o_(s){if(s.propertyName==="value"&&bh(Zu)){var l=[];n_(l,Zu,s,Fa(s)),Yi(x3,l)}}function v3(s,l,c){s==="focusin"?(l_(),Ju=l,Zu=c,Ju.attachEvent("onpropertychange",o_)):s==="focusout"&&l_()}function y3(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return bh(Zu)}function _3(s,l){if(s==="click")return bh(l)}function w3(s,l){if(s==="input"||s==="change")return bh(l)}function b3(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var xa=typeof Object.is=="function"?Object.is:b3;function ef(s,l){if(xa(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var c=Object.keys(s),h=Object.keys(l);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var v=c[h];if(!_t.call(l,v)||!xa(s[v],l[v]))return!1}return!0}function c_(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function u_(s,l){var c=c_(s);s=0;for(var h;c;){if(c.nodeType===3){if(h=s+c.textContent.length,s<=l&&h>=l)return{node:c,offset:l-s};s=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=c_(c)}}function f_(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?f_(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function h_(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=Ts(s.document);l instanceof s.HTMLIFrameElement;){try{var c=typeof l.contentWindow.location.href=="string"}catch{c=!1}if(c)s=l.contentWindow;else break;l=Ts(s.document)}return l}function Fp(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var E3=Ma&&"documentMode"in document&&11>=document.documentMode,wc=null,Mp=null,tf=null,Pp=!1;function d_(s,l,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Pp||wc==null||wc!==Ts(h)||(h=wc,"selectionStart"in h&&Fp(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),tf&&ef(tf,h)||(tf=h,h=ud(Mp,"onSelect"),0<h.length&&(l=new ks("onSelect","select",null,l,c),s.push({event:l,listeners:h}),l.target=wc)))}function xo(s,l){var c={};return c[s.toLowerCase()]=l.toLowerCase(),c["Webkit"+s]="webkit"+l,c["Moz"+s]="moz"+l,c}var bc={animationend:xo("Animation","AnimationEnd"),animationiteration:xo("Animation","AnimationIteration"),animationstart:xo("Animation","AnimationStart"),transitionrun:xo("Transition","TransitionRun"),transitionstart:xo("Transition","TransitionStart"),transitioncancel:xo("Transition","TransitionCancel"),transitionend:xo("Transition","TransitionEnd")},jp={},m_={};Ma&&(m_=document.createElement("div").style,"AnimationEvent"in window||(delete bc.animationend.animation,delete bc.animationiteration.animation,delete bc.animationstart.animation),"TransitionEvent"in window||delete bc.transitionend.transition);function vo(s){if(jp[s])return jp[s];if(!bc[s])return s;var l=bc[s],c;for(c in l)if(l.hasOwnProperty(c)&&c in m_)return jp[s]=l[c];return s}var p_=vo("animationend"),g_=vo("animationiteration"),x_=vo("animationstart"),T3=vo("transitionrun"),S3=vo("transitionstart"),A3=vo("transitioncancel"),v_=vo("transitionend"),y_=new Map,Lp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lp.push("scrollEnd");function hs(s,l){y_.set(s,l),cr(l,[s])}var Eh=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},ja=[],Ec=0,Bp=0;function Th(){for(var s=Ec,l=Bp=Ec=0;l<s;){var c=ja[l];ja[l++]=null;var h=ja[l];ja[l++]=null;var v=ja[l];ja[l++]=null;var _=ja[l];if(ja[l++]=null,h!==null&&v!==null){var k=h.pending;k===null?v.next=v:(v.next=k.next,k.next=v),h.pending=v}_!==0&&__(c,v,_)}}function Sh(s,l,c,h){ja[Ec++]=s,ja[Ec++]=l,ja[Ec++]=c,ja[Ec++]=h,Bp|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function Vp(s,l,c,h){return Sh(s,l,c,h),Ah(s)}function yo(s,l){return Sh(s,null,null,l),Ah(s)}function __(s,l,c){s.lanes|=c;var h=s.alternate;h!==null&&(h.lanes|=c);for(var v=!1,_=s.return;_!==null;)_.childLanes|=c,h=_.alternate,h!==null&&(h.childLanes|=c),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(v=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,v&&l!==null&&(v=31-dr(c),s=_.hiddenUpdates,h=s[v],h===null?s[v]=[l]:h.push(l),l.lane=c|536870912),_):null}function Ah(s){if(50<Tf)throw Tf=0,$g=null,Error(n(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var Tc={};function k3(s,l,c,h){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function va(s,l,c,h){return new k3(s,l,c,h)}function Up(s){return s=s.prototype,!(!s||!s.isReactComponent)}function li(s,l){var c=s.alternate;return c===null?(c=va(s.tag,l,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=l,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,l=s.dependencies,c.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function w_(s,l){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,l=c.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function kh(s,l,c,h,v,_){var k=0;if(h=s,typeof s=="function")Up(s)&&(k=1);else if(typeof s=="string")k=D6(s,c,Y.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case N:return s=va(31,c,l,v),s.elementType=N,s.lanes=_,s;case b:return _o(c.children,v,_,l);case T:k=8,v|=24;break;case I:return s=va(12,c,l,v|2),s.elementType=I,s.lanes=_,s;case V:return s=va(13,c,l,v),s.elementType=V,s.lanes=_,s;case H:return s=va(19,c,l,v),s.elementType=H,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case C:k=10;break e;case R:k=9;break e;case G:k=11;break e;case A:k=14;break e;case D:k=16,h=null;break e}k=29,c=Error(n(130,s===null?"null":typeof s,"")),h=null}return l=va(k,c,l,v),l.elementType=s,l.type=h,l.lanes=_,l}function _o(s,l,c,h){return s=va(7,s,h,l),s.lanes=c,s}function zp(s,l,c){return s=va(6,s,null,l),s.lanes=c,s}function b_(s){var l=va(18,null,null,0);return l.stateNode=s,l}function Hp(s,l,c){return l=va(4,s.children!==null?s.children:[],s.key,l),l.lanes=c,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var E_=new WeakMap;function La(s,l){if(typeof s=="object"&&s!==null){var c=E_.get(s);return c!==void 0?c:(l={value:s,source:l,stack:ht(l)},E_.set(s,l),l)}return{value:s,source:l,stack:ht(l)}}var Sc=[],Ac=0,Ch=null,rf=0,Ba=[],Va=0,Ji=null,Is=1,Ds="";function oi(s,l){Sc[Ac++]=rf,Sc[Ac++]=Ch,Ch=s,rf=l}function T_(s,l,c){Ba[Va++]=Is,Ba[Va++]=Ds,Ba[Va++]=Ji,Ji=s;var h=Is;s=Ds;var v=32-dr(h)-1;h&=~(1<<v),c+=1;var _=32-dr(l)+v;if(30<_){var k=v-v%5;_=(h&(1<<k)-1).toString(32),h>>=k,v-=k,Is=1<<32-dr(l)+v|c<<v|h,Ds=_+s}else Is=1<<_|c<<v|h,Ds=s}function Gp(s){s.return!==null&&(oi(s,1),T_(s,1,0))}function qp(s){for(;s===Ch;)Ch=Sc[--Ac],Sc[Ac]=null,rf=Sc[--Ac],Sc[Ac]=null;for(;s===Ji;)Ji=Ba[--Va],Ba[Va]=null,Ds=Ba[--Va],Ba[Va]=null,Is=Ba[--Va],Ba[Va]=null}function S_(s,l){Ba[Va++]=Is,Ba[Va++]=Ds,Ba[Va++]=Ji,Is=l.id,Ds=l.overflow,Ji=s}var yn=null,mr=null,Ot=!1,Zi=null,Ua=!1,Wp=Error(n(519));function el(s){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw nf(La(l,s)),Wp}function A_(s){var l=s.stateNode,c=s.type,h=s.memoizedProps;switch(l[X]=s,l[K]=h,c){case"dialog":kt("cancel",l),kt("close",l);break;case"iframe":case"object":case"embed":kt("load",l);break;case"video":case"audio":for(c=0;c<Af.length;c++)kt(Af[c],l);break;case"source":kt("error",l);break;case"img":case"image":case"link":kt("error",l),kt("load",l);break;case"details":kt("toggle",l);break;case"input":kt("invalid",l),lh(l,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":kt("invalid",l);break;case"textarea":kt("invalid",l),qi(l,h.value,h.defaultValue,h.children)}c=h.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||l.textContent===""+c||h.suppressHydrationWarning===!0||Hw(l.textContent,c)?(h.popover!=null&&(kt("beforetoggle",l),kt("toggle",l)),h.onScroll!=null&&kt("scroll",l),h.onScrollEnd!=null&&kt("scrollend",l),h.onClick!=null&&(l.onclick=ls),l=!0):l=!1,l||el(s,!0)}function k_(s){for(yn=s.return;yn;)switch(yn.tag){case 5:case 31:case 13:Ua=!1;return;case 27:case 3:Ua=!0;return;default:yn=yn.return}}function kc(s){if(s!==yn)return!1;if(!Ot)return k_(s),Ot=!0,!1;var l=s.tag,c;if((c=l!==3&&l!==27)&&((c=l===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||u1(s.type,s.memoizedProps)),c=!c),c&&mr&&el(s),k_(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));mr=Jw(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));mr=Jw(s)}else l===27?(l=mr,ml(s.type)?(s=p1,p1=null,mr=s):mr=l):mr=yn?Ha(s.stateNode.nextSibling):null;return!0}function wo(){mr=yn=null,Ot=!1}function Xp(){var s=Zi;return s!==null&&(sa===null?sa=s:sa.push.apply(sa,s),Zi=null),s}function nf(s){Zi===null?Zi=[s]:Zi.push(s)}var Yp=Q(null),bo=null,ci=null;function tl(s,l,c){J(Yp,l._currentValue),l._currentValue=c}function ui(s){s._currentValue=Yp.current,L(Yp)}function $p(s,l,c){for(;s!==null;){var h=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,h!==null&&(h.childLanes|=l)):h!==null&&(h.childLanes&l)!==l&&(h.childLanes|=l),s===c)break;s=s.return}}function Kp(s,l,c,h){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var _=v.dependencies;if(_!==null){var k=v.child;_=_.firstContext;e:for(;_!==null;){var z=_;_=v;for(var ae=0;ae<l.length;ae++)if(z.context===l[ae]){_.lanes|=c,z=_.alternate,z!==null&&(z.lanes|=c),$p(_.return,c,s),h||(k=null);break e}_=z.next}}else if(v.tag===18){if(k=v.return,k===null)throw Error(n(341));k.lanes|=c,_=k.alternate,_!==null&&(_.lanes|=c),$p(k,c,s),k=null}else k=v.child;if(k!==null)k.return=v;else for(k=v;k!==null;){if(k===s){k=null;break}if(v=k.sibling,v!==null){v.return=k.return,k=v;break}k=k.return}v=k}}function Cc(s,l,c,h){s=null;for(var v=l,_=!1;v!==null;){if(!_){if((v.flags&524288)!==0)_=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var k=v.alternate;if(k===null)throw Error(n(387));if(k=k.memoizedProps,k!==null){var z=v.type;xa(v.pendingProps.value,k.value)||(s!==null?s.push(z):s=[z])}}else if(v===Te.current){if(k=v.alternate,k===null)throw Error(n(387));k.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(If):s=[If])}v=v.return}s!==null&&Kp(l,s,c,h),l.flags|=262144}function Nh(s){for(s=s.firstContext;s!==null;){if(!xa(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Eo(s){bo=s,ci=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function _n(s){return C_(bo,s)}function Rh(s,l){return bo===null&&Eo(s),C_(s,l)}function C_(s,l){var c=l._currentValue;if(l={context:l,memoizedValue:c,next:null},ci===null){if(s===null)throw Error(n(308));ci=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else ci=ci.next=l;return c}var C3=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(c,h){s.push(h)}};this.abort=function(){l.aborted=!0,s.forEach(function(c){return c()})}},N3=t.unstable_scheduleCallback,R3=t.unstable_NormalPriority,Xr={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Qp(){return{controller:new C3,data:new Map,refCount:0}}function af(s){s.refCount--,s.refCount===0&&N3(R3,function(){s.controller.abort()})}var sf=null,Jp=0,Nc=0,Rc=null;function I3(s,l){if(sf===null){var c=sf=[];Jp=0,Nc=t1(),Rc={status:"pending",value:void 0,then:function(h){c.push(h)}}}return Jp++,l.then(N_,N_),l}function N_(){if(--Jp===0&&sf!==null){Rc!==null&&(Rc.status="fulfilled");var s=sf;sf=null,Nc=0,Rc=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function D3(s,l){var c=[],h={status:"pending",value:null,reason:null,then:function(v){c.push(v)}};return s.then(function(){h.status="fulfilled",h.value=l;for(var v=0;v<c.length;v++)(0,c[v])(l)},function(v){for(h.status="rejected",h.reason=v,v=0;v<c.length;v++)(0,c[v])(void 0)}),h}var R_=se.S;se.S=function(s,l){dw=zt(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&I3(s,l),R_!==null&&R_(s,l)};var To=Q(null);function Zp(){var s=To.current;return s!==null?s:ur.pooledCache}function Ih(s,l){l===null?J(To,To.current):J(To,l.pool)}function I_(){var s=Zp();return s===null?null:{parent:Xr._currentValue,pool:s}}var Ic=Error(n(460)),eg=Error(n(474)),Dh=Error(n(542)),Oh={then:function(){}};function D_(s){return s=s.status,s==="fulfilled"||s==="rejected"}function O_(s,l,c){switch(c=s[c],c===void 0?s.push(l):c!==l&&(l.then(ls,ls),l=c),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,M_(s),s;default:if(typeof l.status=="string")l.then(ls,ls);else{if(s=ur,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=l,s.status="pending",s.then(function(h){if(l.status==="pending"){var v=l;v.status="fulfilled",v.value=h}},function(h){if(l.status==="pending"){var v=l;v.status="rejected",v.reason=h}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,M_(s),s}throw Ao=l,Ic}}function So(s){try{var l=s._init;return l(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(Ao=c,Ic):c}}var Ao=null;function F_(){if(Ao===null)throw Error(n(459));var s=Ao;return Ao=null,s}function M_(s){if(s===Ic||s===Dh)throw Error(n(483))}var Dc=null,lf=0;function Fh(s){var l=lf;return lf+=1,Dc===null&&(Dc=[]),O_(Dc,s,l)}function of(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Mh(s,l){throw l.$$typeof===y?Error(n(525)):(s=Object.prototype.toString.call(l),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function P_(s){function l(oe,ie){if(s){var he=oe.deletions;he===null?(oe.deletions=[ie],oe.flags|=16):he.push(ie)}}function c(oe,ie){if(!s)return null;for(;ie!==null;)l(oe,ie),ie=ie.sibling;return null}function h(oe){for(var ie=new Map;oe!==null;)oe.key!==null?ie.set(oe.key,oe):ie.set(oe.index,oe),oe=oe.sibling;return ie}function v(oe,ie){return oe=li(oe,ie),oe.index=0,oe.sibling=null,oe}function _(oe,ie,he){return oe.index=he,s?(he=oe.alternate,he!==null?(he=he.index,he<ie?(oe.flags|=67108866,ie):he):(oe.flags|=67108866,ie)):(oe.flags|=1048576,ie)}function k(oe){return s&&oe.alternate===null&&(oe.flags|=67108866),oe}function z(oe,ie,he,Ne){return ie===null||ie.tag!==6?(ie=zp(he,oe.mode,Ne),ie.return=oe,ie):(ie=v(ie,he),ie.return=oe,ie)}function ae(oe,ie,he,Ne){var rt=he.type;return rt===b?Ce(oe,ie,he.props.children,Ne,he.key):ie!==null&&(ie.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===D&&So(rt)===ie.type)?(ie=v(ie,he.props),of(ie,he),ie.return=oe,ie):(ie=kh(he.type,he.key,he.props,null,oe.mode,Ne),of(ie,he),ie.return=oe,ie)}function pe(oe,ie,he,Ne){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==he.containerInfo||ie.stateNode.implementation!==he.implementation?(ie=Hp(he,oe.mode,Ne),ie.return=oe,ie):(ie=v(ie,he.children||[]),ie.return=oe,ie)}function Ce(oe,ie,he,Ne,rt){return ie===null||ie.tag!==7?(ie=_o(he,oe.mode,Ne,rt),ie.return=oe,ie):(ie=v(ie,he),ie.return=oe,ie)}function De(oe,ie,he){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=zp(""+ie,oe.mode,he),ie.return=oe,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case w:return he=kh(ie.type,ie.key,ie.props,null,oe.mode,he),of(he,ie),he.return=oe,he;case E:return ie=Hp(ie,oe.mode,he),ie.return=oe,ie;case D:return ie=So(ie),De(oe,ie,he)}if(ye(ie)||j(ie))return ie=_o(ie,oe.mode,he,null),ie.return=oe,ie;if(typeof ie.then=="function")return De(oe,Fh(ie),he);if(ie.$$typeof===C)return De(oe,Rh(oe,ie),he);Mh(oe,ie)}return null}function ve(oe,ie,he,Ne){var rt=ie!==null?ie.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return rt!==null?null:z(oe,ie,""+he,Ne);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case w:return he.key===rt?ae(oe,ie,he,Ne):null;case E:return he.key===rt?pe(oe,ie,he,Ne):null;case D:return he=So(he),ve(oe,ie,he,Ne)}if(ye(he)||j(he))return rt!==null?null:Ce(oe,ie,he,Ne,null);if(typeof he.then=="function")return ve(oe,ie,Fh(he),Ne);if(he.$$typeof===C)return ve(oe,ie,Rh(oe,he),Ne);Mh(oe,he)}return null}function Ee(oe,ie,he,Ne,rt){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return oe=oe.get(he)||null,z(ie,oe,""+Ne,rt);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case w:return oe=oe.get(Ne.key===null?he:Ne.key)||null,ae(ie,oe,Ne,rt);case E:return oe=oe.get(Ne.key===null?he:Ne.key)||null,pe(ie,oe,Ne,rt);case D:return Ne=So(Ne),Ee(oe,ie,he,Ne,rt)}if(ye(Ne)||j(Ne))return oe=oe.get(he)||null,Ce(ie,oe,Ne,rt,null);if(typeof Ne.then=="function")return Ee(oe,ie,he,Fh(Ne),rt);if(Ne.$$typeof===C)return Ee(oe,ie,he,Rh(ie,Ne),rt);Mh(ie,Ne)}return null}function Je(oe,ie,he,Ne){for(var rt=null,Bt=null,tt=ie,wt=ie=0,Nt=null;tt!==null&&wt<he.length;wt++){tt.index>wt?(Nt=tt,tt=null):Nt=tt.sibling;var Vt=ve(oe,tt,he[wt],Ne);if(Vt===null){tt===null&&(tt=Nt);break}s&&tt&&Vt.alternate===null&&l(oe,tt),ie=_(Vt,ie,wt),Bt===null?rt=Vt:Bt.sibling=Vt,Bt=Vt,tt=Nt}if(wt===he.length)return c(oe,tt),Ot&&oi(oe,wt),rt;if(tt===null){for(;wt<he.length;wt++)tt=De(oe,he[wt],Ne),tt!==null&&(ie=_(tt,ie,wt),Bt===null?rt=tt:Bt.sibling=tt,Bt=tt);return Ot&&oi(oe,wt),rt}for(tt=h(tt);wt<he.length;wt++)Nt=Ee(tt,oe,wt,he[wt],Ne),Nt!==null&&(s&&Nt.alternate!==null&&tt.delete(Nt.key===null?wt:Nt.key),ie=_(Nt,ie,wt),Bt===null?rt=Nt:Bt.sibling=Nt,Bt=Nt);return s&&tt.forEach(function(yl){return l(oe,yl)}),Ot&&oi(oe,wt),rt}function it(oe,ie,he,Ne){if(he==null)throw Error(n(151));for(var rt=null,Bt=null,tt=ie,wt=ie=0,Nt=null,Vt=he.next();tt!==null&&!Vt.done;wt++,Vt=he.next()){tt.index>wt?(Nt=tt,tt=null):Nt=tt.sibling;var yl=ve(oe,tt,Vt.value,Ne);if(yl===null){tt===null&&(tt=Nt);break}s&&tt&&yl.alternate===null&&l(oe,tt),ie=_(yl,ie,wt),Bt===null?rt=yl:Bt.sibling=yl,Bt=yl,tt=Nt}if(Vt.done)return c(oe,tt),Ot&&oi(oe,wt),rt;if(tt===null){for(;!Vt.done;wt++,Vt=he.next())Vt=De(oe,Vt.value,Ne),Vt!==null&&(ie=_(Vt,ie,wt),Bt===null?rt=Vt:Bt.sibling=Vt,Bt=Vt);return Ot&&oi(oe,wt),rt}for(tt=h(tt);!Vt.done;wt++,Vt=he.next())Vt=Ee(tt,oe,wt,Vt.value,Ne),Vt!==null&&(s&&Vt.alternate!==null&&tt.delete(Vt.key===null?wt:Vt.key),ie=_(Vt,ie,wt),Bt===null?rt=Vt:Bt.sibling=Vt,Bt=Vt);return s&&tt.forEach(function(H6){return l(oe,H6)}),Ot&&oi(oe,wt),rt}function ir(oe,ie,he,Ne){if(typeof he=="object"&&he!==null&&he.type===b&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case w:e:{for(var rt=he.key;ie!==null;){if(ie.key===rt){if(rt=he.type,rt===b){if(ie.tag===7){c(oe,ie.sibling),Ne=v(ie,he.props.children),Ne.return=oe,oe=Ne;break e}}else if(ie.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===D&&So(rt)===ie.type){c(oe,ie.sibling),Ne=v(ie,he.props),of(Ne,he),Ne.return=oe,oe=Ne;break e}c(oe,ie);break}else l(oe,ie);ie=ie.sibling}he.type===b?(Ne=_o(he.props.children,oe.mode,Ne,he.key),Ne.return=oe,oe=Ne):(Ne=kh(he.type,he.key,he.props,null,oe.mode,Ne),of(Ne,he),Ne.return=oe,oe=Ne)}return k(oe);case E:e:{for(rt=he.key;ie!==null;){if(ie.key===rt)if(ie.tag===4&&ie.stateNode.containerInfo===he.containerInfo&&ie.stateNode.implementation===he.implementation){c(oe,ie.sibling),Ne=v(ie,he.children||[]),Ne.return=oe,oe=Ne;break e}else{c(oe,ie);break}else l(oe,ie);ie=ie.sibling}Ne=Hp(he,oe.mode,Ne),Ne.return=oe,oe=Ne}return k(oe);case D:return he=So(he),ir(oe,ie,he,Ne)}if(ye(he))return Je(oe,ie,he,Ne);if(j(he)){if(rt=j(he),typeof rt!="function")throw Error(n(150));return he=rt.call(he),it(oe,ie,he,Ne)}if(typeof he.then=="function")return ir(oe,ie,Fh(he),Ne);if(he.$$typeof===C)return ir(oe,ie,Rh(oe,he),Ne);Mh(oe,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,ie!==null&&ie.tag===6?(c(oe,ie.sibling),Ne=v(ie,he),Ne.return=oe,oe=Ne):(c(oe,ie),Ne=zp(he,oe.mode,Ne),Ne.return=oe,oe=Ne),k(oe)):c(oe,ie)}return function(oe,ie,he,Ne){try{lf=0;var rt=ir(oe,ie,he,Ne);return Dc=null,rt}catch(tt){if(tt===Ic||tt===Dh)throw tt;var Bt=va(29,tt,null,oe.mode);return Bt.lanes=Ne,Bt.return=oe,Bt}finally{}}}var ko=P_(!0),j_=P_(!1),rl=!1;function tg(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function rg(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function nl(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function al(s,l,c){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,(Gt&2)!==0){var v=h.pending;return v===null?l.next=l:(l.next=v.next,v.next=l),h.pending=l,l=Ah(s),__(s,null,c),l}return Sh(s,h,l,c),Ah(s)}function cf(s,l,c){if(l=l.updateQueue,l!==null&&(l=l.shared,(c&4194048)!==0)){var h=l.lanes;h&=s.pendingLanes,c|=h,l.lanes=c,ri(s,c)}}function ng(s,l){var c=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var v=null,_=null;if(c=c.firstBaseUpdate,c!==null){do{var k={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};_===null?v=_=k:_=_.next=k,c=c.next}while(c!==null);_===null?v=_=l:_=_.next=l}else v=_=l;c={baseState:h.baseState,firstBaseUpdate:v,lastBaseUpdate:_,shared:h.shared,callbacks:h.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=l}var ag=!1;function uf(){if(ag){var s=Rc;if(s!==null)throw s}}function ff(s,l,c,h){ag=!1;var v=s.updateQueue;rl=!1;var _=v.firstBaseUpdate,k=v.lastBaseUpdate,z=v.shared.pending;if(z!==null){v.shared.pending=null;var ae=z,pe=ae.next;ae.next=null,k===null?_=pe:k.next=pe,k=ae;var Ce=s.alternate;Ce!==null&&(Ce=Ce.updateQueue,z=Ce.lastBaseUpdate,z!==k&&(z===null?Ce.firstBaseUpdate=pe:z.next=pe,Ce.lastBaseUpdate=ae))}if(_!==null){var De=v.baseState;k=0,Ce=pe=ae=null,z=_;do{var ve=z.lane&-536870913,Ee=ve!==z.lane;if(Ee?(Ct&ve)===ve:(h&ve)===ve){ve!==0&&ve===Nc&&(ag=!0),Ce!==null&&(Ce=Ce.next={lane:0,tag:z.tag,payload:z.payload,callback:null,next:null});e:{var Je=s,it=z;ve=l;var ir=c;switch(it.tag){case 1:if(Je=it.payload,typeof Je=="function"){De=Je.call(ir,De,ve);break e}De=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=it.payload,ve=typeof Je=="function"?Je.call(ir,De,ve):Je,ve==null)break e;De=x({},De,ve);break e;case 2:rl=!0}}ve=z.callback,ve!==null&&(s.flags|=64,Ee&&(s.flags|=8192),Ee=v.callbacks,Ee===null?v.callbacks=[ve]:Ee.push(ve))}else Ee={lane:ve,tag:z.tag,payload:z.payload,callback:z.callback,next:null},Ce===null?(pe=Ce=Ee,ae=De):Ce=Ce.next=Ee,k|=ve;if(z=z.next,z===null){if(z=v.shared.pending,z===null)break;Ee=z,z=Ee.next,Ee.next=null,v.lastBaseUpdate=Ee,v.shared.pending=null}}while(!0);Ce===null&&(ae=De),v.baseState=ae,v.firstBaseUpdate=pe,v.lastBaseUpdate=Ce,_===null&&(v.shared.lanes=0),cl|=k,s.lanes=k,s.memoizedState=De}}function L_(s,l){if(typeof s!="function")throw Error(n(191,s));s.call(l)}function B_(s,l){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)L_(c[s],l)}var Oc=Q(null),Ph=Q(0);function V_(s,l){s=yi,J(Ph,s),J(Oc,l),yi=s|l.baseLanes}function sg(){J(Ph,yi),J(Oc,Oc.current)}function ig(){yi=Ph.current,L(Oc),L(Ph)}var ya=Q(null),za=null;function sl(s){var l=s.alternate;J(Mr,Mr.current&1),J(ya,s),za===null&&(l===null||Oc.current!==null||l.memoizedState!==null)&&(za=s)}function lg(s){J(Mr,Mr.current),J(ya,s),za===null&&(za=s)}function U_(s){s.tag===22?(J(Mr,Mr.current),J(ya,s),za===null&&(za=s)):il()}function il(){J(Mr,Mr.current),J(ya,ya.current)}function _a(s){L(ya),za===s&&(za=null),L(Mr)}var Mr=Q(0);function jh(s){for(var l=s;l!==null;){if(l.tag===13){var c=l.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||d1(c)||m1(c)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var fi=0,vt=null,ar=null,Yr=null,Lh=!1,Fc=!1,Co=!1,Bh=0,hf=0,Mc=null,O3=0;function Cr(){throw Error(n(321))}function og(s,l){if(l===null)return!1;for(var c=0;c<l.length&&c<s.length;c++)if(!xa(s[c],l[c]))return!1;return!0}function cg(s,l,c,h,v,_){return fi=_,vt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,se.H=s===null||s.memoizedState===null?T2:Tg,Co=!1,_=c(h,v),Co=!1,Fc&&(_=H_(l,c,h,v)),z_(s),_}function z_(s){se.H=pf;var l=ar!==null&&ar.next!==null;if(fi=0,Yr=ar=vt=null,Lh=!1,hf=0,Mc=null,l)throw Error(n(300));s===null||$r||(s=s.dependencies,s!==null&&Nh(s)&&($r=!0))}function H_(s,l,c,h){vt=s;var v=0;do{if(Fc&&(Mc=null),hf=0,Fc=!1,25<=v)throw Error(n(301));if(v+=1,Yr=ar=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}se.H=S2,_=l(c,h)}while(Fc);return _}function F3(){var s=se.H,l=s.useState()[0];return l=typeof l.then=="function"?df(l):l,s=s.useState()[0],(ar!==null?ar.memoizedState:null)!==s&&(vt.flags|=1024),l}function ug(){var s=Bh!==0;return Bh=0,s}function fg(s,l,c){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~c}function hg(s){if(Lh){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Lh=!1}fi=0,Yr=ar=vt=null,Fc=!1,hf=Bh=0,Mc=null}function Yn(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yr===null?vt.memoizedState=Yr=s:Yr=Yr.next=s,Yr}function Pr(){if(ar===null){var s=vt.alternate;s=s!==null?s.memoizedState:null}else s=ar.next;var l=Yr===null?vt.memoizedState:Yr.next;if(l!==null)Yr=l,ar=s;else{if(s===null)throw vt.alternate===null?Error(n(467)):Error(n(310));ar=s,s={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},Yr===null?vt.memoizedState=Yr=s:Yr=Yr.next=s}return Yr}function Vh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function df(s){var l=hf;return hf+=1,Mc===null&&(Mc=[]),s=O_(Mc,s,l),l=vt,(Yr===null?l.memoizedState:Yr.next)===null&&(l=l.alternate,se.H=l===null||l.memoizedState===null?T2:Tg),s}function Uh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return df(s);if(s.$$typeof===C)return _n(s)}throw Error(n(438,String(s)))}function dg(s){var l=null,c=vt.updateQueue;if(c!==null&&(l=c.memoCache),l==null){var h=vt.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(l={data:h.data.map(function(v){return v.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),c===null&&(c=Vh(),vt.updateQueue=c),c.memoCache=l,c=l.data[l.index],c===void 0)for(c=l.data[l.index]=Array(s),h=0;h<s;h++)c[h]=M;return l.index++,c}function hi(s,l){return typeof l=="function"?l(s):l}function zh(s){var l=Pr();return mg(l,ar,s)}function mg(s,l,c){var h=s.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=c;var v=s.baseQueue,_=h.pending;if(_!==null){if(v!==null){var k=v.next;v.next=_.next,_.next=k}l.baseQueue=v=_,h.pending=null}if(_=s.baseState,v===null)s.memoizedState=_;else{l=v.next;var z=k=null,ae=null,pe=l,Ce=!1;do{var De=pe.lane&-536870913;if(De!==pe.lane?(Ct&De)===De:(fi&De)===De){var ve=pe.revertLane;if(ve===0)ae!==null&&(ae=ae.next={lane:0,revertLane:0,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),De===Nc&&(Ce=!0);else if((fi&ve)===ve){pe=pe.next,ve===Nc&&(Ce=!0);continue}else De={lane:0,revertLane:pe.revertLane,gesture:null,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},ae===null?(z=ae=De,k=_):ae=ae.next=De,vt.lanes|=ve,cl|=ve;De=pe.action,Co&&c(_,De),_=pe.hasEagerState?pe.eagerState:c(_,De)}else ve={lane:De,revertLane:pe.revertLane,gesture:pe.gesture,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},ae===null?(z=ae=ve,k=_):ae=ae.next=ve,vt.lanes|=De,cl|=De;pe=pe.next}while(pe!==null&&pe!==l);if(ae===null?k=_:ae.next=z,!xa(_,s.memoizedState)&&($r=!0,Ce&&(c=Rc,c!==null)))throw c;s.memoizedState=_,s.baseState=k,s.baseQueue=ae,h.lastRenderedState=_}return v===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function pg(s){var l=Pr(),c=l.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var h=c.dispatch,v=c.pending,_=l.memoizedState;if(v!==null){c.pending=null;var k=v=v.next;do _=s(_,k.action),k=k.next;while(k!==v);xa(_,l.memoizedState)||($r=!0),l.memoizedState=_,l.baseQueue===null&&(l.baseState=_),c.lastRenderedState=_}return[_,h]}function G_(s,l,c){var h=vt,v=Pr(),_=Ot;if(_){if(c===void 0)throw Error(n(407));c=c()}else c=l();var k=!xa((ar||v).memoizedState,c);if(k&&(v.memoizedState=c,$r=!0),v=v.queue,vg(X_.bind(null,h,v,s),[s]),v.getSnapshot!==l||k||Yr!==null&&Yr.memoizedState.tag&1){if(h.flags|=2048,Pc(9,{destroy:void 0},W_.bind(null,h,v,c,l),null),ur===null)throw Error(n(349));_||(fi&127)!==0||q_(h,l,c)}return c}function q_(s,l,c){s.flags|=16384,s={getSnapshot:l,value:c},l=vt.updateQueue,l===null?(l=Vh(),vt.updateQueue=l,l.stores=[s]):(c=l.stores,c===null?l.stores=[s]:c.push(s))}function W_(s,l,c,h){l.value=c,l.getSnapshot=h,Y_(l)&&$_(s)}function X_(s,l,c){return c(function(){Y_(l)&&$_(s)})}function Y_(s){var l=s.getSnapshot;s=s.value;try{var c=l();return!xa(s,c)}catch{return!0}}function $_(s){var l=yo(s,2);l!==null&&ia(l,s,2)}function gg(s){var l=Yn();if(typeof s=="function"){var c=s;if(s=c(),Co){qr(!0);try{c()}finally{qr(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:s},l}function K_(s,l,c,h){return s.baseState=c,mg(s,ar,typeof h=="function"?h:hi)}function M3(s,l,c,h,v){if(qh(s))throw Error(n(485));if(s=l.action,s!==null){var _={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){_.listeners.push(k)}};se.T!==null?c(!0):_.isTransition=!1,h(_),c=l.pending,c===null?(_.next=l.pending=_,Q_(l,_)):(_.next=c.next,l.pending=c.next=_)}}function Q_(s,l){var c=l.action,h=l.payload,v=s.state;if(l.isTransition){var _=se.T,k={};se.T=k;try{var z=c(v,h),ae=se.S;ae!==null&&ae(k,z),J_(s,l,z)}catch(pe){xg(s,l,pe)}finally{_!==null&&k.types!==null&&(_.types=k.types),se.T=_}}else try{_=c(v,h),J_(s,l,_)}catch(pe){xg(s,l,pe)}}function J_(s,l,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(h){Z_(s,l,h)},function(h){return xg(s,l,h)}):Z_(s,l,c)}function Z_(s,l,c){l.status="fulfilled",l.value=c,e2(l),s.state=c,l=s.pending,l!==null&&(c=l.next,c===l?s.pending=null:(c=c.next,l.next=c,Q_(s,c)))}function xg(s,l,c){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do l.status="rejected",l.reason=c,e2(l),l=l.next;while(l!==h)}s.action=null}function e2(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function t2(s,l){return l}function r2(s,l){if(Ot){var c=ur.formState;if(c!==null){e:{var h=vt;if(Ot){if(mr){t:{for(var v=mr,_=Ua;v.nodeType!==8;){if(!_){v=null;break t}if(v=Ha(v.nextSibling),v===null){v=null;break t}}_=v.data,v=_==="F!"||_==="F"?v:null}if(v){mr=Ha(v.nextSibling),h=v.data==="F!";break e}}el(h)}h=!1}h&&(l=c[0])}}return c=Yn(),c.memoizedState=c.baseState=l,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t2,lastRenderedState:l},c.queue=h,c=w2.bind(null,vt,h),h.dispatch=c,h=gg(!1),_=Eg.bind(null,vt,!1,h.queue),h=Yn(),v={state:l,dispatch:null,action:s,pending:null},h.queue=v,c=M3.bind(null,vt,v,_,c),v.dispatch=c,h.memoizedState=s,[l,c,!1]}function n2(s){var l=Pr();return a2(l,ar,s)}function a2(s,l,c){if(l=mg(s,l,t2)[0],s=zh(hi)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var h=df(l)}catch(k){throw k===Ic?Dh:k}else h=l;l=Pr();var v=l.queue,_=v.dispatch;return c!==l.memoizedState&&(vt.flags|=2048,Pc(9,{destroy:void 0},P3.bind(null,v,c),null)),[h,_,s]}function P3(s,l){s.action=l}function s2(s){var l=Pr(),c=ar;if(c!==null)return a2(l,c,s);Pr(),l=l.memoizedState,c=Pr();var h=c.queue.dispatch;return c.memoizedState=s,[l,h,!1]}function Pc(s,l,c,h){return s={tag:s,create:c,deps:h,inst:l,next:null},l=vt.updateQueue,l===null&&(l=Vh(),vt.updateQueue=l),c=l.lastEffect,c===null?l.lastEffect=s.next=s:(h=c.next,c.next=s,s.next=h,l.lastEffect=s),s}function i2(){return Pr().memoizedState}function Hh(s,l,c,h){var v=Yn();vt.flags|=s,v.memoizedState=Pc(1|l,{destroy:void 0},c,h===void 0?null:h)}function Gh(s,l,c,h){var v=Pr();h=h===void 0?null:h;var _=v.memoizedState.inst;ar!==null&&h!==null&&og(h,ar.memoizedState.deps)?v.memoizedState=Pc(l,_,c,h):(vt.flags|=s,v.memoizedState=Pc(1|l,_,c,h))}function l2(s,l){Hh(8390656,8,s,l)}function vg(s,l){Gh(2048,8,s,l)}function j3(s){vt.flags|=4;var l=vt.updateQueue;if(l===null)l=Vh(),vt.updateQueue=l,l.events=[s];else{var c=l.events;c===null?l.events=[s]:c.push(s)}}function o2(s){var l=Pr().memoizedState;return j3({ref:l,nextImpl:s}),function(){if((Gt&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function c2(s,l){return Gh(4,2,s,l)}function u2(s,l){return Gh(4,4,s,l)}function f2(s,l){if(typeof l=="function"){s=s();var c=l(s);return function(){typeof c=="function"?c():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function h2(s,l,c){c=c!=null?c.concat([s]):null,Gh(4,4,f2.bind(null,l,s),c)}function yg(){}function d2(s,l){var c=Pr();l=l===void 0?null:l;var h=c.memoizedState;return l!==null&&og(l,h[1])?h[0]:(c.memoizedState=[s,l],s)}function m2(s,l){var c=Pr();l=l===void 0?null:l;var h=c.memoizedState;if(l!==null&&og(l,h[1]))return h[0];if(h=s(),Co){qr(!0);try{s()}finally{qr(!1)}}return c.memoizedState=[h,l],h}function _g(s,l,c){return c===void 0||(fi&1073741824)!==0&&(Ct&261930)===0?s.memoizedState=l:(s.memoizedState=c,s=pw(),vt.lanes|=s,cl|=s,c)}function p2(s,l,c,h){return xa(c,l)?c:Oc.current!==null?(s=_g(s,c,h),xa(s,l)||($r=!0),s):(fi&42)===0||(fi&1073741824)!==0&&(Ct&261930)===0?($r=!0,s.memoizedState=c):(s=pw(),vt.lanes|=s,cl|=s,l)}function g2(s,l,c,h,v){var _=ce.p;ce.p=_!==0&&8>_?_:8;var k=se.T,z={};se.T=z,Eg(s,!1,l,c);try{var ae=v(),pe=se.S;if(pe!==null&&pe(z,ae),ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var Ce=D3(ae,h);mf(s,l,Ce,Ea(s))}else mf(s,l,h,Ea(s))}catch(De){mf(s,l,{then:function(){},status:"rejected",reason:De},Ea())}finally{ce.p=_,k!==null&&z.types!==null&&(k.types=z.types),se.T=k}}function L3(){}function wg(s,l,c,h){if(s.tag!==5)throw Error(n(476));var v=x2(s).queue;g2(s,v,l,le,c===null?L3:function(){return v2(s),c(h)})}function x2(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:le,baseState:le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:le},next:null};var c={};return l.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:hi,lastRenderedState:c},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function v2(s){var l=x2(s);l.next===null&&(l=s.alternate.memoizedState),mf(s,l.next.queue,{},Ea())}function bg(){return _n(If)}function y2(){return Pr().memoizedState}function _2(){return Pr().memoizedState}function B3(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var c=Ea();s=nl(c);var h=al(l,s,c);h!==null&&(ia(h,l,c),cf(h,l,c)),l={cache:Qp()},s.payload=l;return}l=l.return}}function V3(s,l,c){var h=Ea();c={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},qh(s)?b2(l,c):(c=Vp(s,l,c,h),c!==null&&(ia(c,s,h),E2(c,l,h)))}function w2(s,l,c){var h=Ea();mf(s,l,c,h)}function mf(s,l,c,h){var v={lane:h,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(qh(s))b2(l,v);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=l.lastRenderedReducer,_!==null))try{var k=l.lastRenderedState,z=_(k,c);if(v.hasEagerState=!0,v.eagerState=z,xa(z,k))return Sh(s,l,v,0),ur===null&&Th(),!1}catch{}finally{}if(c=Vp(s,l,v,h),c!==null)return ia(c,s,h),E2(c,l,h),!0}return!1}function Eg(s,l,c,h){if(h={lane:2,revertLane:t1(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},qh(s)){if(l)throw Error(n(479))}else l=Vp(s,c,h,2),l!==null&&ia(l,s,2)}function qh(s){var l=s.alternate;return s===vt||l!==null&&l===vt}function b2(s,l){Fc=Lh=!0;var c=s.pending;c===null?l.next=l:(l.next=c.next,c.next=l),s.pending=l}function E2(s,l,c){if((c&4194048)!==0){var h=l.lanes;h&=s.pendingLanes,c|=h,l.lanes=c,ri(s,c)}}var pf={readContext:_n,use:Uh,useCallback:Cr,useContext:Cr,useEffect:Cr,useImperativeHandle:Cr,useLayoutEffect:Cr,useInsertionEffect:Cr,useMemo:Cr,useReducer:Cr,useRef:Cr,useState:Cr,useDebugValue:Cr,useDeferredValue:Cr,useTransition:Cr,useSyncExternalStore:Cr,useId:Cr,useHostTransitionStatus:Cr,useFormState:Cr,useActionState:Cr,useOptimistic:Cr,useMemoCache:Cr,useCacheRefresh:Cr};pf.useEffectEvent=Cr;var T2={readContext:_n,use:Uh,useCallback:function(s,l){return Yn().memoizedState=[s,l===void 0?null:l],s},useContext:_n,useEffect:l2,useImperativeHandle:function(s,l,c){c=c!=null?c.concat([s]):null,Hh(4194308,4,f2.bind(null,l,s),c)},useLayoutEffect:function(s,l){return Hh(4194308,4,s,l)},useInsertionEffect:function(s,l){Hh(4,2,s,l)},useMemo:function(s,l){var c=Yn();l=l===void 0?null:l;var h=s();if(Co){qr(!0);try{s()}finally{qr(!1)}}return c.memoizedState=[h,l],h},useReducer:function(s,l,c){var h=Yn();if(c!==void 0){var v=c(l);if(Co){qr(!0);try{c(l)}finally{qr(!1)}}}else v=l;return h.memoizedState=h.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},h.queue=s,s=s.dispatch=V3.bind(null,vt,s),[h.memoizedState,s]},useRef:function(s){var l=Yn();return s={current:s},l.memoizedState=s},useState:function(s){s=gg(s);var l=s.queue,c=w2.bind(null,vt,l);return l.dispatch=c,[s.memoizedState,c]},useDebugValue:yg,useDeferredValue:function(s,l){var c=Yn();return _g(c,s,l)},useTransition:function(){var s=gg(!1);return s=g2.bind(null,vt,s.queue,!0,!1),Yn().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,c){var h=vt,v=Yn();if(Ot){if(c===void 0)throw Error(n(407));c=c()}else{if(c=l(),ur===null)throw Error(n(349));(Ct&127)!==0||q_(h,l,c)}v.memoizedState=c;var _={value:c,getSnapshot:l};return v.queue=_,l2(X_.bind(null,h,_,s),[s]),h.flags|=2048,Pc(9,{destroy:void 0},W_.bind(null,h,_,c,l),null),c},useId:function(){var s=Yn(),l=ur.identifierPrefix;if(Ot){var c=Ds,h=Is;c=(h&~(1<<32-dr(h)-1)).toString(32)+c,l="_"+l+"R_"+c,c=Bh++,0<c&&(l+="H"+c.toString(32)),l+="_"}else c=O3++,l="_"+l+"r_"+c.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:bg,useFormState:r2,useActionState:r2,useOptimistic:function(s){var l=Yn();l.memoizedState=l.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=c,l=Eg.bind(null,vt,!0,c),c.dispatch=l,[s,l]},useMemoCache:dg,useCacheRefresh:function(){return Yn().memoizedState=B3.bind(null,vt)},useEffectEvent:function(s){var l=Yn(),c={impl:s};return l.memoizedState=c,function(){if((Gt&2)!==0)throw Error(n(440));return c.impl.apply(void 0,arguments)}}},Tg={readContext:_n,use:Uh,useCallback:d2,useContext:_n,useEffect:vg,useImperativeHandle:h2,useInsertionEffect:c2,useLayoutEffect:u2,useMemo:m2,useReducer:zh,useRef:i2,useState:function(){return zh(hi)},useDebugValue:yg,useDeferredValue:function(s,l){var c=Pr();return p2(c,ar.memoizedState,s,l)},useTransition:function(){var s=zh(hi)[0],l=Pr().memoizedState;return[typeof s=="boolean"?s:df(s),l]},useSyncExternalStore:G_,useId:y2,useHostTransitionStatus:bg,useFormState:n2,useActionState:n2,useOptimistic:function(s,l){var c=Pr();return K_(c,ar,s,l)},useMemoCache:dg,useCacheRefresh:_2};Tg.useEffectEvent=o2;var S2={readContext:_n,use:Uh,useCallback:d2,useContext:_n,useEffect:vg,useImperativeHandle:h2,useInsertionEffect:c2,useLayoutEffect:u2,useMemo:m2,useReducer:pg,useRef:i2,useState:function(){return pg(hi)},useDebugValue:yg,useDeferredValue:function(s,l){var c=Pr();return ar===null?_g(c,s,l):p2(c,ar.memoizedState,s,l)},useTransition:function(){var s=pg(hi)[0],l=Pr().memoizedState;return[typeof s=="boolean"?s:df(s),l]},useSyncExternalStore:G_,useId:y2,useHostTransitionStatus:bg,useFormState:s2,useActionState:s2,useOptimistic:function(s,l){var c=Pr();return ar!==null?K_(c,ar,s,l):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:dg,useCacheRefresh:_2};S2.useEffectEvent=o2;function Sg(s,l,c,h){l=s.memoizedState,c=c(h,l),c=c==null?l:x({},l,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Ag={enqueueSetState:function(s,l,c){s=s._reactInternals;var h=Ea(),v=nl(h);v.payload=l,c!=null&&(v.callback=c),l=al(s,v,h),l!==null&&(ia(l,s,h),cf(l,s,h))},enqueueReplaceState:function(s,l,c){s=s._reactInternals;var h=Ea(),v=nl(h);v.tag=1,v.payload=l,c!=null&&(v.callback=c),l=al(s,v,h),l!==null&&(ia(l,s,h),cf(l,s,h))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var c=Ea(),h=nl(c);h.tag=2,l!=null&&(h.callback=l),l=al(s,h,c),l!==null&&(ia(l,s,c),cf(l,s,c))}};function A2(s,l,c,h,v,_,k){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,_,k):l.prototype&&l.prototype.isPureReactComponent?!ef(c,h)||!ef(v,_):!0}function k2(s,l,c,h){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(c,h),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(c,h),l.state!==s&&Ag.enqueueReplaceState(l,l.state,null)}function No(s,l){var c=l;if("ref"in l){c={};for(var h in l)h!=="ref"&&(c[h]=l[h])}if(s=s.defaultProps){c===l&&(c=x({},c));for(var v in s)c[v]===void 0&&(c[v]=s[v])}return c}function C2(s){Eh(s)}function N2(s){console.error(s)}function R2(s){Eh(s)}function Wh(s,l){try{var c=s.onUncaughtError;c(l.value,{componentStack:l.stack})}catch(h){setTimeout(function(){throw h})}}function I2(s,l,c){try{var h=s.onCaughtError;h(c.value,{componentStack:c.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function kg(s,l,c){return c=nl(c),c.tag=3,c.payload={element:null},c.callback=function(){Wh(s,l)},c}function D2(s){return s=nl(s),s.tag=3,s}function O2(s,l,c,h){var v=c.type.getDerivedStateFromError;if(typeof v=="function"){var _=h.value;s.payload=function(){return v(_)},s.callback=function(){I2(l,c,h)}}var k=c.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(s.callback=function(){I2(l,c,h),typeof v!="function"&&(ul===null?ul=new Set([this]):ul.add(this));var z=h.stack;this.componentDidCatch(h.value,{componentStack:z!==null?z:""})})}function U3(s,l,c,h,v){if(c.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(l=c.alternate,l!==null&&Cc(l,c,v,!0),c=ya.current,c!==null){switch(c.tag){case 31:case 13:return za===null?ad():c.alternate===null&&Nr===0&&(Nr=3),c.flags&=-257,c.flags|=65536,c.lanes=v,h===Oh?c.flags|=16384:(l=c.updateQueue,l===null?c.updateQueue=new Set([h]):l.add(h),Jg(s,h,v)),!1;case 22:return c.flags|=65536,h===Oh?c.flags|=16384:(l=c.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([h])},c.updateQueue=l):(c=l.retryQueue,c===null?l.retryQueue=new Set([h]):c.add(h)),Jg(s,h,v)),!1}throw Error(n(435,c.tag))}return Jg(s,h,v),ad(),!1}if(Ot)return l=ya.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=v,h!==Wp&&(s=Error(n(422),{cause:h}),nf(La(s,c)))):(h!==Wp&&(l=Error(n(423),{cause:h}),nf(La(l,c))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,h=La(h,c),v=kg(s.stateNode,h,v),ng(s,v),Nr!==4&&(Nr=2)),!1;var _=Error(n(520),{cause:h});if(_=La(_,c),Ef===null?Ef=[_]:Ef.push(_),Nr!==4&&(Nr=2),l===null)return!0;h=La(h,c),c=l;do{switch(c.tag){case 3:return c.flags|=65536,s=v&-v,c.lanes|=s,s=kg(c.stateNode,h,s),ng(c,s),!1;case 1:if(l=c.type,_=c.stateNode,(c.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(ul===null||!ul.has(_))))return c.flags|=65536,v&=-v,c.lanes|=v,v=D2(v),O2(v,s,c,h),ng(c,v),!1}c=c.return}while(c!==null);return!1}var Cg=Error(n(461)),$r=!1;function wn(s,l,c,h){l.child=s===null?j_(l,null,c,h):ko(l,s.child,c,h)}function F2(s,l,c,h,v){c=c.render;var _=l.ref;if("ref"in h){var k={};for(var z in h)z!=="ref"&&(k[z]=h[z])}else k=h;return Eo(l),h=cg(s,l,c,k,_,v),z=ug(),s!==null&&!$r?(fg(s,l,v),di(s,l,v)):(Ot&&z&&Gp(l),l.flags|=1,wn(s,l,h,v),l.child)}function M2(s,l,c,h,v){if(s===null){var _=c.type;return typeof _=="function"&&!Up(_)&&_.defaultProps===void 0&&c.compare===null?(l.tag=15,l.type=_,P2(s,l,_,h,v)):(s=kh(c.type,null,h,l,l.mode,v),s.ref=l.ref,s.return=l,l.child=s)}if(_=s.child,!Pg(s,v)){var k=_.memoizedProps;if(c=c.compare,c=c!==null?c:ef,c(k,h)&&s.ref===l.ref)return di(s,l,v)}return l.flags|=1,s=li(_,h),s.ref=l.ref,s.return=l,l.child=s}function P2(s,l,c,h,v){if(s!==null){var _=s.memoizedProps;if(ef(_,h)&&s.ref===l.ref)if($r=!1,l.pendingProps=h=_,Pg(s,v))(s.flags&131072)!==0&&($r=!0);else return l.lanes=s.lanes,di(s,l,v)}return Ng(s,l,c,h,v)}function j2(s,l,c,h){var v=h.children,_=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((l.flags&128)!==0){if(_=_!==null?_.baseLanes|c:c,s!==null){for(h=l.child=s.child,v=0;h!==null;)v=v|h.lanes|h.childLanes,h=h.sibling;h=v&~_}else h=0,l.child=null;return L2(s,l,_,c,h)}if((c&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Ih(l,_!==null?_.cachePool:null),_!==null?V_(l,_):sg(),U_(l);else return h=l.lanes=536870912,L2(s,l,_!==null?_.baseLanes|c:c,c,h)}else _!==null?(Ih(l,_.cachePool),V_(l,_),il(),l.memoizedState=null):(s!==null&&Ih(l,null),sg(),il());return wn(s,l,v,c),l.child}function gf(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function L2(s,l,c,h,v){var _=Zp();return _=_===null?null:{parent:Xr._currentValue,pool:_},l.memoizedState={baseLanes:c,cachePool:_},s!==null&&Ih(l,null),sg(),U_(l),s!==null&&Cc(s,l,h,!0),l.childLanes=v,null}function Xh(s,l){return l=$h({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function B2(s,l,c){return ko(l,s.child,null,c),s=Xh(l,l.pendingProps),s.flags|=2,_a(l),l.memoizedState=null,s}function z3(s,l,c){var h=l.pendingProps,v=(l.flags&128)!==0;if(l.flags&=-129,s===null){if(Ot){if(h.mode==="hidden")return s=Xh(l,h),l.lanes=536870912,gf(null,s);if(lg(l),(s=mr)?(s=Qw(s,Ua),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:Ji!==null?{id:Is,overflow:Ds}:null,retryLane:536870912,hydrationErrors:null},c=b_(s),c.return=l,l.child=c,yn=l,mr=null)):s=null,s===null)throw el(l);return l.lanes=536870912,null}return Xh(l,h)}var _=s.memoizedState;if(_!==null){var k=_.dehydrated;if(lg(l),v)if(l.flags&256)l.flags&=-257,l=B2(s,l,c);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(n(558));else if($r||Cc(s,l,c,!1),v=(c&s.childLanes)!==0,$r||v){if(h=ur,h!==null&&(k=io(h,c),k!==0&&k!==_.retryLane))throw _.retryLane=k,yo(s,k),ia(h,s,k),Cg;ad(),l=B2(s,l,c)}else s=_.treeContext,mr=Ha(k.nextSibling),yn=l,Ot=!0,Zi=null,Ua=!1,s!==null&&S_(l,s),l=Xh(l,h),l.flags|=4096;return l}return s=li(s.child,{mode:h.mode,children:h.children}),s.ref=l.ref,l.child=s,s.return=l,s}function Yh(s,l){var c=l.ref;if(c===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(s===null||s.ref!==c)&&(l.flags|=4194816)}}function Ng(s,l,c,h,v){return Eo(l),c=cg(s,l,c,h,void 0,v),h=ug(),s!==null&&!$r?(fg(s,l,v),di(s,l,v)):(Ot&&h&&Gp(l),l.flags|=1,wn(s,l,c,v),l.child)}function V2(s,l,c,h,v,_){return Eo(l),l.updateQueue=null,c=H_(l,h,c,v),z_(s),h=ug(),s!==null&&!$r?(fg(s,l,_),di(s,l,_)):(Ot&&h&&Gp(l),l.flags|=1,wn(s,l,c,_),l.child)}function U2(s,l,c,h,v){if(Eo(l),l.stateNode===null){var _=Tc,k=c.contextType;typeof k=="object"&&k!==null&&(_=_n(k)),_=new c(h,_),l.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Ag,l.stateNode=_,_._reactInternals=l,_=l.stateNode,_.props=h,_.state=l.memoizedState,_.refs={},tg(l),k=c.contextType,_.context=typeof k=="object"&&k!==null?_n(k):Tc,_.state=l.memoizedState,k=c.getDerivedStateFromProps,typeof k=="function"&&(Sg(l,c,k,h),_.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(k=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),k!==_.state&&Ag.enqueueReplaceState(_,_.state,null),ff(l,h,_,v),uf(),_.state=l.memoizedState),typeof _.componentDidMount=="function"&&(l.flags|=4194308),h=!0}else if(s===null){_=l.stateNode;var z=l.memoizedProps,ae=No(c,z);_.props=ae;var pe=_.context,Ce=c.contextType;k=Tc,typeof Ce=="object"&&Ce!==null&&(k=_n(Ce));var De=c.getDerivedStateFromProps;Ce=typeof De=="function"||typeof _.getSnapshotBeforeUpdate=="function",z=l.pendingProps!==z,Ce||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(z||pe!==k)&&k2(l,_,h,k),rl=!1;var ve=l.memoizedState;_.state=ve,ff(l,h,_,v),uf(),pe=l.memoizedState,z||ve!==pe||rl?(typeof De=="function"&&(Sg(l,c,De,h),pe=l.memoizedState),(ae=rl||A2(l,c,ae,h,ve,pe,k))?(Ce||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(l.flags|=4194308)):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=h,l.memoizedState=pe),_.props=h,_.state=pe,_.context=k,h=ae):(typeof _.componentDidMount=="function"&&(l.flags|=4194308),h=!1)}else{_=l.stateNode,rg(s,l),k=l.memoizedProps,Ce=No(c,k),_.props=Ce,De=l.pendingProps,ve=_.context,pe=c.contextType,ae=Tc,typeof pe=="object"&&pe!==null&&(ae=_n(pe)),z=c.getDerivedStateFromProps,(pe=typeof z=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(k!==De||ve!==ae)&&k2(l,_,h,ae),rl=!1,ve=l.memoizedState,_.state=ve,ff(l,h,_,v),uf();var Ee=l.memoizedState;k!==De||ve!==Ee||rl||s!==null&&s.dependencies!==null&&Nh(s.dependencies)?(typeof z=="function"&&(Sg(l,c,z,h),Ee=l.memoizedState),(Ce=rl||A2(l,c,Ce,h,ve,Ee,ae)||s!==null&&s.dependencies!==null&&Nh(s.dependencies))?(pe||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(h,Ee,ae),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(h,Ee,ae)),typeof _.componentDidUpdate=="function"&&(l.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof _.componentDidUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=1024),l.memoizedProps=h,l.memoizedState=Ee),_.props=h,_.state=Ee,_.context=ae,h=Ce):(typeof _.componentDidUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||k===s.memoizedProps&&ve===s.memoizedState||(l.flags|=1024),h=!1)}return _=h,Yh(s,l),h=(l.flags&128)!==0,_||h?(_=l.stateNode,c=h&&typeof c.getDerivedStateFromError!="function"?null:_.render(),l.flags|=1,s!==null&&h?(l.child=ko(l,s.child,null,v),l.child=ko(l,null,c,v)):wn(s,l,c,v),l.memoizedState=_.state,s=l.child):s=di(s,l,v),s}function z2(s,l,c,h){return wo(),l.flags|=256,wn(s,l,c,h),l.child}var Rg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ig(s){return{baseLanes:s,cachePool:I_()}}function Dg(s,l,c){return s=s!==null?s.childLanes&~c:0,l&&(s|=ba),s}function H2(s,l,c){var h=l.pendingProps,v=!1,_=(l.flags&128)!==0,k;if((k=_)||(k=s!==null&&s.memoizedState===null?!1:(Mr.current&2)!==0),k&&(v=!0,l.flags&=-129),k=(l.flags&32)!==0,l.flags&=-33,s===null){if(Ot){if(v?sl(l):il(),(s=mr)?(s=Qw(s,Ua),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:Ji!==null?{id:Is,overflow:Ds}:null,retryLane:536870912,hydrationErrors:null},c=b_(s),c.return=l,l.child=c,yn=l,mr=null)):s=null,s===null)throw el(l);return m1(s)?l.lanes=32:l.lanes=536870912,null}var z=h.children;return h=h.fallback,v?(il(),v=l.mode,z=$h({mode:"hidden",children:z},v),h=_o(h,v,c,null),z.return=l,h.return=l,z.sibling=h,l.child=z,h=l.child,h.memoizedState=Ig(c),h.childLanes=Dg(s,k,c),l.memoizedState=Rg,gf(null,h)):(sl(l),Og(l,z))}var ae=s.memoizedState;if(ae!==null&&(z=ae.dehydrated,z!==null)){if(_)l.flags&256?(sl(l),l.flags&=-257,l=Fg(s,l,c)):l.memoizedState!==null?(il(),l.child=s.child,l.flags|=128,l=null):(il(),z=h.fallback,v=l.mode,h=$h({mode:"visible",children:h.children},v),z=_o(z,v,c,null),z.flags|=2,h.return=l,z.return=l,h.sibling=z,l.child=h,ko(l,s.child,null,c),h=l.child,h.memoizedState=Ig(c),h.childLanes=Dg(s,k,c),l.memoizedState=Rg,l=gf(null,h));else if(sl(l),m1(z)){if(k=z.nextSibling&&z.nextSibling.dataset,k)var pe=k.dgst;k=pe,h=Error(n(419)),h.stack="",h.digest=k,nf({value:h,source:null,stack:null}),l=Fg(s,l,c)}else if($r||Cc(s,l,c,!1),k=(c&s.childLanes)!==0,$r||k){if(k=ur,k!==null&&(h=io(k,c),h!==0&&h!==ae.retryLane))throw ae.retryLane=h,yo(s,h),ia(k,s,h),Cg;d1(z)||ad(),l=Fg(s,l,c)}else d1(z)?(l.flags|=192,l.child=s.child,l=null):(s=ae.treeContext,mr=Ha(z.nextSibling),yn=l,Ot=!0,Zi=null,Ua=!1,s!==null&&S_(l,s),l=Og(l,h.children),l.flags|=4096);return l}return v?(il(),z=h.fallback,v=l.mode,ae=s.child,pe=ae.sibling,h=li(ae,{mode:"hidden",children:h.children}),h.subtreeFlags=ae.subtreeFlags&65011712,pe!==null?z=li(pe,z):(z=_o(z,v,c,null),z.flags|=2),z.return=l,h.return=l,h.sibling=z,l.child=h,gf(null,h),h=l.child,z=s.child.memoizedState,z===null?z=Ig(c):(v=z.cachePool,v!==null?(ae=Xr._currentValue,v=v.parent!==ae?{parent:ae,pool:ae}:v):v=I_(),z={baseLanes:z.baseLanes|c,cachePool:v}),h.memoizedState=z,h.childLanes=Dg(s,k,c),l.memoizedState=Rg,gf(s.child,h)):(sl(l),c=s.child,s=c.sibling,c=li(c,{mode:"visible",children:h.children}),c.return=l,c.sibling=null,s!==null&&(k=l.deletions,k===null?(l.deletions=[s],l.flags|=16):k.push(s)),l.child=c,l.memoizedState=null,c)}function Og(s,l){return l=$h({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function $h(s,l){return s=va(22,s,null,l),s.lanes=0,s}function Fg(s,l,c){return ko(l,s.child,null,c),s=Og(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function G2(s,l,c){s.lanes|=l;var h=s.alternate;h!==null&&(h.lanes|=l),$p(s.return,l,c)}function Mg(s,l,c,h,v,_){var k=s.memoizedState;k===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:v,treeForkCount:_}:(k.isBackwards=l,k.rendering=null,k.renderingStartTime=0,k.last=h,k.tail=c,k.tailMode=v,k.treeForkCount=_)}function q2(s,l,c){var h=l.pendingProps,v=h.revealOrder,_=h.tail;h=h.children;var k=Mr.current,z=(k&2)!==0;if(z?(k=k&1|2,l.flags|=128):k&=1,J(Mr,k),wn(s,l,h,c),h=Ot?rf:0,!z&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&G2(s,c,l);else if(s.tag===19)G2(s,c,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(c=l.child,v=null;c!==null;)s=c.alternate,s!==null&&jh(s)===null&&(v=c),c=c.sibling;c=v,c===null?(v=l.child,l.child=null):(v=c.sibling,c.sibling=null),Mg(l,!1,v,c,_,h);break;case"backwards":case"unstable_legacy-backwards":for(c=null,v=l.child,l.child=null;v!==null;){if(s=v.alternate,s!==null&&jh(s)===null){l.child=v;break}s=v.sibling,v.sibling=c,c=v,v=s}Mg(l,!0,c,null,_,h);break;case"together":Mg(l,!1,null,null,void 0,h);break;default:l.memoizedState=null}return l.child}function di(s,l,c){if(s!==null&&(l.dependencies=s.dependencies),cl|=l.lanes,(c&l.childLanes)===0)if(s!==null){if(Cc(s,l,c,!1),(c&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(n(153));if(l.child!==null){for(s=l.child,c=li(s,s.pendingProps),l.child=c,c.return=l;s.sibling!==null;)s=s.sibling,c=c.sibling=li(s,s.pendingProps),c.return=l;c.sibling=null}return l.child}function Pg(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Nh(s)))}function H3(s,l,c){switch(l.tag){case 3:Re(l,l.stateNode.containerInfo),tl(l,Xr,s.memoizedState.cache),wo();break;case 27:case 5:Fe(l);break;case 4:Re(l,l.stateNode.containerInfo);break;case 10:tl(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,lg(l),null;break;case 13:var h=l.memoizedState;if(h!==null)return h.dehydrated!==null?(sl(l),l.flags|=128,null):(c&l.child.childLanes)!==0?H2(s,l,c):(sl(l),s=di(s,l,c),s!==null?s.sibling:null);sl(l);break;case 19:var v=(s.flags&128)!==0;if(h=(c&l.childLanes)!==0,h||(Cc(s,l,c,!1),h=(c&l.childLanes)!==0),v){if(h)return q2(s,l,c);l.flags|=128}if(v=l.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),J(Mr,Mr.current),h)break;return null;case 22:return l.lanes=0,j2(s,l,c,l.pendingProps);case 24:tl(l,Xr,s.memoizedState.cache)}return di(s,l,c)}function W2(s,l,c){if(s!==null)if(s.memoizedProps!==l.pendingProps)$r=!0;else{if(!Pg(s,c)&&(l.flags&128)===0)return $r=!1,H3(s,l,c);$r=(s.flags&131072)!==0}else $r=!1,Ot&&(l.flags&1048576)!==0&&T_(l,rf,l.index);switch(l.lanes=0,l.tag){case 16:e:{var h=l.pendingProps;if(s=So(l.elementType),l.type=s,typeof s=="function")Up(s)?(h=No(s,h),l.tag=1,l=U2(null,l,s,h,c)):(l.tag=0,l=Ng(null,l,s,h,c));else{if(s!=null){var v=s.$$typeof;if(v===G){l.tag=11,l=F2(null,l,s,h,c);break e}else if(v===A){l.tag=14,l=M2(null,l,s,h,c);break e}}throw l=be(s)||s,Error(n(306,l,""))}}return l;case 0:return Ng(s,l,l.type,l.pendingProps,c);case 1:return h=l.type,v=No(h,l.pendingProps),U2(s,l,h,v,c);case 3:e:{if(Re(l,l.stateNode.containerInfo),s===null)throw Error(n(387));h=l.pendingProps;var _=l.memoizedState;v=_.element,rg(s,l),ff(l,h,null,c);var k=l.memoizedState;if(h=k.cache,tl(l,Xr,h),h!==_.cache&&Kp(l,[Xr],c,!0),uf(),h=k.element,_.isDehydrated)if(_={element:h,isDehydrated:!1,cache:k.cache},l.updateQueue.baseState=_,l.memoizedState=_,l.flags&256){l=z2(s,l,h,c);break e}else if(h!==v){v=La(Error(n(424)),l),nf(v),l=z2(s,l,h,c);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(mr=Ha(s.firstChild),yn=l,Ot=!0,Zi=null,Ua=!0,c=j_(l,null,h,c),l.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(wo(),h===v){l=di(s,l,c);break e}wn(s,l,h,c)}l=l.child}return l;case 26:return Yh(s,l),s===null?(c=nb(l.type,null,l.pendingProps,null))?l.memoizedState=c:Ot||(c=l.type,s=l.pendingProps,h=fd(ue.current).createElement(c),h[X]=l,h[K]=s,bn(h,c,s),Ze(h),l.stateNode=h):l.memoizedState=nb(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Fe(l),s===null&&Ot&&(h=l.stateNode=eb(l.type,l.pendingProps,ue.current),yn=l,Ua=!0,v=mr,ml(l.type)?(p1=v,mr=Ha(h.firstChild)):mr=v),wn(s,l,l.pendingProps.children,c),Yh(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&Ot&&((v=h=mr)&&(h=y6(h,l.type,l.pendingProps,Ua),h!==null?(l.stateNode=h,yn=l,mr=Ha(h.firstChild),Ua=!1,v=!0):v=!1),v||el(l)),Fe(l),v=l.type,_=l.pendingProps,k=s!==null?s.memoizedProps:null,h=_.children,u1(v,_)?h=null:k!==null&&u1(v,k)&&(l.flags|=32),l.memoizedState!==null&&(v=cg(s,l,F3,null,null,c),If._currentValue=v),Yh(s,l),wn(s,l,h,c),l.child;case 6:return s===null&&Ot&&((s=c=mr)&&(c=_6(c,l.pendingProps,Ua),c!==null?(l.stateNode=c,yn=l,mr=null,s=!0):s=!1),s||el(l)),null;case 13:return H2(s,l,c);case 4:return Re(l,l.stateNode.containerInfo),h=l.pendingProps,s===null?l.child=ko(l,null,h,c):wn(s,l,h,c),l.child;case 11:return F2(s,l,l.type,l.pendingProps,c);case 7:return wn(s,l,l.pendingProps,c),l.child;case 8:return wn(s,l,l.pendingProps.children,c),l.child;case 12:return wn(s,l,l.pendingProps.children,c),l.child;case 10:return h=l.pendingProps,tl(l,l.type,h.value),wn(s,l,h.children,c),l.child;case 9:return v=l.type._context,h=l.pendingProps.children,Eo(l),v=_n(v),h=h(v),l.flags|=1,wn(s,l,h,c),l.child;case 14:return M2(s,l,l.type,l.pendingProps,c);case 15:return P2(s,l,l.type,l.pendingProps,c);case 19:return q2(s,l,c);case 31:return z3(s,l,c);case 22:return j2(s,l,c,l.pendingProps);case 24:return Eo(l),h=_n(Xr),s===null?(v=Zp(),v===null&&(v=ur,_=Qp(),v.pooledCache=_,_.refCount++,_!==null&&(v.pooledCacheLanes|=c),v=_),l.memoizedState={parent:h,cache:v},tg(l),tl(l,Xr,v)):((s.lanes&c)!==0&&(rg(s,l),ff(l,null,null,c),uf()),v=s.memoizedState,_=l.memoizedState,v.parent!==h?(v={parent:h,cache:h},l.memoizedState=v,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=v),tl(l,Xr,h)):(h=_.cache,tl(l,Xr,h),h!==v.cache&&Kp(l,[Xr],c,!0))),wn(s,l,l.pendingProps.children,c),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function mi(s){s.flags|=4}function jg(s,l,c,h,v){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(yw())s.flags|=8192;else throw Ao=Oh,eg}else s.flags&=-16777217}function X2(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!ob(l))if(yw())s.flags|=8192;else throw Ao=Oh,eg}function Kh(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?fc():536870912,s.lanes|=l,Vc|=l)}function xf(s,l){if(!Ot)switch(s.tailMode){case"hidden":l=s.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function pr(s){var l=s.alternate!==null&&s.alternate.child===s.child,c=0,h=0;if(l)for(var v=s.child;v!==null;)c|=v.lanes|v.childLanes,h|=v.subtreeFlags&65011712,h|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)c|=v.lanes|v.childLanes,h|=v.subtreeFlags,h|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=h,s.childLanes=c,l}function G3(s,l,c){var h=l.pendingProps;switch(qp(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pr(l),null;case 1:return pr(l),null;case 3:return c=l.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),l.memoizedState.cache!==h&&(l.flags|=2048),ui(Xr),Ae(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(kc(l)?mi(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Xp())),pr(l),null;case 26:var v=l.type,_=l.memoizedState;return s===null?(mi(l),_!==null?(pr(l),X2(l,_)):(pr(l),jg(l,v,null,h,c))):_?_!==s.memoizedState?(mi(l),pr(l),X2(l,_)):(pr(l),l.flags&=-16777217):(s=s.memoizedProps,s!==h&&mi(l),pr(l),jg(l,v,s,h,c)),null;case 27:if(st(l),c=ue.current,v=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==h&&mi(l);else{if(!h){if(l.stateNode===null)throw Error(n(166));return pr(l),null}s=Y.current,kc(l)?A_(l):(s=eb(v,h,c),l.stateNode=s,mi(l))}return pr(l),null;case 5:if(st(l),v=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==h&&mi(l);else{if(!h){if(l.stateNode===null)throw Error(n(166));return pr(l),null}if(_=Y.current,kc(l))A_(l);else{var k=fd(ue.current);switch(_){case 1:_=k.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:_=k.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":_=k.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":_=k.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":_=k.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof h.is=="string"?k.createElement("select",{is:h.is}):k.createElement("select"),h.multiple?_.multiple=!0:h.size&&(_.size=h.size);break;default:_=typeof h.is=="string"?k.createElement(v,{is:h.is}):k.createElement(v)}}_[X]=l,_[K]=h;e:for(k=l.child;k!==null;){if(k.tag===5||k.tag===6)_.appendChild(k.stateNode);else if(k.tag!==4&&k.tag!==27&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===l)break e;for(;k.sibling===null;){if(k.return===null||k.return===l)break e;k=k.return}k.sibling.return=k.return,k=k.sibling}l.stateNode=_;e:switch(bn(_,v,h),v){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&mi(l)}}return pr(l),jg(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,c),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==h&&mi(l);else{if(typeof h!="string"&&l.stateNode===null)throw Error(n(166));if(s=ue.current,kc(l)){if(s=l.stateNode,c=l.memoizedProps,h=null,v=yn,v!==null)switch(v.tag){case 27:case 5:h=v.memoizedProps}s[X]=l,s=!!(s.nodeValue===c||h!==null&&h.suppressHydrationWarning===!0||Hw(s.nodeValue,c)),s||el(l,!0)}else s=fd(s).createTextNode(h),s[X]=l,l.stateNode=s}return pr(l),null;case 31:if(c=l.memoizedState,s===null||s.memoizedState!==null){if(h=kc(l),c!==null){if(s===null){if(!h)throw Error(n(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[X]=l}else wo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;pr(l),s=!1}else c=Xp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return l.flags&256?(_a(l),l):(_a(l),null);if((l.flags&128)!==0)throw Error(n(558))}return pr(l),null;case 13:if(h=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=kc(l),h!==null&&h.dehydrated!==null){if(s===null){if(!v)throw Error(n(318));if(v=l.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[X]=l}else wo(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;pr(l),v=!1}else v=Xp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return l.flags&256?(_a(l),l):(_a(l),null)}return _a(l),(l.flags&128)!==0?(l.lanes=c,l):(c=h!==null,s=s!==null&&s.memoizedState!==null,c&&(h=l.child,v=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(v=h.alternate.memoizedState.cachePool.pool),_=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(_=h.memoizedState.cachePool.pool),_!==v&&(h.flags|=2048)),c!==s&&c&&(l.child.flags|=8192),Kh(l,l.updateQueue),pr(l),null);case 4:return Ae(),s===null&&s1(l.stateNode.containerInfo),pr(l),null;case 10:return ui(l.type),pr(l),null;case 19:if(L(Mr),h=l.memoizedState,h===null)return pr(l),null;if(v=(l.flags&128)!==0,_=h.rendering,_===null)if(v)xf(h,!1);else{if(Nr!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(_=jh(s),_!==null){for(l.flags|=128,xf(h,!1),s=_.updateQueue,l.updateQueue=s,Kh(l,s),l.subtreeFlags=0,s=c,c=l.child;c!==null;)w_(c,s),c=c.sibling;return J(Mr,Mr.current&1|2),Ot&&oi(l,h.treeForkCount),l.child}s=s.sibling}h.tail!==null&&zt()>td&&(l.flags|=128,v=!0,xf(h,!1),l.lanes=4194304)}else{if(!v)if(s=jh(_),s!==null){if(l.flags|=128,v=!0,s=s.updateQueue,l.updateQueue=s,Kh(l,s),xf(h,!0),h.tail===null&&h.tailMode==="hidden"&&!_.alternate&&!Ot)return pr(l),null}else 2*zt()-h.renderingStartTime>td&&c!==536870912&&(l.flags|=128,v=!0,xf(h,!1),l.lanes=4194304);h.isBackwards?(_.sibling=l.child,l.child=_):(s=h.last,s!==null?s.sibling=_:l.child=_,h.last=_)}return h.tail!==null?(s=h.tail,h.rendering=s,h.tail=s.sibling,h.renderingStartTime=zt(),s.sibling=null,c=Mr.current,J(Mr,v?c&1|2:c&1),Ot&&oi(l,h.treeForkCount),s):(pr(l),null);case 22:case 23:return _a(l),ig(),h=l.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(l.flags|=8192):h&&(l.flags|=8192),h?(c&536870912)!==0&&(l.flags&128)===0&&(pr(l),l.subtreeFlags&6&&(l.flags|=8192)):pr(l),c=l.updateQueue,c!==null&&Kh(l,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),h=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(h=l.memoizedState.cachePool.pool),h!==c&&(l.flags|=2048),s!==null&&L(To),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),l.memoizedState.cache!==c&&(l.flags|=2048),ui(Xr),pr(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function q3(s,l){switch(qp(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return ui(Xr),Ae(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return st(l),null;case 31:if(l.memoizedState!==null){if(_a(l),l.alternate===null)throw Error(n(340));wo()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(_a(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(n(340));wo()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return L(Mr),null;case 4:return Ae(),null;case 10:return ui(l.type),null;case 22:case 23:return _a(l),ig(),s!==null&&L(To),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return ui(Xr),null;case 25:return null;default:return null}}function Y2(s,l){switch(qp(l),l.tag){case 3:ui(Xr),Ae();break;case 26:case 27:case 5:st(l);break;case 4:Ae();break;case 31:l.memoizedState!==null&&_a(l);break;case 13:_a(l);break;case 19:L(Mr);break;case 10:ui(l.type);break;case 22:case 23:_a(l),ig(),s!==null&&L(To);break;case 24:ui(Xr)}}function vf(s,l){try{var c=l.updateQueue,h=c!==null?c.lastEffect:null;if(h!==null){var v=h.next;c=v;do{if((c.tag&s)===s){h=void 0;var _=c.create,k=c.inst;h=_(),k.destroy=h}c=c.next}while(c!==v)}}catch(z){Jt(l,l.return,z)}}function ll(s,l,c){try{var h=l.updateQueue,v=h!==null?h.lastEffect:null;if(v!==null){var _=v.next;h=_;do{if((h.tag&s)===s){var k=h.inst,z=k.destroy;if(z!==void 0){k.destroy=void 0,v=l;var ae=c,pe=z;try{pe()}catch(Ce){Jt(v,ae,Ce)}}}h=h.next}while(h!==_)}}catch(Ce){Jt(l,l.return,Ce)}}function $2(s){var l=s.updateQueue;if(l!==null){var c=s.stateNode;try{B_(l,c)}catch(h){Jt(s,s.return,h)}}}function K2(s,l,c){c.props=No(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(h){Jt(s,l,h)}}function yf(s,l){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof c=="function"?s.refCleanup=c(h):c.current=h}}catch(v){Jt(s,l,v)}}function Os(s,l){var c=s.ref,h=s.refCleanup;if(c!==null)if(typeof h=="function")try{h()}catch(v){Jt(s,l,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(v){Jt(s,l,v)}else c.current=null}function Q2(s){var l=s.type,c=s.memoizedProps,h=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":c.autoFocus&&h.focus();break e;case"img":c.src?h.src=c.src:c.srcSet&&(h.srcset=c.srcSet)}}catch(v){Jt(s,s.return,v)}}function Lg(s,l,c){try{var h=s.stateNode;d6(h,s.type,c,l),h[K]=l}catch(v){Jt(s,s.return,v)}}function J2(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ml(s.type)||s.tag===4}function Bg(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||J2(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ml(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Vg(s,l,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,l?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,l):(l=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,l.appendChild(s),c=c._reactRootContainer,c!=null||l.onclick!==null||(l.onclick=ls));else if(h!==4&&(h===27&&ml(s.type)&&(c=s.stateNode,l=null),s=s.child,s!==null))for(Vg(s,l,c),s=s.sibling;s!==null;)Vg(s,l,c),s=s.sibling}function Qh(s,l,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,l?c.insertBefore(s,l):c.appendChild(s);else if(h!==4&&(h===27&&ml(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(Qh(s,l,c),s=s.sibling;s!==null;)Qh(s,l,c),s=s.sibling}function Z2(s){var l=s.stateNode,c=s.memoizedProps;try{for(var h=s.type,v=l.attributes;v.length;)l.removeAttributeNode(v[0]);bn(l,h,c),l[X]=s,l[K]=c}catch(_){Jt(s,s.return,_)}}var pi=!1,Kr=!1,Ug=!1,ew=typeof WeakSet=="function"?WeakSet:Set,hn=null;function W3(s,l){if(s=s.containerInfo,o1=vd,s=h_(s),Fp(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var v=h.anchorOffset,_=h.focusNode;h=h.focusOffset;try{c.nodeType,_.nodeType}catch{c=null;break e}var k=0,z=-1,ae=-1,pe=0,Ce=0,De=s,ve=null;t:for(;;){for(var Ee;De!==c||v!==0&&De.nodeType!==3||(z=k+v),De!==_||h!==0&&De.nodeType!==3||(ae=k+h),De.nodeType===3&&(k+=De.nodeValue.length),(Ee=De.firstChild)!==null;)ve=De,De=Ee;for(;;){if(De===s)break t;if(ve===c&&++pe===v&&(z=k),ve===_&&++Ce===h&&(ae=k),(Ee=De.nextSibling)!==null)break;De=ve,ve=De.parentNode}De=Ee}c=z===-1||ae===-1?null:{start:z,end:ae}}else c=null}c=c||{start:0,end:0}}else c=null;for(c1={focusedElem:s,selectionRange:c},vd=!1,hn=l;hn!==null;)if(l=hn,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,hn=s;else for(;hn!==null;){switch(l=hn,_=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)v=s[c],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,c=l,v=_.memoizedProps,_=_.memoizedState,h=c.stateNode;try{var Je=No(c.type,v);s=h.getSnapshotBeforeUpdate(Je,_),h.__reactInternalSnapshotBeforeUpdate=s}catch(it){Jt(c,c.return,it)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,c=s.nodeType,c===9)h1(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":h1(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=l.sibling,s!==null){s.return=l.return,hn=s;break}hn=l.return}}function tw(s,l,c){var h=c.flags;switch(c.tag){case 0:case 11:case 15:xi(s,c),h&4&&vf(5,c);break;case 1:if(xi(s,c),h&4)if(s=c.stateNode,l===null)try{s.componentDidMount()}catch(k){Jt(c,c.return,k)}else{var v=No(c.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(v,l,s.__reactInternalSnapshotBeforeUpdate)}catch(k){Jt(c,c.return,k)}}h&64&&$2(c),h&512&&yf(c,c.return);break;case 3:if(xi(s,c),h&64&&(s=c.updateQueue,s!==null)){if(l=null,c.child!==null)switch(c.child.tag){case 27:case 5:l=c.child.stateNode;break;case 1:l=c.child.stateNode}try{B_(s,l)}catch(k){Jt(c,c.return,k)}}break;case 27:l===null&&h&4&&Z2(c);case 26:case 5:xi(s,c),l===null&&h&4&&Q2(c),h&512&&yf(c,c.return);break;case 12:xi(s,c);break;case 31:xi(s,c),h&4&&aw(s,c);break;case 13:xi(s,c),h&4&&sw(s,c),h&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=t6.bind(null,c),w6(s,c))));break;case 22:if(h=c.memoizedState!==null||pi,!h){l=l!==null&&l.memoizedState!==null||Kr,v=pi;var _=Kr;pi=h,(Kr=l)&&!_?vi(s,c,(c.subtreeFlags&8772)!==0):xi(s,c),pi=v,Kr=_}break;case 30:break;default:xi(s,c)}}function rw(s){var l=s.alternate;l!==null&&(s.alternate=null,rw(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Be(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var wr=null,ra=!1;function gi(s,l,c){for(c=c.child;c!==null;)nw(s,l,c),c=c.sibling}function nw(s,l,c){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(Mt,c)}catch{}switch(c.tag){case 26:Kr||Os(c,l),gi(s,l,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Kr||Os(c,l);var h=wr,v=ra;ml(c.type)&&(wr=c.stateNode,ra=!1),gi(s,l,c),Cf(c.stateNode),wr=h,ra=v;break;case 5:Kr||Os(c,l);case 6:if(h=wr,v=ra,wr=null,gi(s,l,c),wr=h,ra=v,wr!==null)if(ra)try{(wr.nodeType===9?wr.body:wr.nodeName==="HTML"?wr.ownerDocument.body:wr).removeChild(c.stateNode)}catch(_){Jt(c,l,_)}else try{wr.removeChild(c.stateNode)}catch(_){Jt(c,l,_)}break;case 18:wr!==null&&(ra?(s=wr,$w(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Yc(s)):$w(wr,c.stateNode));break;case 4:h=wr,v=ra,wr=c.stateNode.containerInfo,ra=!0,gi(s,l,c),wr=h,ra=v;break;case 0:case 11:case 14:case 15:ll(2,c,l),Kr||ll(4,c,l),gi(s,l,c);break;case 1:Kr||(Os(c,l),h=c.stateNode,typeof h.componentWillUnmount=="function"&&K2(c,l,h)),gi(s,l,c);break;case 21:gi(s,l,c);break;case 22:Kr=(h=Kr)||c.memoizedState!==null,gi(s,l,c),Kr=h;break;default:gi(s,l,c)}}function aw(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Yc(s)}catch(c){Jt(l,l.return,c)}}}function sw(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Yc(s)}catch(c){Jt(l,l.return,c)}}function X3(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new ew),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new ew),l;default:throw Error(n(435,s.tag))}}function Jh(s,l){var c=X3(s);l.forEach(function(h){if(!c.has(h)){c.add(h);var v=r6.bind(null,s,h);h.then(v,v)}})}function na(s,l){var c=l.deletions;if(c!==null)for(var h=0;h<c.length;h++){var v=c[h],_=s,k=l,z=k;e:for(;z!==null;){switch(z.tag){case 27:if(ml(z.type)){wr=z.stateNode,ra=!1;break e}break;case 5:wr=z.stateNode,ra=!1;break e;case 3:case 4:wr=z.stateNode.containerInfo,ra=!0;break e}z=z.return}if(wr===null)throw Error(n(160));nw(_,k,v),wr=null,ra=!1,_=v.alternate,_!==null&&(_.return=null),v.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)iw(l,s),l=l.sibling}var ds=null;function iw(s,l){var c=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:na(l,s),aa(s),h&4&&(ll(3,s,s.return),vf(3,s),ll(5,s,s.return));break;case 1:na(l,s),aa(s),h&512&&(Kr||c===null||Os(c,c.return)),h&64&&pi&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?h:c.concat(h))));break;case 26:var v=ds;if(na(l,s),aa(s),h&512&&(Kr||c===null||Os(c,c.return)),h&4){var _=c!==null?c.memoizedState:null;if(h=s.memoizedState,c===null)if(h===null)if(s.stateNode===null){e:{h=s.type,c=s.memoizedProps,v=v.ownerDocument||v;t:switch(h){case"title":_=v.getElementsByTagName("title")[0],(!_||_[ge]||_[X]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=v.createElement(h),v.head.insertBefore(_,v.querySelector("head > title"))),bn(_,h,c),_[X]=s,Ze(_),h=_;break e;case"link":var k=ib("link","href",v).get(h+(c.href||""));if(k){for(var z=0;z<k.length;z++)if(_=k[z],_.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&_.getAttribute("rel")===(c.rel==null?null:c.rel)&&_.getAttribute("title")===(c.title==null?null:c.title)&&_.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){k.splice(z,1);break t}}_=v.createElement(h),bn(_,h,c),v.head.appendChild(_);break;case"meta":if(k=ib("meta","content",v).get(h+(c.content||""))){for(z=0;z<k.length;z++)if(_=k[z],_.getAttribute("content")===(c.content==null?null:""+c.content)&&_.getAttribute("name")===(c.name==null?null:c.name)&&_.getAttribute("property")===(c.property==null?null:c.property)&&_.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&_.getAttribute("charset")===(c.charSet==null?null:c.charSet)){k.splice(z,1);break t}}_=v.createElement(h),bn(_,h,c),v.head.appendChild(_);break;default:throw Error(n(468,h))}_[X]=s,Ze(_),h=_}s.stateNode=h}else lb(v,s.type,s.stateNode);else s.stateNode=sb(v,h,s.memoizedProps);else _!==h?(_===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):_.count--,h===null?lb(v,s.type,s.stateNode):sb(v,h,s.memoizedProps)):h===null&&s.stateNode!==null&&Lg(s,s.memoizedProps,c.memoizedProps)}break;case 27:na(l,s),aa(s),h&512&&(Kr||c===null||Os(c,c.return)),c!==null&&h&4&&Lg(s,s.memoizedProps,c.memoizedProps);break;case 5:if(na(l,s),aa(s),h&512&&(Kr||c===null||Os(c,c.return)),s.flags&32){v=s.stateNode;try{ta(v,"")}catch(Je){Jt(s,s.return,Je)}}h&4&&s.stateNode!=null&&(v=s.memoizedProps,Lg(s,v,c!==null?c.memoizedProps:v)),h&1024&&(Ug=!0);break;case 6:if(na(l,s),aa(s),h&4){if(s.stateNode===null)throw Error(n(162));h=s.memoizedProps,c=s.stateNode;try{c.nodeValue=h}catch(Je){Jt(s,s.return,Je)}}break;case 3:if(md=null,v=ds,ds=hd(l.containerInfo),na(l,s),ds=v,aa(s),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Yc(l.containerInfo)}catch(Je){Jt(s,s.return,Je)}Ug&&(Ug=!1,lw(s));break;case 4:h=ds,ds=hd(s.stateNode.containerInfo),na(l,s),aa(s),ds=h;break;case 12:na(l,s),aa(s);break;case 31:na(l,s),aa(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Jh(s,h)));break;case 13:na(l,s),aa(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(ed=zt()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Jh(s,h)));break;case 22:v=s.memoizedState!==null;var ae=c!==null&&c.memoizedState!==null,pe=pi,Ce=Kr;if(pi=pe||v,Kr=Ce||ae,na(l,s),Kr=Ce,pi=pe,aa(s),h&8192)e:for(l=s.stateNode,l._visibility=v?l._visibility&-2:l._visibility|1,v&&(c===null||ae||pi||Kr||Ro(s)),c=null,l=s;;){if(l.tag===5||l.tag===26){if(c===null){ae=c=l;try{if(_=ae.stateNode,v)k=_.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none";else{z=ae.stateNode;var De=ae.memoizedProps.style,ve=De!=null&&De.hasOwnProperty("display")?De.display:null;z.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(Je){Jt(ae,ae.return,Je)}}}else if(l.tag===6){if(c===null){ae=l;try{ae.stateNode.nodeValue=v?"":ae.memoizedProps}catch(Je){Jt(ae,ae.return,Je)}}}else if(l.tag===18){if(c===null){ae=l;try{var Ee=ae.stateNode;v?Kw(Ee,!0):Kw(ae.stateNode,!1)}catch(Je){Jt(ae,ae.return,Je)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;c===l&&(c=null),l=l.return}c===l&&(c=null),l.sibling.return=l.return,l=l.sibling}h&4&&(h=s.updateQueue,h!==null&&(c=h.retryQueue,c!==null&&(h.retryQueue=null,Jh(s,c))));break;case 19:na(l,s),aa(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,Jh(s,h)));break;case 30:break;case 21:break;default:na(l,s),aa(s)}}function aa(s){var l=s.flags;if(l&2){try{for(var c,h=s.return;h!==null;){if(J2(h)){c=h;break}h=h.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var v=c.stateNode,_=Bg(s);Qh(s,_,v);break;case 5:var k=c.stateNode;c.flags&32&&(ta(k,""),c.flags&=-33);var z=Bg(s);Qh(s,z,k);break;case 3:case 4:var ae=c.stateNode.containerInfo,pe=Bg(s);Vg(s,pe,ae);break;default:throw Error(n(161))}}catch(Ce){Jt(s,s.return,Ce)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function lw(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;lw(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function xi(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)tw(s,l.alternate,l),l=l.sibling}function Ro(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:ll(4,l,l.return),Ro(l);break;case 1:Os(l,l.return);var c=l.stateNode;typeof c.componentWillUnmount=="function"&&K2(l,l.return,c),Ro(l);break;case 27:Cf(l.stateNode);case 26:case 5:Os(l,l.return),Ro(l);break;case 22:l.memoizedState===null&&Ro(l);break;case 30:Ro(l);break;default:Ro(l)}s=s.sibling}}function vi(s,l,c){for(c=c&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var h=l.alternate,v=s,_=l,k=_.flags;switch(_.tag){case 0:case 11:case 15:vi(v,_,c),vf(4,_);break;case 1:if(vi(v,_,c),h=_,v=h.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(pe){Jt(h,h.return,pe)}if(h=_,v=h.updateQueue,v!==null){var z=h.stateNode;try{var ae=v.shared.hiddenCallbacks;if(ae!==null)for(v.shared.hiddenCallbacks=null,v=0;v<ae.length;v++)L_(ae[v],z)}catch(pe){Jt(h,h.return,pe)}}c&&k&64&&$2(_),yf(_,_.return);break;case 27:Z2(_);case 26:case 5:vi(v,_,c),c&&h===null&&k&4&&Q2(_),yf(_,_.return);break;case 12:vi(v,_,c);break;case 31:vi(v,_,c),c&&k&4&&aw(v,_);break;case 13:vi(v,_,c),c&&k&4&&sw(v,_);break;case 22:_.memoizedState===null&&vi(v,_,c),yf(_,_.return);break;case 30:break;default:vi(v,_,c)}l=l.sibling}}function zg(s,l){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&af(c))}function Hg(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&af(s))}function ms(s,l,c,h){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)ow(s,l,c,h),l=l.sibling}function ow(s,l,c,h){var v=l.flags;switch(l.tag){case 0:case 11:case 15:ms(s,l,c,h),v&2048&&vf(9,l);break;case 1:ms(s,l,c,h);break;case 3:ms(s,l,c,h),v&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&af(s)));break;case 12:if(v&2048){ms(s,l,c,h),s=l.stateNode;try{var _=l.memoizedProps,k=_.id,z=_.onPostCommit;typeof z=="function"&&z(k,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ae){Jt(l,l.return,ae)}}else ms(s,l,c,h);break;case 31:ms(s,l,c,h);break;case 13:ms(s,l,c,h);break;case 23:break;case 22:_=l.stateNode,k=l.alternate,l.memoizedState!==null?_._visibility&2?ms(s,l,c,h):_f(s,l):_._visibility&2?ms(s,l,c,h):(_._visibility|=2,jc(s,l,c,h,(l.subtreeFlags&10256)!==0||!1)),v&2048&&zg(k,l);break;case 24:ms(s,l,c,h),v&2048&&Hg(l.alternate,l);break;default:ms(s,l,c,h)}}function jc(s,l,c,h,v){for(v=v&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var _=s,k=l,z=c,ae=h,pe=k.flags;switch(k.tag){case 0:case 11:case 15:jc(_,k,z,ae,v),vf(8,k);break;case 23:break;case 22:var Ce=k.stateNode;k.memoizedState!==null?Ce._visibility&2?jc(_,k,z,ae,v):_f(_,k):(Ce._visibility|=2,jc(_,k,z,ae,v)),v&&pe&2048&&zg(k.alternate,k);break;case 24:jc(_,k,z,ae,v),v&&pe&2048&&Hg(k.alternate,k);break;default:jc(_,k,z,ae,v)}l=l.sibling}}function _f(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var c=s,h=l,v=h.flags;switch(h.tag){case 22:_f(c,h),v&2048&&zg(h.alternate,h);break;case 24:_f(c,h),v&2048&&Hg(h.alternate,h);break;default:_f(c,h)}l=l.sibling}}var wf=8192;function Lc(s,l,c){if(s.subtreeFlags&wf)for(s=s.child;s!==null;)cw(s,l,c),s=s.sibling}function cw(s,l,c){switch(s.tag){case 26:Lc(s,l,c),s.flags&wf&&s.memoizedState!==null&&O6(c,ds,s.memoizedState,s.memoizedProps);break;case 5:Lc(s,l,c);break;case 3:case 4:var h=ds;ds=hd(s.stateNode.containerInfo),Lc(s,l,c),ds=h;break;case 22:s.memoizedState===null&&(h=s.alternate,h!==null&&h.memoizedState!==null?(h=wf,wf=16777216,Lc(s,l,c),wf=h):Lc(s,l,c));break;default:Lc(s,l,c)}}function uw(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function bf(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var h=l[c];hn=h,hw(h,s)}uw(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)fw(s),s=s.sibling}function fw(s){switch(s.tag){case 0:case 11:case 15:bf(s),s.flags&2048&&ll(9,s,s.return);break;case 3:bf(s);break;case 12:bf(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Zh(s)):bf(s);break;default:bf(s)}}function Zh(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var h=l[c];hn=h,hw(h,s)}uw(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:ll(8,l,l.return),Zh(l);break;case 22:c=l.stateNode,c._visibility&2&&(c._visibility&=-3,Zh(l));break;default:Zh(l)}s=s.sibling}}function hw(s,l){for(;hn!==null;){var c=hn;switch(c.tag){case 0:case 11:case 15:ll(8,c,l);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var h=c.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:af(c.memoizedState.cache)}if(h=c.child,h!==null)h.return=c,hn=h;else e:for(c=s;hn!==null;){h=hn;var v=h.sibling,_=h.return;if(rw(h),h===c){hn=null;break e}if(v!==null){v.return=_,hn=v;break e}hn=_}}}var Y3={getCacheForType:function(s){var l=_n(Xr),c=l.data.get(s);return c===void 0&&(c=s(),l.data.set(s,c)),c},cacheSignal:function(){return _n(Xr).controller.signal}},$3=typeof WeakMap=="function"?WeakMap:Map,Gt=0,ur=null,At=null,Ct=0,Qt=0,wa=null,ol=!1,Bc=!1,Gg=!1,yi=0,Nr=0,cl=0,Io=0,qg=0,ba=0,Vc=0,Ef=null,sa=null,Wg=!1,ed=0,dw=0,td=1/0,rd=null,ul=null,sn=0,fl=null,Uc=null,_i=0,Xg=0,Yg=null,mw=null,Tf=0,$g=null;function Ea(){return(Gt&2)!==0&&Ct!==0?Ct&-Ct:se.T!==null?t1():U()}function pw(){if(ba===0)if((Ct&536870912)===0||Ot){var s=Zs;Zs<<=1,(Zs&3932160)===0&&(Zs=262144),ba=s}else ba=536870912;return s=ya.current,s!==null&&(s.flags|=32),ba}function ia(s,l,c){(s===ur&&(Qt===2||Qt===9)||s.cancelPendingCommit!==null)&&(zc(s,0),hl(s,Ct,ba,!1)),ei(s,c),((Gt&2)===0||s!==ur)&&(s===ur&&((Gt&2)===0&&(Io|=c),Nr===4&&hl(s,Ct,ba,!1)),Fs(s))}function gw(s,l,c){if((Gt&6)!==0)throw Error(n(327));var h=!c&&(l&127)===0&&(l&s.expiredLanes)===0||ma(s,l),v=h?J3(s,l):Qg(s,l,!0),_=h;do{if(v===0){Bc&&!h&&hl(s,l,0,!1);break}else{if(c=s.current.alternate,_&&!K3(c)){v=Qg(s,l,!1),_=!1;continue}if(v===2){if(_=l,s.errorRecoveryDisabledLanes&_)var k=0;else k=s.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){l=k;e:{var z=s;v=Ef;var ae=z.current.memoizedState.isDehydrated;if(ae&&(zc(z,k).flags|=256),k=Qg(z,k,!1),k!==2){if(Gg&&!ae){z.errorRecoveryDisabledLanes|=_,Io|=_,v=4;break e}_=sa,sa=v,_!==null&&(sa===null?sa=_:sa.push.apply(sa,_))}v=k}if(_=!1,v!==2)continue}}if(v===1){zc(s,0),hl(s,l,0,!0);break}e:{switch(h=s,_=v,_){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:hl(h,l,ba,!ol);break e;case 2:sa=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(v=ed+300-zt(),10<v)){if(hl(h,l,ba,!ol),Da(h,0,!0)!==0)break e;_i=l,h.timeoutHandle=Xw(xw.bind(null,h,c,sa,rd,Wg,l,ba,Io,Vc,ol,_,"Throttled",-0,0),v);break e}xw(h,c,sa,rd,Wg,l,ba,Io,Vc,ol,_,null,-0,0)}}break}while(!0);Fs(s)}function xw(s,l,c,h,v,_,k,z,ae,pe,Ce,De,ve,Ee){if(s.timeoutHandle=-1,De=l.subtreeFlags,De&8192||(De&16785408)===16785408){De={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ls},cw(l,_,De);var Je=(_&62914560)===_?ed-zt():(_&4194048)===_?dw-zt():0;if(Je=F6(De,Je),Je!==null){_i=_,s.cancelPendingCommit=Je(Sw.bind(null,s,l,_,c,h,v,k,z,ae,Ce,De,null,ve,Ee)),hl(s,_,k,!pe);return}}Sw(s,l,_,c,h,v,k,z,ae)}function K3(s){for(var l=s;;){var c=l.tag;if((c===0||c===11||c===15)&&l.flags&16384&&(c=l.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var h=0;h<c.length;h++){var v=c[h],_=v.getSnapshot;v=v.value;try{if(!xa(_(),v))return!1}catch{return!1}}if(c=l.child,l.subtreeFlags&16384&&c!==null)c.return=l,l=c;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function hl(s,l,c,h){l&=~qg,l&=~Io,s.suspendedLanes|=l,s.pingedLanes&=~l,h&&(s.warmLanes|=l),h=s.expirationTimes;for(var v=l;0<v;){var _=31-dr(v),k=1<<_;h[_]=-1,v&=~k}c!==0&&ti(s,c,l)}function nd(){return(Gt&6)===0?(Sf(0),!1):!0}function Kg(){if(At!==null){if(Qt===0)var s=At.return;else s=At,ci=bo=null,hg(s),Dc=null,lf=0,s=At;for(;s!==null;)Y2(s.alternate,s),s=s.return;At=null}}function zc(s,l){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,g6(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),_i=0,Kg(),ur=s,At=c=li(s.current,null),Ct=l,Qt=0,wa=null,ol=!1,Bc=ma(s,l),Gg=!1,Vc=ba=qg=Io=cl=Nr=0,sa=Ef=null,Wg=!1,(l&8)!==0&&(l|=l&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=l;0<h;){var v=31-dr(h),_=1<<v;l|=s[v],h&=~_}return yi=l,Th(),c}function vw(s,l){vt=null,se.H=pf,l===Ic||l===Dh?(l=F_(),Qt=3):l===eg?(l=F_(),Qt=4):Qt=l===Cg?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,wa=l,At===null&&(Nr=1,Wh(s,La(l,s.current)))}function yw(){var s=ya.current;return s===null?!0:(Ct&4194048)===Ct?za===null:(Ct&62914560)===Ct||(Ct&536870912)!==0?s===za:!1}function _w(){var s=se.H;return se.H=pf,s===null?pf:s}function ww(){var s=se.A;return se.A=Y3,s}function ad(){Nr=4,ol||(Ct&4194048)!==Ct&&ya.current!==null||(Bc=!0),(cl&134217727)===0&&(Io&134217727)===0||ur===null||hl(ur,Ct,ba,!1)}function Qg(s,l,c){var h=Gt;Gt|=2;var v=_w(),_=ww();(ur!==s||Ct!==l)&&(rd=null,zc(s,l)),l=!1;var k=Nr;e:do try{if(Qt!==0&&At!==null){var z=At,ae=wa;switch(Qt){case 8:Kg(),k=6;break e;case 3:case 2:case 9:case 6:ya.current===null&&(l=!0);var pe=Qt;if(Qt=0,wa=null,Hc(s,z,ae,pe),c&&Bc){k=0;break e}break;default:pe=Qt,Qt=0,wa=null,Hc(s,z,ae,pe)}}Q3(),k=Nr;break}catch(Ce){vw(s,Ce)}while(!0);return l&&s.shellSuspendCounter++,ci=bo=null,Gt=h,se.H=v,se.A=_,At===null&&(ur=null,Ct=0,Th()),k}function Q3(){for(;At!==null;)bw(At)}function J3(s,l){var c=Gt;Gt|=2;var h=_w(),v=ww();ur!==s||Ct!==l?(rd=null,td=zt()+500,zc(s,l)):Bc=ma(s,l);e:do try{if(Qt!==0&&At!==null){l=At;var _=wa;t:switch(Qt){case 1:Qt=0,wa=null,Hc(s,l,_,1);break;case 2:case 9:if(D_(_)){Qt=0,wa=null,Ew(l);break}l=function(){Qt!==2&&Qt!==9||ur!==s||(Qt=7),Fs(s)},_.then(l,l);break e;case 3:Qt=7;break e;case 4:Qt=5;break e;case 7:D_(_)?(Qt=0,wa=null,Ew(l)):(Qt=0,wa=null,Hc(s,l,_,7));break;case 5:var k=null;switch(At.tag){case 26:k=At.memoizedState;case 5:case 27:var z=At;if(k?ob(k):z.stateNode.complete){Qt=0,wa=null;var ae=z.sibling;if(ae!==null)At=ae;else{var pe=z.return;pe!==null?(At=pe,sd(pe)):At=null}break t}}Qt=0,wa=null,Hc(s,l,_,5);break;case 6:Qt=0,wa=null,Hc(s,l,_,6);break;case 8:Kg(),Nr=6;break e;default:throw Error(n(462))}}Z3();break}catch(Ce){vw(s,Ce)}while(!0);return ci=bo=null,se.H=h,se.A=v,Gt=c,At!==null?0:(ur=null,Ct=0,Th(),Nr)}function Z3(){for(;At!==null&&!ns();)bw(At)}function bw(s){var l=W2(s.alternate,s,yi);s.memoizedProps=s.pendingProps,l===null?sd(s):At=l}function Ew(s){var l=s,c=l.alternate;switch(l.tag){case 15:case 0:l=V2(c,l,l.pendingProps,l.type,void 0,Ct);break;case 11:l=V2(c,l,l.pendingProps,l.type.render,l.ref,Ct);break;case 5:hg(l);default:Y2(c,l),l=At=w_(l,yi),l=W2(c,l,yi)}s.memoizedProps=s.pendingProps,l===null?sd(s):At=l}function Hc(s,l,c,h){ci=bo=null,hg(l),Dc=null,lf=0;var v=l.return;try{if(U3(s,v,l,c,Ct)){Nr=1,Wh(s,La(c,s.current)),At=null;return}}catch(_){if(v!==null)throw At=v,_;Nr=1,Wh(s,La(c,s.current)),At=null;return}l.flags&32768?(Ot||h===1?s=!0:Bc||(Ct&536870912)!==0?s=!1:(ol=s=!0,(h===2||h===9||h===3||h===6)&&(h=ya.current,h!==null&&h.tag===13&&(h.flags|=16384))),Tw(l,s)):sd(l)}function sd(s){var l=s;do{if((l.flags&32768)!==0){Tw(l,ol);return}s=l.return;var c=G3(l.alternate,l,yi);if(c!==null){At=c;return}if(l=l.sibling,l!==null){At=l;return}At=l=s}while(l!==null);Nr===0&&(Nr=5)}function Tw(s,l){do{var c=q3(s.alternate,s);if(c!==null){c.flags&=32767,At=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!l&&(s=s.sibling,s!==null)){At=s;return}At=s=c}while(s!==null);Nr=6,At=null}function Sw(s,l,c,h,v,_,k,z,ae){s.cancelPendingCommit=null;do id();while(sn!==0);if((Gt&6)!==0)throw Error(n(327));if(l!==null){if(l===s.current)throw Error(n(177));if(_=l.lanes|l.childLanes,_|=Bp,Uu(s,c,_,k,z,ae),s===ur&&(At=ur=null,Ct=0),Uc=l,fl=s,_i=c,Xg=_,Yg=v,mw=h,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,n6(Xt,function(){return Rw(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||h){h=se.T,se.T=null,v=ce.p,ce.p=2,k=Gt,Gt|=4;try{W3(s,l,c)}finally{Gt=k,ce.p=v,se.T=h}}sn=1,Aw(),kw(),Cw()}}function Aw(){if(sn===1){sn=0;var s=fl,l=Uc,c=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||c){c=se.T,se.T=null;var h=ce.p;ce.p=2;var v=Gt;Gt|=4;try{iw(l,s);var _=c1,k=h_(s.containerInfo),z=_.focusedElem,ae=_.selectionRange;if(k!==z&&z&&z.ownerDocument&&f_(z.ownerDocument.documentElement,z)){if(ae!==null&&Fp(z)){var pe=ae.start,Ce=ae.end;if(Ce===void 0&&(Ce=pe),"selectionStart"in z)z.selectionStart=pe,z.selectionEnd=Math.min(Ce,z.value.length);else{var De=z.ownerDocument||document,ve=De&&De.defaultView||window;if(ve.getSelection){var Ee=ve.getSelection(),Je=z.textContent.length,it=Math.min(ae.start,Je),ir=ae.end===void 0?it:Math.min(ae.end,Je);!Ee.extend&&it>ir&&(k=ir,ir=it,it=k);var oe=u_(z,it),ie=u_(z,ir);if(oe&&ie&&(Ee.rangeCount!==1||Ee.anchorNode!==oe.node||Ee.anchorOffset!==oe.offset||Ee.focusNode!==ie.node||Ee.focusOffset!==ie.offset)){var he=De.createRange();he.setStart(oe.node,oe.offset),Ee.removeAllRanges(),it>ir?(Ee.addRange(he),Ee.extend(ie.node,ie.offset)):(he.setEnd(ie.node,ie.offset),Ee.addRange(he))}}}}for(De=[],Ee=z;Ee=Ee.parentNode;)Ee.nodeType===1&&De.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof z.focus=="function"&&z.focus(),z=0;z<De.length;z++){var Ne=De[z];Ne.element.scrollLeft=Ne.left,Ne.element.scrollTop=Ne.top}}vd=!!o1,c1=o1=null}finally{Gt=v,ce.p=h,se.T=c}}s.current=l,sn=2}}function kw(){if(sn===2){sn=0;var s=fl,l=Uc,c=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||c){c=se.T,se.T=null;var h=ce.p;ce.p=2;var v=Gt;Gt|=4;try{tw(s,l.alternate,l)}finally{Gt=v,ce.p=h,se.T=c}}sn=3}}function Cw(){if(sn===4||sn===3){sn=0,Gn();var s=fl,l=Uc,c=_i,h=mw;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?sn=5:(sn=0,Uc=fl=null,Nw(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(ul=null),as(c),l=l.stateNode,or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(Mt,l,void 0,(l.current.flags&128)===128)}catch{}if(h!==null){l=se.T,v=ce.p,ce.p=2,se.T=null;try{for(var _=s.onRecoverableError,k=0;k<h.length;k++){var z=h[k];_(z.value,{componentStack:z.stack})}}finally{se.T=l,ce.p=v}}(_i&3)!==0&&id(),Fs(s),v=s.pendingLanes,(c&261930)!==0&&(v&42)!==0?s===$g?Tf++:(Tf=0,$g=s):Tf=0,Sf(0)}}function Nw(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,af(l)))}function id(){return Aw(),kw(),Cw(),Rw()}function Rw(){if(sn!==5)return!1;var s=fl,l=Xg;Xg=0;var c=as(_i),h=se.T,v=ce.p;try{ce.p=32>c?32:c,se.T=null,c=Yg,Yg=null;var _=fl,k=_i;if(sn=0,Uc=fl=null,_i=0,(Gt&6)!==0)throw Error(n(331));var z=Gt;if(Gt|=4,fw(_.current),ow(_,_.current,k,c),Gt=z,Sf(0,!1),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(Mt,_)}catch{}return!0}finally{ce.p=v,se.T=h,Nw(s,l)}}function Iw(s,l,c){l=La(c,l),l=kg(s.stateNode,l,2),s=al(s,l,2),s!==null&&(ei(s,2),Fs(s))}function Jt(s,l,c){if(s.tag===3)Iw(s,s,c);else for(;l!==null;){if(l.tag===3){Iw(l,s,c);break}else if(l.tag===1){var h=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ul===null||!ul.has(h))){s=La(c,s),c=D2(2),h=al(l,c,2),h!==null&&(O2(c,h,l,s),ei(h,2),Fs(h));break}}l=l.return}}function Jg(s,l,c){var h=s.pingCache;if(h===null){h=s.pingCache=new $3;var v=new Set;h.set(l,v)}else v=h.get(l),v===void 0&&(v=new Set,h.set(l,v));v.has(c)||(Gg=!0,v.add(c),s=e6.bind(null,s,l,c),l.then(s,s))}function e6(s,l,c){var h=s.pingCache;h!==null&&h.delete(l),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,ur===s&&(Ct&c)===c&&(Nr===4||Nr===3&&(Ct&62914560)===Ct&&300>zt()-ed?(Gt&2)===0&&zc(s,0):qg|=c,Vc===Ct&&(Vc=0)),Fs(s)}function Dw(s,l){l===0&&(l=fc()),s=yo(s,l),s!==null&&(ei(s,l),Fs(s))}function t6(s){var l=s.memoizedState,c=0;l!==null&&(c=l.retryLane),Dw(s,c)}function r6(s,l){var c=0;switch(s.tag){case 31:case 13:var h=s.stateNode,v=s.memoizedState;v!==null&&(c=v.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(n(314))}h!==null&&h.delete(l),Dw(s,c)}function n6(s,l){return Ft(s,l)}var ld=null,Gc=null,Zg=!1,od=!1,e1=!1,dl=0;function Fs(s){s!==Gc&&s.next===null&&(Gc===null?ld=Gc=s:Gc=Gc.next=s),od=!0,Zg||(Zg=!0,s6())}function Sf(s,l){if(!e1&&od){e1=!0;do for(var c=!1,h=ld;h!==null;){if(s!==0){var v=h.pendingLanes;if(v===0)var _=0;else{var k=h.suspendedLanes,z=h.pingedLanes;_=(1<<31-dr(42|s)+1)-1,_&=v&~(k&~z),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(c=!0,Pw(h,_))}else _=Ct,_=Da(h,h===ur?_:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(_&3)===0||ma(h,_)||(c=!0,Pw(h,_));h=h.next}while(c);e1=!1}}function a6(){Ow()}function Ow(){od=Zg=!1;var s=0;dl!==0&&p6()&&(s=dl);for(var l=zt(),c=null,h=ld;h!==null;){var v=h.next,_=Fw(h,l);_===0?(h.next=null,c===null?ld=v:c.next=v,v===null&&(Gc=c)):(c=h,(s!==0||(_&3)!==0)&&(od=!0)),h=v}sn!==0&&sn!==5||Sf(s),dl!==0&&(dl=0)}function Fw(s,l){for(var c=s.suspendedLanes,h=s.pingedLanes,v=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var k=31-dr(_),z=1<<k,ae=v[k];ae===-1?((z&c)===0||(z&h)!==0)&&(v[k]=Vu(z,l)):ae<=l&&(s.expiredLanes|=z),_&=~z}if(l=ur,c=Ct,c=Da(s,s===l?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,c===0||s===l&&(Qt===2||Qt===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&Hr(h),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||ma(s,c)){if(l=c&-c,l===s.callbackPriority)return l;switch(h!==null&&Hr(h),as(c)){case 2:case 8:c=qn;break;case 32:c=Xt;break;case 268435456:c=dt;break;default:c=Xt}return h=Mw.bind(null,s),c=Ft(c,h),s.callbackPriority=l,s.callbackNode=c,l}return h!==null&&h!==null&&Hr(h),s.callbackPriority=2,s.callbackNode=null,2}function Mw(s,l){if(sn!==0&&sn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(id()&&s.callbackNode!==c)return null;var h=Ct;return h=Da(s,s===ur?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(gw(s,h,l),Fw(s,zt()),s.callbackNode!=null&&s.callbackNode===c?Mw.bind(null,s):null)}function Pw(s,l){if(id())return null;gw(s,l,!0)}function s6(){x6(function(){(Gt&6)!==0?Ft(nn,a6):Ow()})}function t1(){if(dl===0){var s=Nc;s===0&&(s=da,da<<=1,(da&261888)===0&&(da=256)),dl=s}return dl}function jw(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:mc(""+s)}function Lw(s,l){var c=l.ownerDocument.createElement("input");return c.name=l.name,c.value=l.value,s.id&&c.setAttribute("form",s.id),l.parentNode.insertBefore(c,l),s=new FormData(s),c.parentNode.removeChild(c),s}function i6(s,l,c,h,v){if(l==="submit"&&c&&c.stateNode===v){var _=jw((v[K]||null).action),k=h.submitter;k&&(l=(l=k[K]||null)?jw(l.formAction):k.getAttribute("formAction"),l!==null&&(_=l,k=null));var z=new ks("action","action",null,h,v);s.push({event:z,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(dl!==0){var ae=k?Lw(v,k):new FormData(v);wg(c,{pending:!0,data:ae,method:v.method,action:_},null,ae)}}else typeof _=="function"&&(z.preventDefault(),ae=k?Lw(v,k):new FormData(v),wg(c,{pending:!0,data:ae,method:v.method,action:_},_,ae))},currentTarget:v}]})}}for(var r1=0;r1<Lp.length;r1++){var n1=Lp[r1],l6=n1.toLowerCase(),o6=n1[0].toUpperCase()+n1.slice(1);hs(l6,"on"+o6)}hs(p_,"onAnimationEnd"),hs(g_,"onAnimationIteration"),hs(x_,"onAnimationStart"),hs("dblclick","onDoubleClick"),hs("focusin","onFocus"),hs("focusout","onBlur"),hs(T3,"onTransitionRun"),hs(S3,"onTransitionStart"),hs(A3,"onTransitionCancel"),hs(v_,"onTransitionEnd"),Nn("onMouseEnter",["mouseout","mouseover"]),Nn("onMouseLeave",["mouseout","mouseover"]),Nn("onPointerEnter",["pointerout","pointerover"]),Nn("onPointerLeave",["pointerout","pointerover"]),cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),cr("onBeforeInput",["compositionend","keypress","textInput","paste"]),cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Af="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),c6=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Af));function Bw(s,l){l=(l&4)!==0;for(var c=0;c<s.length;c++){var h=s[c],v=h.event;h=h.listeners;e:{var _=void 0;if(l)for(var k=h.length-1;0<=k;k--){var z=h[k],ae=z.instance,pe=z.currentTarget;if(z=z.listener,ae!==_&&v.isPropagationStopped())break e;_=z,v.currentTarget=pe;try{_(v)}catch(Ce){Eh(Ce)}v.currentTarget=null,_=ae}else for(k=0;k<h.length;k++){if(z=h[k],ae=z.instance,pe=z.currentTarget,z=z.listener,ae!==_&&v.isPropagationStopped())break e;_=z,v.currentTarget=pe;try{_(v)}catch(Ce){Eh(Ce)}v.currentTarget=null,_=ae}}}}function kt(s,l){var c=l[de];c===void 0&&(c=l[de]=new Set);var h=s+"__bubble";c.has(h)||(Vw(l,s,2,!1),c.add(h))}function a1(s,l,c){var h=0;l&&(h|=4),Vw(c,s,h,l)}var cd="_reactListening"+Math.random().toString(36).slice(2);function s1(s){if(!s[cd]){s[cd]=!0,Yt.forEach(function(c){c!=="selectionchange"&&(c6.has(c)||a1(c,!1,s),a1(c,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[cd]||(l[cd]=!0,a1("selectionchange",!1,l))}}function Vw(s,l,c,h){switch(pb(l)){case 2:var v=j6;break;case 8:v=L6;break;default:v=_1}c=v.bind(null,l,c,s),v=void 0,!uo||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(v=!0),h?v!==void 0?s.addEventListener(l,c,{capture:!0,passive:v}):s.addEventListener(l,c,!0):v!==void 0?s.addEventListener(l,c,{passive:v}):s.addEventListener(l,c,!1)}function i1(s,l,c,h,v){var _=h;if((l&1)===0&&(l&2)===0&&h!==null)e:for(;;){if(h===null)return;var k=h.tag;if(k===3||k===4){var z=h.stateNode.containerInfo;if(z===v)break;if(k===4)for(k=h.return;k!==null;){var ae=k.tag;if((ae===3||ae===4)&&k.stateNode.containerInfo===v)return;k=k.return}for(;z!==null;){if(k=Ve(z),k===null)return;if(ae=k.tag,ae===5||ae===6||ae===26||ae===27){h=_=k;continue e}z=z.parentNode}}h=h.return}Yi(function(){var pe=_,Ce=Fa(c),De=[];e:{var ve=y_.get(s);if(ve!==void 0){var Ee=ks,Je=s;switch(s){case"keypress":if(ho(c)===0)break e;case"keydown":case"keyup":Ee=_h;break;case"focusin":Je="focus",Ee=po;break;case"focusout":Je="blur",Ee=po;break;case"beforeblur":case"afterblur":Ee=po;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=Ku;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=fh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=S;break;case p_:case g_:case x_:Ee=dh;break;case v_:Ee=W;break;case"scroll":case"scrollend":Ee=$u;break;case"wheel":Ee=we;break;case"copy":case"cut":case"paste":Ee=mh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=ii;break;case"toggle":case"beforetoggle":Ee=xt}var it=(l&4)!==0,ir=!it&&(s==="scroll"||s==="scrollend"),oe=it?ve!==null?ve+"Capture":null:ve;it=[];for(var ie=pe,he;ie!==null;){var Ne=ie;if(he=Ne.stateNode,Ne=Ne.tag,Ne!==5&&Ne!==26&&Ne!==27||he===null||oe===null||(Ne=os(ie,oe),Ne!=null&&it.push(kf(ie,Ne,he))),ir)break;ie=ie.return}0<it.length&&(ve=new Ee(ve,Je,null,c,Ce),De.push({event:ve,listeners:it}))}}if((l&7)===0){e:{if(ve=s==="mouseover"||s==="pointerover",Ee=s==="mouseout"||s==="pointerout",ve&&c!==Wu&&(Je=c.relatedTarget||c.fromElement)&&(Ve(Je)||Je[ee]))break e;if((Ee||ve)&&(ve=Ce.window===Ce?Ce:(ve=Ce.ownerDocument)?ve.defaultView||ve.parentWindow:window,Ee?(Je=c.relatedTarget||c.toElement,Ee=pe,Je=Je?Ve(Je):null,Je!==null&&(ir=i(Je),it=Je.tag,Je!==ir||it!==5&&it!==27&&it!==6)&&(Je=null)):(Ee=null,Je=pe),Ee!==Je)){if(it=Ku,Ne="onMouseLeave",oe="onMouseEnter",ie="mouse",(s==="pointerout"||s==="pointerover")&&(it=ii,Ne="onPointerLeave",oe="onPointerEnter",ie="pointer"),ir=Ee==null?ve:Le(Ee),he=Je==null?ve:Le(Je),ve=new it(Ne,ie+"leave",Ee,c,Ce),ve.target=ir,ve.relatedTarget=he,Ne=null,Ve(Ce)===pe&&(it=new it(oe,ie+"enter",Je,c,Ce),it.target=he,it.relatedTarget=ir,Ne=it),ir=Ne,Ee&&Je)t:{for(it=u6,oe=Ee,ie=Je,he=0,Ne=oe;Ne;Ne=it(Ne))he++;Ne=0;for(var rt=ie;rt;rt=it(rt))Ne++;for(;0<he-Ne;)oe=it(oe),he--;for(;0<Ne-he;)ie=it(ie),Ne--;for(;he--;){if(oe===ie||ie!==null&&oe===ie.alternate){it=oe;break t}oe=it(oe),ie=it(ie)}it=null}else it=null;Ee!==null&&Uw(De,ve,Ee,it,!1),Je!==null&&ir!==null&&Uw(De,ir,Je,it,!0)}}e:{if(ve=pe?Le(pe):window,Ee=ve.nodeName&&ve.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&ve.type==="file")var Bt=a_;else if(r_(ve))if(s_)Bt=w3;else{Bt=y3;var tt=v3}else Ee=ve.nodeName,!Ee||Ee.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?pe&&dc(pe.elementType)&&(Bt=a_):Bt=_3;if(Bt&&(Bt=Bt(s,pe))){n_(De,Bt,c,Ce);break e}tt&&tt(s,ve,pe),s==="focusout"&&pe&&ve.type==="number"&&pe.memoizedProps.value!=null&&Hu(ve,"number",ve.value)}switch(tt=pe?Le(pe):window,s){case"focusin":(r_(tt)||tt.contentEditable==="true")&&(wc=tt,Mp=pe,tf=null);break;case"focusout":tf=Mp=wc=null;break;case"mousedown":Pp=!0;break;case"contextmenu":case"mouseup":case"dragend":Pp=!1,d_(De,c,Ce);break;case"selectionchange":if(E3)break;case"keydown":case"keyup":d_(De,c,Ce)}var wt;if(Ht)e:{switch(s){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else _c?go(s,c)&&(Nt="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Nt="onCompositionStart");Nt&&(Rs&&c.locale!=="ko"&&(_c||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&_c&&(wt=Yu()):(As=Ce,Xu="value"in As?As.value:As.textContent,_c=!0)),tt=ud(pe,Nt),0<tt.length&&(Nt=new Ns(Nt,s,null,c,Ce),De.push({event:Nt,listeners:tt}),wt?Nt.data=wt:(wt=yc(c),wt!==null&&(Nt.data=wt)))),(wt=Pa?m3(s,c):p3(s,c))&&(Nt=ud(pe,"onBeforeInput"),0<Nt.length&&(tt=new Ns("onBeforeInput","beforeinput",null,c,Ce),De.push({event:tt,listeners:Nt}),tt.data=wt)),i6(De,s,pe,c,Ce)}Bw(De,l)})}function kf(s,l,c){return{instance:s,listener:l,currentTarget:c}}function ud(s,l){for(var c=l+"Capture",h=[];s!==null;){var v=s,_=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||_===null||(v=os(s,c),v!=null&&h.unshift(kf(s,v,_)),v=os(s,l),v!=null&&h.push(kf(s,v,_))),s.tag===3)return h;s=s.return}return[]}function u6(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Uw(s,l,c,h,v){for(var _=l._reactName,k=[];c!==null&&c!==h;){var z=c,ae=z.alternate,pe=z.stateNode;if(z=z.tag,ae!==null&&ae===h)break;z!==5&&z!==26&&z!==27||pe===null||(ae=pe,v?(pe=os(c,_),pe!=null&&k.unshift(kf(c,pe,ae))):v||(pe=os(c,_),pe!=null&&k.push(kf(c,pe,ae)))),c=c.return}k.length!==0&&s.push({event:l,listeners:k})}var f6=/\r\n?/g,h6=/\u0000|\uFFFD/g;function zw(s){return(typeof s=="string"?s:""+s).replace(f6,`
`).replace(h6,"")}function Hw(s,l){return l=zw(l),zw(s)===l}function sr(s,l,c,h,v,_){switch(c){case"children":typeof h=="string"?l==="body"||l==="textarea"&&h===""||ta(s,h):(typeof h=="number"||typeof h=="bigint")&&l!=="body"&&ta(s,""+h);break;case"className":ga(s,"class",h);break;case"tabIndex":ga(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":ga(s,c,h);break;case"style":qu(s,h,_);break;case"data":if(l!=="object"){ga(s,"data",h);break}case"src":case"href":if(h===""&&(l!=="a"||c!=="href")){s.removeAttribute(c);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=mc(""+h),s.setAttribute(c,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(c==="formAction"?(l!=="input"&&sr(s,l,"name",v.name,v,null),sr(s,l,"formEncType",v.formEncType,v,null),sr(s,l,"formMethod",v.formMethod,v,null),sr(s,l,"formTarget",v.formTarget,v,null)):(sr(s,l,"encType",v.encType,v,null),sr(s,l,"method",v.method,v,null),sr(s,l,"target",v.target,v,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(c);break}h=mc(""+h),s.setAttribute(c,h);break;case"onClick":h!=null&&(s.onclick=ls);break;case"onScroll":h!=null&&kt("scroll",s);break;case"onScrollEnd":h!=null&&kt("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}c=mc(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""+h):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":h===!0?s.setAttribute(c,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(c,h):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(c,h):s.removeAttribute(c);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(c):s.setAttribute(c,h);break;case"popover":kt("beforetoggle",s),kt("toggle",s),Rn(s,"popover",h);break;case"xlinkActuate":Wr(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Wr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Wr(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Wr(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Wr(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Wr(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Wr(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Wr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Wr(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Rn(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=uh.get(c)||c,Rn(s,c,h))}}function l1(s,l,c,h,v,_){switch(c){case"style":qu(s,h,_);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(n(61));if(c=h.__html,c!=null){if(v.children!=null)throw Error(n(60));s.innerHTML=c}}break;case"children":typeof h=="string"?ta(s,h):(typeof h=="number"||typeof h=="bigint")&&ta(s,""+h);break;case"onScroll":h!=null&&kt("scroll",s);break;case"onScrollEnd":h!=null&&kt("scrollend",s);break;case"onClick":h!=null&&(s.onclick=ls);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$t.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(v=c.endsWith("Capture"),l=c.slice(2,v?c.length-7:void 0),_=s[K]||null,_=_!=null?_[c]:null,typeof _=="function"&&s.removeEventListener(l,_,v),typeof h=="function")){typeof _!="function"&&_!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(l,h,v);break e}c in s?s[c]=h:h===!0?s.setAttribute(c,""):Rn(s,c,h)}}}function bn(s,l,c){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":kt("error",s),kt("load",s);var h=!1,v=!1,_;for(_ in c)if(c.hasOwnProperty(_)){var k=c[_];if(k!=null)switch(_){case"src":h=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:sr(s,l,_,k,c,null)}}v&&sr(s,l,"srcSet",c.srcSet,c,null),h&&sr(s,l,"src",c.src,c,null);return;case"input":kt("invalid",s);var z=_=k=v=null,ae=null,pe=null;for(h in c)if(c.hasOwnProperty(h)){var Ce=c[h];if(Ce!=null)switch(h){case"name":v=Ce;break;case"type":k=Ce;break;case"checked":ae=Ce;break;case"defaultChecked":pe=Ce;break;case"value":_=Ce;break;case"defaultValue":z=Ce;break;case"children":case"dangerouslySetInnerHTML":if(Ce!=null)throw Error(n(137,l));break;default:sr(s,l,h,Ce,c,null)}}lh(s,_,z,ae,pe,k,v,!1);return;case"select":kt("invalid",s),h=k=_=null;for(v in c)if(c.hasOwnProperty(v)&&(z=c[v],z!=null))switch(v){case"value":_=z;break;case"defaultValue":k=z;break;case"multiple":h=z;default:sr(s,l,v,z,c,null)}l=_,c=k,s.multiple=!!h,l!=null?Gi(s,!!h,l,!1):c!=null&&Gi(s,!!h,c,!0);return;case"textarea":kt("invalid",s),_=v=h=null;for(k in c)if(c.hasOwnProperty(k)&&(z=c[k],z!=null))switch(k){case"value":h=z;break;case"defaultValue":v=z;break;case"children":_=z;break;case"dangerouslySetInnerHTML":if(z!=null)throw Error(n(91));break;default:sr(s,l,k,z,c,null)}qi(s,h,v,_);return;case"option":for(ae in c)if(c.hasOwnProperty(ae)&&(h=c[ae],h!=null))switch(ae){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:sr(s,l,ae,h,c,null)}return;case"dialog":kt("beforetoggle",s),kt("toggle",s),kt("cancel",s),kt("close",s);break;case"iframe":case"object":kt("load",s);break;case"video":case"audio":for(h=0;h<Af.length;h++)kt(Af[h],s);break;case"image":kt("error",s),kt("load",s);break;case"details":kt("toggle",s);break;case"embed":case"source":case"link":kt("error",s),kt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in c)if(c.hasOwnProperty(pe)&&(h=c[pe],h!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:sr(s,l,pe,h,c,null)}return;default:if(dc(l)){for(Ce in c)c.hasOwnProperty(Ce)&&(h=c[Ce],h!==void 0&&l1(s,l,Ce,h,c,void 0));return}}for(z in c)c.hasOwnProperty(z)&&(h=c[z],h!=null&&sr(s,l,z,h,c,null))}function d6(s,l,c,h){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,_=null,k=null,z=null,ae=null,pe=null,Ce=null;for(Ee in c){var De=c[Ee];if(c.hasOwnProperty(Ee)&&De!=null)switch(Ee){case"checked":break;case"value":break;case"defaultValue":ae=De;default:h.hasOwnProperty(Ee)||sr(s,l,Ee,null,h,De)}}for(var ve in h){var Ee=h[ve];if(De=c[ve],h.hasOwnProperty(ve)&&(Ee!=null||De!=null))switch(ve){case"type":_=Ee;break;case"name":v=Ee;break;case"checked":pe=Ee;break;case"defaultChecked":Ce=Ee;break;case"value":k=Ee;break;case"defaultValue":z=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,l));break;default:Ee!==De&&sr(s,l,ve,Ee,h,De)}}hc(s,k,z,ae,pe,Ce,_,v);return;case"select":Ee=k=z=ve=null;for(_ in c)if(ae=c[_],c.hasOwnProperty(_)&&ae!=null)switch(_){case"value":break;case"multiple":Ee=ae;default:h.hasOwnProperty(_)||sr(s,l,_,null,h,ae)}for(v in h)if(_=h[v],ae=c[v],h.hasOwnProperty(v)&&(_!=null||ae!=null))switch(v){case"value":ve=_;break;case"defaultValue":z=_;break;case"multiple":k=_;default:_!==ae&&sr(s,l,v,_,h,ae)}l=z,c=k,h=Ee,ve!=null?Gi(s,!!c,ve,!1):!!h!=!!c&&(l!=null?Gi(s,!!c,l,!0):Gi(s,!!c,c?[]:"",!1));return;case"textarea":Ee=ve=null;for(z in c)if(v=c[z],c.hasOwnProperty(z)&&v!=null&&!h.hasOwnProperty(z))switch(z){case"value":break;case"children":break;default:sr(s,l,z,null,h,v)}for(k in h)if(v=h[k],_=c[k],h.hasOwnProperty(k)&&(v!=null||_!=null))switch(k){case"value":ve=v;break;case"defaultValue":Ee=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(n(91));break;default:v!==_&&sr(s,l,k,v,h,_)}oh(s,ve,Ee);return;case"option":for(var Je in c)if(ve=c[Je],c.hasOwnProperty(Je)&&ve!=null&&!h.hasOwnProperty(Je))switch(Je){case"selected":s.selected=!1;break;default:sr(s,l,Je,null,h,ve)}for(ae in h)if(ve=h[ae],Ee=c[ae],h.hasOwnProperty(ae)&&ve!==Ee&&(ve!=null||Ee!=null))switch(ae){case"selected":s.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:sr(s,l,ae,ve,h,Ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var it in c)ve=c[it],c.hasOwnProperty(it)&&ve!=null&&!h.hasOwnProperty(it)&&sr(s,l,it,null,h,ve);for(pe in h)if(ve=h[pe],Ee=c[pe],h.hasOwnProperty(pe)&&ve!==Ee&&(ve!=null||Ee!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,l));break;default:sr(s,l,pe,ve,h,Ee)}return;default:if(dc(l)){for(var ir in c)ve=c[ir],c.hasOwnProperty(ir)&&ve!==void 0&&!h.hasOwnProperty(ir)&&l1(s,l,ir,void 0,h,ve);for(Ce in h)ve=h[Ce],Ee=c[Ce],!h.hasOwnProperty(Ce)||ve===Ee||ve===void 0&&Ee===void 0||l1(s,l,Ce,ve,h,Ee);return}}for(var oe in c)ve=c[oe],c.hasOwnProperty(oe)&&ve!=null&&!h.hasOwnProperty(oe)&&sr(s,l,oe,null,h,ve);for(De in h)ve=h[De],Ee=c[De],!h.hasOwnProperty(De)||ve===Ee||ve==null&&Ee==null||sr(s,l,De,ve,h,Ee)}function Gw(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function m6(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,c=performance.getEntriesByType("resource"),h=0;h<c.length;h++){var v=c[h],_=v.transferSize,k=v.initiatorType,z=v.duration;if(_&&z&&Gw(k)){for(k=0,z=v.responseEnd,h+=1;h<c.length;h++){var ae=c[h],pe=ae.startTime;if(pe>z)break;var Ce=ae.transferSize,De=ae.initiatorType;Ce&&Gw(De)&&(ae=ae.responseEnd,k+=Ce*(ae<z?1:(z-pe)/(ae-pe)))}if(--h,l+=8*(_+k)/(v.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var o1=null,c1=null;function fd(s){return s.nodeType===9?s:s.ownerDocument}function qw(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ww(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function u1(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var f1=null;function p6(){var s=window.event;return s&&s.type==="popstate"?s===f1?!1:(f1=s,!0):(f1=null,!1)}var Xw=typeof setTimeout=="function"?setTimeout:void 0,g6=typeof clearTimeout=="function"?clearTimeout:void 0,Yw=typeof Promise=="function"?Promise:void 0,x6=typeof queueMicrotask=="function"?queueMicrotask:typeof Yw<"u"?function(s){return Yw.resolve(null).then(s).catch(v6)}:Xw;function v6(s){setTimeout(function(){throw s})}function ml(s){return s==="head"}function $w(s,l){var c=l,h=0;do{var v=c.nextSibling;if(s.removeChild(c),v&&v.nodeType===8)if(c=v.data,c==="/$"||c==="/&"){if(h===0){s.removeChild(v),Yc(l);return}h--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")h++;else if(c==="html")Cf(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,Cf(c);for(var _=c.firstChild;_;){var k=_.nextSibling,z=_.nodeName;_[ge]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&_.rel.toLowerCase()==="stylesheet"||c.removeChild(_),_=k}}else c==="body"&&Cf(s.ownerDocument.body);c=v}while(c);Yc(l)}function Kw(s,l){var c=s;s=0;do{var h=c.nextSibling;if(c.nodeType===1?l?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(l?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),h&&h.nodeType===8)if(c=h.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=h}while(c)}function h1(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var c=l;switch(l=l.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":h1(c),Be(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function y6(s,l,c,h){for(;s.nodeType===1;){var v=c;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[ge])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var _=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=Ha(s.nextSibling),s===null)break}return null}function _6(s,l,c){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=Ha(s.nextSibling),s===null))return null;return s}function Qw(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=Ha(s.nextSibling),s===null))return null;return s}function d1(s){return s.data==="$?"||s.data==="$~"}function m1(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function w6(s,l){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||c.readyState!=="loading")l();else{var h=function(){l(),c.removeEventListener("DOMContentLoaded",h)};c.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function Ha(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var p1=null;function Jw(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(l===0)return Ha(s.nextSibling);l--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||l++}s=s.nextSibling}return null}function Zw(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(l===0)return s;l--}else c!=="/$"&&c!=="/&"||l++}s=s.previousSibling}return null}function eb(s,l,c){switch(l=fd(c),s){case"html":if(s=l.documentElement,!s)throw Error(n(452));return s;case"head":if(s=l.head,!s)throw Error(n(453));return s;case"body":if(s=l.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Cf(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Be(s)}var Ga=new Map,tb=new Set;function hd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var wi=ce.d;ce.d={f:b6,r:E6,D:T6,C:S6,L:A6,m:k6,X:N6,S:C6,M:R6};function b6(){var s=wi.f(),l=nd();return s||l}function E6(s){var l=qe(s);l!==null&&l.tag===5&&l.type==="form"?v2(l):wi.r(s)}var qc=typeof document>"u"?null:document;function rb(s,l,c){var h=qc;if(h&&typeof l=="string"&&l){var v=ea(l);v='link[rel="'+s+'"][href="'+v+'"]',typeof c=="string"&&(v+='[crossorigin="'+c+'"]'),tb.has(v)||(tb.add(v),s={rel:s,crossOrigin:c,href:l},h.querySelector(v)===null&&(l=h.createElement("link"),bn(l,"link",s),Ze(l),h.head.appendChild(l)))}}function T6(s){wi.D(s),rb("dns-prefetch",s,null)}function S6(s,l){wi.C(s,l),rb("preconnect",s,l)}function A6(s,l,c){wi.L(s,l,c);var h=qc;if(h&&s&&l){var v='link[rel="preload"][as="'+ea(l)+'"]';l==="image"&&c&&c.imageSrcSet?(v+='[imagesrcset="'+ea(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(v+='[imagesizes="'+ea(c.imageSizes)+'"]')):v+='[href="'+ea(s)+'"]';var _=v;switch(l){case"style":_=Wc(s);break;case"script":_=Xc(s)}Ga.has(_)||(s=x({rel:"preload",href:l==="image"&&c&&c.imageSrcSet?void 0:s,as:l},c),Ga.set(_,s),h.querySelector(v)!==null||l==="style"&&h.querySelector(Nf(_))||l==="script"&&h.querySelector(Rf(_))||(l=h.createElement("link"),bn(l,"link",s),Ze(l),h.head.appendChild(l)))}}function k6(s,l){wi.m(s,l);var c=qc;if(c&&s){var h=l&&typeof l.as=="string"?l.as:"script",v='link[rel="modulepreload"][as="'+ea(h)+'"][href="'+ea(s)+'"]',_=v;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Xc(s)}if(!Ga.has(_)&&(s=x({rel:"modulepreload",href:s},l),Ga.set(_,s),c.querySelector(v)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(Rf(_)))return}h=c.createElement("link"),bn(h,"link",s),Ze(h),c.head.appendChild(h)}}}function C6(s,l,c){wi.S(s,l,c);var h=qc;if(h&&s){var v=Ge(h).hoistableStyles,_=Wc(s);l=l||"default";var k=v.get(_);if(!k){var z={loading:0,preload:null};if(k=h.querySelector(Nf(_)))z.loading=5;else{s=x({rel:"stylesheet",href:s,"data-precedence":l},c),(c=Ga.get(_))&&g1(s,c);var ae=k=h.createElement("link");Ze(ae),bn(ae,"link",s),ae._p=new Promise(function(pe,Ce){ae.onload=pe,ae.onerror=Ce}),ae.addEventListener("load",function(){z.loading|=1}),ae.addEventListener("error",function(){z.loading|=2}),z.loading|=4,dd(k,l,h)}k={type:"stylesheet",instance:k,count:1,state:z},v.set(_,k)}}}function N6(s,l){wi.X(s,l);var c=qc;if(c&&s){var h=Ge(c).hoistableScripts,v=Xc(s),_=h.get(v);_||(_=c.querySelector(Rf(v)),_||(s=x({src:s,async:!0},l),(l=Ga.get(v))&&x1(s,l),_=c.createElement("script"),Ze(_),bn(_,"link",s),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},h.set(v,_))}}function R6(s,l){wi.M(s,l);var c=qc;if(c&&s){var h=Ge(c).hoistableScripts,v=Xc(s),_=h.get(v);_||(_=c.querySelector(Rf(v)),_||(s=x({src:s,async:!0,type:"module"},l),(l=Ga.get(v))&&x1(s,l),_=c.createElement("script"),Ze(_),bn(_,"link",s),c.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},h.set(v,_))}}function nb(s,l,c,h){var v=(v=ue.current)?hd(v):null;if(!v)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(l=Wc(c.href),c=Ge(v).hoistableStyles,h=c.get(l),h||(h={type:"style",instance:null,count:0,state:null},c.set(l,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=Wc(c.href);var _=Ge(v).hoistableStyles,k=_.get(s);if(k||(v=v.ownerDocument||v,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,k),(_=v.querySelector(Nf(s)))&&!_._p&&(k.instance=_,k.state.loading=5),Ga.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Ga.set(s,c),_||I6(v,s,c,k.state))),l&&h===null)throw Error(n(528,""));return k}if(l&&h!==null)throw Error(n(529,""));return null;case"script":return l=c.async,c=c.src,typeof c=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Xc(c),c=Ge(v).hoistableScripts,h=c.get(l),h||(h={type:"script",instance:null,count:0,state:null},c.set(l,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function Wc(s){return'href="'+ea(s)+'"'}function Nf(s){return'link[rel="stylesheet"]['+s+"]"}function ab(s){return x({},s,{"data-precedence":s.precedence,precedence:null})}function I6(s,l,c,h){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?h.loading=1:(l=s.createElement("link"),h.preload=l,l.addEventListener("load",function(){return h.loading|=1}),l.addEventListener("error",function(){return h.loading|=2}),bn(l,"link",c),Ze(l),s.head.appendChild(l))}function Xc(s){return'[src="'+ea(s)+'"]'}function Rf(s){return"script[async]"+s}function sb(s,l,c){if(l.count++,l.instance===null)switch(l.type){case"style":var h=s.querySelector('style[data-href~="'+ea(c.href)+'"]');if(h)return l.instance=h,Ze(h),h;var v=x({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),Ze(h),bn(h,"style",v),dd(h,c.precedence,s),l.instance=h;case"stylesheet":v=Wc(c.href);var _=s.querySelector(Nf(v));if(_)return l.state.loading|=4,l.instance=_,Ze(_),_;h=ab(c),(v=Ga.get(v))&&g1(h,v),_=(s.ownerDocument||s).createElement("link"),Ze(_);var k=_;return k._p=new Promise(function(z,ae){k.onload=z,k.onerror=ae}),bn(_,"link",h),l.state.loading|=4,dd(_,c.precedence,s),l.instance=_;case"script":return _=Xc(c.src),(v=s.querySelector(Rf(_)))?(l.instance=v,Ze(v),v):(h=c,(v=Ga.get(_))&&(h=x({},c),x1(h,v)),s=s.ownerDocument||s,v=s.createElement("script"),Ze(v),bn(v,"link",h),s.head.appendChild(v),l.instance=v);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(h=l.instance,l.state.loading|=4,dd(h,c.precedence,s));return l.instance}function dd(s,l,c){for(var h=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=h.length?h[h.length-1]:null,_=v,k=0;k<h.length;k++){var z=h[k];if(z.dataset.precedence===l)_=z;else if(_!==v)break}_?_.parentNode.insertBefore(s,_.nextSibling):(l=c.nodeType===9?c.head:c,l.insertBefore(s,l.firstChild))}function g1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function x1(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var md=null;function ib(s,l,c){if(md===null){var h=new Map,v=md=new Map;v.set(c,h)}else v=md,h=v.get(c),h||(h=new Map,v.set(c,h));if(h.has(s))return h;for(h.set(s,null),c=c.getElementsByTagName(s),v=0;v<c.length;v++){var _=c[v];if(!(_[ge]||_[X]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var k=_.getAttribute(l)||"";k=s+k;var z=h.get(k);z?z.push(_):h.set(k,[_])}}return h}function lb(s,l,c){s=s.ownerDocument||s,s.head.insertBefore(c,l==="title"?s.querySelector("head > title"):null)}function D6(s,l,c){if(c===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function ob(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function O6(s,l,c,h){if(c.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var v=Wc(h.href),_=l.querySelector(Nf(v));if(_){l=_._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=pd.bind(s),l.then(s,s)),c.state.loading|=4,c.instance=_,Ze(_);return}_=l.ownerDocument||l,h=ab(h),(v=Ga.get(v))&&g1(h,v),_=_.createElement("link"),Ze(_);var k=_;k._p=new Promise(function(z,ae){k.onload=z,k.onerror=ae}),bn(_,"link",h),c.instance=_}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,l),(l=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=pd.bind(s),l.addEventListener("load",c),l.addEventListener("error",c))}}var v1=0;function F6(s,l){return s.stylesheets&&s.count===0&&xd(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var h=setTimeout(function(){if(s.stylesheets&&xd(s,s.stylesheets),s.unsuspend){var _=s.unsuspend;s.unsuspend=null,_()}},6e4+l);0<s.imgBytes&&v1===0&&(v1=62500*m6());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&xd(s,s.stylesheets),s.unsuspend)){var _=s.unsuspend;s.unsuspend=null,_()}},(s.imgBytes>v1?50:800)+l);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(h),clearTimeout(v)}}:null}function pd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)xd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var gd=null;function xd(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,gd=new Map,l.forEach(M6,s),gd=null,pd.call(s))}function M6(s,l){if(!(l.state.loading&4)){var c=gd.get(s);if(c)var h=c.get(null);else{c=new Map,gd.set(s,c);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<v.length;_++){var k=v[_];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(c.set(k.dataset.precedence,k),h=k)}h&&c.set(null,h)}v=l.instance,k=v.getAttribute("data-precedence"),_=c.get(k)||h,_===h&&c.set(null,v),c.set(k,v),this.count++,h=pd.bind(this),v.addEventListener("load",h),v.addEventListener("error",h),_?_.parentNode.insertBefore(v,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),l.state.loading|=4}}var If={$$typeof:C,Provider:null,Consumer:null,_currentValue:le,_currentValue2:le,_threadCount:0};function P6(s,l,c,h,v,_,k,z,ae){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Oa(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Oa(0),this.hiddenUpdates=Oa(null),this.identifierPrefix=h,this.onUncaughtError=v,this.onCaughtError=_,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ae,this.incompleteTransitions=new Map}function cb(s,l,c,h,v,_,k,z,ae,pe,Ce,De){return s=new P6(s,l,c,k,ae,pe,Ce,De,z),l=1,_===!0&&(l|=24),_=va(3,null,null,l),s.current=_,_.stateNode=s,l=Qp(),l.refCount++,s.pooledCache=l,l.refCount++,_.memoizedState={element:h,isDehydrated:c,cache:l},tg(_),s}function ub(s){return s?(s=Tc,s):Tc}function fb(s,l,c,h,v,_){v=ub(v),h.context===null?h.context=v:h.pendingContext=v,h=nl(l),h.payload={element:c},_=_===void 0?null:_,_!==null&&(h.callback=_),c=al(s,h,l),c!==null&&(ia(c,s,l),cf(c,s,l))}function hb(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<l?c:l}}function y1(s,l){hb(s,l),(s=s.alternate)&&hb(s,l)}function db(s){if(s.tag===13||s.tag===31){var l=yo(s,67108864);l!==null&&ia(l,s,67108864),y1(s,67108864)}}function mb(s){if(s.tag===13||s.tag===31){var l=Ea();l=ni(l);var c=yo(s,l);c!==null&&ia(c,s,l),y1(s,l)}}var vd=!0;function j6(s,l,c,h){var v=se.T;se.T=null;var _=ce.p;try{ce.p=2,_1(s,l,c,h)}finally{ce.p=_,se.T=v}}function L6(s,l,c,h){var v=se.T;se.T=null;var _=ce.p;try{ce.p=8,_1(s,l,c,h)}finally{ce.p=_,se.T=v}}function _1(s,l,c,h){if(vd){var v=w1(h);if(v===null)i1(s,l,h,yd,c),gb(s,h);else if(V6(v,s,l,c,h))h.stopPropagation();else if(gb(s,h),l&4&&-1<B6.indexOf(s)){for(;v!==null;){var _=qe(v);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var k=Wn(_.pendingLanes);if(k!==0){var z=_;for(z.pendingLanes|=2,z.entangledLanes|=2;k;){var ae=1<<31-dr(k);z.entanglements[1]|=ae,k&=~ae}Fs(_),(Gt&6)===0&&(td=zt()+500,Sf(0))}}break;case 31:case 13:z=yo(_,2),z!==null&&ia(z,_,2),nd(),y1(_,2)}if(_=w1(h),_===null&&i1(s,l,h,yd,c),_===v)break;v=_}v!==null&&h.stopPropagation()}else i1(s,l,h,null,c)}}function w1(s){return s=Fa(s),b1(s)}var yd=null;function b1(s){if(yd=null,s=Ve(s),s!==null){var l=i(s);if(l===null)s=null;else{var c=l.tag;if(c===13){if(s=o(l),s!==null)return s;s=null}else if(c===31){if(s=u(l),s!==null)return s;s=null}else if(c===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return yd=s,null}function pb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Gr()){case nn:return 2;case qn:return 8;case Xt:case Or:return 32;case dt:return 268435456;default:return 32}default:return 32}}var E1=!1,pl=null,gl=null,xl=null,Df=new Map,Of=new Map,vl=[],B6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function gb(s,l){switch(s){case"focusin":case"focusout":pl=null;break;case"dragenter":case"dragleave":gl=null;break;case"mouseover":case"mouseout":xl=null;break;case"pointerover":case"pointerout":Df.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Of.delete(l.pointerId)}}function Ff(s,l,c,h,v,_){return s===null||s.nativeEvent!==_?(s={blockedOn:l,domEventName:c,eventSystemFlags:h,nativeEvent:_,targetContainers:[v]},l!==null&&(l=qe(l),l!==null&&db(l)),s):(s.eventSystemFlags|=h,l=s.targetContainers,v!==null&&l.indexOf(v)===-1&&l.push(v),s)}function V6(s,l,c,h,v){switch(l){case"focusin":return pl=Ff(pl,s,l,c,h,v),!0;case"dragenter":return gl=Ff(gl,s,l,c,h,v),!0;case"mouseover":return xl=Ff(xl,s,l,c,h,v),!0;case"pointerover":var _=v.pointerId;return Df.set(_,Ff(Df.get(_)||null,s,l,c,h,v)),!0;case"gotpointercapture":return _=v.pointerId,Of.set(_,Ff(Of.get(_)||null,s,l,c,h,v)),!0}return!1}function xb(s){var l=Ve(s.target);if(l!==null){var c=i(l);if(c!==null){if(l=c.tag,l===13){if(l=o(c),l!==null){s.blockedOn=l,Z(s.priority,function(){mb(c)});return}}else if(l===31){if(l=u(c),l!==null){s.blockedOn=l,Z(s.priority,function(){mb(c)});return}}else if(l===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function _d(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var c=w1(s.nativeEvent);if(c===null){c=s.nativeEvent;var h=new c.constructor(c.type,c);Wu=h,c.target.dispatchEvent(h),Wu=null}else return l=qe(c),l!==null&&db(l),s.blockedOn=c,!1;l.shift()}return!0}function vb(s,l,c){_d(s)&&c.delete(l)}function U6(){E1=!1,pl!==null&&_d(pl)&&(pl=null),gl!==null&&_d(gl)&&(gl=null),xl!==null&&_d(xl)&&(xl=null),Df.forEach(vb),Of.forEach(vb)}function wd(s,l){s.blockedOn===l&&(s.blockedOn=null,E1||(E1=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,U6)))}var bd=null;function yb(s){bd!==s&&(bd=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){bd===s&&(bd=null);for(var l=0;l<s.length;l+=3){var c=s[l],h=s[l+1],v=s[l+2];if(typeof h!="function"){if(b1(h||c)===null)continue;break}var _=qe(c);_!==null&&(s.splice(l,3),l-=3,wg(_,{pending:!0,data:v,method:c.method,action:h},h,v))}}))}function Yc(s){function l(ae){return wd(ae,s)}pl!==null&&wd(pl,s),gl!==null&&wd(gl,s),xl!==null&&wd(xl,s),Df.forEach(l),Of.forEach(l);for(var c=0;c<vl.length;c++){var h=vl[c];h.blockedOn===s&&(h.blockedOn=null)}for(;0<vl.length&&(c=vl[0],c.blockedOn===null);)xb(c),c.blockedOn===null&&vl.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(h=0;h<c.length;h+=3){var v=c[h],_=c[h+1],k=v[K]||null;if(typeof _=="function")k||yb(c);else if(k){var z=null;if(_&&_.hasAttribute("formAction")){if(v=_,k=_[K]||null)z=k.formAction;else if(b1(v)!==null)continue}else z=k.action;typeof z=="function"?c[h+1]=z:(c.splice(h,3),h-=3),yb(c)}}}function _b(){function s(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(k){return v=k})},focusReset:"manual",scroll:"manual"})}function l(){v!==null&&(v(),v=null),h||setTimeout(c,20)}function c(){if(!h&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(c,100),function(){h=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),v!==null&&(v(),v=null)}}}function T1(s){this._internalRoot=s}Ed.prototype.render=T1.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(n(409));var c=l.current,h=Ea();fb(c,h,s,l,null,null)},Ed.prototype.unmount=T1.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;fb(s.current,2,null,s,null,null),nd(),l[ee]=null}};function Ed(s){this._internalRoot=s}Ed.prototype.unstable_scheduleHydration=function(s){if(s){var l=U();s={blockedOn:null,target:s,priority:l};for(var c=0;c<vl.length&&l!==0&&l<vl[c].priority;c++);vl.splice(c,0,s),c===0&&xb(s)}};var wb=e.version;if(wb!=="19.2.1")throw Error(n(527,wb,"19.2.1"));ce.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=d(l),s=s!==null?m(s):null,s=s===null?null:s.stateNode,s};var z6={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:se,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Td=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Td.isDisabled&&Td.supportsFiber)try{Mt=Td.inject(z6),or=Td}catch{}}return Pf.createRoot=function(s,l){if(!a(s))throw Error(n(299));var c=!1,h="",v=C2,_=N2,k=R2;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(h=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(_=l.onCaughtError),l.onRecoverableError!==void 0&&(k=l.onRecoverableError)),l=cb(s,1,!1,null,null,c,h,null,v,_,k,_b),s[ee]=l.current,s1(s),new T1(l)},Pf.hydrateRoot=function(s,l,c){if(!a(s))throw Error(n(299));var h=!1,v="",_=C2,k=N2,z=R2,ae=null;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onUncaughtError!==void 0&&(_=c.onUncaughtError),c.onCaughtError!==void 0&&(k=c.onCaughtError),c.onRecoverableError!==void 0&&(z=c.onRecoverableError),c.formState!==void 0&&(ae=c.formState)),l=cb(s,1,!0,l,c??null,h,v,ae,_,k,z,_b),l.context=ub(null),c=l.current,h=Ea(),h=ni(h),v=nl(h),v.callback=null,al(c,v,h),c=h,l.current.lanes=c,ei(l,c),Fs(l),s[ee]=l.current,s1(s),new Ed(l)},Pf.version="19.2.1",Pf}var Ib;function J6(){if(Ib)return k1.exports;Ib=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),k1.exports=Q6(),k1.exports}var Z6=J6();const eR=jS(Z6);var Db="popstate";function tR(t={}){function e(a,i){let{pathname:o="/",search:u="",hash:f=""}=ec(a.location.hash.substring(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),fx("",{pathname:o,search:u,hash:f},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(a,i){let o=a.document.querySelector("base"),u="";if(o&&o.getAttribute("href")){let f=a.location.href,d=f.indexOf("#");u=d===-1?f:f.slice(0,d)}return u+"#"+(typeof i=="string"?i:o0(i))}function n(a,i){Ra(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return nR(e,r,n,t)}function Er(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Ra(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function rR(){return Math.random().toString(36).substring(2,10)}function Ob(t,e){return{usr:t.state,key:t.key,idx:e}}function fx(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ec(e):e,state:r,key:e&&e.key||n||rR()}}function o0({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function ec(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function nR(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,u="POP",f=null,d=m();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function m(){return(o.state||{idx:null}).idx}function x(){u="POP";let T=m(),I=T==null?null:T-d;d=T,f&&f({action:u,location:b.location,delta:I})}function y(T,I){u="PUSH";let R=fx(b.location,T,I);r&&r(R,T),d=m()+1;let C=Ob(R,d),G=b.createHref(R);try{o.pushState(C,"",G)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;a.location.assign(G)}i&&f&&f({action:u,location:b.location,delta:1})}function w(T,I){u="REPLACE";let R=fx(b.location,T,I);r&&r(R,T),d=m();let C=Ob(R,d),G=b.createHref(R);o.replaceState(C,"",G),i&&f&&f({action:u,location:b.location,delta:0})}function E(T){return aR(T)}let b={get action(){return u},get location(){return t(a,o)},listen(T){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(Db,x),f=T,()=>{a.removeEventListener(Db,x),f=null}},createHref(T){return e(a,T)},createURL:E,encodeLocation(T){let I=E(T);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:y,replace:w,go(T){return o.go(T)}};return b}function aR(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),Er(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:o0(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function LS(t,e,r="/"){return sR(t,e,r,!1)}function sR(t,e,r,n){let a=typeof e=="string"?ec(e):e,i=Ri(a.pathname||"/",r);if(i==null)return null;let o=BS(t);iR(o);let u=null;for(let f=0;u==null&&f<o.length;++f){let d=xR(i);u=pR(o[f],d,n)}return u}function BS(t,e=[],r=[],n="",a=!1){let i=(o,u,f=a,d)=>{let m={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};if(m.relativePath.startsWith("/")){if(!m.relativePath.startsWith(n)&&f)return;Er(m.relativePath.startsWith(n),`Absolute route path "${m.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),m.relativePath=m.relativePath.slice(n.length)}let x=Ai([n,m.relativePath]),y=r.concat(m);o.children&&o.children.length>0&&(Er(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${x}".`),BS(o.children,e,y,x,f)),!(o.path==null&&!o.index)&&e.push({path:x,score:dR(x,o.index),routesMeta:y})};return t.forEach((o,u)=>{if(o.path===""||!o.path?.includes("?"))i(o,u);else for(let f of VS(o.path))i(o,u,!0,f)}),e}function VS(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=VS(n.join("/")),u=[];return u.push(...o.map(f=>f===""?i:[i,f].join("/"))),a&&u.push(...o),u.map(f=>t.startsWith("/")&&f===""?"/":f)}function iR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:mR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var lR=/^:[\w-]+$/,oR=3,cR=2,uR=1,fR=10,hR=-2,Fb=t=>t==="*";function dR(t,e){let r=t.split("/"),n=r.length;return r.some(Fb)&&(n+=hR),e&&(n+=cR),r.filter(a=>!Fb(a)).reduce((a,i)=>a+(lR.test(i)?oR:i===""?uR:fR),n)}function mR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function pR(t,e,r=!1){let{routesMeta:n}=t,a={},i="/",o=[];for(let u=0;u<n.length;++u){let f=n[u],d=u===n.length-1,m=i==="/"?e:e.slice(i.length)||"/",x=lm({path:f.relativePath,caseSensitive:f.caseSensitive,end:d},m),y=f.route;if(!x&&d&&r&&!n[n.length-1].route.index&&(x=lm({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},m)),!x)return null;Object.assign(a,x.params),o.push({params:a,pathname:Ai([i,x.pathname]),pathnameBase:bR(Ai([i,x.pathnameBase])),route:y}),x.pathnameBase!=="/"&&(i=Ai([i,x.pathnameBase]))}return o}function lm(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=gR(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((d,{paramName:m,isOptional:x},y)=>{if(m==="*"){let E=u[y]||"";o=i.slice(0,i.length-E.length).replace(/(.)\/+$/,"$1")}const w=u[y];return x&&!w?d[m]=void 0:d[m]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function gR(t,e=!1,r=!0){Ra(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,f)=>(n.push({paramName:u,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function xR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Ra(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ri(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}var vR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yR=t=>vR.test(t);function _R(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?ec(t):t,i;if(r)if(yR(r))i=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),Ra(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${r}`)}r.startsWith("/")?i=Mb(r.substring(1),"/"):i=Mb(r,e)}else i=e;return{pathname:i,search:ER(n),hash:TR(a)}}function Mb(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function I1(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wR(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function iv(t){let e=wR(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function lv(t,e,r,n=!1){let a;typeof t=="string"?a=ec(t):(a={...t},Er(!a.pathname||!a.pathname.includes("?"),I1("?","pathname","search",a)),Er(!a.pathname||!a.pathname.includes("#"),I1("#","pathname","hash",a)),Er(!a.search||!a.search.includes("#"),I1("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,u;if(o==null)u=r;else{let x=e.length-1;if(!n&&o.startsWith("..")){let y=o.split("/");for(;y[0]==="..";)y.shift(),x-=1;a.pathname=y.join("/")}u=x>=0?e[x]:"/"}let f=_R(a,u),d=o&&o!=="/"&&o.endsWith("/"),m=(i||o===".")&&r.endsWith("/");return!f.pathname.endsWith("/")&&(d||m)&&(f.pathname+="/"),f}var Ai=t=>t.join("/").replace(/\/\/+/g,"/"),bR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),ER=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,TR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function SR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function AR(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var US=["POST","PUT","PATCH","DELETE"];new Set(US);var kR=["GET",...US];new Set(kR);var Au=re.createContext(null);Au.displayName="DataRouter";var qm=re.createContext(null);qm.displayName="DataRouterState";re.createContext(!1);var zS=re.createContext({isTransitioning:!1});zS.displayName="ViewTransition";var CR=re.createContext(new Map);CR.displayName="Fetchers";var NR=re.createContext(null);NR.displayName="Await";var ts=re.createContext(null);ts.displayName="Navigation";var D0=re.createContext(null);D0.displayName="Location";var $s=re.createContext({outlet:null,matches:[],isDataRoute:!1});$s.displayName="Route";var ov=re.createContext(null);ov.displayName="RouteError";function RR(t,{relative:e}={}){Er(ku(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=re.useContext(ts),{hash:a,pathname:i,search:o}=F0(t,{relative:e}),u=i;return r!=="/"&&(u=i==="/"?r:Ai([r,i])),n.createHref({pathname:u,search:o,hash:a})}function ku(){return re.useContext(D0)!=null}function Ql(){return Er(ku(),"useLocation() may be used only in the context of a <Router> component."),re.useContext(D0).location}var HS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function GS(t){re.useContext(ts).static||re.useLayoutEffect(t)}function O0(){let{isDataRoute:t}=re.useContext($s);return t?HR():IR()}function IR(){Er(ku(),"useNavigate() may be used only in the context of a <Router> component.");let t=re.useContext(Au),{basename:e,navigator:r}=re.useContext(ts),{matches:n}=re.useContext($s),{pathname:a}=Ql(),i=JSON.stringify(iv(n)),o=re.useRef(!1);return GS(()=>{o.current=!0}),re.useCallback((f,d={})=>{if(Ra(o.current,HS),!o.current)return;if(typeof f=="number"){r.go(f);return}let m=lv(f,JSON.parse(i),a,d.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Ai([e,m.pathname])),(d.replace?r.replace:r.push)(m,d.state,d)},[e,r,i,a,t])}re.createContext(null);function F0(t,{relative:e}={}){let{matches:r}=re.useContext($s),{pathname:n}=Ql(),a=JSON.stringify(iv(r));return re.useMemo(()=>lv(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function DR(t,e){return qS(t,e)}function qS(t,e,r,n,a){Er(ku(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=re.useContext(ts),{matches:o}=re.useContext($s),u=o[o.length-1],f=u?u.params:{},d=u?u.pathname:"/",m=u?u.pathnameBase:"/",x=u&&u.route;{let R=x&&x.path||"";WS(d,!x||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let y=Ql(),w;if(e){let R=typeof e=="string"?ec(e):e;Er(m==="/"||R.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${R.pathname}" was given in the \`location\` prop.`),w=R}else w=y;let E=w.pathname||"/",b=E;if(m!=="/"){let R=m.replace(/^\//,"").split("/");b="/"+E.replace(/^\//,"").split("/").slice(R.length).join("/")}let T=LS(t,{pathname:b});Ra(x||T!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),Ra(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let I=jR(T&&T.map(R=>Object.assign({},R,{params:Object.assign({},f,R.params),pathname:Ai([m,i.encodeLocation?i.encodeLocation(R.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?m:Ai([m,i.encodeLocation?i.encodeLocation(R.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathnameBase])})),o,r,n,a);return e&&I?re.createElement(D0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},I):I}function OR(){let t=zR(),e=SR(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=re.createElement(re.Fragment,null,re.createElement("p",null," Hey developer "),re.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",re.createElement("code",{style:i},"ErrorBoundary")," or"," ",re.createElement("code",{style:i},"errorElement")," prop on your route.")),re.createElement(re.Fragment,null,re.createElement("h2",null,"Unexpected Application Error!"),re.createElement("h3",{style:{fontStyle:"italic"}},e),r?re.createElement("pre",{style:a},r):null,o)}var FR=re.createElement(OR,null),MR=class extends re.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?re.createElement($s.Provider,{value:this.props.routeContext},re.createElement(ov.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function PR({routeContext:t,match:e,children:r}){let n=re.useContext(Au);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),re.createElement($s.Provider,{value:t},r)}function jR(t,e=[],r=null,n=null,a=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,o=r?.errors;if(o!=null){let m=i.findIndex(x=>x.route.id&&o?.[x.route.id]!==void 0);Er(m>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,m+1))}let u=!1,f=-1;if(r)for(let m=0;m<i.length;m++){let x=i[m];if((x.route.HydrateFallback||x.route.hydrateFallbackElement)&&(f=m),x.route.id){let{loaderData:y,errors:w}=r,E=x.route.loader&&!y.hasOwnProperty(x.route.id)&&(!w||w[x.route.id]===void 0);if(x.route.lazy||E){u=!0,f>=0?i=i.slice(0,f+1):i=[i[0]];break}}}let d=r&&n?(m,x)=>{n(m,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:AR(r.matches),errorInfo:x})}:void 0;return i.reduceRight((m,x,y)=>{let w,E=!1,b=null,T=null;r&&(w=o&&x.route.id?o[x.route.id]:void 0,b=x.route.errorElement||FR,u&&(f<0&&y===0?(WS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),E=!0,T=null):f===y&&(E=!0,T=x.route.hydrateFallbackElement||null)));let I=e.concat(i.slice(0,y+1)),R=()=>{let C;return w?C=b:E?C=T:x.route.Component?C=re.createElement(x.route.Component,null):x.route.element?C=x.route.element:C=m,re.createElement(PR,{match:x,routeContext:{outlet:m,matches:I,isDataRoute:r!=null},children:C})};return r&&(x.route.ErrorBoundary||x.route.errorElement||y===0)?re.createElement(MR,{location:r.location,revalidation:r.revalidation,component:b,error:w,children:R(),routeContext:{outlet:null,matches:I,isDataRoute:!0},onError:d}):R()},null)}function cv(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function LR(t){let e=re.useContext(Au);return Er(e,cv(t)),e}function BR(t){let e=re.useContext(qm);return Er(e,cv(t)),e}function VR(t){let e=re.useContext($s);return Er(e,cv(t)),e}function uv(t){let e=VR(t),r=e.matches[e.matches.length-1];return Er(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function UR(){return uv("useRouteId")}function zR(){let t=re.useContext(ov),e=BR("useRouteError"),r=uv("useRouteError");return t!==void 0?t:e.errors?.[r]}function HR(){let{router:t}=LR("useNavigate"),e=uv("useNavigate"),r=re.useRef(!1);return GS(()=>{r.current=!0}),re.useCallback(async(a,i={})=>{Ra(r.current,HS),r.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...i}))},[t,e])}var Pb={};function WS(t,e,r){!e&&!Pb[t]&&(Pb[t]=!0,Ra(!1,r))}re.memo(GR);function GR({routes:t,future:e,state:r,unstable_onError:n}){return qS(t,void 0,r,n,e)}function Sd({to:t,replace:e,state:r,relative:n}){Er(ku(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=re.useContext(ts);Ra(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=re.useContext($s),{pathname:o}=Ql(),u=O0(),f=lv(t,iv(i),o,n==="path"),d=JSON.stringify(f);return re.useEffect(()=>{u(JSON.parse(d),{replace:e,state:r,relative:n})},[u,d,n,e,r]),null}function Vf(t){Er(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function qR({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:i=!1,unstable_useTransitions:o}){Er(!ku(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),f=re.useMemo(()=>({basename:u,navigator:a,static:i,unstable_useTransitions:o,future:{}}),[u,a,i,o]);typeof r=="string"&&(r=ec(r));let{pathname:d="/",search:m="",hash:x="",state:y=null,key:w="default"}=r,E=re.useMemo(()=>{let b=Ri(d,u);return b==null?null:{location:{pathname:b,search:m,hash:x,state:y,key:w},navigationType:n}},[u,d,m,x,y,w,n]);return Ra(E!=null,`<Router basename="${u}"> is not able to match the URL "${d}${m}${x}" because it does not start with the basename, so the <Router> won't render anything.`),E==null?null:re.createElement(ts.Provider,{value:f},re.createElement(D0.Provider,{children:e,value:E}))}function WR({children:t,location:e}){return DR(hx(t),e)}function hx(t,e=[]){let r=[];return re.Children.forEach(t,(n,a)=>{if(!re.isValidElement(n))return;let i=[...e,a];if(n.type===re.Fragment){r.push.apply(r,hx(n.props.children,i));return}Er(n.type===Vf,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Er(!n.props.index||!n.props.children,"An index route cannot have child routes.");let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=hx(n.props.children,i)),r.push(o)}),r}var Yd="get",$d="application/x-www-form-urlencoded";function Wm(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function XR(t){return Wm(t)&&t.tagName.toLowerCase()==="button"}function YR(t){return Wm(t)&&t.tagName.toLowerCase()==="form"}function $R(t){return Wm(t)&&t.tagName.toLowerCase()==="input"}function KR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function QR(t,e){return t.button===0&&(!e||e==="_self")&&!KR(t)}var Ad=null;function JR(){if(Ad===null)try{new FormData(document.createElement("form"),0),Ad=!1}catch{Ad=!0}return Ad}var ZR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function D1(t){return t!=null&&!ZR.has(t)?(Ra(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${$d}"`),null):t}function e5(t,e){let r,n,a,i,o;if(YR(t)){let u=t.getAttribute("action");n=u?Ri(u,e):null,r=t.getAttribute("method")||Yd,a=D1(t.getAttribute("enctype"))||$d,i=new FormData(t)}else if(XR(t)||$R(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=t.getAttribute("formaction")||u.getAttribute("action");if(n=f?Ri(f,e):null,r=t.getAttribute("formmethod")||u.getAttribute("method")||Yd,a=D1(t.getAttribute("formenctype"))||D1(u.getAttribute("enctype"))||$d,i=new FormData(u,t),!JR()){let{name:d,type:m,value:x}=t;if(m==="image"){let y=d?`${d}.`:"";i.append(`${y}x`,"0"),i.append(`${y}y`,"0")}else d&&i.append(d,x)}}else{if(Wm(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Yd,n=null,a=$d,o=t}return i&&a==="text/plain"&&(o=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function fv(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function t5(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&Ri(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function r5(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function n5(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function a5(t,e,r){let n=await Promise.all(t.map(async a=>{let i=e.routes[a.route.id];if(i){let o=await r5(i,r);return o.links?o.links():[]}return[]}));return o5(n.flat(1).filter(n5).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function jb(t,e,r,n,a,i){let o=(f,d)=>r[d]?f.route.id!==r[d].route.id:!0,u=(f,d)=>r[d].pathname!==f.pathname||r[d].route.path?.endsWith("*")&&r[d].params["*"]!==f.params["*"];return i==="assets"?e.filter((f,d)=>o(f,d)||u(f,d)):i==="data"?e.filter((f,d)=>{let m=n.routes[f.route.id];if(!m||!m.hasLoader)return!1;if(o(f,d)||u(f,d))return!0;if(f.route.shouldRevalidate){let x=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function s5(t,e,{includeHydrateFallback:r}={}){return i5(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function i5(t){return[...new Set(t)]}function l5(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function o5(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let i=JSON.stringify(l5(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}function XS(){let t=re.useContext(Au);return fv(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function c5(){let t=re.useContext(qm);return fv(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var hv=re.createContext(void 0);hv.displayName="FrameworkContext";function YS(){let t=re.useContext(hv);return fv(t,"You must render this element inside a <HydratedRouter> element"),t}function u5(t,e){let r=re.useContext(hv),[n,a]=re.useState(!1),[i,o]=re.useState(!1),{onFocus:u,onBlur:f,onMouseEnter:d,onMouseLeave:m,onTouchStart:x}=e,y=re.useRef(null);re.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let b=I=>{I.forEach(R=>{o(R.isIntersecting)})},T=new IntersectionObserver(b,{threshold:.5});return y.current&&T.observe(y.current),()=>{T.disconnect()}}},[t]),re.useEffect(()=>{if(n){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[n]);let w=()=>{a(!0)},E=()=>{a(!1),o(!1)};return r?t!=="intent"?[i,y,{}]:[i,y,{onFocus:jf(u,w),onBlur:jf(f,E),onMouseEnter:jf(d,w),onMouseLeave:jf(m,E),onTouchStart:jf(x,w)}]:[!1,y,{}]}function jf(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function f5({page:t,...e}){let{router:r}=XS(),n=re.useMemo(()=>LS(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?re.createElement(d5,{page:t,matches:n,...e}):null}function h5(t){let{manifest:e,routeModules:r}=YS(),[n,a]=re.useState([]);return re.useEffect(()=>{let i=!1;return a5(t,e,r).then(o=>{i||a(o)}),()=>{i=!0}},[t,e,r]),n}function d5({page:t,matches:e,...r}){let n=Ql(),{manifest:a,routeModules:i}=YS(),{basename:o}=XS(),{loaderData:u,matches:f}=c5(),d=re.useMemo(()=>jb(t,e,f,a,n,"data"),[t,e,f,a,n]),m=re.useMemo(()=>jb(t,e,f,a,n,"assets"),[t,e,f,a,n]),x=re.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let E=new Set,b=!1;if(e.forEach(I=>{let R=a.routes[I.route.id];!R||!R.hasLoader||(!d.some(C=>C.route.id===I.route.id)&&I.route.id in u&&i[I.route.id]?.shouldRevalidate||R.hasClientLoader?b=!0:E.add(I.route.id))}),E.size===0)return[];let T=t5(t,o,"data");return b&&E.size>0&&T.searchParams.set("_routes",e.filter(I=>E.has(I.route.id)).map(I=>I.route.id).join(",")),[T.pathname+T.search]},[o,u,n,a,d,e,t,i]),y=re.useMemo(()=>s5(m,a),[m,a]),w=h5(m);return re.createElement(re.Fragment,null,x.map(E=>re.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...r})),y.map(E=>re.createElement("link",{key:E,rel:"modulepreload",href:E,...r})),w.map(({key:E,link:b})=>re.createElement("link",{key:E,nonce:r.nonce,...b})))}function m5(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var $S=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{$S&&(window.__reactRouterVersion="7.10.1")}catch{}function p5({basename:t,children:e,unstable_useTransitions:r,window:n}){let a=re.useRef();a.current==null&&(a.current=tR({window:n,v5Compat:!0}));let i=a.current,[o,u]=re.useState({action:i.action,location:i.location}),f=re.useCallback(d=>{r===!1?u(d):re.startTransition(()=>u(d))},[r]);return re.useLayoutEffect(()=>i.listen(f),[i,f]),re.createElement(qR,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:i,unstable_useTransitions:r===!0})}var KS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,du=re.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:o,state:u,target:f,to:d,preventScrollReset:m,viewTransition:x,...y},w){let{basename:E,unstable_useTransitions:b}=re.useContext(ts),T=typeof d=="string"&&KS.test(d),I,R=!1;if(typeof d=="string"&&T&&(I=d,$S))try{let M=new URL(window.location.href),F=d.startsWith("//")?new URL(M.protocol+d):new URL(d),j=Ri(F.pathname,E);F.origin===M.origin&&j!=null?d=j+F.search+F.hash:R=!0}catch{Ra(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=RR(d,{relative:a}),[G,V,H]=u5(n,y),A=y5(d,{replace:o,state:u,target:f,preventScrollReset:m,relative:a,viewTransition:x,unstable_useTransitions:b});function D(M){e&&e(M),M.defaultPrevented||A(M)}let N=re.createElement("a",{...y,...H,href:I||C,onClick:R||i?e:D,ref:m5(w,V),target:f,"data-discover":!T&&r==="render"?"true":void 0});return G&&!T?re.createElement(re.Fragment,null,N,re.createElement(f5,{page:C})):N});du.displayName="Link";var g5=re.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:o,viewTransition:u,children:f,...d},m){let x=F0(o,{relative:d.relative}),y=Ql(),w=re.useContext(qm),{navigator:E,basename:b}=re.useContext(ts),T=w!=null&&T5(x)&&u===!0,I=E.encodeLocation?E.encodeLocation(x).pathname:x.pathname,R=y.pathname,C=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;r||(R=R.toLowerCase(),C=C?C.toLowerCase():null,I=I.toLowerCase()),C&&b&&(C=Ri(C,b)||C);const G=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let V=R===I||!a&&R.startsWith(I)&&R.charAt(G)==="/",H=C!=null&&(C===I||!a&&C.startsWith(I)&&C.charAt(I.length)==="/"),A={isActive:V,isPending:H,isTransitioning:T},D=V?e:void 0,N;typeof n=="function"?N=n(A):N=[n,V?"active":null,H?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let M=typeof i=="function"?i(A):i;return re.createElement(du,{...d,"aria-current":D,className:N,ref:m,style:M,to:o,viewTransition:u},typeof f=="function"?f(A):f)});g5.displayName="NavLink";var x5=re.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:i,method:o=Yd,action:u,onSubmit:f,relative:d,preventScrollReset:m,viewTransition:x,...y},w)=>{let{unstable_useTransitions:E}=re.useContext(ts),b=b5(),T=E5(u,{relative:d}),I=o.toLowerCase()==="get"?"get":"post",R=typeof u=="string"&&KS.test(u),C=G=>{if(f&&f(G),G.defaultPrevented)return;G.preventDefault();let V=G.nativeEvent.submitter,H=V?.getAttribute("formmethod")||o,A=()=>b(V||G.currentTarget,{fetcherKey:e,method:H,navigate:r,replace:a,state:i,relative:d,preventScrollReset:m,viewTransition:x});E&&r!==!1?re.startTransition(()=>A()):A()};return re.createElement("form",{ref:w,method:I,action:T,onSubmit:n?f:C,...y,"data-discover":!R&&t==="render"?"true":void 0})});x5.displayName="Form";function v5(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function QS(t){let e=re.useContext(Au);return Er(e,v5(t)),e}function y5(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:o,unstable_useTransitions:u}={}){let f=O0(),d=Ql(),m=F0(t,{relative:i});return re.useCallback(x=>{if(QR(x,e)){x.preventDefault();let y=r!==void 0?r:o0(d)===o0(m),w=()=>f(t,{replace:y,state:n,preventScrollReset:a,relative:i,viewTransition:o});u?re.startTransition(()=>w()):w()}},[d,f,m,r,n,e,t,a,i,o,u])}var _5=0,w5=()=>`__${String(++_5)}__`;function b5(){let{router:t}=QS("useSubmit"),{basename:e}=re.useContext(ts),r=UR(),n=t.fetch,a=t.navigate;return re.useCallback(async(i,o={})=>{let{action:u,method:f,encType:d,formData:m,body:x}=e5(i,e);if(o.navigate===!1){let y=o.fetcherKey||w5();await n(y,r,o.action||u,{preventScrollReset:o.preventScrollReset,formData:m,body:x,formMethod:o.method||f,formEncType:o.encType||d,flushSync:o.flushSync})}else await a(o.action||u,{preventScrollReset:o.preventScrollReset,formData:m,body:x,formMethod:o.method||f,formEncType:o.encType||d,replace:o.replace,state:o.state,fromRouteId:r,flushSync:o.flushSync,viewTransition:o.viewTransition})},[n,a,e,r])}function E5(t,{relative:e}={}){let{basename:r}=re.useContext(ts),n=re.useContext($s);Er(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...F0(t||".",{relative:e})},o=Ql();if(t==null){i.search=o.search;let u=new URLSearchParams(i.search),f=u.getAll("index");if(f.some(m=>m==="")){u.delete("index"),f.filter(x=>x).forEach(x=>u.append("index",x));let m=u.toString();i.search=m?`?${m}`:""}}return(!t||t===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:Ai([r,i.pathname])),o0(i)}function T5(t,{relative:e}={}){let r=re.useContext(zS);Er(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=QS("useViewTransitionState"),a=F0(t,{relative:e});if(!r.isTransitioning)return!1;let i=Ri(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=Ri(r.nextLocation.pathname,n)||r.nextLocation.pathname;return lm(a.pathname,o)!=null||lm(a.pathname,i)!=null}const S5=()=>{};var Lb={};const JS=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},A5=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const i=t[r++];e[n++]=String.fromCharCode((a&31)<<6|i&63)}else if(a>239&&a<365){const i=t[r++],o=t[r++],u=t[r++],f=((a&7)<<18|(i&63)<<12|(o&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(f>>10)),e[n++]=String.fromCharCode(56320+(f&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(i&63)<<6|o&63)}}return e.join("")},ZS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const i=t[a],o=a+1<t.length,u=o?t[a+1]:0,f=a+2<t.length,d=f?t[a+2]:0,m=i>>2,x=(i&3)<<4|u>>4;let y=(u&15)<<2|d>>6,w=d&63;f||(w=64,o||(y=64)),n.push(r[m],r[x],r[y],r[w])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(JS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):A5(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const i=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const d=a<t.length?r[t.charAt(a)]:64;++a;const x=a<t.length?r[t.charAt(a)]:64;if(++a,i==null||u==null||d==null||x==null)throw new k5;const y=i<<2|u>>4;if(n.push(y),d!==64){const w=u<<4&240|d>>2;if(n.push(w),x!==64){const E=d<<6&192|x;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class k5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const C5=function(t){const e=JS(t);return ZS.encodeByteArray(e,!0)},om=function(t){return C5(t).replace(/\./g,"")},e4=function(t){try{return ZS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function N5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const R5=()=>N5().__FIREBASE_DEFAULTS__,I5=()=>{if(typeof process>"u"||typeof Lb>"u")return;const t=Lb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},D5=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&e4(t[1]);return e&&JSON.parse(e)},Xm=()=>{try{return S5()||R5()||I5()||D5()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},t4=t=>Xm()?.emulatorHosts?.[t],O5=t=>{const e=t4(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},r4=()=>Xm()?.config,n4=t=>Xm()?.[`_${t}`];class F5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}function Cu(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function a4(t){return(await fetch(t,{credentials:"include"})).ok}function M5(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[om(JSON.stringify(r)),om(JSON.stringify(o)),""].join(".")}const Yf={};function P5(){const t={prod:[],emulator:[]};for(const e of Object.keys(Yf))Yf[e]?t.emulator.push(e):t.prod.push(e);return t}function j5(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Bb=!1;function s4(t,e){if(typeof window>"u"||typeof document>"u"||!Cu(window.location.host)||Yf[t]===e||Yf[t]||Bb)return;Yf[t]=e;function r(y){return`__firebase__banner__${y}`}const n="__firebase__banner",i=P5().prod.length>0;function o(){const y=document.getElementById(n);y&&y.remove()}function u(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function f(y,w){y.setAttribute("width","24"),y.setAttribute("id",w),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function d(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{Bb=!0,o()},y}function m(y,w){y.setAttribute("id",w),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function x(){const y=j5(n),w=r("text"),E=document.getElementById(w)||document.createElement("span"),b=r("learnmore"),T=document.getElementById(b)||document.createElement("a"),I=r("preprendIcon"),R=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const C=y.element;u(C),m(T,b);const G=d();f(R,I),C.append(R,E,T,G),document.body.appendChild(C)}i?(E.innerText="Preview backend disconnected.",R.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(R.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",x):x()}function Un(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function L5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Un())}function B5(){const t=Xm()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function V5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function U5(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function z5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function H5(){const t=Un();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function G5(){return!B5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function q5(){try{return typeof indexedDB=="object"}catch{return!1}}function W5(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(r){e(r)}})}const X5="FirebaseError";class Li extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=X5,Object.setPrototypeOf(this,Li.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,M0.prototype.create)}}class M0{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,i=this.errors[e],o=i?Y5(i,n):"Error",u=`${this.serviceName}: ${o} (${a}).`;return new Li(a,u,n)}}function Y5(t,e){return t.replace($5,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const $5=/\{\$([^}]+)}/g;function K5(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ho(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const i=t[a],o=e[a];if(Vb(i)&&Vb(o)){if(!Ho(i,o))return!1}else if(i!==o)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function Vb(t){return t!==null&&typeof t=="object"}function P0(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(a=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Q5(t,e){const r=new J5(t,e);return r.subscribe.bind(r)}class J5{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let a;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Z5(e,["next","error","complete"])?a=e:a={next:e,error:r,complete:n},a.next===void 0&&(a.next=O1),a.error===void 0&&(a.error=O1),a.complete===void 0&&(a.complete=O1);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Z5(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function O1(){}function cn(t){return t&&t._delegate?t._delegate:t}class Go{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Do="[DEFAULT]";class eI{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new F5;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(rI(e))try{this.getOrInitializeService({instanceIdentifier:Do})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:a});n.resolve(i)}catch{}}}}clearInstance(e=Do){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Do){return this.instances.has(e)}getOptions(e=Do){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(i);n===u&&o.resolve(a)}return a}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const i=this.instances.get(n);return i&&e(i,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:tI(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Do){return this.component?this.component.multipleInstances?e:Do:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function tI(t){return t===Do?void 0:t}function rI(t){return t.instantiationMode==="EAGER"}class nI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new eI(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var Rt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Rt||(Rt={}));const aI={debug:Rt.DEBUG,verbose:Rt.VERBOSE,info:Rt.INFO,warn:Rt.WARN,error:Rt.ERROR,silent:Rt.SILENT},sI=Rt.INFO,iI={[Rt.DEBUG]:"log",[Rt.VERBOSE]:"log",[Rt.INFO]:"info",[Rt.WARN]:"warn",[Rt.ERROR]:"error"},lI=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=iI[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class dv{constructor(e){this.name=e,this._logLevel=sI,this._logHandler=lI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Rt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?aI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Rt.DEBUG,...e),this._logHandler(this,Rt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Rt.VERBOSE,...e),this._logHandler(this,Rt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Rt.INFO,...e),this._logHandler(this,Rt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Rt.WARN,...e),this._logHandler(this,Rt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Rt.ERROR,...e),this._logHandler(this,Rt.ERROR,...e)}}const oI=(t,e)=>e.some(r=>t instanceof r);let Ub,zb;function cI(){return Ub||(Ub=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function uI(){return zb||(zb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const i4=new WeakMap,dx=new WeakMap,l4=new WeakMap,F1=new WeakMap,mv=new WeakMap;function fI(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(Rl(t.result)),a()},o=()=>{n(t.error),a()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&i4.set(r,t)}).catch(()=>{}),mv.set(e,t),e}function hI(t){if(dx.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),a()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});dx.set(t,e)}let mx={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return dx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||l4.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Rl(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function dI(t){mx=t(mx)}function mI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(M1(this),e,...r);return l4.set(n,e.sort?e.sort():[e]),Rl(n)}:uI().includes(t)?function(...e){return t.apply(M1(this),e),Rl(i4.get(this))}:function(...e){return Rl(t.apply(M1(this),e))}}function pI(t){return typeof t=="function"?mI(t):(t instanceof IDBTransaction&&hI(t),oI(t,cI())?new Proxy(t,mx):t)}function Rl(t){if(t instanceof IDBRequest)return fI(t);if(F1.has(t))return F1.get(t);const e=pI(t);return e!==t&&(F1.set(t,e),mv.set(e,t)),e}const M1=t=>mv.get(t);function gI(t,e,{blocked:r,upgrade:n,blocking:a,terminated:i}={}){const o=indexedDB.open(t,e),u=Rl(o);return n&&o.addEventListener("upgradeneeded",f=>{n(Rl(o.result),f.oldVersion,f.newVersion,Rl(o.transaction),f)}),r&&o.addEventListener("blocked",f=>r(f.oldVersion,f.newVersion,f)),u.then(f=>{i&&f.addEventListener("close",()=>i()),a&&f.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const xI=["get","getKey","getAll","getAllKeys","count"],vI=["put","add","delete","clear"],P1=new Map;function Hb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(P1.get(e))return P1.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=vI.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||xI.includes(r)))return;const i=async function(o,...u){const f=this.transaction(o,a?"readwrite":"readonly");let d=f.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),a&&f.done]))[0]};return P1.set(e,i),i}dI(t=>({...t,get:(e,r,n)=>Hb(e,r)||t.get(e,r,n),has:(e,r)=>!!Hb(e,r)||t.has(e,r)}));class yI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(_I(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function _I(t){return t.getComponent()?.type==="VERSION"}const px="@firebase/app",Gb="0.14.6";const Ii=new dv("@firebase/app"),wI="@firebase/app-compat",bI="@firebase/analytics-compat",EI="@firebase/analytics",TI="@firebase/app-check-compat",SI="@firebase/app-check",AI="@firebase/auth",kI="@firebase/auth-compat",CI="@firebase/database",NI="@firebase/data-connect",RI="@firebase/database-compat",II="@firebase/functions",DI="@firebase/functions-compat",OI="@firebase/installations",FI="@firebase/installations-compat",MI="@firebase/messaging",PI="@firebase/messaging-compat",jI="@firebase/performance",LI="@firebase/performance-compat",BI="@firebase/remote-config",VI="@firebase/remote-config-compat",UI="@firebase/storage",zI="@firebase/storage-compat",HI="@firebase/firestore",GI="@firebase/ai",qI="@firebase/firestore-compat",WI="firebase",XI="12.6.0";const gx="[DEFAULT]",YI={[px]:"fire-core",[wI]:"fire-core-compat",[EI]:"fire-analytics",[bI]:"fire-analytics-compat",[SI]:"fire-app-check",[TI]:"fire-app-check-compat",[AI]:"fire-auth",[kI]:"fire-auth-compat",[CI]:"fire-rtdb",[NI]:"fire-data-connect",[RI]:"fire-rtdb-compat",[II]:"fire-fn",[DI]:"fire-fn-compat",[OI]:"fire-iid",[FI]:"fire-iid-compat",[MI]:"fire-fcm",[PI]:"fire-fcm-compat",[jI]:"fire-perf",[LI]:"fire-perf-compat",[BI]:"fire-rc",[VI]:"fire-rc-compat",[UI]:"fire-gcs",[zI]:"fire-gcs-compat",[HI]:"fire-fst",[qI]:"fire-fst-compat",[GI]:"fire-vertex","fire-js":"fire-js",[WI]:"fire-js-all"};const cm=new Map,$I=new Map,xx=new Map;function qb(t,e){try{t.container.addComponent(e)}catch(r){Ii.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function mu(t){const e=t.name;if(xx.has(e))return Ii.debug(`There were multiple attempts to register component ${e}.`),!1;xx.set(e,t);for(const r of cm.values())qb(r,t);for(const r of $I.values())qb(r,t);return!0}function pv(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function xs(t){return t==null?!1:t.settings!==void 0}const KI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Il=new M0("app","Firebase",KI);class QI{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Go("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Il.create("app-deleted",{appName:this._name})}}const Nu=XI;function o4(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:gx,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw Il.create("bad-app-name",{appName:String(a)});if(r||(r=r4()),!r)throw Il.create("no-options");const i=cm.get(a);if(i){if(Ho(r,i.options)&&Ho(n,i.config))return i;throw Il.create("duplicate-app",{appName:a})}const o=new nI(a);for(const f of xx.values())o.addComponent(f);const u=new QI(r,n,o);return cm.set(a,u),u}function c4(t=gx){const e=cm.get(t);if(!e&&t===gx&&r4())return o4();if(!e)throw Il.create("no-app",{appName:t});return e}function Dl(t,e,r){let n=YI[t]??t;r&&(n+=`-${r}`);const a=n.match(/\s|\//),i=e.match(/\s|\//);if(a||i){const o=[`Unable to register library "${n}" with version "${e}":`];a&&o.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ii.warn(o.join(" "));return}mu(new Go(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const JI="firebase-heartbeat-database",ZI=1,c0="firebase-heartbeat-store";let j1=null;function u4(){return j1||(j1=gI(JI,ZI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(c0)}catch(r){console.warn(r)}}}}).catch(t=>{throw Il.create("idb-open",{originalErrorMessage:t.message})})),j1}async function eD(t){try{const r=(await u4()).transaction(c0),n=await r.objectStore(c0).get(f4(t));return await r.done,n}catch(e){if(e instanceof Li)Ii.warn(e.message);else{const r=Il.create("idb-get",{originalErrorMessage:e?.message});Ii.warn(r.message)}}}async function Wb(t,e){try{const n=(await u4()).transaction(c0,"readwrite");await n.objectStore(c0).put(e,f4(t)),await n.done}catch(r){if(r instanceof Li)Ii.warn(r.message);else{const n=Il.create("idb-set",{originalErrorMessage:r?.message});Ii.warn(n.message)}}}function f4(t){return`${t.name}!${t.options.appId}`}const tD=1024,rD=30;class nD{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new sD(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Xb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(a=>a.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>rD){const a=iD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Ii.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Xb(),{heartbeatsToSend:r,unsentEntries:n}=aD(this._heartbeatsCache.heartbeats),a=om(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return Ii.warn(e),""}}}function Xb(){return new Date().toISOString().substring(0,10)}function aD(t,e=tD){const r=[];let n=t.slice();for(const a of t){const i=r.find(o=>o.agent===a.agent);if(i){if(i.dates.push(a.date),Yb(r)>e){i.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),Yb(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class sD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return q5()?W5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await eD(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Wb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Wb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Yb(t){return om(JSON.stringify({version:2,heartbeats:t})).length}function iD(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}function lD(t){mu(new Go("platform-logger",e=>new yI(e),"PRIVATE")),mu(new Go("heartbeat",e=>new nD(e),"PRIVATE")),Dl(px,Gb,t),Dl(px,Gb,"esm2020"),Dl("fire-js","")}lD("");var $b=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ol,h4;(function(){var t;function e(A,D){function N(){}N.prototype=D.prototype,A.F=D.prototype,A.prototype=new N,A.prototype.constructor=A,A.D=function(M,F,j){for(var P=Array(arguments.length-2),be=2;be<arguments.length;be++)P[be-2]=arguments[be];return D.prototype[F].apply(M,P)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(n,r),n.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(A,D,N){N||(N=0);const M=Array(16);if(typeof D=="string")for(var F=0;F<16;++F)M[F]=D.charCodeAt(N++)|D.charCodeAt(N++)<<8|D.charCodeAt(N++)<<16|D.charCodeAt(N++)<<24;else for(F=0;F<16;++F)M[F]=D[N++]|D[N++]<<8|D[N++]<<16|D[N++]<<24;D=A.g[0],N=A.g[1],F=A.g[2];let j=A.g[3],P;P=D+(j^N&(F^j))+M[0]+3614090360&4294967295,D=N+(P<<7&4294967295|P>>>25),P=j+(F^D&(N^F))+M[1]+3905402710&4294967295,j=D+(P<<12&4294967295|P>>>20),P=F+(N^j&(D^N))+M[2]+606105819&4294967295,F=j+(P<<17&4294967295|P>>>15),P=N+(D^F&(j^D))+M[3]+3250441966&4294967295,N=F+(P<<22&4294967295|P>>>10),P=D+(j^N&(F^j))+M[4]+4118548399&4294967295,D=N+(P<<7&4294967295|P>>>25),P=j+(F^D&(N^F))+M[5]+1200080426&4294967295,j=D+(P<<12&4294967295|P>>>20),P=F+(N^j&(D^N))+M[6]+2821735955&4294967295,F=j+(P<<17&4294967295|P>>>15),P=N+(D^F&(j^D))+M[7]+4249261313&4294967295,N=F+(P<<22&4294967295|P>>>10),P=D+(j^N&(F^j))+M[8]+1770035416&4294967295,D=N+(P<<7&4294967295|P>>>25),P=j+(F^D&(N^F))+M[9]+2336552879&4294967295,j=D+(P<<12&4294967295|P>>>20),P=F+(N^j&(D^N))+M[10]+4294925233&4294967295,F=j+(P<<17&4294967295|P>>>15),P=N+(D^F&(j^D))+M[11]+2304563134&4294967295,N=F+(P<<22&4294967295|P>>>10),P=D+(j^N&(F^j))+M[12]+1804603682&4294967295,D=N+(P<<7&4294967295|P>>>25),P=j+(F^D&(N^F))+M[13]+4254626195&4294967295,j=D+(P<<12&4294967295|P>>>20),P=F+(N^j&(D^N))+M[14]+2792965006&4294967295,F=j+(P<<17&4294967295|P>>>15),P=N+(D^F&(j^D))+M[15]+1236535329&4294967295,N=F+(P<<22&4294967295|P>>>10),P=D+(F^j&(N^F))+M[1]+4129170786&4294967295,D=N+(P<<5&4294967295|P>>>27),P=j+(N^F&(D^N))+M[6]+3225465664&4294967295,j=D+(P<<9&4294967295|P>>>23),P=F+(D^N&(j^D))+M[11]+643717713&4294967295,F=j+(P<<14&4294967295|P>>>18),P=N+(j^D&(F^j))+M[0]+3921069994&4294967295,N=F+(P<<20&4294967295|P>>>12),P=D+(F^j&(N^F))+M[5]+3593408605&4294967295,D=N+(P<<5&4294967295|P>>>27),P=j+(N^F&(D^N))+M[10]+38016083&4294967295,j=D+(P<<9&4294967295|P>>>23),P=F+(D^N&(j^D))+M[15]+3634488961&4294967295,F=j+(P<<14&4294967295|P>>>18),P=N+(j^D&(F^j))+M[4]+3889429448&4294967295,N=F+(P<<20&4294967295|P>>>12),P=D+(F^j&(N^F))+M[9]+568446438&4294967295,D=N+(P<<5&4294967295|P>>>27),P=j+(N^F&(D^N))+M[14]+3275163606&4294967295,j=D+(P<<9&4294967295|P>>>23),P=F+(D^N&(j^D))+M[3]+4107603335&4294967295,F=j+(P<<14&4294967295|P>>>18),P=N+(j^D&(F^j))+M[8]+1163531501&4294967295,N=F+(P<<20&4294967295|P>>>12),P=D+(F^j&(N^F))+M[13]+2850285829&4294967295,D=N+(P<<5&4294967295|P>>>27),P=j+(N^F&(D^N))+M[2]+4243563512&4294967295,j=D+(P<<9&4294967295|P>>>23),P=F+(D^N&(j^D))+M[7]+1735328473&4294967295,F=j+(P<<14&4294967295|P>>>18),P=N+(j^D&(F^j))+M[12]+2368359562&4294967295,N=F+(P<<20&4294967295|P>>>12),P=D+(N^F^j)+M[5]+4294588738&4294967295,D=N+(P<<4&4294967295|P>>>28),P=j+(D^N^F)+M[8]+2272392833&4294967295,j=D+(P<<11&4294967295|P>>>21),P=F+(j^D^N)+M[11]+1839030562&4294967295,F=j+(P<<16&4294967295|P>>>16),P=N+(F^j^D)+M[14]+4259657740&4294967295,N=F+(P<<23&4294967295|P>>>9),P=D+(N^F^j)+M[1]+2763975236&4294967295,D=N+(P<<4&4294967295|P>>>28),P=j+(D^N^F)+M[4]+1272893353&4294967295,j=D+(P<<11&4294967295|P>>>21),P=F+(j^D^N)+M[7]+4139469664&4294967295,F=j+(P<<16&4294967295|P>>>16),P=N+(F^j^D)+M[10]+3200236656&4294967295,N=F+(P<<23&4294967295|P>>>9),P=D+(N^F^j)+M[13]+681279174&4294967295,D=N+(P<<4&4294967295|P>>>28),P=j+(D^N^F)+M[0]+3936430074&4294967295,j=D+(P<<11&4294967295|P>>>21),P=F+(j^D^N)+M[3]+3572445317&4294967295,F=j+(P<<16&4294967295|P>>>16),P=N+(F^j^D)+M[6]+76029189&4294967295,N=F+(P<<23&4294967295|P>>>9),P=D+(N^F^j)+M[9]+3654602809&4294967295,D=N+(P<<4&4294967295|P>>>28),P=j+(D^N^F)+M[12]+3873151461&4294967295,j=D+(P<<11&4294967295|P>>>21),P=F+(j^D^N)+M[15]+530742520&4294967295,F=j+(P<<16&4294967295|P>>>16),P=N+(F^j^D)+M[2]+3299628645&4294967295,N=F+(P<<23&4294967295|P>>>9),P=D+(F^(N|~j))+M[0]+4096336452&4294967295,D=N+(P<<6&4294967295|P>>>26),P=j+(N^(D|~F))+M[7]+1126891415&4294967295,j=D+(P<<10&4294967295|P>>>22),P=F+(D^(j|~N))+M[14]+2878612391&4294967295,F=j+(P<<15&4294967295|P>>>17),P=N+(j^(F|~D))+M[5]+4237533241&4294967295,N=F+(P<<21&4294967295|P>>>11),P=D+(F^(N|~j))+M[12]+1700485571&4294967295,D=N+(P<<6&4294967295|P>>>26),P=j+(N^(D|~F))+M[3]+2399980690&4294967295,j=D+(P<<10&4294967295|P>>>22),P=F+(D^(j|~N))+M[10]+4293915773&4294967295,F=j+(P<<15&4294967295|P>>>17),P=N+(j^(F|~D))+M[1]+2240044497&4294967295,N=F+(P<<21&4294967295|P>>>11),P=D+(F^(N|~j))+M[8]+1873313359&4294967295,D=N+(P<<6&4294967295|P>>>26),P=j+(N^(D|~F))+M[15]+4264355552&4294967295,j=D+(P<<10&4294967295|P>>>22),P=F+(D^(j|~N))+M[6]+2734768916&4294967295,F=j+(P<<15&4294967295|P>>>17),P=N+(j^(F|~D))+M[13]+1309151649&4294967295,N=F+(P<<21&4294967295|P>>>11),P=D+(F^(N|~j))+M[4]+4149444226&4294967295,D=N+(P<<6&4294967295|P>>>26),P=j+(N^(D|~F))+M[11]+3174756917&4294967295,j=D+(P<<10&4294967295|P>>>22),P=F+(D^(j|~N))+M[2]+718787259&4294967295,F=j+(P<<15&4294967295|P>>>17),P=N+(j^(F|~D))+M[9]+3951481745&4294967295,A.g[0]=A.g[0]+D&4294967295,A.g[1]=A.g[1]+(F+(P<<21&4294967295|P>>>11))&4294967295,A.g[2]=A.g[2]+F&4294967295,A.g[3]=A.g[3]+j&4294967295}n.prototype.v=function(A,D){D===void 0&&(D=A.length);const N=D-this.blockSize,M=this.C;let F=this.h,j=0;for(;j<D;){if(F==0)for(;j<=N;)a(this,A,j),j+=this.blockSize;if(typeof A=="string"){for(;j<D;)if(M[F++]=A.charCodeAt(j++),F==this.blockSize){a(this,M),F=0;break}}else for(;j<D;)if(M[F++]=A[j++],F==this.blockSize){a(this,M),F=0;break}}this.h=F,this.o+=D},n.prototype.A=function(){var A=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);A[0]=128;for(var D=1;D<A.length-8;++D)A[D]=0;D=this.o*8;for(var N=A.length-8;N<A.length;++N)A[N]=D&255,D/=256;for(this.v(A),A=Array(16),D=0,N=0;N<4;++N)for(let M=0;M<32;M+=8)A[D++]=this.g[N]>>>M&255;return A};function i(A,D){var N=u;return Object.prototype.hasOwnProperty.call(N,A)?N[A]:N[A]=D(A)}function o(A,D){this.h=D;const N=[];let M=!0;for(let F=A.length-1;F>=0;F--){const j=A[F]|0;M&&j==D||(N[F]=j,M=!1)}this.g=N}var u={};function f(A){return-128<=A&&A<128?i(A,function(D){return new o([D|0],D<0?-1:0)}):new o([A|0],A<0?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return x;if(A<0)return T(d(-A));const D=[];let N=1;for(let M=0;A>=N;M++)D[M]=A/N|0,N*=4294967296;return new o(D,0)}function m(A,D){if(A.length==0)throw Error("number format error: empty string");if(D=D||10,D<2||36<D)throw Error("radix out of range: "+D);if(A.charAt(0)=="-")return T(m(A.substring(1),D));if(A.indexOf("-")>=0)throw Error('number format error: interior "-" character');const N=d(Math.pow(D,8));let M=x;for(let j=0;j<A.length;j+=8){var F=Math.min(8,A.length-j);const P=parseInt(A.substring(j,j+F),D);F<8?(F=d(Math.pow(D,F)),M=M.j(F).add(d(P))):(M=M.j(N),M=M.add(d(P)))}return M}var x=f(0),y=f(1),w=f(16777216);t=o.prototype,t.m=function(){if(b(this))return-T(this).m();let A=0,D=1;for(let N=0;N<this.g.length;N++){const M=this.i(N);A+=(M>=0?M:4294967296+M)*D,D*=4294967296}return A},t.toString=function(A){if(A=A||10,A<2||36<A)throw Error("radix out of range: "+A);if(E(this))return"0";if(b(this))return"-"+T(this).toString(A);const D=d(Math.pow(A,6));var N=this;let M="";for(;;){const F=G(N,D).g;N=I(N,F.j(D));let j=((N.g.length>0?N.g[0]:N.h)>>>0).toString(A);if(N=F,E(N))return j+M;for(;j.length<6;)j="0"+j;M=j+M}},t.i=function(A){return A<0?0:A<this.g.length?this.g[A]:this.h};function E(A){if(A.h!=0)return!1;for(let D=0;D<A.g.length;D++)if(A.g[D]!=0)return!1;return!0}function b(A){return A.h==-1}t.l=function(A){return A=I(this,A),b(A)?-1:E(A)?0:1};function T(A){const D=A.g.length,N=[];for(let M=0;M<D;M++)N[M]=~A.g[M];return new o(N,~A.h).add(y)}t.abs=function(){return b(this)?T(this):this},t.add=function(A){const D=Math.max(this.g.length,A.g.length),N=[];let M=0;for(let F=0;F<=D;F++){let j=M+(this.i(F)&65535)+(A.i(F)&65535),P=(j>>>16)+(this.i(F)>>>16)+(A.i(F)>>>16);M=P>>>16,j&=65535,P&=65535,N[F]=P<<16|j}return new o(N,N[N.length-1]&-2147483648?-1:0)};function I(A,D){return A.add(T(D))}t.j=function(A){if(E(this)||E(A))return x;if(b(this))return b(A)?T(this).j(T(A)):T(T(this).j(A));if(b(A))return T(this.j(T(A)));if(this.l(w)<0&&A.l(w)<0)return d(this.m()*A.m());const D=this.g.length+A.g.length,N=[];for(var M=0;M<2*D;M++)N[M]=0;for(M=0;M<this.g.length;M++)for(let F=0;F<A.g.length;F++){const j=this.i(M)>>>16,P=this.i(M)&65535,be=A.i(F)>>>16,ye=A.i(F)&65535;N[2*M+2*F]+=P*ye,R(N,2*M+2*F),N[2*M+2*F+1]+=j*ye,R(N,2*M+2*F+1),N[2*M+2*F+1]+=P*be,R(N,2*M+2*F+1),N[2*M+2*F+2]+=j*be,R(N,2*M+2*F+2)}for(A=0;A<D;A++)N[A]=N[2*A+1]<<16|N[2*A];for(A=D;A<2*D;A++)N[A]=0;return new o(N,0)};function R(A,D){for(;(A[D]&65535)!=A[D];)A[D+1]+=A[D]>>>16,A[D]&=65535,D++}function C(A,D){this.g=A,this.h=D}function G(A,D){if(E(D))throw Error("division by zero");if(E(A))return new C(x,x);if(b(A))return D=G(T(A),D),new C(T(D.g),T(D.h));if(b(D))return D=G(A,T(D)),new C(T(D.g),D.h);if(A.g.length>30){if(b(A)||b(D))throw Error("slowDivide_ only works with positive integers.");for(var N=y,M=D;M.l(A)<=0;)N=V(N),M=V(M);var F=H(N,1),j=H(M,1);for(M=H(M,2),N=H(N,2);!E(M);){var P=j.add(M);P.l(A)<=0&&(F=F.add(N),j=P),M=H(M,1),N=H(N,1)}return D=I(A,F.j(D)),new C(F,D)}for(F=x;A.l(D)>=0;){for(N=Math.max(1,Math.floor(A.m()/D.m())),M=Math.ceil(Math.log(N)/Math.LN2),M=M<=48?1:Math.pow(2,M-48),j=d(N),P=j.j(D);b(P)||P.l(A)>0;)N-=M,j=d(N),P=j.j(D);E(j)&&(j=y),F=F.add(j),A=I(A,P)}return new C(F,A)}t.B=function(A){return G(this,A).h},t.and=function(A){const D=Math.max(this.g.length,A.g.length),N=[];for(let M=0;M<D;M++)N[M]=this.i(M)&A.i(M);return new o(N,this.h&A.h)},t.or=function(A){const D=Math.max(this.g.length,A.g.length),N=[];for(let M=0;M<D;M++)N[M]=this.i(M)|A.i(M);return new o(N,this.h|A.h)},t.xor=function(A){const D=Math.max(this.g.length,A.g.length),N=[];for(let M=0;M<D;M++)N[M]=this.i(M)^A.i(M);return new o(N,this.h^A.h)};function V(A){const D=A.g.length+1,N=[];for(let M=0;M<D;M++)N[M]=A.i(M)<<1|A.i(M-1)>>>31;return new o(N,A.h)}function H(A,D){const N=D>>5;D%=32;const M=A.g.length-N,F=[];for(let j=0;j<M;j++)F[j]=D>0?A.i(j+N)>>>D|A.i(j+N+1)<<32-D:A.i(j+N);return new o(F,A.h)}n.prototype.digest=n.prototype.A,n.prototype.reset=n.prototype.u,n.prototype.update=n.prototype.v,h4=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=m,Ol=o}).apply(typeof $b<"u"?$b:typeof self<"u"?self:typeof window<"u"?window:{});var kd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var d4,Uf,m4,Kd,vx,p4,g4,x4;(function(){var t,e=Object.defineProperty;function r(g){g=[typeof globalThis=="object"&&globalThis,g,typeof window=="object"&&window,typeof self=="object"&&self,typeof kd=="object"&&kd];for(var S=0;S<g.length;++S){var O=g[S];if(O&&O.Math==Math)return O}throw Error("Cannot find global object")}var n=r(this);function a(g,S){if(S)e:{var O=n;g=g.split(".");for(var W=0;W<g.length-1;W++){var fe=g[W];if(!(fe in O))break e;O=O[fe]}g=g[g.length-1],W=O[g],S=S(W),S!=W&&S!=null&&e(O,g,{configurable:!0,writable:!0,value:S})}}a("Symbol.dispose",function(g){return g||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(g){return g||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(g){return g||function(S){var O=[],W;for(W in S)Object.prototype.hasOwnProperty.call(S,W)&&O.push([W,S[W]]);return O}});var i=i||{},o=this||self;function u(g){var S=typeof g;return S=="object"&&g!=null||S=="function"}function f(g,S,O){return g.call.apply(g.bind,arguments)}function d(g,S,O){return d=f,d.apply(null,arguments)}function m(g,S){var O=Array.prototype.slice.call(arguments,1);return function(){var W=O.slice();return W.push.apply(W,arguments),g.apply(this,W)}}function x(g,S){function O(){}O.prototype=S.prototype,g.Z=S.prototype,g.prototype=new O,g.prototype.constructor=g,g.Ob=function(W,fe,we){for(var He=Array(arguments.length-2),xt=2;xt<arguments.length;xt++)He[xt-2]=arguments[xt];return S.prototype[fe].apply(W,He)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?g=>g&&AsyncContext.Snapshot.wrap(g):g=>g;function w(g){const S=g.length;if(S>0){const O=Array(S);for(let W=0;W<S;W++)O[W]=g[W];return O}return[]}function E(g,S){for(let W=1;W<arguments.length;W++){const fe=arguments[W];var O=typeof fe;if(O=O!="object"?O:fe?Array.isArray(fe)?"array":O:"null",O=="array"||O=="object"&&typeof fe.length=="number"){O=g.length||0;const we=fe.length||0;g.length=O+we;for(let He=0;He<we;He++)g[O+He]=fe[He]}else g.push(fe)}}class b{constructor(S,O){this.i=S,this.j=O,this.h=0,this.g=null}get(){let S;return this.h>0?(this.h--,S=this.g,this.g=S.next,S.next=null):S=this.i(),S}}function T(g){o.setTimeout(()=>{throw g},0)}function I(){var g=A;let S=null;return g.g&&(S=g.g,g.g=g.g.next,g.g||(g.h=null),S.next=null),S}class R{constructor(){this.h=this.g=null}add(S,O){const W=C.get();W.set(S,O),this.h?this.h.next=W:this.g=W,this.h=W}}var C=new b(()=>new G,g=>g.reset());class G{constructor(){this.next=this.g=this.h=null}set(S,O){this.h=S,this.g=O,this.next=null}reset(){this.next=this.g=this.h=null}}let V,H=!1,A=new R,D=()=>{const g=Promise.resolve(void 0);V=()=>{g.then(N)}};function N(){for(var g;g=I();){try{g.h.call(g.g)}catch(O){T(O)}var S=C;S.j(g),S.h<100&&(S.h++,g.next=S.g,S.g=g)}H=!1}function M(){this.u=this.u,this.C=this.C}M.prototype.u=!1,M.prototype.dispose=function(){this.u||(this.u=!0,this.N())},M.prototype[Symbol.dispose]=function(){this.dispose()},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(g,S){this.type=g,this.g=this.target=S,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var g=!1,S=Object.defineProperty({},"passive",{get:function(){g=!0}});try{const O=()=>{};o.addEventListener("test",O,S),o.removeEventListener("test",O,S)}catch{}return g})();function P(g){return/^[\s\xa0]*$/.test(g)}function be(g,S){F.call(this,g?g.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,g&&this.init(g,S)}x(be,F),be.prototype.init=function(g,S){const O=this.type=g.type,W=g.changedTouches&&g.changedTouches.length?g.changedTouches[0]:null;this.target=g.target||g.srcElement,this.g=S,S=g.relatedTarget,S||(O=="mouseover"?S=g.fromElement:O=="mouseout"&&(S=g.toElement)),this.relatedTarget=S,W?(this.clientX=W.clientX!==void 0?W.clientX:W.pageX,this.clientY=W.clientY!==void 0?W.clientY:W.pageY,this.screenX=W.screenX||0,this.screenY=W.screenY||0):(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0),this.button=g.button,this.key=g.key||"",this.ctrlKey=g.ctrlKey,this.altKey=g.altKey,this.shiftKey=g.shiftKey,this.metaKey=g.metaKey,this.pointerId=g.pointerId||0,this.pointerType=g.pointerType,this.state=g.state,this.i=g,g.defaultPrevented&&be.Z.h.call(this)},be.prototype.h=function(){be.Z.h.call(this);const g=this.i;g.preventDefault?g.preventDefault():g.returnValue=!1};var ye="closure_listenable_"+(Math.random()*1e6|0),se=0;function ce(g,S,O,W,fe){this.listener=g,this.proxy=null,this.src=S,this.type=O,this.capture=!!W,this.ha=fe,this.key=++se,this.da=this.fa=!1}function le(g){g.da=!0,g.listener=null,g.proxy=null,g.src=null,g.ha=null}function te(g,S,O){for(const W in g)S.call(O,g[W],W,g)}function _e(g,S){for(const O in g)S.call(void 0,g[O],O,g)}function Q(g){const S={};for(const O in g)S[O]=g[O];return S}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(g,S){let O,W;for(let fe=1;fe<arguments.length;fe++){W=arguments[fe];for(O in W)g[O]=W[O];for(let we=0;we<L.length;we++)O=L[we],Object.prototype.hasOwnProperty.call(W,O)&&(g[O]=W[O])}}function Y(g){this.src=g,this.g={},this.h=0}Y.prototype.add=function(g,S,O,W,fe){const we=g.toString();g=this.g[we],g||(g=this.g[we]=[],this.h++);const He=ue(g,S,W,fe);return He>-1?(S=g[He],O||(S.fa=!1)):(S=new ce(S,this.src,we,!!W,fe),S.fa=O,g.push(S)),S};function ne(g,S){const O=S.type;if(O in g.g){var W=g.g[O],fe=Array.prototype.indexOf.call(W,S,void 0),we;(we=fe>=0)&&Array.prototype.splice.call(W,fe,1),we&&(le(S),g.g[O].length==0&&(delete g.g[O],g.h--))}}function ue(g,S,O,W){for(let fe=0;fe<g.length;++fe){const we=g[fe];if(!we.da&&we.listener==S&&we.capture==!!O&&we.ha==W)return fe}return-1}var Te="closure_lm_"+(Math.random()*1e6|0),Re={};function Ae(g,S,O,W,fe){if(Array.isArray(S)){for(let we=0;we<S.length;we++)Ae(g,S[we],O,W,fe);return null}return O=ht(O),g&&g[ye]?g.J(S,O,u(W)?!!W.capture:!1,fe):Fe(g,S,O,!1,W,fe)}function Fe(g,S,O,W,fe,we){if(!S)throw Error("Invalid event type");const He=u(fe)?!!fe.capture:!!fe;let xt=We(g);if(xt||(g[Te]=xt=new Y(g)),O=xt.add(S,O,W,He,we),O.proxy)return O;if(W=st(),O.proxy=W,W.src=g,W.listener=O,g.addEventListener)j||(fe=He),fe===void 0&&(fe=!1),g.addEventListener(S.toString(),W,fe);else if(g.attachEvent)g.attachEvent(Pe(S.toString()),W);else if(g.addListener&&g.removeListener)g.addListener(W);else throw Error("addEventListener and attachEvent are unavailable.");return O}function st(){function g(O){return S.call(g.src,g.listener,O)}const S=et;return g}function B(g,S,O,W,fe){if(Array.isArray(S))for(var we=0;we<S.length;we++)B(g,S[we],O,W,fe);else W=u(W)?!!W.capture:!!W,O=ht(O),g&&g[ye]?(g=g.i,we=String(S).toString(),we in g.g&&(S=g.g[we],O=ue(S,O,W,fe),O>-1&&(le(S[O]),Array.prototype.splice.call(S,O,1),S.length==0&&(delete g.g[we],g.h--)))):g&&(g=We(g))&&(S=g.g[S.toString()],g=-1,S&&(g=ue(S,O,W,fe)),(O=g>-1?S[g]:null)&&Xe(O))}function Xe(g){if(typeof g!="number"&&g&&!g.da){var S=g.src;if(S&&S[ye])ne(S.i,g);else{var O=g.type,W=g.proxy;S.removeEventListener?S.removeEventListener(O,W,g.capture):S.detachEvent?S.detachEvent(Pe(O),W):S.addListener&&S.removeListener&&S.removeListener(W),(O=We(S))?(ne(O,g),O.h==0&&(O.src=null,S[Te]=null)):le(g)}}}function Pe(g){return g in Re?Re[g]:Re[g]="on"+g}function et(g,S){if(g.da)g=!0;else{S=new be(S,this);const O=g.listener,W=g.ha||g.src;g.fa&&Xe(g),g=O.call(W,S)}return g}function We(g){return g=g[Te],g instanceof Y?g:null}var je="__closure_events_fn_"+(Math.random()*1e9>>>0);function ht(g){return typeof g=="function"?g:(g[je]||(g[je]=function(S){return g.handleEvent(S)}),g[je])}function _t(){M.call(this),this.i=new Y(this),this.M=this,this.G=null}x(_t,M),_t.prototype[ye]=!0,_t.prototype.removeEventListener=function(g,S,O,W){B(this,g,S,O,W)};function Ft(g,S){var O,W=g.G;if(W)for(O=[];W;W=W.G)O.push(W);if(g=g.M,W=S.type||S,typeof S=="string")S=new F(S,g);else if(S instanceof F)S.target=S.target||g;else{var fe=S;S=new F(W,g),J(S,fe)}fe=!0;let we,He;if(O)for(He=O.length-1;He>=0;He--)we=S.g=O[He],fe=Hr(we,W,!0,S)&&fe;if(we=S.g=g,fe=Hr(we,W,!0,S)&&fe,fe=Hr(we,W,!1,S)&&fe,O)for(He=0;He<O.length;He++)we=S.g=O[He],fe=Hr(we,W,!1,S)&&fe}_t.prototype.N=function(){if(_t.Z.N.call(this),this.i){var g=this.i;for(const S in g.g){const O=g.g[S];for(let W=0;W<O.length;W++)le(O[W]);delete g.g[S],g.h--}}this.G=null},_t.prototype.J=function(g,S,O,W){return this.i.add(String(g),S,!1,O,W)},_t.prototype.K=function(g,S,O,W){return this.i.add(String(g),S,!0,O,W)};function Hr(g,S,O,W){if(S=g.i.g[String(S)],!S)return!0;S=S.concat();let fe=!0;for(let we=0;we<S.length;++we){const He=S[we];if(He&&!He.da&&He.capture==O){const xt=He.listener,Fr=He.ha||He.src;He.fa&&ne(g.i,He),fe=xt.call(Fr,W)!==!1&&fe}}return fe&&!W.defaultPrevented}function ns(g,S){if(typeof g!="function")if(g&&typeof g.handleEvent=="function")g=d(g.handleEvent,g);else throw Error("Invalid listener argument");return Number(S)>2147483647?-1:o.setTimeout(g,S||0)}function Gn(g){g.g=ns(()=>{g.g=null,g.i&&(g.i=!1,Gn(g))},g.l);const S=g.h;g.h=null,g.m.apply(null,S)}class zt extends M{constructor(S,O){super(),this.m=S,this.l=O,this.h=null,this.i=!1,this.g=null}j(S){this.h=arguments,this.g?this.i=!0:Gn(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gr(g){M.call(this),this.h=g,this.g={}}x(Gr,M);var nn=[];function qn(g){te(g.g,function(S,O){this.g.hasOwnProperty(O)&&Xe(S)},g),g.g={}}Gr.prototype.N=function(){Gr.Z.N.call(this),qn(this)},Gr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xt=o.JSON.stringify,Or=o.JSON.parse,dt=class{stringify(g){return o.JSON.stringify(g,void 0)}parse(g){return o.JSON.parse(g,void 0)}};function rr(){}function an(){}var Mt={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function or(){F.call(this,"d")}x(or,F);function qr(){F.call(this,"c")}x(qr,F);var dr={},uc=null;function Js(){return uc=uc||new _t}dr.Ia="serverreachability";function so(g){F.call(this,dr.Ia,g)}x(so,F);function da(g){const S=Js();Ft(S,new so(S))}dr.STAT_EVENT="statevent";function Zs(g,S){F.call(this,dr.STAT_EVENT,g),this.stat=S}x(Zs,F);function kr(g){const S=Js();Ft(S,new Zs(S,g))}dr.Ja="timingevent";function Wn(g,S){F.call(this,dr.Ja,g),this.size=S}x(Wn,F);function Da(g,S){if(typeof g!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){g()},S)}function ma(){this.g=!0}ma.prototype.ua=function(){this.g=!1};function Vu(g,S,O,W,fe,we){g.info(function(){if(g.g)if(we){var He="",xt=we.split("&");for(let Ht=0;Ht<xt.length;Ht++){var Fr=xt[Ht].split("=");if(Fr.length>1){const _r=Fr[0];Fr=Fr[1];const Pa=_r.split("_");He=Pa.length>=2&&Pa[1]=="type"?He+(_r+"="+Fr+"&"):He+(_r+"=redacted&")}}}else He=null;else He=we;return"XMLHTTP REQ ("+W+") [attempt "+fe+"]: "+S+`
`+O+`
`+He})}function fc(g,S,O,W,fe,we,He){g.info(function(){return"XMLHTTP RESP ("+W+") [ attempt "+fe+"]: "+S+`
`+O+`
`+we+" "+He})}function Oa(g,S,O,W){g.info(function(){return"XMLHTTP TEXT ("+S+"): "+Uu(g,O)+(W?" "+W:"")})}function ei(g,S){g.info(function(){return"TIMEOUT: "+S})}ma.prototype.info=function(){};function Uu(g,S){if(!g.g)return S;if(!S)return null;try{const we=JSON.parse(S);if(we){for(g=0;g<we.length;g++)if(Array.isArray(we[g])){var O=we[g];if(!(O.length<2)){var W=O[1];if(Array.isArray(W)&&!(W.length<1)){var fe=W[0];if(fe!="noop"&&fe!="stop"&&fe!="close")for(let He=1;He<W.length;He++)W[He]=""}}}}return Xt(we)}catch{return S}}var ti={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},ri={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},io;function ni(){}x(ni,rr),ni.prototype.g=function(){return new XMLHttpRequest},io=new ni;function as(g){return encodeURIComponent(String(g))}function U(g){var S=1;g=g.split(":");const O=[];for(;S>0&&g.length;)O.push(g.shift()),S--;return g.length&&O.push(g.join(":")),O}function Z(g,S,O,W){this.j=g,this.i=S,this.l=O,this.S=W||1,this.V=new Gr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new q}function q(){this.i=null,this.g="",this.h=!1}var X={},K={};function ee(g,S,O){g.M=1,g.A=lo(Wr(S)),g.u=O,g.R=!0,de(g,null)}function de(g,S){g.F=Date.now(),ge(g),g.B=Wr(g.A);var O=g.B,W=g.S;Array.isArray(W)||(W=[String(W)]),dc(O.i,"t",W),g.C=0,O=g.j.L,g.h=new q,g.g=vh(g.j,O?S:null,!g.u),g.P>0&&(g.O=new zt(d(g.Y,g,g.g),g.P)),S=g.V,O=g.g,W=g.ba;var fe="readystatechange";Array.isArray(fe)||(fe&&(nn[0]=fe.toString()),fe=nn);for(let we=0;we<fe.length;we++){const He=Ae(O,fe[we],W||S.handleEvent,!1,S.h||S);if(!He)break;S.g[He.key]=He}S=g.J?Q(g.J):{},g.u?(g.v||(g.v="POST"),S["Content-Type"]="application/x-www-form-urlencoded",g.g.ea(g.B,g.v,g.u,S)):(g.v="GET",g.g.ea(g.B,g.v,null,S)),da(),Vu(g.i,g.v,g.B,g.l,g.S,g.u)}Z.prototype.ba=function(g){g=g.target;const S=this.O;S&&cs(g)==3?S.j():this.Y(g)},Z.prototype.Y=function(g){try{if(g==this.g)e:{const xt=cs(this.g),Fr=this.g.ya(),Ht=this.g.ca();if(!(xt<3)&&(xt!=3||this.g&&(this.h.h||this.g.la()||vn(this.g)))){this.K||xt!=4||Fr==7||(Fr==8||Ht<=0?da(3):da(2)),Ve(this);var S=this.g.ca();this.X=S;var O=ke(this);if(this.o=S==200,fc(this.i,this.v,this.B,this.l,this.S,xt,S),this.o){if(this.U&&!this.L){t:{if(this.g){var W,fe=this.g;if((W=fe.g?fe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!P(W)){var we=W;break t}}we=null}if(g=we)Oa(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ge(this,g);else{this.o=!1,this.m=3,kr(12),Le(this),qe(this);break e}}if(this.R){g=!0;let _r;for(;!this.K&&this.C<O.length;)if(_r=xe(this,O),_r==K){xt==4&&(this.m=4,kr(14),g=!1),Oa(this.i,this.l,null,"[Incomplete Response]");break}else if(_r==X){this.m=4,kr(15),Oa(this.i,this.l,O,"[Invalid Chunk]"),g=!1;break}else Oa(this.i,this.l,_r,null),Ge(this,_r);if(me(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xt!=4||O.length!=0||this.h.h||(this.m=1,kr(16),g=!1),this.o=this.o&&g,!g)Oa(this.i,this.l,O,"[Invalid Chunked Response]"),Le(this),qe(this);else if(O.length>0&&!this.W){this.W=!0;var He=this.j;He.g==this&&He.aa&&!He.P&&(He.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),Qu(He),He.P=!0,kr(11))}}else Oa(this.i,this.l,O,null),Ge(this,O);xt==4&&Le(this),this.o&&!this.K&&(xt==4?mh(this.j,this):(this.o=!1,ge(this)))}else si(this.g),S==400&&O.indexOf("Unknown SID")>0?(this.m=3,kr(12)):(this.m=0,kr(13)),Le(this),qe(this)}}}catch{}finally{}};function ke(g){if(!me(g))return g.g.la();const S=vn(g.g);if(S==="")return"";let O="";const W=S.length,fe=cs(g.g)==4;if(!g.h.i){if(typeof TextDecoder>"u")return Le(g),qe(g),"";g.h.i=new o.TextDecoder}for(let we=0;we<W;we++)g.h.h=!0,O+=g.h.i.decode(S[we],{stream:!(fe&&we==W-1)});return S.length=0,g.h.g+=O,g.C=0,g.h.g}function me(g){return g.g?g.v=="GET"&&g.M!=2&&g.j.Aa:!1}function xe(g,S){var O=g.C,W=S.indexOf(`
`,O);return W==-1?K:(O=Number(S.substring(O,W)),isNaN(O)?X:(W+=1,W+O>S.length?K:(S=S.slice(W,W+O),g.C=W+O,S)))}Z.prototype.cancel=function(){this.K=!0,Le(this)};function ge(g){g.T=Date.now()+g.H,Be(g,g.H)}function Be(g,S){if(g.D!=null)throw Error("WatchDog timer not null");g.D=Da(d(g.aa,g),S)}function Ve(g){g.D&&(o.clearTimeout(g.D),g.D=null)}Z.prototype.aa=function(){this.D=null;const g=Date.now();g-this.T>=0?(ei(this.i,this.B),this.M!=2&&(da(),kr(17)),Le(this),this.m=2,qe(this)):Be(this,this.T-g)};function qe(g){g.j.I==0||g.K||mh(g.j,g)}function Le(g){Ve(g);var S=g.O;S&&typeof S.dispose=="function"&&S.dispose(),g.O=null,qn(g.V),g.g&&(S=g.g,g.g=null,S.abort(),S.dispose())}function Ge(g,S){try{var O=g.j;if(O.I!=0&&(O.g==g||Nn(O.h,g))){if(!g.L&&Nn(O.h,g)&&O.I==3){try{var W=O.Ba.g.parse(S)}catch{W=null}if(Array.isArray(W)&&W.length==3){var fe=W;if(fe[0]==0){e:if(!O.v){if(O.g)if(O.g.F+3e3<g.F)vc(O),Ki(O);else break e;po(O),kr(18)}}else O.xa=fe[1],0<O.xa-O.K&&fe[2]<37500&&O.F&&O.A==0&&!O.C&&(O.C=Da(d(O.Va,O),6e3));cr(O.h)<=1&&O.ta&&(O.ta=void 0)}else Ns(O,11)}else if((g.L||O.g==g)&&vc(O),!P(S))for(fe=O.Ba.g.parse(S),S=0;S<fe.length;S++){let Ht=fe[S];const _r=Ht[0];if(!(_r<=O.K))if(O.K=_r,Ht=Ht[1],O.I==2)if(Ht[0]=="c"){O.M=Ht[1],O.ba=Ht[2];const Pa=Ht[3];Pa!=null&&(O.ka=Pa,O.j.info("VER="+O.ka));const Rs=Ht[4];Rs!=null&&(O.za=Rs,O.j.info("SVER="+O.za));const us=Ht[5];us!=null&&typeof us=="number"&&us>0&&(W=1.5*us,O.O=W,O.j.info("backChannelRequestTimeoutMs_="+W)),W=O;const fs=g.g;if(fs){const go=fs.g?fs.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(go){var we=W.h;we.g||go.indexOf("spdy")==-1&&go.indexOf("quic")==-1&&go.indexOf("h2")==-1||(we.j=we.l,we.g=new Set,we.h&&(ss(we,we.h),we.h=null))}if(W.G){const yc=fs.g?fs.g.getResponseHeader("X-HTTP-Session-Id"):null;yc&&(W.wa=yc,Kt(W.J,W.G,yc))}}O.I=3,O.l&&O.l.ra(),O.aa&&(O.T=Date.now()-g.F,O.j.info("Handshake RTT: "+O.T+"ms")),W=O;var He=g;if(W.na=xh(W,W.L?W.ba:null,W.W),He.L){is(W.h,He);var xt=He,Fr=W.O;Fr&&(xt.H=Fr),xt.D&&(Ve(xt),ge(xt)),W.g=He}else hh(W);O.i.length>0&&Cs(O)}else Ht[0]!="stop"&&Ht[0]!="close"||Ns(O,7);else O.I==3&&(Ht[0]=="stop"||Ht[0]=="close"?Ht[0]=="stop"?Ns(O,7):$u(O):Ht[0]!="noop"&&O.l&&O.l.qa(Ht),O.A=0)}}da(4)}catch{}}var Ze=class{constructor(g,S){this.g=g,this.map=S}};function Yt(g){this.l=g||10,o.PerformanceNavigationTiming?(g=o.performance.getEntriesByType("navigation"),g=g.length>0&&(g[0].nextHopProtocol=="hq"||g[0].nextHopProtocol=="h2")):g=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=g?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function $t(g){return g.h?!0:g.g?g.g.size>=g.j:!1}function cr(g){return g.h?1:g.g?g.g.size:0}function Nn(g,S){return g.h?g.h==S:g.g?g.g.has(S):!1}function ss(g,S){g.g?g.g.add(S):g.h=S}function is(g,S){g.h&&g.h==S?g.h=null:g.g&&g.g.has(S)&&g.g.delete(S)}Yt.prototype.cancel=function(){if(this.i=pa(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const g of this.g.values())g.cancel();this.g.clear()}};function pa(g){if(g.h!=null)return g.i.concat(g.h.G);if(g.g!=null&&g.g.size!==0){let S=g.i;for(const O of g.g.values())S=S.concat(O.G);return S}return w(g.i)}var zi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Rn(g,S){if(g){g=g.split("&");for(let O=0;O<g.length;O++){const W=g[O].indexOf("=");let fe,we=null;W>=0?(fe=g[O].substring(0,W),we=g[O].substring(W+1)):fe=g[O],S(fe,we?decodeURIComponent(we.replace(/\+/g," ")):"")}}}function ga(g){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let S;g instanceof ga?(this.l=g.l,fn(this,g.j),this.o=g.o,this.g=g.g,Hi(this,g.u),this.h=g.h,zu(this,uh(g.i)),this.m=g.m):g&&(S=String(g).match(zi))?(this.l=!1,fn(this,S[1]||"",!0),this.o=Ts(S[2]||""),this.g=Ts(S[3]||"",!0),Hi(this,S[4]),this.h=Ts(S[5]||"",!0),zu(this,S[6]||"",!0),this.m=Ts(S[7]||"")):(this.l=!1,this.i=new qi(null,this.l))}ga.prototype.toString=function(){const g=[];var S=this.j;S&&g.push(oo(S,hc,!0),":");var O=this.g;return(O||S=="file")&&(g.push("//"),(S=this.o)&&g.push(oo(S,hc,!0),"@"),g.push(as(O).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),O=this.u,O!=null&&g.push(":",String(O))),(O=this.h)&&(this.g&&O.charAt(0)!="/"&&g.push("/"),g.push(oo(O,O.charAt(0)=="/"?Hu:lh,!0))),(O=this.i.toString())&&g.push("?",O),(O=this.m)&&g.push("#",oo(O,oh)),g.join("")},ga.prototype.resolve=function(g){const S=Wr(this);let O=!!g.j;O?fn(S,g.j):O=!!g.o,O?S.o=g.o:O=!!g.g,O?S.g=g.g:O=g.u!=null;var W=g.h;if(O)Hi(S,g.u);else if(O=!!g.h){if(W.charAt(0)!="/")if(this.g&&!this.h)W="/"+W;else{var fe=S.h.lastIndexOf("/");fe!=-1&&(W=S.h.slice(0,fe+1)+W)}if(fe=W,fe==".."||fe==".")W="";else if(fe.indexOf("./")!=-1||fe.indexOf("/.")!=-1){W=fe.lastIndexOf("/",0)==0,fe=fe.split("/");const we=[];for(let He=0;He<fe.length;){const xt=fe[He++];xt=="."?W&&He==fe.length&&we.push(""):xt==".."?((we.length>1||we.length==1&&we[0]!="")&&we.pop(),W&&He==fe.length&&we.push("")):(we.push(xt),W=!0)}W=we.join("/")}else W=fe}return O?S.h=W:O=g.i.toString()!=="",O?zu(S,uh(g.i)):O=!!g.m,O&&(S.m=g.m),S};function Wr(g){return new ga(g)}function fn(g,S,O){g.j=O?Ts(S,!0):S,g.j&&(g.j=g.j.replace(/:$/,""))}function Hi(g,S){if(S){if(S=Number(S),isNaN(S)||S<0)throw Error("Bad port number "+S);g.u=S}else g.u=null}function zu(g,S,O){S instanceof qi?(g.i=S,mc(g.i,g.l)):(O||(S=oo(S,Gi)),g.i=new qi(S,g.l))}function Kt(g,S,O){g.i.set(S,O)}function lo(g){return Kt(g,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),g}function Ts(g,S){return g?S?decodeURI(g.replace(/%25/g,"%2525")):decodeURIComponent(g):""}function oo(g,S,O){return typeof g=="string"?(g=encodeURI(g).replace(S,ea),O&&(g=g.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g):null}function ea(g){return g=g.charCodeAt(0),"%"+(g>>4&15).toString(16)+(g&15).toString(16)}var hc=/[#\/\?@]/g,lh=/[#\?:]/g,Hu=/[#\?]/g,Gi=/[#\?@]/g,oh=/#/g;function qi(g,S){this.h=this.g=null,this.i=g||null,this.j=!!S}function ta(g){g.g||(g.g=new Map,g.h=0,g.i&&Rn(g.i,function(S,O){g.add(decodeURIComponent(S.replace(/\+/g," ")),O)}))}t=qi.prototype,t.add=function(g,S){ta(this),this.i=null,g=Wi(this,g);let O=this.g.get(g);return O||this.g.set(g,O=[]),O.push(S),this.h+=1,this};function ch(g,S){ta(g),S=Wi(g,S),g.g.has(S)&&(g.i=null,g.h-=g.g.get(S).length,g.g.delete(S))}function Gu(g,S){return ta(g),S=Wi(g,S),g.g.has(S)}t.forEach=function(g,S){ta(this),this.g.forEach(function(O,W){O.forEach(function(fe){g.call(S,fe,W,this)},this)},this)};function qu(g,S){ta(g);let O=[];if(typeof S=="string")Gu(g,S)&&(O=O.concat(g.g.get(Wi(g,S))));else for(g=Array.from(g.g.values()),S=0;S<g.length;S++)O=O.concat(g[S]);return O}t.set=function(g,S){return ta(this),this.i=null,g=Wi(this,g),Gu(this,g)&&(this.h-=this.g.get(g).length),this.g.set(g,[S]),this.h+=1,this},t.get=function(g,S){return g?(g=qu(this,g),g.length>0?String(g[0]):S):S};function dc(g,S,O){ch(g,S),O.length>0&&(g.i=null,g.g.set(Wi(g,S),w(O)),g.h+=O.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const g=[],S=Array.from(this.g.keys());for(let W=0;W<S.length;W++){var O=S[W];const fe=as(O);O=qu(this,O);for(let we=0;we<O.length;we++){let He=fe;O[we]!==""&&(He+="="+as(O[we])),g.push(He)}}return this.i=g.join("&")};function uh(g){const S=new qi;return S.i=g.i,g.g&&(S.g=new Map(g.g),S.h=g.h),S}function Wi(g,S){return S=String(S),g.j&&(S=S.toLowerCase()),S}function mc(g,S){S&&!g.j&&(ta(g),g.i=null,g.g.forEach(function(O,W){const fe=W.toLowerCase();W!=fe&&(ch(this,W),dc(this,fe,O))},g)),g.j=S}function ls(g,S){const O=new ma;if(o.Image){const W=new Image;W.onload=m(Fa,O,"TestLoadImage: loaded",!0,S,W),W.onerror=m(Fa,O,"TestLoadImage: error",!1,S,W),W.onabort=m(Fa,O,"TestLoadImage: abort",!1,S,W),W.ontimeout=m(Fa,O,"TestLoadImage: timeout",!1,S,W),o.setTimeout(function(){W.ontimeout&&W.ontimeout()},1e4),W.src=g}else S(!1)}function Wu(g,S){const O=new ma,W=new AbortController,fe=setTimeout(()=>{W.abort(),Fa(O,"TestPingServer: timeout",!1,S)},1e4);fetch(g,{signal:W.signal}).then(we=>{clearTimeout(fe),we.ok?Fa(O,"TestPingServer: ok",!0,S):Fa(O,"TestPingServer: server error",!1,S)}).catch(()=>{clearTimeout(fe),Fa(O,"TestPingServer: error",!1,S)})}function Fa(g,S,O,W,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),W(O)}catch{}}function Xi(){this.g=new dt}function Ss(g){this.i=g.Sb||null,this.h=g.ab||!1}x(Ss,rr),Ss.prototype.g=function(){return new co(this.i,this.h)};function co(g,S){_t.call(this),this.H=g,this.o=S,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}x(co,_t),t=co.prototype,t.open=function(g,S){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=g,this.D=S,this.readyState=1,os(this)},t.send=function(g){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const S={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};g&&(S.body=g),(this.H||o).fetch(new Request(this.D,S)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Yi(this)),this.readyState=0},t.Pa=function(g){if(this.g&&(this.l=g,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=g.headers,this.readyState=2,os(this)),this.g&&(this.readyState=3,os(this),this.g)))if(this.responseType==="arraybuffer")g.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in g){if(this.j=g.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;pc(this)}else g.text().then(this.Oa.bind(this),this.ga.bind(this))};function pc(g){g.j.read().then(g.Ma.bind(g)).catch(g.ga.bind(g))}t.Ma=function(g){if(this.g){if(this.o&&g.value)this.response.push(g.value);else if(!this.o){var S=g.value?g.value:new Uint8Array(0);(S=this.B.decode(S,{stream:!g.done}))&&(this.response=this.responseText+=S)}g.done?Yi(this):os(this),this.readyState==3&&pc(this)}},t.Oa=function(g){this.g&&(this.response=this.responseText=g,Yi(this))},t.Na=function(g){this.g&&(this.response=g,Yi(this))},t.ga=function(){this.g&&Yi(this)};function Yi(g){g.readyState=4,g.l=null,g.j=null,g.B=null,os(g)}t.setRequestHeader=function(g,S){this.A.append(g,S)},t.getResponseHeader=function(g){return this.h&&this.h.get(g.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const g=[],S=this.h.entries();for(var O=S.next();!O.done;)O=O.value,g.push(O[0]+": "+O[1]),O=S.next();return g.join(`\r
`)};function os(g){g.onreadystatechange&&g.onreadystatechange.call(g)}Object.defineProperty(co.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(g){this.m=g?"include":"same-origin"}});function Ma(g){let S="";return te(g,function(O,W){S+=W,S+=":",S+=O,S+=`\r
`}),S}function uo(g,S,O){e:{for(W in O){var W=!1;break e}W=!0}W||(O=Ma(O),typeof g=="string"?O!=null&&as(O):Kt(g,S,O))}function nr(g){_t.call(this),this.headers=new Map,this.L=g||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}x(nr,_t);var As=/^https?$/i,Xu=["POST","PUT"];t=nr.prototype,t.Fa=function(g){this.H=g},t.ea=function(g,S,O,W){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+g);S=S?S.toUpperCase():"GET",this.D=g,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():io.g(),this.g.onreadystatechange=y(d(this.Ca,this));try{this.B=!0,this.g.open(S,String(g),!0),this.B=!1}catch(we){fo(this,we);return}if(g=O||"",O=new Map(this.headers),W)if(Object.getPrototypeOf(W)===Object.prototype)for(var fe in W)O.set(fe,W[fe]);else if(typeof W.keys=="function"&&typeof W.get=="function")for(const we of W.keys())O.set(we,W.get(we));else throw Error("Unknown input type for opt_headers: "+String(W));W=Array.from(O.keys()).find(we=>we.toLowerCase()=="content-type"),fe=o.FormData&&g instanceof o.FormData,!(Array.prototype.indexOf.call(Xu,S,void 0)>=0)||W||fe||O.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[we,He]of O)this.g.setRequestHeader(we,He);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(g),this.v=!1}catch(we){fo(this,we)}};function fo(g,S){g.h=!1,g.g&&(g.j=!0,g.g.abort(),g.j=!1),g.l=S,g.o=5,Yu(g),ai(g)}function Yu(g){g.A||(g.A=!0,Ft(g,"complete"),Ft(g,"error"))}t.abort=function(g){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=g||7,Ft(this,"complete"),Ft(this,"abort"),ai(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ai(this,!0)),nr.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ho(this):this.Xa())},t.Xa=function(){ho(this)};function ho(g){if(g.h&&typeof i<"u"){if(g.v&&cs(g)==4)setTimeout(g.Ca.bind(g),0);else if(Ft(g,"readystatechange"),cs(g)==4){g.h=!1;try{const we=g.ca();e:switch(we){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var S=!0;break e;default:S=!1}var O;if(!(O=S)){var W;if(W=we===0){let He=String(g.D).match(zi)[1]||null;!He&&o.self&&o.self.location&&(He=o.self.location.protocol.slice(0,-1)),W=!As.test(He?He.toLowerCase():"")}O=W}if(O)Ft(g,"complete"),Ft(g,"success");else{g.o=6;try{var fe=cs(g)>2?g.g.statusText:""}catch{fe=""}g.l=fe+" ["+g.ca()+"]",Yu(g)}}finally{ai(g)}}}}function ai(g,S){if(g.g){g.m&&(clearTimeout(g.m),g.m=null);const O=g.g;g.g=null,S||Ft(g,"ready");try{O.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function cs(g){return g.g?g.g.readyState:0}t.ca=function(){try{return cs(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(g){if(this.g){var S=this.g.responseText;return g&&S.indexOf(g)==0&&(S=S.substring(g.length)),Or(S)}};function vn(g){try{if(!g.g)return null;if("response"in g.g)return g.g.response;switch(g.F){case"":case"text":return g.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in g.g)return g.g.mozResponseArrayBuffer}return null}catch{return null}}function si(g){const S={};g=(g.g&&cs(g)>=2&&g.g.getAllResponseHeaders()||"").split(`\r
`);for(let W=0;W<g.length;W++){if(P(g[W]))continue;var O=U(g[W]);const fe=O[0];if(O=O[1],typeof O!="string")continue;O=O.trim();const we=S[fe]||[];S[fe]=we,we.push(O)}_e(S,function(W){return W.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ks(g,S,O){return O&&O.internalChannelParams&&O.internalChannelParams[g]||S}function $i(g){this.za=0,this.i=[],this.j=new ma,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ks("failFast",!1,g),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ks("baseRetryDelayMs",5e3,g),this.Za=ks("retryDelaySeedMs",1e4,g),this.Ta=ks("forwardChannelMaxRetries",2,g),this.va=ks("forwardChannelRequestTimeoutMs",2e4,g),this.ma=g&&g.xmlHttpFactory||void 0,this.Ua=g&&g.Rb||void 0,this.Aa=g&&g.useFetchStreams||!1,this.O=void 0,this.L=g&&g.supportsCrossDomainXhr||!1,this.M="",this.h=new Yt(g&&g.concurrentRequestLimit),this.Ba=new Xi,this.S=g&&g.fastHandshake||!1,this.R=g&&g.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=g&&g.Pb||!1,g&&g.ua&&this.j.ua(),g&&g.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&g&&g.detectBufferingProxy||!1,this.ia=void 0,g&&g.longPollingTimeout&&g.longPollingTimeout>0&&(this.ia=g.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=$i.prototype,t.ka=8,t.I=1,t.connect=function(g,S,O,W){kr(0),this.W=g,this.H=S||{},O&&W!==void 0&&(this.H.OSID=O,this.H.OAID=W),this.F=this.X,this.J=xh(this,null,this.W),Cs(this)};function $u(g){if(gc(g),g.I==3){var S=g.V++,O=Wr(g.J);if(Kt(O,"SID",g.M),Kt(O,"RID",S),Kt(O,"TYPE","terminate"),mo(g,O),S=new Z(g,g.j,S),S.M=2,S.A=lo(Wr(O)),O=!1,o.navigator&&o.navigator.sendBeacon)try{O=o.navigator.sendBeacon(S.A.toString(),"")}catch{}!O&&o.Image&&(new Image().src=S.A,O=!0),O||(S.g=vh(S.j,null),S.g.ea(S.A)),S.F=Date.now(),ge(S)}gh(g)}function Ki(g){g.g&&(Qu(g),g.g.cancel(),g.g=null)}function gc(g){Ki(g),g.v&&(o.clearTimeout(g.v),g.v=null),vc(g),g.h.cancel(),g.m&&(typeof g.m=="number"&&o.clearTimeout(g.m),g.m=null)}function Cs(g){if(!$t(g.h)&&!g.m){g.m=!0;var S=g.Ea;V||D(),H||(V(),H=!0),A.add(S,g),g.D=0}}function xc(g,S){return cr(g.h)>=g.h.j-(g.m?1:0)?!1:g.m?(g.i=S.G.concat(g.i),!0):g.I==1||g.I==2||g.D>=(g.Sa?0:g.Ta)?!1:(g.m=Da(d(g.Ea,g,S),ph(g,g.D)),g.D++,!0)}t.Ea=function(g){if(this.m)if(this.m=null,this.I==1){if(!g){this.V=Math.floor(Math.random()*1e5),g=this.V++;const fe=new Z(this,this.j,g);let we=this.o;if(this.U&&(we?(we=Q(we),J(we,this.U)):we=this.U),this.u!==null||this.R||(fe.J=we,we=null),this.S)e:{for(var S=0,O=0;O<this.i.length;O++){t:{var W=this.i[O];if("__data__"in W.map&&(W=W.map.__data__,typeof W=="string")){W=W.length;break t}W=void 0}if(W===void 0)break;if(S+=W,S>4096){S=O;break e}if(S===4096||O===this.i.length-1){S=O+1;break e}}S=1e3}else S=1e3;S=fh(this,fe,S),O=Wr(this.J),Kt(O,"RID",g),Kt(O,"CVER",22),this.G&&Kt(O,"X-HTTP-Session-Id",this.G),mo(this,O),we&&(this.R?S="headers="+as(Ma(we))+"&"+S:this.u&&uo(O,this.u,we)),ss(this.h,fe),this.Ra&&Kt(O,"TYPE","init"),this.S?(Kt(O,"$req",S),Kt(O,"SID","null"),fe.U=!0,ee(fe,O,null)):ee(fe,O,S),this.I=2}}else this.I==3&&(g?Ku(this,g):this.i.length==0||$t(this.h)||Ku(this))};function Ku(g,S){var O;S?O=S.l:O=g.V++;const W=Wr(g.J);Kt(W,"SID",g.M),Kt(W,"RID",O),Kt(W,"AID",g.K),mo(g,W),g.u&&g.o&&uo(W,g.u,g.o),O=new Z(g,g.j,O,g.D+1),g.u===null&&(O.J=g.o),S&&(g.i=S.G.concat(g.i)),S=fh(g,O,1e3),O.H=Math.round(g.va*.5)+Math.round(g.va*.5*Math.random()),ss(g.h,O),ee(O,W,S)}function mo(g,S){g.H&&te(g.H,function(O,W){Kt(S,W,O)}),g.l&&te({},function(O,W){Kt(S,W,O)})}function fh(g,S,O){O=Math.min(g.i.length,O);const W=g.l?d(g.l.Ka,g.l,g):null;e:{var fe=g.i;let xt=-1;for(;;){const Fr=["count="+O];xt==-1?O>0?(xt=fe[0].g,Fr.push("ofs="+xt)):xt=0:Fr.push("ofs="+xt);let Ht=!0;for(let _r=0;_r<O;_r++){var we=fe[_r].g;const Pa=fe[_r].map;if(we-=xt,we<0)xt=Math.max(0,fe[_r].g-100),Ht=!1;else try{we="req"+we+"_"||"";try{var He=Pa instanceof Map?Pa:Object.entries(Pa);for(const[Rs,us]of He){let fs=us;u(us)&&(fs=Xt(us)),Fr.push(we+Rs+"="+encodeURIComponent(fs))}}catch(Rs){throw Fr.push(we+"type="+encodeURIComponent("_badmap")),Rs}}catch{W&&W(Pa)}}if(Ht){He=Fr.join("&");break e}}He=void 0}return g=g.i.splice(0,O),S.G=g,He}function hh(g){if(!g.g&&!g.v){g.Y=1;var S=g.Da;V||D(),H||(V(),H=!0),A.add(S,g),g.A=0}}function po(g){return g.g||g.v||g.A>=3?!1:(g.Y++,g.v=Da(d(g.Da,g),ph(g,g.A)),g.A++,!0)}t.Da=function(){if(this.v=null,dh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var g=4*this.T;this.j.info("BP detection timer enabled: "+g),this.B=Da(d(this.Wa,this),g)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,kr(10),Ki(this),dh(this))};function Qu(g){g.B!=null&&(o.clearTimeout(g.B),g.B=null)}function dh(g){g.g=new Z(g,g.j,"rpc",g.Y),g.u===null&&(g.g.J=g.o),g.g.P=0;var S=Wr(g.na);Kt(S,"RID","rpc"),Kt(S,"SID",g.M),Kt(S,"AID",g.K),Kt(S,"CI",g.F?"0":"1"),!g.F&&g.ia&&Kt(S,"TO",g.ia),Kt(S,"TYPE","xmlhttp"),mo(g,S),g.u&&g.o&&uo(S,g.u,g.o),g.O&&(g.g.H=g.O);var O=g.g;g=g.ba,O.M=1,O.A=lo(Wr(S)),O.u=null,O.R=!0,de(O,g)}t.Va=function(){this.C!=null&&(this.C=null,Ki(this),po(this),kr(19))};function vc(g){g.C!=null&&(o.clearTimeout(g.C),g.C=null)}function mh(g,S){var O=null;if(g.g==S){vc(g),Qu(g),g.g=null;var W=2}else if(Nn(g.h,S))O=S.G,is(g.h,S),W=1;else return;if(g.I!=0){if(S.o)if(W==1){O=S.u?S.u.length:0,S=Date.now()-S.F;var fe=g.D;W=Js(),Ft(W,new Wn(W,O)),Cs(g)}else hh(g);else if(fe=S.m,fe==3||fe==0&&S.X>0||!(W==1&&xc(g,S)||W==2&&po(g)))switch(O&&O.length>0&&(S=g.h,S.i=S.i.concat(O)),fe){case 1:Ns(g,5);break;case 4:Ns(g,10);break;case 3:Ns(g,6);break;default:Ns(g,2)}}}function ph(g,S){let O=g.Qa+Math.floor(Math.random()*g.Za);return g.isActive()||(O*=2),O*S}function Ns(g,S){if(g.j.info("Error code "+S),S==2){var O=d(g.bb,g),W=g.Ua;const fe=!W;W=new ga(W||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||fn(W,"https"),lo(W),fe?ls(W.toString(),O):Wu(W.toString(),O)}else kr(2);g.I=0,g.l&&g.l.pa(S),gh(g),gc(g)}t.bb=function(g){g?(this.j.info("Successfully pinged google.com"),kr(2)):(this.j.info("Failed to ping google.com"),kr(1))};function gh(g){if(g.I=0,g.ja=[],g.l){const S=pa(g.h);(S.length!=0||g.i.length!=0)&&(E(g.ja,S),E(g.ja,g.i),g.h.i.length=0,w(g.i),g.i.length=0),g.l.oa()}}function xh(g,S,O){var W=O instanceof ga?Wr(O):new ga(O);if(W.g!="")S&&(W.g=S+"."+W.g),Hi(W,W.u);else{var fe=o.location;W=fe.protocol,S=S?S+"."+fe.hostname:fe.hostname,fe=+fe.port;const we=new ga(null);W&&fn(we,W),S&&(we.g=S),fe&&Hi(we,fe),O&&(we.h=O),W=we}return O=g.G,S=g.wa,O&&S&&Kt(W,O,S),Kt(W,"VER",g.ka),mo(g,W),W}function vh(g,S,O){if(S&&!g.L)throw Error("Can't create secondary domain capable XhrIo object.");return S=g.Aa&&!g.ma?new nr(new Ss({ab:O})):new nr(g.ma),S.Fa(g.L),S}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function yh(){}t=yh.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Qi(){}Qi.prototype.g=function(g,S){return new Xn(g,S)};function Xn(g,S){_t.call(this),this.g=new $i(S),this.l=g,this.h=S&&S.messageUrlParams||null,g=S&&S.messageHeaders||null,S&&S.clientProtocolHeaderRequired&&(g?g["X-Client-Protocol"]="webchannel":g={"X-Client-Protocol":"webchannel"}),this.g.o=g,g=S&&S.initMessageHeaders||null,S&&S.messageContentType&&(g?g["X-WebChannel-Content-Type"]=S.messageContentType:g={"X-WebChannel-Content-Type":S.messageContentType}),S&&S.sa&&(g?g["X-WebChannel-Client-Profile"]=S.sa:g={"X-WebChannel-Client-Profile":S.sa}),this.g.U=g,(g=S&&S.Qb)&&!P(g)&&(this.g.u=g),this.A=S&&S.supportsCrossDomainXhr||!1,this.v=S&&S.sendRawJson||!1,(S=S&&S.httpSessionIdParam)&&!P(S)&&(this.g.G=S,g=this.h,g!==null&&S in g&&(g=this.h,S in g&&delete g[S])),this.j=new ii(this)}x(Xn,_t),Xn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Xn.prototype.close=function(){$u(this.g)},Xn.prototype.o=function(g){var S=this.g;if(typeof g=="string"){var O={};O.__data__=g,g=O}else this.v&&(O={},O.__data__=Xt(g),g=O);S.i.push(new Ze(S.Ya++,g)),S.I==3&&Cs(S)},Xn.prototype.N=function(){this.g.l=null,delete this.j,$u(this.g),delete this.g,Xn.Z.N.call(this)};function _h(g){or.call(this),g.__headers__&&(this.headers=g.__headers__,this.statusCode=g.__status__,delete g.__headers__,delete g.__status__);var S=g.__sm__;if(S){e:{for(const O in S){g=O;break e}g=void 0}(this.i=g)&&(g=this.i,S=S!==null&&g in S?S[g]:void 0),this.data=S}else this.data=g}x(_h,or);function wh(){qr.call(this),this.status=1}x(wh,qr);function ii(g){this.g=g}x(ii,yh),ii.prototype.ra=function(){Ft(this.g,"a")},ii.prototype.qa=function(g){Ft(this.g,new _h(g))},ii.prototype.pa=function(g){Ft(this.g,new wh)},ii.prototype.oa=function(){Ft(this.g,"b")},Qi.prototype.createWebChannel=Qi.prototype.g,Xn.prototype.send=Xn.prototype.o,Xn.prototype.open=Xn.prototype.m,Xn.prototype.close=Xn.prototype.close,x4=function(){return new Qi},g4=function(){return Js()},p4=dr,vx={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ti.NO_ERROR=0,ti.TIMEOUT=8,ti.HTTP_ERROR=6,Kd=ti,ri.COMPLETE="complete",m4=ri,an.EventType=Mt,Mt.OPEN="a",Mt.CLOSE="b",Mt.ERROR="c",Mt.MESSAGE="d",_t.prototype.listen=_t.prototype.J,Uf=an,nr.prototype.listenOnce=nr.prototype.K,nr.prototype.getLastError=nr.prototype.Ha,nr.prototype.getLastErrorCode=nr.prototype.ya,nr.prototype.getStatus=nr.prototype.ca,nr.prototype.getResponseJson=nr.prototype.La,nr.prototype.getResponseText=nr.prototype.la,nr.prototype.send=nr.prototype.ea,nr.prototype.setWithCredentials=nr.prototype.Fa,d4=nr}).apply(typeof kd<"u"?kd:typeof self<"u"?self:typeof window<"u"?window:{});const Kb="@firebase/firestore",Qb="4.9.2";let Fn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Fn.UNAUTHENTICATED=new Fn(null),Fn.GOOGLE_CREDENTIALS=new Fn("google-credentials-uid"),Fn.FIRST_PARTY=new Fn("first-party-uid"),Fn.MOCK_USER=new Fn("mock-user");let Ru="12.3.0";const qo=new dv("@firebase/firestore");function Jc(){return qo.logLevel}function Qe(t,...e){if(qo.logLevel<=Rt.DEBUG){const r=e.map(gv);qo.debug(`Firestore (${Ru}): ${t}`,...r)}}function Di(t,...e){if(qo.logLevel<=Rt.ERROR){const r=e.map(gv);qo.error(`Firestore (${Ru}): ${t}`,...r)}}function pu(t,...e){if(qo.logLevel<=Rt.WARN){const r=e.map(gv);qo.warn(`Firestore (${Ru}): ${t}`,...r)}}function gv(t){if(typeof t=="string")return t;try{return(function(r){return JSON.stringify(r)})(t)}catch{return t}}function ct(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,v4(t,n,r)}function v4(t,e,r){let n=`FIRESTORE (${Ru}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Di(n),new Error(n)}function Wt(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||v4(e,a,n)}function gt(t,e){return t}const Ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $e extends Li{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Fl{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}class y4{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class oD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(Fn.UNAUTHENTICATED)))}shutdown(){}}class cD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class uD{constructor(e){this.t=e,this.currentUser=Fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Wt(this.o===void 0,42304);let n=this.i;const a=f=>this.i!==n?(n=this.i,r(f)):Promise.resolve();let i=new Fl;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Fl,e.enqueueRetryable((()=>a(this.currentUser)))};const o=()=>{const f=i;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},u=f=>{Qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((f=>u(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?u(f):(Qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Fl)}}),0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(Qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Wt(typeof n.accessToken=="string",31837,{l:n}),new y4(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Wt(e===null||typeof e=="string",2055,{h:e}),new Fn(e)}}class fD{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Fn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class hD{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new fD(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(Fn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Jb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class dD{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,xs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Wt(this.o===void 0,3512);const n=i=>{i.error!=null&&Qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Qe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>n(i)))};const a=i=>{Qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>a(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?a(i):Qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Jb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Wt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Jb(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function mD(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}class xv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=mD(40);for(let i=0;i<a.length;++i)n.length<20&&a[i]<r&&(n+=e.charAt(a[i]%62))}return n}}function It(t,e){return t<e?-1:t>e?1:0}function yx(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const a=t.charAt(n),i=e.charAt(n);if(a!==i)return L1(a)===L1(i)?It(a,i):L1(a)?1:-1}return It(t.length,e.length)}const pD=55296,gD=57343;function L1(t){const e=t.charCodeAt(0);return e>=pD&&e<=gD}function gu(t,e,r){return t.length===e.length&&t.every(((n,a)=>r(n,e[a])))}const Zb="__name__";class Ls{constructor(e,r,n){r===void 0?r=0:r>e.length&&ct(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&ct(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ls.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ls?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const i=Ls.compareSegments(e.get(a),r.get(a));if(i!==0)return i}return It(e.length,r.length)}static compareSegments(e,r){const n=Ls.isNumericId(e),a=Ls.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?Ls.extractNumericId(e).compare(Ls.extractNumericId(r)):yx(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ol.fromString(e.substring(4,e.length-2))}}class hr extends Ls{construct(e,r,n){return new hr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new $e(Ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((a=>a.length>0)))}return new hr(r)}static emptyPath(){return new hr([])}}const xD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class An extends Ls{construct(e,r,n){return new An(e,r,n)}static isValidIdentifier(e){return xD.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),An.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Zb}static keyField(){return new An([Zb])}static fromServerFormat(e){const r=[];let n="",a=0;const i=()=>{if(n.length===0)throw new $e(Ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new $e(Ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new $e(Ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=f,a+=2}else u==="`"?(o=!o,a++):u!=="."||o?(n+=u,a++):(i(),a++)}if(i(),o)throw new $e(Ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new An(r)}static emptyPath(){return new An([])}}class at{constructor(e){this.path=e}static fromPath(e){return new at(hr.fromString(e))}static fromName(e){return new at(hr.fromString(e).popFirst(5))}static empty(){return new at(hr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&hr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return hr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new at(new hr(e.slice()))}}function _4(t,e,r){if(!r)throw new $e(Ie.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function vD(t,e,r,n){if(e===!0&&n===!0)throw new $e(Ie.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function eE(t){if(!at.isDocumentKey(t))throw new $e(Ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function tE(t){if(at.isDocumentKey(t))throw new $e(Ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function w4(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Ym(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ct(12329,{type:typeof t})}function Na(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $e(Ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Ym(t);throw new $e(Ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function rn(t,e){const r={typeString:t};return e&&(r.value=e),r}function j0(t,e){if(!w4(t))throw new $e(Ie.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const a=e[n].typeString,i="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(a&&typeof o!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(i!==void 0&&o!==i.value){r=`Expected '${n}' field to equal '${i.value}'`;break}}if(r)throw new $e(Ie.INVALID_ARGUMENT,r);return!0}const rE=-62135596800,nE=1e6;class xr{static now(){return xr.fromMillis(Date.now())}static fromDate(e){return xr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*nE);return new xr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<rE)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $e(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/nE}_compareTo(e){return this.seconds===e.seconds?It(this.nanoseconds,e.nanoseconds):It(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(j0(e,xr._jsonSchema))return new xr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-rE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xr._jsonSchemaVersion="firestore/timestamp/1.0",xr._jsonSchema={type:rn("string",xr._jsonSchemaVersion),seconds:rn("number"),nanoseconds:rn("number")};class mt{static fromTimestamp(e){return new mt(e)}static min(){return new mt(new xr(0,0))}static max(){return new mt(new xr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const u0=-1;function yD(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=mt.fromTimestamp(n===1e9?new xr(r+1,0):new xr(r,n));return new Ll(a,at.empty(),e)}function _D(t){return new Ll(t.readTime,t.key,u0)}class Ll{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ll(mt.min(),at.empty(),u0)}static max(){return new Ll(mt.max(),at.empty(),u0)}}function wD(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=at.comparator(t.documentKey,e.documentKey),r!==0?r:It(t.largestBatchId,e.largestBatchId))}const bD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ED{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Iu(t){if(t.code!==Ie.FAILED_PRECONDITION||t.message!==bD)throw t;Qe("LocalStore","Unexpectedly lost primary lease")}class Oe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&ct(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Oe(((n,a)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,a)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,a)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof Oe?r:Oe.resolve(r)}catch(r){return Oe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):Oe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):Oe.reject(r)}static resolve(e){return new Oe(((r,n)=>{r(e)}))}static reject(e){return new Oe(((r,n)=>{n(e)}))}static waitFor(e){return new Oe(((r,n)=>{let a=0,i=0,o=!1;e.forEach((u=>{++a,u.next((()=>{++i,o&&i===a&&r()}),(f=>n(f)))})),o=!0,i===a&&r()}))}static or(e){let r=Oe.resolve(!1);for(const n of e)r=r.next((a=>a?Oe.resolve(a):n()));return r}static forEach(e,r){const n=[];return e.forEach(((a,i)=>{n.push(r.call(this,a,i))})),this.waitFor(n)}static mapArray(e,r){return new Oe(((n,a)=>{const i=e.length,o=new Array(i);let u=0;for(let f=0;f<i;f++){const d=f;r(e[d]).next((m=>{o[d]=m,++u,u===i&&n(o)}),(m=>a(m)))}}))}static doWhile(e,r){return new Oe(((n,a)=>{const i=()=>{e()===!0?r().next((()=>{i()}),a):n()};i()}))}}function TD(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Du(t){return t.name==="IndexedDbTransactionError"}class $m{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}$m.ce=-1;const vv=-1;function Km(t){return t==null}function um(t){return t===0&&1/t==-1/0}function SD(t){return typeof t=="number"&&Number.isInteger(t)&&!um(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const b4="";function AD(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=aE(e)),e=kD(t.get(r),e);return aE(e)}function kD(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const i=t.charAt(a);switch(i){case"\0":r+="";break;case b4:r+="";break;default:r+=i}}return r}function aE(t){return t+b4+""}function sE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Jl(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function E4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class Ar{constructor(e,r){this.comparator=e,this.root=r||Tn.EMPTY}insert(e,r){return new Ar(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Tn.BLACK,null,null))}remove(e){return new Ar(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Tn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cd(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cd(this.root,e,this.comparator,!0)}}class Cd{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&a&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Tn{constructor(e,r,n,a,i){this.key=e,this.value=r,this.color=n??Tn.RED,this.left=a??Tn.EMPTY,this.right=i??Tn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,i){return new Tn(e??this.key,r??this.value,n??this.color,a??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const i=n(e,a.key);return a=i<0?a.copy(null,null,null,a.left.insert(e,r,n),null):i===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Tn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return Tn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Tn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Tn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ct(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ct(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ct(27949);return e+(this.isRed()?0:1)}}Tn.EMPTY=null,Tn.RED=!0,Tn.BLACK=!1;Tn.EMPTY=new class{constructor(){this.size=0}get key(){throw ct(57766)}get value(){throw ct(16141)}get color(){throw ct(16727)}get left(){throw ct(29726)}get right(){throw ct(36894)}copy(e,r,n,a,i){return this}insert(e,r,n){return new Tn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class on{constructor(e){this.comparator=e,this.data=new Ar(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new iE(this.data.getIterator())}getIteratorFrom(e){return new iE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof on)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,i=n.getNext().key;if(this.comparator(a,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new on(this.comparator);return r.data=e,r}}class iE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ca{constructor(e){this.fields=e,e.sort(An.comparator)}static empty(){return new Ca([])}unionWith(e){let r=new on(An.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ca(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return gu(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}class T4 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Cn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(a){try{return atob(a)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new T4("Invalid base64 string: "+i):i}})(e);return new Cn(r)}static fromUint8Array(e){const r=(function(a){let i="";for(let o=0;o<a.length;++o)i+=String.fromCharCode(a[o]);return i})(e);return new Cn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return It(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cn.EMPTY_BYTE_STRING=new Cn("");const CD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bl(t){if(Wt(!!t,39018),typeof t=="string"){let e=0;const r=CD.exec(t);if(Wt(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Lr(t.seconds),nanos:Lr(t.nanos)}}function Lr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Vl(t){return typeof t=="string"?Cn.fromBase64String(t):Cn.fromUint8Array(t)}const S4="server_timestamp",A4="__type__",k4="__previous_value__",C4="__local_write_time__";function yv(t){return(t?.mapValue?.fields||{})[A4]?.stringValue===S4}function Qm(t){const e=t.mapValue.fields[k4];return yv(e)?Qm(e):e}function f0(t){const e=Bl(t.mapValue.fields[C4].timestampValue);return new xr(e.seconds,e.nanos)}class ND{constructor(e,r,n,a,i,o,u,f,d,m){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=f,this.useFetchStreams=d,this.isUsingEmulator=m}}const fm="(default)";class h0{constructor(e,r){this.projectId=e,this.database=r||fm}static empty(){return new h0("","")}get isDefaultDatabase(){return this.database===fm}isEqual(e){return e instanceof h0&&e.projectId===this.projectId&&e.database===this.database}}const N4="__type__",RD="__max__",Nd={mapValue:{}},R4="__vector__",hm="value";function Ul(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yv(t)?4:DD(t)?9007199254740991:ID(t)?10:11:ct(28295,{value:t})}function Ys(t,e){if(t===e)return!0;const r=Ul(t);if(r!==Ul(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return f0(t).isEqual(f0(e));case 3:return(function(a,i){if(typeof a.timestampValue=="string"&&typeof i.timestampValue=="string"&&a.timestampValue.length===i.timestampValue.length)return a.timestampValue===i.timestampValue;const o=Bl(a.timestampValue),u=Bl(i.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,i){return Vl(a.bytesValue).isEqual(Vl(i.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,i){return Lr(a.geoPointValue.latitude)===Lr(i.geoPointValue.latitude)&&Lr(a.geoPointValue.longitude)===Lr(i.geoPointValue.longitude)})(t,e);case 2:return(function(a,i){if("integerValue"in a&&"integerValue"in i)return Lr(a.integerValue)===Lr(i.integerValue);if("doubleValue"in a&&"doubleValue"in i){const o=Lr(a.doubleValue),u=Lr(i.doubleValue);return o===u?um(o)===um(u):isNaN(o)&&isNaN(u)}return!1})(t,e);case 9:return gu(t.arrayValue.values||[],e.arrayValue.values||[],Ys);case 10:case 11:return(function(a,i){const o=a.mapValue.fields||{},u=i.mapValue.fields||{};if(sE(o)!==sE(u))return!1;for(const f in o)if(o.hasOwnProperty(f)&&(u[f]===void 0||!Ys(o[f],u[f])))return!1;return!0})(t,e);default:return ct(52216,{left:t})}}function d0(t,e){return(t.values||[]).find((r=>Ys(r,e)))!==void 0}function xu(t,e){if(t===e)return 0;const r=Ul(t),n=Ul(e);if(r!==n)return It(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return It(t.booleanValue,e.booleanValue);case 2:return(function(i,o){const u=Lr(i.integerValue||i.doubleValue),f=Lr(o.integerValue||o.doubleValue);return u<f?-1:u>f?1:u===f?0:isNaN(u)?isNaN(f)?0:-1:1})(t,e);case 3:return lE(t.timestampValue,e.timestampValue);case 4:return lE(f0(t),f0(e));case 5:return yx(t.stringValue,e.stringValue);case 6:return(function(i,o){const u=Vl(i),f=Vl(o);return u.compareTo(f)})(t.bytesValue,e.bytesValue);case 7:return(function(i,o){const u=i.split("/"),f=o.split("/");for(let d=0;d<u.length&&d<f.length;d++){const m=It(u[d],f[d]);if(m!==0)return m}return It(u.length,f.length)})(t.referenceValue,e.referenceValue);case 8:return(function(i,o){const u=It(Lr(i.latitude),Lr(o.latitude));return u!==0?u:It(Lr(i.longitude),Lr(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return oE(t.arrayValue,e.arrayValue);case 10:return(function(i,o){const u=i.fields||{},f=o.fields||{},d=u[hm]?.arrayValue,m=f[hm]?.arrayValue,x=It(d?.values?.length||0,m?.values?.length||0);return x!==0?x:oE(d,m)})(t.mapValue,e.mapValue);case 11:return(function(i,o){if(i===Nd.mapValue&&o===Nd.mapValue)return 0;if(i===Nd.mapValue)return 1;if(o===Nd.mapValue)return-1;const u=i.fields||{},f=Object.keys(u),d=o.fields||{},m=Object.keys(d);f.sort(),m.sort();for(let x=0;x<f.length&&x<m.length;++x){const y=yx(f[x],m[x]);if(y!==0)return y;const w=xu(u[f[x]],d[m[x]]);if(w!==0)return w}return It(f.length,m.length)})(t.mapValue,e.mapValue);default:throw ct(23264,{he:r})}}function lE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return It(t,e);const r=Bl(t),n=Bl(e),a=It(r.seconds,n.seconds);return a!==0?a:It(r.nanos,n.nanos)}function oE(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const i=xu(r[a],n[a]);if(i)return i}return It(r.length,n.length)}function vu(t){return _x(t)}function _x(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=Bl(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return Vl(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return at.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",a=!0;for(const i of r.values||[])a?a=!1:n+=",",n+=_x(i);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let a="{",i=!0;for(const o of n)i?i=!1:a+=",",a+=`${o}:${_x(r.fields[o])}`;return a+"}"})(t.mapValue):ct(61005,{value:t})}function Qd(t){switch(Ul(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Qm(t);return e?16+Qd(e):16;case 5:return 2*t.stringValue.length;case 6:return Vl(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,i)=>a+Qd(i)),0)})(t.arrayValue);case 10:case 11:return(function(n){let a=0;return Jl(n.fields,((i,o)=>{a+=i.length+Qd(o)})),a})(t.mapValue);default:throw ct(13486,{value:t})}}function cE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function wx(t){return!!t&&"integerValue"in t}function _v(t){return!!t&&"arrayValue"in t}function uE(t){return!!t&&"nullValue"in t}function fE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Jd(t){return!!t&&"mapValue"in t}function ID(t){return(t?.mapValue?.fields||{})[N4]?.stringValue===R4}function $f(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Jl(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=$f(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=$f(t.arrayValue.values[r]);return e}return{...t}}function DD(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===RD}class ca{constructor(e){this.value=e}static empty(){return new ca({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Jd(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=$f(r)}setAll(e){let r=An.emptyPath(),n={},a=[];e.forEach(((o,u)=>{if(!r.isImmediateParentOf(u)){const f=this.getFieldsMap(r);this.applyChanges(f,n,a),n={},a=[],r=u.popLast()}o?n[u.lastSegment()]=$f(o):a.push(u.lastSegment())}));const i=this.getFieldsMap(r);this.applyChanges(i,n,a)}delete(e){const r=this.field(e.popLast());Jd(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ys(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];Jd(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){Jl(r,((a,i)=>e[a]=i));for(const a of n)delete e[a]}clone(){return new ca($f(this.value))}}function I4(t){const e=[];return Jl(t.fields,((r,n)=>{const a=new An([r]);if(Jd(n)){const i=I4(n.mapValue).fields;if(i.length===0)e.push(a);else for(const o of i)e.push(a.child(o))}else e.push(a)})),new Ca(e)}class jn{constructor(e,r,n,a,i,o,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=i,this.data=o,this.documentState=u}static newInvalidDocument(e){return new jn(e,0,mt.min(),mt.min(),mt.min(),ca.empty(),0)}static newFoundDocument(e,r,n,a){return new jn(e,1,r,mt.min(),n,a,0)}static newNoDocument(e,r){return new jn(e,2,r,mt.min(),mt.min(),ca.empty(),0)}static newUnknownDocument(e,r){return new jn(e,3,r,mt.min(),mt.min(),ca.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(mt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ca.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ca.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=mt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof jn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new jn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class dm{constructor(e,r){this.position=e,this.inclusive=r}}function hE(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const i=e[a],o=t.position[a];if(i.field.isKeyField()?n=at.comparator(at.fromName(o.referenceValue),r.key):n=xu(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function dE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ys(t.position[r],e.position[r]))return!1;return!0}class m0{constructor(e,r="asc"){this.field=e,this.dir=r}}function OD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class D4{}class tn extends D4{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new MD(e,r,n):r==="array-contains"?new LD(e,n):r==="in"?new BD(e,n):r==="not-in"?new VD(e,n):r==="array-contains-any"?new UD(e,n):new tn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new PD(e,n):new jD(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(xu(r,this.value)):r!==null&&Ul(this.value)===Ul(r)&&this.matchesComparison(xu(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ct(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Es extends D4{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Es(e,r)}matches(e){return O4(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function O4(t){return t.op==="and"}function F4(t){return FD(t)&&O4(t)}function FD(t){for(const e of t.filters)if(e instanceof Es)return!1;return!0}function bx(t){if(t instanceof tn)return t.field.canonicalString()+t.op.toString()+vu(t.value);if(F4(t))return t.filters.map((e=>bx(e))).join(",");{const e=t.filters.map((r=>bx(r))).join(",");return`${t.op}(${e})`}}function M4(t,e){return t instanceof tn?(function(n,a){return a instanceof tn&&n.op===a.op&&n.field.isEqual(a.field)&&Ys(n.value,a.value)})(t,e):t instanceof Es?(function(n,a){return a instanceof Es&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((i,o,u)=>i&&M4(o,a.filters[u])),!0):!1})(t,e):void ct(19439)}function P4(t){return t instanceof tn?(function(r){return`${r.field.canonicalString()} ${r.op} ${vu(r.value)}`})(t):t instanceof Es?(function(r){return r.op.toString()+" {"+r.getFilters().map(P4).join(" ,")+"}"})(t):"Filter"}class MD extends tn{constructor(e,r,n){super(e,r,n),this.key=at.fromName(n.referenceValue)}matches(e){const r=at.comparator(e.key,this.key);return this.matchesComparison(r)}}class PD extends tn{constructor(e,r){super(e,"in",r),this.keys=j4("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class jD extends tn{constructor(e,r){super(e,"not-in",r),this.keys=j4("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function j4(t,e){return(e.arrayValue?.values||[]).map((r=>at.fromName(r.referenceValue)))}class LD extends tn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return _v(r)&&d0(r.arrayValue,this.value)}}class BD extends tn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&d0(this.value.arrayValue,r)}}class VD extends tn{constructor(e,r){super(e,"not-in",r)}matches(e){if(d0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!d0(this.value.arrayValue,r)}}class UD extends tn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!_v(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>d0(this.value.arrayValue,n)))}}class zD{constructor(e,r=null,n=[],a=[],i=null,o=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=i,this.startAt=o,this.endAt=u,this.Te=null}}function mE(t,e=null,r=[],n=[],a=null,i=null,o=null){return new zD(t,e,r,n,a,i,o)}function wv(t){const e=gt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>bx(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(i){return i.field.canonicalString()+i.dir})(n))).join(","),Km(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>vu(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>vu(n))).join(",")),e.Te=r}return e.Te}function bv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!OD(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!M4(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!dE(t.startAt,e.startAt)&&dE(t.endAt,e.endAt)}function Ex(t){return at.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Ou{constructor(e,r=null,n=[],a=[],i=null,o="F",u=null,f=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=i,this.limitType=o,this.startAt=u,this.endAt=f,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function HD(t,e,r,n,a,i,o,u){return new Ou(t,e,r,n,a,i,o,u)}function Ev(t){return new Ou(t)}function pE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function L4(t){return t.collectionGroup!==null}function Kf(t){const e=gt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new on(An.comparator);return o.filters.forEach((f=>{f.getFlattenedFilters().forEach((d=>{d.isInequality()&&(u=u.add(d.field))}))})),u})(e).forEach((i=>{r.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new m0(i,n))})),r.has(An.keyField().canonicalString())||e.Ie.push(new m0(An.keyField(),n))}return e.Ie}function Us(t){const e=gt(t);return e.Ee||(e.Ee=GD(e,Kf(t))),e.Ee}function GD(t,e){if(t.limitType==="F")return mE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const i=a.dir==="desc"?"asc":"desc";return new m0(a.field,i)}));const r=t.endAt?new dm(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new dm(t.startAt.position,t.startAt.inclusive):null;return mE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Tx(t,e){const r=t.filters.concat([e]);return new Ou(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Sx(t,e,r){return new Ou(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Jm(t,e){return bv(Us(t),Us(e))&&t.limitType===e.limitType}function B4(t){return`${wv(Us(t))}|lt:${t.limitType}`}function Zc(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((a=>P4(a))).join(", ")}]`),Km(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((a=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(a))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((a=>vu(a))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((a=>vu(a))).join(",")),`Target(${n})`})(Us(t))}; limitType=${t.limitType})`}function Zm(t,e){return e.isFoundDocument()&&(function(n,a){const i=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):at.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)})(t,e)&&(function(n,a){for(const i of Kf(n))if(!i.field.isKeyField()&&a.data.field(i.field)===null)return!1;return!0})(t,e)&&(function(n,a){for(const i of n.filters)if(!i.matches(a))return!1;return!0})(t,e)&&(function(n,a){return!(n.startAt&&!(function(o,u,f){const d=hE(o,u,f);return o.inclusive?d<=0:d<0})(n.startAt,Kf(n),a)||n.endAt&&!(function(o,u,f){const d=hE(o,u,f);return o.inclusive?d>=0:d>0})(n.endAt,Kf(n),a))})(t,e)}function qD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function V4(t){return(e,r)=>{let n=!1;for(const a of Kf(t)){const i=WD(a,e,r);if(i!==0)return i;n=n||a.field.isKeyField()}return 0}}function WD(t,e,r){const n=t.field.isKeyField()?at.comparator(e.key,r.key):(function(i,o,u){const f=o.data.field(i),d=u.data.field(i);return f!==null&&d!==null?xu(f,d):ct(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return ct(19790,{direction:t.dir})}}class tc{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,i]of n)if(this.equalsFn(a,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<a.length;i++)if(this.equalsFn(a[i][0],e))return void(a[i]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Jl(this.inner,((r,n)=>{for(const[a,i]of n)e(a,i)}))}isEmpty(){return E4(this.inner)}size(){return this.innerSize}}const XD=new Ar(at.comparator);function Oi(){return XD}const U4=new Ar(at.comparator);function zf(...t){let e=U4;for(const r of t)e=e.insert(r.key,r);return e}function z4(t){let e=U4;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function Fo(){return Qf()}function H4(){return Qf()}function Qf(){return new tc((t=>t.toString()),((t,e)=>t.isEqual(e)))}const YD=new Ar(at.comparator),$D=new on(at.comparator);function Dt(...t){let e=$D;for(const r of t)e=e.add(r);return e}const KD=new on(It);function QD(){return KD}function Tv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:um(e)?"-0":e}}function G4(t){return{integerValue:""+t}}function JD(t,e){return SD(e)?G4(e):Tv(t,e)}class ep{constructor(){this._=void 0}}function ZD(t,e,r){return t instanceof mm?(function(a,i){const o={fields:{[A4]:{stringValue:S4},[C4]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return i&&yv(i)&&(i=Qm(i)),i&&(o.fields[k4]=i),{mapValue:o}})(r,e):t instanceof p0?W4(t,e):t instanceof g0?X4(t,e):(function(a,i){const o=q4(a,i),u=gE(o)+gE(a.Ae);return wx(o)&&wx(a.Ae)?G4(u):Tv(a.serializer,u)})(t,e)}function e8(t,e,r){return t instanceof p0?W4(t,e):t instanceof g0?X4(t,e):r}function q4(t,e){return t instanceof pm?(function(n){return wx(n)||(function(i){return!!i&&"doubleValue"in i})(n)})(e)?e:{integerValue:0}:null}class mm extends ep{}class p0 extends ep{constructor(e){super(),this.elements=e}}function W4(t,e){const r=Y4(e);for(const n of t.elements)r.some((a=>Ys(a,n)))||r.push(n);return{arrayValue:{values:r}}}class g0 extends ep{constructor(e){super(),this.elements=e}}function X4(t,e){let r=Y4(e);for(const n of t.elements)r=r.filter((a=>!Ys(a,n)));return{arrayValue:{values:r}}}class pm extends ep{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function gE(t){return Lr(t.integerValue||t.doubleValue)}function Y4(t){return _v(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function t8(t,e){return t.field.isEqual(e.field)&&(function(n,a){return n instanceof p0&&a instanceof p0||n instanceof g0&&a instanceof g0?gu(n.elements,a.elements,Ys):n instanceof pm&&a instanceof pm?Ys(n.Ae,a.Ae):n instanceof mm&&a instanceof mm})(t.transform,e.transform)}class r8{constructor(e,r){this.version=e,this.transformResults=r}}class Jn{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Jn}static exists(e){return new Jn(void 0,e)}static updateTime(e){return new Jn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Zd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class tp{}function $4(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new rp(t.key,Jn.none()):new L0(t.key,t.data,Jn.none());{const r=t.data,n=ca.empty();let a=new on(An.comparator);for(let i of e.fields)if(!a.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),a=a.add(i)}return new Zl(t.key,n,new Ca(a.toArray()),Jn.none())}}function n8(t,e,r){t instanceof L0?(function(a,i,o){const u=a.value.clone(),f=vE(a.fieldTransforms,i,o.transformResults);u.setAll(f),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(t,e,r):t instanceof Zl?(function(a,i,o){if(!Zd(a.precondition,i))return void i.convertToUnknownDocument(o.version);const u=vE(a.fieldTransforms,i,o.transformResults),f=i.data;f.setAll(K4(a)),f.setAll(u),i.convertToFoundDocument(o.version,f).setHasCommittedMutations()})(t,e,r):(function(a,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,r)}function Jf(t,e,r,n){return t instanceof L0?(function(i,o,u,f){if(!Zd(i.precondition,o))return u;const d=i.value.clone(),m=yE(i.fieldTransforms,f,o);return d.setAll(m),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(t,e,r,n):t instanceof Zl?(function(i,o,u,f){if(!Zd(i.precondition,o))return u;const d=yE(i.fieldTransforms,f,o),m=o.data;return m.setAll(K4(i)),m.setAll(d),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),u===null?null:u.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((x=>x.field)))})(t,e,r,n):(function(i,o,u){return Zd(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u})(t,e,r)}function a8(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),i=q4(n.transform,a||null);i!=null&&(r===null&&(r=ca.empty()),r.set(n.field,i))}return r||null}function xE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&gu(n,a,((i,o)=>t8(i,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class L0 extends tp{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Zl extends tp{constructor(e,r,n,a,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function K4(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function vE(t,e,r){const n=new Map;Wt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let a=0;a<r.length;a++){const i=t[a],o=i.transform,u=e.data.field(i.field);n.set(i.field,e8(o,u,r[a]))}return n}function yE(t,e,r){const n=new Map;for(const a of t){const i=a.transform,o=r.data.field(a.field);n.set(a.field,ZD(i,o,e))}return n}class rp extends tp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class s8 extends tp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class i8{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const i=this.mutations[a];i.key.isEqual(e.key)&&n8(i,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Jf(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Jf(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=H4();return this.mutations.forEach((a=>{const i=e.get(a.key),o=i.overlayedDocument;let u=this.applyToLocalView(o,i.mutatedFields);u=r.has(a.key)?null:u;const f=$4(o,u);f!==null&&n.set(a.key,f),o.isValidDocument()||o.convertToNoDocument(mt.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Dt())}isEqual(e){return this.batchId===e.batchId&&gu(this.mutations,e.mutations,((r,n)=>xE(r,n)))&&gu(this.baseMutations,e.baseMutations,((r,n)=>xE(r,n)))}}class Sv{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Wt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return YD})();const i=e.mutations;for(let o=0;o<i.length;o++)a=a.insert(i[o].key,n[o].version);return new Sv(e,r,n,a)}}class l8{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class o8{constructor(e,r){this.count=e,this.unchangedNames=r}}var Jr,Pt;function c8(t){switch(t){case Ie.OK:return ct(64938);case Ie.CANCELLED:case Ie.UNKNOWN:case Ie.DEADLINE_EXCEEDED:case Ie.RESOURCE_EXHAUSTED:case Ie.INTERNAL:case Ie.UNAVAILABLE:case Ie.UNAUTHENTICATED:return!1;case Ie.INVALID_ARGUMENT:case Ie.NOT_FOUND:case Ie.ALREADY_EXISTS:case Ie.PERMISSION_DENIED:case Ie.FAILED_PRECONDITION:case Ie.ABORTED:case Ie.OUT_OF_RANGE:case Ie.UNIMPLEMENTED:case Ie.DATA_LOSS:return!0;default:return ct(15467,{code:t})}}function Q4(t){if(t===void 0)return Di("GRPC error has no .code"),Ie.UNKNOWN;switch(t){case Jr.OK:return Ie.OK;case Jr.CANCELLED:return Ie.CANCELLED;case Jr.UNKNOWN:return Ie.UNKNOWN;case Jr.DEADLINE_EXCEEDED:return Ie.DEADLINE_EXCEEDED;case Jr.RESOURCE_EXHAUSTED:return Ie.RESOURCE_EXHAUSTED;case Jr.INTERNAL:return Ie.INTERNAL;case Jr.UNAVAILABLE:return Ie.UNAVAILABLE;case Jr.UNAUTHENTICATED:return Ie.UNAUTHENTICATED;case Jr.INVALID_ARGUMENT:return Ie.INVALID_ARGUMENT;case Jr.NOT_FOUND:return Ie.NOT_FOUND;case Jr.ALREADY_EXISTS:return Ie.ALREADY_EXISTS;case Jr.PERMISSION_DENIED:return Ie.PERMISSION_DENIED;case Jr.FAILED_PRECONDITION:return Ie.FAILED_PRECONDITION;case Jr.ABORTED:return Ie.ABORTED;case Jr.OUT_OF_RANGE:return Ie.OUT_OF_RANGE;case Jr.UNIMPLEMENTED:return Ie.UNIMPLEMENTED;case Jr.DATA_LOSS:return Ie.DATA_LOSS;default:return ct(39323,{code:t})}}(Pt=Jr||(Jr={}))[Pt.OK=0]="OK",Pt[Pt.CANCELLED=1]="CANCELLED",Pt[Pt.UNKNOWN=2]="UNKNOWN",Pt[Pt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Pt[Pt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Pt[Pt.NOT_FOUND=5]="NOT_FOUND",Pt[Pt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Pt[Pt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Pt[Pt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Pt[Pt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Pt[Pt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Pt[Pt.ABORTED=10]="ABORTED",Pt[Pt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Pt[Pt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Pt[Pt.INTERNAL=13]="INTERNAL",Pt[Pt.UNAVAILABLE=14]="UNAVAILABLE",Pt[Pt.DATA_LOSS=15]="DATA_LOSS";function u8(){return new TextEncoder}const f8=new Ol([4294967295,4294967295],0);function _E(t){const e=u8().encode(t),r=new h4;return r.update(e),new Uint8Array(r.digest())}function wE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ol([r,n],0),new Ol([a,i],0)]}class Av{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Hf(`Invalid padding: ${r}`);if(n<0)throw new Hf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Hf(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Hf(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Ol.fromNumber(this.ge)}ye(e,r,n){let a=e.add(r.multiply(Ol.fromNumber(n)));return a.compare(f8)===1&&(a=new Ol([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=_E(e),[n,a]=wE(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,a,i);if(!this.we(o))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Av(i,a,r);return n.forEach((u=>o.insert(u))),o}insert(e){if(this.ge===0)return;const r=_E(e),[n,a]=wE(r);for(let i=0;i<this.hashCount;i++){const o=this.ye(n,a,i);this.Se(o)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Hf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class np{constructor(e,r,n,a,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,B0.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new np(mt.min(),a,new Ar(It),Oi(),Dt())}}class B0{constructor(e,r,n,a,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new B0(n,r,Dt(),Dt(),Dt())}}class em{constructor(e,r,n,a){this.be=e,this.removedTargetIds=r,this.key=n,this.De=a}}class J4{constructor(e,r){this.targetId=e,this.Ce=r}}class Z4{constructor(e,r,n=Cn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class bE{constructor(){this.ve=0,this.Fe=EE(),this.Me=Cn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Dt(),r=Dt(),n=Dt();return this.Fe.forEach(((a,i)=>{switch(i){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:ct(38017,{changeType:i})}})),new B0(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=EE()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Wt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class h8{constructor(e){this.Ge=e,this.ze=new Map,this.je=Oi(),this.Je=Rd(),this.He=Rd(),this.Ye=new Ar(It)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:ct(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,a)=>{this.rt(a)&&r(a)}))}st(e){const r=e.targetId,n=e.Ce.count,a=this.ot(r);if(a){const i=a.target;if(Ex(i))if(n===0){const o=new at(i.path);this.et(r,o,jn.newNoDocument(o,mt.min()))}else Wt(n===1,20013,{expectedCount:n});else{const o=this._t(r);if(o!==n){const u=this.ut(e),f=u?this.ct(u,e,o):1;if(f!==0){this.it(r);const d=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,d)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:i=0}=r;let o,u;try{o=Vl(n).toUint8Array()}catch(f){if(f instanceof T4)return pu("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{u=new Av(o,a,i)}catch(f){return pu(f instanceof Hf?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return u.ge===0?null:u}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let a=0;return n.forEach((i=>{const o=this.Ge.ht(),u=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(u)||(this.et(r,i,null),a++)})),a}Tt(e){const r=new Map;this.ze.forEach(((i,o)=>{const u=this.ot(o);if(u){if(i.current&&Ex(u.target)){const f=new at(u.target.path);this.It(f).has(o)||this.Et(o,f)||this.et(o,f,jn.newNoDocument(f,e))}i.Be&&(r.set(o,i.ke()),i.qe())}}));let n=Dt();this.He.forEach(((i,o)=>{let u=!0;o.forEachWhile((f=>{const d=this.ot(f);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const a=new np(e,r,this.Ye,this.je,n);return this.je=Oi(),this.Je=Rd(),this.He=Rd(),this.Ye=new Ar(It),a}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,r)?a.Qe(r,1):a.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new bE,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new on(It),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new on(It),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||Qe("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new bE),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function Rd(){return new Ar(at.comparator)}function EE(){return new Ar(at.comparator)}const d8={asc:"ASCENDING",desc:"DESCENDING"},m8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},p8={and:"AND",or:"OR"};class g8{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Ax(t,e){return t.useProto3Json||Km(e)?e:{value:e}}function gm(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function eA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function x8(t,e){return gm(t,e.toTimestamp())}function zs(t){return Wt(!!t,49232),mt.fromTimestamp((function(r){const n=Bl(r);return new xr(n.seconds,n.nanos)})(t))}function kv(t,e){return kx(t,e).canonicalString()}function kx(t,e){const r=(function(a){return new hr(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?r:r.child(e)}function tA(t){const e=hr.fromString(t);return Wt(iA(e),10190,{key:e.toString()}),e}function Cx(t,e){return kv(t.databaseId,e.path)}function B1(t,e){const r=tA(e);if(r.get(1)!==t.databaseId.projectId)throw new $e(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new $e(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new at(nA(r))}function rA(t,e){return kv(t.databaseId,e)}function v8(t){const e=tA(t);return e.length===4?hr.emptyPath():nA(e)}function Nx(t){return new hr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function nA(t){return Wt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function TE(t,e,r){return{name:Cx(t,e),fields:r.value.mapValue.fields}}function y8(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:ct(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],i=(function(d,m){return d.useProto3Json?(Wt(m===void 0||typeof m=="string",58123),Cn.fromBase64String(m||"")):(Wt(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Cn.fromUint8Array(m||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&(function(d){const m=d.code===void 0?Ie.UNKNOWN:Q4(d.code);return new $e(m,d.message||"")})(o);r=new Z4(n,a,i,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=B1(t,n.document.name),i=zs(n.document.updateTime),o=n.document.createTime?zs(n.document.createTime):mt.min(),u=new ca({mapValue:{fields:n.document.fields}}),f=jn.newFoundDocument(a,i,o,u),d=n.targetIds||[],m=n.removedTargetIds||[];r=new em(d,m,f.key,f)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=B1(t,n.document),i=n.readTime?zs(n.readTime):mt.min(),o=jn.newNoDocument(a,i),u=n.removedTargetIds||[];r=new em([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=B1(t,n.document),i=n.removedTargetIds||[];r=new em([],i,a,null)}else{if(!("filter"in e))return ct(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:i}=n,o=new o8(a,i),u=n.targetId;r=new J4(u,o)}}return r}function _8(t,e){let r;if(e instanceof L0)r={update:TE(t,e.key,e.value)};else if(e instanceof rp)r={delete:Cx(t,e.key)};else if(e instanceof Zl)r={update:TE(t,e.key,e.data),updateMask:N8(e.fieldMask)};else{if(!(e instanceof s8))return ct(16599,{Vt:e.type});r={verify:Cx(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(i,o){const u=o.transform;if(u instanceof mm)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof p0)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof g0)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof pm)return{fieldPath:o.field.canonicalString(),increment:u.Ae};throw ct(20930,{transform:o.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(a,i){return i.updateTime!==void 0?{updateTime:x8(a,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:ct(27497)})(t,e.precondition)),r}function w8(t,e){return t&&t.length>0?(Wt(e!==void 0,14353),t.map((r=>(function(a,i){let o=a.updateTime?zs(a.updateTime):zs(i);return o.isEqual(mt.min())&&(o=zs(i)),new r8(o,a.transformResults||[])})(r,e)))):[]}function b8(t,e){return{documents:[rA(t,e.path)]}}function E8(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=rA(t,a);const i=(function(d){if(d.length!==0)return sA(Es.create(d,"and"))})(e.filters);i&&(r.structuredQuery.where=i);const o=(function(d){if(d.length!==0)return d.map((m=>(function(y){return{field:eu(y.field),direction:A8(y.dir)}})(m)))})(e.orderBy);o&&(r.structuredQuery.orderBy=o);const u=Ax(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:r,parent:a}}function T8(t){let e=v8(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Wt(n===1,65062);const m=r.from[0];m.allDescendants?a=m.collectionId:e=e.child(m.collectionId)}let i=[];r.where&&(i=(function(x){const y=aA(x);return y instanceof Es&&F4(y)?y.getFilters():[y]})(r.where));let o=[];r.orderBy&&(o=(function(x){return x.map((y=>(function(E){return new m0(tu(E.field),(function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(E.direction))})(y)))})(r.orderBy));let u=null;r.limit&&(u=(function(x){let y;return y=typeof x=="object"?x.value:x,Km(y)?null:y})(r.limit));let f=null;r.startAt&&(f=(function(x){const y=!!x.before,w=x.values||[];return new dm(w,y)})(r.startAt));let d=null;return r.endAt&&(d=(function(x){const y=!x.before,w=x.values||[];return new dm(w,y)})(r.endAt)),HD(e,a,o,i,u,"F",f,d)}function S8(t,e){const r=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ct(28987,{purpose:a})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function aA(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=tu(r.unaryFilter.field);return tn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=tu(r.unaryFilter.field);return tn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=tu(r.unaryFilter.field);return tn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=tu(r.unaryFilter.field);return tn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ct(61313);default:return ct(60726)}})(t):t.fieldFilter!==void 0?(function(r){return tn.create(tu(r.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ct(58110);default:return ct(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return Es.create(r.compositeFilter.filters.map((n=>aA(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return ct(1026)}})(r.compositeFilter.op))})(t):ct(30097,{filter:t})}function A8(t){return d8[t]}function k8(t){return m8[t]}function C8(t){return p8[t]}function eu(t){return{fieldPath:t.canonicalString()}}function tu(t){return An.fromServerFormat(t.fieldPath)}function sA(t){return t instanceof tn?(function(r){if(r.op==="=="){if(fE(r.value))return{unaryFilter:{field:eu(r.field),op:"IS_NAN"}};if(uE(r.value))return{unaryFilter:{field:eu(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(fE(r.value))return{unaryFilter:{field:eu(r.field),op:"IS_NOT_NAN"}};if(uE(r.value))return{unaryFilter:{field:eu(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:eu(r.field),op:k8(r.op),value:r.value}}})(t):t instanceof Es?(function(r){const n=r.getFilters().map((a=>sA(a)));return n.length===1?n[0]:{compositeFilter:{op:C8(r.op),filters:n}}})(t):ct(54877,{filter:t})}function N8(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function iA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class kl{constructor(e,r,n,a,i=mt.min(),o=mt.min(),u=Cn.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=f}withSequenceNumber(e){return new kl(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new kl(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new kl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new kl(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class R8{constructor(e){this.yt=e}}function I8(t){const e=T8({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Sx(e,e.limit,"L"):e}class D8{constructor(){this.Cn=new O8}addToCollectionParentIndex(e,r){return this.Cn.add(r),Oe.resolve()}getCollectionParents(e,r){return Oe.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return Oe.resolve()}deleteFieldIndex(e,r){return Oe.resolve()}deleteAllFieldIndexes(e){return Oe.resolve()}createTargetIndexes(e,r){return Oe.resolve()}getDocumentsMatchingTarget(e,r){return Oe.resolve(null)}getIndexType(e,r){return Oe.resolve(0)}getFieldIndexes(e,r){return Oe.resolve([])}getNextCollectionGroupToUpdate(e){return Oe.resolve(null)}getMinOffset(e,r){return Oe.resolve(Ll.min())}getMinOffsetFromCollectionGroup(e,r){return Oe.resolve(Ll.min())}updateCollectionGroup(e,r,n){return Oe.resolve()}updateIndexEntries(e,r){return Oe.resolve()}}class O8{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new on(hr.comparator),i=!a.has(n);return this.index[r]=a.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new on(hr.comparator)).toArray()}}const SE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lA=41943040;class oa{static withCacheSize(e){return new oa(e,oa.DEFAULT_COLLECTION_PERCENTILE,oa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}oa.DEFAULT_COLLECTION_PERCENTILE=10,oa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oa.DEFAULT=new oa(lA,oa.DEFAULT_COLLECTION_PERCENTILE,oa.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oa.DISABLED=new oa(-1,0,0);class yu{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new yu(0)}static cr(){return new yu(-1)}}const AE="LruGarbageCollector",F8=1048576;function kE([t,e],[r,n]){const a=It(t,r);return a===0?It(e,n):a}class M8{constructor(e){this.Ir=e,this.buffer=new on(kE),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();kE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class P8{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Qe(AE,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Du(r)?Qe(AE,"Ignoring IndexedDB error during garbage collection: ",r):await Iu(r)}await this.Vr(3e5)}))}}class j8{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return Oe.resolve($m.ce);const n=new M8(r);return this.mr.forEachTarget(e,(a=>n.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>n.Ar(a))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Qe("LruGarbageCollector","Garbage collection skipped; disabled"),Oe.resolve(SE)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Qe("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),SE):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,a,i,o,u,f,d;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((x=>(x>this.params.maximumSequenceNumbersToCollect?(Qe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${x}`),a=this.params.maximumSequenceNumbersToCollect):a=x,o=Date.now(),this.nthSequenceNumber(e,a)))).next((x=>(n=x,u=Date.now(),this.removeTargets(e,n,r)))).next((x=>(i=x,f=Date.now(),this.removeOrphanedDocuments(e,n)))).next((x=>(d=Date.now(),Jc()<=Rt.DEBUG&&Qe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${a} in `+(u-o)+`ms
	Removed ${i} targets in `+(f-u)+`ms
	Removed ${x} documents in `+(d-f)+`ms
Total Duration: ${d-m}ms`),Oe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:i,documentsRemoved:x}))))}}function L8(t,e){return new j8(t,e)}class B8{constructor(){this.changes=new tc((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,jn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Oe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class V8{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}class U8{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,r)))).next((a=>(n!==null&&Jf(n.mutation,a,Ca.empty(),xr.now()),a)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Dt()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Dt()){const a=Fo();return this.populateOverlays(e,a,r).next((()=>this.computeViews(e,r,a,n).next((i=>{let o=zf();return i.forEach(((u,f)=>{o=o.insert(u,f.overlayedDocument)})),o}))))}getOverlayedDocuments(e,r){const n=Fo();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Dt())))}populateOverlays(e,r,n){const a=[];return n.forEach((i=>{r.has(i)||a.push(i)})),this.documentOverlayCache.getOverlays(e,a).next((i=>{i.forEach(((o,u)=>{r.set(o,u)}))}))}computeViews(e,r,n,a){let i=Oi();const o=Qf(),u=(function(){return Qf()})();return r.forEach(((f,d)=>{const m=n.get(d.key);a.has(d.key)&&(m===void 0||m.mutation instanceof Zl)?i=i.insert(d.key,d):m!==void 0?(o.set(d.key,m.mutation.getFieldMask()),Jf(m.mutation,d,m.mutation.getFieldMask(),xr.now())):o.set(d.key,Ca.empty())})),this.recalculateAndSaveOverlays(e,i).next((f=>(f.forEach(((d,m)=>o.set(d,m))),r.forEach(((d,m)=>u.set(d,new V8(m,o.get(d)??null)))),u)))}recalculateAndSaveOverlays(e,r){const n=Qf();let a=new Ar(((o,u)=>o-u)),i=Dt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((o=>{for(const u of o)u.keys().forEach((f=>{const d=r.get(f);if(d===null)return;let m=n.get(f)||Ca.empty();m=u.applyToLocalView(d,m),n.set(f,m);const x=(a.get(u.batchId)||Dt()).add(f);a=a.insert(u.batchId,x)}))})).next((()=>{const o=[],u=a.getReverseIterator();for(;u.hasNext();){const f=u.getNext(),d=f.key,m=f.value,x=H4();m.forEach((y=>{if(!i.has(y)){const w=$4(r.get(y),n.get(y));w!==null&&x.set(y,w),i=i.add(y)}})),o.push(this.documentOverlayCache.saveOverlays(e,d,x))}return Oe.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,a){return(function(o){return at.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):L4(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next((i=>{const o=a-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-i.size):Oe.resolve(Fo());let u=u0,f=i;return o.next((d=>Oe.forEach(d,((m,x)=>(u<x.largestBatchId&&(u=x.largestBatchId),i.get(m)?Oe.resolve():this.remoteDocumentCache.getEntry(e,m).next((y=>{f=f.insert(m,y)}))))).next((()=>this.populateOverlays(e,d,i))).next((()=>this.computeViews(e,f,d,Dt()))).next((m=>({batchId:u,changes:z4(m)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new at(r)).next((n=>{let a=zf();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const i=r.collectionGroup;let o=zf();return this.indexManager.getCollectionParents(e,i).next((u=>Oe.forEach(u,(f=>{const d=(function(x,y){return new Ou(y,null,x.explicitOrderBy.slice(),x.filters.slice(),x.limit,x.limitType,x.startAt,x.endAt)})(r,f.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next((m=>{m.forEach(((x,y)=>{o=o.insert(x,y)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,r,n,a){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,a)))).next((o=>{i.forEach(((f,d)=>{const m=d.getKey();o.get(m)===null&&(o=o.insert(m,jn.newInvalidDocument(m)))}));let u=zf();return o.forEach(((f,d)=>{const m=i.get(f);m!==void 0&&Jf(m.mutation,d,Ca.empty(),xr.now()),Zm(r,d)&&(u=u.insert(f,d))})),u}))}}class z8{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return Oe.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(a){return{id:a.id,version:a.version,createTime:zs(a.createTime)}})(r)),Oe.resolve()}getNamedQuery(e,r){return Oe.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(a){return{name:a.name,query:I8(a.bundledQuery),readTime:zs(a.readTime)}})(r)),Oe.resolve()}}class H8{constructor(){this.overlays=new Ar(at.comparator),this.qr=new Map}getOverlay(e,r){return Oe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Fo();return Oe.forEach(r,(a=>this.getOverlay(e,a).next((i=>{i!==null&&n.set(a,i)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((a,i)=>{this.St(e,r,i)})),Oe.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.qr.get(n);return a!==void 0&&(a.forEach((i=>this.overlays=this.overlays.remove(i))),this.qr.delete(n)),Oe.resolve()}getOverlaysForCollection(e,r,n){const a=Fo(),i=r.length+1,o=new at(r.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){const f=u.getNext().value,d=f.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===i&&f.largestBatchId>n&&a.set(f.getKey(),f)}return Oe.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let i=new Ar(((d,m)=>d-m));const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let m=i.get(d.largestBatchId);m===null&&(m=Fo(),i=i.insert(d.largestBatchId,m)),m.set(d.getKey(),d)}}const u=Fo(),f=i.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((d,m)=>u.set(d,m))),!(u.size()>=a)););return Oe.resolve(u)}St(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const o=this.qr.get(a.largestBatchId).delete(n.key);this.qr.set(a.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new l8(r,n));let i=this.qr.get(r);i===void 0&&(i=Dt(),this.qr.set(r,i)),this.qr.set(r,i.add(n.key))}}class G8{constructor(){this.sessionToken=Cn.EMPTY_BYTE_STRING}getSessionToken(e){return Oe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Oe.resolve()}}class Cv{constructor(){this.Qr=new on(dn.$r),this.Ur=new on(dn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new dn(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new dn(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new at(new hr([])),n=new dn(r,e),a=new dn(r,e+1),i=[];return this.Ur.forEachInRange([n,a],(o=>{this.Gr(o),i.push(o.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new at(new hr([])),n=new dn(r,e),a=new dn(r,e+1);let i=Dt();return this.Ur.forEachInRange([n,a],(o=>{i=i.add(o.key)})),i}containsKey(e){const r=new dn(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class dn{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return at.comparator(e.key,r.key)||It(e.Yr,r.Yr)}static Kr(e,r){return It(e.Yr,r.Yr)||at.comparator(e.key,r.key)}}class q8{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new on(dn.$r)}checkEmpty(e){return Oe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new i8(i,r,n,a);this.mutationQueue.push(o);for(const u of a)this.Zr=this.Zr.add(new dn(u.key,i)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return Oe.resolve(o)}lookupMutationBatch(e,r){return Oe.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.ei(n),i=a<0?0:a;return Oe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Oe.resolve(this.mutationQueue.length===0?vv:this.tr-1)}getAllMutationBatches(e){return Oe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new dn(r,0),a=new dn(r,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,a],(o=>{const u=this.Xr(o.Yr);i.push(u)})),Oe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new on(It);return r.forEach((a=>{const i=new dn(a,0),o=new dn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],(u=>{n=n.add(u.Yr)}))})),Oe.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let i=n;at.isDocumentKey(i)||(i=i.child(""));const o=new dn(new at(i),0);let u=new on(It);return this.Zr.forEachWhile((f=>{const d=f.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(u=u.add(f.Yr)),!0)}),o),Oe.resolve(this.ti(u))}ti(e){const r=[];return e.forEach((n=>{const a=this.Xr(n);a!==null&&r.push(a)})),r}removeMutationBatch(e,r){Wt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return Oe.forEach(r.mutations,(a=>{const i=new dn(a.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new dn(r,0),a=this.Zr.firstAfterOrEqual(n);return Oe.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Oe.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}class W8{constructor(e){this.ri=e,this.docs=(function(){return new Ar(at.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),i=a?a.size:0,o=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Oe.resolve(n?n.document.mutableCopy():jn.newInvalidDocument(r))}getEntries(e,r){let n=Oi();return r.forEach((a=>{const i=this.docs.get(a);n=n.insert(a,i?i.document.mutableCopy():jn.newInvalidDocument(a))})),Oe.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let i=Oi();const o=r.path,u=new at(o.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(u);for(;f.hasNext();){const{key:d,value:{document:m}}=f.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||wD(_D(m),n)<=0||(a.has(m.key)||Zm(r,m))&&(i=i.insert(m.key,m.mutableCopy()))}return Oe.resolve(i)}getAllFromCollectionGroup(e,r,n,a){ct(9500)}ii(e,r){return Oe.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new X8(this)}getSize(e){return Oe.resolve(this.size)}}class X8 extends B8{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?r.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(n)})),Oe.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}class Y8{constructor(e){this.persistence=e,this.si=new tc((r=>wv(r)),bv),this.lastRemoteSnapshotVersion=mt.min(),this.highestTargetId=0,this.oi=0,this._i=new Cv,this.targetCount=0,this.ai=yu.ur()}forEachTarget(e,r){return this.si.forEach(((n,a)=>r(a))),Oe.resolve()}getLastRemoteSnapshotVersion(e){return Oe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Oe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Oe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),Oe.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new yu(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,Oe.resolve()}updateTargetData(e,r){return this.Pr(r),Oe.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,Oe.resolve()}removeTargets(e,r,n){let a=0;const i=[];return this.si.forEach(((o,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)})),Oe.waitFor(i).next((()=>a))}getTargetCount(e){return Oe.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return Oe.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),Oe.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const a=this.persistence.referenceDelegate,i=[];return a&&r.forEach((o=>{i.push(a.markPotentiallyOrphaned(e,o))})),Oe.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),Oe.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return Oe.resolve(n)}containsKey(e,r){return Oe.resolve(this._i.containsKey(r))}}class oA{constructor(e,r){this.ui={},this.overlays={},this.ci=new $m(0),this.li=!1,this.li=!0,this.hi=new G8,this.referenceDelegate=e(this),this.Pi=new Y8(this),this.indexManager=new D8,this.remoteDocumentCache=(function(a){return new W8(a)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new R8(r),this.Ii=new z8(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new H8,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new q8(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){Qe("MemoryPersistence","Starting transaction:",e);const a=new $8(this.ci.next());return this.referenceDelegate.Ei(),n(a).next((i=>this.referenceDelegate.di(a).next((()=>i)))).toPromise().then((i=>(a.raiseOnCommittedEvent(),i)))}Ai(e,r){return Oe.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class $8 extends ED{constructor(e){super(),this.currentSequenceNumber=e}}class Nv{constructor(e){this.persistence=e,this.Ri=new Cv,this.Vi=null}static mi(e){return new Nv(e)}get fi(){if(this.Vi)return this.Vi;throw ct(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),Oe.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),Oe.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),Oe.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((a=>this.fi.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((a=>{a.forEach((i=>this.fi.add(i.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Oe.forEach(this.fi,(n=>{const a=at.fromPath(n);return this.gi(e,a).next((i=>{i||r.removeEntry(a,mt.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return Oe.or([()=>Oe.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class xm{constructor(e,r){this.persistence=e,this.pi=new tc((n=>AD(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=L8(this,r)}static mi(e,r){return new xm(e,r)}Ei(){}di(e){return Oe.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((a=>n+a))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return Oe.forEach(this.pi,((n,a)=>this.br(e,n,a).next((i=>i?Oe.resolve():r(a)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),i=a.newChangeBuffer();return a.ii(e,(o=>this.br(e,o,r).next((u=>{u||(n++,i.removeEntry(o,mt.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),Oe.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Oe.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),Oe.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),Oe.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Qd(e.data.value)),r}br(e,r,n){return Oe.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.pi.get(r);return Oe.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Rv{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=a}static As(e,r){let n=Dt(),a=Dt();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:a=a.add(i.doc.key)}return new Rv(e,r.fromCache,n,a)}}class K8{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Q8{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return G5()?8:TD(Un())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,a){const i={result:null};return this.ys(e,r).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ws(e,r,a,n).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new K8;return this.Ss(e,r,o).next((u=>{if(i.result=u,this.Vs)return this.bs(e,r,o,u.size)}))})).next((()=>i.result))}bs(e,r,n,a){return n.documentReadCount<this.fs?(Jc()<=Rt.DEBUG&&Qe("QueryEngine","SDK will not create cache indexes for query:",Zc(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Oe.resolve()):(Jc()<=Rt.DEBUG&&Qe("QueryEngine","Query:",Zc(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.gs*a?(Jc()<=Rt.DEBUG&&Qe("QueryEngine","The SDK decides to create cache indexes for query:",Zc(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Us(r))):Oe.resolve())}ys(e,r){if(pE(r))return Oe.resolve(null);let n=Us(r);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(r.limit!==null&&a===1&&(r=Sx(r,null,"F"),n=Us(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((i=>{const o=Dt(...i);return this.ps.getDocuments(e,o).next((u=>this.indexManager.getMinOffset(e,n).next((f=>{const d=this.Ds(r,u);return this.Cs(r,d,o,f.readTime)?this.ys(e,Sx(r,null,"F")):this.vs(e,d,r,f)}))))})))))}ws(e,r,n,a){return pE(r)||a.isEqual(mt.min())?Oe.resolve(null):this.ps.getDocuments(e,n).next((i=>{const o=this.Ds(r,i);return this.Cs(r,o,n,a)?Oe.resolve(null):(Jc()<=Rt.DEBUG&&Qe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Zc(r)),this.vs(e,o,r,yD(a,u0)).next((u=>u)))}))}Ds(e,r){let n=new on(V4(e));return r.forEach(((a,i)=>{Zm(e,i)&&(n=n.add(i))})),n}Cs(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(a)>0)}Ss(e,r,n){return Jc()<=Rt.DEBUG&&Qe("QueryEngine","Using full collection scan to execute query:",Zc(r)),this.ps.getDocumentsMatchingQuery(e,r,Ll.min(),n)}vs(e,r,n,a){return this.ps.getDocumentsMatchingQuery(e,n,a).next((i=>(r.forEach((o=>{i=i.insert(o.key,o)})),i)))}}const Iv="LocalStore",J8=3e8;class Z8{constructor(e,r,n,a){this.persistence=e,this.Fs=r,this.serializer=a,this.Ms=new Ar(It),this.xs=new tc((i=>wv(i)),bv),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new U8(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function eO(t,e,r,n){return new Z8(t,e,r,n)}async function cA(t,e){const r=gt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next((i=>(a=i,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((i=>{const o=[],u=[];let f=Dt();for(const d of a){o.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}for(const d of i){u.push(d.batchId);for(const m of d.mutations)f=f.add(m.key)}return r.localDocuments.getDocuments(n,f).next((d=>({Ls:d,removedBatchIds:o,addedBatchIds:u})))}))}))}function tO(t,e){const r=gt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),i=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,f,d,m){const x=d.batch,y=x.keys();let w=Oe.resolve();return y.forEach((E=>{w=w.next((()=>m.getEntry(f,E))).next((b=>{const T=d.docVersions.get(E);Wt(T!==null,48541),b.version.compareTo(T)<0&&(x.applyToRemoteDocument(b,d),b.isValidDocument()&&(b.setReadTime(d.commitVersion),m.addEntry(b)))}))})),w.next((()=>u.mutationQueue.removeMutationBatch(f,x)))})(r,n,e,i).next((()=>i.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let f=Dt();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(f=f.add(u.batch.mutations[d].key));return f})(e)))).next((()=>r.localDocuments.getDocuments(n,a)))}))}function uA(t){const e=gt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function rO(t,e){const r=gt(t),n=e.snapshotVersion;let a=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=r.Ns.newChangeBuffer({trackRemovals:!0});a=r.Ms;const u=[];e.targetChanges.forEach(((m,x)=>{const y=a.get(x);if(!y)return;u.push(r.Pi.removeMatchingKeys(i,m.removedDocuments,x).next((()=>r.Pi.addMatchingKeys(i,m.addedDocuments,x))));let w=y.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(x)!==null?w=w.withResumeToken(Cn.EMPTY_BYTE_STRING,mt.min()).withLastLimboFreeSnapshotVersion(mt.min()):m.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(m.resumeToken,n)),a=a.insert(x,w),(function(b,T,I){return b.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-b.snapshotVersion.toMicroseconds()>=J8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0})(y,w,m)&&u.push(r.Pi.updateTargetData(i,w))}));let f=Oi(),d=Dt();if(e.documentUpdates.forEach((m=>{e.resolvedLimboDocuments.has(m)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(i,m))})),u.push(nO(i,o,e.documentUpdates).next((m=>{f=m.ks,d=m.qs}))),!n.isEqual(mt.min())){const m=r.Pi.getLastRemoteSnapshotVersion(i).next((x=>r.Pi.setTargetsMetadata(i,i.currentSequenceNumber,n)));u.push(m)}return Oe.waitFor(u).next((()=>o.apply(i))).next((()=>r.localDocuments.getLocalViewOfDocuments(i,f,d))).next((()=>f))})).then((i=>(r.Ms=a,i)))}function nO(t,e,r){let n=Dt(),a=Dt();return r.forEach((i=>n=n.add(i))),e.getEntries(t,n).next((i=>{let o=Oi();return r.forEach(((u,f)=>{const d=i.get(u);f.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(u)),f.isNoDocument()&&f.version.isEqual(mt.min())?(e.removeEntry(u,f.readTime),o=o.insert(u,f)):!d.isValidDocument()||f.version.compareTo(d.version)>0||f.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(f),o=o.insert(u,f)):Qe(Iv,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",f.version)})),{ks:o,qs:a}}))}function aO(t,e){const r=gt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=vv),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function sO(t,e){const r=gt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return r.Pi.getTargetData(n,e).next((i=>i?(a=i,Oe.resolve(a)):r.Pi.allocateTargetId(n).next((o=>(a=new kl(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=r.Ms.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function Rx(t,e,r){const n=gt(t),a=n.Ms.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,(o=>n.persistence.referenceDelegate.removeTarget(o,a)))}catch(o){if(!Du(o))throw o;Qe(Iv,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Ms=n.Ms.remove(e),n.xs.delete(a.target)}function CE(t,e,r){const n=gt(t);let a=mt.min(),i=Dt();return n.persistence.runTransaction("Execute query","readwrite",(o=>(function(f,d,m){const x=gt(f),y=x.xs.get(m);return y!==void 0?Oe.resolve(x.Ms.get(y)):x.Pi.getTargetData(d,m)})(n,o,Us(e)).next((u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(o,u.targetId).next((f=>{i=f}))})).next((()=>n.Fs.getDocumentsMatchingQuery(o,e,r?a:mt.min(),r?i:Dt()))).next((u=>(iO(n,qD(e),u),{documents:u,Qs:i})))))}function iO(t,e,r){let n=t.Os.get(e)||mt.min();r.forEach(((a,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)})),t.Os.set(e,n)}class NE{constructor(){this.activeTargetIds=QD()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lO{constructor(){this.Mo=new NE,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new NE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class oO{Oo(e){}shutdown(){}}const RE="ConnectivityMonitor";class IE{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Qe(RE,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Qe(RE,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let Id=null;function Ix(){return Id===null?Id=(function(){return 268435456+Math.round(2147483648*Math.random())})():Id++,"0x"+Id.toString(16)}const V1="RestConnection",cO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class uO{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${a}`,this.Wo=this.databaseId.database===fm?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Go(e,r,n,a,i){const o=Ix(),u=this.zo(e,r.toUriEncodedString());Qe(V1,`Sending RPC '${e}' ${o}:`,u,n);const f={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(f,a,i);const{host:d}=new URL(u),m=Cu(d);return this.Jo(e,u,f,n,m).then((x=>(Qe(V1,`Received RPC '${e}' ${o}: `,x),x)),(x=>{throw pu(V1,`RPC '${e}' ${o} failed with error: `,x,"url: ",u,"request:",n),x}))}Ho(e,r,n,a,i,o){return this.Go(e,r,n,a,i)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ru})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((a,i)=>e[i]=a)),n&&n.headers.forEach(((a,i)=>e[i]=a))}zo(e,r){const n=cO[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}class fO{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Dn="WebChannelConnection";class hO extends uO{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,a,i){const o=Ix();return new Promise(((u,f)=>{const d=new d4;d.setWithCredentials(!0),d.listenOnce(m4.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case Kd.NO_ERROR:const x=d.getResponseJson();Qe(Dn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(x)),u(x);break;case Kd.TIMEOUT:Qe(Dn,`RPC '${e}' ${o} timed out`),f(new $e(Ie.DEADLINE_EXCEEDED,"Request time out"));break;case Kd.HTTP_ERROR:const y=d.getStatus();if(Qe(Dn,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let w=d.getResponseJson();Array.isArray(w)&&(w=w[0]);const E=w?.error;if(E&&E.status&&E.message){const b=(function(I){const R=I.toLowerCase().replace(/_/g,"-");return Object.values(Ie).indexOf(R)>=0?R:Ie.UNKNOWN})(E.status);f(new $e(b,E.message))}else f(new $e(Ie.UNKNOWN,"Server responded with status "+d.getStatus()))}else f(new $e(Ie.UNAVAILABLE,"Connection failed."));break;default:ct(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{Qe(Dn,`RPC '${e}' ${o} completed.`)}}));const m=JSON.stringify(a);Qe(Dn,`RPC '${e}' ${o} sending request:`,a),d.send(r,"POST",m,n,15)}))}T_(e,r,n){const a=Ix(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=x4(),u=g4(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(f.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(f.useFetchStreams=!0),this.jo(f.initMessageHeaders,r,n),f.encodeInitMessageHeaders=!0;const m=i.join("");Qe(Dn,`Creating RPC '${e}' stream ${a}: ${m}`,f);const x=o.createWebChannel(m,f);this.I_(x);let y=!1,w=!1;const E=new fO({Yo:T=>{w?Qe(Dn,`Not sending because RPC '${e}' stream ${a} is closed:`,T):(y||(Qe(Dn,`Opening RPC '${e}' stream ${a} transport.`),x.open(),y=!0),Qe(Dn,`RPC '${e}' stream ${a} sending:`,T),x.send(T))},Zo:()=>x.close()}),b=(T,I,R)=>{T.listen(I,(C=>{try{R(C)}catch(G){setTimeout((()=>{throw G}),0)}}))};return b(x,Uf.EventType.OPEN,(()=>{w||(Qe(Dn,`RPC '${e}' stream ${a} transport opened.`),E.o_())})),b(x,Uf.EventType.CLOSE,(()=>{w||(w=!0,Qe(Dn,`RPC '${e}' stream ${a} transport closed`),E.a_(),this.E_(x))})),b(x,Uf.EventType.ERROR,(T=>{w||(w=!0,pu(Dn,`RPC '${e}' stream ${a} transport errored. Name:`,T.name,"Message:",T.message),E.a_(new $e(Ie.UNAVAILABLE,"The operation could not be completed")))})),b(x,Uf.EventType.MESSAGE,(T=>{if(!w){const I=T.data[0];Wt(!!I,16349);const R=I,C=R?.error||R[0]?.error;if(C){Qe(Dn,`RPC '${e}' stream ${a} received error:`,C);const G=C.status;let V=(function(D){const N=Jr[D];if(N!==void 0)return Q4(N)})(G),H=C.message;V===void 0&&(V=Ie.INTERNAL,H="Unknown error status: "+G+" with message "+C.message),w=!0,E.a_(new $e(V,H)),x.close()}else Qe(Dn,`RPC '${e}' stream ${a} received:`,I),E.u_(I)}})),b(u,p4.STAT_EVENT,(T=>{T.stat===vx.PROXY?Qe(Dn,`RPC '${e}' stream ${a} detected buffering proxy`):T.stat===vx.NOPROXY&&Qe(Dn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{E.__()}),0),E}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function U1(){return typeof document<"u"?document:null}function ap(t){return new g8(t,!0)}class fA{constructor(e,r,n=1e3,a=1.5,i=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=a,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,r-n);a>0&&Qe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const DE="PersistentStream";class hA{constructor(e,r,n,a,i,o,u,f){this.Mi=e,this.S_=n,this.b_=a,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=f,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new fA(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Ie.RESOURCE_EXHAUSTED?(Di(r.toString()),Di("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===r&&this.G_(n,a)}),(n=>{e((()=>{const a=new $e(Ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Qe(DE,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(Qe(DE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class dO extends hA{constructor(e,r,n,a,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,o),this.serializer=i}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=y8(this.serializer,e),n=(function(i){if(!("targetChange"in i))return mt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?mt.min():o.readTime?zs(o.readTime):mt.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=Nx(this.serializer),r.addTarget=(function(i,o){let u;const f=o.target;if(u=Ex(f)?{documents:b8(i,f)}:{query:E8(i,f).ft},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=eA(i,o.resumeToken);const d=Ax(i,o.expectedCount);d!==null&&(u.expectedCount=d)}else if(o.snapshotVersion.compareTo(mt.min())>0){u.readTime=gm(i,o.snapshotVersion.toTimestamp());const d=Ax(i,o.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);const n=S8(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=Nx(this.serializer),r.removeTarget=e,this.q_(r)}}class mO extends hA{constructor(e,r,n,a,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Wt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Wt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Wt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=w8(e.writeResults,e.commitTime),n=zs(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=Nx(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>_8(this.serializer,n)))};this.q_(r)}}class pO{}class gO extends pO{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new $e(Ie.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Go(e,kx(r,n),a,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new $e(Ie.UNKNOWN,i.toString())}))}Ho(e,r,n,a,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,u])=>this.connection.Ho(e,kx(r,n),a,o,u,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new $e(Ie.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class xO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Di(r),this.aa=!1):Qe("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Wo="RemoteStore";class vO{constructor(e,r,n,a,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((o=>{n.enqueueAndForget((async()=>{rc(this)&&(Qe(Wo,"Restarting streams for network reachability change."),await(async function(f){const d=gt(f);d.Ea.add(4),await V0(d),d.Ra.set("Unknown"),d.Ea.delete(4),await sp(d)})(this))}))})),this.Ra=new xO(n,a)}}async function sp(t){if(rc(t))for(const e of t.da)await e(!0)}async function V0(t){for(const e of t.da)await e(!1)}function dA(t,e){const r=gt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Mv(r)?Fv(r):Fu(r).O_()&&Ov(r,e))}function Dv(t,e){const r=gt(t),n=Fu(r);r.Ia.delete(e),n.O_()&&mA(r,e),r.Ia.size===0&&(n.O_()?n.L_():rc(r)&&r.Ra.set("Unknown"))}function Ov(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(mt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Fu(t).Y_(e)}function mA(t,e){t.Va.Ue(e),Fu(t).Z_(e)}function Fv(t){t.Va=new h8({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Fu(t).start(),t.Ra.ua()}function Mv(t){return rc(t)&&!Fu(t).x_()&&t.Ia.size>0}function rc(t){return gt(t).Ea.size===0}function pA(t){t.Va=void 0}async function yO(t){t.Ra.set("Online")}async function _O(t){t.Ia.forEach(((e,r)=>{Ov(t,e)}))}async function wO(t,e){pA(t),Mv(t)?(t.Ra.ha(e),Fv(t)):t.Ra.set("Unknown")}async function bO(t,e,r){if(t.Ra.set("Online"),e instanceof Z4&&e.state===2&&e.cause)try{await(async function(a,i){const o=i.cause;for(const u of i.targetIds)a.Ia.has(u)&&(await a.remoteSyncer.rejectListen(u,o),a.Ia.delete(u),a.Va.removeTarget(u))})(t,e)}catch(n){Qe(Wo,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await vm(t,n)}else if(e instanceof em?t.Va.Ze(e):e instanceof J4?t.Va.st(e):t.Va.tt(e),!r.isEqual(mt.min()))try{const n=await uA(t.localStore);r.compareTo(n)>=0&&await(function(i,o){const u=i.Va.Tt(o);return u.targetChanges.forEach(((f,d)=>{if(f.resumeToken.approximateByteSize()>0){const m=i.Ia.get(d);m&&i.Ia.set(d,m.withResumeToken(f.resumeToken,o))}})),u.targetMismatches.forEach(((f,d)=>{const m=i.Ia.get(f);if(!m)return;i.Ia.set(f,m.withResumeToken(Cn.EMPTY_BYTE_STRING,m.snapshotVersion)),mA(i,f);const x=new kl(m.target,f,d,m.sequenceNumber);Ov(i,x)})),i.remoteSyncer.applyRemoteEvent(u)})(t,r)}catch(n){Qe(Wo,"Failed to raise snapshot:",n),await vm(t,n)}}async function vm(t,e,r){if(!Du(e))throw e;t.Ea.add(1),await V0(t),t.Ra.set("Offline"),r||(r=()=>uA(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Qe(Wo,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await sp(t)}))}function gA(t,e){return e().catch((r=>vm(t,r,e)))}async function ip(t){const e=gt(t),r=zl(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vv;for(;EO(e);)try{const a=await aO(e.localStore,n);if(a===null){e.Ta.length===0&&r.L_();break}n=a.batchId,TO(e,a)}catch(a){await vm(e,a)}xA(e)&&vA(e)}function EO(t){return rc(t)&&t.Ta.length<10}function TO(t,e){t.Ta.push(e);const r=zl(t);r.O_()&&r.X_&&r.ea(e.mutations)}function xA(t){return rc(t)&&!zl(t).x_()&&t.Ta.length>0}function vA(t){zl(t).start()}async function SO(t){zl(t).ra()}async function AO(t){const e=zl(t);for(const r of t.Ta)e.ea(r.mutations)}async function kO(t,e,r){const n=t.Ta.shift(),a=Sv.from(n,e,r);await gA(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await ip(t)}async function CO(t,e){e&&zl(t).X_&&await(async function(n,a){if((function(o){return c8(o)&&o!==Ie.ABORTED})(a.code)){const i=n.Ta.shift();zl(n).B_(),await gA(n,(()=>n.remoteSyncer.rejectFailedWrite(i.batchId,a))),await ip(n)}})(t,e),xA(t)&&vA(t)}async function OE(t,e){const r=gt(t);r.asyncQueue.verifyOperationInProgress(),Qe(Wo,"RemoteStore received new credentials");const n=rc(r);r.Ea.add(3),await V0(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await sp(r)}async function NO(t,e){const r=gt(t);e?(r.Ea.delete(2),await sp(r)):e||(r.Ea.add(2),await V0(r),r.Ra.set("Unknown"))}function Fu(t){return t.ma||(t.ma=(function(r,n,a){const i=gt(r);return i.sa(),new dO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(t.datastore,t.asyncQueue,{Xo:yO.bind(null,t),t_:_O.bind(null,t),r_:wO.bind(null,t),H_:bO.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Mv(t)?Fv(t):t.Ra.set("Unknown")):(await t.ma.stop(),pA(t))}))),t.ma}function zl(t){return t.fa||(t.fa=(function(r,n,a){const i=gt(r);return i.sa(),new mO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:SO.bind(null,t),r_:CO.bind(null,t),ta:AO.bind(null,t),na:kO.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await ip(t)):(await t.fa.stop(),t.Ta.length>0&&(Qe(Wo,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class Pv{constructor(e,r,n,a,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=i,this.deferred=new Fl,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,i){const o=Date.now()+n,u=new Pv(e,r,o,a,i);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $e(Ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function jv(t,e){if(Di("AsyncQueue",`${e}: ${t}`),Du(t))return new $e(Ie.UNAVAILABLE,`${e}: ${t}`);throw t}class su{static emptySet(e){return new su(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||at.comparator(r.key,n.key):(r,n)=>at.comparator(r.key,n.key),this.keyedMap=zf(),this.sortedSet=new Ar(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof su)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,i=n.getNext().key;if(!a.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new su;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}class FE{constructor(){this.ga=new Ar(at.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):ct(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class _u{constructor(e,r,n,a,i,o,u,f,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=f,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,a,i){const o=[];return r.forEach((u=>{o.push({type:0,doc:u})})),new _u(e,r,su.emptySet(r),o,n,a,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}class RO{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class IO{constructor(){this.queries=ME(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const a=gt(r),i=a.queries;a.queries=ME(),i.forEach(((o,u)=>{for(const f of u.Sa)f.onError(n)}))})(this,new $e(Ie.ABORTED,"Firestore shutting down"))}}function ME(){return new tc((t=>B4(t)),Jm)}async function yA(t,e){const r=gt(t);let n=3;const a=e.query;let i=r.queries.get(a);i?!i.ba()&&e.Da()&&(n=2):(i=new RO,n=e.Da()?0:1);try{switch(n){case 0:i.wa=await r.onListen(a,!0);break;case 1:i.wa=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(o){const u=jv(o,`Initialization of query '${Zc(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,i),i.Sa.push(e),e.va(r.onlineState),i.wa&&e.Fa(i.wa)&&Lv(r)}async function _A(t,e){const r=gt(t),n=e.query;let a=3;const i=r.queries.get(n);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?a=e.Da()?0:1:!i.ba()&&e.Da()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function DO(t,e){const r=gt(t);let n=!1;for(const a of e){const i=a.query,o=r.queries.get(i);if(o){for(const u of o.Sa)u.Fa(a)&&(n=!0);o.wa=a}}n&&Lv(r)}function OO(t,e,r){const n=gt(t),a=n.queries.get(e);if(a)for(const i of a.Sa)i.onError(r);n.queries.delete(e)}function Lv(t){t.Ca.forEach((e=>{e.next()}))}var Dx,PE;(PE=Dx||(Dx={})).Ma="default",PE.Cache="cache";class wA{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new _u(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=_u.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Dx.Cache}}class bA{constructor(e){this.key=e}}class EA{constructor(e){this.key=e}}class FO{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Dt(),this.mutatedKeys=Dt(),this.eu=V4(e),this.tu=new su(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new FE,a=r?r.tu:this.tu;let i=r?r.mutatedKeys:this.mutatedKeys,o=a,u=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((m,x)=>{const y=a.get(m),w=Zm(this.query,x)?x:null,E=!!y&&this.mutatedKeys.has(y.key),b=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let T=!1;y&&w?y.data.isEqual(w.data)?E!==b&&(n.track({type:3,doc:w}),T=!0):this.su(y,w)||(n.track({type:2,doc:w}),T=!0,(f&&this.eu(w,f)>0||d&&this.eu(w,d)<0)&&(u=!0)):!y&&w?(n.track({type:0,doc:w}),T=!0):y&&!w&&(n.track({type:1,doc:y}),T=!0,(f||d)&&(u=!0)),T&&(w?(o=o.add(w),i=b?i.add(m):i.delete(m)):(o=o.delete(m),i=i.delete(m)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),i=i.delete(m.key),n.track({type:1,doc:m})}return{tu:o,iu:n,Cs:u,mutatedKeys:i}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((m,x)=>(function(w,E){const b=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ct(20277,{Rt:T})}};return b(w)-b(E)})(m.type,x.type)||this.eu(m.doc,x.doc))),this.ou(n),a=a??!1;const u=r&&!a?this._u():[],f=this.Xa.size===0&&this.current&&!a?1:0,d=f!==this.Za;return this.Za=f,o.length!==0||d?{snapshot:new _u(this.query,e.tu,i,o,e.mutatedKeys,f===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new FE,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Dt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new EA(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new bA(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=Dt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return _u.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Bv="SyncEngine";class MO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class PO{constructor(e){this.key=e,this.hu=!1}}class jO{constructor(e,r,n,a,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new tc((u=>B4(u)),Jm),this.Iu=new Map,this.Eu=new Set,this.du=new Ar(at.comparator),this.Au=new Map,this.Ru=new Cv,this.Vu={},this.mu=new Map,this.fu=yu.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function LO(t,e,r=!0){const n=NA(t);let a;const i=n.Tu.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),a=i.view.lu()):a=await TA(n,e,r,!0),a}async function BO(t,e){const r=NA(t);await TA(r,e,!0,!1)}async function TA(t,e,r,n){const a=await sO(t.localStore,Us(e)),i=a.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let u;return n&&(u=await VO(t,e,i,o==="current",a.resumeToken)),t.isPrimaryClient&&r&&dA(t.remoteStore,a),u}async function VO(t,e,r,n,a){t.pu=(x,y,w)=>(async function(b,T,I,R){let C=T.view.ru(I);C.Cs&&(C=await CE(b.localStore,T.query,!1).then((({documents:A})=>T.view.ru(A,C))));const G=R&&R.targetChanges.get(T.targetId),V=R&&R.targetMismatches.get(T.targetId)!=null,H=T.view.applyChanges(C,b.isPrimaryClient,G,V);return LE(b,T.targetId,H.au),H.snapshot})(t,x,y,w);const i=await CE(t.localStore,e,!0),o=new FO(e,i.Qs),u=o.ru(i.documents),f=B0.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),d=o.applyChanges(u,t.isPrimaryClient,f);LE(t,r,d.au);const m=new MO(e,r,o);return t.Tu.set(e,m),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),d.snapshot}async function UO(t,e,r){const n=gt(t),a=n.Tu.get(e),i=n.Iu.get(a.targetId);if(i.length>1)return n.Iu.set(a.targetId,i.filter((o=>!Jm(o,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await Rx(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),r&&Dv(n.remoteStore,a.targetId),Ox(n,a.targetId)})).catch(Iu)):(Ox(n,a.targetId),await Rx(n.localStore,a.targetId,!0))}async function zO(t,e){const r=gt(t),n=r.Tu.get(e),a=r.Iu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Dv(r.remoteStore,n.targetId))}async function HO(t,e,r){const n=KO(t);try{const a=await(function(o,u){const f=gt(o),d=xr.now(),m=u.reduce(((w,E)=>w.add(E.key)),Dt());let x,y;return f.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let E=Oi(),b=Dt();return f.Ns.getEntries(w,m).next((T=>{E=T,E.forEach(((I,R)=>{R.isValidDocument()||(b=b.add(I))}))})).next((()=>f.localDocuments.getOverlayedDocuments(w,E))).next((T=>{x=T;const I=[];for(const R of u){const C=a8(R,x.get(R.key).overlayedDocument);C!=null&&I.push(new Zl(R.key,C,I4(C.value.mapValue),Jn.exists(!0)))}return f.mutationQueue.addMutationBatch(w,d,I,u)})).next((T=>{y=T;const I=T.applyToLocalDocumentSet(x,b);return f.documentOverlayCache.saveOverlays(w,T.batchId,I)}))})).then((()=>({batchId:y.batchId,changes:z4(x)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(o,u,f){let d=o.Vu[o.currentUser.toKey()];d||(d=new Ar(It)),d=d.insert(u,f),o.Vu[o.currentUser.toKey()]=d})(n,a.batchId,r),await U0(n,a.changes),await ip(n.remoteStore)}catch(a){const i=jv(a,"Failed to persist write");r.reject(i)}}async function SA(t,e){const r=gt(t);try{const n=await rO(r.localStore,e);e.targetChanges.forEach(((a,i)=>{const o=r.Au.get(i);o&&(Wt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?o.hu=!0:a.modifiedDocuments.size>0?Wt(o.hu,14607):a.removedDocuments.size>0&&(Wt(o.hu,42227),o.hu=!1))})),await U0(r,n,e)}catch(n){await Iu(n)}}function jE(t,e,r){const n=gt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Tu.forEach(((i,o)=>{const u=o.view.va(e);u.snapshot&&a.push(u.snapshot)})),(function(o,u){const f=gt(o);f.onlineState=u;let d=!1;f.queries.forEach(((m,x)=>{for(const y of x.Sa)y.va(u)&&(d=!0)})),d&&Lv(f)})(n.eventManager,e),a.length&&n.Pu.H_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function GO(t,e,r){const n=gt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Au.get(e),i=a&&a.key;if(i){let o=new Ar(at.comparator);o=o.insert(i,jn.newNoDocument(i,mt.min()));const u=Dt().add(i),f=new np(mt.min(),new Map,new Ar(It),o,u);await SA(n,f),n.du=n.du.remove(i),n.Au.delete(e),Vv(n)}else await Rx(n.localStore,e,!1).then((()=>Ox(n,e,r))).catch(Iu)}async function qO(t,e){const r=gt(t),n=e.batch.batchId;try{const a=await tO(r.localStore,e);kA(r,n,null),AA(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await U0(r,a)}catch(a){await Iu(a)}}async function WO(t,e,r){const n=gt(t);try{const a=await(function(o,u){const f=gt(o);return f.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let m;return f.mutationQueue.lookupMutationBatch(d,u).next((x=>(Wt(x!==null,37113),m=x.keys(),f.mutationQueue.removeMutationBatch(d,x)))).next((()=>f.mutationQueue.performConsistencyCheck(d))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(d,m,u))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,m))).next((()=>f.localDocuments.getDocuments(d,m)))}))})(n.localStore,e);kA(n,e,r),AA(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await U0(n,a)}catch(a){await Iu(a)}}function AA(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function kA(t,e,r){const n=gt(t);let a=n.Vu[n.currentUser.toKey()];if(a){const i=a.get(e);i&&(r?i.reject(r):i.resolve(),a=a.remove(e)),n.Vu[n.currentUser.toKey()]=a}}function Ox(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||CA(t,n)}))}function CA(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Dv(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Vv(t))}function LE(t,e,r){for(const n of r)n instanceof bA?(t.Ru.addReference(n.key,e),XO(t,n)):n instanceof EA?(Qe(Bv,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||CA(t,n.key)):ct(19791,{wu:n})}function XO(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(Qe(Bv,"New document in limbo: "+r),t.Eu.add(n),Vv(t))}function Vv(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new at(hr.fromString(e)),n=t.fu.next();t.Au.set(n,new PO(r)),t.du=t.du.insert(r,n),dA(t.remoteStore,new kl(Us(Ev(r.path)),n,"TargetPurposeLimboResolution",$m.ce))}}async function U0(t,e,r){const n=gt(t),a=[],i=[],o=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,f)=>{o.push(n.pu(f,e,r).then((d=>{if((d||r)&&n.isPrimaryClient){const m=d?!d.fromCache:r?.targetChanges.get(f.targetId)?.current;n.sharedClientState.updateQueryState(f.targetId,m?"current":"not-current")}if(d){a.push(d);const m=Rv.As(f.targetId,d);i.push(m)}})))})),await Promise.all(o),n.Pu.H_(a),await(async function(f,d){const m=gt(f);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",(x=>Oe.forEach(d,(y=>Oe.forEach(y.Es,(w=>m.persistence.referenceDelegate.addReference(x,y.targetId,w))).next((()=>Oe.forEach(y.ds,(w=>m.persistence.referenceDelegate.removeReference(x,y.targetId,w)))))))))}catch(x){if(!Du(x))throw x;Qe(Iv,"Failed to update sequence numbers: "+x)}for(const x of d){const y=x.targetId;if(!x.fromCache){const w=m.Ms.get(y),E=w.snapshotVersion,b=w.withLastLimboFreeSnapshotVersion(E);m.Ms=m.Ms.insert(y,b)}}})(n.localStore,i))}async function YO(t,e){const r=gt(t);if(!r.currentUser.isEqual(e)){Qe(Bv,"User change. New user:",e.toKey());const n=await cA(r.localStore,e);r.currentUser=e,(function(i,o){i.mu.forEach((u=>{u.forEach((f=>{f.reject(new $e(Ie.CANCELLED,o))}))})),i.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await U0(r,n.Ls)}}function $O(t,e){const r=gt(t),n=r.Au.get(e);if(n&&n.hu)return Dt().add(n.key);{let a=Dt();const i=r.Iu.get(e);if(!i)return a;for(const o of i){const u=r.Tu.get(o);a=a.unionWith(u.view.nu)}return a}}function NA(t){const e=gt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=SA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$O.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=GO.bind(null,e),e.Pu.H_=DO.bind(null,e.eventManager),e.Pu.yu=OO.bind(null,e.eventManager),e}function KO(t){const e=gt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WO.bind(null,e),e}class ym{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=ap(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return eO(this.persistence,new Q8,e.initialUser,this.serializer)}Cu(e){return new oA(Nv.mi,this.serializer)}Du(e){return new lO}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ym.provider={build:()=>new ym};class QO extends ym{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Wt(this.persistence.referenceDelegate instanceof xm,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new P8(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?oa.withCacheSize(this.cacheSizeBytes):oa.DEFAULT;return new oA((n=>xm.mi(n,r)),this.serializer)}}class Fx{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>jE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=YO.bind(null,this.syncEngine),await NO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new IO})()}createDatastore(e){const r=ap(e.databaseInfo.databaseId),n=(function(i){return new hO(i)})(e.databaseInfo);return(function(i,o,u,f){return new gO(i,o,u,f)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,a,i,o,u){return new vO(n,a,i,o,u)})(this.localStore,this.datastore,e.asyncQueue,(r=>jE(this.syncEngine,r,0)),(function(){return IE.v()?new IE:new oO})())}createSyncEngine(e,r){return(function(a,i,o,u,f,d,m){const x=new jO(a,i,o,u,f,d);return m&&(x.gu=!0),x})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){const n=gt(r);Qe(Wo,"RemoteStore shutting down."),n.Ea.add(5),await V0(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Fx.provider={build:()=>new Fx};class RA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Di("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}const Hl="FirestoreClient";class JO{constructor(e,r,n,a,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Fn.UNAUTHENTICATED,this.clientId=xv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async o=>{Qe(Hl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(n,(o=>(Qe(Hl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Fl;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=jv(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function z1(t,e){t.asyncQueue.verifyOperationInProgress(),Qe(Hl,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async a=>{n.isEqual(a)||(await cA(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function BE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await ZO(t);Qe(Hl,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>OE(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,a)=>OE(e.remoteStore,a))),t._onlineComponents=e}async function ZO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Qe(Hl,"Using user provided OfflineComponentProvider");try{await z1(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(a){return a.name==="FirebaseError"?a.code===Ie.FAILED_PRECONDITION||a.code===Ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(r))throw r;pu("Error using user provided cache. Falling back to memory cache: "+r),await z1(t,new ym)}}else Qe(Hl,"Using default OfflineComponentProvider"),await z1(t,new QO(void 0));return t._offlineComponents}async function IA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Qe(Hl,"Using user provided OnlineComponentProvider"),await BE(t,t._uninitializedComponentsProvider._online)):(Qe(Hl,"Using default OnlineComponentProvider"),await BE(t,new Fx))),t._onlineComponents}function e9(t){return IA(t).then((e=>e.syncEngine))}async function Mx(t){const e=await IA(t),r=e.eventManager;return r.onListen=LO.bind(null,e.syncEngine),r.onUnlisten=UO.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=BO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=zO.bind(null,e.syncEngine),r}function t9(t,e,r={}){const n=new Fl;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,u,f,d){const m=new RA({next:y=>{m.Nu(),o.enqueueAndForget((()=>_A(i,x))),y.fromCache&&f.source==="server"?d.reject(new $e(Ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),x=new wA(u,m,{includeMetadataChanges:!0,qa:!0});return yA(i,x)})(await Mx(t),t.asyncQueue,e,r,n))),n.promise}function DA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const VE=new Map;const OA="firestore.googleapis.com",UE=!0;class zE{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new $e(Ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=OA,this.ssl=UE}else this.host=e.host,this.ssl=e.ssl??UE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=lA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<F8)throw new $e(Ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}vD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=DA(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new $e(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new $e(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new $e(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class lp{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $e(Ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $e(Ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new oD;switch(n.type){case"firstParty":return new hD(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new $e(Ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=VE.get(r);n&&(Qe("ComponentProvider","Removing Datastore"),VE.delete(r),n.terminate())})(this),Promise.resolve()}}function r9(t,e,r,n={}){t=Na(t,lp);const a=Cu(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},u=`${e}:${r}`;a&&(a4(`https://${u}`),s4("Firestore",!0)),i.host!==OA&&i.host!==u&&pu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f={...i,host:u,ssl:a,emulatorOptions:n};if(!Ho(f,o)&&(t._setSettings(f),n.mockUserToken)){let d,m;if(typeof n.mockUserToken=="string")d=n.mockUserToken,m=Fn.MOCK_USER;else{d=M5(n.mockUserToken,t._app?.options.projectId);const x=n.mockUserToken.sub||n.mockUserToken.user_id;if(!x)throw new $e(Ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new Fn(x)}t._authCredentials=new cD(new y4(d,m))}}class eo{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new eo(this.firestore,e,this._query)}}class Vr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ml(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vr(this.firestore,e,this._key)}toJSON(){return{type:Vr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(j0(r,Vr._jsonSchema))return new Vr(e,n||null,new at(hr.fromString(r.referencePath)))}}Vr._jsonSchemaVersion="firestore/documentReference/1.0",Vr._jsonSchema={type:rn("string",Vr._jsonSchemaVersion),referencePath:rn("string")};class Ml extends eo{constructor(e,r,n){super(e,r,Ev(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vr(this.firestore,null,new at(e))}withConverter(e){return new Ml(this.firestore,e,this._path)}}function qt(t,e,...r){if(t=cn(t),_4("collection","path",e),t instanceof lp){const n=hr.fromString(e,...r);return tE(n),new Ml(t,null,n)}{if(!(t instanceof Vr||t instanceof Ml))throw new $e(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(hr.fromString(e,...r));return tE(n),new Ml(t.firestore,null,n)}}function Et(t,e,...r){if(t=cn(t),arguments.length===1&&(e=xv.newId()),_4("doc","path",e),t instanceof lp){const n=hr.fromString(e,...r);return eE(n),new Vr(t,null,new at(n))}{if(!(t instanceof Vr||t instanceof Ml))throw new $e(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(hr.fromString(e,...r));return eE(n),new Vr(t.firestore,t instanceof Ml?t.converter:null,new at(n))}}const HE="AsyncQueue";class GE{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new fA(this,"async_queue_retry"),this._c=()=>{const n=U1();n&&Qe(HE,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=U1();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=U1();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new Fl;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Du(e))throw e;Qe(HE,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,Di("INTERNAL UNHANDLED ERROR: ",qE(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const a=Pv.createAndSchedule(this,e,r,n,(i=>this.hc(i)));return this.tc.push(a),a}uc(){this.nc&&ct(47125,{Pc:qE(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function qE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}function WE(t){return(function(r,n){if(typeof r!="object"||r===null)return!1;const a=r;for(const i of n)if(i in a&&typeof a[i]=="function")return!0;return!1})(t,["next","error","complete"])}class Fi extends lp{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new GE,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new GE(e),this._firestoreClient=void 0,await e}}}function n9(t,e){const r=typeof t=="object"?t:c4(),n=typeof t=="string"?t:fm,a=pv(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const i=O5("firestore");i&&r9(a,...i)}return a}function op(t){if(t._terminated)throw new $e(Ie.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||a9(t),t._firestoreClient}function a9(t){const e=t._freezeSettings(),r=(function(a,i,o,u){return new ND(a,i,o,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,DA(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new JO(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(a){const i=a?._online.build();return{_offline:a?._offline.build(i),_online:i}})(t._componentsProvider))}class Qa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Qa(Cn.fromBase64String(e))}catch(r){throw new $e(Ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Qa(Cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Qa._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(j0(e,Qa._jsonSchema))return Qa.fromBase64String(e.bytes)}}Qa._jsonSchemaVersion="firestore/bytes/1.0",Qa._jsonSchema={type:rn("string",Qa._jsonSchemaVersion),bytes:rn("string")};class z0{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new $e(Ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new An(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Uv{constructor(e){this._methodName=e}}class Hs{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new $e(Ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new $e(Ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return It(this._lat,e._lat)||It(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Hs._jsonSchemaVersion}}static fromJSON(e){if(j0(e,Hs._jsonSchema))return new Hs(e.latitude,e.longitude)}}Hs._jsonSchemaVersion="firestore/geoPoint/1.0",Hs._jsonSchema={type:rn("string",Hs._jsonSchemaVersion),latitude:rn("number"),longitude:rn("number")};class Gs{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==a[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Gs._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(j0(e,Gs._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new Gs(e.vectorValues);throw new $e(Ie.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Gs._jsonSchemaVersion="firestore/vectorValue/1.0",Gs._jsonSchema={type:rn("string",Gs._jsonSchemaVersion),vectorValues:rn("object")};const s9=/^__.*__$/;class i9{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Zl(e,this.data,this.fieldMask,r,this.fieldTransforms):new L0(e,this.data,r,this.fieldTransforms)}}class FA{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Zl(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function MA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ct(40011,{Ac:t})}}class zv{constructor(e,r,n,a,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new zv({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return _m(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(MA(this.Ac)&&s9.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class l9{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||ap(e)}Cc(e,r,n,a=!1){return new zv({Ac:e,methodName:r,Dc:n,path:An.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function H0(t){const e=t._freezeSettings(),r=ap(t._databaseId);return new l9(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Hv(t,e,r,n,a,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,r,a);Gv("Data must be an object, but it was:",o,n);const u=LA(n,o);let f,d;if(i.merge)f=new Ca(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const m=[];for(const x of i.mergeFields){const y=Px(e,x,r);if(!o.contains(y))throw new $e(Ie.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);VA(m,y)||m.push(y)}f=new Ca(m),d=o.fieldTransforms.filter((x=>f.covers(x.field)))}else f=null,d=o.fieldTransforms;return new i9(new ca(u),f,d)}class cp extends Uv{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof cp}}function PA(t,e,r,n){const a=t.Cc(1,e,r);Gv("Data must be an object, but it was:",a,n);const i=[],o=ca.empty();Jl(n,((f,d)=>{const m=qv(e,f,r);d=cn(d);const x=a.yc(m);if(d instanceof cp)i.push(m);else{const y=G0(d,x);y!=null&&(i.push(m),o.set(m,y))}}));const u=new Ca(i);return new FA(o,u,a.fieldTransforms)}function jA(t,e,r,n,a,i){const o=t.Cc(1,e,r),u=[Px(e,n,r)],f=[a];if(i.length%2!=0)throw new $e(Ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<i.length;y+=2)u.push(Px(e,i[y])),f.push(i[y+1]);const d=[],m=ca.empty();for(let y=u.length-1;y>=0;--y)if(!VA(d,u[y])){const w=u[y];let E=f[y];E=cn(E);const b=o.yc(w);if(E instanceof cp)d.push(w);else{const T=G0(E,b);T!=null&&(d.push(w),m.set(w,T))}}const x=new Ca(d);return new FA(m,x,o.fieldTransforms)}function o9(t,e,r,n=!1){return G0(r,t.Cc(n?4:3,e))}function G0(t,e){if(BA(t=cn(t)))return Gv("Unsupported field value:",e,t),LA(t,e);if(t instanceof Uv)return(function(n,a){if(!MA(a.Ac))throw a.Sc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(a);i&&a.fieldTransforms.push(i)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,a){const i=[];let o=0;for(const u of n){let f=G0(u,a.wc(o));f==null&&(f={nullValue:"NULL_VALUE"}),i.push(f),o++}return{arrayValue:{values:i}}})(t,e)}return(function(n,a){if((n=cn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return JD(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=xr.fromDate(n);return{timestampValue:gm(a.serializer,i)}}if(n instanceof xr){const i=new xr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:gm(a.serializer,i)}}if(n instanceof Hs)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Qa)return{bytesValue:eA(a.serializer,n._byteString)};if(n instanceof Vr){const i=a.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw a.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:kv(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Gs)return(function(o,u){return{mapValue:{fields:{[N4]:{stringValue:R4},[hm]:{arrayValue:{values:o.toArray().map((d=>{if(typeof d!="number")throw u.Sc("VectorValues must only contain numeric values.");return Tv(u.serializer,d)}))}}}}}})(n,a);throw a.Sc(`Unsupported field value: ${Ym(n)}`)})(t,e)}function LA(t,e){const r={};return E4(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jl(t,((n,a)=>{const i=G0(a,e.mc(n));i!=null&&(r[n]=i)})),{mapValue:{fields:r}}}function BA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xr||t instanceof Hs||t instanceof Qa||t instanceof Vr||t instanceof Uv||t instanceof Gs)}function Gv(t,e,r){if(!BA(r)||!w4(r)){const n=Ym(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function Px(t,e,r){if((e=cn(e))instanceof z0)return e._internalPath;if(typeof e=="string")return qv(t,e);throw _m("Field path arguments must be of type string or ",t,!1,void 0,r)}const c9=new RegExp("[~\\*/\\[\\]]");function qv(t,e,r){if(e.search(c9)>=0)throw _m(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new z0(...e.split("."))._internalPath}catch{throw _m(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function _m(t,e,r,n,a){const i=n&&!n.isEmpty(),o=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let f="";return(i||o)&&(f+=" (found",i&&(f+=` in field ${n}`),o&&(f+=` in document ${a}`),f+=")"),new $e(Ie.INVALID_ARGUMENT,u+t+f)}function VA(t,e){return t.some((r=>r.isEqual(e)))}class UA{constructor(e,r,n,a,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Vr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new u9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(up("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class u9 extends UA{data(){return super.data()}}function up(t,e){return typeof e=="string"?qv(t,e):e instanceof z0?e._internalPath:e._delegate._internalPath}function zA(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $e(Ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wv{}class HA extends Wv{}function jx(t,e,...r){let n=[];e instanceof Wv&&n.push(e),n=n.concat(r),(function(i){const o=i.filter((f=>f instanceof Xv)).length,u=i.filter((f=>f instanceof fp)).length;if(o>1||o>0&&u>0)throw new $e(Ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(n);for(const a of n)t=a._apply(t);return t}class fp extends HA{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new fp(e,r,n)}_apply(e){const r=this._parse(e);return qA(e._query,r),new eo(e.firestore,e.converter,Tx(e._query,r))}_parse(e){const r=H0(e.firestore);return(function(i,o,u,f,d,m,x){let y;if(d.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new $e(Ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){YE(x,m);const E=[];for(const b of x)E.push(XE(f,i,b));y={arrayValue:{values:E}}}else y=XE(f,i,x)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||YE(x,m),y=o9(u,o,x,m==="in"||m==="not-in");return tn.create(d,m,y)})(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function GA(t,e,r){const n=e,a=up("where",t);return fp._create(a,n,r)}class Xv extends Wv{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Xv(e,r)}_parse(e){const r=this._queryConstraints.map((n=>n._parse(e))).filter((n=>n.getFilters().length>0));return r.length===1?r[0]:Es.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:((function(a,i){let o=a;const u=i.getFlattenedFilters();for(const f of u)qA(o,f),o=Tx(o,f)})(e._query,r),new eo(e.firestore,e.converter,Tx(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Yv extends HA{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Yv(e,r)}_apply(e){const r=(function(a,i,o){if(a.startAt!==null)throw new $e(Ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new $e(Ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new m0(i,o)})(e._query,this._field,this._direction);return new eo(e.firestore,e.converter,(function(a,i){const o=a.explicitOrderBy.concat([i]);return new Ou(a.path,a.collectionGroup,o,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,r))}}function f9(t,e="asc"){const r=e,n=up("orderBy",t);return Yv._create(n,r)}function XE(t,e,r){if(typeof(r=cn(r))=="string"){if(r==="")throw new $e(Ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!L4(e)&&r.indexOf("/")!==-1)throw new $e(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(hr.fromString(r));if(!at.isDocumentKey(n))throw new $e(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return cE(t,new at(n))}if(r instanceof Vr)return cE(t,r._key);throw new $e(Ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ym(r)}.`)}function YE(t,e){if(!Array.isArray(t)||t.length===0)throw new $e(Ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qA(t,e){const r=(function(a,i){for(const o of a)for(const u of o.getFlattenedFilters())if(i.indexOf(u.op)>=0)return u.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(r!==null)throw r===e.op?new $e(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $e(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class h9{convertValue(e,r="none"){switch(Ul(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Lr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Vl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw ct(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Jl(e,((a,i)=>{n[a]=this.convertValue(i,r)})),n}convertVectorValue(e){const r=e.fields?.[hm].arrayValue?.values?.map((n=>Lr(n.doubleValue)));return new Gs(r)}convertGeoPoint(e){return new Hs(Lr(e.latitude),Lr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=Qm(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(f0(e));default:return null}}convertTimestamp(e){const r=Bl(e);return new xr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=hr.fromString(e);Wt(iA(n),9688,{name:e});const a=new h0(n.get(1),n.get(3)),i=new at(n.popFirst(5));return a.isEqual(r)||Di(`Document ${i} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}function $v(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}class Gf{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Po extends UA{constructor(e,r,n,a,i,o){super(e,r,n,a,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new tm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(up("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new $e(Ie.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Po._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Po._jsonSchemaVersion="firestore/documentSnapshot/1.0",Po._jsonSchema={type:rn("string",Po._jsonSchemaVersion),bundleSource:rn("string","DocumentSnapshot"),bundleName:rn("string"),bundle:rn("string")};class tm extends Po{data(e={}){return super.data(e)}}class jo{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new Gf(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new tm(this._firestore,this._userDataWriter,n.key,n,new Gf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new $e(Ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(a,i){if(a._snapshot.oldDocs.isEmpty()){let o=0;return a._snapshot.docChanges.map((u=>{const f=new tm(a._firestore,a._userDataWriter,u.doc.key,u.doc,new Gf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:f,oldIndex:-1,newIndex:o++}}))}{let o=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((u=>i||u.type!==3)).map((u=>{const f=new tm(a._firestore,a._userDataWriter,u.doc.key,u.doc,new Gf(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,m=-1;return u.type!==0&&(d=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),m=o.indexOf(u.doc.key)),{type:d9(u.type),doc:f,oldIndex:d,newIndex:m}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new $e(Ie.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=jo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xv.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach((i=>{i._document!==null&&(r.push(i._document),n.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),a.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function d9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ct(61501,{type:t})}}jo._jsonSchemaVersion="firestore/querySnapshot/1.0",jo._jsonSchema={type:rn("string",jo._jsonSchemaVersion),bundleSource:rn("string","QuerySnapshot"),bundleName:rn("string"),bundle:rn("string")};class Kv extends h9{constructor(e){super(),this.firestore=e}convertBytes(e){return new Qa(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Vr(this.firestore,null,r)}}function bl(t){t=Na(t,eo);const e=Na(t.firestore,Fi),r=op(e),n=new Kv(e);return zA(t._query),t9(r,t._query).then((a=>new jo(e,n,t,a)))}function q0(t,e,r){t=Na(t,Vr);const n=Na(t.firestore,Fi),a=$v(t.converter,e,r);return W0(n,[Hv(H0(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,Jn.none())])}function Br(t,e,r,...n){t=Na(t,Vr);const a=Na(t.firestore,Fi),i=H0(a);let o;return o=typeof(e=cn(e))=="string"||e instanceof z0?jA(i,"updateDoc",t._key,e,r,n):PA(i,"updateDoc",t._key,e),W0(a,[o.toMutation(t._key,Jn.exists(!0))])}function wu(t){return W0(Na(t.firestore,Fi),[new rp(t._key,Jn.none())])}function Bs(t,e){const r=Na(t.firestore,Fi),n=Et(t),a=$v(t.converter,e);return W0(r,[Hv(H0(t.firestore),"addDoc",n._key,a,t.converter!==null,{}).toMutation(n._key,Jn.exists(!1))]).then((()=>n))}function pn(t,...e){t=cn(t);let r={includeMetadataChanges:!1,source:"default"},n=0;typeof e[n]!="object"||WE(e[n])||(r=e[n++]);const a={includeMetadataChanges:r.includeMetadataChanges,source:r.source};if(WE(e[n])){const f=e[n];e[n]=f.next?.bind(f),e[n+1]=f.error?.bind(f),e[n+2]=f.complete?.bind(f)}let i,o,u;if(t instanceof Vr)o=Na(t.firestore,Fi),u=Ev(t._key.path),i={next:f=>{e[n]&&e[n](m9(o,t,f))},error:e[n+1],complete:e[n+2]};else{const f=Na(t,eo);o=Na(f.firestore,Fi),u=f._query;const d=new Kv(o);i={next:m=>{e[n]&&e[n](new jo(o,d,f,m))},error:e[n+1],complete:e[n+2]},zA(t._query)}return(function(d,m,x,y){const w=new RA(y),E=new wA(m,w,x);return d.asyncQueue.enqueueAndForget((async()=>yA(await Mx(d),E))),()=>{w.Nu(),d.asyncQueue.enqueueAndForget((async()=>_A(await Mx(d),E)))}})(op(o),u,a,i)}function W0(t,e){return(function(n,a){const i=new Fl;return n.asyncQueue.enqueueAndForget((async()=>HO(await e9(n),a,i))),i.promise})(op(t),e)}function m9(t,e,r){const n=r.docs.get(e._key),a=new Kv(t);return new Po(t,a,e._key,n,new Gf(r.hasPendingWrites,r.fromCache),e.converter)}class p9{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=H0(e)}set(e,r,n){this._verifyNotCommitted();const a=H1(e,this._firestore),i=$v(a.converter,r,n),o=Hv(this._dataReader,"WriteBatch.set",a._key,i,a.converter!==null,n);return this._mutations.push(o.toMutation(a._key,Jn.none())),this}update(e,r,n,...a){this._verifyNotCommitted();const i=H1(e,this._firestore);let o;return o=typeof(r=cn(r))=="string"||r instanceof z0?jA(this._dataReader,"WriteBatch.update",i._key,r,n,a):PA(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,Jn.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=H1(e,this._firestore);return this._mutations=this._mutations.concat(new rp(r._key,Jn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new $e(Ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function H1(t,e){if((t=cn(t)).firestore!==e)throw new $e(Ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Lx(t){return op(t=Na(t,Fi)),new p9(t,(e=>W0(t,e)))}(function(e,r=!0){(function(a){Ru=a})(Nu),mu(new Go("firestore",((n,{instanceIdentifier:a,options:i})=>{const o=n.getProvider("app").getImmediate(),u=new Fi(new uD(n.getProvider("auth-internal")),new dD(o,n.getProvider("app-check-internal")),(function(d,m){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new $e(Ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new h0(d.options.projectId,m)})(o,a),o);return i={useFetchStreams:r,...i},u._setSettings(i),u}),"PUBLIC").setMultipleInstances(!0)),Dl(Kb,Qb,e),Dl(Kb,Qb,"esm2020")})();function WA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const g9=WA,XA=new M0("auth","Firebase",WA());const wm=new dv("@firebase/auth");function x9(t,...e){wm.logLevel<=Rt.WARN&&wm.warn(`Auth (${Nu}): ${t}`,...e)}function rm(t,...e){wm.logLevel<=Rt.ERROR&&wm.error(`Auth (${Nu}): ${t}`,...e)}function Mi(t,...e){throw Qv(t,...e)}function qs(t,...e){return Qv(t,...e)}function YA(t,e,r){const n={...g9(),[e]:r};return new M0("auth","Firebase",n).create(e,{appName:t.name})}function Pl(t){return YA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qv(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return XA.create(t,...e)}function ft(t,e,...r){if(!t)throw Qv(e,...r)}function bi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw rm(e),new Error(e)}function Pi(t,e){t||bi(e)}function Bx(){return typeof self<"u"&&self.location?.href||""}function v9(){return $E()==="http:"||$E()==="https:"}function $E(){return typeof self<"u"&&self.location?.protocol||null}function y9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(v9()||U5()||"connection"in navigator)?navigator.onLine:!0}function _9(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class X0{constructor(e,r){this.shortDelay=e,this.longDelay=r,Pi(r>e,"Short delay should be less than long delay!"),this.isMobile=L5()||z5()}get(){return y9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Jv(t,e){Pi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class $A{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;bi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;bi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;bi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const w9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const b9=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],E9=new X0(3e4,6e4);function hp(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Mu(t,e,r,n,a={}){return KA(t,a,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const u=P0({key:t.config.apiKey,...o}).slice(1),f=await t._getAdditionalHeaders();f["Content-Type"]="application/json",t.languageCode&&(f["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:f,...i};return V5()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Cu(t.emulatorConfig.host)&&(d.credentials="include"),$A.fetch()(await JA(t,t.config.apiHost,r,u),d)})}async function KA(t,e,r){t._canInitEmulator=!1;const n={...w9,...e};try{const a=new T9(t),i=await Promise.race([r(),a.promise]);a.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Dd(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const u=i.ok?o.errorMessage:o.error.message,[f,d]=u.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Dd(t,"credential-already-in-use",o);if(f==="EMAIL_EXISTS")throw Dd(t,"email-already-in-use",o);if(f==="USER_DISABLED")throw Dd(t,"user-disabled",o);const m=n[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw YA(t,m,d);Mi(t,m)}}catch(a){if(a instanceof Li)throw a;Mi(t,"network-request-failed",{message:String(a)})}}async function QA(t,e,r,n,a={}){const i=await Mu(t,e,r,n,a);return"mfaPendingCredential"in i&&Mi(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function JA(t,e,r,n){const a=`${e}${r}?${n}`,i=t,o=i.config.emulator?Jv(t.config,a):`${t.config.apiScheme}://${a}`;return b9.includes(r)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class T9{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(qs(this.auth,"network-request-failed")),E9.get())})}}function Dd(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const a=qs(t,e,n);return a.customData._tokenResponse=r,a}async function S9(t,e){return Mu(t,"POST","/v1/accounts:delete",e)}async function bm(t,e){return Mu(t,"POST","/v1/accounts:lookup",e)}function Zf(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function A9(t,e=!1){const r=cn(t),n=await r.getIdToken(e),a=Zv(n);ft(a&&a.exp&&a.auth_time&&a.iat,r.auth,"internal-error");const i=typeof a.firebase=="object"?a.firebase:void 0,o=i?.sign_in_provider;return{claims:a,token:n,authTime:Zf(G1(a.auth_time)),issuedAtTime:Zf(G1(a.iat)),expirationTime:Zf(G1(a.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function G1(t){return Number(t)*1e3}function Zv(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return rm("JWT malformed, contained fewer than 3 sections"),null;try{const a=e4(r);return a?JSON.parse(a):(rm("Failed to decode base64 JWT payload"),null)}catch(a){return rm("Caught error parsing JWT payload as JSON",a?.toString()),null}}function KE(t){const e=Zv(t);return ft(e,"internal-error"),ft(typeof e.exp<"u","internal-error"),ft(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function x0(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Li&&k9(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function k9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class C9{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Vx{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Zf(this.lastLoginAt),this.creationTime=Zf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Em(t){const e=t.auth,r=await t.getIdToken(),n=await x0(t,bm(e,{idToken:r}));ft(n?.users.length,e,"internal-error");const a=n.users[0];t._notifyReloadListener(a);const i=a.providerUserInfo?.length?ZA(a.providerUserInfo):[],o=R9(t.providerData,i),u=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!o?.length,d=u?f:!1,m={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new Vx(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(t,m)}async function N9(t){const e=cn(t);await Em(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function R9(t,e){return[...t.filter(n=>!e.some(a=>a.providerId===n.providerId)),...e]}function ZA(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function I9(t,e){const r=await KA(t,{},async()=>{const n=P0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:i}=t.config,o=await JA(t,a,"/v1/token",`key=${i}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:u,body:n};return t.emulatorConfig&&Cu(t.emulatorConfig.host)&&(f.credentials="include"),$A.fetch()(o,f)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function D9(t,e){return Mu(t,"POST","/v2/accounts:revokeToken",hp(t,e))}class iu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ft(e.idToken,"internal-error"),ft(typeof e.idToken<"u","internal-error"),ft(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):KE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ft(e.length!==0,"internal-error");const r=KE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ft(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:a,expiresIn:i}=await I9(e,r);this.updateTokensAndExpiration(n,a,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:a,expirationTime:i}=r,o=new iu;return n&&(ft(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),a&&(ft(typeof a=="string","internal-error",{appName:e}),o.accessToken=a),i&&(ft(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new iu,this.toJSON())}_performRefresh(){return bi("not implemented")}}function _l(t,e){ft(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class vs{constructor({uid:e,auth:r,stsTokenManager:n,...a}){this.providerId="firebase",this.proactiveRefresh=new C9(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Vx(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await x0(this,this.stsTokenManager.getToken(this.auth,e));return ft(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return A9(this,e)}reload(){return N9(this)}_assign(e){this!==e&&(ft(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new vs({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){ft(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await Em(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(xs(this.auth.app))return Promise.reject(Pl(this.auth));const e=await this.getIdToken();return await x0(this,S9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const n=r.displayName??void 0,a=r.email??void 0,i=r.phoneNumber??void 0,o=r.photoURL??void 0,u=r.tenantId??void 0,f=r._redirectEventId??void 0,d=r.createdAt??void 0,m=r.lastLoginAt??void 0,{uid:x,emailVerified:y,isAnonymous:w,providerData:E,stsTokenManager:b}=r;ft(x&&b,e,"internal-error");const T=iu.fromJSON(this.name,b);ft(typeof x=="string",e,"internal-error"),_l(n,e.name),_l(a,e.name),ft(typeof y=="boolean",e,"internal-error"),ft(typeof w=="boolean",e,"internal-error"),_l(i,e.name),_l(o,e.name),_l(u,e.name),_l(f,e.name),_l(d,e.name),_l(m,e.name);const I=new vs({uid:x,auth:e,email:a,emailVerified:y,displayName:n,isAnonymous:w,photoURL:o,phoneNumber:i,tenantId:u,stsTokenManager:T,createdAt:d,lastLoginAt:m});return E&&Array.isArray(E)&&(I.providerData=E.map(R=>({...R}))),f&&(I._redirectEventId=f),I}static async _fromIdTokenResponse(e,r,n=!1){const a=new iu;a.updateFromServerResponse(r);const i=new vs({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:n});return await Em(i),i}static async _fromGetAccountInfoResponse(e,r,n){const a=r.users[0];ft(a.localId!==void 0,"internal-error");const i=a.providerUserInfo!==void 0?ZA(a.providerUserInfo):[],o=!(a.email&&a.passwordHash)&&!i?.length,u=new iu;u.updateFromIdToken(n);const f=new vs({uid:a.localId,auth:e,stsTokenManager:u,isAnonymous:o}),d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:i,metadata:new Vx(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!i?.length};return Object.assign(f,d),f}}const QE=new Map;function Ei(t){Pi(t instanceof Function,"Expected a class definition");let e=QE.get(t);return e?(Pi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,QE.set(t,e),e)}class ek{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}ek.type="NONE";const JE=ek;function nm(t,e,r){return`firebase:${t}:${e}:${r}`}class lu{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:a,name:i}=this.auth;this.fullUserKey=nm(this.userKey,a.apiKey,i),this.fullPersistenceKey=nm("persistence",a.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await bm(this.auth,{idToken:e}).catch(()=>{});return r?vs._fromGetAccountInfoResponse(this.auth,r,e):null}return vs._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new lu(Ei(JE),e,n);const a=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=a[0]||Ei(JE);const o=nm(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const m=await d._get(o);if(m){let x;if(typeof m=="string"){const y=await bm(e,{idToken:m}).catch(()=>{});if(!y)break;x=await vs._fromGetAccountInfoResponse(e,y,m)}else x=vs._fromJSON(e,m);d!==i&&(u=x),i=d;break}}catch{}const f=a.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!f.length?new lu(i,e,n):(i=f[0],u&&await i._set(o,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new lu(i,e,n))}}function ZE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(ak(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ik(e))return"Blackberry";if(lk(e))return"Webos";if(rk(e))return"Safari";if((e.includes("chrome/")||nk(e))&&!e.includes("edge/"))return"Chrome";if(sk(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function tk(t=Un()){return/firefox\//i.test(t)}function rk(t=Un()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nk(t=Un()){return/crios\//i.test(t)}function ak(t=Un()){return/iemobile/i.test(t)}function sk(t=Un()){return/android/i.test(t)}function ik(t=Un()){return/blackberry/i.test(t)}function lk(t=Un()){return/webos/i.test(t)}function ey(t=Un()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function O9(t=Un()){return ey(t)&&!!window.navigator?.standalone}function F9(){return H5()&&document.documentMode===10}function ok(t=Un()){return ey(t)||sk(t)||lk(t)||ik(t)||/windows phone/i.test(t)||ak(t)}function ck(t,e=[]){let r;switch(t){case"Browser":r=ZE(Un());break;case"Worker":r=`${ZE(Un())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Nu}/${n}`}class M9{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,u)=>{try{const f=e(i);o(f)}catch(f){u(f)}});n.onAbort=r,this.queue.push(n);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const a of r)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function P9(t,e={}){return Mu(t,"GET","/v2/passwordPolicy",hp(t,e))}const j9=6;class L9{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??j9,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),a&&(r.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let a=0;a<e.length;a++)n=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,a,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class B9{constructor(e,r,n,a){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new eT(this),this.idTokenSubscription=new eT(this),this.beforeStateQueue=new M9(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=XA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ei(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await lu.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await bm(this,{idToken:e}),n=await vs._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(xs(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let n=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=n?._redirectEventId,u=await this.tryRedirectSignIn(e);(!i||i===o)&&u?.user&&(n=u.user,a=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return ft(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Em(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_9()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(xs(this.app))return Promise.reject(Pl(this));const r=e?cn(e):null;return r&&ft(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&ft(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return xs(this.app)?Promise.reject(Pl(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return xs(this.app)?Promise.reject(Pl(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ei(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await P9(this),r=new L9(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new M0("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await D9(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ei(e)||this._popupRedirectResolver;ft(r,this,"argument-error"),this.redirectPersistenceManager=await lu.create(this,[Ei(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,a){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(ft(u,this,"internal-error"),u.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const f=e.addObserver(r,n,a);return()=>{o=!0,f()}}else{const f=e.addObserver(r);return()=>{o=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ft(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ck(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(xs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&x9(`Error while retrieving App Check token: ${e.error}`),e?.token}}function dp(t){return cn(t)}class eT{constructor(e){this.auth=e,this.observer=null,this.addObserver=Q5(r=>this.observer=r)}get next(){return ft(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ty={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function V9(t){ty=t}function U9(t){return ty.loadJS(t)}function z9(){return ty.gapiScript}function H9(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function G9(t,e){const r=pv(t,"auth");if(r.isInitialized()){const a=r.getImmediate(),i=r.getOptions();if(Ho(i,e??{}))return a;Mi(a,"already-initialized")}return r.initialize({options:e})}function q9(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Ei);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function W9(t,e,r){const n=dp(t);ft(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const a=!1,i=uk(e),{host:o,port:u}=X9(e),f=u===null?"":`:${u}`,d={url:`${i}//${o}${f}/`},m=Object.freeze({host:o,port:u,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!n._canInitEmulator){ft(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ft(Ho(d,n.config.emulator)&&Ho(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,Cu(o)?(a4(`${i}//${o}${f}`),s4("Auth",!0)):Y9()}function uk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function X9(t){const e=uk(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(n);if(a){const i=a[1];return{host:i,port:tT(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:tT(o)}}}function tT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Y9(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class fk{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return bi("not implemented")}_getIdTokenResponse(e){return bi("not implemented")}_linkToIdToken(e,r){return bi("not implemented")}_getReauthenticationResolver(e){return bi("not implemented")}}async function ou(t,e){return QA(t,"POST","/v1/accounts:signInWithIdp",hp(t,e))}const $9="http://localhost";class Xo extends fk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Xo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Mi("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:a,...i}=r;if(!n||!a)return null;const o=new Xo(n,a);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return ou(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ou(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ou(e,r)}buildRequest(){const e={requestUri:$9,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=P0(r)}return e}}class hk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Y0 extends hk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class El extends Y0{constructor(){super("facebook.com")}static credential(e){return Xo._fromParams({providerId:El.PROVIDER_ID,signInMethod:El.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return El.credentialFromTaggedObject(e)}static credentialFromError(e){return El.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return El.credential(e.oauthAccessToken)}catch{return null}}}El.FACEBOOK_SIGN_IN_METHOD="facebook.com";El.PROVIDER_ID="facebook.com";class Tl extends Y0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Xo._fromParams({providerId:Tl.PROVIDER_ID,signInMethod:Tl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Tl.credentialFromTaggedObject(e)}static credentialFromError(e){return Tl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Tl.credential(r,n)}catch{return null}}}Tl.GOOGLE_SIGN_IN_METHOD="google.com";Tl.PROVIDER_ID="google.com";class Sl extends Y0{constructor(){super("github.com")}static credential(e){return Xo._fromParams({providerId:Sl.PROVIDER_ID,signInMethod:Sl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sl.credentialFromTaggedObject(e)}static credentialFromError(e){return Sl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sl.credential(e.oauthAccessToken)}catch{return null}}}Sl.GITHUB_SIGN_IN_METHOD="github.com";Sl.PROVIDER_ID="github.com";class Al extends Y0{constructor(){super("twitter.com")}static credential(e,r){return Xo._fromParams({providerId:Al.PROVIDER_ID,signInMethod:Al.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Al.credentialFromTaggedObject(e)}static credentialFromError(e){return Al.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Al.credential(r,n)}catch{return null}}}Al.TWITTER_SIGN_IN_METHOD="twitter.com";Al.PROVIDER_ID="twitter.com";async function K9(t,e){return QA(t,"POST","/v1/accounts:signUp",hp(t,e))}class Gl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,a=!1){const i=await vs._fromIdTokenResponse(e,n,a),o=rT(n);return new Gl({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const a=rT(n);return new Gl({user:e,providerId:a,_tokenResponse:n,operationType:r})}}function rT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}async function Q9(t){if(xs(t.app))return Promise.reject(Pl(t));const e=dp(t);if(await e._initializationPromise,e.currentUser?.isAnonymous)return new Gl({user:e.currentUser,providerId:null,operationType:"signIn"});const r=await K9(e,{returnSecureToken:!0}),n=await Gl._fromIdTokenResponse(e,"signIn",r,!0);return await e._updateCurrentUser(n.user),n}class Tm extends Li{constructor(e,r,n,a){super(r.code,r.message),this.operationType=n,this.user=a,Object.setPrototypeOf(this,Tm.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,a){return new Tm(e,r,n,a)}}function dk(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Tm._fromErrorAndOperation(t,i,e,n):i})}async function J9(t,e,r=!1){const n=await x0(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Gl._forOperation(t,"link",n)}async function Z9(t,e,r=!1){const{auth:n}=t;if(xs(n.app))return Promise.reject(Pl(n));const a="reauthenticate";try{const i=await x0(t,dk(n,a,e,t),r);ft(i.idToken,n,"internal-error");const o=Zv(i.idToken);ft(o,n,"internal-error");const{sub:u}=o;return ft(t.uid===u,n,"user-mismatch"),Gl._forOperation(t,a,i)}catch(i){throw i?.code==="auth/user-not-found"&&Mi(n,"user-mismatch"),i}}async function eF(t,e,r=!1){if(xs(t.app))return Promise.reject(Pl(t));const n="signIn",a=await dk(t,n,e),i=await Gl._fromIdTokenResponse(t,n,a);return r||await t._updateCurrentUser(i.user),i}function tF(t,e,r,n){return cn(t).onIdTokenChanged(e,r,n)}function rF(t,e,r){return cn(t).beforeAuthStateChanged(e,r)}function nF(t,e,r,n){return cn(t).onAuthStateChanged(e,r,n)}const Sm="__sak";class mk{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Sm,"1"),this.storage.removeItem(Sm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const aF=1e3,sF=10;class pk extends mk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ok(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),a=this.localCache[r];n!==a&&e(r,a,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,u,f)=>{this.notifyListeners(o,f)});return}const n=e.key;r?this.detachListener():this.stopPolling();const a=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);F9()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,sF):a()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},aF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}pk.type="LOCAL";const iF=pk;class gk extends mk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}gk.type="SESSION";const xk=gk;function lF(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class mp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(a=>a.isListeningto(e));if(r)return r;const n=new mp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:a,data:i}=r.data,o=this.handlersMap[a];if(!o?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:a});const u=Array.from(o).map(async d=>d(r.origin,i)),f=await lF(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:a,response:f})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}mp.receivers=[];function ry(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}class oF{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let i,o;return new Promise((u,f)=>{const d=ry("",20);a.port1.start();const m=setTimeout(()=>{f(new Error("unsupported_event"))},n);o={messageChannel:a,onMessage(x){const y=x;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(m),i=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),u(y.data.response);break;default:clearTimeout(m),clearTimeout(i),f(new Error("invalid_response"));break}}},this.handlers.add(o),a.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[a.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function Ws(){return window}function cF(t){Ws().location.href=t}function vk(){return typeof Ws().WorkerGlobalScope<"u"&&typeof Ws().importScripts=="function"}async function uF(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function fF(){return navigator?.serviceWorker?.controller||null}function hF(){return vk()?self:null}const yk="firebaseLocalStorageDb",dF=1,Am="firebaseLocalStorage",_k="fbase_key";class $0{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function pp(t,e){return t.transaction([Am],e?"readwrite":"readonly").objectStore(Am)}function mF(){const t=indexedDB.deleteDatabase(yk);return new $0(t).toPromise()}function Ux(){const t=indexedDB.open(yk,dF);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(Am,{keyPath:_k})}catch(a){r(a)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(Am)?e(n):(n.close(),await mF(),e(await Ux()))})})}async function nT(t,e,r){const n=pp(t,!0).put({[_k]:e,value:r});return new $0(n).toPromise()}async function pF(t,e){const r=pp(t,!1).get(e),n=await new $0(r).toPromise();return n===void 0?null:n.value}function aT(t,e){const r=pp(t,!0).delete(e);return new $0(r).toPromise()}const gF=800,xF=3;class wk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ux(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>xF)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return vk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=mp._getInstance(hF()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await uF(),!this.activeServiceWorker)return;this.sender=new oF(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||fF()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ux();return await nT(e,Sm,"1"),await aT(e,Sm),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>nT(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>pF(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>aT(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const i=pp(a,!1).getAll();return new $0(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:a,value:i}of e)n.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(i)&&(this.notifyListeners(a,i),r.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!n.has(a)&&(this.notifyListeners(a,null),r.push(a));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const a of Array.from(n))a(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),gF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wk.type="LOCAL";const vF=wk;new X0(3e4,6e4);function yF(t,e){return e?Ei(e):(ft(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class ny extends fk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ou(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ou(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ou(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function _F(t){return eF(t.auth,new ny(t),t.bypassAuthState)}function wF(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),Z9(r,new ny(t),t.bypassAuthState)}async function bF(t){const{auth:e,user:r}=t;return ft(r,e,"internal-error"),J9(r,new ny(t),t.bypassAuthState)}class bk{constructor(e,r,n,a,i=!1){this.auth=e,this.resolver=n,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:a,tenantId:i,error:o,type:u}=e;if(o){this.reject(o);return}const f={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(f))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _F;case"linkViaPopup":case"linkViaRedirect":return bF;case"reauthViaPopup":case"reauthViaRedirect":return wF;default:Mi(this.auth,"internal-error")}}resolve(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const EF=new X0(2e3,1e4);class nu extends bk{constructor(e,r,n,a,i){super(e,r,a,i),this.provider=n,this.authWindow=null,this.pollId=null,nu.currentPopupAction&&nu.currentPopupAction.cancel(),nu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ft(e,this.auth,"internal-error"),e}async onExecution(){Pi(this.filter.length===1,"Popup operations only handle one event");const e=ry();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(qs(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(qs(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nu.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(qs(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,EF.get())};e()}}nu.currentPopupAction=null;const TF="pendingRedirect",am=new Map;class SF extends bk{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=am.get(this.auth._key());if(!e){try{const n=await AF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}am.set(this.auth._key(),e)}return this.bypassAuthState||am.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function AF(t,e){const r=NF(e),n=CF(t);if(!await n._isAvailable())return!1;const a=await n._get(r)==="true";return await n._remove(r),a}function kF(t,e){am.set(t._key(),e)}function CF(t){return Ei(t._redirectPersistence)}function NF(t){return nm(TF,t.config.apiKey,t.name)}async function RF(t,e,r=!1){if(xs(t.app))return Promise.reject(Pl(t));const n=dp(t),a=yF(n,e),o=await new SF(n,a,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}const IF=600*1e3;class DF{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!OF(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!Ek(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";r.onError(qs(this.auth,n))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=IF&&this.cachedEventUids.clear(),this.cachedEventUids.has(sT(e))}saveEventToCache(e){this.cachedEventUids.add(sT(e)),this.lastProcessedEventTime=Date.now()}}function sT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Ek({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function OF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ek(t);default:return!1}}async function FF(t,e={}){return Mu(t,"GET","/v1/projects",e)}const MF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,PF=/^https?/;async function jF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await FF(t);for(const r of e)try{if(LF(r))return}catch{}Mi(t,"unauthorized-domain")}function LF(t){const e=Bx(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!PF.test(r))return!1;if(MF.test(t))return n===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(n)}const BF=new X0(3e4,6e4);function iT(){const t=Ws().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function VF(t){return new Promise((e,r)=>{function n(){iT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iT(),r(qs(t,"network-request-failed"))},timeout:BF.get()})}if(Ws().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Ws().gapi?.load)n();else{const a=H9("iframefcb");return Ws()[a]=()=>{gapi.load?n():r(qs(t,"network-request-failed"))},U9(`${z9()}?onload=${a}`).catch(i=>r(i))}}).catch(e=>{throw sm=null,e})}let sm=null;function UF(t){return sm=sm||VF(t),sm}const zF=new X0(5e3,15e3),HF="__/auth/iframe",GF="emulator/auth/iframe",qF={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},WF=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function XF(t){const e=t.config;ft(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Jv(e,GF):`https://${t.config.authDomain}/${HF}`,n={apiKey:e.apiKey,appName:t.name,v:Nu},a=WF.get(t.config.apiHost);a&&(n.eid=a);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${P0(n).slice(1)}`}async function YF(t){const e=await UF(t),r=Ws().gapi;return ft(r,t,"internal-error"),e.open({where:document.body,url:XF(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:qF,dontclear:!0},n=>new Promise(async(a,i)=>{await n.restyle({setHideOnLeave:!1});const o=qs(t,"network-request-failed"),u=Ws().setTimeout(()=>{i(o)},zF.get());function f(){Ws().clearTimeout(u),a(n)}n.ping(f).then(f,()=>{i(o)})}))}const $F={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},KF=500,QF=600,JF="_blank",ZF="http://localhost";class lT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function eM(t,e,r,n=KF,a=QF){const i=Math.max((window.screen.availHeight-a)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const f={...$F,width:n.toString(),height:a.toString(),top:i,left:o},d=Un().toLowerCase();r&&(u=nk(d)?JF:r),tk(d)&&(e=e||ZF,f.scrollbars="yes");const m=Object.entries(f).reduce((y,[w,E])=>`${y}${w}=${E},`,"");if(O9(d)&&u!=="_self")return tM(e||"",u),new lT(null);const x=window.open(e||"",u,m);ft(x,t,"popup-blocked");try{x.focus()}catch{}return new lT(x)}function tM(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}const rM="__/auth/handler",nM="emulator/auth/handler",aM=encodeURIComponent("fac");async function oT(t,e,r,n,a,i){ft(t.config.authDomain,t,"auth-domain-config-required"),ft(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Nu,eventId:a};if(e instanceof hk){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",K5(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,x]of Object.entries({}))o[m]=x}if(e instanceof Y0){const m=e.getScopes().filter(x=>x!=="");m.length>0&&(o.scopes=m.join(","))}t.tenantId&&(o.tid=t.tenantId);const u=o;for(const m of Object.keys(u))u[m]===void 0&&delete u[m];const f=await t._getAppCheckToken(),d=f?`#${aM}=${encodeURIComponent(f)}`:"";return`${sM(t)}?${P0(u).slice(1)}${d}`}function sM({config:t}){return t.emulator?Jv(t,nM):`https://${t.authDomain}/${rM}`}const q1="webStorageSupport";class iM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xk,this._completeRedirectFn=RF,this._overrideRedirectResult=kF}async _openPopup(e,r,n,a){Pi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await oT(e,r,n,Bx(),a);return eM(e,i,ry())}async _openRedirect(e,r,n,a){await this._originValidation(e);const i=await oT(e,r,n,Bx(),a);return cF(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:a,promise:i}=this.eventManagers[r];return a?Promise.resolve(a):(Pi(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await YF(e),n=new DF(e);return r.register("authEvent",a=>(ft(a?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(q1,{type:q1},a=>{const i=a?.[0]?.[q1];i!==void 0&&r(!!i),Mi(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=jF(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return ok()||rk()||ey()}}const lM=iM;var cT="@firebase/auth",uT="1.11.1";class oM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ft(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function cM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function uM(t){mu(new Go("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:u}=n.options;ft(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const f={apiKey:o,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ck(t)},d=new B9(n,a,i,f);return q9(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),mu(new Go("auth-internal",e=>{const r=dp(e.getProvider("auth").getImmediate());return(n=>new oM(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Dl(cT,uT,cM(t)),Dl(cT,uT,"esm2020")}const fM=300,hM=n4("authIdTokenMaxAge")||fM;let fT=null;const dM=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>hM)return;const a=r?.token;fT!==a&&(fT=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function mM(t=c4()){const e=pv(t,"auth");if(e.isInitialized())return e.getImmediate();const r=G9(t,{popupRedirectResolver:lM,persistence:[vF,iF,xk]}),n=n4("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=dM(i.toString());rF(r,o,()=>o(r.currentUser)),tF(r,u=>o(u))}}const a=t4("auth");return a&&W9(r,`http://${a}`),r}function pM(){return document.getElementsByTagName("head")?.[0]??document}V9({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=a=>{const i=qs("internal-error");i.customData=a,r(i)},n.type="text/javascript",n.charset="UTF-8",pM().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});uM("Browser");const gM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xM=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),hT=t=>{const e=xM(t);return e.charAt(0).toUpperCase()+e.slice(1)},Tk=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),vM=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var yM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const _M=re.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...u},f)=>re.createElement("svg",{ref:f,...yM,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:Tk("lucide",a),...!i&&!vM(u)&&{"aria-hidden":"true"},...u},[...o.map(([d,m])=>re.createElement(d,m)),...Array.isArray(i)?i:[i]]));const Ye=(t,e)=>{const r=re.forwardRef(({className:n,...a},i)=>re.createElement(_M,{ref:i,iconNode:e,className:Tk(`lucide-${gM(hT(t))}`,`lucide-${t}`,n),...a}));return r.displayName=hT(t),r};const wM=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],bM=Ye("archive",wM);const EM=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Sk=Ye("arrow-down",EM);const TM=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Ak=Ye("arrow-left",TM);const SM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],AM=Ye("arrow-right",SM);const kM=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],CM=Ye("arrow-up",kM);const NM=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],RM=Ye("bold",NM);const IM=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],ay=Ye("calculator",IM);const DM=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],OM=Ye("calendar",DM);const FM=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],sy=Ye("camera",FM);const MM=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],PM=Ye("chevron-down",MM);const jM=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],LM=Ye("chevron-left",jM);const BM=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],kk=Ye("chevron-right",BM);const VM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],UM=Ye("circle-alert",VM);const zM=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],gp=Ye("circle-check-big",zM);const HM=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],km=Ye("circle-question-mark",HM);const GM=[["path",{d:"M12 6v6h4",key:"135r8i"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Ck=Ye("clock-3",GM);const qM=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],WM=Ye("clock",qM);const XM=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],YM=Ye("cloud-upload",XM);const $M=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Cm=Ye("crown",$M);const KM=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],QM=Ye("database",KM);const JM=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Nk=Ye("dollar-sign",JM);const ZM=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],eP=Ye("download",ZM);const tP=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Ti=Ye("external-link",tP);const rP=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Rk=Ye("file-spreadsheet",rP);const nP=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ik=Ye("file-text",nP);const aP=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],dT=Ye("folder",aP);const sP=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],mT=Ye("heart",sP);const iP=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],K0=Ye("image",iP);const lP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],xp=Ye("info",lP);const oP=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],cP=Ye("italic",oP);const uP=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Dk=Ye("key",uP);const fP=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Nm=Ye("link",fP);const hP=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],dP=Ye("list-checks",hP);const mP=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],pP=Ye("list",mP);const gP=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],xP=Ye("lock",gP);const vP=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Ok=Ye("log-out",vP);const yP=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],_P=Ye("map-pin",yP);const wP=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],zx=Ye("megaphone",wP);const bP=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],pT=Ye("message-square",bP);const EP=[["path",{d:"M5 12h14",key:"1ays0h"}]],iy=Ye("minus",EP);const TP=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],gT=Ye("music",TP);const SP=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],ly=Ye("package",SP);const AP=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],vp=Ye("pen-line",AP);const kP=[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]],Fk=Ye("plane",kP);const CP=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ql=Ye("plus",CP);const NP=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],RP=Ye("refresh-ccw",NP);const IP=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],DP=Ye("refresh-cw",IP);const OP=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],xT=Ye("rocket",OP);const FP=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],MP=Ye("rotate-ccw",FP);const PP=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],nc=Ye("save",PP);const jP=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],oy=Ye("scale",jP);const LP=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],BP=Ye("school",LP);const VP=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Mk=Ye("search",VP);const UP=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Pk=Ye("settings",UP);const zP=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],HP=Ye("shield",zP);const GP=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],jk=Ye("shopping-bag",GP);const qP=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],yp=Ye("shopping-cart",qP);const WP=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],bu=Ye("tag",WP);const XP=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 19H7",key:"4cu937"}]],YP=Ye("text-align-end",XP);const $P=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 19H5",key:"vjpgq2"}]],KP=Ye("text-align-center",$P);const QP=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],JP=Ye("text-align-start",QP);const ZP=[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]],Lk=Ye("ticket",ZP);const ej=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],_p=Ye("trash-2",ej);const tj=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Bk=Ye("triangle-alert",tj);const rj=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],cy=Ye("truck",rj);const nj=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],W1=Ye("type",nj);const aj=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],sj=Ye("underline",aj);const ij=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],uy=Ye("upload",ij);const lj=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Rm=Ye("user",lj);const oj=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],vT=Ye("users",oj);const cj=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],uj=Ye("volume-2",cj);const fj=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],hj=Ye("volume-x",fj);const dj=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ua=Ye("x",dj);const mj=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Im=Ye("zap",mj);const pj=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],gj=Ye("zoom-in",pj);const xj=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],vj=Ye("zoom-out",xj);function yj({users:t,onLogin:e}){const[r,n]=re.useState(""),[a,i]=re.useState(""),o=d=>{d.preventDefault(),e(r,a)},f="PLUS ULTRA  GO BEYOND  PLUS ULTRA  GO BEYOND  ".repeat(4);return p.jsxs("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4 relative overflow-hidden",children:[p.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:"radial-gradient(#ffffff 1px, transparent 1px)",backgroundSize:"20px 20px"}}),p.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-32 flex justify-center pointer-events-none overflow-hidden select-none opacity-10",children:p.jsxs("div",{className:"animate-scroll-down whitespace-nowrap text-8xl font-black text-slate-100 tracking-tighter",style:{writingMode:"vertical-rl"},children:[p.jsx("span",{children:f}),p.jsx("span",{children:f})]})}),p.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-32 flex justify-center pointer-events-none overflow-hidden select-none opacity-10",children:p.jsxs("div",{className:"animate-scroll-up whitespace-nowrap text-8xl font-black text-slate-100 tracking-tighter",style:{writingMode:"vertical-rl"},children:[p.jsx("span",{children:f}),p.jsx("span",{children:f})]})}),p.jsx("style",{jsx:!0,children:`
        @keyframes scroll-up {
          0% { transform: translateY(0); }
          100% { transform: translateY(-50%); }
        }
        
        @keyframes scroll-down {
          0% { transform: translateY(-50%); }
          100% { transform: translateY(0); }
        }

        .animate-scroll-up {
          /* 1.  50s */
          animation: scroll-up 50s linear infinite;
          /* 2.   GPU  () */
          will-change: transform;
        }

        .animate-scroll-down {
          /* 1.  50s */
          animation: scroll-down 50s linear infinite;
          /* 2.   */
          will-change: transform;
        }
      `}),p.jsxs("form",{onSubmit:o,className:`\r
          bg-white w-full max-w-md p-8 rounded-lg \r
          border-4 border-slate-900 \r
          shadow-[8px_8px_0px_0px_#FACC15] \r
          relative overflow-hidden z-10\r
        `,children:[p.jsx("div",{className:"absolute top-0 left-0 w-full h-1/4 bg-red-600 transform -skew-y-3 -mt-8 opacity-10"}),p.jsxs("div",{className:"text-center mb-8 relative z-10",children:[p.jsx("div",{className:"inline-block p-4 bg-slate-900 rounded-full text-yellow-400 mb-4 border-2 border-yellow-400",children:p.jsx(HP,{size:36})}),p.jsx("h1",{className:"text-3xl font-black italic text-slate-900 tracking-wider",children:""}),p.jsx("p",{className:"text-slate-500 text-sm mt-1 font-bold",children:"U.A. ACADEMY LOGIN"})]}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{children:[p.jsxs("label",{className:"text-slate-900 text-sm font-black italic block mb-1 flex items-center gap-1",children:[p.jsx(Rm,{size:16}),"  (Your ID)"]}),p.jsxs("select",{className:`\r
                w-full border-2 border-slate-900 rounded-lg px-3 py-2.5 \r
                bg-slate-50 text-slate-800 font-bold \r
                focus:outline-none focus:ring-4 focus:ring-yellow-400 \r
                transition-all appearance-none\r
              `,value:r,onChange:d=>n(d.target.value),required:!0,children:[p.jsx("option",{value:"",children:"..."}),t.map(d=>p.jsx("option",{value:d.id,children:d.name},d.id))]})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-slate-900 text-sm font-black italic block mb-1 flex items-center gap-1",children:[p.jsx(xP,{size:16}),"  (Password)"]}),p.jsx("input",{type:"password",value:a,onChange:d=>i(d.target.value),placeholder:"",className:`\r
                w-full border-2 border-slate-900 rounded-lg px-3 py-2 \r
                bg-slate-50 text-slate-900 font-bold \r
                focus:outline-none focus:ring-4 focus:ring-yellow-400 \r
                placeholder-slate-400 transition-all\r
              `,required:!0}),p.jsx("span",{className:"text-xs text-slate-500 font-medium mt-1",children:" 4  0 "})]}),p.jsxs("button",{type:"submit",className:`\r
              w-full py-3 mt-4 text-xl \r
              bg-red-600 text-white font-black italic \r
              rounded-lg border-2 border-red-800\r
              shadow-[4px_4px_0px_0px_rgba(15,23,42,1)]\r
              hover:bg-red-700 \r
              disabled:opacity-50 disabled:shadow-none\r
              transition-all transform active:translate-y-0.5 active:translate-x-0.5 active:shadow-none\r
            `,disabled:!r||!a,children:[p.jsx(AM,{size:20,className:"inline mr-2"})," (LOGIN!)"]})]})]})]})}var _j="firebase",wj="12.6.0";Dl(_j,wj,"app");console.log("FB KEY =","AIzaSyD97NjWJOV7NPgAzEEgzX7U31yXkq6L0VI");const bj={apiKey:"AIzaSyD97NjWJOV7NPgAzEEgzX7U31yXkq6L0VI",authDomain:"my-shopping-cart-be7df.firebaseapp.com",projectId:"my-shopping-cart-be7df",storageBucket:"my-shopping-cart-be7df.firebasestorage.app",messagingSenderId:"968807957116",appId:"1:968807957116:web:b4d0c85cc06c9afed53ff9",measurementId:"G-M4E24RKXL0"},Vk=o4(bj),Ke=n9(Vk),X1=mM(Vk);var Ja=function(t,e){return Number(t.toFixed(e))},Ej=function(t,e){return e},br=function(t,e,r){r&&typeof r=="function"&&r(t,e)},Tj=function(t){return-Math.cos(t*Math.PI)/2+.5},Sj=function(t){return t},Aj=function(t){return t*t},kj=function(t){return t*(2-t)},Cj=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},Nj=function(t){return t*t*t},Rj=function(t){return--t*t*t+1},Ij=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},Dj=function(t){return t*t*t*t},Oj=function(t){return 1- --t*t*t*t},Fj=function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},Mj=function(t){return t*t*t*t*t},Pj=function(t){return 1+--t*t*t*t*t},jj=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},Uk={easeOut:Tj,linear:Sj,easeInQuad:Aj,easeOutQuad:kj,easeInOutQuad:Cj,easeInCubic:Nj,easeOutCubic:Rj,easeInOutCubic:Ij,easeInQuart:Dj,easeOutQuart:Oj,easeInOutQuart:Fj,easeInQuint:Mj,easeOutQuint:Pj,easeInOutQuint:jj},zk=function(t){typeof t=="number"&&cancelAnimationFrame(t)},gs=function(t){t.mounted&&(zk(t.animation),t.animate=!1,t.animation=null,t.velocity=null)};function Hk(t,e,r,n){if(t.mounted){var a=new Date().getTime(),i=1;gs(t),t.animation=function(){if(!t.mounted)return zk(t.animation);var o=new Date().getTime()-a,u=o/r,f=Uk[e],d=f(u);o>=r?(n(i),t.animation=null):t.animation&&(n(d),requestAnimationFrame(t.animation))},requestAnimationFrame(t.animation)}}function Lj(t){var e=t.scale,r=t.positionX,n=t.positionY;return!(Number.isNaN(e)||Number.isNaN(r)||Number.isNaN(n))}function to(t,e,r,n){var a=Lj(e);if(!(!t.mounted||!a)){var i=t.setTransformState,o=t.transformState,u=o.scale,f=o.positionX,d=o.positionY,m=e.scale-u,x=e.positionX-f,y=e.positionY-d;r===0?i(e.scale,e.positionX,e.positionY):Hk(t,n,r,function(w){var E=u+m*w,b=f+x*w,T=d+y*w;i(E,b,T)})}}function Bj(t,e,r){var n=t.offsetWidth,a=t.offsetHeight,i=e.offsetWidth,o=e.offsetHeight,u=i*r,f=o*r,d=n-u,m=a-f;return{wrapperWidth:n,wrapperHeight:a,newContentWidth:u,newDiffWidth:d,newContentHeight:f,newDiffHeight:m}}var Vj=function(t,e,r,n,a,i,o){var u=t>e?r*(o?1:.5):0,f=n>a?i*(o?1:.5):0,d=t-e-u,m=u,x=n-a-f,y=f;return{minPositionX:d,maxPositionX:m,minPositionY:x,maxPositionY:y}},fy=function(t,e){var r=t.wrapperComponent,n=t.contentComponent,a=t.setup.centerZoomedOut;if(!r||!n)throw new Error("Components are not mounted");var i=Bj(r,n,e),o=i.wrapperWidth,u=i.wrapperHeight,f=i.newContentWidth,d=i.newDiffWidth,m=i.newContentHeight,x=i.newDiffHeight,y=Vj(o,f,d,u,m,x,!!a);return y},Hx=function(t,e,r,n){return n?t<e?Ja(e,2):t>r?Ja(r,2):Ja(t,2):Ja(t,2)},Lo=function(t,e){var r=fy(t,e);return t.bounds=r,r};function Q0(t,e,r,n,a,i,o){var u=r.minPositionX,f=r.minPositionY,d=r.maxPositionX,m=r.maxPositionY,x=0,y=0;o&&(x=a,y=i);var w=Hx(t,u-x,d+x,n),E=Hx(e,f-y,m+y,n);return{x:w,y:E}}function wp(t,e,r,n,a,i){var o=t.transformState,u=o.scale,f=o.positionX,d=o.positionY,m=n-u;if(typeof e!="number"||typeof r!="number")return console.error("Mouse X and Y position were not provided!"),{x:f,y:d};var x=f-e*m,y=d-r*m,w=Q0(x,y,a,i,0,0,null);return w}function J0(t,e,r,n,a){var i=a?n:0,o=e-i;return!Number.isNaN(r)&&t>=r?r:!Number.isNaN(e)&&t<=o?o:t}var yT=function(t,e){var r=t.setup.panning.excluded,n=t.isInitialized,a=t.wrapperComponent,i=e.target,o="shadowRoot"in i&&"composedPath"in e,u=o?e.composedPath().some(function(m){return m instanceof Element?a?.contains(m):!1}):a?.contains(i),f=n&&i&&u;if(!f)return!1;var d=bp(i,r);return!d},_T=function(t){var e=t.isInitialized,r=t.isPanning,n=t.setup,a=n.panning.disabled,i=e&&r&&!a;return!!i},Uj=function(t,e){var r=t.transformState,n=r.positionX,a=r.positionY;t.isPanning=!0;var i=e.clientX,o=e.clientY;t.startCoords={x:i-n,y:o-a}},zj=function(t,e){var r=e.touches,n=t.transformState,a=n.positionX,i=n.positionY;t.isPanning=!0;var o=r.length===1;if(o){var u=r[0].clientX,f=r[0].clientY;t.startCoords={x:u-a,y:f-i}}};function Hj(t){var e=t.transformState,r=e.positionX,n=e.positionY,a=e.scale,i=t.setup,o=i.disabled,u=i.limitToBounds,f=i.centerZoomedOut,d=t.wrapperComponent;if(!(o||!d||!t.bounds)){var m=t.bounds,x=m.maxPositionX,y=m.minPositionX,w=m.maxPositionY,E=m.minPositionY,b=r>x||r<y,T=n>w||n<E,I=r>x?d.offsetWidth:t.setup.minPositionX||0,R=n>w?d.offsetHeight:t.setup.minPositionY||0,C=wp(t,I,R,a,t.bounds,u||f),G=C.x,V=C.y;return{scale:a,positionX:b?G:r,positionY:T?V:n}}}function Gk(t,e,r,n,a){var i=t.setup.limitToBounds,o=t.wrapperComponent,u=t.bounds,f=t.transformState,d=f.scale,m=f.positionX,x=f.positionY;if(!(o===null||u===null||e===m&&r===x)){var y=Q0(e,r,u,i,n,a,o),w=y.x,E=y.y;t.setTransformState(d,w,E)}}var Gj=function(t,e,r){var n=t.startCoords,a=t.transformState,i=t.setup.panning,o=i.lockAxisX,u=i.lockAxisY,f=a.positionX,d=a.positionY;if(!n)return{x:f,y:d};var m=e-n.x,x=r-n.y,y=o?f:m,w=u?d:x;return{x:y,y:w}},Wl=function(t,e){var r=t.setup,n=t.transformState,a=n.scale,i=r.minScale,o=r.disablePadding;return e>0&&a>=i&&!o?e:0},qj=function(t){var e=t.mounted,r=t.setup,n=r.disabled,a=r.velocityAnimation,i=t.transformState.scale,o=a.disabled,u=!o||i>1||!n||e;return!!u},Wj=function(t){var e=t.mounted,r=t.velocity,n=t.bounds,a=t.setup,i=a.disabled,o=a.velocityAnimation,u=t.transformState.scale,f=o.disabled,d=!f||u>1||!i||e;return!(!d||!r||!n)};function Xj(t,e){var r=t.setup.velocityAnimation,n=r.equalToMove,a=r.animationTime,i=r.sensitivity;return n?a*e*i:a}function wT(t,e,r,n,a,i,o,u,f,d){if(a){if(e>o&&r>o){var m=o+(t-o)*d;return m>f?f:m<o?o:m}if(e<i&&r<i){var m=i+(t-i)*d;return m<u?u:m>i?i:m}}return n?e:Hx(t,i,o,a)}function Yj(t,e){var r=1;return e?Math.min(r,t.offsetWidth/window.innerWidth):r}function $j(t,e){var r=qj(t);if(r){var n=t.lastMousePosition,a=t.velocityTime,i=t.setup,o=t.wrapperComponent,u=i.velocityAnimation.equalToMove,f=Date.now();if(n&&a&&o){var d=Yj(o,u),m=e.x-n.x,x=e.y-n.y,y=m/d,w=x/d,E=f-a,b=m*m+x*x,T=Math.sqrt(b)/E;t.velocity={velocityX:y,velocityY:w,total:T}}t.lastMousePosition=e,t.velocityTime=f}}function Kj(t){var e=t.velocity,r=t.bounds,n=t.setup,a=t.wrapperComponent,i=Wj(t);if(!(!i||!e||!r||!a)){var o=e.velocityX,u=e.velocityY,f=e.total,d=r.maxPositionX,m=r.minPositionX,x=r.maxPositionY,y=r.minPositionY,w=n.limitToBounds,E=n.alignmentAnimation,b=n.zoomAnimation,T=n.panning,I=T.lockAxisY,R=T.lockAxisX,C=b.animationType,G=E.sizeX,V=E.sizeY,H=E.velocityAlignmentTime,A=H,D=Xj(t,f),N=Math.max(D,A),M=Wl(t,G),F=Wl(t,V),j=M*a.offsetWidth/100,P=F*a.offsetHeight/100,be=d+j,ye=m-j,se=x+P,ce=y-P,le=t.transformState,te=new Date().getTime();Hk(t,C,N,function(_e){var Q=t.transformState,L=Q.scale,J=Q.positionX,Y=Q.positionY,ne=new Date().getTime()-te,ue=ne/A,Te=Uk[E.animationType],Re=1-Te(Math.min(1,ue)),Ae=1-_e,Fe=J+o*Ae,st=Y+u*Ae,B=wT(Fe,le.positionX,J,R,w,m,d,ye,be,Re),Xe=wT(st,le.positionY,Y,I,w,y,x,ce,se,Re);(J!==Fe||Y!==st)&&t.setTransformState(L,B,Xe)})}}function bT(t,e){var r=t.transformState.scale;gs(t),Lo(t,r),window.TouchEvent!==void 0&&e instanceof TouchEvent?zj(t,e):Uj(t,e)}function hy(t,e){var r=t.transformState.scale,n=t.setup,a=n.minScale,i=n.alignmentAnimation,o=i.disabled,u=i.sizeX,f=i.sizeY,d=i.animationTime,m=i.animationType,x=o||r<a||!u&&!f;if(!x){var y=Hj(t);y&&to(t,y,e??d,m)}}function ET(t,e,r){var n=t.startCoords,a=t.setup,i=a.alignmentAnimation,o=i.sizeX,u=i.sizeY;if(n){var f=Gj(t,e,r),d=f.x,m=f.y,x=Wl(t,o),y=Wl(t,u);$j(t,{x:d,y:m}),Gk(t,d,m,x,y)}}function Qj(t){if(t.isPanning){var e=t.setup.panning.velocityDisabled,r=t.velocity,n=t.wrapperComponent,a=t.contentComponent;t.isPanning=!1,t.animate=!1,t.animation=null;var i=n?.getBoundingClientRect(),o=a?.getBoundingClientRect(),u=i?.width||0,f=i?.height||0,d=o?.width||0,m=o?.height||0,x=u<d||f<m,y=!e&&r&&r?.total>.1&&x;y?Kj(t):hy(t)}}function dy(t,e,r,n){var a=t.setup,i=a.minScale,o=a.maxScale,u=a.limitToBounds,f=J0(Ja(e,2),i,o,0,!1),d=Lo(t,f),m=wp(t,r,n,f,d,u),x=m.x,y=m.y;return{scale:f,positionX:x,positionY:y}}function qk(t,e,r){var n=t.transformState.scale,a=t.wrapperComponent,i=t.setup,o=i.minScale,u=i.limitToBounds,f=i.zoomAnimation,d=f.disabled,m=f.animationTime,x=f.animationType,y=d||n>=o;if((n>=1||u)&&hy(t),!(y||!a||!t.mounted)){var w=e||a.offsetWidth/2,E=r||a.offsetHeight/2,b=dy(t,o,w,E);b&&to(t,b,m,x)}}var jl=function(){return jl=Object.assign||function(e){for(var r,n=1,a=arguments.length;n<a;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},jl.apply(this,arguments)};function TT(t,e,r){for(var n=0,a=e.length,i;n<a;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}var Od={scale:1,positionX:0,positionY:0},Lf={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},Gx={wrapperClass:"react-transform-wrapper",contentClass:"react-transform-component"},Wk=function(t){var e,r,n,a;return{previousScale:(e=t.initialScale)!==null&&e!==void 0?e:Od.scale,scale:(r=t.initialScale)!==null&&r!==void 0?r:Od.scale,positionX:(n=t.initialPositionX)!==null&&n!==void 0?n:Od.positionX,positionY:(a=t.initialPositionY)!==null&&a!==void 0?a:Od.positionY}},ST=function(t){var e=jl({},Lf);return Object.keys(t).forEach(function(r){var n=typeof t[r]<"u",a=typeof Lf[r]<"u";if(a&&n){var i=Object.prototype.toString.call(Lf[r]),o=i==="[object Object]",u=i==="[object Array]";o?e[r]=jl(jl({},Lf[r]),t[r]):u?e[r]=TT(TT([],Lf[r],!0),t[r]):e[r]=t[r]}}),e},Xk=function(t,e,r){var n=t.transformState.scale,a=t.wrapperComponent,i=t.setup,o=i.maxScale,u=i.minScale,f=i.zoomAnimation,d=i.smooth,m=f.size;if(!a)throw new Error("Wrapper is not mounted");var x=d?n*Math.exp(e*r):n+e*r,y=J0(Ja(x,3),u,o,m,!1);return y};function Yk(t,e,r,n,a){var i=t.wrapperComponent,o=t.transformState,u=o.scale,f=o.positionX,d=o.positionY;if(!i)return console.error("No WrapperComponent found");var m=i.offsetWidth,x=i.offsetHeight,y=(m/2-f)/u,w=(x/2-d)/u,E=Xk(t,e,r),b=dy(t,E,y,w);if(!b)return console.error("Error during zoom event. New transformation state was not calculated.");to(t,b,n,a)}function $k(t,e,r,n){var a=t.setup,i=t.wrapperComponent,o=a.limitToBounds,u=Wk(t.props),f=t.transformState,d=f.scale,m=f.positionX,x=f.positionY;if(i){var y=fy(t,u.scale),w=Q0(u.positionX,u.positionY,y,o,0,0,i),E={scale:u.scale,positionX:w.x,positionY:w.y};d===u.scale&&m===u.positionX&&x===u.positionY||(n?.(),to(t,E,e,r))}}function Jj(t,e,r,n){var a=t.getBoundingClientRect(),i=e.getBoundingClientRect(),o=r.getBoundingClientRect(),u=i.x*n.scale,f=i.y*n.scale;return{x:(a.x-o.x+u)/n.scale,y:(a.y-o.y+f)/n.scale}}function Zj(t,e,r){var n=t.wrapperComponent,a=t.contentComponent,i=t.transformState,o=t.setup,u=o.limitToBounds,f=o.minScale,d=o.maxScale;if(!n||!a)return i;var m=n.getBoundingClientRect(),x=e.getBoundingClientRect(),y=Jj(e,n,a,i),w=y.x,E=y.y,b=x.width/i.scale,T=x.height/i.scale,I=n.offsetWidth/b,R=n.offsetHeight/T,C=J0(r||Math.min(I,R),f,d,0,!1),G=(m.width-b*C)/2,V=(m.height-T*C)/2,H=(m.left-w)*C+G,A=(m.top-E)*C+V,D=fy(t,C),N=Q0(H,A,D,u,0,0,n),M=N.x,F=N.y;return{positionX:M,positionY:F,scale:C}}var eL=function(t){return function(e,r,n){e===void 0&&(e=.5),r===void 0&&(r=300),n===void 0&&(n="easeOut"),Yk(t,1,e,r,n)}},tL=function(t){return function(e,r,n){e===void 0&&(e=.5),r===void 0&&(r=300),n===void 0&&(n="easeOut"),Yk(t,-1,e,r,n)}},rL=function(t){return function(e,r,n,a,i){a===void 0&&(a=300),i===void 0&&(i="easeOut");var o=t.transformState,u=o.positionX,f=o.positionY,d=o.scale,m=t.wrapperComponent,x=t.contentComponent,y=t.setup.disabled;if(!(y||!m||!x)){var w={positionX:Number.isNaN(e)?u:e,positionY:Number.isNaN(r)?f:r,scale:Number.isNaN(n)?d:n};to(t,w,a,i)}}},nL=function(t){return function(e,r){e===void 0&&(e=200),r===void 0&&(r="easeOut"),$k(t,e,r)}},aL=function(t){return function(e,r,n){r===void 0&&(r=200),n===void 0&&(n="easeOut");var a=t.transformState,i=t.wrapperComponent,o=t.contentComponent;if(i&&o){var u=Kk(e||a.scale,i,o);to(t,u,r,n)}}},sL=function(t){return function(e,r,n,a){n===void 0&&(n=600),a===void 0&&(a="easeOut"),gs(t);var i=t.wrapperComponent,o=typeof e=="string"?document.getElementById(e):e;if(i&&o&&i.contains(o)){var u=Zj(t,o,r);to(t,u,n,a)}}},qx=function(t){return{instance:t,zoomIn:eL(t),zoomOut:tL(t),setTransform:rL(t),resetTransform:nL(t),centerView:aL(t),zoomToElement:sL(t)}},iL=function(t){return{instance:t,state:t.transformState}},fr=function(t){var e={};return Object.assign(e,iL(t)),Object.assign(e,qx(t)),e},Y1=!1;function $1(){try{var t={get passive(){return Y1=!0,!1}};return t}catch{return Y1=!1,Y1}}var Fd=".".concat(Gx.wrapperClass),bp=function(t,e){return e.some(function(r){return t.matches("".concat(Fd," ").concat(r,", ").concat(Fd," .").concat(r,", ").concat(Fd," ").concat(r," *, ").concat(Fd," .").concat(r," *"))})},Wx=function(t){t&&clearTimeout(t)},lL=function(t,e,r){return"translate(".concat(t,"px, ").concat(e,"px) scale(").concat(r,")")},Kk=function(t,e,r){var n=r.offsetWidth*t,a=r.offsetHeight*t,i=(e.offsetWidth-n)/2,o=(e.offsetHeight-a)/2;return{scale:t,positionX:i,positionY:o}};function oL(t){return function(e){t.forEach(function(r){typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var cL=function(t,e){var r=t.setup.wheel,n=r.disabled,a=r.wheelDisabled,i=r.touchPadDisabled,o=r.excluded,u=t.isInitialized,f=t.isPanning,d=e.target,m=u&&!f&&!n&&d;if(!m||a&&!e.ctrlKey||i&&e.ctrlKey)return!1;var x=bp(d,o);return!x},uL=function(t){return t?t.deltaY<0?1:-1:0};function fL(t,e){var r=uL(t),n=Ej(e,r);return n}function Qk(t,e,r){var n=e.getBoundingClientRect(),a=0,i=0;if("clientX"in t)a=(t.clientX-n.left)/r,i=(t.clientY-n.top)/r;else{var o=t.touches[0];a=(o.clientX-n.left)/r,i=(o.clientY-n.top)/r}return(Number.isNaN(a)||Number.isNaN(i))&&console.error("No mouse or touch offset found"),{x:a,y:i}}var hL=function(t,e,r,n,a){var i=t.transformState.scale,o=t.wrapperComponent,u=t.setup,f=u.maxScale,d=u.minScale,m=u.zoomAnimation,x=u.disablePadding,y=m.size,w=m.disabled;if(!o)throw new Error("Wrapper is not mounted");var E=i+e*r,b=n?!1:!w,T=J0(Ja(E,3),d,f,y,b&&!x);return T},dL=function(t,e){var r=t.previousWheelEvent,n=t.transformState.scale,a=t.setup,i=a.maxScale,o=a.minScale;return r?n<i||n>o||Math.sign(r.deltaY)!==Math.sign(e.deltaY)||r.deltaY>0&&r.deltaY<e.deltaY||r.deltaY<0&&r.deltaY>e.deltaY||Math.sign(r.deltaY)!==Math.sign(e.deltaY):!1},mL=function(t,e){var r=t.setup.pinch,n=r.disabled,a=r.excluded,i=t.isInitialized,o=e.target,u=i&&!n&&o;if(!u)return!1;var f=bp(o,a);return!f},pL=function(t){var e=t.setup.pinch.disabled,r=t.isInitialized,n=t.pinchStartDistance,a=r&&!e&&n;return!!a},gL=function(t,e,r){var n=r.getBoundingClientRect(),a=t.touches,i=Ja(a[0].clientX-n.left,5),o=Ja(a[0].clientY-n.top,5),u=Ja(a[1].clientX-n.left,5),f=Ja(a[1].clientY-n.top,5);return{x:(i+u)/2/e,y:(o+f)/2/e}},Jk=function(t){return Math.sqrt(Math.pow(t.touches[0].pageX-t.touches[1].pageX,2)+Math.pow(t.touches[0].pageY-t.touches[1].pageY,2))},xL=function(t,e){var r=t.pinchStartScale,n=t.pinchStartDistance,a=t.setup,i=a.maxScale,o=a.minScale,u=a.zoomAnimation,f=a.disablePadding,d=u.size,m=u.disabled;if(!r||n===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return t.transformState.scale;var x=e/n,y=x*r;return J0(Ja(y,2),o,i,d,!m&&!f)},vL=160,yL=100,_L=function(t,e){var r=t.props,n=r.onWheelStart,a=r.onZoomStart;t.wheelStopEventTimer||(gs(t),br(fr(t),e,n),br(fr(t),e,a))},wL=function(t,e){var r=t.props,n=r.onWheel,a=r.onZoom,i=t.contentComponent,o=t.setup,u=t.transformState,f=u.scale,d=o.limitToBounds,m=o.centerZoomedOut,x=o.zoomAnimation,y=o.wheel,w=o.disablePadding,E=o.smooth,b=x.size,T=x.disabled,I=y.step,R=y.smoothStep;if(!i)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var C=fL(e,null),G=E?R*Math.abs(e.deltaY):I,V=hL(t,C,G,!e.ctrlKey);if(f!==V){var H=Lo(t,V),A=Qk(e,i,f),D=T||b===0||m||w,N=d&&D,M=wp(t,A.x,A.y,V,H,N),F=M.x,j=M.y;t.previousWheelEvent=e,t.setTransformState(V,F,j),br(fr(t),e,n),br(fr(t),e,a)}},bL=function(t,e){var r=t.props,n=r.onWheelStop,a=r.onZoomStop;Wx(t.wheelAnimationTimer),t.wheelAnimationTimer=setTimeout(function(){t.mounted&&(qk(t,e.x,e.y),t.wheelAnimationTimer=null)},yL);var i=dL(t,e);i&&(Wx(t.wheelStopEventTimer),t.wheelStopEventTimer=setTimeout(function(){t.mounted&&(t.wheelStopEventTimer=null,br(fr(t),e,n),br(fr(t),e,a))},vL))},Zk=function(t){for(var e=0,r=0,n=0;n<2;n+=1)e+=t.touches[n].clientX,r+=t.touches[n].clientY;var a=e/2,i=r/2;return{x:a,y:i}},EL=function(t,e){var r=Jk(e);t.pinchStartDistance=r,t.lastDistance=r,t.pinchStartScale=t.transformState.scale,t.isPanning=!1;var n=Zk(e);t.pinchLastCenterX=n.x,t.pinchLastCenterY=n.y,gs(t)},TL=function(t,e){var r=t.contentComponent,n=t.pinchStartDistance,a=t.wrapperComponent,i=t.transformState.scale,o=t.setup,u=o.limitToBounds,f=o.centerZoomedOut,d=o.zoomAnimation,m=o.alignmentAnimation,x=d.disabled,y=d.size;if(!(n===null||!r)){var w=gL(e,i,r);if(!(!Number.isFinite(w.x)||!Number.isFinite(w.y))){var E=Jk(e),b=xL(t,E),T=Zk(e),I=T.x-(t.pinchLastCenterX||0),R=T.y-(t.pinchLastCenterY||0);if(!(b===i&&I===0&&R===0)){t.pinchLastCenterX=T.x,t.pinchLastCenterY=T.y;var C=Lo(t,b),G=x||y===0||f,V=u&&G,H=wp(t,w.x,w.y,b,C,V),A=H.x,D=H.y;t.pinchMidpoint=w,t.lastDistance=E;var N=m.sizeX,M=m.sizeY,F=Wl(t,N),j=Wl(t,M),P=A+I,be=D+R,ye=Q0(P,be,C,u,F,j,a),se=ye.x,ce=ye.y;t.setTransformState(b,se,ce)}}}},SL=function(t){var e=t.pinchMidpoint;t.velocity=null,t.lastDistance=null,t.pinchMidpoint=null,t.pinchStartScale=null,t.pinchStartDistance=null,qk(t,e?.x,e?.y)},eC=function(t,e){var r=t.props.onZoomStop,n=t.setup.doubleClick.animationTime;Wx(t.doubleClickStopEventTimer),t.doubleClickStopEventTimer=setTimeout(function(){t.doubleClickStopEventTimer=null,br(fr(t),e,r)},n)},AL=function(t,e){var r=t.props,n=r.onZoomStart,a=r.onZoom,i=t.setup.doubleClick,o=i.animationTime,u=i.animationType;br(fr(t),e,n),$k(t,o,u,function(){return br(fr(t),e,a)}),eC(t,e)};function kL(t,e){return t==="toggle"?e===1?1:-1:t==="zoomOut"?-1:1}function CL(t,e){var r=t.setup,n=t.doubleClickStopEventTimer,a=t.transformState,i=t.contentComponent,o=a.scale,u=t.props,f=u.onZoomStart,d=u.onZoom,m=r.doubleClick,x=m.disabled,y=m.mode,w=m.step,E=m.animationTime,b=m.animationType;if(!x&&!n){if(y==="reset")return AL(t,e);if(!i)return console.error("No ContentComponent found");var T=kL(y,t.transformState.scale),I=Xk(t,T,w);if(o!==I){br(fr(t),e,f);var R=Qk(e,i,o),C=dy(t,I,R.x,R.y);if(!C)return console.error("Error during zoom event. New transformation state was not calculated.");br(fr(t),e,d),to(t,C,E,b),eC(t,e)}}}var NL=function(t,e){var r=t.isInitialized,n=t.setup,a=t.wrapperComponent,i=n.doubleClick,o=i.disabled,u=i.excluded,f=e.target,d=a?.contains(f),m=r&&f&&d&&!o;if(!m)return!1;var x=bp(f,u);return!x},RL=(function(){function t(e){var r=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){r.initializeWindowEvents()},this.unmount=function(){r.cleanupWindowEvents()},this.update=function(n){r.props=n,Lo(r,r.transformState.scale),r.setup=ST(n)},this.initializeWindowEvents=function(){var n,a,i=$1(),o=(n=r.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,u=o?.defaultView;(a=r.wrapperComponent)===null||a===void 0||a.addEventListener("wheel",r.onWheelPanning,i),u?.addEventListener("mousedown",r.onPanningStart,i),u?.addEventListener("mousemove",r.onPanning,i),u?.addEventListener("mouseup",r.onPanningStop,i),o?.addEventListener("mouseleave",r.clearPanning,i),u?.addEventListener("keyup",r.setKeyUnPressed,i),u?.addEventListener("keydown",r.setKeyPressed,i)},this.cleanupWindowEvents=function(){var n,a,i=$1(),o=(n=r.wrapperComponent)===null||n===void 0?void 0:n.ownerDocument,u=o?.defaultView;u?.removeEventListener("mousedown",r.onPanningStart,i),u?.removeEventListener("mousemove",r.onPanning,i),u?.removeEventListener("mouseup",r.onPanningStop,i),o?.removeEventListener("mouseleave",r.clearPanning,i),u?.removeEventListener("keyup",r.setKeyUnPressed,i),u?.removeEventListener("keydown",r.setKeyPressed,i),document.removeEventListener("mouseleave",r.clearPanning,i),gs(r),(a=r.observer)===null||a===void 0||a.disconnect()},this.handleInitializeWrapperEvents=function(n){var a=$1();n.addEventListener("wheel",r.onWheelZoom,a),n.addEventListener("dblclick",r.onDoubleClick,a),n.addEventListener("touchstart",r.onTouchPanningStart,a),n.addEventListener("touchmove",r.onTouchPanning,a),n.addEventListener("touchend",r.onTouchPanningStop,a)},this.handleInitialize=function(n,a){var i=!1,o=r.setup.centerOnInit,u=function(f,d){for(var m=0,x=f;m<x.length;m++){var y=x[m];if(y.target===d)return!0}return!1};r.applyTransformation(),r.onInitCallbacks.forEach(function(f){f(fr(r))}),r.observer=new ResizeObserver(function(f){if(u(f,n)||u(f,a))if(o&&!i){var d=a.offsetWidth,m=a.offsetHeight;(d>0||m>0)&&(i=!0,r.setCenter())}else gs(r),Lo(r,r.transformState.scale),hy(r,0)}),r.observer.observe(n),r.observer.observe(a)},this.onWheelZoom=function(n){var a=r.setup.disabled;if(!a){var i=cL(r,n);if(i){var o=r.isPressingKeys(r.setup.wheel.activationKeys);o&&(_L(r,n),wL(r,n),bL(r,n))}}},this.onWheelPanning=function(n){var a=r.setup,i=a.disabled,o=a.wheel,u=a.panning;if(!(!r.wrapperComponent||!r.contentComponent||i||!o.wheelDisabled||u.disabled||!u.wheelPanning||n.ctrlKey)){n.preventDefault(),n.stopPropagation();var f=r.transformState,d=f.positionX,m=f.positionY,x=d-n.deltaX,y=m-n.deltaY,w=u.lockAxisX?d:x,E=u.lockAxisY?m:y,b=r.setup.alignmentAnimation,T=b.sizeX,I=b.sizeY,R=Wl(r,T),C=Wl(r,I);w===d&&E===m||Gk(r,w,E,R,C)}},this.onPanningStart=function(n){var a=r.setup.disabled,i=r.props.onPanningStart;if(!a){var o=yT(r,n);if(o){var u=r.isPressingKeys(r.setup.panning.activationKeys);u&&(n.button===0&&!r.setup.panning.allowLeftClickPan||n.button===1&&!r.setup.panning.allowMiddleClickPan||n.button===2&&!r.setup.panning.allowRightClickPan||(n.preventDefault(),n.stopPropagation(),gs(r),bT(r,n),br(fr(r),n,i)))}}},this.onPanning=function(n){var a=r.setup.disabled,i=r.props.onPanning;if(!a){var o=_T(r);if(o){var u=r.isPressingKeys(r.setup.panning.activationKeys);u&&(n.preventDefault(),n.stopPropagation(),ET(r,n.clientX,n.clientY),br(fr(r),n,i))}}},this.onPanningStop=function(n){var a=r.props.onPanningStop;r.isPanning&&(Qj(r),br(fr(r),n,a))},this.onPinchStart=function(n){var a=r.setup.disabled,i=r.props,o=i.onPinchingStart,u=i.onZoomStart;if(!a){var f=mL(r,n);f&&(EL(r,n),gs(r),br(fr(r),n,o),br(fr(r),n,u))}},this.onPinch=function(n){var a=r.setup.disabled,i=r.props,o=i.onPinching,u=i.onZoom;if(!a){var f=pL(r);f&&(n.preventDefault(),n.stopPropagation(),TL(r,n),br(fr(r),n,o),br(fr(r),n,u))}},this.onPinchStop=function(n){var a=r.props,i=a.onPinchingStop,o=a.onZoomStop;r.pinchStartScale&&(SL(r),br(fr(r),n,i),br(fr(r),n,o))},this.onTouchPanningStart=function(n){var a=r.setup.disabled,i=r.props.onPanningStart;if(!a){var o=yT(r,n);if(o){var u=r.lastTouch&&+new Date-r.lastTouch<200&&n.touches.length===1;if(!u){r.lastTouch=+new Date,gs(r);var f=n.touches,d=f.length===1,m=f.length===2;d&&(gs(r),bT(r,n),br(fr(r),n,i)),m&&r.onPinchStart(n)}}}},this.onTouchPanning=function(n){var a=r.setup.disabled,i=r.props.onPanning;if(r.isPanning&&n.touches.length===1){if(a)return;var o=_T(r);if(!o)return;n.preventDefault(),n.stopPropagation();var u=n.touches[0];ET(r,u.clientX,u.clientY),br(fr(r),n,i)}else n.touches.length>1&&r.onPinch(n)},this.onTouchPanningStop=function(n){r.onPanningStop(n),r.onPinchStop(n)},this.onDoubleClick=function(n){var a=r.setup.disabled;if(!a){var i=NL(r,n);i&&CL(r,n)}},this.clearPanning=function(n){r.isPanning&&r.onPanningStop(n)},this.setKeyPressed=function(n){r.pressedKeys[n.key]=!0},this.setKeyUnPressed=function(n){r.pressedKeys[n.key]=!1},this.isPressingKeys=function(n){return n.length?!!n.find(function(a){return r.pressedKeys[a]}):!0},this.setTransformState=function(n,a,i){var o=r.props.onTransformed;if(!Number.isNaN(n)&&!Number.isNaN(a)&&!Number.isNaN(i)){n!==r.transformState.scale&&(r.transformState.previousScale=r.transformState.scale,r.transformState.scale=n),r.transformState.positionX=a,r.transformState.positionY=i,r.applyTransformation();var u=fr(r);r.onChangeCallbacks.forEach(function(f){return f(u)}),br(u,{scale:n,positionX:a,positionY:i},o)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(r.wrapperComponent&&r.contentComponent){var n=Kk(r.transformState.scale,r.wrapperComponent,r.contentComponent);r.setTransformState(n.scale,n.positionX,n.positionY)}},this.handleTransformStyles=function(n,a,i){return r.props.customTransform?r.props.customTransform(n,a,i):lL(n,a,i)},this.applyTransformation=function(){if(!(!r.mounted||!r.contentComponent)){var n=r.transformState,a=n.scale,i=n.positionX,o=n.positionY,u=r.handleTransformStyles(i,o,a);r.contentComponent.style.transform=u}},this.getContext=function(){return fr(r)},this.onChange=function(n){return r.onChangeCallbacks.has(n)||r.onChangeCallbacks.add(n),function(){r.onChangeCallbacks.delete(n)}},this.onInit=function(n){return r.onInitCallbacks.has(n)||r.onInitCallbacks.add(n),function(){r.onInitCallbacks.delete(n)}},this.init=function(n,a){r.cleanupWindowEvents(),r.wrapperComponent=n,r.contentComponent=a,Lo(r,r.transformState.scale),r.handleInitializeWrapperEvents(n),r.handleInitialize(n,a),r.initializeWindowEvents(),r.isInitialized=!0;var i=fr(r);br(i,void 0,r.props.onInit)},this.props=e,this.setup=ST(this.props),this.transformState=Wk(this.props)}return t})(),my=Xs.createContext(null),IL=function(t,e){return typeof t=="function"?t(e):t},DL=Xs.forwardRef(function(t,e){var r=re.useRef(new RL(t)).current,n=IL(t.children,qx(r));return re.useImperativeHandle(e,function(){return qx(r)},[r]),re.useEffect(function(){r.update(t)},[r,t]),Xs.createElement(my.Provider,{value:r},n)});Xs.forwardRef(function(t,e){var r=re.useRef(null),n=re.useContext(my);return re.useEffect(function(){return n.onChange(function(a){if(r.current){var i=0,o=0;r.current.style.transform=n.handleTransformStyles(i,o,1/a.instance.transformState.scale)}})},[n]),Xs.createElement("div",jl({},t,{ref:oL([r,e])}))});function OL(t,e){e===void 0&&(e={});var r=e.insertAt;if(!(typeof document>"u")){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",r==="top"&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}}var FL=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,AT={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};OL(FL);var ML=function(t){var e=t.children,r=t.wrapperClass,n=r===void 0?"":r,a=t.contentClass,i=a===void 0?"":a,o=t.wrapperStyle,u=t.contentStyle,f=t.wrapperProps,d=f===void 0?{}:f,m=t.contentProps,x=m===void 0?{}:m,y=re.useContext(my),w=y.init,E=y.cleanupWindowEvents,b=re.useRef(null),T=re.useRef(null);return re.useEffect(function(){var I=b.current,R=T.current;return I!==null&&R!==null&&w&&w?.(I,R),function(){E?.()}},[]),Xs.createElement("div",jl({},d,{ref:b,className:"".concat(Gx.wrapperClass," ").concat(AT.wrapper," ").concat(n),style:o}),Xs.createElement("div",jl({},x,{ref:T,className:"".concat(Gx.contentClass," ").concat(AT.content," ").concat(i),style:u}),e))};const $n=({isOpen:t,onClose:e,title:r,children:n})=>(re.useEffect(()=>{const a=i=>{i.key==="Escape"&&e()};return t&&window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[t,e]),t?p.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/90 backdrop-blur-sm p-4 animate-in fade-in duration-200",children:p.jsxs("div",{className:`\r
            bg-white w-full max-w-lg rounded-lg overflow-hidden relative \r
            border-4 border-slate-900 \r
            shadow-[8px_8px_0px_0px_#FACC15] \r
            animate-in zoom-in-95 duration-300\r
        `,onClick:a=>a.stopPropagation(),children:[p.jsxs("div",{className:"bg-slate-900 p-4 border-b-4 border-slate-900 flex justify-between items-center relative overflow-hidden",children:[p.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-slate-800 rotate-45 transform translate-x-10 -translate-y-10"}),p.jsxs("div",{className:"flex items-center gap-2 relative z-10",children:[p.jsx(Im,{className:"text-yellow-400 fill-yellow-400",size:24}),p.jsx("h3",{className:"text-xl font-black italic tracking-wider text-yellow-400 uppercase transform -skew-x-6",children:r})]}),p.jsx("button",{onClick:e,className:`\r
                    relative z-10 \r
                    bg-red-600 hover:bg-red-700 text-white \r
                    p-1.5 rounded border-2 border-white \r
                    transition-transform hover:scale-110 active:scale-95\r
                    shadow-lg\r
                `,children:p.jsx(ua,{size:20,strokeWidth:3})})]}),p.jsx("div",{className:"p-6 max-h-[80vh] overflow-y-auto bg-white",children:n}),p.jsxs("div",{className:"h-2 bg-yellow-400 border-t-2 border-slate-900 flex",children:[p.jsx("div",{className:"w-1/3 bg-red-600 border-r-2 border-slate-900"}),p.jsx("div",{className:"w-1/3 bg-white border-r-2 border-slate-900"}),p.jsx("div",{className:"w-1/3 bg-blue-600"})]})]})}):null);function tC({currentUser:t,onSubmit:e,onCancel:r}){const[n,a]=re.useState(t?.name||""),i=o=>{if(o.preventDefault(),!n.trim())return alert("");if(n.trim()===t?.name)return alert("");e(n)};return p.jsxs("form",{onSubmit:i,className:"space-y-4 font-sans text-slate-800",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-black text-slate-700 mb-1",children:" (Nickname)"}),p.jsxs("div",{className:"relative",children:[p.jsx(bu,{size:16,className:"absolute left-3 top-3 text-slate-400"}),p.jsx("input",{type:"text",value:n,onChange:o=>a(o.target.value),className:"w-full border-2 border-slate-900 rounded p-2 pl-9 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 text-slate-900",placeholder:"",autoFocus:!0})]}),p.jsx("p",{className:"text-xs text-slate-400 mt-1 pl-1",children:"* "})]}),p.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-slate-100",children:[p.jsxs("button",{type:"button",onClick:r,className:"px-4 py-2 rounded border-2 border-slate-300 text-slate-600 font-bold hover:bg-slate-100 transition-all",children:[p.jsx(ua,{size:16,className:"inline mr-1"})," "]}),p.jsxs("button",{type:"submit",className:"px-4 py-2 bg-slate-900 text-yellow-400 rounded font-black border-2 border-slate-900 hover:bg-slate-800 shadow-[2px_2px_0px_0px_#FACC15] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(nc,{size:16,className:"inline mr-1"})," "]})]})]})}const PL=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=500,u=500;let f=a.width,d=a.height;f>d?f>o&&(d*=o/f,f=o):d>u&&(f*=u/d,d=u),i.width=f,i.height=d,i.getContext("2d").drawImage(a,0,0,f,d),e(i.toDataURL("image/jpeg",.7))}}});function rC({currentUser:t,onSubmit:e}){const[r,n]=re.useState(t?.avatar||""),[a,i]=re.useState(null),o=async f=>{f.target.files&&f.target.files[0]&&i(await PL(f.target.files[0]))},u=()=>{const f=a||r;f&&e(f)};return p.jsxs("div",{className:"space-y-6",children:[p.jsx("div",{className:"flex justify-center mb-4",children:p.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden border-4 border-orange-100 shadow-md",children:p.jsx("img",{src:a||r||t?.avatar,className:"w-full h-full object-cover",alt:"avatar",onError:f=>f.target.src=`https://api.dicebear.com/7.x/avataaars/svg?seed=${t?.name}&backgroundColor=ffdfbf`})})}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-stone-600 text-sm font-bold flex items-center gap-2",children:[p.jsx(K0,{size:16})," "]}),p.jsx("input",{type:"text",className:"border border-stone-200 rounded-lg px-3 py-2 text-sm",placeholder:"",value:r,onChange:f=>{n(f.target.value),i(null)}})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-0 flex items-center",children:p.jsx("span",{className:"w-full border-t border-stone-200"})}),p.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:p.jsx("span",{className:"bg-white px-2 text-stone-400",children:""})})]}),p.jsxs("div",{className:"flex flex-col gap-2",children:[p.jsxs("label",{className:"text-stone-600 text-sm font-bold flex items-center gap-2",children:[p.jsx(uy,{size:16})," "]}),p.jsx("input",{type:"file",accept:"image/*",onChange:o,className:"block w-full text-sm text-stone-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-bold file:bg-orange-50 file:text-orange-600 hover:file:bg-orange-100 cursor-pointer"})]})]}),p.jsx("button",{className:"w-full py-2 bg-orange-400 text-white rounded-lg font-bold hover:bg-orange-500",onClick:u,children:""})]})}function nC({onSubmit:t}){const[e,r]=re.useState("");return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsx("label",{className:"text-stone-600 text-sm font-bold tracking-wide",children:""}),p.jsx("input",{type:"password",className:"border border-stone-200 rounded-lg px-3 py-2",placeholder:"",value:e,onChange:n=>r(n.target.value)})]}),p.jsx("button",{className:"w-full py-2 bg-orange-400 text-white rounded-lg font-bold hover:bg-orange-500 disabled:opacity-50",onClick:()=>t(e),disabled:!e,children:""})]})}const jL=["https://pbs.twimg.com/media/G8MiWocaEAAYWbC?format=jpg&name=large","https://pbs.twimg.com/media/G8MiYLNbIAA_YJg?format=jpg&name=large","https://pbs.twimg.com/media/G8MiZktakAAvzHC?format=jpg&name=large","https://pbs.twimg.com/media/G8Mis25acAAqfys?format=jpg&name=large","https://pbs.twimg.com/media/G8MivlbakAA4A73?format=jpg&name=large","https://pbs.twimg.com/media/G8MixoiaAAAyEGE?format=jpg&name=large","https://pbs.twimg.com/media/G8Mi4L9b0AAPNmS?format=jpg&name=large","https://pbs.twimg.com/media/G8Mi6X_bwAAkrMd?format=jpg&name=large","https://pbs.twimg.com/media/G8MjC5vbgAE_hJg?format=jpg&name=large","https://pbs.twimg.com/media/G8MjIZ0bwAAEAhT?format=jpg&name=large"],Md=250;function LL({currentUser:t,onImageClick:e}){const[r,n]=re.useState([]),[a,i]=re.useState({exchangeRate:.24,totalShippingJPY:0,status:"",secondPayment:{weights:{},boxWeight:0}}),[o,u]=re.useState(!0);re.useEffect(()=>{u(!0);const w=Et(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),E=pn(w,b=>{if(b.exists()){const T=b.data(),R=(T.orders||[]).sort((C,G)=>{const V=C.buyer.localeCompare(G.buyer);return V!==0?V:C.id-G.id});n(R),i({exchangeRate:.24,totalShippingJPY:0,status:"",secondPayment:{weights:{},boxWeight:0},...T.settings})}u(!1)});return()=>E()},[]);const f=re.useMemo(()=>r.reduce((w,E)=>E.isBought?w+E.quantity:w,0),[r]),d=re.useMemo(()=>f>0?a.totalShippingJPY/f:0,[f,a.totalShippingJPY]),m=parseFloat(a.secondPayment?.boxWeight||0),x=f>0?m*Md/f:0,y=re.useMemo(()=>{const w={};return r.forEach(E=>{if(w[E.buyer]||(w[E.buyer]={items:[],totalItemPriceJPY:0,totalShippingShareJPY:0,totalSecondPayTWD:0,count:0}),E.isBought){const b=E.price*E.quantity,T=d*E.quantity,I=parseFloat(a.secondPayment?.weights?.[E.name]||0),C=(I*Md+x)*E.quantity;w[E.buyer].items.push({...E,weight:I,secondPaySubtotal:C}),w[E.buyer].totalItemPriceJPY+=b,w[E.buyer].totalShippingShareJPY+=T,w[E.buyer].totalSecondPayTWD+=C,w[E.buyer].count+=E.quantity}}),w},[r,d,a.secondPayment,x]);return o?p.jsx("div",{className:"p-10 text-center font-bold text-slate-500 uppercase tracking-widest italic animate-pulse",children:"Scanning Intel..."}):p.jsxs("div",{className:"space-y-8 pb-20",children:[p.jsx("div",{className:"bg-slate-900 text-yellow-400 p-6 rounded-xl border-4 border-slate-900 shadow-[8px_8px_0px_0px_#0f172a] relative overflow-hidden",children:p.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-3xl font-black italic mb-2",children:"JS ONLINE "}),p.jsxs("div",{className:"space-y-1 font-bold text-white text-sm",children:[p.jsxs("p",{className:"flex items-center gap-2",children:[p.jsx(Ck,{size:16,className:"text-yellow-400"})," 12/17 11:00  12/21 16:00"]}),p.jsxs("a",{href:"https://jumpshop-online.com/collections/jf2026",target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 underline hover:text-yellow-300",children:[p.jsx(Ti,{size:16})," "]})]})]}),p.jsx("div",{className:"bg-white p-4 rounded-lg border-4 border-slate-700 text-slate-900 w-full md:w-auto shadow-lg",children:p.jsxs("div",{className:"flex flex-col gap-3",children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("span",{className:"font-black text-xs uppercase bg-slate-200 px-1 rounded tracking-tighter",children:"Mission Status"}),p.jsx("span",{className:"font-black text-purple-600 italic uppercase",children:a.status})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-black text-slate-500 block uppercase tracking-tighter",children:"Exchange Rate"}),p.jsxs("div",{className:"flex items-center font-black",children:[p.jsx(Nk,{size:14,className:"text-slate-400"}),p.jsx("span",{children:a.exchangeRate})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-black text-slate-500 block uppercase tracking-tighter",children:"Total PCS"}),p.jsxs("div",{className:"flex items-center font-black text-slate-900",children:[p.jsx(cy,{size:14,className:"text-slate-400 mr-1"}),p.jsx("span",{children:f})]})]})]})]})})]})}),p.jsxs("div",{className:"bg-white p-4 rounded-xl border-2 border-slate-200",children:[p.jsxs("h4",{className:"font-black text-sm text-slate-500 mb-3 flex items-center gap-2",children:[p.jsx(sy,{size:16}),"  ()"]}),p.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:jL.map((w,E)=>p.jsx("div",{onClick:()=>e(w),className:"w-20 h-20 shrink-0 bg-white rounded border border-slate-300 overflow-hidden hover:scale-105 transition-transform cursor-pointer relative group shadow-sm",children:p.jsx("img",{src:w,alt:`Item ${E}`,className:"w-full h-full object-cover"})},E))})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(y).map(([w,E])=>{const b=E.totalItemPriceJPY+E.totalShippingShareJPY,T=Math.ceil(b*a.exchangeRate),I=T+Math.round(E.totalSecondPayTWD);return p.jsxs("div",{className:"bg-white rounded-xl border-4 border-slate-900 p-5 shadow-[4px_4px_0px_0px_#6b21a8] relative overflow-hidden group hover:-translate-y-1 transition-transform",children:[p.jsxs("div",{className:"flex justify-between items-start mb-4 border-b-2 border-slate-100 pb-2",children:[p.jsx("h3",{className:"text-2xl font-black italic text-slate-900 tracking-tighter",children:w}),p.jsxs("div",{className:"text-right",children:[p.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase",children:"Grand Total"}),p.jsxs("span",{className:"text-3xl font-black text-purple-600",children:["NT$ ",I.toLocaleString()]})]})]}),p.jsxs("div",{className:"space-y-3",children:[p.jsxs("div",{className:"space-y-1 text-sm font-bold text-slate-600",children:[p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("span",{children:[" (",E.count,")"]}),p.jsxs("span",{children:["",E.totalItemPriceJPY.toLocaleString()]})]}),p.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[p.jsx("span",{children:""}),p.jsxs("span",{children:["",E.totalShippingShareJPY.toFixed(0)]})]}),p.jsxs("div",{className:"flex justify-between text-slate-900 border-t border-slate-100 pt-1",children:[p.jsx("span",{children:""}),p.jsxs("span",{className:"font-black",children:["NT$ ",T.toLocaleString()]})]})]}),p.jsxs("div",{className:"bg-blue-50/50 p-2 rounded-lg border border-blue-100 space-y-1",children:[p.jsxs("div",{className:"flex justify-between text-sm font-black text-blue-800",children:[p.jsxs("span",{className:"flex items-center gap-1",children:[p.jsx(Fk,{size:14})," "]}),p.jsxs("span",{children:["NT$ ",Math.round(E.totalSecondPayTWD).toLocaleString()]})]}),p.jsx("p",{className:"text-[9px] text-blue-400 leading-tight",children:" + "})]})]}),p.jsxs("div",{className:"mt-4 space-y-2",children:[p.jsxs("details",{className:"group/detail border-t border-slate-100 pt-2",children:[p.jsxs("summary",{className:"text-[11px] font-black text-slate-500 cursor-pointer hover:text-slate-900 list-none flex justify-between items-center uppercase tracking-tighter",children:[p.jsx("span",{children:" ()"}),p.jsx(Sk,{size:12,className:"group-open/detail:rotate-180 transition-transform"})]}),p.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-y-auto pr-1",children:E.items.map((R,C)=>p.jsxs("div",{className:"flex justify-between text-[11px] font-bold text-slate-600 bg-slate-50 p-1.5 rounded border border-slate-100",children:[p.jsxs("span",{className:"truncate w-2/3",children:[R.ip," ",R.name," x",R.quantity]}),p.jsxs("span",{className:"font-mono",children:["",R.price*R.quantity]})]},C))})]}),p.jsxs("details",{className:"group/weight border-t border-slate-100 pt-2",children:[p.jsxs("summary",{className:"text-[11px] font-black text-blue-500 cursor-pointer hover:text-blue-700 list-none flex justify-between items-center uppercase tracking-tighter",children:[p.jsx("span",{children:" ()"}),p.jsx(oy,{size:12,className:"group-open/weight:rotate-180 transition-transform"})]}),p.jsxs("div",{className:"mt-2 space-y-1 bg-blue-50/30 p-2 rounded-lg border border-blue-100",children:[E.items.map((R,C)=>p.jsxs("div",{className:"flex justify-between text-[10px] font-bold text-blue-600/80",children:[p.jsxs("span",{className:"truncate w-2/3",children:[R.name," (",R.weight,"kg)"]}),p.jsxs("span",{className:"font-mono",children:["NT$ ",Math.round(R.secondPaySubtotal)]})]},C)),p.jsxs("div",{className:"flex justify-between text-[10px] font-black text-blue-400 border-t border-blue-100 mt-1 pt-1 italic",children:[p.jsx("span",{children:" ()"}),p.jsxs("span",{children:["NT$ ",x.toFixed(1)]})]})]})]})]})]},w)})}),p.jsxs("div",{className:"max-w-xl mx-auto bg-slate-100 p-4 rounded-xl border-2 border-dashed border-slate-300 flex items-start gap-3",children:[p.jsx(xp,{size:20,className:"text-slate-400 shrink-0 mt-1"}),p.jsxs("div",{className:"text-[12px] font-bold text-slate-500 leading-relaxed",children:[p.jsx("p",{className:"text-slate-900 uppercase tracking-widest mb-1",children:"Calculation Protocol:"}),p.jsx("p",{children:"1.  = ( + )   ()"}),p.jsxs("p",{children:["2.  = [(  ",Md,") + (  ",Md," / )]  "]}),p.jsx("p",{children:"3.  =  + "})]})]})]})}const BL={titi:"",xiaomei:"",heng:"",baobao:"",yeye:"",Sjie:"S",qiaoyu:"",teacher:"",ann:"",Aurora:"Aurora"};function VL({currentUser:t}){const[e,r]=re.useState("vendors"),[n,a]=re.useState(!1),[i,o]=re.useState(null),[u,f]=re.useState(null),[d,m]=re.useState(0),x=t?.id==="yeye",y=t?.isMember;re.useEffect(()=>{if(!t?.id)return;const R=BL[t.id]||t.name;let C=0,G=0;const V=pn(Et(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),A=>{if(A.exists()){const D=A.data(),N=D.orders||[],M=D.settings||{exchangeRate:.24,totalShippingJPY:0},F=N.reduce((ye,se)=>se.isBought?ye+se.quantity:ye,0),j=F>0?M.totalShippingJPY/F:0,be=N.filter(ye=>ye.buyer===R&&ye.isBought).reduce((ye,se)=>ye+se.price*se.quantity+j*se.quantity,0);C=Math.ceil(be*M.exchangeRate)}else C=0;m(C+G)}),H=pn(qt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders"),A=>{G=0,m(C+G)});return()=>{V(),H()}},[t]);const w=()=>{localStorage.removeItem("app_user_id"),window.location.reload()},E=async R=>{if(t)try{await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{name:R}),alert(""),o(null)}catch(C){console.error("",C),alert("")}},b=async R=>{t&&(await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{avatar:R}),alert(""),o(null))},T=async R=>{t&&(await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{password:R}),alert(""),o(null))},I=async()=>{if(t)if(t.isMember){if(t.memberValidUntil)confirm(`
`)&&(await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{memberValidUntil:null,memberCancelledAt:null}),alert(""));else if(confirm(`
 30 `)){const R=new Date;R.setDate(R.getDate()+30),await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberValidUntil:R.toISOString(),memberCancelledAt:new Date().toISOString()}),alert(`
 ${R.toLocaleDateString()}`)}}else confirm(` PLUS ULTRA 
`)&&(await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberSince:new Date().toISOString(),memberValidUntil:null,memberCancelledAt:null}),alert(""))};return p.jsxs("div",{className:"min-h-screen bg-slate-50 font-sans pb-20 selection:bg-yellow-400 selection:text-black",children:[p.jsx("header",{className:"sticky top-0 z-30 bg-slate-900 border-b-4 border-yellow-400 px-4 py-3 shadow-md",children:p.jsxs("div",{className:"max-w-5xl mx-auto flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-0",children:[p.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[p.jsxs(du,{to:"/home",className:"flex items-center gap-2 bg-yellow-400 px-4 py-1.5 rounded transform -skew-x-12 border-2 border-yellow-600 hover:scale-105 transition-transform group",children:[p.jsx(Ak,{size:20,className:"text-slate-900 transform skew-x-12 group-hover:-translate-x-1 transition-transform",strokeWidth:3}),p.jsx("span",{className:"text-slate-900 font-black text-sm transform skew-x-12 hidden",children:""})]}),p.jsx("h1",{className:"text-2xl font-black italic tracking-tight text-white",children:"JF26 "})]}),p.jsxs("div",{className:"flex items-center justify-end gap-2 sm:gap-4 w-full sm:w-auto",children:[t&&p.jsx(UL,{amount:d}),p.jsxs("div",{className:"text-right hidden sm:block",children:[p.jsx("p",{className:"text-xs text-slate-400",children:"HERO NAME"}),p.jsx("p",{className:"font-bold text-white tracking-wide",children:t?.name})]}),p.jsxs("div",{className:"relative",children:[p.jsxs("button",{onClick:()=>a(!n),className:`w-10 h-10 rounded-full bg-slate-800 border-2 ${y?"border-purple-500":"border-yellow-400"} shadow-lg overflow-hidden hover:scale-105 transition-all relative`,children:[p.jsx("img",{src:t?.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${t?.name}`,alt:"avatar",className:"w-full h-full object-cover"}),y&&p.jsx("div",{className:"absolute -top-1 -right-1 bg-purple-600 rounded-full p-0.5 border border-white",children:p.jsx(Cm,{size:8,className:"text-white fill-white"})})]}),n&&p.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-xl border-2 border-slate-900 py-1 z-50 animate-in fade-in slide-in-from-top-2",children:[p.jsxs("div",{className:"px-3 py-2 border-b-2 border-slate-100 bg-slate-50",children:[p.jsxs("div",{className:"flex justify-between items-center mb-1",children:[p.jsxs("span",{className:"text-xs font-black text-slate-500 flex items-center gap-1",children:[p.jsx(Cm,{size:12,className:y?"text-purple-600 fill-purple-600":"text-slate-300"}),"PLUS "]}),y&&p.jsx("span",{className:"text-[10px] bg-purple-100 text-purple-700 px-1.5 rounded font-bold",children:"SUBSCRIBED"})]}),p.jsx("button",{onClick:I,className:`w-full text-xs font-bold py-1.5 rounded border-2 transition-all ${y&&t.memberValidUntil?"bg-green-100 text-green-700 border-green-300 hover:bg-green-200":y?"bg-white border-slate-300 text-slate-500 hover:bg-red-50 hover:text-red-500 hover:border-red-300":"bg-purple-600 border-purple-800 text-white hover:bg-purple-700"}`,children:y?t.memberValidUntil?" ()":" (30)":" (NT$90/)"})]}),p.jsxs("button",{onClick:()=>{a(!1),o("changeName")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(bu,{size:16})," "]}),p.jsxs("button",{onClick:()=>{a(!1),o("changeAvatar")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(sy,{size:16})," "]}),p.jsxs("button",{onClick:()=>{a(!1),o("changePwd")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(Dk,{size:16})," "]}),t?.name===""&&p.jsx("div",{className:"border-t border-slate-100 mt-1",children:p.jsxs(du,{to:"/admin/dashboard",className:"block px-4 py-2 text-sm text-blue-700 font-black hover:bg-blue-50 transition-colors flex items-center gap-2",onClick:()=>a(!1),children:[p.jsx(Pk,{size:16})," "]})}),p.jsx("div",{className:"border-t-2 border-slate-100 my-1"}),p.jsxs("button",{onClick:w,className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2 font-black",children:[p.jsx(Ok,{size:16})," "]})]})]})]})]})}),p.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-8",children:[p.jsxs("div",{className:"text-center mb-8 relative",children:[p.jsxs("div",{className:"inline-block relative",children:[p.jsx("h2",{className:"text-5xl font-black text-slate-900 italic transform -skew-x-6 z-10 relative",children:"JUMP FESTA 2026"}),p.jsx("div",{className:"absolute -bottom-2 -right-4 w-[110%] h-6 bg-yellow-400 -z-0 transform -skew-x-6"})]}),p.jsxs("p",{className:"text-slate-500 font-bold mt-4 flex items-center justify-center gap-2",children:[p.jsx(xT,{size:18,className:"text-slate-900"})," ..."]}),p.jsxs("div",{className:"flex justify-center gap-3 text-sm font-black mt-6 flex-wrap",children:[p.jsxs("a",{href:"https://www.jumpfesta.com/maker/",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JF26  ",p.jsx(Ti,{size:14})]}),p.jsxs("a",{href:"https://jumpcs.shueisha.co.jp/shop/pages/jumpfesta.aspx",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JCS ",p.jsx(Ti,{size:14})]}),p.jsxs("a",{href:"https://docs.google.com/spreadsheets/d/1zfT-MMN-DwIRamibiAQUyp4lJLGBoxS3Rpeb1aVJLK8/edit?usp=sharing",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-white border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JF26  ",p.jsx(Ti,{size:14})]}),p.jsxs("a",{href:"https://forms.gle/VsHvAvraVQp4dHaK8",target:"_blank",rel:"noreferrer",className:"px-4 py-1.5 bg-yellow-400 border-2 border-slate-900 shadow-[4px_4px_0px_0px_#0f172a] hover:translate-y-0.5 hover:shadow-[2px_2px_0px_0px_#0f172a] transition-all flex items-center gap-1 rounded",children:["JF26  ",p.jsx(Ti,{size:14})]})]})]}),p.jsx("nav",{className:"max-w-md mx-auto mb-8 px-4",children:p.jsx("div",{className:"bg-white p-1 rounded-lg shadow-sm border-2 border-slate-200 flex justify-around gap-1",children:[{id:"vendors",label:"",icon:xT},{id:"js_pre",label:"JS  (Online)",icon:yp},{id:"jcs_lottery",label:"JCS ",icon:Lk}].map(R=>{const C=R.icon,G=e===R.id;return p.jsxs("button",{onClick:()=>r(R.id),className:`
                                        flex-1 flex flex-col items-center justify-center gap-1 py-2 px-0.5 sm:px-4 rounded font-black transition-all border-2 
                                        ${G?"bg-slate-900 border-slate-900 text-yellow-400 shadow-md transform -translate-y-1":"bg-transparent border-transparent text-slate-500 hover:bg-slate-100 hover:text-slate-900"}
                                    `,children:[p.jsx(C,{size:20,className:G?"animate-pulse":""}),p.jsx("span",{className:"text-[11px] sm:text-sm whitespace-nowrap",children:R.label})]},R.id)})})}),p.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-300",children:[e==="vendors"&&p.jsx(zL,{currentUser:t,isAdmin:x}),e==="js_pre"&&p.jsx(LL,{currentUser:t,isAdmin:x,onImageClick:f}),e==="jcs_lottery"&&p.jsx(GL,{currentUser:t,isAdmin:x})]})]}),p.jsx($n,{isOpen:i==="changeName",onClose:()=>o(null),title:"",children:p.jsx(tC,{currentUser:t,onSubmit:E,onCancel:()=>o(null)})}),p.jsx($n,{isOpen:i==="changePwd",onClose:()=>o(null),title:"",children:p.jsx(nC,{onSubmit:T})}),p.jsx($n,{isOpen:i==="changeAvatar",onClose:()=>o(null),title:"",children:p.jsx(rC,{currentUser:t,onSubmit:b})}),u&&p.jsx("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-md flex items-center justify-center p-0 animate-in fade-in duration-200",children:p.jsx(DL,{initialScale:1,minScale:.5,maxScale:4,centerOnInit:!0,children:({zoomIn:R,zoomOut:C,resetTransform:G})=>p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"absolute top-4 right-4 z-[110] flex items-center gap-2 bg-slate-900/80 p-2 rounded-full backdrop-blur border border-slate-700 shadow-xl",children:[p.jsx("button",{onClick:()=>R(),className:"p-2 text-white hover:text-yellow-400 hover:bg-white/10 rounded-full",children:p.jsx(gj,{size:20})}),p.jsx("button",{onClick:()=>C(),className:"p-2 text-white hover:text-yellow-400 hover:bg-white/10 rounded-full",children:p.jsx(vj,{size:20})}),p.jsx("button",{onClick:()=>G(),className:"p-2 text-white hover:text-yellow-400 hover:bg-white/10 rounded-full",children:p.jsx(MP,{size:20})}),p.jsx("div",{className:"w-px h-6 bg-slate-600 mx-1"}),p.jsx("button",{onClick:()=>f(null),className:"p-2 text-white hover:text-red-400 hover:bg-white/10 rounded-full",children:p.jsx(ua,{size:20})})]}),p.jsx(ML,{wrapperClass:"!w-screen !h-screen",contentClass:"!w-screen !h-screen flex items-center justify-center",children:p.jsx("img",{src:u,alt:"Full Preview",className:"max-w-full max-h-full object-contain"})})]})})})]})}function UL({amount:t}){const e=" JF26 ";return p.jsxs("div",{className:`\r
            relative group border-r border-slate-700 mr-1 pr-2 sm:mr-2 sm:pr-4\r
            flex w-full items-center justify-end gap-3   /*  */\r
            sm:w-auto sm:flex-col sm:items-end sm:gap-0  /*  */\r
        `,children:[p.jsxs("button",{type:"button",onClick:()=>alert(e),className:`\r
                    focus:outline-none group/btn\r
                    flex items-center gap-2              /*  */\r
                    sm:mb-1 sm:gap-1.5\r
                `,children:[p.jsx("span",{className:"text-[16px] sm:text-base text-slate-400 font-bold whitespace-nowrap pt-0.5",children:""}),p.jsxs("span",{className:"text-[10px] text-yellow-500 group-hover/btn:text-yellow-400 border-b border-dashed border-yellow-500/50 flex items-center gap-0.5 transition-colors",children:[p.jsx("span",{className:"hidden sm:inline",children:"?"}),p.jsx(km,{className:"block sm:hidden",size:14}),p.jsx(km,{className:"hidden sm:block",size:10})]})]}),p.jsxs("div",{className:"text-yellow-400 font-black drop-shadow-sm text-right flex items-center",children:[p.jsx("span",{className:"text-xs mr-1 text-yellow-200 mt-1",children:"NT$"}),p.jsx("span",{className:"text-xl sm:text-xl font-mono",children:t.toLocaleString()})]}),p.jsx("div",{className:"absolute top-12 right-0 w-max bg-slate-800 text-white text-xs p-2 rounded border border-yellow-400 shadow-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 hidden sm:block whitespace-pre-wrap text-left",children:e})]})}function zL({currentUser:t,isAdmin:e,modalType:r,setModalType:n}){const[a,i]=re.useState([]),[o,u]=re.useState(""),[f,d]=re.useState(null),[m,x]=re.useState(null),[y,w]=re.useState(0),E=[{name:"JS  (JUMP SHOP)",mainUrl:"https://jumpfesta.com/maker/",preOrder:{period:"2025/12/17 ~ 12/21",url:"https://jumpshop-online.com/collections/jf2026"},postOrder:{period:"",url:""},tags:[""],products:["Jump"],notes:"Jump Shop Online "}];re.useEffect(()=>{const V=pn(qt(Ke,"artifacts","default-app-id","public","data","jf26_vendors"),H=>{const A=H.docs.map(D=>({id:D.id,...D.data()}));i(A.sort((D,N)=>(D.order||0)-(N.order||0)))});return()=>V()},[]);const b=V=>{try{const H=V.updatedAt||V.createdAt;if(!H)return!1;const A=`vendor_${V.id}`;let D=t?.readHistory?.[A];if(!D&&t?.id)try{const N=`read_${t.id}_${A}`;D=localStorage.getItem(N)}catch(N){console.warn("LocalStorage access denied:",N)}return D?new Date(H)>new Date(D):!0}catch(H){return console.error("checkIsNew error:",H),!1}},T=async V=>{if(!t?.id)return;const H=new Date().toISOString(),A=`vendor_${V.id}`,D=`read_${t.id}_${A}`;try{try{localStorage.setItem(D,H),w(M=>M+1)}catch(M){console.warn("LocalStorage write failed:",M)}const N=Et(Ke,"artifacts","default-app-id","public","data","users",t.id);await q0(N,{readHistory:{[A]:H}},{merge:!0})}catch(N){console.error("",N)}},I=async()=>{if(confirm(""))try{const V=Lx(Ke);E.forEach((H,A)=>{const D=Et(qt(Ke,"artifacts","default-app-id","public","data","jf26_vendors"));V.set(D,{...H,order:A,updatedAt:new Date().toISOString()})}),await V.commit()}catch{alert("")}},R=async V=>{if(confirm(""))try{await wu(Et(Ke,"artifacts","default-app-id","public","data","jf26_vendors",V))}catch(H){console.error("",H),alert("")}},C=a.filter(V=>(V.name||"").toLowerCase().includes(o.toLowerCase())||(Array.isArray(V.products)?V.products.some(H=>H.toLowerCase().includes(o.toLowerCase())):(V.products||V.ips||"").toLowerCase().includes(o.toLowerCase()))),G=V=>{switch(V){case"":return"bg-yellow-400 text-slate-900 border-slate-900";case"":return"bg-blue-500 text-white border-slate-900";case"":return"bg-red-600 text-white border-slate-900";default:return"bg-white text-slate-800 border-slate-900"}};return p.jsxs("div",{children:[e&&a.length===0&&p.jsx("div",{className:"flex justify-end mb-4",children:p.jsxs("button",{onClick:I,className:"px-4 py-1.5 bg-blue-100 text-blue-600 border border-blue-300 rounded hover:bg-blue-200 flex items-center gap-1 font-bold",children:[p.jsx(QM,{size:12})," "]})}),p.jsxs("div",{className:"mb-10 flex flex-col md:flex-row items-center gap-4",children:[p.jsxs("div",{className:"flex-1 w-full h-12 rounded-xl border-4 border-slate-900 bg-white shadow-[4px_4px_0px_0px_#0f172a] transition-all focus-within:ring-4 focus-within:ring-yellow-400/50 overflow-hidden flex items-center",children:[p.jsx("div",{className:"pl-4 pr-2 flex items-center justify-center text-slate-900",children:p.jsx(Mk,{size:24,strokeWidth:3})}),p.jsx("input",{type:"text",placeholder:"  IP...",className:"w-full h-full bg-transparent border-none outline-none text-slate-900 font-bold placeholder:text-slate-400 placeholder:font-medium text-lg",value:o,onChange:V=>u(V.target.value)})]}),e&&p.jsxs("button",{onClick:()=>{d(null),n("vendor")},className:"w-full md:w-auto px-6 h-12 bg-slate-900 text-yellow-400 rounded-xl border-4 border-slate-900 font-black shadow-[4px_4px_0px_0px_#FACC15] hover:-translate-y-1 hover:shadow-[6px_6px_0px_0px_#FACC15] flex items-center justify-center gap-2 text-lg active:scale-[0.98] transition-all whitespace-nowrap",children:[p.jsx(ql,{size:24,strokeWidth:3})," "]})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map((V,H)=>{const A=Array.isArray(V.products)?V.products:[],D=A.length>10,N=D?A.slice(0,10):A,M=b(V);return p.jsxs("div",{onClick:()=>T(V),className:"bg-white rounded-xl border-4 border-slate-900 p-5 shadow-[8px_8px_0px_0px_#FACC15] hover:-translate-y-1 hover:shadow-[10px_10px_0px_0px_#FACC15] transition-all duration-200 flex flex-col relative group cursor-pointer",children:[M&&p.jsx("div",{className:"absolute -top-3 -left-3 bg-red-600 text-white text-xs font-black px-2 py-1 shadow-md transform -rotate-12 z-20 border-2 border-white pointer-events-none animate-bounce",children:"NEW!"}),p.jsx("div",{className:"absolute top-3 right-3 w-3 h-3 rounded-full bg-slate-200 border-2 border-slate-900 z-10"}),p.jsxs("div",{className:"flex justify-between items-start mb-4 pr-4 border-b-2 border-slate-100 pb-2",children:[p.jsx("h3",{className:"font-black text-2xl text-slate-900 leading-tight italic",children:V.name}),e&&p.jsx("div",{className:"flex flex-col gap-1 ml-2 shrink-0",children:p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:F=>{F.stopPropagation(),d(V),n("vendor")},className:"p-1.5 bg-white text-slate-900 rounded border-2 border-slate-900 hover:bg-slate-100 shadow-[2px_2px_0px_0px_#000]",title:"",children:p.jsx(vp,{size:14,strokeWidth:2.5})}),p.jsx("button",{onClick:F=>{F.stopPropagation(),R(V.id)},className:"p-1.5 bg-red-500 text-white rounded border-2 border-slate-900 hover:bg-red-600 shadow-[2px_2px_0px_0px_#000]",title:"",children:p.jsx(_p,{size:14,strokeWidth:2.5})})]})})]}),V.tags&&V.tags.length>0&&p.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:V.tags.map(F=>p.jsx("span",{className:`text-[11px] font-black px-2 py-0.5 border-2 shadow-[2px_2px_0px_0px_rgba(0,0,0,0.1)] ${G(F)}`,children:F},F))}),p.jsxs("div",{className:"space-y-4 flex-1",children:[p.jsxs("div",{children:[p.jsxs("p",{className:"text-xs font-black text-slate-400 mb-2 flex items-center gap-1 uppercase tracking-wider",children:[p.jsx(bu,{size:12}),"  (IPs)"]}),p.jsxs("div",{className:"flex flex-wrap gap-2",children:[N.map((F,j)=>p.jsx("span",{className:"bg-yellow-50 text-slate-900 text-xs font-bold px-2 py-1 border-2 border-slate-200 transition-transform hover:scale-105 hover:border-slate-900 hover:bg-yellow-200",children:F},j)),D&&p.jsxs("button",{onClick:F=>{F.stopPropagation(),x(V)},className:"bg-slate-800 text-white text-xs font-bold px-2 py-1 border-2 border-slate-900 hover:bg-slate-700 transition-colors cursor-pointer flex items-center gap-1",children:[p.jsx(pP,{size:12})," MORE..."]})]})]}),p.jsxs("div",{className:"space-y-2 bg-slate-50 p-3 rounded border-2 border-slate-200 relative",children:[V.preOrder?.period&&p.jsxs("div",{className:"text-sm",children:[p.jsx("span",{className:"text-[10px] font-black bg-yellow-400 text-slate-900 px-1 border border-slate-900 mr-2",children:""}),p.jsx("span",{className:"font-bold text-slate-700",children:V.preOrder.period})]}),V.postOrder?.period&&p.jsxs("div",{className:"text-sm",children:[p.jsx("span",{className:"text-[10px] font-black bg-blue-500 text-white px-1 border border-slate-900 mr-2",children:""}),p.jsx("span",{className:"font-bold text-slate-700",children:V.postOrder.period})]}),V.tags?.includes("")&&p.jsxs("div",{className:"text-sm flex items-center gap-2 text-red-600 font-black",children:[p.jsx(_P,{size:14}),"  JUMP FESTA "]})]}),V.notes&&p.jsxs("div",{className:"flex items-start gap-2 bg-red-50 p-2 rounded border-2 border-red-100",children:[p.jsx(UM,{size:14,className:"text-red-500 mt-0.5 shrink-0"}),p.jsx("p",{className:"text-xs font-bold text-red-600 leading-relaxed",children:V.notes})]})]}),p.jsxs("div",{className:"mt-6 space-y-3 pt-4 border-t-2 border-slate-100",children:[p.jsxs("div",{className:"flex gap-2",children:[V.preOrder?.url&&p.jsxs("a",{href:V.preOrder.url,target:"_blank",rel:"noreferrer",onClick:F=>F.stopPropagation(),className:"flex-1 py-2 bg-yellow-400 text-slate-900 text-center font-black rounded border-2 border-slate-900 hover:bg-yellow-300 transition-colors flex items-center justify-center gap-1 text-xs shadow-[3px_3px_0px_0px_#0f172a] active:translate-y-0.5 active:shadow-none",children:[p.jsx(yp,{size:14,strokeWidth:3})," "]}),V.postOrder?.url&&p.jsxs("a",{href:V.postOrder.url,target:"_blank",rel:"noreferrer",onClick:F=>F.stopPropagation(),className:"flex-1 py-2 bg-blue-500 text-white text-center font-black rounded border-2 border-slate-900 hover:bg-blue-400 transition-colors flex items-center justify-center gap-1 text-xs shadow-[3px_3px_0px_0px_#0f172a] active:translate-y-0.5 active:shadow-none",children:[p.jsx(cy,{size:14,strokeWidth:3})," "]})]}),V.mainUrl&&p.jsxs("a",{href:V.mainUrl,target:"_blank",rel:"noreferrer",onClick:F=>F.stopPropagation(),className:"block w-full py-2 bg-slate-100 text-slate-700 text-center font-black rounded border-2 border-slate-900 hover:bg-slate-200 transition-colors flex items-center justify-center gap-2 text-sm",children:[p.jsx(Ti,{size:16})," /"]})]})]},V.id)})}),p.jsx($n,{isOpen:r==="vendor",onClose:()=>{n(null),d(null)},title:f?"EDIT VENDOR":"NEW VENDOR",children:p.jsx(HL,{initialData:f,onSubmit:async V=>{try{f?(await Br(Et(Ke,"artifacts","default-app-id","public","data","jf26_vendors",f.id),{...V,updatedAt:new Date().toISOString()}),alert("")):(await Bs(qt(Ke,"artifacts","default-app-id","public","data","jf26_vendors"),{...V,order:Date.now(),updatedAt:new Date().toISOString(),createdAt:new Date().toISOString()}),alert("")),n(null)}catch(H){console.error("",H),alert("")}},onCancel:()=>n(null)})}),m&&p.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-sm animate-in fade-in duration-200",onClick:()=>x(null),children:p.jsxs("div",{className:"bg-white w-full max-w-md rounded-xl shadow-2xl border-4 border-slate-900 overflow-hidden",onClick:V=>V.stopPropagation(),children:[p.jsxs("div",{className:"bg-slate-900 px-4 py-3 border-b-4 border-yellow-400 flex justify-between items-center",children:[p.jsxs("h3",{className:"font-black text-lg text-white flex items-center gap-2 truncate italic",children:[p.jsx(bu,{size:20,className:"text-yellow-400"})," ",m.name]}),p.jsx("button",{onClick:()=>x(null),className:"text-slate-400 hover:text-white transition-colors",children:p.jsx(ua,{size:24})})]}),p.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto bg-slate-50",children:p.jsx("div",{className:"flex flex-wrap gap-2",children:(Array.isArray(m.products)?m.products:[]).map((V,H)=>p.jsx("span",{className:"bg-white text-slate-900 text-sm font-bold px-3 py-2 border-2 border-slate-900 shadow-[2px_2px_0px_0px_#ccc]",children:V},H))})})]})})]})}function HL({initialData:t,onSubmit:e,onCancel:r}){const[n,a]=re.useState({name:t?.name||"",mainUrl:t?.mainUrl||"",preOrder:{period:t?.preOrder?.period||"",url:t?.preOrder?.url||""},postOrder:{period:t?.postOrder?.period||"",url:t?.postOrder?.url||""},tags:t?.tags||[],products:t?.products||[],notes:t?.notes||""}),i=d=>{a(m=>{const x=m.tags.includes(d)?m.tags.filter(y=>y!==d):[...m.tags,d];return{...m,tags:x}})},o=d=>{const x=d.target.value.split(/[,]/).map(y=>y.trim()).filter(y=>y);a({...n,products:x})},u="w-full border-2 border-slate-300 rounded p-2 text-sm font-bold focus:border-slate-900 focus:ring-0 focus:shadow-[4px_4px_0px_0px_#FACC15] transition-all",f="block text-xs font-black text-slate-700 mb-1 uppercase tracking-wide";return p.jsxs("form",{onSubmit:d=>{d.preventDefault(),e(n)},className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:f,children:""}),p.jsx("input",{className:u,value:n.name,onChange:d=>a({...n,name:d.target.value}),required:!0})]}),p.jsxs("div",{children:[p.jsx("label",{className:f,children:" (Main URL)"}),p.jsx("input",{className:u,value:n.mainUrl,onChange:d=>a({...n,mainUrl:d.target.value}),placeholder:"https://..."})]}),p.jsxs("div",{children:[p.jsx("label",{className:f,children:""}),p.jsx("div",{className:"flex gap-3",children:["","",""].map(d=>p.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded px-2 py-2 text-center text-xs font-black transition-all ${n.tags.includes(d)?"bg-slate-900 text-yellow-400 border-slate-900 shadow-[2px_2px_0px_0px_#FACC15] transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[p.jsx("input",{type:"checkbox",className:"hidden",checked:n.tags.includes(d),onChange:()=>i(d)}),n.tags.includes(d)&&p.jsx(gp,{size:10,className:"inline mr-1"}),d]},d))})]}),p.jsxs("div",{className:"bg-yellow-50 p-3 rounded border-2 border-yellow-200 space-y-2",children:[p.jsx("p",{className:f+" text-yellow-700 border-b border-yellow-200 pb-1",children:""}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),p.jsx("input",{className:u,value:n.preOrder.period,onChange:d=>a({...n,preOrder:{...n.preOrder,period:d.target.value}})})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),p.jsx("input",{className:u,value:n.preOrder.url,onChange:d=>a({...n,preOrder:{...n.preOrder,url:d.target.value}})})]})]}),p.jsxs("div",{className:"bg-blue-50 p-3 rounded border-2 border-blue-200 space-y-2",children:[p.jsx("p",{className:f+" text-blue-700 border-b border-blue-200 pb-1",children:""}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),p.jsx("input",{className:u,value:n.postOrder.period,onChange:d=>a({...n,postOrder:{...n.postOrder,period:d.target.value}})})]}),p.jsxs("div",{children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),p.jsx("input",{className:u,value:n.postOrder.url,onChange:d=>a({...n,postOrder:{...n.postOrder,url:d.target.value}})})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:f,children:" IP ()"}),p.jsx("textarea",{className:u+" h-20",defaultValue:n.products.join(", "),onChange:o,placeholder:"..."})]}),p.jsxs("div",{children:[p.jsx("label",{className:f,children:""}),p.jsx("input",{className:u,value:n.notes,onChange:d=>a({...n,notes:d.target.value})})]}),p.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t-2 border-slate-200 mt-2",children:[p.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded border-2 border-slate-300 font-black text-slate-500 hover:bg-slate-100 hover:text-slate-900",children:""}),p.jsx("button",{type:"submit",className:"px-6 py-2 rounded bg-slate-900 text-yellow-400 font-black border-2 border-slate-900 hover:bg-slate-800 shadow-[4px_4px_0px_0px_#FACC15] active:translate-y-0.5 active:shadow-none transition-all",children:" (SAVE)"})]})]})}function GL({currentUser:t,isAdmin:e}){const[r,n]=re.useState(Array.from({length:10},(u,f)=>({id:`order_${f+1}`,index:f+1}))),[a,i]=re.useState(null);re.useEffect(()=>{const u=pn(qt(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders"),f=>{const d={};f.docs.forEach(m=>{d[m.id]=m.data()}),n(m=>m.map(x=>({...x,...d[x.id]||{items:[]}})))});return()=>u()},[]);const o=u=>{switch(u){case"WON":return"bg-green-100 text-green-700 border-green-200";case"LOST":return"bg-slate-100 text-slate-400 border-slate-200 grayscale opacity-70";default:return"bg-white text-slate-900 border-slate-200"}};return p.jsxs("div",{children:[p.jsx("div",{className:"bg-slate-900 text-yellow-400 p-6 rounded-xl border-4 border-yellow-400 shadow-[8px_8px_0px_0px_#0f172a] relative overflow-hidden mb-10",children:p.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"text-3xl font-black italic mb-2",children:"JUMP CHARACTERS STORE "}),p.jsxs("div",{className:"space-y-1 font-bold text-white",children:[p.jsxs("p",{className:"flex items-center gap-2",children:[p.jsx(Ck,{size:18,className:"text-yellow-400"})," 12/17 11:00 ~ 12/21 16:00"]}),p.jsxs("a",{href:"https://jumpcs.shueisha.co.jp/shop/default.aspx",target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 underline hover:text-yellow-300",children:[p.jsx(Ti,{size:18})," "]})]})]}),p.jsx("div",{className:"bg-yellow-400 text-slate-900 px-4 py-2 rounded font-black border-2 border-yellow-600 transform rotate-2",children:"(23)"})]})}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:r.map(u=>{const f=u.items&&u.items.length>0,d=f?u.items.reduce((m,x)=>m+Number(x.price)*Number(x.qty),0):0;return p.jsxs("div",{className:"bg-white rounded-xl border-4 border-slate-900 overflow-hidden shadow-[4px_4px_0px_0px_#6b21a8] hover:translate-y-[-2px] hover:shadow-[6px_6px_0px_0px_#6b21a8] transition-all",children:[p.jsxs("div",{className:"bg-slate-900 text-white px-4 py-3 flex justify-between items-center",children:[p.jsxs("h4",{className:"font-black italic text-lg flex items-center gap-2",children:[p.jsx(Lk,{className:"text-purple-400",size:20})," ORDER #",u.index]}),e&&p.jsxs("button",{onClick:()=>i(u),className:"text-xs bg-slate-700 hover:bg-slate-600 px-2 py-1 rounded border border-slate-500 flex items-center gap-1",children:[p.jsx(vp,{size:12})," "]})]}),p.jsx("div",{className:"p-4 min-h-[150px]",children:f?p.jsxs("div",{className:"space-y-3",children:[u.items.map((m,x)=>p.jsxs("div",{className:`flex items-center justify-between p-2 rounded border-2 ${o(m.status)}`,children:[p.jsxs("div",{className:"flex-1",children:[p.jsx("div",{className:"font-bold text-sm",children:m.name}),p.jsxs("div",{className:"text-xs opacity-80",children:["",m.price," x ",m.qty]})]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsxs("div",{className:"font-mono font-black",children:["",m.price*m.qty]}),m.status==="WON"&&p.jsx(gp,{className:"text-green-600",size:18}),m.status==="LOST"&&p.jsx(XCircle,{className:"text-slate-400",size:18}),(!m.status||m.status==="PENDING")&&p.jsx(WM,{size:18,className:"text-slate-400"})]})]},x)),p.jsxs("div",{className:"border-t-2 border-slate-100 mt-2 pt-2 flex justify-between items-center font-black text-slate-900",children:[p.jsx("span",{children:"TOTAL"}),p.jsxs("span",{className:"text-lg",children:["",d.toLocaleString()]})]})]}):p.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-300 font-bold gap-2 py-8",children:[p.jsx(ly,{size:32}),p.jsx("span",{children:""})]})})]},u.id)})}),p.jsx($n,{isOpen:!!a,onClose:()=>i(null),title:` #${a?.index}`,children:a&&p.jsx(qL,{initialData:a,onSubmit:async u=>{try{await q0(Et(Ke,"artifacts","default-app-id","public","data","jf26_jcs_orders",a.id),u),i(null)}catch(f){console.error(f),alert("")}},onCancel:()=>i(null)})})]})}function qL({initialData:t,onSubmit:e,onCancel:r}){const[n,a]=re.useState(t.items||[]),i=()=>{a([...n,{name:"",qty:1,price:0,status:"PENDING"}])},o=(f,d,m)=>{const x=[...n];x[f][d]=m,a(x)},u=f=>{a(n.filter((d,m)=>m!==f))};return p.jsxs("form",{onSubmit:f=>{f.preventDefault(),e({items:n})},className:"space-y-4",children:[p.jsx("div",{className:"max-h-[50vh] overflow-y-auto space-y-4 p-1",children:n.map((f,d)=>p.jsxs("div",{className:"bg-slate-50 p-3 rounded border-2 border-slate-200 relative",children:[p.jsx("button",{type:"button",onClick:()=>u(d),className:"absolute top-1 right-1 text-slate-400 hover:text-red-500",children:p.jsx(ua,{size:16})}),p.jsxs("div",{className:"space-y-2 pr-6",children:[p.jsx("input",{className:"w-full text-sm font-bold border border-slate-300 rounded p-1",placeholder:"",value:f.name,onChange:m=>o(d,"name",m.target.value),required:!0}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("input",{type:"number",className:"w-20 text-sm border border-slate-300 rounded p-1",placeholder:"",value:f.qty,onChange:m=>o(d,"qty",m.target.value)}),p.jsx("input",{type:"number",className:"flex-1 text-sm border border-slate-300 rounded p-1",placeholder:"()",value:f.price,onChange:m=>o(d,"price",m.target.value)})]}),p.jsx("div",{className:"flex gap-2 text-xs font-bold",children:["PENDING","WON","LOST"].map(m=>p.jsx("button",{type:"button",onClick:()=>o(d,"status",m),className:`flex-1 py-1 rounded border ${f.status===m?m==="WON"?"bg-green-500 text-white border-green-600":m==="LOST"?"bg-slate-500 text-white border-slate-600":"bg-yellow-400 text-black border-yellow-500":"bg-white text-slate-500 border-slate-200"}`,children:m==="WON"?"":m==="LOST"?"":""},m))})]})]},d))}),p.jsxs("button",{type:"button",onClick:i,className:"w-full py-2 bg-slate-100 text-slate-600 font-bold rounded border-2 border-dashed border-slate-300 hover:bg-slate-200 hover:border-slate-400 flex items-center justify-center gap-2",children:[p.jsx(ql,{size:16})," "]}),p.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t-2 border-slate-100",children:[p.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 rounded border font-bold",children:""}),p.jsx("button",{type:"submit",className:"px-6 py-2 rounded bg-slate-900 text-white font-bold",children:""})]})]})}function WL(){const[t,e]=re.useState(!1),[r,n]=re.useState(!0),a=re.useRef(null),i="4sNrzUoSLQY",o=`https://www.youtube.com/embed/${i}?autoplay=1&mute=1&loop=1&playlist=${i}&controls=1&enablejsapi=1`,u=()=>{if(!a.current)return;const f=r?"unMute":"mute";a.current.contentWindow.postMessage(JSON.stringify({event:"command",func:f,args:[]}),"*"),n(!r)};return p.jsx("div",{className:`
                fixed bottom-4 z-[9999] transition-all duration-300
                ${t?"left-4":"left-1/2 -translate-x-1/2 md:left-4 md:translate-x-0"}
                ${t?"w-12 h-12":"w-80"}
            `,children:p.jsxs("div",{className:"bg-slate-900 border-4 border-yellow-400 rounded-xl shadow-[4px_4px_0px_0px_#000] overflow-hidden flex flex-col h-full",children:[p.jsx("div",{style:{display:t?"none":"block",height:"180px"},children:p.jsx("iframe",{ref:a,width:"100%",height:"100%",src:o,title:"YouTube music player",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0})}),t?p.jsx("button",{onClick:()=>e(!1),className:"w-full h-full flex items-center justify-center text-yellow-400 hover:bg-slate-800 bg-slate-900",children:p.jsx(gT,{size:20,className:"animate-pulse"})}):p.jsxs("div",{className:"p-3 bg-slate-900",children:[p.jsxs("div",{className:"flex justify-between items-center mb-1",children:[p.jsxs("span",{className:"text-[10px] font-black text-yellow-400 flex items-center gap-1",children:[p.jsx(gT,{size:12})," BGM PLAYER"]}),p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("button",{onClick:u,className:`hover:text-yellow-400 transition-colors ${r?"text-slate-400":"text-yellow-400"}`,title:r?"":"",children:r?p.jsx(hj,{size:16}):p.jsx(uj,{size:16})}),p.jsx("button",{onClick:()=>e(!0),className:"text-slate-400 hover:text-white",children:p.jsx(iy,{size:16})})]})]}),p.jsx("div",{className:"text-[10px] text-slate-400 text-center truncate px-1",children:r?" ":":   | "})]})]})})}const XL=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=800,u=800;let f=a.width,d=a.height;f>d?f>o&&(d*=o/f,f=o):d>u&&(f*=u/d,d=u),i.width=f,i.height=d,i.getContext("2d").drawImage(a,0,0,f,d),e(i.toDataURL("image/jpeg",.7))}}});function YL({onSubmit:t,onCancel:e,initialData:r=null}){const[n,a]=re.useState(r?.title||""),[i,o]=re.useState(()=>r?.images?.filter(R=>R.startsWith("http"))?.join(", ")||""),[u,f]=re.useState(r?.url||""),[d,m]=re.useState(r?.note||""),[x,y]=re.useState(()=>r?.images?.filter(R=>R.startsWith("data:"))||[]),w=async R=>{if(R.target.files){const H=5-(i.split(",").map(N=>N.trim()).filter(N=>N).length+x.length);if(H<=0){alert(" 5 "),R.target.value=null;return}const A=Array.from(R.target.files).slice(0,H),D=await Promise.all(A.map(N=>XL(N)));y(N=>[...N,...D]),R.target.value=null}},E=R=>{y(C=>C.filter((G,V)=>V!==R))},b=()=>{if(!n)return alert("");const C=[...i.split(",").map(G=>G.trim()).filter(G=>G),...x];t({title:n,images:C,url:u,note:d})},T=x.length+i.split(",").map(R=>R.trim()).filter(R=>R).length,I=!!r;return p.jsxs("form",{onSubmit:R=>{R.preventDefault(),b()},className:"flex flex-col gap-4 text-slate-800",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(pT,{size:16}),"  ()"]}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",placeholder:" ",value:n,onChange:R=>a(R.target.value),required:!0})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(K0,{size:16}),"  ()"]}),p.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 text-sm h-16 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",placeholder:"",value:i,onChange:R=>o(R.target.value)})]}),p.jsxs("div",{className:"flex flex-col gap-2 p-3 border-2 border-dashed border-slate-300 rounded-lg bg-slate-100",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 flex items-center justify-between",children:[p.jsxs("span",{children:[p.jsx(uy,{size:16,className:"inline mr-1"}),"  ( ",T," / 5)"]}),T>=5&&p.jsx("span",{className:"text-red-600 font-bold",children:""})]}),p.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:w,disabled:T>=5,className:"block w-full text-sm text-slate-700 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-2 file:border-red-800 file:text-xs file:font-black file:bg-red-600 file:text-white hover:file:bg-red-700 cursor-pointer disabled:opacity-50"}),x.length>0&&p.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 pb-4",children:x.map((R,C)=>p.jsxs("div",{className:"relative shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 border-slate-900 shadow",children:[p.jsx("img",{src:R,className:"w-full h-full object-cover",alt:"preview"}),p.jsx("button",{type:"button",onClick:()=>E(C),className:"absolute top-0 right-0 bg-red-600 text-white rounded-full p-1 transform translate-x-1/3 -translate-y-1/3 border-2 border-white hover:bg-red-700 transition-all",children:p.jsx(ua,{size:12})})]},C))})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(Ti,{size:16}),"  ()"]}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:u,onChange:R=>f(R.target.value),placeholder:"https://www.amazon.co.jp/..."})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(pT,{size:16})," / ()"]}),p.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 h-24 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",maxLength:500,value:d,onChange:R=>m(R.target.value),placeholder:" M  8000"})]}),p.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[p.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[p.jsx(ua,{size:16,className:"inline mr-1"})," "]}),p.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-red-600 text-white border-2 border-red-800 hover:bg-red-700 font-black italic shadow-[2px_2px_0px_0px_rgba(153,27,27,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(nc,{size:16,className:"inline mr-1"})," ",I?"":""]})]})]})}function $L({onSubmit:t,onCancel:e}){const[r,n]=re.useState(""),[a,i]=re.useState(""),[o,u]=re.useState(""),[f,d]=re.useState(""),[m,x]=re.useState([{id:Date.now(),name:"",price:"",quantity:1,url:""}]),y=()=>{x([...m,{id:Date.now(),name:"",price:"",quantity:1,url:""}])},w=T=>{m.length>1&&x(m.filter(I=>I.id!==T))},E=(T,I,R)=>{x(m.map(C=>C.id===T?{...C,[I]:R}:C))},b=T=>{if(T.preventDefault(),!r.trim())return alert(" IP ");if(!o.trim())return alert("");const I=m.filter(R=>R.name.trim()&&R.price);if(I.length===0)return alert("");t({ipName:r,type:a,sourceUrl:o,note:f,items:I})};return p.jsxs("form",{onSubmit:b,className:"space-y-5 font-sans text-slate-800",children:[p.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200",children:[p.jsxs("h4",{className:"font-black italic text-lg text-slate-900 border-b-2 border-slate-300 pb-2 mb-3 flex items-center gap-2",children:[p.jsx(xp,{size:20,className:"text-blue-600"}),"  (INFO)"]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" IP /  ",p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:" ...",value:r,onChange:T=>n(T.target.value)})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" ",p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsxs("div",{className:"flex gap-3",children:[p.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg p-2 text-center font-black transition-all ${a===""?"bg-slate-900 text-yellow-400 border-slate-900 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[p.jsx("input",{type:"radio",className:"hidden",value:"",checked:a==="",onChange:()=>i("")})," "]}),p.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg p-2 text-center font-black transition-all ${a===""?"bg-green-600 text-white border-green-800 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[p.jsx("input",{type:"radio",className:"hidden",value:"",checked:a==="",onChange:()=>i("")})," "]})]})]}),p.jsxs("div",{children:[p.jsxs("label",{className:"block text-sm font-black text-slate-700 mb-1",children:[" /  ",p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsxs("div",{className:"relative",children:[p.jsx(Nm,{size:16,className:"absolute left-3 top-3 text-slate-400"}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 pl-9 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:"...",value:o,onChange:T=>u(T.target.value)})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-black text-slate-700 mb-1",children:" ()"}),p.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-medium placeholder:font-normal h-20",placeholder:"...",value:f,onChange:T=>d(T.target.value)})]})]})]}),p.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border-2 border-slate-300",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4",children:[p.jsxs("h4",{className:"font-black italic text-lg text-slate-900 transform -skew-x-3 flex items-center gap-2",children:[p.jsx(yp,{size:20,className:"text-red-600"}),"  (ITEMS)"]}),p.jsx("button",{type:"button",onClick:y,className:"text-xs font-black px-3 py-1.5 bg-yellow-400 text-slate-900 rounded border-2 border-slate-900 hover:bg-yellow-500 transition-all shadow-sm",children:"+ "})]}),p.jsx("div",{className:"space-y-3",children:m.map((T,I)=>p.jsxs("div",{className:"bg-white p-3 rounded-lg border-2 border-slate-900 relative shadow-[2px_2px_0px_0px_rgba(15,23,42,1)] animate-in fade-in slide-in-from-bottom-1",children:[p.jsxs("div",{className:"flex justify-between items-center mb-2 border-b border-dashed border-slate-200 pb-1",children:[p.jsxs("span",{className:"text-xs font-black text-slate-400 italic",children:["ITEM #",I+1]}),m.length>1&&p.jsx("button",{type:"button",onClick:()=>w(T.id),className:"text-red-400 hover:text-red-600",children:p.jsx(ua,{size:16})})]}),p.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[p.jsxs("div",{className:"col-span-8",children:[p.jsxs("label",{className:"text-[10px] font-bold text-slate-500",children:[" ",p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsx("input",{className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm font-bold focus:border-slate-900 focus:ring-0",placeholder:" S",value:T.name,onChange:R=>E(T.id,"name",R.target.value)})]}),p.jsxs("div",{className:"col-span-4",children:[p.jsxs("label",{className:"text-[10px] font-bold text-slate-500",children:[" ",p.jsx("span",{className:"text-red-500",children:"*"})]}),p.jsx("input",{type:"number",className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm font-black text-red-600 focus:border-slate-900 focus:ring-0",placeholder:"",value:T.price,onChange:R=>E(T.id,"price",R.target.value)})]}),p.jsxs("div",{className:"col-span-4 sm:col-span-3",children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:""}),p.jsxs("div",{className:"flex items-center",children:[p.jsx("button",{type:"button",onClick:()=>E(T.id,"quantity",Math.max(1,T.quantity-1)),className:"bg-slate-200 p-1 rounded-l border-y-2 border-l-2 border-slate-200 hover:bg-slate-300",children:p.jsx(iy,{size:12})}),p.jsx("input",{type:"number",className:"w-full text-center border-y-2 border-slate-200 p-1 text-sm font-bold h-[30px]",value:T.quantity,onChange:R=>E(T.id,"quantity",Math.max(1,parseInt(R.target.value)||1))}),p.jsx("button",{type:"button",onClick:()=>E(T.id,"quantity",T.quantity+1),className:"bg-slate-200 p-1 rounded-r border-y-2 border-r-2 border-slate-200 hover:bg-slate-300",children:p.jsx(ql,{size:12})})]})]}),p.jsxs("div",{className:"col-span-8 sm:col-span-9",children:[p.jsx("label",{className:"text-[10px] font-bold text-slate-500",children:" ()"}),p.jsx("input",{className:"w-full border-2 border-slate-200 rounded p-1.5 text-sm text-slate-500 focus:border-slate-900 focus:ring-0",placeholder:"http://...",value:T.url,onChange:R=>E(T.id,"url",R.target.value)})]})]})]},T.id))})]}),p.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200",children:[p.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[p.jsx(ua,{size:16,className:"inline mr-1"})," "]}),p.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-purple-600 text-white border-2 border-purple-800 hover:bg-purple-700 font-black italic shadow-[4px_4px_0px_0px_rgba(76,29,149,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(nc,{size:16,className:"inline mr-1"})," "]})]})]})}function KL({group:t,currentOrder:e,onSubmit:r}){const[n,a]=re.useState(()=>{const m={};return t.items.forEach(x=>{const y=e?.items?.find(w=>w.itemId==x.id||w.name?.trim()===x.name?.trim()&&(w.spec?.trim()||"")===(x.spec?.trim()||""));m[x.id]=y?y.quantity:0}),m}),i=(m,x)=>{const y=parseInt(x)||0,w=t.items.find(b=>b.id===m);let E=Math.max(0,y);w?.limit&&E>w.limit&&(E=w.limit),a(b=>({...b,[m]:E}))},o=()=>{const m=t.items.map(x=>({itemId:x.id||x.name,name:x.name,spec:x.spec,price:x.price,image:x.image,quantity:n[x.id]||0})).filter(x=>x.quantity>0);if(m.length===0){e?confirm(" 0()")&&r([]):alert("");return}r(m)},u=t.items.reduce((m,x)=>{const y=Number(x.price)||0,w=n[x.id]||0;return m+y*w},0),f=Number(t.shippingFee||0),d=Math.round((u+f)*t.exchangeRate);return p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg border-2 border-yellow-400 text-sm font-bold text-slate-800",children:[p.jsxs("p",{className:"flex items-center gap-2",children:[p.jsx(Im,{size:16,className:"text-red-600"}),""]}),p.jsxs("ul",{className:"mt-1 ml-1 list-disc list-inside text-xs font-medium text-slate-600 space-y-0.5",children:[p.jsxs("li",{children:["",t.exchangeRate]}),p.jsxs("li",{children:[" ",f.toLocaleString()]}),p.jsxs("li",{children:["",t.deadline]})]})]}),p.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg border-2 border-slate-200",children:[p.jsx("h4",{className:"font-black italic text-lg text-slate-900 border-b border-slate-300 pb-3 mb-3",children:""}),p.jsx("div",{className:"space-y-4",children:t.items.map(m=>{const x=n[m.id]||0,y=m.limit&&x>=m.limit;return p.jsxs("div",{className:"flex items-center justify-between border-b-2 border-slate-100 pb-4 last:border-0 bg-white p-3 rounded-lg shadow-sm",children:[p.jsxs("div",{className:"flex items-start gap-3 flex-1 overflow-hidden",children:[p.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-100 border-2 border-slate-900 shrink-0 overflow-hidden flex items-center justify-center shadow-md",children:m.image?p.jsx("img",{src:m.image,alt:m.spec,className:"w-full h-full object-cover"}):p.jsx(K0,{size:20,className:"text-slate-400"})}),p.jsxs("div",{className:"min-w-0 pt-1",children:[p.jsx("div",{className:"font-black italic text-slate-900 truncate",children:m.name}),p.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-2 mt-1 flex-wrap",children:[m.spec&&p.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full font-bold",children:m.spec}),p.jsxs("span",{className:"text-red-600 font-black flex items-center gap-0.5",children:["",m.price]}),m.limit&&p.jsxs("span",{className:"text-xs text-slate-500 font-medium",children:[" (: ",m.limit,")"]}),y&&p.jsx("span",{className:"text-red-600 font-black text-xs",children:" (MAX!)"})]})]})]}),p.jsxs("div",{className:"flex items-center gap-1 pl-2 shrink-0",children:[p.jsx("button",{type:"button",className:"w-8 h-8 rounded-full bg-slate-100 hover:bg-slate-200 font-bold text-slate-900 flex items-center justify-center border-2 border-slate-900 transition-colors shadow-[1px_1px_0px_0px_rgba(15,23,42,1)] active:shadow-none active:translate-y-0.5 active:translate-x-0.5",onClick:()=>i(m.id,x-1),children:p.jsx(iy,{size:16})}),p.jsx("input",{type:"number",className:"w-10 text-center font-black italic text-lg border-none focus:ring-2 focus:ring-yellow-400 p-0 bg-transparent text-slate-900",value:x,onChange:w=>i(m.id,w.target.value),min:"0",max:m.limit||999}),p.jsx("button",{type:"button",className:`w-8 h-8 rounded-full font-bold flex items-center justify-center border-2 border-slate-900 transition-colors shadow-[1px_1px_0px_0px_rgba(15,23,42,1)] active:shadow-none active:translate-y-0.5 active:translate-x-0.5 ${y?"bg-slate-300 text-slate-600 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,onClick:()=>i(m.id,x+1),disabled:y,children:p.jsx(ql,{size:16})})]})]},m.id)})})]}),p.jsxs("div",{className:"bg-slate-800 text-white p-4 rounded-lg border-2 border-yellow-400 shadow-md",children:[p.jsx("h4",{className:"text-xl font-black italic text-yellow-400 mb-2",children:" (Summary)"}),p.jsxs("p",{className:"flex justify-between font-bold text-white border-b border-slate-600 pb-1 text-base",children:[p.jsx("span",{children:" (Goods JPY)"}),p.jsxs("span",{className:"font-mono text-xl text-red-400",children:[" ",u.toLocaleString()]})]}),f>0&&p.jsxs("p",{className:"flex justify-between text-sm pt-1 text-slate-300",children:[p.jsx("span",{children:" (Shipping JPY)"}),p.jsxs("span",{className:"font-mono",children:[" ",f.toLocaleString()]})]}),p.jsxs("p",{className:"flex justify-between pt-2 border-t border-slate-600 mt-2 font-black text-xl italic",children:[p.jsx("span",{children:" (NT$)"}),p.jsxs("span",{className:"font-mono text-2xl text-yellow-400",children:["NT$ ",d.toLocaleString()]})]})]}),p.jsx("div",{className:"pt-4 sticky bottom-0 bg-white/90 backdrop-blur-sm pb-2 border-t-2 border-yellow-400 mt-4",children:p.jsxs("button",{type:"button",className:"w-full py-3 bg-red-600 text-white rounded-lg font-black italic text-xl hover:bg-red-700 transition-all shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] active:translate-y-1 active:shadow-none active:translate-x-1 border-2 border-slate-900",onClick:o,children:[p.jsx(gp,{size:20,className:"inline mr-2"}),u===0&&e?"":e?"":" (PLUS ULTRA!)"]})})]})}var Dm={};Dm.version="0.18.5";var aC=1252,QL=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],py={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},gy=function(t){QL.indexOf(t)!=-1&&(aC=py[0]=t)};function JL(){gy(1252)}var ys=function(t){gy(t)};function xy(){ys(1200),JL()}function kT(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function ZL(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function sC(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var qf=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?ZL(t.slice(2)):e==254&&r==255?sC(t.slice(2)):e==65279?t.slice(1):t},Pd=function(e){return String.fromCharCode(e)},CT=function(e){return String.fromCharCode(e)},v0,Cl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function y0(t){for(var e="",r=0,n=0,a=0,i=0,o=0,u=0,f=0,d=0;d<t.length;)r=t.charCodeAt(d++),i=r>>2,n=t.charCodeAt(d++),o=(r&3)<<4|n>>4,a=t.charCodeAt(d++),u=(n&15)<<2|a>>6,f=a&63,isNaN(n)?u=f=64:isNaN(a)&&(f=64),e+=Cl.charAt(i)+Cl.charAt(o)+Cl.charAt(u)+Cl.charAt(f);return e}function Ia(t){var e="",r=0,n=0,a=0,i=0,o=0,u=0,f=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)i=Cl.indexOf(t.charAt(d++)),o=Cl.indexOf(t.charAt(d++)),r=i<<2|o>>4,e+=String.fromCharCode(r),u=Cl.indexOf(t.charAt(d++)),n=(o&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),f=Cl.indexOf(t.charAt(d++)),a=(u&3)<<6|f,f!==64&&(e+=String.fromCharCode(a));return e}var Tt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Bi=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Xl(t){return Tt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function NT(t){return Tt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Aa=function(e){return Tt?Bi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Ep(t){if(typeof ArrayBuffer>"u")return Aa(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function ro(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function e7(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function vy(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return vy(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var gn=Tt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Bi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function t7(t){for(var e=[],r=0,n=t.length+250,a=Xl(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=t.charCodeAt(++i)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|u>>6&15|(o&3)<<4,a[r++]=128|u&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Xl(65535),n=65530)}return e.push(a.slice(0,r)),gn(e)}var Zn=/\u0000/g,Wf=/[\u0001-\u0006]/g;function cu(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function _s(t,e){var r=""+t;return r.length>=e?r:Rr("0",e-r.length)+r}function yy(t,e){var r=""+t;return r.length>=e?r:Rr(" ",e-r.length)+r}function Om(t,e){var r=""+t;return r.length>=e?r:r+Rr(" ",e-r.length)}function r7(t,e){var r=""+Math.round(t);return r.length>=e?r:Rr("0",e-r.length)+r}function n7(t,e){var r=""+t;return r.length>=e?r:Rr("0",e-r.length)+r}var RT=Math.pow(2,32);function $c(t,e){if(t>RT||t<-RT)return r7(t,e);var r=Math.round(t);return n7(r,e)}function Fm(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var IT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],K1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function a7(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},DT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},s7={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Mm(t,e,r){for(var n=t<0?-1:1,a=t*n,i=0,o=1,u=0,f=1,d=0,m=0,x=Math.floor(a);d<e&&(x=Math.floor(a),u=x*o+i,m=x*d+f,!(a-x<5e-8));)a=1/(a-x),i=o,o=u,f=d,d=m;if(m>e&&(d>e?(m=f,u=i):(m=d,u=o)),!r)return[0,n*u,m];var y=Math.floor(n*u/m);return[y,n*u-y*m,m]}function Mo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),i=0,o=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)o=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),o=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=f7(f,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=i,u}var iC=new Date(1899,11,31,0,0,0),i7=iC.getTime(),l7=new Date(1900,2,1,0,0,0);function lC(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=l7&&(r+=1440*60*1e3),(r-(i7+(t.getTimezoneOffset()-iC.getTimezoneOffset())*6e4))/(1440*60*1e3)}function _y(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function o7(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function c7(t){var e=t<0?12:11,r=_y(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function u7(t){var e=_y(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function _0(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=c7(t):e===10?r=t.toFixed(10).substr(0,12):r=u7(t),_y(o7(r.toUpperCase()))}function Yo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):_0(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return es(14,lC(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function f7(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function h7(t,e,r,n){var a="",i=0,o=0,u=r.y,f,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:f=u%100,d=2;break;default:f=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:f=r.m,d=e.length;break;case 3:return K1[r.m-1][1];case 5:return K1[r.m-1][0];default:return K1[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:f=r.d,d=e.length;break;case 3:return IT[r.q][0];default:return IT[r.q][1]}break;case 104:switch(e.length){case 1:case 2:f=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:f=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:f=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?_s(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,i=Math.round(o*(r.S+r.u)),i>=60*o&&(i=0),e==="s"?i===0?"0":""+i/o:(a=_s(i,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:f=u,d=1;break}var m=d>0?_s(f,d):"";return m}function Nl(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var oC=/%/g;function d7(t,e,r){var n=e.replace(oC,""),a=e.length-n.length;return ki(t,n,r*Math.pow(10,2*a))+Rr("%",a)}function m7(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ki(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function cC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+cC(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(a+i)%a)+"."+m.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var uC=/# (\?+)( ?)\/( ?)(\d+)/;function p7(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),i=Math.floor(a/n),o=a-i*n,u=n;return r+(i===0?"":""+i)+" "+(o===0?Rr(" ",t[1].length+1+t[4].length):yy(o,t[1].length)+t[2]+"/"+t[3]+_s(u,t[4].length))}function g7(t,e,r){return r+(e===0?"":""+e)+Rr(" ",t[1].length+2+t[4].length)}var fC=/^#*0*\.([0#]+)/,hC=/\).*[0#]/,dC=/\(###\) ###\\?-####/;function Kn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function OT(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function FT(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function x7(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function v7(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Wa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(hC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wa("n",n,r):"("+Wa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return m7(t,e,r);if(e.indexOf("%")!==-1)return d7(t,e,r);if(e.indexOf("E")!==-1)return cC(e,r);if(e.charCodeAt(0)===36)return"$"+Wa(t,e.substr(e.charAt(1)==" "?2:1),r);var a,i,o,u,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+$c(f,e.length);if(e.match(/^[#?]+$/))return a=$c(r,0),a==="0"&&(a=""),a.length>e.length?a:Kn(e.substr(0,e.length-a.length))+a;if(i=e.match(uC))return p7(i,f,d);if(e.match(/^#+0+$/))return d+$c(f,e.length-e.indexOf("0"));if(i=e.match(fC))return a=OT(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Kn(i[1])).replace(/\.$/,"."+Kn(i[1])).replace(/\.(\d*)$/,function(E,b){return"."+b+Rr("0",Kn(i[1]).length-b.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+OT(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+Nl($c(f,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wa(t,e,-r):Nl(""+(Math.floor(r)+x7(r,i[1].length)))+"."+_s(FT(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Wa(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=cu(Wa(t,e.replace(/[\\-]/g,""),r)),o=0,cu(cu(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<a.length?a.charAt(o++):E==="0"?"0":""}));if(e.match(dC))return a=Wa(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=Mm(f,Math.pow(10,o)-1,!1),a=""+d,m=ki("n",i[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+i[2]+"/"+i[3],m=Om(u[2],o),m.length<i[4].length&&(m=Kn(i[4].substr(i[4].length-m.length))+m),a+=m,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=Mm(f,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?yy(u[1],o)+i[2]+"/"+i[3]+Om(u[2],o):Rr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=$c(r,0),e.length<=a.length?a:Kn(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var x=e.indexOf(".")-o,y=e.length-a.length-x;return Kn(e.substr(0,x)+a+e.substr(e.length-y))}if(i=e.match(/^00,000\.([#0]*0)$/))return o=FT(r,i[1].length),r<0?"-"+Wa(t,e,-r):Nl(v7(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?_s(0,3-E.length):"")+E})+"."+_s(o,i[1].length);switch(e){case"###,##0.00":return Wa(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var w=Nl($c(f,0));return w!=="0"?d+w:"";case"###,###.00":return Wa(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Wa(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function y7(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ki(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function _7(t,e,r){var n=e.replace(oC,""),a=e.length-n.length;return ki(t,n,r*Math.pow(10,2*a))+Rr("%",a)}function mC(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+mC(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(e/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+i):r+="E+"+(o-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,f,d,m){return f+d+m.substr(0,(a+i)%a)+"."+m.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ps(t,e,r){if(t.charCodeAt(0)===40&&!e.match(hC)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ps("n",n,r):"("+Ps("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return y7(t,e,r);if(e.indexOf("%")!==-1)return _7(t,e,r);if(e.indexOf("E")!==-1)return mC(e,r);if(e.charCodeAt(0)===36)return"$"+Ps(t,e.substr(e.charAt(1)==" "?2:1),r);var a,i,o,u,f=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+_s(f,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:Kn(e.substr(0,e.length-a.length))+a;if(i=e.match(uC))return g7(i,f,d);if(e.match(/^#+0+$/))return d+_s(f,e.length-e.indexOf("0"));if(i=e.match(fC))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Kn(i[1])).replace(/\.$/,"."+Kn(i[1])),a=a.replace(/\.(\d*)$/,function(E,b){return"."+b+Rr("0",Kn(i[1]).length-b.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return d+Nl(""+f);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ps(t,e,-r):Nl(""+r)+"."+Rr("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Ps(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=cu(Ps(t,e.replace(/[\\-]/g,""),r)),o=0,cu(cu(e.replace(/\\/g,"")).replace(/[0#]/g,function(E){return o<a.length?a.charAt(o++):E==="0"?"0":""}));if(e.match(dC))return a=Ps(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),u=Mm(f,Math.pow(10,o)-1,!1),a=""+d,m=ki("n",i[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+i[2]+"/"+i[3],m=Om(u[2],o),m.length<i[4].length&&(m=Kn(i[4].substr(i[4].length-m.length))+m),a+=m,a;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),u=Mm(f,Math.pow(10,o)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?yy(u[1],o)+i[2]+"/"+i[3]+Om(u[2],o):Rr(" ",2*o+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:Kn(e.substr(0,e.length-a.length))+a;if(i=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var x=e.indexOf(".")-o,y=e.length-a.length-x;return Kn(e.substr(0,x)+a+e.substr(e.length-y))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ps(t,e,-r):Nl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?_s(0,3-E.length):"")+E})+"."+_s(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var w=Nl(""+f);return w!=="0"?d+w:"";default:if(e.match(/\.[0#?]*$/))return Ps(t,e.slice(0,e.lastIndexOf(".")),r)+Kn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ki(t,e,r){return(r|0)===r?Ps(t,e,r):Wa(t,e,r)}function w7(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var pC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pu(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Fm(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(pC))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function b7(t,e,r,n){for(var a=[],i="",o=0,u="",f="t",d,m,x,y="H";o<t.length;)switch(u=t.charAt(o)){case"G":if(!Fm(t,o))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(x=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(x);a[a.length]={t:"t",v:i},++o;break;case"\\":var w=t.charAt(++o),E=w==="("||w===")"?w:"t";a[a.length]={t:E,v:w},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=Mo(e,r,t.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},f=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Mo(e,r),d==null))return"";for(i=u;++o<t.length&&t.charAt(o).toLowerCase()===u;)i+=u;u==="m"&&f.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=y),a[a.length]={t:u,v:i},f=u;break;case"A":case"a":case"":var b={t:u,v:u};if(d==null&&(d=Mo(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(b.v=d.H>=12?"P":"A"),b.t="T",y="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(b.v=d.H>=12?"PM":"AM"),b.t="T",o+=5,y="h"):t.substr(o,5).toUpperCase()==="/"?(d!=null&&(b.v=d.H>=12?"":""),b.t="T",o+=5,y="h"):(b.t="t",++o),d==null&&b.t==="T")return"";a[a.length]=b,f=u;break;case"[":for(i=u;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(pC)){if(d==null&&(d=Mo(e,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pu(t)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=u;++o<t.length&&(u=t.charAt(o))==="0";)i+=u;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=u;++o<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(o))>-1;)i+=u;a[a.length]={t:"n",v:i};break;case"?":for(i=u;t.charAt(++o)===u;)i+=u;a[a.length]={t:u,v:i},f=u;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=u;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:u,v:u},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++o;break}var T=0,I=0,R;for(o=a.length-1,f="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=y,f="h",T<1&&(T=1);break;case"s":(R=a[o].v.match(/\.0+$/))&&(I=Math.max(I,R[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":f=a[o].t;break;case"m":f==="s"&&(a[o].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&a[o].v.match(/[Hh]/)&&(T=1),T<2&&a[o].v.match(/[Mm]/)&&(T=2),T<3&&a[o].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var C="",G;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=h7(a[o].t.charCodeAt(0),a[o].v,d,I),a[o].t="t";break;case"n":case"?":for(G=o+1;a[G]!=null&&((u=a[G].t)==="?"||u==="D"||(u===" "||u==="t")&&a[G+1]!=null&&(a[G+1].t==="?"||a[G+1].t==="t"&&a[G+1].v==="/")||a[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[G].v==="/"||a[G].v===" "&&a[G+1]!=null&&a[G+1].t=="?"));)a[o].v+=a[G].v,a[G]={v:"",t:";"},++G;C+=a[o].v,o=G-1;break;case"G":a[o].t="t",a[o].v=Yo(e,r);break}var V="",H,A;if(C.length>0){C.charCodeAt(0)==40?(H=e<0&&C.charCodeAt(0)===45?-e:e,A=ki("n",C,H)):(H=e<0&&n>1?-e:e,A=ki("n",C,H),H<0&&a[0]&&a[0].t=="t"&&(A=A.substr(1),a[0].v="-"+a[0].v)),G=A.length-1;var D=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){D=o;break}var N=a.length;if(D===a.length&&A.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(G>=a[o].v.length-1?(G-=a[o].v.length,a[o].v=A.substr(G+1,a[o].v.length)):G<0?a[o].v="":(a[o].v=A.substr(0,G+1),G=-1),a[o].t="t",N=o);G>=0&&N<a.length&&(a[N].v=A.substr(0,G+1)+a[N].v)}else if(D!==a.length&&A.indexOf("E")===-1){for(G=A.indexOf(".")-1,o=D;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(m=a[o].v.indexOf(".")>-1&&o===D?a[o].v.indexOf(".")-1:a[o].v.length-1,V=a[o].v.substr(m+1);m>=0;--m)G>=0&&(a[o].v.charAt(m)==="0"||a[o].v.charAt(m)==="#")&&(V=A.charAt(G--)+V);a[o].v=V,a[o].t="t",N=o}for(G>=0&&N<a.length&&(a[N].v=A.substr(0,G+1)+a[N].v),G=A.indexOf(".")+1,o=D;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==D)){for(m=a[o].v.indexOf(".")>-1&&o===D?a[o].v.indexOf(".")+1:0,V=a[o].v.substr(0,m);m<a[o].v.length;++m)G<A.length&&(V+=A.charAt(G++));a[o].v=V,a[o].t="t",N=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(H=n>1&&e<0&&o>0&&a[o-1].v==="-"?-e:e,a[o].v=ki(a[o].t,a[o].v,H),a[o].t="t");var M="";for(o=0;o!==a.length;++o)a[o]!=null&&(M+=a[o].v);return M}var MT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function PT(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function E7(t,e){var r=w7(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(MT),u=r[1].match(MT);return PT(e,o)?[n,r[0]]:PT(e,u)?[n,r[1]]:[n,r[o!=null&&u!=null?2:1]]}return[n,i]}function es(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:lt)[t],n==null&&(n=r.table&&r.table[DT[t]]||lt[DT[t]]),n==null&&(n=s7[t]||"General");break}if(Fm(n,0))return Yo(e,r);e instanceof Date&&(e=lC(e,r.date1904));var a=E7(n,e);if(Fm(a[1]))return Yo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return b7(a[1],e,r,a[0])}function Ci(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(lt[r]==null){e<0&&(e=r);continue}if(lt[r]==t){e=r;break}}e<0&&(e=391)}return lt[e]=t,e}function Tp(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ci(t[e],e)}function ju(){lt=a7()}var T7={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},gC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function S7(t){var e=typeof t=="number"?lt[t]:t;return e=e.replace(gC,"(\\d+)"),new RegExp("^"+e+"$")}function A7(t,e,r){var n=-1,a=-1,i=-1,o=-1,u=-1,f=-1;(e.match(gC)||[]).forEach(function(x,y){var w=parseInt(r[y+1],10);switch(x.toLowerCase().charAt(0)){case"y":n=w;break;case"d":i=w;break;case"h":o=w;break;case"s":f=w;break;case"m":o>=0?u=w:a=w;break}}),f>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return o==-1&&u==-1&&f==-1?d:n==-1&&a==-1&&i==-1?m:d+"T"+m}var k7=(function(){var t={};t.version="1.2.0";function e(){for(var A=0,D=new Array(256),N=0;N!=256;++N)A=N,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,D[N]=A;return typeof Int32Array<"u"?new Int32Array(D):D}var r=e();function n(A){var D=0,N=0,M=0,F=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)F[M]=A[M];for(M=0;M!=256;++M)for(N=A[M],D=256+M;D<4096;D+=256)N=F[D]=N>>>8^A[N&255];var j=[];for(M=1;M!=16;++M)j[M-1]=typeof Int32Array<"u"?F.subarray(M*256,M*256+256):F.slice(M*256,M*256+256);return j}var a=n(r),i=a[0],o=a[1],u=a[2],f=a[3],d=a[4],m=a[5],x=a[6],y=a[7],w=a[8],E=a[9],b=a[10],T=a[11],I=a[12],R=a[13],C=a[14];function G(A,D){for(var N=D^-1,M=0,F=A.length;M<F;)N=N>>>8^r[(N^A.charCodeAt(M++))&255];return~N}function V(A,D){for(var N=D^-1,M=A.length-15,F=0;F<M;)N=C[A[F++]^N&255]^R[A[F++]^N>>8&255]^I[A[F++]^N>>16&255]^T[A[F++]^N>>>24]^b[A[F++]]^E[A[F++]]^w[A[F++]]^y[A[F++]]^x[A[F++]]^m[A[F++]]^d[A[F++]]^f[A[F++]]^u[A[F++]]^o[A[F++]]^i[A[F++]]^r[A[F++]];for(M+=15;F<M;)N=N>>>8^r[(N^A[F++])&255];return~N}function H(A,D){for(var N=D^-1,M=0,F=A.length,j=0,P=0;M<F;)j=A.charCodeAt(M++),j<128?N=N>>>8^r[(N^j)&255]:j<2048?(N=N>>>8^r[(N^(192|j>>6&31))&255],N=N>>>8^r[(N^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,P=A.charCodeAt(M++)&1023,N=N>>>8^r[(N^(240|j>>8&7))&255],N=N>>>8^r[(N^(128|j>>2&63))&255],N=N>>>8^r[(N^(128|P>>6&15|(j&3)<<4))&255],N=N>>>8^r[(N^(128|P&63))&255]):(N=N>>>8^r[(N^(224|j>>12&15))&255],N=N>>>8^r[(N^(128|j>>6&63))&255],N=N>>>8^r[(N^(128|j&63))&255]);return~N}return t.table=r,t.bstr=G,t.buf=V,t.str=H,t})(),nt=(function(){var e={};e.version="1.2.1";function r(U,Z){for(var q=U.split("/"),X=Z.split("/"),K=0,ee=0,de=Math.min(q.length,X.length);K<de;++K){if(ee=q[K].length-X[K].length)return ee;if(q[K]!=X[K])return q[K]<X[K]?-1:1}return q.length-X.length}function n(U){if(U.charAt(U.length-1)=="/")return U.slice(0,-1).indexOf("/")===-1?U:n(U.slice(0,-1));var Z=U.lastIndexOf("/");return Z===-1?U:U.slice(0,Z+1)}function a(U){if(U.charAt(U.length-1)=="/")return a(U.slice(0,-1));var Z=U.lastIndexOf("/");return Z===-1?U:U.slice(Z+1)}function i(U,Z){typeof Z=="string"&&(Z=new Date(Z));var q=Z.getHours();q=q<<6|Z.getMinutes(),q=q<<5|Z.getSeconds()>>>1,U.write_shift(2,q);var X=Z.getFullYear()-1980;X=X<<4|Z.getMonth()+1,X=X<<5|Z.getDate(),U.write_shift(2,X)}function o(U){var Z=U.read_shift(2)&65535,q=U.read_shift(2)&65535,X=new Date,K=q&31;q>>>=5;var ee=q&15;q>>>=4,X.setMilliseconds(0),X.setFullYear(q+1980),X.setMonth(ee-1),X.setDate(K);var de=Z&31;Z>>>=5;var ke=Z&63;return Z>>>=6,X.setHours(Z),X.setMinutes(ke),X.setSeconds(de<<1),X}function u(U){Sn(U,0);for(var Z={},q=0;U.l<=U.length-4;){var X=U.read_shift(2),K=U.read_shift(2),ee=U.l+K,de={};switch(X){case 21589:q=U.read_shift(1),q&1&&(de.mtime=U.read_shift(4)),K>5&&(q&2&&(de.atime=U.read_shift(4)),q&4&&(de.ctime=U.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}U.l=ee,Z[X]=de}return Z}var f;function d(){return f||(f={})}function m(U,Z){if(U[0]==80&&U[1]==75)return da(U,Z);if((U[0]|32)==109&&(U[1]|32)==105)return ei(U,Z);if(U.length<512)throw new Error("CFB file size "+U.length+" < 512");var q=3,X=512,K=0,ee=0,de=0,ke=0,me=0,xe=[],ge=U.slice(0,512);Sn(ge,0);var Be=x(ge);switch(q=Be[0],q){case 3:X=512;break;case 4:X=4096;break;case 0:if(Be[1]==0)return da(U,Z);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}X!==512&&(ge=U.slice(0,X),Sn(ge,28));var Ve=U.slice(0,X);y(ge,q);var qe=ge.read_shift(4,"i");if(q===3&&qe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+qe);ge.l+=4,de=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),ke=ge.read_shift(4,"i"),K=ge.read_shift(4,"i"),me=ge.read_shift(4,"i"),ee=ge.read_shift(4,"i");for(var Le=-1,Ge=0;Ge<109&&(Le=ge.read_shift(4,"i"),!(Le<0));++Ge)xe[Ge]=Le;var Ze=w(U,X);T(me,ee,Ze,X,xe);var Yt=R(Ze,de,xe,X);Yt[de].name="!Directory",K>0&&ke!==P&&(Yt[ke].name="!MiniFAT"),Yt[xe[0]].name="!FAT",Yt.fat_addrs=xe,Yt.ssz=X;var $t={},cr=[],Nn=[],ss=[];C(de,Yt,Ze,cr,K,$t,Nn,ke),E(Nn,ss,cr),cr.shift();var is={FileIndex:Nn,FullPaths:ss};return Z&&Z.raw&&(is.raw={header:Ve,sectors:Ze}),is}function x(U){if(U[U.l]==80&&U[U.l+1]==75)return[0,0];U.chk(be,"Header Signature: "),U.l+=16;var Z=U.read_shift(2,"u");return[U.read_shift(2,"u"),Z]}function y(U,Z){var q=9;switch(U.l+=2,q=U.read_shift(2)){case 9:if(Z!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(Z!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}U.chk("0600","Mini Sector Shift: "),U.chk("000000000000","Reserved: ")}function w(U,Z){for(var q=Math.ceil(U.length/Z)-1,X=[],K=1;K<q;++K)X[K-1]=U.slice(K*Z,(K+1)*Z);return X[q-1]=U.slice(q*Z),X}function E(U,Z,q){for(var X=0,K=0,ee=0,de=0,ke=0,me=q.length,xe=[],ge=[];X<me;++X)xe[X]=ge[X]=X,Z[X]=q[X];for(;ke<ge.length;++ke)X=ge[ke],K=U[X].L,ee=U[X].R,de=U[X].C,xe[X]===X&&(K!==-1&&xe[K]!==K&&(xe[X]=xe[K]),ee!==-1&&xe[ee]!==ee&&(xe[X]=xe[ee])),de!==-1&&(xe[de]=X),K!==-1&&X!=xe[X]&&(xe[K]=xe[X],ge.lastIndexOf(K)<ke&&ge.push(K)),ee!==-1&&X!=xe[X]&&(xe[ee]=xe[X],ge.lastIndexOf(ee)<ke&&ge.push(ee));for(X=1;X<me;++X)xe[X]===X&&(ee!==-1&&xe[ee]!==ee?xe[X]=xe[ee]:K!==-1&&xe[K]!==K&&(xe[X]=xe[K]));for(X=1;X<me;++X)if(U[X].type!==0){if(ke=X,ke!=xe[ke])do ke=xe[ke],Z[X]=Z[ke]+"/"+Z[X];while(ke!==0&&xe[ke]!==-1&&ke!=xe[ke]);xe[X]=-1}for(Z[0]+="/",X=1;X<me;++X)U[X].type!==2&&(Z[X]+="/")}function b(U,Z,q){for(var X=U.start,K=U.size,ee=[],de=X;q&&K>0&&de>=0;)ee.push(Z.slice(de*j,de*j+j)),K-=j,de=Oo(q,de*4);return ee.length===0?Se(0):gn(ee).slice(0,U.size)}function T(U,Z,q,X,K){var ee=P;if(U===P){if(Z!==0)throw new Error("DIFAT chain shorter than expected")}else if(U!==-1){var de=q[U],ke=(X>>>2)-1;if(!de)return;for(var me=0;me<ke&&(ee=Oo(de,me*4))!==P;++me)K.push(ee);T(Oo(de,X-4),Z-1,q,X,K)}}function I(U,Z,q,X,K){var ee=[],de=[];K||(K=[]);var ke=X-1,me=0,xe=0;for(me=Z;me>=0;){K[me]=!0,ee[ee.length]=me,de.push(U[me]);var ge=q[Math.floor(me*4/X)];if(xe=me*4&ke,X<4+xe)throw new Error("FAT boundary crossed: "+me+" 4 "+X);if(!U[ge])break;me=Oo(U[ge],xe)}return{nodes:ee,data:YT([de])}}function R(U,Z,q,X){var K=U.length,ee=[],de=[],ke=[],me=[],xe=X-1,ge=0,Be=0,Ve=0,qe=0;for(ge=0;ge<K;++ge)if(ke=[],Ve=ge+Z,Ve>=K&&(Ve-=K),!de[Ve]){me=[];var Le=[];for(Be=Ve;Be>=0;){Le[Be]=!0,de[Be]=!0,ke[ke.length]=Be,me.push(U[Be]);var Ge=q[Math.floor(Be*4/X)];if(qe=Be*4&xe,X<4+qe)throw new Error("FAT boundary crossed: "+Be+" 4 "+X);if(!U[Ge]||(Be=Oo(U[Ge],qe),Le[Be]))break}ee[Ve]={nodes:ke,data:YT([me])}}return ee}function C(U,Z,q,X,K,ee,de,ke){for(var me=0,xe=X.length?2:0,ge=Z[U].data,Be=0,Ve=0,qe;Be<ge.length;Be+=128){var Le=ge.slice(Be,Be+128);Sn(Le,64),Ve=Le.read_shift(2),qe=ky(Le,0,Ve-xe),X.push(qe);var Ge={name:qe,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},Ze=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);Ze!==0&&(Ge.ct=G(Le,Le.l-8));var Yt=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);Yt!==0&&(Ge.mt=G(Le,Le.l-8)),Ge.start=Le.read_shift(4,"i"),Ge.size=Le.read_shift(4,"i"),Ge.size<0&&Ge.start<0&&(Ge.size=Ge.type=0,Ge.start=P,Ge.name=""),Ge.type===5?(me=Ge.start,K>0&&me!==P&&(Z[me].name="!StreamData")):Ge.size>=4096?(Ge.storage="fat",Z[Ge.start]===void 0&&(Z[Ge.start]=I(q,Ge.start,Z.fat_addrs,Z.ssz)),Z[Ge.start].name=Ge.name,Ge.content=Z[Ge.start].data.slice(0,Ge.size)):(Ge.storage="minifat",Ge.size<0?Ge.size=0:me!==P&&Ge.start!==P&&Z[me]&&(Ge.content=b(Ge,Z[me].data,(Z[ke]||{}).data))),Ge.content&&Sn(Ge.content,0),ee[qe]=Ge,de.push(Ge)}}function G(U,Z){return new Date((Sa(U,Z+4)/1e7*Math.pow(2,32)+Sa(U,Z)/1e7-11644473600)*1e3)}function V(U,Z){return d(),m(f.readFileSync(U),Z)}function H(U,Z){var q=Z&&Z.type;switch(q||Tt&&Buffer.isBuffer(U)&&(q="buffer"),q||"base64"){case"file":return V(U,Z);case"base64":return m(Aa(Ia(U)),Z);case"binary":return m(Aa(U),Z)}return m(U,Z)}function A(U,Z){var q=Z||{},X=q.root||"Root Entry";if(U.FullPaths||(U.FullPaths=[]),U.FileIndex||(U.FileIndex=[]),U.FullPaths.length!==U.FileIndex.length)throw new Error("inconsistent CFB structure");U.FullPaths.length===0&&(U.FullPaths[0]=X+"/",U.FileIndex[0]={name:X,type:5}),q.CLSID&&(U.FileIndex[0].clsid=q.CLSID),D(U)}function D(U){var Z="Sh33tJ5";if(!nt.find(U,"/"+Z)){var q=Se(4);q[0]=55,q[1]=q[3]=50,q[2]=54,U.FileIndex.push({name:Z,type:2,content:q,size:4,L:69,R:69,C:69}),U.FullPaths.push(U.FullPaths[0]+Z),N(U)}}function N(U,Z){A(U);for(var q=!1,X=!1,K=U.FullPaths.length-1;K>=0;--K){var ee=U.FileIndex[K];switch(ee.type){case 0:X?q=!0:(U.FileIndex.pop(),U.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(ee.R*ee.L*ee.C)&&(q=!0),ee.R>-1&&ee.L>-1&&ee.R==ee.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!Z)){var de=new Date(1987,1,19),ke=0,me=Object.create?Object.create(null):{},xe=[];for(K=0;K<U.FullPaths.length;++K)me[U.FullPaths[K]]=!0,U.FileIndex[K].type!==0&&xe.push([U.FullPaths[K],U.FileIndex[K]]);for(K=0;K<xe.length;++K){var ge=n(xe[K][0]);X=me[ge],X||(xe.push([ge,{name:a(ge).replace("/",""),type:1,clsid:se,ct:de,mt:de,content:null}]),me[ge]=!0)}for(xe.sort(function(qe,Le){return r(qe[0],Le[0])}),U.FullPaths=[],U.FileIndex=[],K=0;K<xe.length;++K)U.FullPaths[K]=xe[K][0],U.FileIndex[K]=xe[K][1];for(K=0;K<xe.length;++K){var Be=U.FileIndex[K],Ve=U.FullPaths[K];if(Be.name=a(Ve).replace("/",""),Be.L=Be.R=Be.C=-(Be.color=1),Be.size=Be.content?Be.content.length:0,Be.start=0,Be.clsid=Be.clsid||se,K===0)Be.C=xe.length>1?1:-1,Be.size=0,Be.type=5;else if(Ve.slice(-1)=="/"){for(ke=K+1;ke<xe.length&&n(U.FullPaths[ke])!=Ve;++ke);for(Be.C=ke>=xe.length?-1:ke,ke=K+1;ke<xe.length&&n(U.FullPaths[ke])!=n(Ve);++ke);Be.R=ke>=xe.length?-1:ke,Be.type=1}else n(U.FullPaths[K+1]||"")==n(Ve)&&(Be.R=K+1),Be.type=2}}}function M(U,Z){var q=Z||{};if(q.fileType=="mad")return Uu(U,q);switch(N(U),q.fileType){case"zip":return kr(U,q)}var X=(function(qe){for(var Le=0,Ge=0,Ze=0;Ze<qe.FileIndex.length;++Ze){var Yt=qe.FileIndex[Ze];if(Yt.content){var $t=Yt.content.length;$t>0&&($t<4096?Le+=$t+63>>6:Ge+=$t+511>>9)}}for(var cr=qe.FullPaths.length+3>>2,Nn=Le+7>>3,ss=Le+127>>7,is=Nn+Ge+cr+ss,pa=is+127>>7,zi=pa<=109?0:Math.ceil((pa-109)/127);is+pa+zi+127>>7>pa;)zi=++pa<=109?0:Math.ceil((pa-109)/127);var Rn=[1,zi,pa,ss,cr,Ge,Le,0];return qe.FileIndex[0].size=Le<<6,Rn[7]=(qe.FileIndex[0].start=Rn[0]+Rn[1]+Rn[2]+Rn[3]+Rn[4]+Rn[5])+(Rn[6]+7>>3),Rn})(U),K=Se(X[7]<<9),ee=0,de=0;{for(ee=0;ee<8;++ee)K.write_shift(1,ye[ee]);for(ee=0;ee<8;++ee)K.write_shift(2,0);for(K.write_shift(2,62),K.write_shift(2,3),K.write_shift(2,65534),K.write_shift(2,9),K.write_shift(2,6),ee=0;ee<3;++ee)K.write_shift(2,0);for(K.write_shift(4,0),K.write_shift(4,X[2]),K.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),K.write_shift(4,0),K.write_shift(4,4096),K.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:P),K.write_shift(4,X[3]),K.write_shift(-4,X[1]?X[0]-1:P),K.write_shift(4,X[1]),ee=0;ee<109;++ee)K.write_shift(-4,ee<X[2]?X[1]+ee:-1)}if(X[1])for(de=0;de<X[1];++de){for(;ee<236+de*127;++ee)K.write_shift(-4,ee<X[2]?X[1]+ee:-1);K.write_shift(-4,de===X[1]-1?P:de+1)}var ke=function(qe){for(de+=qe;ee<de-1;++ee)K.write_shift(-4,ee+1);qe&&(++ee,K.write_shift(-4,P))};for(de=ee=0,de+=X[1];ee<de;++ee)K.write_shift(-4,ce.DIFSECT);for(de+=X[2];ee<de;++ee)K.write_shift(-4,ce.FATSECT);ke(X[3]),ke(X[4]);for(var me=0,xe=0,ge=U.FileIndex[0];me<U.FileIndex.length;++me)ge=U.FileIndex[me],ge.content&&(xe=ge.content.length,!(xe<4096)&&(ge.start=de,ke(xe+511>>9)));for(ke(X[6]+7>>3);K.l&511;)K.write_shift(-4,ce.ENDOFCHAIN);for(de=ee=0,me=0;me<U.FileIndex.length;++me)ge=U.FileIndex[me],ge.content&&(xe=ge.content.length,!(!xe||xe>=4096)&&(ge.start=de,ke(xe+63>>6)));for(;K.l&511;)K.write_shift(-4,ce.ENDOFCHAIN);for(ee=0;ee<X[4]<<2;++ee){var Be=U.FullPaths[ee];if(!Be||Be.length===0){for(me=0;me<17;++me)K.write_shift(4,0);for(me=0;me<3;++me)K.write_shift(4,-1);for(me=0;me<12;++me)K.write_shift(4,0);continue}ge=U.FileIndex[ee],ee===0&&(ge.start=ge.size?ge.start-1:P);var Ve=ee===0&&q.root||ge.name;if(xe=2*(Ve.length+1),K.write_shift(64,Ve,"utf16le"),K.write_shift(2,xe),K.write_shift(1,ge.type),K.write_shift(1,ge.color),K.write_shift(-4,ge.L),K.write_shift(-4,ge.R),K.write_shift(-4,ge.C),ge.clsid)K.write_shift(16,ge.clsid,"hex");else for(me=0;me<4;++me)K.write_shift(4,0);K.write_shift(4,ge.state||0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,0),K.write_shift(4,ge.start),K.write_shift(4,ge.size),K.write_shift(4,0)}for(ee=1;ee<U.FileIndex.length;++ee)if(ge=U.FileIndex[ee],ge.size>=4096)if(K.l=ge.start+1<<9,Tt&&Buffer.isBuffer(ge.content))ge.content.copy(K,K.l,0,ge.size),K.l+=ge.size+511&-512;else{for(me=0;me<ge.size;++me)K.write_shift(1,ge.content[me]);for(;me&511;++me)K.write_shift(1,0)}for(ee=1;ee<U.FileIndex.length;++ee)if(ge=U.FileIndex[ee],ge.size>0&&ge.size<4096)if(Tt&&Buffer.isBuffer(ge.content))ge.content.copy(K,K.l,0,ge.size),K.l+=ge.size+63&-64;else{for(me=0;me<ge.size;++me)K.write_shift(1,ge.content[me]);for(;me&63;++me)K.write_shift(1,0)}if(Tt)K.l=K.length;else for(;K.l<K.length;)K.write_shift(1,0);return K}function F(U,Z){var q=U.FullPaths.map(function(me){return me.toUpperCase()}),X=q.map(function(me){var xe=me.split("/");return xe[xe.length-(me.slice(-1)=="/"?2:1)]}),K=!1;Z.charCodeAt(0)===47?(K=!0,Z=q[0].slice(0,-1)+Z):K=Z.indexOf("/")!==-1;var ee=Z.toUpperCase(),de=K===!0?q.indexOf(ee):X.indexOf(ee);if(de!==-1)return U.FileIndex[de];var ke=!ee.match(Wf);for(ee=ee.replace(Zn,""),ke&&(ee=ee.replace(Wf,"!")),de=0;de<q.length;++de)if((ke?q[de].replace(Wf,"!"):q[de]).replace(Zn,"")==ee||(ke?X[de].replace(Wf,"!"):X[de]).replace(Zn,"")==ee)return U.FileIndex[de];return null}var j=64,P=-2,be="d0cf11e0a1b11ae1",ye=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:P,FREESECT:-1,HEADER_SIGNATURE:be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(U,Z,q){d();var X=M(U,q);f.writeFileSync(Z,X)}function te(U){for(var Z=new Array(U.length),q=0;q<U.length;++q)Z[q]=String.fromCharCode(U[q]);return Z.join("")}function _e(U,Z){var q=M(U,Z);switch(Z&&Z.type||"buffer"){case"file":return d(),f.writeFileSync(Z.filename,q),q;case"binary":return typeof q=="string"?q:te(q);case"base64":return y0(typeof q=="string"?q:te(q));case"buffer":if(Tt)return Buffer.isBuffer(q)?q:Bi(q);case"array":return typeof q=="string"?Aa(q):q}return q}var Q;function L(U){try{var Z=U.InflateRaw,q=new Z;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)Q=U;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function J(U,Z){if(!Q)return Js(U,Z);var q=Q.InflateRaw,X=new q,K=X._processChunk(U.slice(U.l),X._finishFlushFlag);return U.l+=X.bytesRead,K}function Y(U){return Q?Q.deflateRawSync(U):dt(U)}var ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Re(U){var Z=(U<<1|U<<11)&139536|(U<<5|U<<15)&558144;return(Z>>16|Z>>8|Z)&255}for(var Ae=typeof Uint8Array<"u",Fe=Ae?new Uint8Array(256):[],st=0;st<256;++st)Fe[st]=Re(st);function B(U,Z){var q=Fe[U&255];return Z<=8?q>>>8-Z:(q=q<<8|Fe[U>>8&255],Z<=16?q>>>16-Z:(q=q<<8|Fe[U>>16&255],q>>>24-Z))}function Xe(U,Z){var q=Z&7,X=Z>>>3;return(U[X]|(q<=6?0:U[X+1]<<8))>>>q&3}function Pe(U,Z){var q=Z&7,X=Z>>>3;return(U[X]|(q<=5?0:U[X+1]<<8))>>>q&7}function et(U,Z){var q=Z&7,X=Z>>>3;return(U[X]|(q<=4?0:U[X+1]<<8))>>>q&15}function We(U,Z){var q=Z&7,X=Z>>>3;return(U[X]|(q<=3?0:U[X+1]<<8))>>>q&31}function je(U,Z){var q=Z&7,X=Z>>>3;return(U[X]|(q<=1?0:U[X+1]<<8))>>>q&127}function ht(U,Z,q){var X=Z&7,K=Z>>>3,ee=(1<<q)-1,de=U[K]>>>X;return q<8-X||(de|=U[K+1]<<8-X,q<16-X)||(de|=U[K+2]<<16-X,q<24-X)||(de|=U[K+3]<<24-X),de&ee}function _t(U,Z,q){var X=Z&7,K=Z>>>3;return X<=5?U[K]|=(q&7)<<X:(U[K]|=q<<X&255,U[K+1]=(q&7)>>8-X),Z+3}function Ft(U,Z,q){var X=Z&7,K=Z>>>3;return q=(q&1)<<X,U[K]|=q,Z+1}function Hr(U,Z,q){var X=Z&7,K=Z>>>3;return q<<=X,U[K]|=q&255,q>>>=8,U[K+1]=q,Z+8}function ns(U,Z,q){var X=Z&7,K=Z>>>3;return q<<=X,U[K]|=q&255,q>>>=8,U[K+1]=q&255,U[K+2]=q>>>8,Z+16}function Gn(U,Z){var q=U.length,X=2*q>Z?2*q:Z+5,K=0;if(q>=Z)return U;if(Tt){var ee=NT(X);if(U.copy)U.copy(ee);else for(;K<U.length;++K)ee[K]=U[K];return ee}else if(Ae){var de=new Uint8Array(X);if(de.set)de.set(U);else for(;K<q;++K)de[K]=U[K];return de}return U.length=X,U}function zt(U){for(var Z=new Array(U),q=0;q<U;++q)Z[q]=0;return Z}function Gr(U,Z,q){var X=1,K=0,ee=0,de=0,ke=0,me=U.length,xe=Ae?new Uint16Array(32):zt(32);for(ee=0;ee<32;++ee)xe[ee]=0;for(ee=me;ee<q;++ee)U[ee]=0;me=U.length;var ge=Ae?new Uint16Array(me):zt(me);for(ee=0;ee<me;++ee)xe[K=U[ee]]++,X<K&&(X=K),ge[ee]=0;for(xe[0]=0,ee=1;ee<=X;++ee)xe[ee+16]=ke=ke+xe[ee-1]<<1;for(ee=0;ee<me;++ee)ke=U[ee],ke!=0&&(ge[ee]=xe[ke+16]++);var Be=0;for(ee=0;ee<me;++ee)if(Be=U[ee],Be!=0)for(ke=B(ge[ee],X)>>X-Be,de=(1<<X+4-Be)-1;de>=0;--de)Z[ke|de<<Be]=Be&15|ee<<4;return X}var nn=Ae?new Uint16Array(512):zt(512),qn=Ae?new Uint16Array(32):zt(32);if(!Ae){for(var Xt=0;Xt<512;++Xt)nn[Xt]=0;for(Xt=0;Xt<32;++Xt)qn[Xt]=0}(function(){for(var U=[],Z=0;Z<32;Z++)U.push(5);Gr(U,qn,32);var q=[];for(Z=0;Z<=143;Z++)q.push(8);for(;Z<=255;Z++)q.push(9);for(;Z<=279;Z++)q.push(7);for(;Z<=287;Z++)q.push(8);Gr(q,nn,288)})();var Or=(function(){for(var Z=Ae?new Uint8Array(32768):[],q=0,X=0;q<Te.length-1;++q)for(;X<Te[q+1];++X)Z[X]=q;for(;X<32768;++X)Z[X]=29;var K=Ae?new Uint8Array(259):[];for(q=0,X=0;q<ue.length-1;++q)for(;X<ue[q+1];++X)K[X]=q;function ee(ke,me){for(var xe=0;xe<ke.length;){var ge=Math.min(65535,ke.length-xe),Be=xe+ge==ke.length;for(me.write_shift(1,+Be),me.write_shift(2,ge),me.write_shift(2,~ge&65535);ge-- >0;)me[me.l++]=ke[xe++]}return me.l}function de(ke,me){for(var xe=0,ge=0,Be=Ae?new Uint16Array(32768):[];ge<ke.length;){var Ve=Math.min(65535,ke.length-ge);if(Ve<10){for(xe=_t(me,xe,+(ge+Ve==ke.length)),xe&7&&(xe+=8-(xe&7)),me.l=xe/8|0,me.write_shift(2,Ve),me.write_shift(2,~Ve&65535);Ve-- >0;)me[me.l++]=ke[ge++];xe=me.l*8;continue}xe=_t(me,xe,+(ge+Ve==ke.length)+2);for(var qe=0;Ve-- >0;){var Le=ke[ge];qe=(qe<<5^Le)&32767;var Ge=-1,Ze=0;if((Ge=Be[qe])&&(Ge|=ge&-32768,Ge>ge&&(Ge-=32768),Ge<ge))for(;ke[Ge+Ze]==ke[ge+Ze]&&Ze<250;)++Ze;if(Ze>2){Le=K[Ze],Le<=22?xe=Hr(me,xe,Fe[Le+1]>>1)-1:(Hr(me,xe,3),xe+=5,Hr(me,xe,Fe[Le-23]>>5),xe+=3);var Yt=Le<8?0:Le-4>>2;Yt>0&&(ns(me,xe,Ze-ue[Le]),xe+=Yt),Le=Z[ge-Ge],xe=Hr(me,xe,Fe[Le]>>3),xe-=3;var $t=Le<4?0:Le-2>>1;$t>0&&(ns(me,xe,ge-Ge-Te[Le]),xe+=$t);for(var cr=0;cr<Ze;++cr)Be[qe]=ge&32767,qe=(qe<<5^ke[ge])&32767,++ge;Ve-=Ze-1}else Le<=143?Le=Le+48:xe=Ft(me,xe,1),xe=Hr(me,xe,Fe[Le]),Be[qe]=ge&32767,++ge}xe=Hr(me,xe,0)-1}return me.l=(xe+7)/8|0,me.l}return function(me,xe){return me.length<8?ee(me,xe):de(me,xe)}})();function dt(U){var Z=Se(50+Math.floor(U.length*1.1)),q=Or(U,Z);return Z.slice(0,q)}var rr=Ae?new Uint16Array(32768):zt(32768),an=Ae?new Uint16Array(32768):zt(32768),Mt=Ae?new Uint16Array(128):zt(128),or=1,qr=1;function dr(U,Z){var q=We(U,Z)+257;Z+=5;var X=We(U,Z)+1;Z+=5;var K=et(U,Z)+4;Z+=4;for(var ee=0,de=Ae?new Uint8Array(19):zt(19),ke=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],me=1,xe=Ae?new Uint8Array(8):zt(8),ge=Ae?new Uint8Array(8):zt(8),Be=de.length,Ve=0;Ve<K;++Ve)de[ne[Ve]]=ee=Pe(U,Z),me<ee&&(me=ee),xe[ee]++,Z+=3;var qe=0;for(xe[0]=0,Ve=1;Ve<=me;++Ve)ge[Ve]=qe=qe+xe[Ve-1]<<1;for(Ve=0;Ve<Be;++Ve)(qe=de[Ve])!=0&&(ke[Ve]=ge[qe]++);var Le=0;for(Ve=0;Ve<Be;++Ve)if(Le=de[Ve],Le!=0){qe=Fe[ke[Ve]]>>8-Le;for(var Ge=(1<<7-Le)-1;Ge>=0;--Ge)Mt[qe|Ge<<Le]=Le&7|Ve<<3}var Ze=[];for(me=1;Ze.length<q+X;)switch(qe=Mt[je(U,Z)],Z+=qe&7,qe>>>=3){case 16:for(ee=3+Xe(U,Z),Z+=2,qe=Ze[Ze.length-1];ee-- >0;)Ze.push(qe);break;case 17:for(ee=3+Pe(U,Z),Z+=3;ee-- >0;)Ze.push(0);break;case 18:for(ee=11+je(U,Z),Z+=7;ee-- >0;)Ze.push(0);break;default:Ze.push(qe),me<qe&&(me=qe);break}var Yt=Ze.slice(0,q),$t=Ze.slice(q);for(Ve=q;Ve<286;++Ve)Yt[Ve]=0;for(Ve=X;Ve<30;++Ve)$t[Ve]=0;return or=Gr(Yt,rr,286),qr=Gr($t,an,30),Z}function uc(U,Z){if(U[0]==3&&!(U[1]&3))return[Xl(Z),2];for(var q=0,X=0,K=NT(Z||1<<18),ee=0,de=K.length>>>0,ke=0,me=0;(X&1)==0;){if(X=Pe(U,q),q+=3,X>>>1)X>>1==1?(ke=9,me=5):(q=dr(U,q),ke=or,me=qr);else{q&7&&(q+=8-(q&7));var xe=U[q>>>3]|U[(q>>>3)+1]<<8;if(q+=32,xe>0)for(!Z&&de<ee+xe&&(K=Gn(K,ee+xe),de=K.length);xe-- >0;)K[ee++]=U[q>>>3],q+=8;continue}for(;;){!Z&&de<ee+32767&&(K=Gn(K,ee+32767),de=K.length);var ge=ht(U,q,ke),Be=X>>>1==1?nn[ge]:rr[ge];if(q+=Be&15,Be>>>=4,(Be>>>8&255)===0)K[ee++]=Be;else{if(Be==256)break;Be-=257;var Ve=Be<8?0:Be-4>>2;Ve>5&&(Ve=0);var qe=ee+ue[Be];Ve>0&&(qe+=ht(U,q,Ve),q+=Ve),ge=ht(U,q,me),Be=X>>>1==1?qn[ge]:an[ge],q+=Be&15,Be>>>=4;var Le=Be<4?0:Be-2>>1,Ge=Te[Be];for(Le>0&&(Ge+=ht(U,q,Le),q+=Le),!Z&&de<qe&&(K=Gn(K,qe+100),de=K.length);ee<qe;)K[ee]=K[ee-Ge],++ee}}}return Z?[K,q+7>>>3]:[K.slice(0,ee),q+7>>>3]}function Js(U,Z){var q=U.slice(U.l||0),X=uc(q,Z);return U.l+=X[1],X[0]}function so(U,Z){if(U)typeof console<"u"&&console.error(Z);else throw new Error(Z)}function da(U,Z){var q=U;Sn(q,0);var X=[],K=[],ee={FileIndex:X,FullPaths:K};A(ee,{root:Z.root});for(var de=q.length-4;(q[de]!=80||q[de+1]!=75||q[de+2]!=5||q[de+3]!=6)&&de>=0;)--de;q.l=de+4,q.l+=4;var ke=q.read_shift(2);q.l+=6;var me=q.read_shift(4);for(q.l=me,de=0;de<ke;++de){q.l+=20;var xe=q.read_shift(4),ge=q.read_shift(4),Be=q.read_shift(2),Ve=q.read_shift(2),qe=q.read_shift(2);q.l+=8;var Le=q.read_shift(4),Ge=u(q.slice(q.l+Be,q.l+Be+Ve));q.l+=Be+Ve+qe;var Ze=q.l;q.l=Le+4,Zs(q,xe,ge,ee,Ge),q.l=Ze}return ee}function Zs(U,Z,q,X,K){U.l+=2;var ee=U.read_shift(2),de=U.read_shift(2),ke=o(U);if(ee&8257)throw new Error("Unsupported ZIP encryption");for(var me=U.read_shift(4),xe=U.read_shift(4),ge=U.read_shift(4),Be=U.read_shift(2),Ve=U.read_shift(2),qe="",Le=0;Le<Be;++Le)qe+=String.fromCharCode(U[U.l++]);if(Ve){var Ge=u(U.slice(U.l,U.l+Ve));(Ge[21589]||{}).mt&&(ke=Ge[21589].mt),((K||{})[21589]||{}).mt&&(ke=K[21589].mt)}U.l+=Ve;var Ze=U.slice(U.l,U.l+xe);switch(de){case 8:Ze=J(U,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Yt=!1;ee&8&&(me=U.read_shift(4),me==134695760&&(me=U.read_shift(4),Yt=!0),xe=U.read_shift(4),ge=U.read_shift(4)),xe!=Z&&so(Yt,"Bad compressed size: "+Z+" != "+xe),ge!=q&&so(Yt,"Bad uncompressed size: "+q+" != "+ge),ri(X,qe,Ze,{unsafe:!0,mt:ke})}function kr(U,Z){var q=Z||{},X=[],K=[],ee=Se(1),de=q.compression?8:0,ke=0,me=0,xe=0,ge=0,Be=0,Ve=U.FullPaths[0],qe=Ve,Le=U.FileIndex[0],Ge=[],Ze=0;for(me=1;me<U.FullPaths.length;++me)if(qe=U.FullPaths[me].slice(Ve.length),Le=U.FileIndex[me],!(!Le.size||!Le.content||qe=="Sh33tJ5")){var Yt=ge,$t=Se(qe.length);for(xe=0;xe<qe.length;++xe)$t.write_shift(1,qe.charCodeAt(xe)&127);$t=$t.slice(0,$t.l),Ge[Be]=k7.buf(Le.content,0);var cr=Le.content;de==8&&(cr=Y(cr)),ee=Se(30),ee.write_shift(4,67324752),ee.write_shift(2,20),ee.write_shift(2,ke),ee.write_shift(2,de),Le.mt?i(ee,Le.mt):ee.write_shift(4,0),ee.write_shift(-4,Ge[Be]),ee.write_shift(4,cr.length),ee.write_shift(4,Le.content.length),ee.write_shift(2,$t.length),ee.write_shift(2,0),ge+=ee.length,X.push(ee),ge+=$t.length,X.push($t),ge+=cr.length,X.push(cr),ee=Se(46),ee.write_shift(4,33639248),ee.write_shift(2,0),ee.write_shift(2,20),ee.write_shift(2,ke),ee.write_shift(2,de),ee.write_shift(4,0),ee.write_shift(-4,Ge[Be]),ee.write_shift(4,cr.length),ee.write_shift(4,Le.content.length),ee.write_shift(2,$t.length),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(4,0),ee.write_shift(4,Yt),Ze+=ee.l,K.push(ee),Ze+=$t.length,K.push($t),++Be}return ee=Se(22),ee.write_shift(4,101010256),ee.write_shift(2,0),ee.write_shift(2,0),ee.write_shift(2,Be),ee.write_shift(2,Be),ee.write_shift(4,Ze),ee.write_shift(4,ge),ee.write_shift(2,0),gn([gn(X),gn(K),ee])}var Wn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Da(U,Z){if(U.ctype)return U.ctype;var q=U.name||"",X=q.match(/\.([^\.]+)$/);return X&&Wn[X[1]]||Z&&(X=(q=Z).match(/[\.\\]([^\.\\])+$/),X&&Wn[X[1]])?Wn[X[1]]:"application/octet-stream"}function ma(U){for(var Z=y0(U),q=[],X=0;X<Z.length;X+=76)q.push(Z.slice(X,X+76));return q.join(`\r
`)+`\r
`}function Vu(U){var Z=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var ge=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});Z=Z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Z.charAt(0)==`
`&&(Z="=0D"+Z.slice(1)),Z=Z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],X=Z.split(`\r
`),K=0;K<X.length;++K){var ee=X[K];if(ee.length==0){q.push("");continue}for(var de=0;de<ee.length;){var ke=76,me=ee.slice(de,de+ke);me.charAt(ke-1)=="="?ke--:me.charAt(ke-2)=="="?ke-=2:me.charAt(ke-3)=="="&&(ke-=3),me=ee.slice(de,de+ke),de+=ke,de<ee.length&&(me+="="),q.push(me)}}return q.join(`\r
`)}function fc(U){for(var Z=[],q=0;q<U.length;++q){for(var X=U[q];q<=U.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+U[++q];Z.push(X)}for(var K=0;K<Z.length;++K)Z[K]=Z[K].replace(/[=][0-9A-Fa-f]{2}/g,function(ee){return String.fromCharCode(parseInt(ee.slice(1),16))});return Aa(Z.join(`\r
`))}function Oa(U,Z,q){for(var X="",K="",ee="",de,ke=0;ke<10;++ke){var me=Z[ke];if(!me||me.match(/^\s*$/))break;var xe=me.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":X=xe[2].trim();break;case"content-type":ee=xe[2].trim();break;case"content-transfer-encoding":K=xe[2].trim();break}}switch(++ke,K.toLowerCase()){case"base64":de=Aa(Ia(Z.slice(ke).join("")));break;case"quoted-printable":de=fc(Z.slice(ke));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+K)}var ge=ri(U,X.slice(q.length),de,{unsafe:!0});ee&&(ge.ctype=ee)}function ei(U,Z){if(te(U.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=Z&&Z.root||"",X=(Tt&&Buffer.isBuffer(U)?U.toString("binary"):te(U)).split(`\r
`),K=0,ee="";for(K=0;K<X.length;++K)if(ee=X[K],!!/^Content-Location:/i.test(ee)&&(ee=ee.slice(ee.indexOf("file")),q||(q=ee.slice(0,ee.lastIndexOf("/")+1)),ee.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),ee.slice(0,q.length)!=q););var de=(X[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var ke="--"+(de[1]||""),me=[],xe=[],ge={FileIndex:me,FullPaths:xe};A(ge);var Be,Ve=0;for(K=0;K<X.length;++K){var qe=X[K];qe!==ke&&qe!==ke+"--"||(Ve++&&Oa(ge,X.slice(Be,K),q),Be=K)}return ge}function Uu(U,Z){var q=Z||{},X=q.boundary||"SheetJS";X="------="+X;for(var K=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],ee=U.FullPaths[0],de=ee,ke=U.FileIndex[0],me=1;me<U.FullPaths.length;++me)if(de=U.FullPaths[me].slice(ee.length),ke=U.FileIndex[me],!(!ke.size||!ke.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ze){return"_x"+Ze.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ze){return"_u"+Ze.charCodeAt(0).toString(16)+"_"});for(var xe=ke.content,ge=Tt&&Buffer.isBuffer(xe)?xe.toString("binary"):te(xe),Be=0,Ve=Math.min(1024,ge.length),qe=0,Le=0;Le<=Ve;++Le)(qe=ge.charCodeAt(Le))>=32&&qe<128&&++Be;var Ge=Be>=Ve*4/5;K.push(X),K.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+de),K.push("Content-Transfer-Encoding: "+(Ge?"quoted-printable":"base64")),K.push("Content-Type: "+Da(ke,de)),K.push(""),K.push(Ge?Vu(ge):ma(ge))}return K.push(X+`--\r
`),K.join(`\r
`)}function ti(U){var Z={};return A(Z,U),Z}function ri(U,Z,q,X){var K=X&&X.unsafe;K||A(U);var ee=!K&&nt.find(U,Z);if(!ee){var de=U.FullPaths[0];Z.slice(0,de.length)==de?de=Z:(de.slice(-1)!="/"&&(de+="/"),de=(de+Z).replace("//","/")),ee={name:a(Z),type:2},U.FileIndex.push(ee),U.FullPaths.push(de),K||nt.utils.cfb_gc(U)}return ee.content=q,ee.size=q?q.length:0,X&&(X.CLSID&&(ee.clsid=X.CLSID),X.mt&&(ee.mt=X.mt),X.ct&&(ee.ct=X.ct)),ee}function io(U,Z){A(U);var q=nt.find(U,Z);if(q){for(var X=0;X<U.FileIndex.length;++X)if(U.FileIndex[X]==q)return U.FileIndex.splice(X,1),U.FullPaths.splice(X,1),!0}return!1}function ni(U,Z,q){A(U);var X=nt.find(U,Z);if(X){for(var K=0;K<U.FileIndex.length;++K)if(U.FileIndex[K]==X)return U.FileIndex[K].name=a(q),U.FullPaths[K]=q,!0}return!1}function as(U){N(U,!0)}return e.find=F,e.read=H,e.parse=m,e.write=_e,e.writeFile=le,e.utils={cfb_new:ti,cfb_add:ri,cfb_del:io,cfb_mov:ni,cfb_gc:as,ReadShift:e0,CheckField:LC,prep_blob:Sn,bconcat:gn,use_zlib:L,_deflateRaw:dt,_inflateRaw:Js,consts:ce},e})();function C7(t){return typeof t=="string"?Ep(t):Array.isArray(t)?e7(t):t}function Z0(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Ep(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Vs(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([C7(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=ro(e)),u.write(e),u.close(),e}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+t)}function N7(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Dr(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function jT(t,e){for(var r=[],n=Dr(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function Sp(t){for(var e=[],r=Dr(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Ap(t){for(var e=[],r=Dr(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function R7(t){for(var e=[],r=Dr(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Pm=new Date(1899,11,30,0,0,0);function un(t,e){var r=t.getTime(),n=Pm.getTime()+(t.getTimezoneOffset()-Pm.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var xC=new Date,I7=Pm.getTime()+(xC.getTimezoneOffset()-Pm.getTimezoneOffset())*6e4,LT=xC.getTimezoneOffset();function kp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+I7),e.getTimezoneOffset()!==LT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-LT)*6e4),e}function D7(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[i],10)}return e}var BT=new Date("2017-02-19T19:06:09.000Z"),vC=isNaN(BT.getFullYear())?new Date("2/19/17"):BT,O7=vC.getFullYear()==2017;function vr(t,e){var r=new Date(t);if(O7)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(vC.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function $o(t,e){if(Tt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Vs(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Vs(sC(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Vs(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Vs(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function yr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=yr(t[r]));return e}function Rr(t,e){for(var r="";r.length<e;)r+=t;return r}function ws(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var F7=["january","february","march","april","may","june","july","august","september","october","november","december"];function Eu(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&F7.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var M7=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),o=[i[0]],u=1;u<i.length;++u)o.push(a),o.push(i[u]);return o}})();function yC(t){return t?t.content&&t.type?$o(t.content,!0):t.data?qf(t.data):t.asNodeBuffer&&Tt?qf(t.asNodeBuffer().toString("binary")):t.asBinary?qf(t.asBinary()):t._data&&t._data.getContent?qf($o(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function _C(t){if(!t)return null;if(t.data)return kT(t.data);if(t.asNodeBuffer&&Tt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?kT(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function P7(t){return t&&t.name.slice(-4)===".bin"?_C(t):yC(t)}function $a(t,e){for(var r=t.FullPaths||Dr(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var o=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function wy(t,e){var r=$a(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Zr(t,e,r){if(!r)return P7(wy(t,e));if(!e)return null;try{return Zr(t,e)}catch{return null}}function ka(t,e,r){if(!r)return yC(wy(t,e));if(!e)return null;try{return ka(t,e)}catch{return null}}function j7(t,e,r){return _C(wy(t,e))}function VT(t){for(var e=t.FullPaths||Dr(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function bt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Tt?n=Bi(r):n=t7(r),nt.utils.cfb_add(t,e,n)}nt.utils.cfb_add(t,e,r)}else t.file(e,r)}function by(){return nt.utils.cfb_new()}function wC(t,e){switch(e.type){case"base64":return nt.read(t,{type:"base64"});case"binary":return nt.read(t,{type:"binary"});case"buffer":case"array":return nt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Xf(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var zr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,L7=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,UT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,B7=/<[^>]*>/g,Hn=zr.match(UT)?UT:B7,V7=/<\w*:/,U7=/<(\/?)\w+:/;function ut(t,e,r){for(var n={},a=0,i=0;a!==t.length&&!((i=t.charCodeAt(a))===32||i===10||i===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var o=t.match(L7),u=0,f="",d=0,m="",x="",y=1;if(o)for(d=0;d!=o.length;++d){for(x=o[d],i=0;i!=x.length&&x.charCodeAt(i)!==61;++i);for(m=x.slice(0,i).trim();x.charCodeAt(i+1)==32;)++i;for(y=(a=x.charCodeAt(i+1))==34||a==39?1:0,f=x.slice(i+1+y,x.length-y),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=f,n[m.toLowerCase()]=f;else{var w=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(n[w]&&m.slice(u-3,u)=="ext")continue;n[w]=f,n[w.toLowerCase()]=f}}return n}function Ks(t){return t.replace(U7,"<$1")}var bC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ey=Sp(bC),jt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(t,function(u,f){return bC[u]||String.fromCharCode(parseInt(f,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,f){return String.fromCharCode(parseInt(f,16))});var o=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,o)+r(a.slice(o+3))}})(),Ty=/[&<>'"]/g,z7=/[\u0000-\u0008\u000b-\u001f]/g;function tr(t){var e=t+"";return e.replace(Ty,function(r){return Ey[r]}).replace(z7,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function zT(t){return tr(t).replace(/ /g,"_x0020_")}var EC=/[\u0000-\u001f]/g;function Sy(t){var e=t+"";return e.replace(Ty,function(r){return Ey[r]}).replace(/\n/g,"<br/>").replace(EC,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function H7(t){var e=t+"";return e.replace(Ty,function(r){return Ey[r]}).replace(EC,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var HT=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function G7(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function gr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Q1(t){for(var e="",r=0,n=0,a=0,i=0,o=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,e+=String.fromCharCode(o);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}o=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function GT(t){var e=Xl(2*t.length),r,n,a=1,i=0,o=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[i++]=o&255,e[i++]=o>>>8,o=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function qT(t){return Bi(t,"binary").toString("utf8")}var jd="foo bar baz",lr=Tt&&(qT(jd)==Q1(jd)&&qT||GT(jd)==Q1(jd)&&GT)||Q1,Vs=Tt?function(t){return Bi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},w0=(function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),TC=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}})(),q7=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),W7=/<\/?(?:vt:)?variant>/g,X7=/<(?:vt:)([^>]*)>([\s\S]*)</;function WT(t,e){var r=ut(t),n=t.match(q7(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var o=i.replace(W7,"").match(X7);o&&a.push({v:lr(o[2]),t:o[1]})}),a}var SC=/(^\s|\s$|\n)/;function kn(t,e){return"<"+t+(e.match(SC)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function b0(t){return Dr(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ue(t,e,r){return"<"+t+(r!=null?b0(r):"")+(e!=null?(e.match(SC)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Xx(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Y7(t,e){switch(typeof t){case"string":var r=Ue("vt:lpwstr",tr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ue((t|0)==t?"vt:i4":"vt:r8",tr(String(t)));case"boolean":return Ue("vt:bool",t?"true":"false")}if(t instanceof Date)return Ue("vt:filetime",Xx(t));throw new Error("Unable to serialize "+t)}function Ay(t){if(Tt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return lr(ro(vy(t)));throw new Error("Bad input format: expected Buffer or string")}var E0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ln={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ac=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ta={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function $7(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,i=5;i>=0;--i)a=a*256+t[e+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function K7(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,i=0,o=n?-e:e;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(e)?26985:0);for(var u=0;u<=5;++u,i/=256)t[r+u]=i&255;t[r+6]=(a&15)<<4|i&15,t[r+7]=a>>4|n}var XT=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,i=t[0][n].length;a<i;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},YT=Tt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Bi(e)})):XT(t)}:XT,$T=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(Si(t,a)));return n.join("").replace(Zn,"")},ky=Tt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Zn,""):$T(t,e,r)}:$T,KT=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},AC=Tt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):KT(t,e,r)}:KT,QT=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode(ru(t,a)));return n.join("")},eh=Tt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):QT(e,r,n)}:QT,kC=function(t,e){var r=Sa(t,e);return r>0?eh(t,e+4,e+4+r-1):""},CC=kC,NC=function(t,e){var r=Sa(t,e);return r>0?eh(t,e+4,e+4+r-1):""},RC=NC,IC=function(t,e){var r=2*Sa(t,e);return r>0?eh(t,e+4,e+4+r-1):""},DC=IC,OC=function(e,r){var n=Sa(e,r);return n>0?ky(e,r+4,r+4+n):""},FC=OC,MC=function(t,e){var r=Sa(t,e);return r>0?eh(t,e+4,e+4+r):""},PC=MC,jC=function(t,e){return $7(t,e)},jm=jC,Cy=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Tt&&(CC=function(e,r){if(!Buffer.isBuffer(e))return kC(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},RC=function(e,r){if(!Buffer.isBuffer(e))return NC(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},DC=function(e,r){if(!Buffer.isBuffer(e))return IC(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},FC=function(e,r){if(!Buffer.isBuffer(e))return OC(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},PC=function(e,r){if(!Buffer.isBuffer(e))return MC(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},jm=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):jC(e,r)},Cy=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var ru=function(t,e){return t[e]},Si=function(t,e){return t[e+1]*256+t[e]},Q7=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Sa=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Oo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},J7=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function e0(t,e){var r="",n,a,i=[],o,u,f,d;switch(e){case"dbcs":if(d=this.l,Tt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(f=0;f<t;++f)r+=String.fromCharCode(Si(this,d)),d+=2;t*=2;break;case"utf8":r=eh(this,this.l,this.l+t);break;case"utf16le":t*=2,r=ky(this,this.l,this.l+t);break;case"wstr":return e0.call(this,t,"dbcs");case"lpstr-ansi":r=CC(this,this.l),t=4+Sa(this,this.l);break;case"lpstr-cp":r=RC(this,this.l),t=4+Sa(this,this.l);break;case"lpwstr":r=DC(this,this.l),t=4+2*Sa(this,this.l);break;case"lpp4":t=4+Sa(this,this.l),r=FC(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Sa(this,this.l),r=PC(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=ru(this,this.l+t++))!==0;)i.push(Pd(o));r=i.join("");break;case"_wstr":for(t=0,r="";(o=Si(this,this.l+t))!==0;)i.push(Pd(o)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=ru(this,d),this.l=d+1,u=e0.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Pd(Si(this,d))),d+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=t;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return o=ru(this,d),this.l=d+1,u=e0.call(this,t-f,o?"dbcs-cont":"sbcs-cont"),i.join("")+u;i.push(Pd(ru(this,d))),d+=1}r=i.join("");break;default:switch(t){case 1:return n=ru(this,this.l),this.l++,n;case 2:return n=(e==="i"?Q7:Si)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Oo:J7)(this,this.l),this.l+=4,n):(a=Sa(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=jm(this,this.l):a=jm([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=AC(this,this.l,t);break}}return this.l+=t,r}var Z7=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},eB=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},tB=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function rB(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)tB(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var o=e.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Z7(this,e,this.l);break;case 8:if(n=8,r==="f"){K7(this,e,this.l);break}case 16:break;case-4:n=4,eB(this,e,this.l);break}return this.l+=n,this}function LC(t,e){var r=AC(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Sn(t,e){t.l=e,t.read_shift=e0,t.chk=LC,t.write_shift=rB}function zn(t,e){t.l+=e}function Se(t){var e=Xl(t);return Sn(e,0),e}function Vi(t,e,r){if(t){var n,a,i;Sn(t,t.l||0);for(var o=t.length,u=0,f=0;t.l<o;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=N0[u]||N0[65535];for(n=t.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=t.read_shift(1))&127)<<7*a;f=t.l+i;var m=d.f&&d.f(t,i,r);if(t.l=f,e(m,d,u))return}}}function fa(){var t=[],e=Tt?256:2048,r=function(d){var m=Se(d);return Sn(m,0),m},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,e)))},o=function(){return a(),gn(t)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:u,end:o,_bufs:t}}function Me(t,e,r,n){var a=+e,i;if(!isNaN(a)){n||(n=N0[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var o=t.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Cy(r)&&t.push(r)}}function t0(t,e,r){var n=yr(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function JT(t,e,r){var n=yr(t);return n.s=t0(n.s,e.s,r),n.e=t0(n.e,e.s,r),n}function r0(t,e){if(t.cRel&&t.c<0)for(t=yr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=yr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ot(t);return!t.cRel&&t.cRel!=null&&(r=sB(r)),!t.rRel&&t.rRel!=null&&(r=nB(r)),r}function J1(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Tr(t.s.c)+":"+(t.e.cRel?"":"$")+Tr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ur(t.s.r)+":"+(t.e.rRel?"":"$")+Ur(t.e.r):r0(t.s,e.biff)+":"+r0(t.e,e.biff)}function Ny(t){return parseInt(aB(t),10)-1}function Ur(t){return""+(t+1)}function nB(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function aB(t){return t.replace(/\$(\d+)$/,"$1")}function Ry(t){for(var e=iB(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Tr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function sB(t){return t.replace(/^([A-Z])/,"$$$1")}function iB(t){return t.replace(/^\$([A-Z])/,"$1")}function lB(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Sr(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function ot(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ha(t){var e=t.indexOf(":");return e==-1?{s:Sr(t),e:Sr(t)}:{s:Sr(t.slice(0,e)),e:Sr(t.slice(e+1))}}function yt(t,e){return typeof e>"u"||typeof e=="number"?yt(t.s,t.e):(typeof t!="string"&&(t=ot(t)),typeof e!="string"&&(e=ot(e)),t==e?t:t+":"+e)}function Lt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=t.length;for(r=0;n<i&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<i&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===i||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=i&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function ZT(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=es(t.z,r?un(e):e)}catch{}try{return t.w=es((t.XF||{}).numFmtId||(r?14:0),r?un(e):e)}catch{return""+e}}function ji(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ui[t.v]||t.v:e==null?ZT(t,t.v):ZT(t,e))}function no(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function BC(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,i=t||(a?[]:{}),o=0,u=0;if(i&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?Sr(n.origin):n.origin;o=f.r,u=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var m=Lt(i["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),o==-1&&(d.e.r=o=m.e.r+1)}for(var x=0;x!=e.length;++x)if(e[x]){if(!Array.isArray(e[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=e[x].length;++y)if(!(typeof e[x][y]>"u")){var w={v:e[x][y]},E=o+x,b=u+y;if(d.s.r>E&&(d.s.r=E),d.s.c>b&&(d.s.c=b),d.e.r<E&&(d.e.r=E),d.e.c<b&&(d.e.c=b),e[x][y]&&typeof e[x][y]=="object"&&!Array.isArray(e[x][y])&&!(e[x][y]instanceof Date))w=e[x][y];else if(Array.isArray(w.v)&&(w.f=e[x][y][1],w.v=w.v[0]),w.v===null)if(w.f)w.t="n";else if(n.nullError)w.t="e",w.v=0;else if(n.sheetStubs)w.t="z";else continue;else typeof w.v=="number"?w.t="n":typeof w.v=="boolean"?w.t="b":w.v instanceof Date?(w.z=n.dateNF||lt[14],n.cellDates?(w.t="d",w.w=es(w.z,un(w.v))):(w.t="n",w.v=un(w.v),w.w=es(w.z,w.v))):w.t="s";if(a)i[E]||(i[E]=[]),i[E][b]&&i[E][b].z&&(w.z=i[E][b].z),i[E][b]=w;else{var T=ot({c:b,r:E});i[T]&&i[T].z&&(w.z=i[T].z),i[T]=w}}}return d.s.c<1e7&&(i["!ref"]=yt(d)),i}function Lu(t,e){return BC(null,t,e)}function oB(t){return t.read_shift(4,"i")}function bs(t,e){return e||(e=Se(4)),e.write_shift(4,t),e}function Vn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function xn(t,e){var r=!1;return e==null&&(r=!0,e=Se(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function cB(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function uB(t,e){return e||(e=Se(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Iy(t,e){var r=t.l,n=t.read_shift(1),a=Vn(t),i=[],o={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),f=0;f!=u;++f)i.push(cB(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function fB(t,e){var r=!1;return e==null&&(r=!0,e=Se(15+4*t.t.length)),e.write_shift(1,0),xn(t.t,e),r?e.slice(0,e.l):e}var hB=Iy;function dB(t,e){var r=!1;return e==null&&(r=!0,e=Se(23+4*t.t.length)),e.write_shift(1,1),xn(t.t,e),e.write_shift(4,1),uB({},e),r?e.slice(0,e.l):e}function rs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function sc(t,e){return e==null&&(e=Se(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function ic(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function lc(t,e){return e==null&&(e=Se(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var mB=Vn,VC=xn;function Dy(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Lm(t,e){var r=!1;return e==null&&(r=!0,e=Se(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var pB=Vn,Yx=Dy,Oy=Lm;function Fy(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?jm([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Oo(e,0)>>2;return r?a/100:a}function UC(t,e){e==null&&(e=Se(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function zC(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function gB(t,e){return e||(e=Se(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var oc=zC,Bu=gB;function Bn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Ko(t,e){return(e||Se(8)).write_shift(8,t,"f")}function xB(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),u=t.read_shift(1),f=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=Bo[a];d&&(e.rgb=S0(d));break;case 2:e.rgb=S0([o,u,f]);break;case 3:e.theme=a;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function Bm(t,e){if(e||(e=Se(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function vB(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function yB(t,e){e||(e=Se(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function HC(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function _B(t){return HC(t,1)}function wB(t){return HC(t,2)}var My=2,la=3,Ld=11,eS=12,Vm=19,Bd=64,bB=65,EB=71,TB=4108,SB=4126,mn=80,GC=81,AB=[mn,GC],$x={1:{n:"CodePage",t:My},2:{n:"Category",t:mn},3:{n:"PresentationFormat",t:mn},4:{n:"ByteCount",t:la},5:{n:"LineCount",t:la},6:{n:"ParagraphCount",t:la},7:{n:"SlideCount",t:la},8:{n:"NoteCount",t:la},9:{n:"HiddenCount",t:la},10:{n:"MultimediaClipCount",t:la},11:{n:"ScaleCrop",t:Ld},12:{n:"HeadingPairs",t:TB},13:{n:"TitlesOfParts",t:SB},14:{n:"Manager",t:mn},15:{n:"Company",t:mn},16:{n:"LinksUpToDate",t:Ld},17:{n:"CharacterCount",t:la},19:{n:"SharedDoc",t:Ld},22:{n:"HyperlinksChanged",t:Ld},23:{n:"AppVersion",t:la,p:"version"},24:{n:"DigSig",t:bB},26:{n:"ContentType",t:mn},27:{n:"ContentStatus",t:mn},28:{n:"Language",t:mn},29:{n:"Version",t:mn},255:{},2147483648:{n:"Locale",t:Vm},2147483651:{n:"Behavior",t:Vm},1919054434:{}},Kx={1:{n:"CodePage",t:My},2:{n:"Title",t:mn},3:{n:"Subject",t:mn},4:{n:"Author",t:mn},5:{n:"Keywords",t:mn},6:{n:"Comments",t:mn},7:{n:"Template",t:mn},8:{n:"LastAuthor",t:mn},9:{n:"RevNumber",t:mn},10:{n:"EditTime",t:Bd},11:{n:"LastPrinted",t:Bd},12:{n:"CreatedDate",t:Bd},13:{n:"ModifiedDate",t:Bd},14:{n:"PageCount",t:la},15:{n:"WordCount",t:la},16:{n:"CharCount",t:la},17:{n:"Thumbnail",t:EB},18:{n:"Application",t:mn},19:{n:"DocSecurity",t:la},255:{},2147483648:{n:"Locale",t:Vm},2147483651:{n:"Behavior",t:Vm},1919054434:{}},tS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},kB=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function CB(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var NB=CB([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Bo=yr(NB),Ui={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Qx={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Vd={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Py(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function RB(t){var e=Py();if(!t||!t.match)return e;var r={};if((t.match(Hn)||[]).forEach(function(n){var a=ut(n);switch(a[0].replace(V7,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[Qx[a.ContentType]]!==void 0&&e[Qx[a.ContentType]].push(a.PartName);break}}),e.xmlns!==ln.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function WC(t,e){var r=R7(Qx),n=[],a;n[n.length]=zr,n[n.length]=Ue("Types",null,{xmlns:ln.CT,"xmlns:xsd":ln.xsd,"xmlns:xsi":ln.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Ue("Default",null,{Extension:f[0],ContentType:f[1]})}));var i=function(f){t[f]&&t[f].length>0&&(a=t[f][0],n[n.length]=Ue("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Vd[f][e.bookType]||Vd[f].xlsx}))},o=function(f){(t[f]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Vd[f][e.bookType]||Vd[f].xlsx})})},u=function(f){(t[f]||[]).forEach(function(d){n[n.length]=Ue("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return i("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var St={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function T0(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function n0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Hn)||[]).forEach(function(a){var i=ut(a);if(i[0]==="<Relationship"){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var u=i.TargetMode==="External"?i.Target:Xf(i.Target,e);r[u]=o,n[i.Id]=o}}),r["!id"]=n,r}function uu(t){var e=[zr,Ue("Relationships",null,{xmlns:ln.RELS})];return Dr(t["!id"]).forEach(function(r){e[e.length]=Ue("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function er(t,e,r,n,a,i){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[St.HLINK,St.XPATH,St.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var IB="application/vnd.oasis.opendocument.spreadsheet";function DB(t,e){for(var r=Ay(t),n,a;n=E0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ut(n[0],!1),a.path=="/"&&a.type!==IB)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function OB(t){var e=[zr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function rS(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function FB(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function MB(t){var e=[zr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(rS(t[r][0],t[r][1])),e.push(FB("",t[r][0]));return e.push(rS("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function XC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Dm.version+"</meta:generator></office:meta></office:document-meta>"}var Za=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],PB=(function(){for(var t=new Array(Za.length),e=0;e<Za.length;++e){var r=Za[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function YC(t){var e={};t=lr(t);for(var r=0;r<Za.length;++r){var n=Za[r],a=t.match(PB[r]);a!=null&&a.length>0&&(e[n[1]]=jt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=vr(e[n[1]]))}return e}function Z1(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=tr(e),n[n.length]=r?Ue(t,e,r):kn(t,e))}function $C(t,e){var r=e||{},n=[zr,Ue("cp:coreProperties",null,{"xmlns:cp":ln.CORE_PROPS,"xmlns:dc":ln.dc,"xmlns:dcterms":ln.dcterms,"xmlns:dcmitype":ln.dcmitype,"xmlns:xsi":ln.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Z1("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Xx(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&Z1("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Xx(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Za.length;++i){var o=Za[i],u=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Z1(o[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Vo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],KC=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function QC(t,e,r,n){var a=[];if(typeof t=="string")a=WT(t,n);else for(var i=0;i<t.length;++i)a=a.concat(t[i].map(function(m){return{v:m}}));var o=typeof e=="string"?WT(e,n).map(function(m){return m.v}):e,u=0,f=0;if(o.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=o.slice(u,u+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=o.slice(u,u+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=o.slice(u,u+f);break}u+=f}}function jB(t,e,r){var n={};return e||(e={}),t=lr(t),Vo.forEach(function(a){var i=(t.match(w0(a[0]))||[])[1];switch(a[2]){case"string":i&&(e[a[1]]=jt(i));break;case"bool":e[a[1]]=i==="true";break;case"raw":var o=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&QC(n.HeadingPairs,n.TitlesOfParts,e,r),e}function JC(t){var e=[],r=Ue;return t||(t={}),t.Application="SheetJS",e[e.length]=zr,e[e.length]=Ue("Properties",null,{xmlns:ln.EXT_PROPS,"xmlns:vt":ln.vt}),Vo.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=tr(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+tr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var LB=/<[^>]+>[^<]*/g;function BB(t,e){var r={},n="",a=t.match(LB);if(a)for(var i=0;i!=a.length;++i){var o=a[i],u=ut(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=jt(u.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var f=o.split(">"),d=f[0].slice(4),m=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=jt(m);break;case"bool":r[n]=gr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(m);break;case"filetime":case"date":r[n]=vr(m);break;case"cy":case"error":r[n]=jt(m);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,d,f)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function ZC(t){var e=[zr,Ue("Properties",null,{xmlns:ln.CUST_PROPS,"xmlns:vt":ln.vt})];if(!t)return e.join("");var r=1;return Dr(t).forEach(function(a){++r,e[e.length]=Ue("property",Y7(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:tr(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Jx={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ex;function VB(t,e,r){ex||(ex=Sp(Jx)),e=ex[e]||e,t[e]=r}function UB(t,e){var r=[];return Dr(Jx).map(function(n){for(var a=0;a<Za.length;++a)if(Za[a][1]==n)return Za[a];for(a=0;a<Vo.length;++a)if(Vo[a][1]==n)return Vo[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(kn(Jx[n[1]]||n[1],a))}}),Ue("DocumentProperties",r.join(""),{xmlns:Ta.o})}function zB(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Dr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<Za.length;++o)if(i==Za[o][1])return;for(o=0;o<Vo.length;++o)if(i==Vo[o][1])return;for(o=0;o<r.length;++o)if(i==r[o])return;var u=t[i],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u=String(u),a.push(Ue(zT(i),u,{"dt:dt":f}))}}),e&&Dr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=e[i],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Ue(zT(i),o,{"dt:dt":u}))}}),"<"+n+' xmlns="'+Ta.o+'">'+a.join("")+"</"+n+">"}function jy(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function HB(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var o=Se(8);return o.write_shift(4,n),o.write_shift(4,a),o}function eN(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function tN(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function rN(t,e,r){return e===31?tN(t):eN(t,e,r)}function Zx(t,e,r){return rN(t,e,r===!1?0:4)}function GB(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return rN(t,e,0)}function qB(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Zn,""),t.l-a&2&&(t.l+=2)}return r}function WB(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Zn,"");return r}function XB(t){var e=t.l,r=Um(t,GC);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Um(t,la);return[r,n]}function YB(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(XB(t));return r}function nS(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var i=t.read_shift(4),o=t.read_shift(4);n[i]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(Zn,"").replace(Wf,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function nN(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function $B(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Um(t,e,r){var n=t.read_shift(2),a,i=r||{};if(t.l+=2,e!==eS&&n!==e&&AB.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===eS?n:e){case 2:return a=t.read_shift(2,"i"),i.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return eN(t,n,4).replace(Zn,"");case 31:return tN(t);case 64:return jy(t);case 65:return nN(t);case 71:return $B(t);case 80:return Zx(t,n,!i.raw).replace(Zn,"");case 81:return GB(t,n).replace(Zn,"");case 4108:return YB(t);case 4126:case 4127:return n==4127?qB(t):WB(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function aS(t,e){var r=Se(4),n=Se(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Se(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=HB(e);break;case 31:case 80:for(n=Se(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return gn([r,n])}function sS(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),i=[],o=0,u=0,f=-1,d={};for(o=0;o!=a;++o){var m=t.read_shift(4),x=t.read_shift(4);i[o]=[m,x+r]}i.sort(function(R,C){return R[1]-C[1]});var y={};for(o=0;o!=a;++o){if(t.l!==i[o][1]){var w=!0;if(o>0&&e)switch(e[i[o-1][0]].t){case 2:t.l+2===i[o][1]&&(t.l+=2,w=!1);break;case 80:t.l<=i[o][1]&&(t.l=i[o][1],w=!1);break;case 4108:t.l<=i[o][1]&&(t.l=i[o][1],w=!1);break}if((!e||o==0)&&t.l<=i[o][1]&&(w=!1,t.l=i[o][1]),w)throw new Error("Read Error: Expected address "+i[o][1]+" at "+t.l+" :"+o)}if(e){var E=e[i[o][0]];if(y[E.n]=Um(t,E.t,{raw:!0}),E.p==="version"&&(y[E.n]=String(y[E.n]>>16)+"."+("0000"+String(y[E.n]&65535)).slice(-4)),E.n=="CodePage")switch(y[E.n]){case 0:y[E.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ys(u=y[E.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[E.n])}}else if(i[o][0]===1){if(u=y.CodePage=Um(t,My),ys(u),f!==-1){var b=t.l;t.l=i[f][1],d=nS(t,u),t.l=b}}else if(i[o][0]===0){if(u===0){f=o,t.l=i[o+1][1];continue}d=nS(t,u)}else{var T=d[i[o][0]],I;switch(t[t.l]){case 65:t.l+=4,I=nN(t);break;case 30:t.l+=4,I=Zx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,I=Zx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,I=t.read_shift(4,"i");break;case 19:t.l+=4,I=t.read_shift(4);break;case 5:t.l+=4,I=t.read_shift(8,"f");break;case 11:t.l+=4,I=jr(t,4);break;case 64:t.l+=4,I=vr(jy(t));break;default:throw new Error("unparsed value: "+t[t.l])}y[T]=I}}return t.l=r+n,y}var aN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function KB(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function iS(t,e,r){var n=Se(8),a=[],i=[],o=8,u=0,f=Se(8),d=Se(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),i.push(f),a.push(d),o+=8+f.length,!e){d=Se(8),d.write_shift(4,0),a.unshift(d);var m=[Se(4)];for(m[0].write_shift(4,t.length),u=0;u<t.length;++u){var x=t[u][0];for(f=Se(8+2*(x.length+1)+(x.length%2?0:2)),f.write_shift(4,u+2),f.write_shift(4,x.length+1),f.write_shift(0,x,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=gn(m),i.unshift(f),o+=8+f.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(aN.indexOf(t[u][0])>-1||KC.indexOf(t[u][0])>-1)&&t[u][1]!=null){var y=t[u][1],w=0;if(e){w=+e[t[u][0]];var E=r[w];if(E.p=="version"&&typeof y=="string"){var b=y.split(".");y=(+b[0]<<16)+(+b[1]||0)}f=aS(E.t,y)}else{var T=KB(y);T==-1&&(T=31,y=String(y)),f=aS(T,y)}i.push(f),d=Se(8),d.write_shift(4,e?w:2+u),a.push(d),o+=8+f.length}var I=8*(i.length+1);for(u=0;u<i.length;++u)a[u].write_shift(4,I),I+=i[u].length;return n.write_shift(4,o),n.write_shift(4,i.length),gn([n].concat(a).concat(i))}function lS(t,e,r){var n=t.content;if(!n)return{};Sn(n,0);var a,i,o,u,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),m=n.read_shift(16);if(m!==nt.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(o=n.read_shift(16),f=n.read_shift(4));var x=sS(n,e),y={SystemIdentifier:d};for(var w in x)y[w]=x[w];if(y.FMTID=i,a===1)return y;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var E;try{E=sS(n,null)}catch{}for(w in E)y[w]=E[w];return y.FMTID=[i,o],y}function oS(t,e,r,n,a,i){var o=Se(a?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,nt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,a?68:48);var f=iS(t,r,n);if(u.push(f),a){var d=iS(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+f.length),u.push(d)}return gn(u)}function wl(t,e){return t.read_shift(e),null}function QB(t,e){e||(e=Se(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function JB(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function jr(t,e){return t.read_shift(e)===1}function Qn(t,e){return e||(e=Se(2)),e.write_shift(2,+!!t),e}function en(t){return t.read_shift(2,"u")}function Ka(t,e){return e||(e=Se(2)),e.write_shift(2,t),e}function sN(t,e){return JB(t,e,en)}function ZB(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function iN(t,e,r){return r||(r=Se(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function th(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?t.read_shift(n,a):"";return o}function eV(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,i=1+(r&1),o=0,u,f={};a&&(o=t.read_shift(2)),n&&(u=t.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",m=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*o),n&&(t.l+=u),f.t=m,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function tV(t){var e=t.t||"",r=Se(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Se(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return gn(a)}function Qo(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function rh(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Qo(t,n,r)}function cc(t,e,r){if(r.biff>5)return rh(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function lN(t,e,r){return r||(r=Se(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function rV(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function nV(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Zn,"");return n&&(t.l+=24),a}function aV(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(i>>1,"utf16le").replace(Zn,"");return r+o}function sV(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return nV(t);case"0303000000000000c000000000000046":return aV(t);default:throw new Error("Unsupported Moniker "+r)}}function Ud(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Zn,""):"";return r}function cS(t,e){e||(e=Se(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function iV(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var i,o,u,f,d="",m,x;a&16&&(i=Ud(t,r-t.l)),a&128&&(o=Ud(t,r-t.l)),(a&257)===257&&(u=Ud(t,r-t.l)),(a&257)===1&&(f=sV(t,r-t.l)),a&8&&(d=Ud(t,r-t.l)),a&32&&(m=t.read_shift(16)),a&64&&(x=jy(t)),t.l=r;var y=o||u||f||"";y&&d&&(y+="#"+d),y||(y="#"+d),a&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var w={Target:y};return m&&(w.guid=m),x&&(w.time=x),i&&(w.Tooltip=i),w}function lV(t){var e=Se(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}e.write_shift(4,2),e.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(i==28)n=n.slice(1),cS(n,e);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),i&8&&cS(a>-1?n.slice(a+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(e.write_shift(2,f),e.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)e.write_shift(1,n.charCodeAt(r+3*f)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function oN(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function cN(t,e){var r=oN(t);return r[3]=0,r}function Qs(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Jo(t,e,r,n){return n||(n=Se(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function oV(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function cV(t,e,r){return e===0?"":cc(t,e,r)}function uV(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),i=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[a,i,o]}function uN(t){var e=t.read_shift(2),r=Fy(t);return[e,r]}function fV(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=th(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,a}function Cp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function fN(t,e){return e||(e=Se(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function hN(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var hV=hN;function dN(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function dV(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function mV(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function On(t){t.l+=2,t.l+=t.read_shift(2)}var pV={0:On,4:On,5:On,6:On,7:mV,8:On,9:On,10:On,11:On,12:On,13:dV,14:On,15:On,16:On,17:On,18:On,19:On,20:On,21:dN};function gV(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(pV[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function zd(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Ly(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Se(a);return i.write_shift(2,n),i.write_shift(2,e),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function xV(t,e){return e===0||t.read_shift(2),1200}function vV(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=cc(t,0,r);return t.read_shift(e+n-t.l),a}function yV(t,e){var r=!e||e.biff==8,n=Se(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function _V(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function wV(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var o=th(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:i,name:o}}function bV(t,e){var r=!e||e.biff>=8?2:1,n=Se(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function EV(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),i=[],o=0;o!=a&&t.l<r;++o)i.push(eV(t));return i.Count=n,i.Unique=a,i}function TV(t,e){var r=Se(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=tV(t[a]);var i=gn([r].concat(n));return i.parts=[r.length].concat(n.map(function(o){return o.length})),i}function SV(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function AV(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function kV(t){var e=oV(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function CV(t){return t.read_shift(2),t.read_shift(4)}function uS(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function NV(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),u=t.read_shift(2),f=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:i,CurTab:o,FirstTab:u,Selected:f,TabRatio:d}}function RV(){var t=Se(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function IV(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function DV(t){var e=Se(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function OV(){}function FV(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=th(t,0,r),n}function MV(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,i=Se(a);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function PV(t){var e=Qs(t);return e.isst=t.read_shift(4),e}function jV(t,e,r,n){var a=Se(10);return Jo(t,e,n,a),a.write_shift(4,r),a}function LV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=Qs(t);r.biff==2&&t.l++;var i=rh(t,n-t.l,r);return a.val=i,a}function BV(t,e,r,n,a){var i=!a||a.biff==8,o=Se(8+ +i+(1+i)*r.length);return Jo(t,e,n,o),o.write_shift(2,r.length),i&&o.write_shift(1,1),o.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),o}function VV(t,e,r){var n=t.read_shift(2),a=cc(t,0,r);return[n,a]}function UV(t,e,r,n){var a=r&&r.biff==5;n||(n=Se(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var zV=cc;function fS(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,i=t.read_shift(a),o=t.read_shift(a),u=t.read_shift(2),f=t.read_shift(2);return t.l=n,{s:{r:i,c:u},e:{r:o,c:f}}}function HV(t,e){var r=e.biff==8||!e.biff?4:2,n=Se(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function GV(t){var e=t.read_shift(2),r=t.read_shift(2),n=uN(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function qV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),i=[];t.l<r;)i.push(uN(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(i.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:i}}function WV(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(i.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:i}}function XV(t,e,r,n){var a={},i=t.read_shift(4),o=t.read_shift(4),u=t.read_shift(4),f=t.read_shift(2);return a.patternType=kB[u>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function YV(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=XV(t,e,n.fStyle,r),n}function hS(t,e,r,n){var a=r&&r.biff==5;n||(n=Se(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var i=0;return t.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function $V(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function KV(t){var e=Se(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function dS(t,e,r){var n=Qs(t);(r.biff==2||e==9)&&++t.l;var a=ZB(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function QV(t,e,r,n,a,i){var o=Se(8);return Jo(t,e,n,o),iN(r,i,o),o}function JV(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Qs(t),a=Bn(t);return n.val=a,n}function ZV(t,e,r,n){var a=Se(14);return Jo(t,e,n,a),Ko(r,a),a}var mS=cV;function eU(t,e,r){var n=t.l+e,a=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var o=Qo(t,i),u=[];n>t.l;)u.push(rh(t));return[i,a,o,u]}function pS(t,e,r){var n=t.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=fV(t,e-2,r)),i.body=a||t.read_shift(e-2),typeof a=="string"&&(i.Name=a),i}var tU=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function gS(t,e,r){var n=t.l+e,a=t.read_shift(2),i=t.read_shift(1),o=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),f=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=Qo(t,o,r);a&32&&(d=tU[d.charCodeAt(0)]);var m=n-t.l;r&&r.biff==2&&--m;var x=n==t.l||u===0||!(m>0)?[]:gq(t,m,r,u);return{chKey:i,Name:d,itab:f,rgce:x}}function mN(t,e,r){if(r.biff<8)return rU(t,e,r);for(var n=[],a=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(uV(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function rU(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=th(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function nU(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),i=Qo(t,n,r),o=Qo(t,a,r);return[i,o]}function aU(t,e,r){var n=hN(t);t.l++;var a=t.read_shift(1);return e-=8,[xq(t,e,r),a,n]}function xS(t,e,r){var n=hV(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,mq(t,e,r)]}function sU(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function iU(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),u=cc(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,o,i]}}function lU(t,e,r){return iU(t,e,r)}function oU(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Cp(t));return r}function cU(t){var e=Se(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)fN(t[r],e);return e}function uU(t,e,r){if(r&&r.biff<8)return hU(t,e,r);var n=dN(t),a=gV(t,e-22,n[1]);return{cmo:n,ft:a}}var fU={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function hU(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((fU[n]||zn)(t,e,r)),{cmo:[a,n,i],ft:o}}function dU(t,e,r){var n=t.l,a="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:o=rV(t,6,r);var u=t.read_shift(2);t.read_shift(2),en(t,2);var f=t.read_shift(2);t.l+=f;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var m=t[t.l],x=Qo(t,t.lens[d+1]-t.lens[d]-1);if(a+=x,a.length>=(m?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function mU(t,e){var r=Cp(t);t.l+=16;var n=iV(t,e-24);return[r,n]}function pU(t){var e=Se(24),r=Sr(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return gn([e,lV(t[1])])}function gU(t,e){t.read_shift(2);var r=Cp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Zn,""),[r,n]}function xU(t){var e=t[1].Tooltip,r=Se(10+2*(e.length+1));r.write_shift(2,2048);var n=Sr(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function vU(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=tS[r]||r,r=t.read_shift(2),e[1]=tS[r]||r,e}function yU(t){return t||(t=Se(4)),t.write_shift(2,1),t.write_shift(2,1),t}function _U(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(cN(t));return r}function wU(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(cN(t));return r}function bU(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function pN(t,e,r){if(!r.cellStyles)return zn(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),u=t.read_shift(n),f=t.read_shift(2);n==2&&(t.l+=2);var d={s:a,e:i,w:o,ixfe:u,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function EU(t,e){var r=Se(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function TU(t,e){var r={};return e<32||(t.l+=16,r.header=Bn(t),r.footer=Bn(t),t.l+=2),r}function SU(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function AU(t){for(var e=Se(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var kU=Qs,CU=sN,NU=rh;function RU(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function IU(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Qs(t);++t.l;var a=cc(t,e-7,r);return n.t="str",n.val=a,n}function DU(t){var e=Qs(t);++t.l;var r=Bn(t);return e.t="n",e.val=r,e}function OU(t,e,r){var n=Se(15);return ih(n,t,e),n.write_shift(8,r,"f"),n}function FU(t){var e=Qs(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function MU(t,e,r){var n=Se(9);return ih(n,t,e),n.write_shift(2,r),n}function PU(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function jU(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function LU(t,e,r){var n=t.l+e,a=Qs(t),i=t.read_shift(2),o=Qo(t,i,r);return t.l=n,a.t="str",a.val=o,a}var BU=[2,3,48,49,131,139,140,245],ev=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Sp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,f){var d=[],m=Xl(1);switch(f.type){case"base64":m=Aa(Ia(u));break;case"binary":m=Aa(u);break;case"buffer":case"array":m=u;break}Sn(m,0);var x=m.read_shift(1),y=!!(x&136),w=!1,E=!1;switch(x){case 2:break;case 3:break;case 48:w=!0,y=!0;break;case 49:w=!0,y=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var b=0,T=521;x==2&&(b=m.read_shift(2)),m.l+=3,x!=2&&(b=m.read_shift(4)),b>1048576&&(b=1e6),x!=2&&(T=m.read_shift(2));var I=m.read_shift(2),R=f.codepage||1252;x!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(R=t[m[m.l]]),m.l+=1,m.l+=2),E&&(m.l+=36);for(var C=[],G={},V=Math.min(m.length,x==2?521:T-10-(w?264:0)),H=E?32:11;m.l<V&&m[m.l]!=13;)switch(G={},G.name=v0.utils.decode(R,m.slice(m.l,m.l+H)).replace(/[\u0000\r\n].*$/g,""),m.l+=H,G.type=String.fromCharCode(m.read_shift(1)),x!=2&&!E&&(G.offset=m.read_shift(4)),G.len=m.read_shift(1),x==2&&(G.offset=m.read_shift(2)),G.dec=m.read_shift(1),G.name.length&&C.push(G),x!=2&&(m.l+=E?13:14),G.type){case"B":(!w||G.len!=8)&&f.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+G.name+":"+G.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+G.type)}if(m[m.l]!==13&&(m.l=T-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=T;var A=0,D=0;for(d[0]=[],D=0;D!=C.length;++D)d[0][D]=C[D].name;for(;b-- >0;){if(m[m.l]===42){m.l+=I;continue}for(++m.l,d[++A]=[],D=0,D=0;D!=C.length;++D){var N=m.slice(m.l,m.l+C[D].len);m.l+=C[D].len,Sn(N,0);var M=v0.utils.decode(R,N);switch(C[D].type){case"C":M.trim().length&&(d[A][D]=M.replace(/\s+$/,""));break;case"D":M.length===8?d[A][D]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):d[A][D]=M;break;case"F":d[A][D]=parseFloat(M.trim());break;case"+":case"I":d[A][D]=E?N.read_shift(-4,"i")^2147483648:N.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":d[A][D]=!0;break;case"N":case"F":d[A][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));d[A][D]="##MEMO##"+(E?parseInt(M.trim(),10):N.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(d[A][D]=+M||0);break;case"@":d[A][D]=new Date(N.read_shift(-8,"f")-621356832e5);break;case"T":d[A][D]=new Date((N.read_shift(4)-2440588)*864e5+N.read_shift(4));break;case"Y":d[A][D]=N.read_shift(4,"i")/1e4+N.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[A][D]=-N.read_shift(-8,"f");break;case"B":if(w&&C[D].len==8){d[A][D]=N.read_shift(8,"f");break}case"G":case"P":N.l+=C[D].len;break;case"0":if(C[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[D].type)}}}if(x!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=C,d}function n(u,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var m=Lu(r(u,d),d);return m["!cols"]=d.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete d.DBF,m}function a(u,f){try{return no(n(u,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,f){var d=f||{};if(+d.codepage>=0&&ys(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=fa(),x=Gm(u,{header:1,raw:!0,cellDates:!0}),y=x[0],w=x.slice(1),E=u["!cols"]||[],b=0,T=0,I=0,R=1;for(b=0;b<y.length;++b){if(((E[b]||{}).DBF||{}).name){y[b]=E[b].DBF.name,++I;continue}if(y[b]!=null){if(++I,typeof y[b]=="number"&&(y[b]=y[b].toString(10)),typeof y[b]!="string")throw new Error("DBF Invalid column name "+y[b]+" |"+typeof y[b]+"|");if(y.indexOf(y[b])!==b){for(T=0;T<1024;++T)if(y.indexOf(y[b]+"_"+T)==-1){y[b]+="_"+T;break}}}}var C=Lt(u["!ref"]),G=[],V=[],H=[];for(b=0;b<=C.e.c-C.s.c;++b){var A="",D="",N=0,M=[];for(T=0;T<w.length;++T)w[T][b]!=null&&M.push(w[T][b]);if(M.length==0||y[b]==null){G[b]="?";continue}for(T=0;T<M.length;++T){switch(typeof M[T]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=M[T]instanceof Date?"D":"C";break;default:D="C"}N=Math.max(N,String(M[T]).length),A=A&&A!=D?"C":D}N>250&&(N=250),D=((E[b]||{}).DBF||{}).type,D=="C"&&E[b].DBF.len>N&&(N=E[b].DBF.len),A=="B"&&D=="N"&&(A="N",H[b]=E[b].DBF.dec,N=E[b].DBF.len),V[b]=A=="C"||D=="N"?N:i[A]||0,R+=V[b],G[b]=A}var F=m.next(32);for(F.write_shift(4,318902576),F.write_shift(4,w.length),F.write_shift(2,296+32*I),F.write_shift(2,R),b=0;b<4;++b)F.write_shift(4,0);for(F.write_shift(4,0|(+e[aC]||3)<<8),b=0,T=0;b<y.length;++b)if(y[b]!=null){var j=m.next(32),P=(y[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,P,"sbcs"),j.write_shift(1,G[b]=="?"?"C":G[b],"sbcs"),j.write_shift(4,T),j.write_shift(1,V[b]||i[G[b]]||0),j.write_shift(1,H[b]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),T+=V[b]||i[G[b]]||0}var be=m.next(264);for(be.write_shift(4,13),b=0;b<65;++b)be.write_shift(4,0);for(b=0;b<w.length;++b){var ye=m.next(R);for(ye.write_shift(1,0),T=0;T<y.length;++T)if(y[T]!=null)switch(G[T]){case"L":ye.write_shift(1,w[b][T]==null?63:w[b][T]?84:70);break;case"B":ye.write_shift(8,w[b][T]||0,"f");break;case"N":var se="0";for(typeof w[b][T]=="number"&&(se=w[b][T].toFixed(H[T]||0)),I=0;I<V[T]-se.length;++I)ye.write_shift(1,32);ye.write_shift(1,se,"sbcs");break;case"D":w[b][T]?(ye.write_shift(4,("0000"+w[b][T].getFullYear()).slice(-4),"sbcs"),ye.write_shift(2,("00"+(w[b][T].getMonth()+1)).slice(-2),"sbcs"),ye.write_shift(2,("00"+w[b][T].getDate()).slice(-2),"sbcs")):ye.write_shift(8,"00000000","sbcs");break;case"C":var ce=String(w[b][T]!=null?w[b][T]:"").slice(0,V[T]);for(ye.write_shift(1,ce,"sbcs"),I=0;I<V[T]-ce.length;++I)ye.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}})(),gN=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Dr(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(y,w){var E=t[w];return typeof E=="number"?CT(E):E},n=function(y,w,E){var b=w.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return b==59?y:CT(b)};t["|"]=254;function a(y,w){switch(w.type){case"base64":return i(Ia(y),w);case"binary":return i(y,w);case"buffer":return i(Tt&&Buffer.isBuffer(y)?y.toString("binary"):ro(y),w);case"array":return i($o(y),w)}throw new Error("Unrecognized type "+w.type)}function i(y,w){var E=y.split(/[\n\r]+/),b=-1,T=-1,I=0,R=0,C=[],G=[],V=null,H={},A=[],D=[],N=[],M=0,F;for(+w.codepage>=0&&ys(+w.codepage);I!==E.length;++I){M=0;var j=E[I].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),P=j.replace(/;;/g,"\0").split(";").map(function(ne){return ne.replace(/\u0000/g,";")}),be=P[0],ye;if(j.length>0)switch(be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":P[1].charAt(0)=="P"&&G.push(j.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,ce=!1,le=!1,te=!1,_e=-1,Q=-1;for(R=1;R<P.length;++R)switch(P[R].charAt(0)){case"A":break;case"X":T=parseInt(P[R].slice(1))-1,ce=!0;break;case"Y":for(b=parseInt(P[R].slice(1))-1,ce||(T=0),F=C.length;F<=b;++F)C[F]=[];break;case"K":ye=P[R].slice(1),ye.charAt(0)==='"'?ye=ye.slice(1,ye.length-1):ye==="TRUE"?ye=!0:ye==="FALSE"?ye=!1:isNaN(ws(ye))?isNaN(Eu(ye).getDate())||(ye=vr(ye)):(ye=ws(ye),V!==null&&Pu(V)&&(ye=kp(ye))),se=!0;break;case"E":te=!0;var L=fu(P[R].slice(1),{r:b,c:T});C[b][T]=[C[b][T],L];break;case"S":le=!0,C[b][T]=[C[b][T],"S5S"];break;case"G":break;case"R":_e=parseInt(P[R].slice(1))-1;break;case"C":Q=parseInt(P[R].slice(1))-1;break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+j)}if(se&&(C[b][T]&&C[b][T].length==2?C[b][T][0]=ye:C[b][T]=ye,V=null),le){if(te)throw new Error("SYLK shared formula cannot have own formula");var J=_e>-1&&C[_e][Q];if(!J||!J[1])throw new Error("SYLK shared formula cannot find base");C[b][T][1]=FN(J[1],{r:b-_e,c:T-Q})}break;case"F":var Y=0;for(R=1;R<P.length;++R)switch(P[R].charAt(0)){case"X":T=parseInt(P[R].slice(1))-1,++Y;break;case"Y":for(b=parseInt(P[R].slice(1))-1,F=C.length;F<=b;++F)C[F]=[];break;case"M":M=parseInt(P[R].slice(1))/20;break;case"F":break;case"G":break;case"P":V=G[parseInt(P[R].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(N=P[R].slice(1).split(" "),F=parseInt(N[0],10);F<=parseInt(N[1],10);++F)M=parseInt(N[2],10),D[F-1]=M===0?{hidden:!0}:{wch:M},Yl(D[F-1]);break;case"C":T=parseInt(P[R].slice(1))-1,D[T]||(D[T]={});break;case"R":b=parseInt(P[R].slice(1))-1,A[b]||(A[b]={}),M>0?(A[b].hpt=M,A[b].hpx=Su(M)):M===0&&(A[b].hidden=!0);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+j)}Y<1&&(V=null);break;default:if(w&&w.WTF)throw new Error("SYLK bad record "+j)}}return A.length>0&&(H["!rows"]=A),D.length>0&&(H["!cols"]=D),w&&w.sheetRows&&(C=C.slice(0,w.sheetRows)),[C,H]}function o(y,w){var E=a(y,w),b=E[0],T=E[1],I=Lu(b,w);return Dr(T).forEach(function(R){I[R]=T[R]}),I}function u(y,w){return no(o(y,w),w)}function f(y,w,E,b){var T="C;Y"+(E+1)+";X"+(b+1)+";K";switch(y.t){case"n":T+=y.v||0,y.f&&!y.F&&(T+=";E"+Gy(y.f,{r:E,c:b}));break;case"b":T+=y.v?"TRUE":"FALSE";break;case"e":T+=y.w||y.v;break;case"d":T+='"'+(y.w||y.v)+'"';break;case"s":T+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function d(y,w){w.forEach(function(E,b){var T="F;W"+(b+1)+" "+(b+1)+" ";E.hidden?T+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=A0(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=k0(E.wpx)),typeof E.wch=="number"&&(T+=Math.round(E.wch))),T.charAt(T.length-1)!=" "&&y.push(T)})}function m(y,w){w.forEach(function(E,b){var T="F;";E.hidden?T+="M0;":E.hpt?T+="M"+20*E.hpt+";":E.hpx&&(T+="M"+20*C0(E.hpx)+";"),T.length>2&&y.push(T+"R"+(b+1))})}function x(y,w){var E=["ID;PWXL;N;E"],b=[],T=Lt(y["!ref"]),I,R=Array.isArray(y),C=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),y["!cols"]&&d(E,y["!cols"]),y["!rows"]&&m(E,y["!rows"]),E.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var G=T.s.r;G<=T.e.r;++G)for(var V=T.s.c;V<=T.e.c;++V){var H=ot({r:G,c:V});I=R?(y[G]||[])[V]:y[H],!(!I||I.v==null&&(!I.f||I.F))&&b.push(f(I,y,G,V))}return E.join(C)+C+b.join(C)+C+"E"+C}return{to_workbook:u,to_sheet:o,from_sheet:x}})(),xN=(function(){function t(i,o){switch(o.type){case"base64":return e(Ia(i),o);case"binary":return e(i,o);case"buffer":return e(Tt&&Buffer.isBuffer(i)?i.toString("binary"):ro(i),o);case"array":return e($o(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){for(var u=i.split(`
`),f=-1,d=-1,m=0,x=[];m!==u.length;++m){if(u[m].trim()==="BOT"){x[++f]=[],d=0;continue}if(!(f<0)){var y=u[m].trim().split(","),w=y[0],E=y[1];++m;for(var b=u[m]||"";(b.match(/["]/g)||[]).length&1&&m<u.length-1;)b+=`
`+u[++m];switch(b=b.trim(),+w){case-1:if(b==="BOT"){x[++f]=[],d=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?x[f][d]=!0:b==="FALSE"?x[f][d]=!1:isNaN(ws(E))?isNaN(Eu(E).getDate())?x[f][d]=E:x[f][d]=vr(E):x[f][d]=ws(E),++d;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),x[f][d++]=b!==""?b:null;break}if(b==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function r(i,o){return Lu(t(i,o),o)}function n(i,o){return no(r(i,o),o)}var a=(function(){var i=function(f,d,m,x,y){f.push(d),f.push(m+","+x),f.push('"'+y.replace(/"/g,'""')+'"')},o=function(f,d,m,x){f.push(d+","+m),f.push(d==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(f){var d=[],m=Lt(f["!ref"]),x,y=Array.isArray(f);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,m.e.r-m.s.r+1,""),i(d,"TUPLES",0,m.e.c-m.s.c+1,""),i(d,"DATA",0,0,"");for(var w=m.s.r;w<=m.e.r;++w){o(d,-1,0,"BOT");for(var E=m.s.c;E<=m.e.c;++E){var b=ot({r:w,c:E});if(x=y?(f[w]||[])[E]:f[b],!x){o(d,1,0,"");continue}switch(x.t){case"n":var T=x.w;!T&&x.v!=null&&(T=x.v),T==null?x.f&&!x.F?o(d,1,0,"="+x.f):o(d,1,0,""):o(d,0,T,"V");break;case"b":o(d,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=es(x.z||lt[14],un(vr(x.v)))),o(d,0,x.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var I=`\r
`,R=d.join(I);return R}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),vN=(function(){function t(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,y){for(var w=x.split(`
`),E=-1,b=-1,T=0,I=[];T!==w.length;++T){var R=w[T].trim().split(":");if(R[0]==="cell"){var C=Sr(R[1]);if(I.length<=C.r)for(E=I.length;E<=C.r;++E)I[E]||(I[E]=[]);switch(E=C.r,b=C.c,R[2]){case"t":I[E][b]=t(R[3]);break;case"v":I[E][b]=+R[3];break;case"vtf":var G=R[R.length-1];case"vtc":switch(R[3]){case"nl":I[E][b]=!!+R[4];break;default:I[E][b]=+R[4];break}R[2]=="vtf"&&(I[E][b]=[I[E][b],G])}}}return y&&y.sheetRows&&(I=I.slice(0,y.sheetRows)),I}function n(x,y){return Lu(r(x,y),y)}function a(x,y){return no(n(x,y),y)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(x){if(!x||!x["!ref"])return"";for(var y=[],w=[],E,b="",T=ha(x["!ref"]),I=Array.isArray(x),R=T.s.r;R<=T.e.r;++R)for(var C=T.s.c;C<=T.e.c;++C)if(b=ot({r:R,c:C}),E=I?(x[R]||[])[C]:x[b],!(!E||E.v==null||E.t==="z")){switch(w=["cell",b,"t"],E.t){case"s":case"str":w.push(e(E.v));break;case"n":E.f?(w[2]="vtf",w[3]="n",w[4]=E.v,w[5]=e(E.f)):(w[2]="v",w[3]=E.v);break;case"b":w[2]="vt"+(E.f?"f":"c"),w[3]="nl",w[4]=E.v?"1":"0",w[5]=e(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var G=un(vr(E.v));w[2]="vtc",w[3]="nd",w[4]=""+G,w[5]=E.w||es(E.z||lt[14],G);break;case"e":continue}y.push(w.join(":"))}return y.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function m(x){return[i,o,u,o,d(x),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:m}})(),Tu=(function(){function t(m,x,y,w,E){E.raw?x[y][w]=m:m===""||(m==="TRUE"?x[y][w]=!0:m==="FALSE"?x[y][w]=!1:isNaN(ws(m))?isNaN(Eu(m).getDate())?x[y][w]=m:x[y][w]=vr(m):x[y][w]=ws(m))}function e(m,x){var y=x||{},w=[];if(!m||m.length===0)return w;for(var E=m.split(/[\r\n]/),b=E.length-1;b>=0&&E[b].length===0;)--b;for(var T=10,I=0,R=0;R<=b;++R)I=E[R].indexOf(" "),I==-1?I=E[R].length:I++,T=Math.max(T,I);for(R=0;R<=b;++R){w[R]=[];var C=0;for(t(E[R].slice(0,T).trim(),w,R,C,y),C=1;C<=(E[R].length-T)/10+1;++C)t(E[R].slice(T+(C-1)*10,T+C*10).trim(),w,R,C,y)}return y.sheetRows&&(w=w.slice(0,y.sheetRows)),w}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(m){for(var x={},y=!1,w=0,E=0;w<m.length;++w)(E=m.charCodeAt(w))==34?y=!y:!y&&E in r&&(x[E]=(x[E]||0)+1);E=[];for(w in x)Object.prototype.hasOwnProperty.call(x,w)&&E.push([x[w],w]);if(!E.length){x=n;for(w in x)Object.prototype.hasOwnProperty.call(x,w)&&E.push([x[w],w])}return E.sort(function(b,T){return b[0]-T[0]||n[b[1]]-n[T[1]]}),r[E.pop()[1]]||44}function i(m,x){var y=x||{},w="",E=y.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(w=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(w=m.charAt(4),m=m.slice(6)):w=a(m.slice(0,1024)):y&&y.FS?w=y.FS:w=a(m.slice(0,1024));var T=0,I=0,R=0,C=0,G=0,V=w.charCodeAt(0),H=!1,A=0,D=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var N=y.dateNF!=null?S7(y.dateNF):null;function M(){var F=m.slice(C,G),j={};if(F.charAt(0)=='"'&&F.charAt(F.length-1)=='"'&&(F=F.slice(1,-1).replace(/""/g,'"')),F.length===0)j.t="z";else if(y.raw)j.t="s",j.v=F;else if(F.trim().length===0)j.t="s",j.v=F;else if(F.charCodeAt(0)==61)F.charCodeAt(1)==34&&F.charCodeAt(F.length-1)==34?(j.t="s",j.v=F.slice(2,-1).replace(/""/g,'"')):eG(F)?(j.t="n",j.f=F.slice(1)):(j.t="s",j.v=F);else if(F=="TRUE")j.t="b",j.v=!0;else if(F=="FALSE")j.t="b",j.v=!1;else if(!isNaN(R=ws(F)))j.t="n",y.cellText!==!1&&(j.w=F),j.v=R;else if(!isNaN(Eu(F).getDate())||N&&F.match(N)){j.z=y.dateNF||lt[14];var P=0;N&&F.match(N)&&(F=A7(F,y.dateNF,F.match(N)||[]),P=1),y.cellDates?(j.t="d",j.v=vr(F,P)):(j.t="n",j.v=un(vr(F,P))),y.cellText!==!1&&(j.w=es(j.z,j.v instanceof Date?un(j.v):j.v)),y.cellNF||delete j.z}else j.t="s",j.v=F;if(j.t=="z"||(y.dense?(E[T]||(E[T]=[]),E[T][I]=j):E[ot({c:I,r:T})]=j),C=G+1,D=m.charCodeAt(C),b.e.c<I&&(b.e.c=I),b.e.r<T&&(b.e.r=T),A==V)++I;else if(I=0,++T,y.sheetRows&&y.sheetRows<=T)return!0}e:for(;G<m.length;++G)switch(A=m.charCodeAt(G)){case 34:D===34&&(H=!H);break;case V:case 10:case 13:if(!H&&M())break e;break}return G-C>0&&M(),E["!ref"]=yt(b),E}function o(m,x){return!(x&&x.PRN)||x.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?i(m,x):Lu(e(m,x),x)}function u(m,x){var y="",w=x.type=="string"?[0,0,0,0]:Jy(m,x);switch(x.type){case"base64":y=Ia(m);break;case"binary":y=m;break;case"buffer":x.codepage==65001?y=m.toString("utf8"):x.codepage&&typeof v0<"u"||(y=Tt&&Buffer.isBuffer(m)?m.toString("binary"):ro(m));break;case"array":y=$o(m);break;case"string":y=m;break;default:throw new Error("Unrecognized type "+x.type)}return w[0]==239&&w[1]==187&&w[2]==191?y=lr(y.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?y=lr(y):x.type=="binary"&&typeof v0<"u",y.slice(0,19)=="socialcalc:version:"?vN.to_sheet(x.type=="string"?y:lr(y),x):o(y,x)}function f(m,x){return no(u(m,x),x)}function d(m){for(var x=[],y=Lt(m["!ref"]),w,E=Array.isArray(m),b=y.s.r;b<=y.e.r;++b){for(var T=[],I=y.s.c;I<=y.e.c;++I){var R=ot({r:b,c:I});if(w=E?(m[b]||[])[I]:m[R],!w||w.v==null){T.push("          ");continue}for(var C=(w.w||(ji(w),w.w)||"").slice(0,10);C.length<10;)C+=" ";T.push(C+(I===0?" ":""))}x.push(T.join(""))}return x.join(`
`)}return{to_workbook:f,to_sheet:u,from_sheet:d}})();function VU(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=gN.to_workbook(t,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Tu.to_workbook(t,e)}}var Uo=(function(){function t(L,J,Y){if(L){Sn(L,L.l||0);for(var ne=Y.Enum||_e;L.l<L.length;){var ue=L.read_shift(2),Te=ne[ue]||ne[65535],Re=L.read_shift(2),Ae=L.l+Re,Fe=Te.f&&Te.f(L,Re,Y);if(L.l=Ae,J(Fe,Te,ue))return}}}function e(L,J){switch(J.type){case"base64":return r(Aa(Ia(L)),J);case"binary":return r(Aa(L),J);case"buffer":case"array":return r(L,J)}throw"Unsupported type "+J.type}function r(L,J){if(!L)return L;var Y=J||{},ne=Y.dense?[]:{},ue="Sheet1",Te="",Re=0,Ae={},Fe=[],st=[],B={s:{r:0,c:0},e:{r:0,c:0}},Xe=Y.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)Y.Enum=_e,t(L,function(je,ht,_t){switch(_t){case 0:Y.vers=je,je>=4096&&(Y.qpro=!0);break;case 6:B=je;break;case 204:je&&(Te=je);break;case 222:Te=je;break;case 15:case 51:Y.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:_t==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=Y.dateNF||lt[14],Y.cellDates&&(je[1].t="d",je[1].v=kp(je[1].v))),Y.qpro&&je[3]>Re&&(ne["!ref"]=yt(B),Ae[ue]=ne,Fe.push(ue),ne=Y.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},Re=je[3],ue=Te||"Sheet"+(Re+1),Te="");var Ft=Y.dense?(ne[je[0].r]||[])[je[0].c]:ne[ot(je[0])];if(Ft){Ft.t=je[1].t,Ft.v=je[1].v,je[1].z!=null&&(Ft.z=je[1].z),je[1].f!=null&&(Ft.f=je[1].f);break}Y.dense?(ne[je[0].r]||(ne[je[0].r]=[]),ne[je[0].r][je[0].c]=je[1]):ne[ot(je[0])]=je[1];break}},Y);else if(L[2]==26||L[2]==14)Y.Enum=Q,L[2]==14&&(Y.qpro=!0,L.l=0),t(L,function(je,ht,_t){switch(_t){case 204:ue=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>Re&&(ne["!ref"]=yt(B),Ae[ue]=ne,Fe.push(ue),ne=Y.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},Re=je[3],ue="Sheet"+(Re+1)),Xe>0&&je[0].r>=Xe)break;Y.dense?(ne[je[0].r]||(ne[je[0].r]=[]),ne[je[0].r][je[0].c]=je[1]):ne[ot(je[0])]=je[1],B.e.c<je[0].c&&(B.e.c=je[0].c),B.e.r<je[0].r&&(B.e.r=je[0].r);break;case 27:je[14e3]&&(st[je[14e3][0]]=je[14e3][1]);break;case 1537:st[je[0]]=je[1],je[0]==Re&&(ue=je[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(ne["!ref"]=yt(B),Ae[Te||ue]=ne,Fe.push(Te||ue),!st.length)return{SheetNames:Fe,Sheets:Ae};for(var Pe={},et=[],We=0;We<st.length;++We)Ae[Fe[We]]?(et.push(st[We]||Fe[We]),Pe[st[We]]=Ae[st[We]]||Ae[Fe[We]]):(et.push(st[We]),Pe[st[We]]={"!ref":"A1"});return{SheetNames:et,Sheets:Pe}}function n(L,J){var Y=J||{};if(+Y.codepage>=0&&ys(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var ne=fa(),ue=Lt(L["!ref"]),Te=Array.isArray(L),Re=[];ze(ne,0,i(1030)),ze(ne,6,f(ue));for(var Ae=Math.min(ue.e.r,8191),Fe=ue.s.r;Fe<=Ae;++Fe)for(var st=Ur(Fe),B=ue.s.c;B<=ue.e.c;++B){Fe===ue.s.r&&(Re[B]=Tr(B));var Xe=Re[B]+st,Pe=Te?(L[Fe]||[])[B]:L[Xe];if(!(!Pe||Pe.t=="z"))if(Pe.t=="n")(Pe.v|0)==Pe.v&&Pe.v>=-32768&&Pe.v<=32767?ze(ne,13,w(Fe,B,Pe.v)):ze(ne,14,b(Fe,B,Pe.v));else{var et=ji(Pe);ze(ne,15,x(Fe,B,et.slice(0,239)))}}return ze(ne,1),ne.end()}function a(L,J){var Y=J||{};if(+Y.codepage>=0&&ys(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var ne=fa();ze(ne,0,o(L));for(var ue=0,Te=0;ue<L.SheetNames.length;++ue)(L.Sheets[L.SheetNames[ue]]||{})["!ref"]&&ze(ne,27,te(L.SheetNames[ue],Te++));var Re=0;for(ue=0;ue<L.SheetNames.length;++ue){var Ae=L.Sheets[L.SheetNames[ue]];if(!(!Ae||!Ae["!ref"])){for(var Fe=Lt(Ae["!ref"]),st=Array.isArray(Ae),B=[],Xe=Math.min(Fe.e.r,8191),Pe=Fe.s.r;Pe<=Xe;++Pe)for(var et=Ur(Pe),We=Fe.s.c;We<=Fe.e.c;++We){Pe===Fe.s.r&&(B[We]=Tr(We));var je=B[We]+et,ht=st?(Ae[Pe]||[])[We]:Ae[je];if(!(!ht||ht.t=="z"))if(ht.t=="n")ze(ne,23,M(Pe,We,Re,ht.v));else{var _t=ji(ht);ze(ne,22,A(Pe,We,Re,_t.slice(0,239)))}}++Re}}return ze(ne,1),ne.end()}function i(L){var J=Se(2);return J.write_shift(2,L),J}function o(L){var J=Se(26);J.write_shift(2,4096),J.write_shift(2,4),J.write_shift(4,0);for(var Y=0,ne=0,ue=0,Te=0;Te<L.SheetNames.length;++Te){var Re=L.SheetNames[Te],Ae=L.Sheets[Re];if(!(!Ae||!Ae["!ref"])){++ue;var Fe=ha(Ae["!ref"]);Y<Fe.e.r&&(Y=Fe.e.r),ne<Fe.e.c&&(ne=Fe.e.c)}}return Y>8191&&(Y=8191),J.write_shift(2,Y),J.write_shift(1,ue),J.write_shift(1,ne),J.write_shift(2,0),J.write_shift(2,0),J.write_shift(1,1),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(4,0),J}function u(L,J,Y){var ne={s:{c:0,r:0},e:{c:0,r:0}};return J==8&&Y.qpro?(ne.s.c=L.read_shift(1),L.l++,ne.s.r=L.read_shift(2),ne.e.c=L.read_shift(1),L.l++,ne.e.r=L.read_shift(2),ne):(ne.s.c=L.read_shift(2),ne.s.r=L.read_shift(2),J==12&&Y.qpro&&(L.l+=2),ne.e.c=L.read_shift(2),ne.e.r=L.read_shift(2),J==12&&Y.qpro&&(L.l+=2),ne.s.c==65535&&(ne.s.c=ne.e.c=ne.s.r=ne.e.r=0),ne)}function f(L){var J=Se(8);return J.write_shift(2,L.s.c),J.write_shift(2,L.s.r),J.write_shift(2,L.e.c),J.write_shift(2,L.e.r),J}function d(L,J,Y){var ne=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(ne[0].c=L.read_shift(1),ne[3]=L.read_shift(1),ne[0].r=L.read_shift(2),L.l+=2):(ne[2]=L.read_shift(1),ne[0].c=L.read_shift(2),ne[0].r=L.read_shift(2)),ne}function m(L,J,Y){var ne=L.l+J,ue=d(L,J,Y);if(ue[1].t="s",Y.vers==20768){L.l++;var Te=L.read_shift(1);return ue[1].v=L.read_shift(Te,"utf8"),ue}return Y.qpro&&L.l++,ue[1].v=L.read_shift(ne-L.l,"cstr"),ue}function x(L,J,Y){var ne=Se(7+Y.length);ne.write_shift(1,255),ne.write_shift(2,J),ne.write_shift(2,L),ne.write_shift(1,39);for(var ue=0;ue<ne.length;++ue){var Te=Y.charCodeAt(ue);ne.write_shift(1,Te>=128?95:Te)}return ne.write_shift(1,0),ne}function y(L,J,Y){var ne=d(L,J,Y);return ne[1].v=L.read_shift(2,"i"),ne}function w(L,J,Y){var ne=Se(7);return ne.write_shift(1,255),ne.write_shift(2,J),ne.write_shift(2,L),ne.write_shift(2,Y,"i"),ne}function E(L,J,Y){var ne=d(L,J,Y);return ne[1].v=L.read_shift(8,"f"),ne}function b(L,J,Y){var ne=Se(13);return ne.write_shift(1,255),ne.write_shift(2,J),ne.write_shift(2,L),ne.write_shift(8,Y,"f"),ne}function T(L,J,Y){var ne=L.l+J,ue=d(L,J,Y);if(ue[1].v=L.read_shift(8,"f"),Y.qpro)L.l=ne;else{var Te=L.read_shift(2);G(L.slice(L.l,L.l+Te),ue),L.l+=Te}return ue}function I(L,J,Y){var ne=J&32768;return J&=-32769,J=(ne?L:0)+(J>=8192?J-16384:J),(ne?"":"$")+(Y?Tr(J):Ur(J))}var R={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function G(L,J){Sn(L,0);for(var Y=[],ne=0,ue="",Te="",Re="",Ae="";L.l<L.length;){var Fe=L[L.l++];switch(Fe){case 0:Y.push(L.read_shift(8,"f"));break;case 1:Te=I(J[0].c,L.read_shift(2),!0),ue=I(J[0].r,L.read_shift(2),!1),Y.push(Te+ue);break;case 2:{var st=I(J[0].c,L.read_shift(2),!0),B=I(J[0].r,L.read_shift(2),!1);Te=I(J[0].c,L.read_shift(2),!0),ue=I(J[0].r,L.read_shift(2),!1),Y.push(st+B+":"+Te+ue)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(L.read_shift(2));break;case 6:{for(var Xe="";Fe=L[L.l++];)Xe+=String.fromCharCode(Fe);Y.push('"'+Xe.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:Ae=Y.pop(),Re=Y.pop(),Y.push(["AND","OR"][Fe-20]+"("+Re+","+Ae+")");break;default:if(Fe<32&&C[Fe])Ae=Y.pop(),Re=Y.pop(),Y.push(Re+C[Fe]+Ae);else if(R[Fe]){if(ne=R[Fe][1],ne==69&&(ne=L[L.l++]),ne>Y.length){console.error("WK1 bad formula parse 0x"+Fe.toString(16)+":|"+Y.join("|")+"|");return}var Pe=Y.slice(-ne);Y.length-=ne,Y.push(R[Fe][0]+"("+Pe.join(",")+")")}else return Fe<=7?console.error("WK1 invalid opcode "+Fe.toString(16)):Fe<=24?console.error("WK1 unsupported op "+Fe.toString(16)):Fe<=30?console.error("WK1 invalid opcode "+Fe.toString(16)):Fe<=115?console.error("WK1 unsupported function opcode "+Fe.toString(16)):console.error("WK1 unrecognized opcode "+Fe.toString(16))}}Y.length==1?J[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function V(L){var J=[{c:0,r:0},{t:"n",v:0},0];return J[0].r=L.read_shift(2),J[3]=L[L.l++],J[0].c=L[L.l++],J}function H(L,J){var Y=V(L);return Y[1].t="s",Y[1].v=L.read_shift(J-4,"cstr"),Y}function A(L,J,Y,ne){var ue=Se(6+ne.length);ue.write_shift(2,L),ue.write_shift(1,Y),ue.write_shift(1,J),ue.write_shift(1,39);for(var Te=0;Te<ne.length;++Te){var Re=ne.charCodeAt(Te);ue.write_shift(1,Re>=128?95:Re)}return ue.write_shift(1,0),ue}function D(L,J){var Y=V(L);Y[1].v=L.read_shift(2);var ne=Y[1].v>>1;if(Y[1].v&1)switch(ne&7){case 0:ne=(ne>>3)*5e3;break;case 1:ne=(ne>>3)*500;break;case 2:ne=(ne>>3)/20;break;case 3:ne=(ne>>3)/200;break;case 4:ne=(ne>>3)/2e3;break;case 5:ne=(ne>>3)/2e4;break;case 6:ne=(ne>>3)/16;break;case 7:ne=(ne>>3)/64;break}return Y[1].v=ne,Y}function N(L,J){var Y=V(L),ne=L.read_shift(4),ue=L.read_shift(4),Te=L.read_shift(2);if(Te==65535)return ne===0&&ue===3221225472?(Y[1].t="e",Y[1].v=15):ne===0&&ue===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var Re=Te&32768;return Te=(Te&32767)-16446,Y[1].v=(1-Re*2)*(ue*Math.pow(2,Te+32)+ne*Math.pow(2,Te)),Y}function M(L,J,Y,ne){var ue=Se(14);if(ue.write_shift(2,L),ue.write_shift(1,Y),ue.write_shift(1,J),ne==0)return ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,65535),ue;var Te=0,Re=0,Ae=0,Fe=0;return ne<0&&(Te=1,ne=-ne),Re=Math.log2(ne)|0,ne/=Math.pow(2,Re-31),Fe=ne>>>0,(Fe&2147483648)==0&&(ne/=2,++Re,Fe=ne>>>0),ne-=Fe,Fe|=2147483648,Fe>>>=0,ne*=Math.pow(2,32),Ae=ne>>>0,ue.write_shift(4,Ae),ue.write_shift(4,Fe),Re+=16383+(Te?32768:0),ue.write_shift(2,Re),ue}function F(L,J){var Y=N(L);return L.l+=J-14,Y}function j(L,J){var Y=V(L),ne=L.read_shift(4);return Y[1].v=ne>>6,Y}function P(L,J){var Y=V(L),ne=L.read_shift(8,"f");return Y[1].v=ne,Y}function be(L,J){var Y=P(L);return L.l+=J-10,Y}function ye(L,J){return L[L.l+J-1]==0?L.read_shift(J,"cstr"):""}function se(L,J){var Y=L[L.l++];Y>J-1&&(Y=J-1);for(var ne="";ne.length<Y;)ne+=String.fromCharCode(L[L.l++]);return ne}function ce(L,J,Y){if(!(!Y.qpro||J<21)){var ne=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var ue=L.read_shift(J-21,"cstr");return[ne,ue]}}function le(L,J){for(var Y={},ne=L.l+J;L.l<ne;){var ue=L.read_shift(2);if(ue==14e3){for(Y[ue]=[0,""],Y[ue][0]=L.read_shift(2);L[L.l];)Y[ue][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return Y}function te(L,J){var Y=Se(5+L.length);Y.write_shift(2,14e3),Y.write_shift(2,J);for(var ne=0;ne<L.length;++ne){var ue=L.charCodeAt(ne);Y[Y.l++]=ue>127?95:ue}return Y[Y.l++]=0,Y}var _e={0:{n:"BOF",f:en},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ye},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},Q={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:H},23:{n:"NUMBER17",f:N},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:F},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:P},40:{n:"FORMULA28",f:be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}})();function UU(t){var e={},r=t.match(Hn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=ut(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=py[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return e}var zU=(function(){var t=w0("t"),e=w0("rPr");function r(i){var o=i.match(t);if(!o)return{t:"s",v:""};var u={t:"s",v:jt(o[1])},f=i.match(e);return f&&(u.s=UU(f[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(u){return u.v})}})(),HU=(function(){var e=/(\r\n|\n)/g;function r(a,i,o){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),i.push('<span style="'+u.join("")+'">'),a.b&&(i.push("<b>"),o.push("</b>")),a.i&&(i.push("<i>"),o.push("</i>")),a.strike&&(i.push("<s>"),o.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),o.push("</"+f+">")),o.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),GU=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,qU=/<(?:\w+:)?r>/,WU=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function By(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=jt(lr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=lr(t),r&&(n.h=Sy(n.t))):t.match(qU)&&(n.r=lr(t),n.t=jt(lr((t.replace(WU,"").match(GU)||[]).join("").replace(Hn,""))),r&&(n.h=HU(zU(n.r)))),n):{t:""}}var XU=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,YU=/<(?:\w+:)?(?:si|sstItem)>/g,$U=/<\/(?:\w+:)?(?:si|sstItem)>/;function KU(t,e){var r=[],n="";if(!t)return r;var a=t.match(XU);if(a){n=a[2].replace(YU,"").split($U);for(var i=0;i!=n.length;++i){var o=By(n[i].trim(),e);o!=null&&(r[r.length]=o)}a=ut(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var QU=/^\s|\s$|[\t\n\r]/;function yN(t,e){if(!e.bookSST)return"";var r=[zr];r[r.length]=Ue("sst",null,{xmlns:ac[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(QU)&&(i+=' xml:space="preserve"'),i+=">"+tr(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function JU(t){return[t.read_shift(4),t.read_shift(4)]}function ZU(t,e){var r=[],n=!1;return Vi(t,function(i,o,u){switch(u){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function ez(t,e){return e||(e=Se(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var tz=fB;function rz(t){var e=fa();Me(e,159,ez(t));for(var r=0;r<t.length;++r)Me(e,19,tz(t[r]));return Me(e,160),e.end()}function _N(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Ni(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function nz(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Ni(t,4),e.U=Ni(t,4),e.W=Ni(t,4),e}function az(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),i=[];a-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function sz(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(az(t));return e}function iz(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function lz(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Ni(t,4),e.U=Ni(t,4),e.W=Ni(t,4),e}function oz(t){var e=lz(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function wN(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function bN(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function cz(t){var e=Ni(t);switch(e.Minor){case 2:return[e.Minor,uz(t)];case 3:return[e.Minor,fz()];case 4:return[e.Minor,hz(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function uz(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=wN(t,r),a=bN(t,t.length-t.l);return{t:"Std",h:n,v:a}}function fz(){throw new Error("File is password-protected: ECMA-376 Extensible")}function hz(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Hn,function(i){var o=ut(i);switch(Ks(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=o[u]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function dz(t,e){var r={},n=r.EncryptionVersionInfo=Ni(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=wN(t,a),e-=a,r.EncryptionVerifier=bN(t,e),r}function mz(t){var e={},r=e.EncryptionVersionInfo=Ni(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Vy(t){var e=0,r,n=_N(t),a=n.length+1,i,o,u,f,d;for(r=Xl(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)o=r[i],u=(e&16384)===0?0:1,f=e<<1&32767,d=u|f,e=d^o;return e^52811}var EN=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,u){return n(o^u)},i=function(o){for(var u=e[o.length-1],f=104,d=o.length-1;d>=0;--d)for(var m=o[d],x=0;x!=7;++x)m&64&&(u^=r[f]),m*=2,--f;return u};return function(o){for(var u=_N(o),f=i(u),d=u.length,m=Xl(16),x=0;x!=16;++x)m[x]=0;var y,w,E;for((d&1)===1&&(y=f>>8,m[d]=a(t[0],y),--d,y=f&255,w=u[u.length-1],m[d]=a(w,y));d>0;)--d,y=f>>8,m[d]=a(u[d],y),--d,y=f&255,m[d]=a(u[d],y);for(d=15,E=15-u.length;E>0;)y=f>>8,m[d]=a(t[E],y),--d,--E,y=f&255,m[d]=a(u[d],y),--d,--E;return m}})(),pz=function(t,e,r,n,a){a||(a=e),n||(n=EN(t));var i,o;for(i=0;i!=e.length;++i)o=e[i],o^=n[r],o=(o>>5|o<<3)&255,a[i]=o,++r;return[a,r,n]},gz=function(t){var e=0,r=EN(t);return function(n){var a=pz("",n,e,r);return e=a[1],a[0]}};function xz(t,e,r,n){var a={key:en(t),verificationBytes:en(t)};return r.password&&(a.verifier=Vy(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=gz(r.password)),a}function vz(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=mz(t):n.Data=dz(t,e),n}function yz(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?vz(t,e-2,n):xz(t,r.biff>=8?e:e-2,r,n),n}var TN=(function(){function t(a,i){switch(i.type){case"base64":return e(Ia(a),i);case"binary":return e(a,i);case"buffer":return e(Tt&&Buffer.isBuffer(a)?a.toString("binary"):ro(a),i);case"array":return e($o(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){var o=i||{},u=o.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,x){Array.isArray(u)&&(u[x]=[]);for(var y=/\\\w+\b/g,w=0,E,b=-1;E=y.exec(m);){switch(E[0]){case"\\cell":var T=m.slice(w,y.lastIndex-E[0].length);if(T[0]==" "&&(T=T.slice(1)),++b,T.length){var I={v:T,t:"s"};Array.isArray(u)?u[x][b]=I:u[ot({r:x,c:b})]=I}break}w=y.lastIndex}b>d.e.c&&(d.e.c=b)}),u["!ref"]=yt(d),u}function r(a,i){return no(t(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],o=Lt(a["!ref"]),u,f=Array.isArray(a),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)i.push("\\cellx"+(m+1));for(i.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var x=ot({r:d,c:m});u=f?(a[d]||[])[m]:a[x],!(!u||u.v==null&&(!u.f||u.F))&&(i.push(" "+(u.w||(ji(u),u.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function _z(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function S0(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function wz(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),i=Math.min(e,r,n),o=a-i;if(o===0)return[0,0,e];var u=0,f=0,d=a+i;switch(f=o/(d>1?2-d:d),a){case e:u=((r-n)/o+6)%6;break;case r:u=(n-e)/o+2;break;case n:u=(e-r)/o+4;break}return[u/6,f,d/2]}function bz(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),i=n-a/2,o=[i,i,i],u=6*e,f;if(r!==0)switch(u|0){case 0:case 6:f=a*u,o[0]+=a,o[1]+=f;break;case 1:f=a*(2-u),o[0]+=f,o[1]+=a;break;case 2:f=a*(u-2),o[1]+=a,o[2]+=f;break;case 3:f=a*(4-u),o[1]+=f,o[2]+=a;break;case 4:f=a*(u-4),o[2]+=a,o[0]+=f;break;case 5:f=a*(6-u),o[2]+=f,o[0]+=a;break}for(var d=0;d!=3;++d)o[d]=Math.round(o[d]*255);return o}function zm(t,e){if(e===0)return t;var r=wz(_z(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),S0(bz(r))}var SN=6,Ez=15,Tz=1,Ln=SN;function A0(t){return Math.floor((t+Math.round(128/Ln)/256)*Ln)}function k0(t){return Math.floor((t-5)/Ln*100+.5)/100}function Hm(t){return Math.round((t*Ln+5)/Ln*256)/256}function tx(t){return Hm(k0(A0(t)))}function Uy(t){var e=Math.abs(t-tx(t)),r=Ln;if(e>.005)for(Ln=Tz;Ln<Ez;++Ln)Math.abs(t-tx(t))<=e&&(e=Math.abs(t-tx(t)),r=Ln);Ln=r}function Yl(t){t.width?(t.wpx=A0(t.width),t.wch=k0(t.wpx),t.MDW=Ln):t.wpx?(t.wch=k0(t.wpx),t.width=Hm(t.wch),t.MDW=Ln):typeof t.wch=="number"&&(t.width=Hm(t.wch),t.wpx=A0(t.width),t.MDW=Ln),t.customWidth&&delete t.customWidth}var Sz=96,AN=Sz;function C0(t){return t*96/AN}function Su(t){return t*AN/96}var Az={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function kz(t,e,r,n){e.Borders=[];var a={},i=!1;(t[0].match(Hn)||[]).forEach(function(o){var u=ut(o);switch(Ks(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=gr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=gr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in borders")}})}function Cz(t,e,r,n){e.Fills=[];var a={},i=!1;(t[0].match(Hn)||[]).forEach(function(o){var u=ut(o);switch(Ks(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fills")}})}function Nz(t,e,r,n){e.Fonts=[];var a={},i=!1;(t[0].match(Hn)||[]).forEach(function(o){var u=ut(o);switch(Ks(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=lr(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?gr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?gr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?gr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?gr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?gr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?gr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?gr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=py[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=gr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var f=Bo[a.color.index];a.color.index==81&&(f=Bo[1]),f||(f=Bo[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=zm(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+u[0]+" in fonts")}})}function Rz(t,e,r){e.NumberFmt=[];for(var n=Dr(lt),a=0;a<n.length;++a)e.NumberFmt[n[a]]=lt[n[a]];var i=t[0].match(Hn);if(i)for(a=0;a<i.length;++a){var o=ut(i[a]);switch(Ks(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=jt(lr(o.formatCode)),f=parseInt(o.numFmtId,10);if(e.NumberFmt[f]=u,f>0){if(f>392){for(f=392;f>60&&e.NumberFmt[f]!=null;--f);e.NumberFmt[f]=u}Ci(u,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Iz(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ue("numFmt",null,{numFmtId:n,formatCode:tr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ue("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Hd=["numFmtId","fillId","fontId","borderId","xfId"],Gd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Dz(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(Hn)||[]).forEach(function(i){var o=ut(i),u=0;switch(Ks(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],u=0;u<Hd.length;++u)n[Hd[u]]&&(n[Hd[u]]=parseInt(n[Hd[u]],10));for(u=0;u<Gd.length;++u)n[Gd[u]]&&(n[Gd[u]]=gr(n[Gd[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};o.vertical&&(f.vertical=o.vertical),o.horizontal&&(f.horizontal=o.horizontal),o.textRotation!=null&&(f.textRotation=o.textRotation),o.indent&&(f.indent=o.indent),o.wrapText&&(f.wrapText=gr(o.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Oz(t){var e=[];return e[e.length]=Ue("cellXfs",null),t.forEach(function(r){e[e.length]=Ue("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ue("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Fz=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,f,d){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(e))&&Rz(x,m,d),(x=u.match(a))&&Nz(x,m,f,d),(x=u.match(n))&&Cz(x,m,f,d),(x=u.match(i))&&kz(x,m,f,d),(x=u.match(r))&&Dz(x,m,d),m}})();function kN(t,e){var r=[zr,Ue("styleSheet",null,{xmlns:ac[0],"xmlns:vt":ln.vt})],n;return t.SSF&&(n=Iz(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Oz(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Mz(t,e){var r=t.read_shift(2),n=Vn(t);return[r,n]}function Pz(t,e,r){r||(r=Se(6+4*e.length)),r.write_shift(2,t),xn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function jz(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=vB(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var u=t.read_shift(1);u>0&&(n.family=u);var f=t.read_shift(1);switch(f>0&&(n.charset=f),t.l++,n.color=xB(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Vn(t),n}function Lz(t,e){e||(e=Se(153)),e.write_shift(2,t.sz*20),yB(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Bm(t.color,e);var n=0;return n=2,e.write_shift(1,n),xn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Bz=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rx,Vz=zn;function vS(t,e){e||(e=Se(84)),rx||(rx=Sp(Bz));var r=rx[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Bm({auto:1},e),Bm({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Uz(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function CN(t,e,r){r||(r=Se(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Bf(t,e){return e||(e=Se(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var zz=zn;function Hz(t,e){return e||(e=Se(51)),e.write_shift(1,0),Bf(null,e),Bf(null,e),Bf(null,e),Bf(null,e),Bf(null,e),e.length>e.l?e.slice(0,e.l):e}function Gz(t,e){return e||(e=Se(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Lm(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function qz(t,e,r){var n=Se(2052);return n.write_shift(4,t),Lm(e,n),Lm(r,n),n.length>n.l?n.slice(0,n.l):n}function Wz(t,e,r){var n={};n.NumberFmt=[];for(var a in lt)n.NumberFmt[a]=lt[a];n.CellXf=[],n.Fonts=[];var i=[],o=!1;return Vi(t,function(f,d,m){switch(m){case 44:n.NumberFmt[f[0]]=f[1],Ci(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(f.color.rgb=zm(e.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:i.push(m),o=!0;break;case 38:i.pop(),o=!1;break;default:if(d.T>0)i.push(m);else if(d.T<0)i.pop();else if(!o||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}function Xz(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Me(t,615,bs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Me(t,44,Pz(a,e[a]))}),Me(t,616))}}function Yz(t){var e=1;Me(t,611,bs(e)),Me(t,43,Lz({sz:12,color:{theme:1},name:"Calibri",family:2})),Me(t,612)}function $z(t){var e=2;Me(t,603,bs(e)),Me(t,45,vS({patternType:"none"})),Me(t,45,vS({patternType:"gray125"})),Me(t,604)}function Kz(t){var e=1;Me(t,613,bs(e)),Me(t,46,Hz()),Me(t,614)}function Qz(t){var e=1;Me(t,626,bs(e)),Me(t,47,CN({numFmtId:0},65535)),Me(t,627)}function Jz(t,e){Me(t,617,bs(e.length)),e.forEach(function(r){Me(t,47,CN(r,0))}),Me(t,618)}function Zz(t){var e=1;Me(t,619,bs(e)),Me(t,48,Gz({xfId:0,name:"Normal"})),Me(t,620)}function eH(t){var e=0;Me(t,505,bs(e)),Me(t,506)}function tH(t){var e=0;Me(t,508,qz(e,"TableStyleMedium9","PivotStyleMedium4")),Me(t,509)}function rH(t,e){var r=fa();return Me(r,278),Xz(r,t.SSF),Yz(r),$z(r),Kz(r),Qz(r),Jz(r,e.cellXfs),Zz(r),eH(r),tH(r),Me(r,279),r.end()}var nH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function aH(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Hn)||[]).forEach(function(a){var i=ut(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[nH.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function sH(){}function iH(){}var lH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,oH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,cH=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function uH(t,e,r){e.themeElements={};var n;[["clrScheme",lH,aH],["fontScheme",oH,sH],["fmtScheme",cH,iH]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var fH=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function NN(t,e){(!t||t.length===0)&&(t=zy());var r,n={};if(!(r=t.match(fH)))throw new Error("themeElements not found in theme");return uH(r[0],n,e),n.raw=t,n}function zy(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[zr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function hH(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var o;try{o=wC(i,{type:"array"})}catch{return}var u=ka(o,"theme/theme/theme1.xml",!0);if(u)return NN(u,r)}}function dH(t){return t.read_shift(4)}function mH(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=pH(t,4);break;case 2:e.xclrValue=oN(t);break;case 3:e.xclrValue=dH(t);break;case 4:t.l+=4;break}return t.l+=8,e}function pH(t,e){return zn(t,e)}function gH(t,e){return zn(t,e)}function xH(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=mH(t);break;case 6:n[1]=gH(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function vH(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),i=[];a-- >0;)i.push(xH(t,r-t.l));return{ixfe:n,ext:i}}function yH(t,e){e.forEach(function(r){r[0]})}function _H(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Vn(t)}}function wH(t){var e=Se(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),xn(t.name,e),e.slice(0,e.l)}function bH(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function EH(t){var e=Se(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function TH(t,e){var r=Se(8+2*e.length);return r.write_shift(4,t),xn(e,r),r.slice(0,r.l)}function SH(t){return t.l+=4,t.read_shift(4)!=0}function AH(t,e){var r=Se(8);return r.write_shift(4,t),r.write_shift(4,1),r}function kH(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],o=!1,u=2;return Vi(t,function(f,d,m){switch(m){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(x){u==1?n.Cell.push({type:n.Types[x[0]-1].name,index:x[1]}):u==0&&n.Value.push({type:n.Types[x[0]-1].name,index:x[1]})});break;case 337:u=f?1:0;break;case 338:u=2;break;case 35:i.push(m),o=!0;break;case 36:i.pop(),o=!1;break;default:if(!d.T){if(!o||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function CH(){var t=fa();return Me(t,332),Me(t,334,bs(1)),Me(t,335,wH({name:"XLDAPR",version:12e4,flags:3496657072})),Me(t,336),Me(t,339,TH(1,"XLDAPR")),Me(t,52),Me(t,35,bs(514)),Me(t,4096,bs(0)),Me(t,4097,Ka(1)),Me(t,36),Me(t,53),Me(t,340),Me(t,337,AH(1)),Me(t,51,EH([[1,0]])),Me(t,338),Me(t,333),t.end()}function NH(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,i=2,o;return t.replace(Hn,function(u){var f=ut(u);switch(Ks(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(o=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):i==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return u}),n}function RN(){var t=[zr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function RH(t){var e=[];if(!t)return e;var r=1;return(t.match(Hn)||[]).forEach(function(n){var a=ut(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function IH(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ot(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function DH(t,e,r){var n=[];return Vi(t,function(i,o,u){switch(u){case 63:n.push(i);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function OH(t,e,r,n){if(!t)return t;var a=n||{},i=!1;Vi(t,function(u,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function FH(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var au=1024;function IN(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ue("xml",null,{"xmlns:v":Ta.v,"xmlns:o":Ta.o,"xmlns:x":Ta.x,"xmlns:mv":Ta.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];au<t*1e3;)au+=1e3;return e.forEach(function(i){var o=Sr(i[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var f=u.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Ue("v:fill",f,u),m={on:"t",obscured:"t"};++au,a=a.concat(["<v:shape"+b0({id:"_x0000_s"+au,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Ue("v:shadow",null,m),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",kn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),kn("x:AutoFill","False"),kn("x:Row",String(o.r)),kn("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function yS(t,e,r,n){var a=Array.isArray(t),i;e.forEach(function(o){var u=Sr(o.ref);if(a?(t[u.r]||(t[u.r]=[]),i=t[u.r][u.c]):i=t[o.ref],!i){i={t:"z"},a?t[u.r][u.c]=i:t[o.ref]=i;var f=Lt(t["!ref"]||"BDWGO1000001:A1");f.s.r>u.r&&(f.s.r=u.r),f.e.r<u.r&&(f.e.r=u.r),f.s.c>u.c&&(f.s.c=u.c),f.e.c<u.c&&(f.e.c=u.c);var d=yt(f);d!==t["!ref"]&&(t["!ref"]=d)}i.c||(i.c=[]);var m={a:o.author,t:o.t,r:o.r,T:r};o.h&&(m.h=o.h);for(var x=i.c.length-1;x>=0;--x){if(!r&&i.c[x].T)return;r&&!i.c[x].T&&i.c.splice(x,1)}if(r&&n){for(x=0;x<n.length;++x)if(m.a==n[x].id){m.a=n[x].name||m.a;break}}i.c.push(m)})}function MH(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var f=ut(u[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=Sr(f.ref);if(!(e.sheetRows&&e.sheetRows<=m.r)){var x=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!x&&!!x[1]&&By(x[1])||{r:"",t:"",h:""};d.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),d.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=y.h),n.push(d)}}}}),n}function DN(t){var e=[zr,Ue("comments",null,{xmlns:ac[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var i=tr(a.a);r.indexOf(i)==-1&&(r.push(i),e.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(tr(f.a))),i.push(f.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)e.push(kn("t",tr(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,u=1;u<i.length;++u)o+=`Reply:
    `+i[u]+`
`;e.push(kn("t",tr(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function PH(t,e){var r=[],n=!1,a={},i=0;return t.replace(Hn,function(u,f){var d=ut(u);switch(Ks(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=f+u.length;break;case"</text>":a.t=t.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function jH(t,e,r){var n=[zr,Ue("ThreadedComments",null,{xmlns:ln.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?i=f.id:f.parentId=i,o.ID=f.id,o.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Ue("threadedComment",kn("text",o.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function LH(t,e){var r=[],n=!1;return t.replace(Hn,function(i){var o=ut(i);switch(Ks(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return i}),r}function BH(t){var e=[zr,Ue("personList",null,{xmlns:ln.TCMNT,"xmlns:x":ac[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ue("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function VH(t){var e={};e.iauthor=t.read_shift(4);var r=oc(t);return e.rfx=r.s,e.ref=ot(r.s),t.l+=16,e}function UH(t,e){return e==null&&(e=Se(36)),e.write_shift(4,t[1].iauthor),Bu(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var zH=Vn;function HH(t){return xn(t.slice(0,54))}function GH(t,e){var r=[],n=[],a={},i=!1;return Vi(t,function(u,f,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function qH(t){var e=fa(),r=[];return Me(e,628),Me(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Me(e,632,HH(a.a)))})}),Me(e,631),Me(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:Sr(n[0]),e:Sr(n[0])};Me(e,635,UH([i,a])),a.t&&a.t.length>0&&Me(e,637,dB(a)),Me(e,636),delete a.iauthor})}),Me(e,634),Me(e,629),e.end()}var WH="application/vnd.ms-office.vbaProject";function XH(t){var e=nt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");nt.utils.cfb_add(e,a,t.FileIndex[n].content)}}),nt.write(e)}function YH(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&nt.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var ON=["xlsb","xlsm","xlam","biff8","xla"];function $H(){return{"!type":"dialog"}}function KH(){return{"!type":"dialog"}}function QH(){return{"!type":"macro"}}function JH(){return{"!type":"macro"}}var fu=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,i,o){var u=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return u?m+=e.c:--m,f?d+=e.r:--d,a+(u?"":"$")+Tr(m)+(f?"":"$")+Ur(d)}return function(a,i){return e=i,a.replace(t,r)}})(),Hy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Gy=(function(){return function(e,r){return e.replace(Hy,function(n,a,i,o,u,f){var d=Ry(o)-(i?0:r.c),m=Ny(f)-(u?0:r.r),x=m==0?"":u?m+1:"["+m+"]",y=d==0?"":i?d+1:"["+d+"]";return a+"R"+x+"C"+y})}})();function FN(t,e){return t.replace(Hy,function(r,n,a,i,o,u){return n+(a=="$"?a+i:Tr(Ry(i)+e.c))+(o=="$"?o+u:Ur(Ny(u)+e.r))})}function ZH(t,e,r){var n=ha(e),a=n.s,i=Sr(r),o={r:i.r-a.r,c:i.c-a.c};return FN(t,o)}function eG(t){return t.length!=1}function _S(t){return t.replace(/_xlfn\./g,"")}function Qr(t){t.l+=1}function $l(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function MN(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return PN(t);r.biff==12&&(n=4)}var a=t.read_shift(n),i=t.read_shift(n),o=$l(t),u=$l(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:u[0],cRel:u[1],rRel:u[2]}}}function PN(t){var e=$l(t),r=$l(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function tG(t,e,r){if(r.biff<8)return PN(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),i=$l(t),o=$l(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function jN(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return rG(t);var n=t.read_shift(r&&r.biff==12?4:2),a=$l(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function rG(t){var e=$l(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function nG(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function aG(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return sG(t);var a=t.read_shift(n>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,u=(i&32768)>>15;if(i&=16383,u==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:u}}function sG(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function iG(t,e,r){var n=(t[t.l++]&96)>>5,a=MN(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function lG(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=MN(t,i,r);return[n,a,o]}function oG(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function cG(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,a]}function uG(t,e,r){var n=(t[t.l++]&96)>>5,a=tG(t,e-1,r);return[n,a]}function fG(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function wS(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function hG(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function dG(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function mG(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function pG(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function gG(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function LN(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function xG(t){return t.read_shift(2),LN(t)}function vG(t){return t.read_shift(2),LN(t)}function yG(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=jN(t,0,r);return[n,a]}function _G(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=aG(t,0,r);return[n,a]}function wG(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=jN(t,0,r);return[n,a,i]}function bG(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[Sq[a],UN[a],n]}function EG(t,e,r){var n=t[t.l++],a=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:TG(t);return[a,(i[0]===0?UN:Tq)[i[1]]]}function TG(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function SG(t,e,r){t.l+=r&&r.biff==2?3:4}function AG(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function kG(t){return t.l++,Ui[t.read_shift(1)]}function CG(t){return t.l++,t.read_shift(2)}function NG(t){return t.l++,t.read_shift(1)!==0}function RG(t){return t.l++,Bn(t)}function IG(t,e,r){return t.l++,th(t,e-1,r)}function DG(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=jr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ui[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Bn(t);break;case 2:r[1]=cc(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function OG(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?oc:Cp)(t));return a}function FG(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,o=[];i!=n&&(o[i]=[]);++i)for(var u=0;u!=a;++u)o[i][u]=DG(t,r.biff);return o}function MG(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function PG(t,e,r){if(r.biff==5)return jG(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[n,a,i]}function jG(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function LG(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function BG(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function VG(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function UG(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,a]}var zG=zn,HG=zn,GG=zn;function nh(t,e,r){return t.l+=2,[nG(t)]}function qy(t){return t.l+=6,[]}var qG=nh,WG=qy,XG=qy,YG=nh;function BN(t){return t.l+=2,[en(t),t.read_shift(2)&1]}var $G=nh,KG=BN,QG=qy,JG=nh,ZG=nh,eq=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function tq(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),o=eq[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:a,C:i}}function rq(t){return t.l+=2,[t.read_shift(4)]}function nq(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function aq(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function sq(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function iq(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function lq(t){return t.l+=4,[0,0]}var bS={1:{n:"PtgExp",f:AG},2:{n:"PtgTbl",f:GG},3:{n:"PtgAdd",f:Qr},4:{n:"PtgSub",f:Qr},5:{n:"PtgMul",f:Qr},6:{n:"PtgDiv",f:Qr},7:{n:"PtgPower",f:Qr},8:{n:"PtgConcat",f:Qr},9:{n:"PtgLt",f:Qr},10:{n:"PtgLe",f:Qr},11:{n:"PtgEq",f:Qr},12:{n:"PtgGe",f:Qr},13:{n:"PtgGt",f:Qr},14:{n:"PtgNe",f:Qr},15:{n:"PtgIsect",f:Qr},16:{n:"PtgUnion",f:Qr},17:{n:"PtgRange",f:Qr},18:{n:"PtgUplus",f:Qr},19:{n:"PtgUminus",f:Qr},20:{n:"PtgPercent",f:Qr},21:{n:"PtgParen",f:Qr},22:{n:"PtgMissArg",f:Qr},23:{n:"PtgStr",f:IG},26:{n:"PtgSheet",f:nq},27:{n:"PtgEndSheet",f:aq},28:{n:"PtgErr",f:kG},29:{n:"PtgBool",f:NG},30:{n:"PtgInt",f:CG},31:{n:"PtgNum",f:RG},32:{n:"PtgArray",f:fG},33:{n:"PtgFunc",f:bG},34:{n:"PtgFuncVar",f:EG},35:{n:"PtgName",f:MG},36:{n:"PtgRef",f:yG},37:{n:"PtgArea",f:iG},38:{n:"PtgMemArea",f:LG},39:{n:"PtgMemErr",f:zG},40:{n:"PtgMemNoMem",f:HG},41:{n:"PtgMemFunc",f:BG},42:{n:"PtgRefErr",f:VG},43:{n:"PtgAreaErr",f:oG},44:{n:"PtgRefN",f:_G},45:{n:"PtgAreaN",f:uG},46:{n:"PtgMemAreaN",f:sq},47:{n:"PtgMemNoMemN",f:iq},57:{n:"PtgNameX",f:PG},58:{n:"PtgRef3d",f:wG},59:{n:"PtgArea3d",f:lG},60:{n:"PtgRefErr3d",f:UG},61:{n:"PtgAreaErr3d",f:cG},255:{}},oq={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},cq={1:{n:"PtgElfLel",f:BN},2:{n:"PtgElfRw",f:JG},3:{n:"PtgElfCol",f:qG},6:{n:"PtgElfRwV",f:ZG},7:{n:"PtgElfColV",f:YG},10:{n:"PtgElfRadical",f:$G},11:{n:"PtgElfRadicalS",f:QG},13:{n:"PtgElfColS",f:WG},15:{n:"PtgElfColSV",f:XG},16:{n:"PtgElfRadicalLel",f:KG},25:{n:"PtgList",f:tq},29:{n:"PtgSxName",f:rq},255:{}},uq={0:{n:"PtgAttrNoop",f:lq},1:{n:"PtgAttrSemi",f:gG},2:{n:"PtgAttrIf",f:mG},4:{n:"PtgAttrChoose",f:hG},8:{n:"PtgAttrGoto",f:dG},16:{n:"PtgAttrSum",f:SG},32:{n:"PtgAttrBaxcel",f:wS},33:{n:"PtgAttrBaxcel",f:wS},64:{n:"PtgAttrSpace",f:xG},65:{n:"PtgAttrSpaceSemi",f:vG},128:{n:"PtgAttrIfError",f:pG},255:{}};function ah(t,e,r,n){if(n.biff<8)return zn(t,e);for(var a=t.l+e,i=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=FG(t,0,n),i.push(r[o][1]);break;case"PtgMemArea":r[o][2]=OG(t,r[o][1],n),i.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),i.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=a-t.l,e!==0&&i.push(zn(t,e)),i}function sh(t,e,r){for(var n=t.l+e,a,i,o=[];n!=t.l;)e=n-t.l,i=t[t.l],a=bS[i]||bS[oq[i]],(i===24||i===25)&&(a=(i===24?cq:uq)[t[t.l+1]]),!a||!a.f?zn(t,e):o.push([a.n,a.f(t,e,r)]);return o}function fq(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],i=0;i<n.length;++i){var o=n[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var hq={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dq(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function VN(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ES(t,e,r){var n=VN(t,e,r);return n=="#REF"?n:dq(n,r)}function Pn(t,e,r,n,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},u=[],f,d,m,x=0,y=0,w,E="";if(!t[0]||!t[0][0])return"";for(var b=-1,T="",I=0,R=t[0].length;I<R;++I){var C=t[0][I];switch(C[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=u.pop(),d=u.pop(),b>=0){switch(t[0][b][1][0]){case 0:T=Rr(" ",t[0][b][1][1]);break;case 1:T=Rr("\r",t[0][b][1][1]);break;default:if(T="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}d=d+T,b=-1}u.push(d+hq[C[0]]+f);break;case"PtgIsect":f=u.pop(),d=u.pop(),u.push(d+" "+f);break;case"PtgUnion":f=u.pop(),d=u.pop(),u.push(d+","+f);break;case"PtgRange":f=u.pop(),d=u.pop(),u.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=t0(C[1][1],o,a),u.push(r0(m,i));break;case"PtgRefN":m=r?t0(C[1][1],r,a):C[1][1],u.push(r0(m,i));break;case"PtgRef3d":x=C[1][1],m=t0(C[1][2],o,a),E=ES(n,x,a),u.push(E+"!"+r0(m,i));break;case"PtgFunc":case"PtgFuncVar":var G=C[1][0],V=C[1][1];G||(G=0),G&=127;var H=G==0?[]:u.slice(-G);u.length-=G,V==="User"&&(V=H.shift()),u.push(V+"("+H.join(",")+")");break;case"PtgBool":u.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(C[1]);break;case"PtgNum":u.push(String(C[1]));break;case"PtgStr":u.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(C[1]);break;case"PtgAreaN":w=JT(C[1][1],r?{s:r}:o,a),u.push(J1(w,a));break;case"PtgArea":w=JT(C[1][1],o,a),u.push(J1(w,a));break;case"PtgArea3d":x=C[1][1],w=C[1][2],E=ES(n,x,a),u.push(E+"!"+J1(w,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=C[1][2];var A=(n.names||[])[y-1]||(n[0]||[])[y],D=A?A.Name:"SH33TJSNAME"+String(y);D&&D.slice(0,6)=="_xlfn."&&!a.xlfn&&(D=D.slice(6)),u.push(D);break;case"PtgNameX":var N=C[1][1];y=C[1][2];var M;if(a.biff<=5)N<0&&(N=-N),n[N]&&(M=n[N][y]);else{var F="";if(((n[N]||[])[0]||[])[0]==14849||(((n[N]||[])[0]||[])[0]==1025?n[N][y]&&n[N][y].itab>0&&(F=n.SheetNames[n[N][y].itab-1]+"!"):F=n.SheetNames[y-1]+"!"),n[N]&&n[N][y])F+=n[N][y].Name;else if(n[0]&&n[0][y])F+=n[0][y].Name;else{var j=(VN(n,N,a)||"").split(";;");j[y-1]?F=j[y-1]:F+="SH33TJSERRX"}u.push(F);break}M||(M={Name:"SH33TJSERRY"}),u.push(M.Name);break;case"PtgParen":var P="(",be=")";if(b>=0){switch(T="",t[0][b][1][0]){case 2:P=Rr(" ",t[0][b][1][1])+P;break;case 3:P=Rr("\r",t[0][b][1][1])+P;break;case 4:be=Rr(" ",t[0][b][1][1])+be;break;case 5:be=Rr("\r",t[0][b][1][1])+be;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][b][1][0])}b=-1}u.push(P+u.pop()+be);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:C[1][1],r:C[1][0]};var ye={c:r.c,r:r.r};if(n.sharedf[ot(m)]){var se=n.sharedf[ot(m)];u.push(Pn(se,o,ye,n,a))}else{var ce=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){u.push(Pn(d[1],o,ye,n,a)),ce=!0;break}ce||u.push(C[1])}break;case"PtgArray":u.push("{"+fq(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=I;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&le.indexOf(t[0][I][0])==-1){C=t[0][b];var te=!0;switch(C[1][0]){case 4:te=!1;case 0:T=Rr(" ",C[1][1]);break;case 5:te=!1;case 1:T=Rr("\r",C[1][1]);break;default:if(T="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}u.push((te?T:"")+u.pop()+(te?"":T)),b=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function mq(t,e,r){var n=t.l+e,a=r.biff==2?1:2,i,o=t.read_shift(a);if(o==65535)return[[],zn(t,e-2)];var u=sh(t,o,r);return e!==o+a&&(i=ah(t,e-o-a,u,r)),t.l=n,[u,i]}function pq(t,e,r){var n=t.l+e,a=r.biff==2?1:2,i,o=t.read_shift(a);if(o==65535)return[[],zn(t,e-2)];var u=sh(t,o,r);return e!==o+a&&(i=ah(t,e-o-a,u,r)),t.l=n,[u,i]}function gq(t,e,r,n){var a=t.l+e,i=sh(t,n,r),o;return a!==t.l&&(o=ah(t,a-t.l,i,r)),[i,o]}function xq(t,e,r){var n=t.l+e,a,i=t.read_shift(2),o=sh(t,i,r);return i==65535?[[],zn(t,e-2)]:(e!==i+2&&(a=ah(t,n-i-2,o,r)),[o,a])}function vq(t){var e;if(Si(t,t.l+6)!==65535)return[Bn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function yq(t){if(t==null){var e=Se(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Ko(t);return Ko(0)}function nx(t,e,r){var n=t.l+e,a=Qs(t);r.biff==2&&++t.l;var i=vq(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=pq(t,n-t.l,r);return{cell:a,val:i[0],formula:u,shared:o>>3&1,tt:i[1]}}function _q(t,e,r,n,a){var i=Jo(e,r,a),o=yq(t.v),u=Se(6),f=33;u.write_shift(2,f),u.write_shift(4,0);for(var d=Se(t.bf.length),m=0;m<t.bf.length;++m)d[m]=t.bf[m];var x=gn([i,o,u,d]);return x}function Np(t,e,r){var n=t.read_shift(4),a=sh(t,n,r),i=t.read_shift(4),o=i>0?ah(t,i,a,r):null;return[a,o]}var wq=Np,Rp=Np,bq=Np,Eq=Np,Tq={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},UN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Sq={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function TS(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Aq(t){var e="of:="+t.replace(Hy,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function ax(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function kq(t){return t.replace(/\./,"!")}var a0={},hu={},s0=typeof Map<"u";function Wy(t,e,r){var n=0,a=t.length;if(r){if(s0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var i=s0?r.get(e):r[e];n<i.length;++n)if(t[i[n]].t===e)return t.Count++,i[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(s0?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function Ip(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Ln=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=k0(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Hm(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function zo(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function ao(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,i=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Ci(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=i;++a)if(t[a].numFmtId===n)return a;return t[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function zN(t,e,r,n,a,i){try{n.cellNF&&(t.z=lt[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=vr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(lt[e]==null&&Ci(T7[e]||"General",e),t.t==="e")t.w=t.w||Ui[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=_0(t.v);else if(t.t==="d"){var o=un(t.v);(o|0)===o?t.w=o.toString(10):t.w=_0(o)}else{if(t.v===void 0)return"";t.w=Yo(t.v,hu)}else t.t==="d"?t.w=es(e,un(t.v),hu):t.w=es(e,t.v,hu)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=zm(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=zm(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&i.Fills)throw u}}}function Cq(t,e,r){if(t&&t["!ref"]){var n=Lt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function Nq(t,e){var r=Lt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=yt(r))}var Rq=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Iq=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Dq=/<(?:\w:)?hyperlink [^>]*>/mg,Oq=/"(\w*:\w*)"/,Fq=/<(?:\w:)?col\b[^>]*[\/]?>/g,Mq=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Pq=/<(?:\w:)?pageMargins[^>]*\/>/g,HN=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,jq=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Lq=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Bq(t,e,r,n,a,i,o){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",x=t.match(Iq);x?(d=t.slice(0,x.index),m=t.slice(x.index+x[0].length)):d=m=t;var y=d.match(HN);y?Xy(y[0],u,a,r):(y=d.match(jq))&&Uq(y[0],y[1]||"",u,a,r);var w=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(w>0){var E=d.slice(w,w+50).match(Oq);E&&Nq(u,E[1])}var b=d.match(Lq);b&&b[1]&&eW(b[1],a);var T=[];if(e.cellStyles){var I=d.match(Fq);I&&$q(T,I)}x&&nW(x[1],u,e,f,i,o);var R=m.match(Mq);R&&(u["!autofilter"]=Qq(R[0]));var C=[],G=m.match(Rq);if(G)for(w=0;w!=G.length;++w)C[w]=Lt(G[w].slice(G[w].indexOf('"')+1));var V=m.match(Dq);V&&Wq(u,V,n);var H=m.match(Pq);if(H&&(u["!margins"]=Xq(ut(H[0]))),!u["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(u["!ref"]=yt(f)),e.sheetRows>0&&u["!ref"]){var A=Lt(u["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>f.e.r&&(A.e.r=f.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>f.e.c&&(A.e.c=f.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),u["!fullref"]=u["!ref"],u["!ref"]=yt(A))}return T.length>0&&(u["!cols"]=T),C.length>0&&(u["!merges"]=C),u}function Vq(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+yt(t[r])+'"/>';return e+"</mergeCells>"}function Xy(t,e,r,n){var a=ut(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=jt(lr(a.codeName)))}function Uq(t,e,r,n,a){Xy(t.slice(0,t.indexOf(">")),r,n,a)}function zq(t,e,r,n,a){var i=!1,o={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var f=e.SheetNames[r];try{e.Workbook&&(f=e.Workbook.Sheets[r].CodeName||f)}catch{}i=!0,o.codeName=Vs(tr(f))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),u=(u||"")+Ue("outlinePr",null,d)}!i&&!u||(a[a.length]=Ue("sheetPr",u,o))}var Hq=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Gq=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function qq(t){var e={sheet:1};return Hq.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Gq.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Vy(t.password).toString(16).toUpperCase()),Ue("sheetProtection",null,e)}function Wq(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var i=ut(lr(e[a]),!0);if(!i.ref)return;var o=((r||{})["!id"]||[])[i.id];o?(i.Target=o.Target,i.location&&(i.Target+="#"+jt(i.location))):(i.Target="#"+jt(i.location),o={Target:i.Target,TargetMode:"Internal"}),i.Rel=o,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var u=Lt(i.ref),f=u.s.r;f<=u.e.r;++f)for(var d=u.s.c;d<=u.e.c;++d){var m=ot({c:d,r:f});n?(t[f]||(t[f]=[]),t[f][d]||(t[f][d]={t:"z",v:void 0}),t[f][d].l=i):(t[m]||(t[m]={t:"z",v:void 0}),t[m].l=i)}}}function Xq(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Yq(t){return zo(t),Ue("pageMargins",null,t)}function $q(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=ut(e[n],!0);a.hidden&&(a.hidden=gr(a.hidden));var i=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Uy(a.width)),Yl(a);i<=o;)t[i++]=yr(a)}}function Kq(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=Ue("col",null,Ip(a,n)));return r[r.length]="</cols>",r.join("")}function Qq(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function Jq(t,e,r,n){var a=typeof t.ref=="string"?t.ref:yt(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=ha(a);o.s.r==o.e.r&&(o.e.r=ha(e["!ref"]).e.r,a=yt(o));for(var u=0;u<i.length;++u){var f=i[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ue("autoFilter",null,{ref:a})}var Zq=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function eW(t,e){e.Views||(e.Views=[{}]),(t.match(Zq)||[]).forEach(function(r,n){var a=ut(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),gr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function tW(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,a),{})}function rW(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Ui[t.v];break;case"d":n&&n.cellDates?a=vr(t.v,-1).toISOString():(t=yr(t),t.t="n",a=""+(t.v=un(vr(t.v)))),typeof t.z>"u"&&(t.z=lt[14]);break;default:a=t.v;break}var u=kn("v",tr(a)),f={r:e},d=ao(n.cellXfs,t,n);switch(d!==0&&(f.s=d),t.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=kn("v",""+Wy(n.Strings,t.v,n.revStrings)),f.t="s";break}f.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var m=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=Ue("f",tr(t.f),m)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(f.cm=1),Ue("c",u,f)}var nW=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=w0("v"),o=w0("f");return function(f,d,m,x,y,w){for(var E=0,b="",T=[],I=[],R=0,C=0,G=0,V="",H,A,D=0,N=0,M,F,j=0,P=0,be=Array.isArray(w.CellXf),ye,se=[],ce=[],le=Array.isArray(d),te=[],_e={},Q=!1,L=!!m.sheetStubs,J=f.split(e),Y=0,ne=J.length;Y!=ne;++Y){b=J[Y].trim();var ue=b.length;if(ue!==0){var Te=0;e:for(E=0;E<ue;++E)switch(b[E]){case">":if(b[E-1]!="/"){++E;break e}if(m&&m.cellStyles){if(A=ut(b.slice(Te,E),!0),D=A.r!=null?parseInt(A.r,10):D+1,N=-1,m.sheetRows&&m.sheetRows<D)continue;_e={},Q=!1,A.ht&&(Q=!0,_e.hpt=parseFloat(A.ht),_e.hpx=Su(_e.hpt)),A.hidden=="1"&&(Q=!0,_e.hidden=!0),A.outlineLevel!=null&&(Q=!0,_e.level=+A.outlineLevel),Q&&(te[D-1]=_e)}break;case"<":Te=E;break}if(Te>=E)break;if(A=ut(b.slice(Te,E),!0),D=A.r!=null?parseInt(A.r,10):D+1,N=-1,!(m.sheetRows&&m.sheetRows<D)){x.s.r>D-1&&(x.s.r=D-1),x.e.r<D-1&&(x.e.r=D-1),m&&m.cellStyles&&(_e={},Q=!1,A.ht&&(Q=!0,_e.hpt=parseFloat(A.ht),_e.hpx=Su(_e.hpt)),A.hidden=="1"&&(Q=!0,_e.hidden=!0),A.outlineLevel!=null&&(Q=!0,_e.level=+A.outlineLevel),Q&&(te[D-1]=_e)),T=b.slice(E).split(t);for(var Re=0;Re!=T.length&&T[Re].trim().charAt(0)=="<";++Re);for(T=T.slice(Re),E=0;E!=T.length;++E)if(b=T[E].trim(),b.length!==0){if(I=b.match(r),R=E,C=0,G=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,I!=null&&I.length===2){for(R=0,V=I[1],C=0;C!=V.length&&!((G=V.charCodeAt(C)-64)<1||G>26);++C)R=26*R+G;--R,N=R}else++N;for(C=0;C!=b.length&&b.charCodeAt(C)!==62;++C);if(++C,A=ut(b.slice(0,C),!0),A.r||(A.r=ot({r:D-1,c:N})),V=b.slice(C),H={t:""},(I=V.match(i))!=null&&I[1]!==""&&(H.v=jt(I[1])),m.cellFormula){if((I=V.match(o))!=null&&I[1]!==""){if(H.f=jt(lr(I[1])).replace(/\r\n/g,`
`),m.xlfn||(H.f=_S(H.f)),I[0].indexOf('t="array"')>-1)H.F=(V.match(a)||[])[1],H.F.indexOf(":")>-1&&se.push([Lt(H.F),H.F]);else if(I[0].indexOf('t="shared"')>-1){F=ut(I[0]);var Ae=jt(lr(I[1]));m.xlfn||(Ae=_S(Ae)),ce[parseInt(F.si,10)]=[F,Ae,A.r]}}else(I=V.match(/<f[^>]*\/>/))&&(F=ut(I[0]),ce[F.si]&&(H.f=ZH(ce[F.si][1],ce[F.si][2],A.r)));var Fe=Sr(A.r);for(C=0;C<se.length;++C)Fe.r>=se[C][0].s.r&&Fe.r<=se[C][0].e.r&&Fe.c>=se[C][0].s.c&&Fe.c<=se[C][0].e.c&&(H.F=se[C][1])}if(A.t==null&&H.v===void 0)if(H.f||H.F)H.v=0,H.t="n";else if(L)H.t="z";else continue;else H.t=A.t||"n";switch(x.s.c>N&&(x.s.c=N),x.e.c<N&&(x.e.c=N),H.t){case"n":if(H.v==""||H.v==null){if(!L)continue;H.t="z"}else H.v=parseFloat(H.v);break;case"s":if(typeof H.v>"u"){if(!L)continue;H.t="z"}else M=a0[parseInt(H.v,10)],H.v=M.t,H.r=M.r,m.cellHTML&&(H.h=M.h);break;case"str":H.t="s",H.v=H.v!=null?lr(H.v):"",m.cellHTML&&(H.h=Sy(H.v));break;case"inlineStr":I=V.match(n),H.t="s",I!=null&&(M=By(I[1]))?(H.v=M.t,m.cellHTML&&(H.h=M.h)):H.v="";break;case"b":H.v=gr(H.v);break;case"d":m.cellDates?H.v=vr(H.v,1):(H.v=un(vr(H.v,1)),H.t="n");break;case"e":(!m||m.cellText!==!1)&&(H.w=H.v),H.v=qC[H.v];break}if(j=P=0,ye=null,be&&A.s!==void 0&&(ye=w.CellXf[A.s],ye!=null&&(ye.numFmtId!=null&&(j=ye.numFmtId),m.cellStyles&&ye.fillId!=null&&(P=ye.fillId))),zN(H,j,P,m,y,w),m.cellDates&&be&&H.t=="n"&&Pu(lt[j])&&(H.t="d",H.v=kp(H.v)),A.cm&&m.xlmeta){var st=(m.xlmeta.Cell||[])[+A.cm-1];st&&st.type=="XLDAPR"&&(H.D=!0)}if(le){var B=Sr(A.r);d[B.r]||(d[B.r]=[]),d[B.r][B.c]=H}else d[A.r]=H}}}}te.length>0&&(d["!rows"]=te)}})();function aW(t,e,r,n){var a=[],i=[],o=Lt(t["!ref"]),u="",f,d="",m=[],x=0,y=0,w=t["!rows"],E=Array.isArray(t),b={r:d},T,I=-1;for(y=o.s.c;y<=o.e.c;++y)m[y]=Tr(y);for(x=o.s.r;x<=o.e.r;++x){for(i=[],d=Ur(x),y=o.s.c;y<=o.e.c;++y){f=m[y]+d;var R=E?(t[x]||[])[y]:t[f];R!==void 0&&(u=rW(R,f,t,e))!=null&&i.push(u)}(i.length>0||w&&w[x])&&(b={r:d},w&&w[x]&&(T=w[x],T.hidden&&(b.hidden=1),I=-1,T.hpx?I=C0(T.hpx):T.hpt&&(I=T.hpt),I>-1&&(b.ht=I,b.customHeight=1),T.level&&(b.outlineLevel=T.level)),a[a.length]=Ue("row",i.join(""),b))}if(w)for(;x<w.length;++x)w&&w[x]&&(b={r:x+1},T=w[x],T.hidden&&(b.hidden=1),I=-1,T.hpx?I=C0(T.hpx):T.hpt&&(I=T.hpt),I>-1&&(b.ht=I,b.customHeight=1),T.level&&(b.outlineLevel=T.level),a[a.length]=Ue("row","",b));return a.join("")}function GN(t,e,r,n){var a=[zr,Ue("worksheet",null,{xmlns:ac[0],"xmlns:r":ln.r})],i=r.SheetNames[t],o=0,u="",f=r.Sheets[i];f==null&&(f={});var d=f["!ref"]||"A1",m=Lt(d);if(m.e.c>16383||m.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),d=yt(m)}n||(n={}),f["!comments"]=[];var x=[];zq(f,r,t,e,a),a[a.length]=Ue("dimension",null,{ref:d}),a[a.length]=tW(f,e,t,r),e.sheetFormat&&(a[a.length]=Ue("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=Kq(f,f["!cols"])),a[o=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(u=aW(f,e),u.length>0&&(a[a.length]=u)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),f["!protect"]&&(a[a.length]=qq(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=Jq(f["!autofilter"],f,r,t)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=Vq(f["!merges"]));var y=-1,w,E=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(b){b[1].Target&&(w={ref:b[0]},b[1].Target.charAt(0)!="#"&&(E=er(n,-1,tr(b[1].Target).replace(/#.*$/,""),St.HLINK),w["r:id"]="rId"+E),(y=b[1].Target.indexOf("#"))>-1&&(w.location=tr(b[1].Target.slice(y+1))),b[1].Tooltip&&(w.tooltip=tr(b[1].Tooltip)),a[a.length]=Ue("hyperlink",null,w))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=Yq(f["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=kn("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:d}))),x.length>0&&(E=er(n,-1,"../drawings/drawing"+(t+1)+".xml",St.DRAW),a[a.length]=Ue("drawing",null,{"r:id":"rId"+E}),f["!drawing"]=x),f["!comments"].length>0&&(E=er(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",St.VML),a[a.length]=Ue("legacyDrawing",null,{"r:id":"rId"+E}),f["!legacy"]=E),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function sW(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function iW(t,e,r){var n=Se(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var i=320;a.hpx?i=C0(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var u=0,f=n.l;n.l+=4;for(var d={r:t,c:0},m=0;m<16;++m)if(!(e.s.c>m+1<<10||e.e.c<m<<10)){for(var x=-1,y=-1,w=m<<10;w<m+1<<10;++w){d.c=w;var E=Array.isArray(r)?(r[d.r]||[])[d.c]:r[ot(d)];E&&(x<0&&(x=w),y=w)}x<0||(++u,n.write_shift(4,x),n.write_shift(4,y))}var b=n.l;return n.l=f,n.write_shift(4,u),n.l=b,n.length>n.l?n.slice(0,n.l):n}function lW(t,e,r,n){var a=iW(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Me(t,0,a)}var oW=oc,cW=Bu;function uW(){}function fW(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=mB(t),r}function hW(t,e,r){r==null&&(r=Se(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Bm({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),VC(t,r),r.slice(0,r.l)}function dW(t){var e=rs(t);return[e]}function mW(t,e,r){return r==null&&(r=Se(8)),sc(e,r)}function pW(t){var e=ic(t);return[e]}function gW(t,e,r){return r==null&&(r=Se(4)),lc(e,r)}function xW(t){var e=rs(t),r=t.read_shift(1);return[e,r,"b"]}function vW(t,e,r){return r==null&&(r=Se(9)),sc(e,r),r.write_shift(1,t.v?1:0),r}function yW(t){var e=ic(t),r=t.read_shift(1);return[e,r,"b"]}function _W(t,e,r){return r==null&&(r=Se(5)),lc(e,r),r.write_shift(1,t.v?1:0),r}function wW(t){var e=rs(t),r=t.read_shift(1);return[e,r,"e"]}function bW(t,e,r){return r==null&&(r=Se(9)),sc(e,r),r.write_shift(1,t.v),r}function EW(t){var e=ic(t),r=t.read_shift(1);return[e,r,"e"]}function TW(t,e,r){return r==null&&(r=Se(8)),lc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function SW(t){var e=rs(t),r=t.read_shift(4);return[e,r,"s"]}function AW(t,e,r){return r==null&&(r=Se(12)),sc(e,r),r.write_shift(4,e.v),r}function kW(t){var e=ic(t),r=t.read_shift(4);return[e,r,"s"]}function CW(t,e,r){return r==null&&(r=Se(8)),lc(e,r),r.write_shift(4,e.v),r}function NW(t){var e=rs(t),r=Bn(t);return[e,r,"n"]}function RW(t,e,r){return r==null&&(r=Se(16)),sc(e,r),Ko(t.v,r),r}function qN(t){var e=ic(t),r=Bn(t);return[e,r,"n"]}function IW(t,e,r){return r==null&&(r=Se(12)),lc(e,r),Ko(t.v,r),r}function DW(t){var e=rs(t),r=Fy(t);return[e,r,"n"]}function OW(t,e,r){return r==null&&(r=Se(12)),sc(e,r),UC(t.v,r),r}function FW(t){var e=ic(t),r=Fy(t);return[e,r,"n"]}function MW(t,e,r){return r==null&&(r=Se(8)),lc(e,r),UC(t.v,r),r}function PW(t){var e=rs(t),r=Iy(t);return[e,r,"is"]}function jW(t){var e=rs(t),r=Vn(t);return[e,r,"str"]}function LW(t,e,r){return r==null&&(r=Se(12+4*t.v.length)),sc(e,r),xn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function BW(t){var e=ic(t),r=Vn(t);return[e,r,"str"]}function VW(t,e,r){return r==null&&(r=Se(8+4*t.v.length)),lc(e,r),xn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function UW(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=t.read_shift(1),o=[a,i,"b"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return o}function zW(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=t.read_shift(1),o=[a,i,"e"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return o}function HW(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=Bn(t),o=[a,i,"n"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return o}function GW(t,e,r){var n=t.l+e,a=rs(t);a.r=r["!row"];var i=Vn(t),o=[a,i,"str"];if(r.cellFormula){t.l+=2;var u=Rp(t,n-t.l,r);o[3]=Pn(u,null,a,r.supbooks,r)}else t.l=n;return o}var qW=oc,WW=Bu;function XW(t,e){return e==null&&(e=Se(4)),e.write_shift(4,t),e}function YW(t,e){var r=t.l+e,n=oc(t),a=Dy(t),i=Vn(t),o=Vn(t),u=Vn(t);t.l=r;var f={rfx:n,relId:a,loc:i,display:u};return o&&(f.Tooltip=o),f}function $W(t,e){var r=Se(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Bu({s:Sr(t[0]),e:Sr(t[0])},r),Oy("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return xn(a||"",r),xn(t[1].Tooltip||"",r),xn("",r),r.slice(0,r.l)}function KW(){}function QW(t,e,r){var n=t.l+e,a=zC(t),i=t.read_shift(1),o=[a];if(o[2]=i,r.cellFormula){var u=wq(t,n-t.l,r);o[1]=u}else t.l=n;return o}function JW(t,e,r){var n=t.l+e,a=oc(t),i=[a];if(r.cellFormula){var o=Eq(t,n-t.l,r);i[1]=o,t.l=n}else t.l=n;return i}function ZW(t,e,r){r==null&&(r=Se(18));var n=Ip(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var WN=["left","right","top","bottom","header","footer"];function eX(t){var e={};return WN.forEach(function(r){e[r]=Bn(t)}),e}function tX(t,e){return e==null&&(e=Se(48)),zo(t),WN.forEach(function(r){Ko(t[r],e)}),e}function rX(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function nX(t,e,r){r==null&&(r=Se(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function aX(t){var e=Se(24);return e.write_shift(4,4),e.write_shift(4,1),Bu(t,e),e}function sX(t,e){return e==null&&(e=Se(66)),e.write_shift(2,t.password?Vy(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function iX(){}function lX(){}function oX(t,e,r,n,a,i,o){if(!t)return t;var u=e||{};n||(n={"!id":{}});var f=u.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,y=!1,w,E,b,T,I,R,C,G,V,H=[];u.biff=12,u["!row"]=0;var A=0,D=!1,N=[],M={},F=u.supbooks||a.supbooks||[[]];if(F.sharedf=M,F.arrayf=N,F.SheetNames=a.SheetNames||a.Sheets.map(function(le){return le.name}),!u.supbooks&&(u.supbooks=F,a.Names))for(var j=0;j<a.Names.length;++j)F[0][j+1]=a.Names[j];var P=[],be=[],ye=!1;N0[16]={n:"BrtShortReal",f:qN};var se;if(Vi(t,function(te,_e,Q){if(!y)switch(Q){case 148:d=te;break;case 0:w=te,u.sheetRows&&u.sheetRows<=w.r&&(y=!0),G=Ur(T=w.r),u["!row"]=w.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=Su(te.hpt)),be[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:te[2]},te[2]){case"n":E.v=te[1];break;case"s":C=a0[te[1]],E.v=C.t,E.r=C.r;break;case"b":E.v=!!te[1];break;case"e":E.v=te[1],u.cellText!==!1&&(E.w=Ui[E.v]);break;case"str":E.t="s",E.v=te[1];break;case"is":E.t="s",E.v=te[1].t;break}if((b=o.CellXf[te[0].iStyleRef])&&zN(E,b.numFmtId,null,u,i,o),I=te[0].c==-1?I+1:te[0].c,u.dense?(f[T]||(f[T]=[]),f[T][I]=E):f[Tr(I)+G]=E,u.cellFormula){for(D=!1,A=0;A<N.length;++A){var L=N[A];w.r>=L[0].s.r&&w.r<=L[0].e.r&&I>=L[0].s.c&&I<=L[0].e.c&&(E.F=yt(L[0]),D=!0)}!D&&te.length>3&&(E.f=te[3])}if(m.s.r>w.r&&(m.s.r=w.r),m.s.c>I&&(m.s.c=I),m.e.r<w.r&&(m.e.r=w.r),m.e.c<I&&(m.e.c=I),u.cellDates&&b&&E.t=="n"&&Pu(lt[b.numFmtId])){var J=Mo(E.v);J&&(E.t="d",E.v=new Date(J.y,J.m-1,J.d,J.H,J.M,J.S,J.u))}se&&(se.type=="XLDAPR"&&(E.D=!0),se=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;E={t:"z",v:void 0},I=te[0].c==-1?I+1:te[0].c,u.dense?(f[T]||(f[T]=[]),f[T][I]=E):f[Tr(I)+G]=E,m.s.r>w.r&&(m.s.r=w.r),m.s.c>I&&(m.s.c=I),m.e.r<w.r&&(m.e.r=w.r),m.e.c<I&&(m.e.c=I),se&&(se.type=="XLDAPR"&&(E.D=!0),se=void 0);break;case 176:H.push(te);break;case 49:se=((u.xlmeta||{}).Cell||[])[te-1];break;case 494:var Y=n["!id"][te.relId];for(Y?(te.Target=Y.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=Y):te.relId==""&&(te.Target="#"+te.loc),T=te.rfx.s.r;T<=te.rfx.e.r;++T)for(I=te.rfx.s.c;I<=te.rfx.e.c;++I)u.dense?(f[T]||(f[T]=[]),f[T][I]||(f[T][I]={t:"z",v:void 0}),f[T][I].l=te):(R=ot({c:I,r:T}),f[R]||(f[R]={t:"z",v:void 0}),f[R].l=te);break;case 426:if(!u.cellFormula)break;N.push(te),V=u.dense?f[T][I]:f[Tr(I)+G],V.f=Pn(te[1],m,{r:w.r,c:I},F,u),V.F=yt(te[0]);break;case 427:if(!u.cellFormula)break;M[ot(te[0].s)]=te[1],V=u.dense?f[T][I]:f[Tr(I)+G],V.f=Pn(te[1],m,{r:w.r,c:I},F,u);break;case 60:if(!u.cellStyles)break;for(;te.e>=te.s;)P[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},ye||(ye=!0,Uy(te.w/256)),Yl(P[te.e+1]);break;case 161:f["!autofilter"]={ref:yt(te)};break;case 476:f["!margins"]=te;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),te.name&&(a.Sheets[r].CodeName=te.name),(te.above||te.left)&&(f["!outline"]={above:te.above,left:te.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),te.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!_e.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+Q.toString(16))}}},u),delete u.supbooks,delete u["!row"],!f["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=yt(d||m)),u.sheetRows&&f["!ref"]){var ce=Lt(f["!ref"]);u.sheetRows<=+ce.e.r&&(ce.e.r=u.sheetRows-1,ce.e.r>m.e.r&&(ce.e.r=m.e.r),ce.e.r<ce.s.r&&(ce.s.r=ce.e.r),ce.e.c>m.e.c&&(ce.e.c=m.e.c),ce.e.c<ce.s.c&&(ce.s.c=ce.e.c),f["!fullref"]=f["!ref"],f["!ref"]=yt(ce))}return H.length>0&&(f["!merges"]=H),P.length>0&&(f["!cols"]=P),be.length>0&&(f["!rows"]=be),f}function cX(t,e,r,n,a,i,o){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=yr(e),e.z=e.z||lt[14],e.v=un(vr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var f={r,c:n};switch(f.s=ao(a.cellXfs,e,a),e.l&&i["!links"].push([ot(f),e.l]),e.c&&i["!comments"].push([ot(f),e.c]),e.t){case"s":case"str":return a.bookSST?(u=Wy(a.Strings,e.v,a.revStrings),f.t="s",f.v=u,o?Me(t,18,CW(e,f)):Me(t,7,AW(e,f))):(f.t="str",o?Me(t,17,VW(e,f)):Me(t,6,LW(e,f))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?Me(t,13,MW(e,f)):Me(t,2,OW(e,f)):o?Me(t,16,IW(e,f)):Me(t,5,RW(e,f)),!0;case"b":return f.t="b",o?Me(t,15,_W(e,f)):Me(t,4,vW(e,f)),!0;case"e":return f.t="e",o?Me(t,14,TW(e,f)):Me(t,3,bW(e,f)),!0}return o?Me(t,12,gW(e,f)):Me(t,1,mW(e,f)),!0}function uX(t,e,r,n){var a=Lt(e["!ref"]||"A1"),i,o="",u=[];Me(t,145);var f=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var m=a.s.r;m<=d;++m){o=Ur(m),lW(t,e,a,m);var x=!1;if(m<=a.e.r)for(var y=a.s.c;y<=a.e.c;++y){m===a.s.r&&(u[y]=Tr(y)),i=u[y]+o;var w=f?(e[m]||[])[y]:e[i];if(!w){x=!1;continue}x=cX(t,w,m,y,n,e,x)}}Me(t,146)}function fX(t,e){!e||!e["!merges"]||(Me(t,177,XW(e["!merges"].length)),e["!merges"].forEach(function(r){Me(t,176,WW(r))}),Me(t,178))}function hX(t,e){!e||!e["!cols"]||(Me(t,390),e["!cols"].forEach(function(r,n){r&&Me(t,60,ZW(n,r))}),Me(t,391))}function dX(t,e){!e||!e["!ref"]||(Me(t,648),Me(t,649,aX(Lt(e["!ref"]))),Me(t,650))}function mX(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=er(r,-1,n[1].Target.replace(/#.*$/,""),St.HLINK);Me(t,494,$W(n,a))}}),delete e["!links"]}function pX(t,e,r,n){if(e["!comments"].length>0){var a=er(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",St.VML);Me(t,551,Oy("rId"+a)),e["!legacy"]=a}}function gX(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],i=typeof a.ref=="string"?a.ref:yt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,u=ha(i);u.s.r==u.e.r&&(u.e.r=ha(e["!ref"]).e.r,i=yt(u));for(var f=0;f<o.length;++f){var d=o[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Me(t,161,Bu(Lt(i))),Me(t,162)}}function xX(t,e,r){Me(t,133),Me(t,137,nX(e,r)),Me(t,138),Me(t,134)}function vX(t,e){e["!protect"]&&Me(t,535,sX(e["!protect"]))}function yX(t,e,r,n){var a=fa(),i=r.SheetNames[t],o=r.Sheets[i]||{},u=i;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var f=Lt(o["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Me(a,129),(r.vbaraw||o["!outline"])&&Me(a,147,hW(u,o["!outline"])),Me(a,148,cW(f)),xX(a,o,r.Workbook),hX(a,o),uX(a,o,t,e),vX(a,o),gX(a,o,r,t),fX(a,o),mX(a,o,n),o["!margins"]&&Me(a,476,tX(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&dX(a,o),pX(a,o,t,n),Me(a,130),a.end()}function _X(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var o=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var a=jt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,a,n]}function wX(t,e,r,n,a,i){var o=i||{"!type":"chart"};if(!t)return i;var u=0,f=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var y=_X(x);m.s.r=m.s.c=0,m.e.c=u,d=Tr(u),y[0].forEach(function(w,E){o[d+Ur(E)]={t:"n",v:w,z:y[1]},f=E}),m.e.r<f&&(m.e.r=f),++u}),u>0&&(o["!ref"]=yt(m)),o}function bX(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o,u=t.match(HN);return u&&Xy(u[0],i,a,r),(o=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=o[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function EX(t,e){t.l+=10;var r=Vn(t);return{name:r}}function TX(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Vi(t,function(f,d,m){switch(m){case 550:i["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Yy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],SX=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],AX=[],kX=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function SS(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var i=e[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=gr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function AS(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=gr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function XN(t){AS(t.WBProps,Yy),AS(t.CalcPr,kX),SS(t.WBView,SX),SS(t.Sheets,AX),hu.date1904=gr(t.WBProps.date1904)}function CX(t){return!t.Workbook||!t.Workbook.WBProps?"false":gr(t.Workbook.WBProps.date1904)?"true":"false"}var NX="][*?/\\".split("");function YN(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return NX.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function RX(t,e,r){t.forEach(function(n,a){YN(n);for(var i=0;i<a;++i)if(n==t[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[a]&&e[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function IX(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];RX(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)Cq(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var DX=/<\w+:workbook/;function OX(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},o=0;if(t.replace(Hn,function(f,d){var m=ut(f);switch(Ks(m[0])){case"<?xml":break;case"<workbook":f.match(DX)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=m[a];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Yy.forEach(function(x){if(m[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=gr(m[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(m[x[0]],10);break;default:r.WBProps[x[0]]=m[x[0]]}}),m.codeName&&(r.WBProps.CodeName=lr(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=jt(lr(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=lr(m.name),m.comment&&(i.Comment=m.comment),m.localSheetId&&(i.Sheet=+m.localSheetId),gr(m.hidden||"0")&&(i.Hidden=!0),o=d+f.length;break;case"</definedName>":i.Ref=jt(lr(t.slice(o,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),ac.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return XN(r),r}function $N(t){var e=[zr];e[e.length]=Ue("workbook",null,{xmlns:ac[0],"xmlns:r":ln.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Yy.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ue("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==t.SheetNames.length&&(i=0),e[e.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:tr(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Ue("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var f={name:u.Name};u.Comment&&(f.comment=u.Comment),u.Sheet!=null&&(f.localSheetId=""+u.Sheet),u.Hidden&&(f.hidden="1"),u.Ref&&(e[e.length]=Ue("definedName",tr(u.Ref),f))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function FX(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Yx(t),r.name=Vn(t),r}function MX(t,e){return e||(e=Se(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Oy(t.strRelID,e),xn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function PX(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?Vn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function jX(t,e){e||(e=Se(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),VC(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function LX(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function BX(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),i=pB(t),o=bq(t,0,r),u=Dy(t);t.l=n;var f={Name:i,Ptg:o};return a<268435455&&(f.Sheet=a),u&&(f.Comment=u),f}function VX(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var i=[],o=[[]];return o.SheetNames=[],o.XTI=[],N0[16]={n:"BrtFRTArchID$",f:LX},Vi(t,function(f,d,m){switch(m){case 156:o.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(e.SID=f.Sheet),f.Ref=Pn(f.Ptg,null,null,o,e),delete e.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,f]):o[0]=[m,f],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(f),o.XTI=o.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(m),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},e),XN(r),r.Names=i,r.supbooks=o,r}function UX(t,e){Me(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Me(t,156,MX(a))}Me(t,144)}function zX(t,e){e||(e=Se(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return xn("SheetJS",e),xn(Dm.version,e),xn(Dm.version,e),xn("7262",e),e.length>e.l?e.slice(0,e.l):e}function HX(t,e){e||(e=Se(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function GX(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Me(t,135),Me(t,158,HX(a)),Me(t,136))}}function qX(t,e){var r=fa();return Me(r,131),Me(r,128,zX()),Me(r,153,jX(t.Workbook&&t.Workbook.WBProps||null)),GX(r,t),UX(r,t),Me(r,132),r.end()}function WX(t,e,r){return e.slice(-4)===".bin"?VX(t,r):OX(t,r)}function XX(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?oX(t,n,r,a,i,o,u):Bq(t,n,r,a,i,o,u)}function YX(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?TX(t,n,r,a,i):bX(t,n,r,a,i)}function $X(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?QH():JH()}function KX(t,e,r,n,a,i,o,u){return e.slice(-4)===".bin"?$H():KH()}function QX(t,e,r,n){return e.slice(-4)===".bin"?Wz(t,r,n):Fz(t,r,n)}function JX(t,e,r){return NN(t,r)}function ZX(t,e,r){return e.slice(-4)===".bin"?ZU(t,r):KU(t,r)}function eY(t,e,r){return e.slice(-4)===".bin"?GH(t,r):MH(t,r)}function tY(t,e,r){return e.slice(-4)===".bin"?DH(t):RH(t)}function rY(t,e,r,n){return r.slice(-4)===".bin"?OH(t,e,r,n):void 0}function nY(t,e,r){return e.slice(-4)===".bin"?kH(t,e,r):NH(t,e,r)}function aY(t,e,r){return(e.slice(-4)===".bin"?qX:$N)(t)}function sY(t,e,r,n,a){return(e.slice(-4)===".bin"?yX:GN)(t,r,n,a)}function iY(t,e,r){return(e.slice(-4)===".bin"?rH:kN)(t,r)}function lY(t,e,r){return(e.slice(-4)===".bin"?rz:yN)(t,r)}function oY(t,e,r){return(e.slice(-4)===".bin"?qH:DN)(t)}function cY(t){return(t.slice(-4)===".bin"?CH:RN)()}var KN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,QN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ps(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(KN),i,o,u,f;if(a)for(f=0;f!=a.length;++f)i=a[f].match(QN),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?u="xmlns"+i[1].slice(6):u=i[1].slice(o+1),n[u]=i[2].slice(1,i[2].length-1));return n}function uY(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(KN),a,i,o,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(QN),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),r[o]=a[2].slice(1,a[2].length-1));return r}var i0;function fY(t,e){var r=i0[t]||jt(t);return r==="General"?Yo(e):es(r,e)}function hY(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=gr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=vr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[jt(e)]=a}function dY(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ui[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=_0(t.v):t.w=Yo(t.v):t.w=fY(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=i0[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Pu(n)){var a=Mo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function mY(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=Az[n.Pattern]||n.Pattern)}t[e.ID]=e}function pY(t,e,r,n,a,i,o,u,f,d){var m="General",x=n.StyleID,y={};d=d||{};var w=[],E=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&o&&(x=o.StyleID);i[x]!==void 0&&(i[x].nf&&(m=i[x].nf),i[x].Interior&&w.push(i[x].Interior),!!i[x].Parent);)x=i[x].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=gr(t);break;case"String":n.t="s",n.r=HT(jt(t)),n.v=t.indexOf("<")>-1?jt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(vr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=jt(t):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=qC[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=HT(e||t));break}if(dY(n,m,d),d.cellFormula!==!1)if(n.Formula){var b=jt(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=fu(b,a),delete n.Formula,n.ArrayRange=="RC"?n.F=fu("RC:RC",a):n.ArrayRange&&(n.F=fu(n.ArrayRange,a),f.push([Lt(n.F),n.F]))}else for(E=0;E<f.length;++E)a.r>=f[E][0].s.r&&a.r<=f[E][0].e.r&&a.c>=f[E][0].s.c&&a.c<=f[E][0].e.c&&(n.F=f[E][1]);d.cellStyles&&(w.forEach(function(T){!y.patternType&&T.patternType&&(y.patternType=T.patternType)}),n.s=y),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function gY(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function sx(t,e){var r=e||{};ju();var n=qf(Ay(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=lr(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=yr(r);return o.type="string",Tu.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ht){a.indexOf("<"+ht)>=0&&(i=!0)}),i)return t$(n,r);i0={"General Number":"General","General Date":lt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":lt[15],"Short Date":lt[14],"Long Time":lt[19],"Medium Time":lt[18],"Short Time":lt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:lt[2],Standard:lt[4],Percent:lt[10],Scientific:lt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,f=[],d,m={},x=[],y=r.dense?[]:{},w="",E={},b={},T=ps('<Data ss:Type="String">'),I=0,R=0,C=0,G={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},H={},A="",D=0,N=[],M={},F={},j=0,P=[],be=[],ye={},se=[],ce,le=!1,te=[],_e=[],Q={},L=0,J=0,Y={Sheets:[],WBProps:{date1904:!1}},ne={};E0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ue="";u=E0.exec(n);)switch(u[3]=(ue=u[3]).toLowerCase()){case"data":if(ue=="data"){if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break}if(f[f.length-1][1])break;u[1]==="/"?pY(n.slice(I,u.index),A,T,f[f.length-1][0]=="comment"?ye:E,{c:R,r:C},V,se[R],b,te,r):(A="",T=ps(u[0]),I=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(be.length>0&&(E.c=be),(!r.sheetRows||r.sheetRows>C)&&E.v!==void 0&&(r.dense?(y[C]||(y[C]=[]),y[C][R]=E):y[Tr(R)+Ur(C)]=E),E.HRef&&(E.l={Target:jt(E.HRef)},E.HRefScreenTip&&(E.l.Tooltip=E.HRefScreenTip),delete E.HRef,delete E.HRefScreenTip),(E.MergeAcross||E.MergeDown)&&(L=R+(parseInt(E.MergeAcross,10)|0),J=C+(parseInt(E.MergeDown,10)|0),N.push({s:{c:R,r:C},e:{c:L,r:J}})),!r.sheetStubs)E.MergeAcross?R=L+1:++R;else if(E.MergeAcross||E.MergeDown){for(var Te=R;Te<=L;++Te)for(var Re=C;Re<=J;++Re)(Te>R||Re>C)&&(r.dense?(y[Re]||(y[Re]=[]),y[Re][Te]={t:"z"}):y[Tr(Te)+Ur(Re)]={t:"z"});R=L+1}else++R;else E=uY(u[0]),E.Index&&(R=+E.Index-1),R<G.s.c&&(G.s.c=R),R>G.e.c&&(G.e.c=R),u[0].slice(-2)==="/>"&&++R,be=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(C<G.s.r&&(G.s.r=C),C>G.e.r&&(G.e.r=C),u[0].slice(-2)==="/>"&&(b=ps(u[0]),b.Index&&(C=+b.Index-1)),R=0,++C):(b=ps(u[0]),b.Index&&(C=+b.Index-1),Q={},(b.AutoFitHeight=="0"||b.Height)&&(Q.hpx=parseInt(b.Height,10),Q.hpt=C0(Q.hpx),_e[C]=Q),b.Hidden=="1"&&(Q.hidden=!0,_e[C]=Q));break;case"worksheet":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));x.push(w),G.s.r<=G.e.r&&G.s.c<=G.e.c&&(y["!ref"]=yt(G),r.sheetRows&&r.sheetRows<=G.e.r&&(y["!fullref"]=y["!ref"],G.e.r=r.sheetRows-1,y["!ref"]=yt(G))),N.length&&(y["!merges"]=N),se.length>0&&(y["!cols"]=se),_e.length>0&&(y["!rows"]=_e),m[w]=y}else G={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=R=0,f.push([u[3],!1]),d=ps(u[0]),w=jt(d.Name),y=r.dense?[]:{},N=[],te=[],_e=[],ne={name:w,Hidden:0},Y.Sheets.push(ne);break;case"table":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;f.push([u[3],!1]),se=[],le=!1}break;case"style":u[1]==="/"?mY(V,H,r):H=ps(u[0]);break;case"numberformat":H.nf=jt(ps(u[0]).Format||"General"),i0[H.nf]&&(H.nf=i0[H.nf]);for(var Ae=0;Ae!=392&&lt[Ae]!=H.nf;++Ae);if(Ae==392){for(Ae=57;Ae!=392;++Ae)if(lt[Ae]==null){Ci(H.nf,Ae);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(ce=ps(u[0]),ce.Hidden&&(ce.hidden=!0,delete ce.Hidden),ce.Width&&(ce.wpx=parseInt(ce.Width,10)),!le&&ce.wpx>10){le=!0,Ln=SN;for(var Fe=0;Fe<se.length;++Fe)se[Fe]&&Yl(se[Fe])}le&&Yl(ce),se[ce.Index-1||se.length]=ce;for(var st=0;st<+ce.Span;++st)se[se.length]=yr(ce);break;case"namedrange":if(u[1]==="/")break;Y.Names||(Y.Names=[]);var B=ut(u[0]),Xe={Name:B.Name,Ref:fu(B.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(Xe.Sheet=Y.Sheets.length-1),Y.Names.push(Xe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?A+=n.slice(D,u.index):D=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;H.Interior=ps(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?VB(M,ue,n.slice(j,u.index)):j=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else f.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));gY(ye),be.push(ye)}else f.push([u[3],!1]),d=ps(u[0]),ye={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Pe=ps(u[0]);y["!autofilter"]={ref:fu(Pe.Range).replace(/\$/g,"")},f.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=f.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&f.push([u[3],!0]);break;case"null":break;default:if(f.length==0&&u[3]=="document"||f.length==0&&u[3]=="uof")return IS(n,r);var et=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:et=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:et=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:et=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:et=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(j,u.index)){case"SheetHidden":ne.Hidden=1;break;case"SheetVeryHidden":ne.Hidden=2;break}else j=u.index+u[0].length;break;case"header":y["!margins"]||zo(y["!margins"]={},"xlml"),isNaN(+ut(u[0]).Margin)||(y["!margins"].header=+ut(u[0]).Margin);break;case"footer":y["!margins"]||zo(y["!margins"]={},"xlml"),isNaN(+ut(u[0]).Margin)||(y["!margins"].footer=+ut(u[0]).Margin);break;case"pagemargins":var We=ut(u[0]);y["!margins"]||zo(y["!margins"]={},"xlml"),isNaN(+We.Top)||(y["!margins"].top=+We.Top),isNaN(+We.Left)||(y["!margins"].left=+We.Left),isNaN(+We.Right)||(y["!margins"].right=+We.Right),isNaN(+We.Bottom)||(y["!margins"].bottom=+We.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:et=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:et=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:et=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:et=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:et=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:et=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:et=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:et=!1}break;case"smarttags":break;default:et=!1;break}if(et||u[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?hY(F,ue,P,n.slice(j,u.index)):(P=u,j=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+f.join("|")}var je={};return!r.bookSheets&&!r.bookProps&&(je.Sheets=m),je.SheetNames=x,je.Workbook=Y,je.SSF=yr(lt),je.Props=M,je.Custprops=F,je}function tv(t,e){switch(Ky(e=e||{}),e.type||"base64"){case"base64":return sx(Ia(t),e);case"binary":case"buffer":case"file":return sx(t,e);case"array":return sx(ro(t),e)}}function xY(t,e){var r=[];return t.Props&&r.push(UB(t.Props,e)),t.Custprops&&r.push(zB(t.Props,t.Custprops)),r.join("")}function vY(){return""}function yY(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var i=[];i.push(Ue("NumberFormat",null,{"ss:Format":tr(lt[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Ue("Style",i.join(""),o))}),Ue("Styles",r.join(""))}function JN(t){return Ue("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Gy(t.Ref,{r:0,c:0})})}function _Y(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(JN(a)))}return Ue("Names",r.join(""))}function wY(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],o=0;o<a.length;++o){var u=a[o];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||i.push(JN(u)))}return i.join("")}function bY(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Ue("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Ue("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Ue("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ue("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(kn("ProtectContents","True")),t["!protect"].objects&&a.push(kn("ProtectObjects","True")),t["!protect"].scenarios&&a.push(kn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(kn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(kn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Ue("WorksheetOptions",a.join(""),{xmlns:Ta.x})}function EY(t){return t.map(function(e){var r=G7(e.t||""),n=Ue("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ue("Comment",n,{"ss:Author":e.a})}).join("")}function TY(t,e,r,n,a,i,o){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+tr(Gy(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var f=Sr(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(f.r==o.r?"":"["+(f.r-o.r)+"]")+"C"+(f.c==o.c?"":"["+(f.c-o.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=tr(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=tr(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],m=0;m!=d.length;++m)d[m].s.c!=o.c||d[m].s.r!=o.r||(d[m].e.c>d[m].s.c&&(u["ss:MergeAcross"]=d[m].e.c-d[m].s.c),d[m].e.r>d[m].s.r&&(u["ss:MergeDown"]=d[m].e.r-d[m].s.r));var x="",y="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":x="Number",y=String(t.v);break;case"b":x="Boolean",y=t.v?"1":"0";break;case"e":x="Error",y=Ui[t.v];break;case"d":x="DateTime",y=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||lt[14]);break;case"s":x="String",y=H7(t.v||"");break}var w=ao(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+w),u["ss:Index"]=o.c+1;var E=t.v!=null?y:"",b=t.t=="z"?"":'<Data ss:Type="'+x+'">'+E+"</Data>";return(t.c||[]).length>0&&(b+=EY(t.c)),Ue("Cell",b,u)}function SY(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Su(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function AY(t,e,r,n){if(!t["!ref"])return"";var a=Lt(t["!ref"]),i=t["!merges"]||[],o=0,u=[];t["!cols"]&&t["!cols"].forEach(function(T,I){Yl(T);var R=!!T.width,C=Ip(I,T),G={"ss:Index":I+1};R&&(G["ss:Width"]=A0(C.width)),T.hidden&&(G["ss:Hidden"]="1"),u.push(Ue("Column",null,G))});for(var f=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var m=[SY(d,(t["!rows"]||[])[d])],x=a.s.c;x<=a.e.c;++x){var y=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>x)&&!(i[o].s.r>d)&&!(i[o].e.c<x)&&!(i[o].e.r<d)){(i[o].s.c!=x||i[o].s.r!=d)&&(y=!0);break}if(!y){var w={r:d,c:x},E=ot(w),b=f?(t[d]||[])[x]:t[E];m.push(TY(b,E,t,e,r,n,w))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function kY(t,e,r){var n=[],a=r.SheetNames[t],i=r.Sheets[a],o=i?wY(i,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=i?AY(i,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(bY(i,e,t,r)),n.join("")}function CY(t,e){e||(e={}),t.SSF||(t.SSF=yr(lt)),t.SSF&&(ju(),Tp(t.SSF),e.revssf=Ap(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],ao(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(xY(t,e)),r.push(vY()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ue("Worksheet",kY(n,e,t),{"ss:Name":tr(t.SheetNames[n])}));return r[2]=yY(t,e),r[3]=_Y(t),zr+Ue("Workbook",r.join(""),{xmlns:Ta.ss,"xmlns:o":Ta.o,"xmlns:x":Ta.x,"xmlns:ss":Ta.ss,"xmlns:dt":Ta.dt,"xmlns:html":Ta.html})}function NY(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=_B(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=wB(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var RY=[60,1084,2066,2165,2175];function IY(t,e,r,n,a){var i=n,o=[],u=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}o.push(u),r.l+=i;for(var f=Si(r,r.l),d=rv[f],m=0;d!=null&&RY.indexOf(f)>-1;)i=Si(r,r.l+2),m=r.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),u=r.slice(m,r.l+4+i),o.push(u),r.l+=4+i,d=rv[f=Si(r,r.l)];var x=gn(o);Sn(x,0);var y=0;x.lens=[];for(var w=0;w<o.length;++w)x.lens.push(y),y+=o[w].length;if(x.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+x.length+" < "+n;return e.f(x,x.length,a)}function Ms(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=lt[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ui[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=_0(t.v):t.w=Yo(t.v):t.w=es(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Pu(lt[n]||String(n))){var a=Mo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function qd(t,e,r){return{v:t,ixfe:e,t:r}}function DY(t,e){var r={opts:{}},n={},a=e.dense?[]:{},i={},o={},u=null,f=[],d="",m={},x,y="",w,E,b,T,I={},R=[],C,G,V=[],H=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},N=function(dt){return dt<8?Bo[dt]:dt<64&&H[dt-8]||Bo[dt]},M=function(dt,rr,an){var Mt=rr.XF.data;if(!(!Mt||!Mt.patternType||!an||!an.cellStyles)){rr.s={},rr.s.patternType=Mt.patternType;var or;(or=S0(N(Mt.icvFore)))&&(rr.s.fgColor={rgb:or}),(or=S0(N(Mt.icvBack)))&&(rr.s.bgColor={rgb:or})}},F=function(dt,rr,an){if(!(Q>1)&&!(an.sheetRows&&dt.r>=an.sheetRows)){if(an.cellStyles&&rr.XF&&rr.XF.data&&M(dt,rr,an),delete rr.ixfe,delete rr.XF,x=dt,y=ot(dt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<o.s.r&&(o.s.r=dt.r),dt.c<o.s.c&&(o.s.c=dt.c),dt.r+1>o.e.r&&(o.e.r=dt.r+1),dt.c+1>o.e.c&&(o.e.c=dt.c+1),an.cellFormula&&rr.f){for(var Mt=0;Mt<R.length;++Mt)if(!(R[Mt][0].s.c>dt.c||R[Mt][0].s.r>dt.r)&&!(R[Mt][0].e.c<dt.c||R[Mt][0].e.r<dt.r)){rr.F=yt(R[Mt][0]),(R[Mt][0].s.c!=dt.c||R[Mt][0].s.r!=dt.r)&&delete rr.f,rr.f&&(rr.f=""+Pn(R[Mt][1],o,dt,te,j));break}}an.dense?(a[dt.r]||(a[dt.r]=[]),a[dt.r][dt.c]=rr):a[y]=rr}},j={enc:!1,sbcch:0,snames:[],sharedf:I,arrayf:R,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(j.password=e.password);var P,be=[],ye=[],se=[],ce=[],le=!1,te=[];te.SheetNames=j.snames,te.sharedf=j.sharedf,te.arrayf=j.arrayf,te.names=[],te.XTI=[];var _e=0,Q=0,L=0,J=[],Y=[],ne;j.codepage=1200,ys(1200);for(var ue=!1;t.l<t.length-1;){var Te=t.l,Re=t.read_shift(2);if(Re===0&&_e===10)break;var Ae=t.l===t.length?0:t.read_shift(2),Fe=rv[Re];if(Fe&&Fe.f){if(e.bookSheets&&_e===133&&Re!==133)break;if(_e=Re,Fe.r===2||Fe.r==12){var st=t.read_shift(2);if(Ae-=2,!j.enc&&st!==Re&&((st&255)<<8|st>>8)!==Re)throw new Error("rt mismatch: "+st+"!="+Re);Fe.r==12&&(t.l+=10,Ae-=10)}var B={};if(Re===10?B=Fe.f(t,Ae,j):B=IY(Re,Fe,t,Ae,j),Q==0&&[9,521,1033,2057].indexOf(_e)===-1)continue;switch(Re){case 34:r.opts.Date1904=A.WBProps.date1904=B;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(j.enc||(t.l=0),j.enc=B,!e.password)throw new Error("File is password-protected");if(B.valid==null)throw new Error("Encryption scheme unsupported");if(!B.valid)throw new Error("Password is incorrect");break;case 92:j.lastuser=B;break;case 66:var Xe=Number(B);switch(Xe){case 21010:Xe=1200;break;case 32768:Xe=1e4;break;case 32769:Xe=1252;break}ys(j.codepage=Xe),ue=!0;break;case 317:j.rrtabid=B;break;case 25:j.winlocked=B;break;case 439:r.opts.RefreshAll=B;break;case 12:r.opts.CalcCount=B;break;case 16:r.opts.CalcDelta=B;break;case 17:r.opts.CalcIter=B;break;case 13:r.opts.CalcMode=B;break;case 14:r.opts.CalcPrecision=B;break;case 95:r.opts.CalcSaveRecalc=B;break;case 15:j.CalcRefMode=B;break;case 2211:r.opts.FullCalc=B;break;case 129:B.fDialog&&(a["!type"]="dialog"),B.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),B.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:V.push(B);break;case 430:te.push([B]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(B);break;case 24:case 536:ne={Name:B.Name,Ref:Pn(B.rgce,o,null,te,j)},B.itab>0&&(ne.Sheet=B.itab-1),te.names.push(ne),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(B),B.Name=="_xlnm._FilterDatabase"&&B.itab>0&&B.rgce&&B.rgce[0]&&B.rgce[0][0]&&B.rgce[0][0][0]=="PtgArea3d"&&(Y[B.itab-1]={ref:yt(B.rgce[0][0][1][2])});break;case 22:j.ExternCount=B;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(B),te.XTI=te.XTI.concat(B);break;case 2196:if(j.biff<8)break;ne!=null&&(ne.Comment=B[1]);break;case 18:a["!protect"]=B;break;case 19:B!==0&&j.WTF&&console.error("Password verifier: "+B);break;case 133:i[B.pos]=B,j.snames.push(B.name);break;case 10:{if(--Q)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=yt(o),e.sheetRows&&e.sheetRows<=o.e.r){var Pe=o.e.r;o.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=yt(o),o.e.r=Pe}o.e.r++,o.e.c++}be.length>0&&(a["!merges"]=be),ye.length>0&&(a["!objects"]=ye),se.length>0&&(a["!cols"]=se),ce.length>0&&(a["!rows"]=ce),A.Sheets.push(D)}d===""?m=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(j.biff===8&&(j.biff={9:2,521:3,1033:4}[Re]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[B.BIFFVer]||8),j.biffguess=B.BIFFVer==0,B.BIFFVer==0&&B.dt==4096&&(j.biff=5,ue=!0,ys(j.codepage=28591)),j.biff==8&&B.BIFFVer==0&&B.dt==16&&(j.biff=2),Q++)break;if(a=e.dense?[]:{},j.biff<8&&!ue&&(ue=!0,ys(j.codepage=e.codepage||1252)),j.biff<5||B.BIFFVer==0&&B.dt==4096){d===""&&(d="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var et={pos:t.l-Ae,name:d};i[et.pos]=et,j.snames.push(d)}else d=(i[Te]||{name:""}).name;B.dt==32&&(a["!type"]="chart"),B.dt==64&&(a["!type"]="macro"),be=[],ye=[],j.arrayf=R=[],se=[],ce=[],le=!1,D={Hidden:(i[Te]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[B.r]||[])[B.c]:a[ot({c:B.c,r:B.r})])&&++B.c,C={ixfe:B.ixfe,XF:V[B.ixfe]||{},v:B.val,t:"n"},L>0&&(C.z=J[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),F({c:B.c,r:B.r},C,e);break;case 5:case 517:C={ixfe:B.ixfe,XF:V[B.ixfe],v:B.val,t:B.t},L>0&&(C.z=J[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),F({c:B.c,r:B.r},C,e);break;case 638:C={ixfe:B.ixfe,XF:V[B.ixfe],v:B.rknum,t:"n"},L>0&&(C.z=J[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),F({c:B.c,r:B.r},C,e);break;case 189:for(var We=B.c;We<=B.C;++We){var je=B.rkrec[We-B.c][0];C={ixfe:je,XF:V[je],v:B.rkrec[We-B.c][1],t:"n"},L>0&&(C.z=J[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),F({c:We,r:B.r},C,e)}break;case 6:case 518:case 1030:{if(B.val=="String"){u=B;break}if(C=qd(B.val,B.cell.ixfe,B.tt),C.XF=V[C.ixfe],e.cellFormula){var ht=B.formula;if(ht&&ht[0]&&ht[0][0]&&ht[0][0][0]=="PtgExp"){var _t=ht[0][0][1][0],Ft=ht[0][0][1][1],Hr=ot({r:_t,c:Ft});I[Hr]?C.f=""+Pn(B.formula,o,B.cell,te,j):C.F=((e.dense?(a[_t]||[])[Ft]:a[Hr])||{}).F}else C.f=""+Pn(B.formula,o,B.cell,te,j)}L>0&&(C.z=J[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),F(B.cell,C,e),u=B}break;case 7:case 519:if(u)u.val=B,C=qd(B,u.cell.ixfe,"s"),C.XF=V[C.ixfe],e.cellFormula&&(C.f=""+Pn(u.formula,o,u.cell,te,j)),L>0&&(C.z=J[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),F(u.cell,C,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{R.push(B);var ns=ot(B[0].s);if(w=e.dense?(a[B[0].s.r]||[])[B[0].s.c]:a[ns],e.cellFormula&&w){if(!u||!ns||!w)break;w.f=""+Pn(B[1],o,B[0],te,j),w.F=yt(B[0])}}break;case 1212:{if(!e.cellFormula)break;if(y){if(!u)break;I[ot(u.cell)]=B[0],w=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[ot(u.cell)],(w||{}).f=""+Pn(B[0],o,x,te,j)}}break;case 253:C=qd(f[B.isst].t,B.ixfe,"s"),f[B.isst].h&&(C.h=f[B.isst].h),C.XF=V[C.ixfe],L>0&&(C.z=J[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),F({c:B.c,r:B.r},C,e);break;case 513:e.sheetStubs&&(C={ixfe:B.ixfe,XF:V[B.ixfe],t:"z"},L>0&&(C.z=J[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),F({c:B.c,r:B.r},C,e));break;case 190:if(e.sheetStubs)for(var Gn=B.c;Gn<=B.C;++Gn){var zt=B.ixfe[Gn-B.c];C={ixfe:zt,XF:V[zt],t:"z"},L>0&&(C.z=J[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),F({c:Gn,r:B.r},C,e)}break;case 214:case 516:case 4:C=qd(B.val,B.ixfe,"s"),C.XF=V[C.ixfe],L>0&&(C.z=J[C.ixfe>>8&63]),Ms(C,e,r.opts.Date1904),F({c:B.c,r:B.r},C,e);break;case 0:case 512:Q===1&&(o=B);break;case 252:f=B;break;case 1054:if(j.biff==4){J[L++]=B[1];for(var Gr=0;Gr<L+163&&lt[Gr]!=B[1];++Gr);Gr>=163&&Ci(B[1],L+163)}else Ci(B[1],B[0]);break;case 30:{J[L++]=B;for(var nn=0;nn<L+163&&lt[nn]!=B;++nn);nn>=163&&Ci(B,L+163)}break;case 229:be=be.concat(B);break;case 93:ye[B.cmo[0]]=j.lastobj=B;break;case 438:j.lastobj.TxO=B;break;case 127:j.lastobj.ImData=B;break;case 440:for(T=B[0].s.r;T<=B[0].e.r;++T)for(b=B[0].s.c;b<=B[0].e.c;++b)w=e.dense?(a[T]||[])[b]:a[ot({c:b,r:T})],w&&(w.l=B[1]);break;case 2048:for(T=B[0].s.r;T<=B[0].e.r;++T)for(b=B[0].s.c;b<=B[0].e.c;++b)w=e.dense?(a[T]||[])[b]:a[ot({c:b,r:T})],w&&w.l&&(w.l.Tooltip=B[1]);break;case 28:{if(j.biff<=5&&j.biff>=2)break;w=e.dense?(a[B[0].r]||[])[B[0].c]:a[ot(B[0])];var qn=ye[B[2]];w||(e.dense?(a[B[0].r]||(a[B[0].r]=[]),w=a[B[0].r][B[0].c]={t:"z"}):w=a[ot(B[0])]={t:"z"},o.e.r=Math.max(o.e.r,B[0].r),o.s.r=Math.min(o.s.r,B[0].r),o.e.c=Math.max(o.e.c,B[0].c),o.s.c=Math.min(o.s.c,B[0].c)),w.c||(w.c=[]),E={a:B[1],t:qn.TxO.t},w.c.push(E)}break;case 2173:yH(V[B.ixfe],B.ext);break;case 125:{if(!j.cellStyles)break;for(;B.e>=B.s;)se[B.e--]={width:B.w/256,level:B.level||0,hidden:!!(B.flags&1)},le||(le=!0,Uy(B.w/256)),Yl(se[B.e+1])}break;case 520:{var Xt={};B.level!=null&&(ce[B.r]=Xt,Xt.level=B.level),B.hidden&&(ce[B.r]=Xt,Xt.hidden=!0),B.hpt&&(ce[B.r]=Xt,Xt.hpt=B.hpt,Xt.hpx=Su(B.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||zo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Re]]=B;break;case 161:a["!margins"]||zo(a["!margins"]={}),a["!margins"].header=B.header,a["!margins"].footer=B.footer;break;case 574:B.RTL&&(A.Views[0].RTL=!0);break;case 146:H=B;break;case 2198:P=B;break;case 140:G=B;break;case 442:d?D.CodeName=B||D.name:A.WBProps.CodeName=B||"ThisWorkbook";break}}else Fe||console.error("Missing Info for XLS Record 0x"+Re.toString(16)),t.l+=Ae}return r.SheetNames=Dr(i).sort(function(Or,dt){return Number(Or)-Number(dt)}).map(function(Or){return i[Or].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&Y.forEach(function(Or,dt){r.Sheets[r.SheetNames[dt]]["!autofilter"]=Or}),r.Strings=f,r.SSF=yr(lt),j.enc&&(r.Encryption=j.enc),P&&(r.Themes=P),r.Metadata={},G!==void 0&&(r.Metadata.Country=G),te.names.length>0&&(A.Names=te.names),r.Workbook=A,r}var l0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function OY(t,e,r){var n=nt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=lS(n,$x,l0.DSI);for(var i in a)e[i]=a[i]}catch(d){if(r.WTF)throw d}var o=nt.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var u=lS(o,Kx,l0.SI);for(var f in u)e[f]==null&&(e[f]=u[f])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(QC(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function FY(t,e){var r=[],n=[],a=[],i=0,o,u=jT($x,"n"),f=jT(Kx,"n");if(t.Props)for(o=Dr(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(u,o[i])?r:Object.prototype.hasOwnProperty.call(f,o[i])?n:a).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=Dr(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(u,o[i])?r:Object.prototype.hasOwnProperty.call(f,o[i])?n:a).push([o[i],t.Custprops[o[i]]]);var d=[];for(i=0;i<a.length;++i)aN.indexOf(a[i][0])>-1||KC.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);n.length&&nt.utils.cfb_add(e,"/SummaryInformation",oS(n,l0.SI,f,Kx)),(r.length||d.length)&&nt.utils.cfb_add(e,"/DocumentSummaryInformation",oS(r,l0.DSI,u,$x,d.length?d:null,l0.UDI))}function ZN(t,e){e||(e={}),Ky(e),xy(),e.codepage&&gy(e.codepage);var r,n;if(t.FullPaths){if(nt.find(t,"/encryption"))throw new Error("File is password-protected");r=nt.find(t,"!CompObj"),n=nt.find(t,"/Workbook")||nt.find(t,"/Book")}else{switch(e.type){case"base64":t=Aa(Ia(t));break;case"binary":t=Aa(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Sn(t,0),n={content:t}}var a,i;if(r&&NY(r),e.bookProps&&!e.bookSheets)a={};else{var o=Tt?"buffer":"array";if(n&&n.content)a=DY(n.content,e);else if((i=nt.find(t,"PerfectOffice_MAIN"))&&i.content)a=Uo.to_workbook(i.content,(e.type=o,e));else if((i=nt.find(t,"NativeContent_MAIN"))&&i.content)a=Uo.to_workbook(i.content,(e.type=o,e));else throw(i=nt.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&nt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=XH(t))}var u={};return t.FullPaths&&OY(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}function MY(t,e){var r=e||{},n=nt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return nt.utils.cfb_add(n,a,e3(t,r)),r.biff==8&&(t.Props||t.Custprops)&&FY(t,n),r.biff==8&&t.vbaraw&&YH(n,nt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var N0={0:{f:sW},1:{f:dW},2:{f:DW},3:{f:wW},4:{f:xW},5:{f:NW},6:{f:jW},7:{f:SW},8:{f:GW},9:{f:HW},10:{f:UW},11:{f:zW},12:{f:pW},13:{f:FW},14:{f:EW},15:{f:yW},16:{f:qN},17:{f:BW},18:{f:kW},19:{f:Iy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:BX},40:{},42:{},43:{f:jz},44:{f:Mz},45:{f:Vz},46:{f:zz},47:{f:Uz},48:{},49:{f:oB},50:{},51:{f:bH},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:pN},62:{f:PW},63:{f:IH},64:{f:iX},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:zn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:rX},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:fW},148:{f:oW,p:16},151:{f:KW},152:{},153:{f:PX},154:{},155:{},156:{f:FX},157:{},158:{},159:{T:1,f:JU},160:{T:-1},161:{T:1,f:oc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_H},336:{T:-1},337:{f:SH,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Yx},357:{},358:{},359:{},360:{T:1},361:{},362:{f:mN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:QW},427:{f:JW},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:eX},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:uW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:YW},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Yx},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:zH},633:{T:1},634:{T:-1},635:{T:1,f:VH},636:{T:-1},637:{f:hB},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:EX},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:lX},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},rv={6:{f:nx},10:{f:wl},12:{f:en},13:{f:en},14:{f:jr},15:{f:jr},16:{f:Bn},17:{f:jr},18:{f:jr},19:{f:en},20:{f:mS},21:{f:mS},23:{f:mN},24:{f:gS},25:{f:jr},26:{},27:{},28:{f:lU},29:{},34:{f:jr},35:{f:pS},38:{f:Bn},39:{f:Bn},40:{f:Bn},41:{f:Bn},42:{f:jr},43:{f:jr},47:{f:yz},49:{f:FV},51:{f:en},60:{},61:{f:NV},64:{f:jr},65:{f:OV},66:{f:en},77:{},80:{},81:{},82:{},85:{f:en},89:{},90:{},91:{},92:{f:vV},93:{f:uU},94:{},95:{f:jr},96:{},97:{},99:{f:jr},125:{f:pN},128:{f:$V},129:{f:_V},130:{f:en},131:{f:jr},132:{f:jr},133:{f:wV},134:{},140:{f:vU},141:{f:en},144:{},146:{f:wU},151:{},152:{},153:{},154:{},155:{},156:{f:en},157:{},158:{},160:{f:CU},161:{f:TU},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:qV},190:{f:WV},193:{f:wl},197:{},198:{},199:{},200:{},201:{},202:{f:jr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:en},220:{},221:{f:jr},222:{},224:{f:YV},225:{f:xV},226:{f:wl},227:{},229:{f:oU},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:EV},253:{f:PV},255:{f:SV},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:sN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:jr},353:{f:wl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:eU},431:{f:jr},432:{},433:{},434:{},437:{},438:{f:dU},439:{f:jr},440:{f:mU},441:{},442:{f:rh},443:{},444:{f:en},445:{},446:{},448:{f:wl},449:{f:CV,r:2},450:{f:wl},512:{f:fS},513:{f:kU},515:{f:JV},516:{f:LV},517:{f:dS},519:{f:NU},520:{f:AV},523:{},545:{f:xS},549:{f:uS},566:{},574:{f:IV},638:{f:GV},659:{},1048:{},1054:{f:VV},1084:{},1212:{f:aU},2048:{f:gU},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:zd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:wl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:bU,r:12},2173:{f:vH,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:jr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:nU,r:12},2197:{},2198:{f:hH,r:12},2199:{},2200:{},2201:{},2202:{f:sU,r:12},2203:{f:wl},2204:{},2205:{},2206:{},2207:{},2211:{f:kV},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:en},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:SU},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:_U},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:fS},1:{},2:{f:FU},3:{f:DU},4:{f:IU},5:{f:dS},7:{f:PU},8:{},9:{f:zd},11:{},22:{f:en},30:{f:zV},31:{},32:{},33:{f:xS},36:{},37:{f:uS},50:{f:jU},62:{},52:{},67:{},68:{f:en},69:{},86:{},126:{},127:{f:RU},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:LU},223:{},234:{},354:{},421:{},518:{f:nx},521:{f:zd},536:{f:gS},547:{f:pS},561:{},579:{},1030:{f:nx},1033:{f:zd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ze(t,e,r,n){var a=e;if(!isNaN(a)){var i=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&Cy(r)&&t.push(r)}}function PY(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return ze(t,e,r,a);var i=e;if(!isNaN(i)){for(var o=r.parts||[],u=0,f=0,d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;var m=t.next(4);for(m.write_shift(2,i),m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d;f<a;){for(m=t.next(4),m.write_shift(2,60),d=0;d+(o[u]||8224)<=8224;)d+=o[u]||8224,u++;m.write_shift(2,d),t.push(r.slice(f,f+d)),f+=d}}}function ih(t,e,r){return t||(t=Se(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function jY(t,e,r,n){var a=Se(9);return ih(a,t,e),iN(r,n||"b",a),a}function LY(t,e,r){var n=Se(8+2*r.length);return ih(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function BY(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?un(vr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?ze(t,2,MU(r,n,a)):ze(t,3,OU(r,n,a));return;case"b":case"e":ze(t,5,jY(r,n,e.v,e.t));return;case"s":case"str":ze(t,4,LY(r,n,(e.v||"").slice(0,255)));return}ze(t,1,ih(null,r,n))}function VY(t,e,r,n){var a=Array.isArray(e),i=Lt(e["!ref"]||"A1"),o,u="",f=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=yt(i)}for(var d=i.s.r;d<=i.e.r;++d){u=Ur(d);for(var m=i.s.c;m<=i.e.c;++m){d===i.s.r&&(f[m]=Tr(m)),o=f[m]+u;var x=a?(e[d]||[])[m]:e[o];x&&BY(t,x,d,m)}}}function UY(t,e){for(var r=e||{},n=fa(),a=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ze(n,r.biff==4?1033:r.biff==3?521:9,Ly(t,16,r)),VY(n,t.Sheets[t.SheetNames[a]],a,r),ze(n,10),n.end()}function zY(t,e,r){ze(t,49,MV({sz:12,name:"Arial"},r))}function HY(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&ze(t,1054,UV(a,e[a],r))})}function GY(t,e){var r=Se(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ze(t,2151,r),r=Se(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),fN(Lt(e["!ref"]||"A1"),r),r.write_shift(4,4),ze(t,2152,r)}function qY(t,e){for(var r=0;r<16;++r)ze(t,224,hS({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ze(t,224,hS(n,0,e))})}function WY(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];ze(t,440,pU(n)),n[1].Tooltip&&ze(t,2048,xU(n))}delete e["!links"]}function XY(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&ze(t,125,EU(Ip(a,n),a))})}}function YY(t,e,r,n,a){var i=16+ao(a.cellXfs,e,a);if(e.v==null&&!e.bf){ze(t,513,Jo(r,n,i));return}if(e.bf)ze(t,6,_q(e,r,n,a,i));else switch(e.t){case"d":case"n":var o=e.t=="d"?un(vr(e.v)):e.v;ze(t,515,ZV(r,n,o,i));break;case"b":case"e":ze(t,517,QV(r,n,e.v,i,a,e.t));break;case"s":case"str":if(a.bookSST){var u=Wy(a.Strings,e.v,a.revStrings);ze(t,253,jV(r,n,u,i))}else ze(t,516,BV(r,n,(e.v||"").slice(0,255),i,a));break;default:ze(t,513,Jo(r,n,i))}}function $Y(t,e,r){var n=fa(),a=r.SheetNames[t],i=r.Sheets[a]||{},o=(r||{}).Workbook||{},u=(o.Sheets||[])[t]||{},f=Array.isArray(i),d=e.biff==8,m,x="",y=[],w=Lt(i["!ref"]||"A1"),E=d?65536:16384;if(w.e.c>255||w.e.r>=E){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");w.e.c=Math.min(w.e.c,255),w.e.r=Math.min(w.e.c,E-1)}ze(n,2057,Ly(r,16,e)),ze(n,13,Ka(1)),ze(n,12,Ka(100)),ze(n,15,Qn(!0)),ze(n,17,Qn(!1)),ze(n,16,Ko(.001)),ze(n,95,Qn(!0)),ze(n,42,Qn(!1)),ze(n,43,Qn(!1)),ze(n,130,Ka(1)),ze(n,128,KV()),ze(n,131,Qn(!1)),ze(n,132,Qn(!1)),d&&XY(n,i["!cols"]),ze(n,512,HV(w,e)),d&&(i["!links"]=[]);for(var b=w.s.r;b<=w.e.r;++b){x=Ur(b);for(var T=w.s.c;T<=w.e.c;++T){b===w.s.r&&(y[T]=Tr(T)),m=y[T]+x;var I=f?(i[b]||[])[T]:i[m];I&&(YY(n,I,b,T,e),d&&I.l&&i["!links"].push([m,I.l]))}}var R=u.CodeName||u.name||a;return d&&ze(n,574,DV((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&ze(n,229,cU(i["!merges"])),d&&WY(n,i),ze(n,442,lN(R)),d&&GY(n,i),ze(n,10),n.end()}function KY(t,e,r){var n=fa(),a=(t||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},u=r.biff==8,f=r.biff==5;if(ze(n,2057,Ly(t,5,r)),r.bookType=="xla"&&ze(n,135),ze(n,225,u?Ka(1200):null),ze(n,193,QB(2)),f&&ze(n,191),f&&ze(n,192),ze(n,226),ze(n,92,yV("SheetJS",r)),ze(n,66,Ka(u?1200:1252)),u&&ze(n,353,Ka(0)),u&&ze(n,448),ze(n,317,AU(t.SheetNames.length)),u&&t.vbaraw&&ze(n,211),u&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";ze(n,442,lN(d))}ze(n,156,Ka(17)),ze(n,25,Qn(!1)),ze(n,18,Qn(!1)),ze(n,19,Ka(0)),u&&ze(n,431,Qn(!1)),u&&ze(n,444,Ka(0)),ze(n,61,RV()),ze(n,64,Qn(!1)),ze(n,141,Ka(0)),ze(n,34,Qn(CX(t)=="true")),ze(n,14,Qn(!0)),u&&ze(n,439,Qn(!1)),ze(n,218,Ka(0)),zY(n,t,r),HY(n,t.SSF,r),qY(n,r),u&&ze(n,352,Qn(!1));var m=n.end(),x=fa();u&&ze(x,140,yU()),u&&r.Strings&&PY(x,252,TV(r.Strings)),ze(x,10);var y=x.end(),w=fa(),E=0,b=0;for(b=0;b<t.SheetNames.length;++b)E+=(u?12:11)+(u?2:1)*t.SheetNames[b].length;var T=m.length+E+y.length;for(b=0;b<t.SheetNames.length;++b){var I=i[b]||{};ze(w,133,bV({pos:T,hs:I.Hidden||0,dt:0,name:t.SheetNames[b]},r)),T+=e[b].length}var R=w.end();if(E!=R.length)throw new Error("BS8 "+E+" != "+R.length);var C=[];return m.length&&C.push(m),R.length&&C.push(R),y.length&&C.push(y),gn(C)}function QY(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=yr(lt)),t&&t.SSF&&(ju(),Tp(t.SSF),r.revssf=Ap(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Qy(r),r.cellXfs=[],ao(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=$Y(a,r,t);return n.unshift(KY(t,n,r)),gn(n)}function e3(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=ha(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=e||{};switch(i.biff||2){case 8:case 5:return QY(t,e);case 4:case 3:case 2:return UY(t,e)}throw new Error("invalid type "+i.bookType+" for BIFF")}function kS(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),o=a.index,u=i&&i.index||t.length,f=M7(t.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,x=0,y=0,w={s:{r:1e7,c:1e7},e:{r:0,c:0}},E=[];for(o=0;o<f.length;++o){var b=f[o].trim(),T=b.slice(0,3).toLowerCase();if(T=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}m=0;continue}if(!(T!="<td"&&T!="<th")){var I=b.split(/<\/t[dh]>/i);for(u=0;u<I.length;++u){var R=I[u].trim();if(R.match(/<t[dh]/i)){for(var C=R,G=0;C.charAt(0)=="<"&&(G=C.indexOf(">"))>-1;)C=C.slice(G+1);for(var V=0;V<E.length;++V){var H=E[V];H.s.c==m&&H.s.r<d&&d<=H.e.r&&(m=H.e.c+1,V=-1)}var A=ut(R.slice(0,R.indexOf(">")));y=A.colspan?+A.colspan:1,((x=+A.rowspan)>1||y>1)&&E.push({s:{r:d,c:m},e:{r:d+(x||1)-1,c:m+y-1}});var D=A.t||A["data-t"]||"";if(!C.length){m+=y;continue}if(C=TC(C),w.s.r>d&&(w.s.r=d),w.e.r<d&&(w.e.r=d),w.s.c>m&&(w.s.c=m),w.e.c<m&&(w.e.c=m),!C.length){m+=y;continue}var N={t:"s",v:C};r.raw||!C.trim().length||D=="s"||(C==="TRUE"?N={t:"b",v:!0}:C==="FALSE"?N={t:"b",v:!1}:isNaN(ws(C))?isNaN(Eu(C).getDate())||(N={t:"d",v:vr(C)},r.cellDates||(N={t:"n",v:un(N.v)}),N.z=r.dateNF||lt[14]):N={t:"n",v:ws(C)}),r.dense?(n[d]||(n[d]=[]),n[d][m]=N):n[ot({r:d,c:m})]=N,m+=y}}}}return n["!ref"]=yt(w),E.length&&(n["!merges"]=E),n}function JY(t,e,r,n){for(var a=t["!merges"]||[],i=[],o=e.s.c;o<=e.e.c;++o){for(var u=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>o)&&!(a[d].e.r<r||a[d].e.c<o)){if(a[d].s.r<r||a[d].s.c<o){u=-1;break}u=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(u<0)){var m=ot({r,c:o}),x=n.dense?(t[r]||[])[o]:t[m],y=x&&x.v!=null&&(x.h||Sy(x.w||(ji(x),x.w)||""))||"",w={};u>1&&(w.rowspan=u),f>1&&(w.colspan=f),n.editable?y='<span contenteditable="true">'+y+"</span>":x&&(w["data-t"]=x&&x.t||"z",x.v!=null&&(w["data-v"]=x.v),x.z!=null&&(w["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+x.l.Target+'">'+y+"</a>")),w.id=(n.id||"sjs")+"-"+m,i.push(Ue("td",y,w))}}var E="<tr>";return E+i.join("")+"</tr>"}var ZY='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',e$="</body></html>";function t$(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return no(kS(r[0],e),e);var n=e_();return r.forEach(function(a,i){t_(n,kS(a,e),"Sheet"+(i+1))}),n}function r$(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function t3(t,e){var r=e||{},n=r.header!=null?r.header:ZY,a=r.footer!=null?r.footer:e$,i=[n],o=ha(t["!ref"]);r.dense=Array.isArray(t),i.push(r$(t,o,r));for(var u=o.s.r;u<=o.e.r;++u)i.push(JY(t,o,u,r));return i.push("</table>"+a),i.join("")}function r3(t,e,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?Sr(n.origin):n.origin;a=o.r,i=o.c}var u=e.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var m=ha(t["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),a==-1&&(d.e.r=a=m.e.r+1)}var x=[],y=0,w=t["!rows"]||(t["!rows"]=[]),E=0,b=0,T=0,I=0,R=0,C=0;for(t["!cols"]||(t["!cols"]=[]);E<u.length&&b<f;++E){var G=u[E];if(CS(G)){if(n.display)continue;w[b]={hidden:!0}}var V=G.children;for(T=I=0;T<V.length;++T){var H=V[T];if(!(n.display&&CS(H))){var A=H.hasAttribute("data-v")?H.getAttribute("data-v"):H.hasAttribute("v")?H.getAttribute("v"):TC(H.innerHTML),D=H.getAttribute("data-z")||H.getAttribute("z");for(y=0;y<x.length;++y){var N=x[y];N.s.c==I+i&&N.s.r<b+a&&b+a<=N.e.r&&(I=N.e.c+1-i,y=-1)}C=+H.getAttribute("colspan")||1,((R=+H.getAttribute("rowspan")||1)>1||C>1)&&x.push({s:{r:b+a,c:I+i},e:{r:b+a+(R||1)-1,c:I+i+(C||1)-1}});var M={t:"s",v:A},F=H.getAttribute("data-t")||H.getAttribute("t")||"";A!=null&&(A.length==0?M.t=F||"z":n.raw||A.trim().length==0||F=="s"||(A==="TRUE"?M={t:"b",v:!0}:A==="FALSE"?M={t:"b",v:!1}:isNaN(ws(A))?isNaN(Eu(A).getDate())||(M={t:"d",v:vr(A)},n.cellDates||(M={t:"n",v:un(M.v)}),M.z=n.dateNF||lt[14]):M={t:"n",v:ws(A)})),M.z===void 0&&D!=null&&(M.z=D);var j="",P=H.getElementsByTagName("A");if(P&&P.length)for(var be=0;be<P.length&&!(P[be].hasAttribute("href")&&(j=P[be].getAttribute("href"),j.charAt(0)!="#"));++be);j&&j.charAt(0)!="#"&&(M.l={Target:j}),n.dense?(t[b+a]||(t[b+a]=[]),t[b+a][I+i]=M):t[ot({c:I+i,r:b+a})]=M,d.e.c<I+i&&(d.e.c=I+i),I+=C}}++b}return x.length&&(t["!merges"]=(t["!merges"]||[]).concat(x)),d.e.r=Math.max(d.e.r,b-1+a),t["!ref"]=yt(d),b>=f&&(t["!fullref"]=yt((d.e.r=u.length-E+b-1+a,d))),t}function n3(t,e){var r=e||{},n=r.dense?[]:{};return r3(n,t,e)}function n$(t,e){return no(n3(t,e),e)}function CS(t){var e="",r=a$(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function a$(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function s$(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=jt(e.replace(/<[^>]*>/g,""));return[r]}var NS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function a3(t,e){var r=e||{},n=Ay(t),a=[],i,o,u={name:""},f="",d=0,m,x,y={},w=[],E=r.dense?[]:{},b,T,I={value:""},R="",C=0,G=[],V=-1,H=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,N={},M=[],F={},j=0,P=0,be=[],ye=1,se=1,ce=[],le={Names:[]},te={},_e=["",""],Q=[],L={},J="",Y=0,ne=!1,ue=!1,Te=0;for(E0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=E0.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?E["!ref"]=yt(A):E["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(E["!fullref"]=E["!ref"],A.e.r=r.sheetRows-1,E["!ref"]=yt(A)),M.length&&(E["!merges"]=M),be.length&&(E["!rows"]=be),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),w.push(m.name),y[m.name]=E,ue=!1):b[0].charAt(b[0].length-2)!=="/"&&(m=ut(b[0],!1),V=H=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,E=r.dense?[]:{},M=[],be=[],ue=!0);break;case"table-row-group":b[1]==="/"?--D:++D;break;case"table-row":case"":if(b[1]==="/"){V+=ye,ye=1;break}if(x=ut(b[0],!1),x.?V=x.-1:V==-1&&(V=0),ye=+x["number-rows-repeated"]||1,ye<10)for(Te=0;Te<ye;++Te)D>0&&(be[V+Te]={level:D});H=-1;break;case"covered-table-cell":b[1]!=="/"&&++H,r.sheetStubs&&(r.dense?(E[V]||(E[V]=[]),E[V][H]={t:"z"}):E[ot({r:V,c:H})]={t:"z"}),R="",G=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++H,I=ut(b[0],!1),se=parseInt(I["number-columns-repeated"]||"1",10),T={t:"z",v:null},I.formula&&r.cellFormula!=!1&&(T.f=TS(jt(I.formula))),(I.||I["value-type"])=="string"&&(T.t="s",T.v=jt(I["string-value"]||""),r.dense?(E[V]||(E[V]=[]),E[V][H]=T):E[ot({r:V,c:H})]=T),H+=se-1;else if(b[1]!=="/"){++H,R="",C=0,G=[],se=1;var Re=ye?V+ye-1:V;if(H>A.e.c&&(A.e.c=H),H<A.s.c&&(A.s.c=H),V<A.s.r&&(A.s.r=V),Re>A.e.r&&(A.e.r=Re),I=ut(b[0],!1),Q=[],L={},T={t:I.||I["value-type"],v:null},r.cellFormula)if(I.formula&&(I.formula=jt(I.formula)),I["number-matrix-columns-spanned"]&&I["number-matrix-rows-spanned"]&&(j=parseInt(I["number-matrix-rows-spanned"],10)||0,P=parseInt(I["number-matrix-columns-spanned"],10)||0,F={s:{r:V,c:H},e:{r:V+j-1,c:H+P-1}},T.F=yt(F),ce.push([F,T.F])),I.formula)T.f=TS(I.formula);else for(Te=0;Te<ce.length;++Te)V>=ce[Te][0].s.r&&V<=ce[Te][0].e.r&&H>=ce[Te][0].s.c&&H<=ce[Te][0].e.c&&(T.F=ce[Te][1]);switch((I["number-columns-spanned"]||I["number-rows-spanned"])&&(j=parseInt(I["number-rows-spanned"],10)||0,P=parseInt(I["number-columns-spanned"],10)||0,F={s:{r:V,c:H},e:{r:V+j-1,c:H+P-1}},M.push(F)),I["number-columns-repeated"]&&(se=parseInt(I["number-columns-repeated"],10)),T.t){case"boolean":T.t="b",T.v=gr(I["boolean-value"]);break;case"float":T.t="n",T.v=parseFloat(I.value);break;case"percentage":T.t="n",T.v=parseFloat(I.value);break;case"currency":T.t="n",T.v=parseFloat(I.value);break;case"date":T.t="d",T.v=vr(I["date-value"]),r.cellDates||(T.t="n",T.v=un(T.v)),T.z="m/d/yy";break;case"time":T.t="n",T.v=D7(I["time-value"])/86400,r.cellDates&&(T.t="d",T.v=kp(T.v)),T.z="HH:MM:SS";break;case"number":T.t="n",T.v=parseFloat(I.);break;default:if(T.t==="string"||T.t==="text"||!T.t)T.t="s",I["string-value"]!=null&&(R=jt(I["string-value"]),G=[]);else throw new Error("Unsupported value type "+T.t)}}else{if(ne=!1,T.t==="s"&&(T.v=R||"",G.length&&(T.R=G),ne=C==0),te.Target&&(T.l=te),Q.length>0&&(T.c=Q,Q=[]),R&&r.cellText!==!1&&(T.w=R),ne&&(T.t="z",delete T.v),(!ne||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=V))for(var Ae=0;Ae<ye;++Ae){if(se=parseInt(I["number-columns-repeated"]||"1",10),r.dense)for(E[V+Ae]||(E[V+Ae]=[]),E[V+Ae][H]=Ae==0?T:yr(T);--se>0;)E[V+Ae][H+se]=yr(T);else for(E[ot({r:V+Ae,c:H})]=T;--se>0;)E[ot({r:V+Ae,c:H+se})]=yr(T);A.e.c<=H&&(A.e.c=H)}se=parseInt(I["number-columns-repeated"]||"1",10),H+=se-1,se=0,T={},R="",G=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i;L.t=R,G.length&&(L.R=G),L.a=J,Q.push(L)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);J="",Y=0,R="",C=0,G=[];break;case"creator":b[1]==="/"?J=n.slice(Y,b.index):Y=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);R="",C=0,G=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(N[u.name]=f,(i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&(f="",u=ut(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=ut(b[0],!1),f+=NS[b[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=ut(b[0],!1),f+=NS[b[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,b.index);break}else d=b.index+b[0].length;break;case"named-range":o=ut(b[0],!1),_e=ax(o["cell-range-address"]);var Fe={Name:o.name,Ref:_e[0]+"!"+_e[1]};ue&&(Fe.Sheet=w.length),le.Names.push(Fe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!I||!I["string-value"])){var st=s$(n.slice(C,b.index));R=(R.length>0?R+`
`:"")+st[0]}else ut(b[0],!1),C=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{_e=ax(ut(b[0])["target-range-address"]),y[_e[0]]["!autofilter"]={ref:_e[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(te=ut(b[0],!1),!te.href)break;te.Target=jt(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(_e=ax(te.Target.slice(1)),te.Target="#"+_e[0]+"!"+_e[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(b)}}var B={Sheets:y,SheetNames:w,Workbook:le};return r.bookSheets&&delete B.Sheets,B}function RS(t,e){e=e||{},$a(t,"META-INF/manifest.xml")&&DB(Zr(t,"META-INF/manifest.xml"),e);var r=ka(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=a3(lr(r),e);return $a(t,"meta.xml")&&(n.Props=YC(Zr(t,"meta.xml"))),n}function IS(t,e){return a3(t,e)}var i$=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+b0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return zr+e}})(),DS=(function(){var t=function(i){return tr(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,o,u){var f=[];f.push('      <table:table table:name="'+tr(o.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,m=0,x=ha(i["!ref"]||"A1"),y=i["!merges"]||[],w=0,E=Array.isArray(i);if(i["!cols"])for(m=0;m<=x.e.c;++m)f.push("        <table:table-column"+(i["!cols"][m]?' table:style-name="co'+i["!cols"][m].ods+'"':"")+`></table:table-column>
`);var b="",T=i["!rows"]||[];for(d=0;d<x.s.r;++d)b=T[d]?' table:style-name="ro'+T[d].ods+'"':"",f.push("        <table:table-row"+b+`></table:table-row>
`);for(;d<=x.e.r;++d){for(b=T[d]?' table:style-name="ro'+T[d].ods+'"':"",f.push("        <table:table-row"+b+`>
`),m=0;m<x.s.c;++m)f.push(e);for(;m<=x.e.c;++m){var I=!1,R={},C="";for(w=0;w!=y.length;++w)if(!(y[w].s.c>m)&&!(y[w].s.r>d)&&!(y[w].e.c<m)&&!(y[w].e.r<d)){(y[w].s.c!=m||y[w].s.r!=d)&&(I=!0),R["table:number-columns-spanned"]=y[w].e.c-y[w].s.c+1,R["table:number-rows-spanned"]=y[w].e.r-y[w].s.r+1;break}if(I){f.push(r);continue}var G=ot({r:d,c:m}),V=E?(i[d]||[])[m]:i[G];if(V&&V.f&&(R["table:formula"]=tr(Aq(V.f)),V.F&&V.F.slice(0,G.length)==G)){var H=ha(V.F);R["table:number-matrix-columns-spanned"]=H.e.c-H.s.c+1,R["table:number-matrix-rows-spanned"]=H.e.r-H.s.r+1}if(!V){f.push(e);continue}switch(V.t){case"b":C=V.v?"TRUE":"FALSE",R["office:value-type"]="boolean",R["office:boolean-value"]=V.v?"true":"false";break;case"n":C=V.w||String(V.v||0),R["office:value-type"]="float",R["office:value"]=V.v||0;break;case"s":case"str":C=V.v==null?"":V.v,R["office:value-type"]="string";break;case"d":C=V.w||vr(V.v).toISOString(),R["office:value-type"]="date",R["office:date-value"]=vr(V.v).toISOString(),R["table:style-name"]="ce1";break;default:f.push(e);continue}var A=t(C);if(V.l&&V.l.Target){var D=V.l.Target;D=D.charAt(0)=="#"?"#"+kq(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),A=Ue("text:a",A,{"xlink:href":D.replace(/&/g,"&amp;")})}f.push("          "+Ue("table:table-cell",Ue("text:p",A,{}),R)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var x=d["!cols"][m];if(x.width==null&&x.wpx==null&&x.wch==null)continue;Yl(x),x.ods=u;var y=d["!cols"][m].wpx+"px";i.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+y+`"/>
`),i.push(`  </style:style>
`),++u}}});var f=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=f;var x=d["!rows"][m].hpx+"px";i.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),i.push(`  </style:style>
`),++f}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,u){var f=[zr],d=b0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=b0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(f.push("<office:document"+d+m+`>
`),f.push(XC().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,o),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)f.push(n(o.Sheets[o.SheetNames[x]],o,x));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),u.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function s3(t,e){if(e.bookType=="fods")return DS(t,e);var r=by(),n="",a=[],i=[];return n="mimetype",bt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",bt(r,n,DS(t,e)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",bt(r,n,i$(t,e)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",bt(r,n,zr+XC()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",bt(r,n,MB(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",bt(r,n,OB(a)),r}function Zo(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function nv(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):lr(ro(t))}function l$(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Aa(Vs(t))}function o$(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Kl(t){var e=t.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function OS(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function c$(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function u$(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)t[e+i]=a&255;t[e+15]|=r>=0?0:128}function R0(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Zt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Ir(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Ut(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=R0(t,r),i=a&7;a=Math.floor(a/8);var o=0,u;if(a==0)break;switch(i){case 0:{for(var f=r[0];t[r[0]++]>=128;);u=t.slice(f,r[0])}break;case 5:o=4,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=R0(t,r),u=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:i};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function En(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(Zt(n*8+a.type)),a.type==2&&e.push(Zt(a.data.length)),e.push(a.data))})}),Kl(e)}function $y(t,e){return t?.map(function(r){return e(r.data)})||[]}function Xa(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=R0(t,n),i=Ut(t.slice(n[0],n[0]+a));n[0]+=a;var o={id:Ir(i[1][0].data),messages:[]};i[2].forEach(function(u){var f=Ut(u.data),d=Ir(f[3][0].data);o.messages.push({meta:f,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=i[3])!=null&&e[0]&&(o.merge=Ir(i[3][0].data)>>>0>0),r.push(o)}return r}function Kc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Zt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Zt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Zt(o.data.length)}],n[2].push({data:En(o.meta),type:2})});var i=En(n);e.push(Zt(i.length)),e.push(i),a.forEach(function(o){return e.push(o)})}),Kl(e)}function f$(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=R0(e,r),a=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var u=o-59;o=e[r[0]],u>1&&(o|=e[r[0]+1]<<8),u>2&&(o|=e[r[0]+2]<<16),u>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=u}a.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var f=0,d=0;if(i==1?(d=(e[r[0]]>>2&7)+4,f=(e[r[0]++]&224)<<3,f|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,i==2?(f=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(f=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Kl(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var m=Kl(a);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function Ya(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(f$(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Kl(e)}function Qc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var i=Zt(n),o=i.length;e.push(i),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return Kl(e)}function h$(t,e,r,n){var a=Zo(t),i=a.getUint32(4,!0),o=(n>1?12:8)+OS(i&(n>1?3470:398))*4,u=-1,f=-1,d=NaN,m=new Date(2001,0,1);i&512&&(u=a.getUint32(o,!0),o+=4),o+=OS(i&(n>1?12288:4096))*4,i&16&&(f=a.getUint32(o,!0),o+=4),i&32&&(d=a.getFloat64(o,!0),o+=8),i&64&&(m.setTime(m.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var x;switch(t[2]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:e[f]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:r[u]};else if(f>-1)x={t:"s",v:e[f]};else if(!isNaN(d))x={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return x}function d$(t,e,r){var n=Zo(t),a=n.getUint32(8,!0),i=12,o=-1,u=-1,f=NaN,d=NaN,m=new Date(2001,0,1);a&1&&(f=c$(t,i),i+=16),a&2&&(d=n.getFloat64(i,!0),i+=8),a&4&&(m.setTime(m.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(u=n.getUint32(i,!0),i+=4),a&16&&(o=n.getUint32(i,!0),i+=4);var x;switch(t[1]){case 0:break;case 2:x={t:"n",v:f};break;case 3:x={t:"s",v:e[u]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:d>0};break;case 7:x={t:"n",v:d/86400};break;case 8:x={t:"e",v:0};break;case 9:if(o>-1)x={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:x={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return x}function ix(t,e){var r=new Uint8Array(32),n=Zo(r),a=12,i=0;switch(r[0]=5,t.t){case"n":r[1]=2,u$(r,a,t.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),i|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,i,!0),r.slice(0,a)}function lx(t,e){var r=new Uint8Array(32),n=Zo(r),a=12,i=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),i|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,i,!0),r.slice(0,a)}function m$(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return h$(t,e,r,t[0]);case 5:return d$(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Mn(t){var e=Ut(t);return R0(e[1][0].data)}function FS(t,e){var r=Ut(e.data),n=Ir(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(o){var u=Ut(o.data),f=Ir(u[1][0].data)>>>0;switch(n){case 1:i[f]=nv(u[3][0].data);break;case 8:{var d=t[Mn(u[9][0].data)][0],m=Ut(d.data),x=t[Mn(m[1][0].data)][0],y=Ir(x.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var w=Ut(x.data);i[f]=w[3].map(function(E){return nv(E.data)}).join("")}break}}),i}function p$(t,e){var r,n,a,i,o,u,f,d,m,x,y,w,E,b,T=Ut(t),I=Ir(T[1][0].data)>>>0,R=Ir(T[2][0].data)>>>0,C=((n=(r=T[8])==null?void 0:r[0])==null?void 0:n.data)&&Ir(T[8][0].data)>0||!1,G,V;if((i=(a=T[7])==null?void 0:a[0])!=null&&i.data&&e!=0)G=(u=(o=T[7])==null?void 0:o[0])==null?void 0:u.data,V=(d=(f=T[6])==null?void 0:f[0])==null?void 0:d.data;else if((x=(m=T[4])==null?void 0:m[0])!=null&&x.data&&e!=1)G=(w=(y=T[4])==null?void 0:y[0])==null?void 0:w.data,V=(b=(E=T[3])==null?void 0:E[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var H=C?4:1,A=Zo(G),D=[],N=0;N<G.length/2;++N){var M=A.getUint16(N*2,!0);M<65535&&D.push([N,M])}if(D.length!=R)throw"Expected ".concat(R," cells, found ").concat(D.length);var F=[];for(N=0;N<D.length-1;++N)F[D[N][0]]=V.subarray(D[N][1]*H,D[N+1][1]*H);return D.length>=1&&(F[D[D.length-1][0]]=V.subarray(D[D.length-1][1]*H)),{R:I,cells:F}}function g$(t,e){var r,n=Ut(e.data),a=(r=n?.[7])!=null&&r[0]?Ir(n[7][0].data)>>>0>0?1:0:-1,i=$y(n[5],function(o){return p$(o,a)});return{nrows:Ir(n[4][0].data)>>>0,data:i.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(f,d){if(o[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));o[u.R][d]=f}),o},[])}}function x$(t,e,r){var n,a=Ut(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Ir(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Ir(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=yt(i);var o=Ut(a[4][0].data),u=FS(t,t[Mn(o[4][0].data)][0]),f=(n=o[17])!=null&&n[0]?FS(t,t[Mn(o[17][0].data)][0]):[],d=Ut(o[3][0].data),m=0;d[1].forEach(function(x){var y=Ut(x.data),w=t[Mn(y[2][0].data)][0],E=Ir(w.meta[1][0].data);if(E!=6002)throw new Error("6001 unexpected reference to ".concat(E));var b=g$(t,w);b.data.forEach(function(T,I){T.forEach(function(R,C){var G=ot({r:m+I,c:C}),V=m$(R,u,f);V&&(r[G]=V)})}),m+=b.nrows})}function v$(t,e){var r=Ut(e.data),n={"!ref":"A1"},a=t[Mn(r[2][0].data)],i=Ir(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return x$(t,a[0],n),n}function y$(t,e){var r,n=Ut(e.data),a={name:(r=n[1])!=null&&r[0]?nv(n[1][0].data):"",sheets:[]},i=$y(n[2],Mn);return i.forEach(function(o){t[o].forEach(function(u){var f=Ir(u.meta[1][0].data);f==6e3&&a.sheets.push(v$(t,u))})}),a}function _$(t,e){var r=e_(),n=Ut(e.data),a=$y(n[1],Mn);if(a.forEach(function(i){t[i].forEach(function(o){var u=Ir(o.meta[1][0].data);if(u==2){var f=y$(t,o);f.sheets.forEach(function(d,m){t_(r,d,m==0?f.name:f.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ox(t){var e,r,n,a,i={},o=[];if(t.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=Ya(f.content)}catch(x){return console.log("?? "+f.content.length+" "+(x.message||x))}var m;try{m=Xa(d)}catch(x){return console.log("## "+(x.message||x))}m.forEach(function(x){i[x.id]=x.messages,o.push(x.id)})}}),!o.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=i?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ir(i[1][0].meta[1][0].data)==1&&i[1][0];if(u||o.forEach(function(f){i[f].forEach(function(d){var m=Ir(d.meta[1][0].data)>>>0;if(m==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return _$(i,u)}function w$(t,e,r){var n,a,i,o;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&Ir(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var f=0,d=Zo(t[7][0].data),m=0,x=[],y=Zo(t[4][0].data),w=0,E=[],b=0;b<e.length;++b){if(e[b]==null){d.setUint16(b*2,65535,!0),y.setUint16(b*2,65535);continue}d.setUint16(b*2,m,!0),y.setUint16(b*2,w,!0);var T,I;switch(typeof e[b]){case"string":T=ix({t:"s",v:e[b]},r),I=lx({t:"s",v:e[b]},r);break;case"number":T=ix({t:"n",v:e[b]},r),I=lx({t:"n",v:e[b]},r);break;case"boolean":T=ix({t:"b",v:e[b]},r),I=lx({t:"b",v:e[b]},r);break;default:throw new Error("Unsupported value "+e[b])}x.push(T),m+=T.length,E.push(I),w+=I.length,++f}for(t[2][0].data=Zt(f);b<t[7][0].data.length/2;++b)d.setUint16(b*2,65535,!0),y.setUint16(b*2,65535,!0);return t[6][0].data=Kl(x),t[3][0].data=Kl(E),f}function b$(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ha(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(yt(n)));var i=Gm(r,{range:n,header:1}),o=["~Sh33tJ5~"];i.forEach(function(J){return J.forEach(function(Y){typeof Y=="string"&&o.push(Y)})});var u={},f=[],d=nt.read(e.numbers,{type:"base64"});d.FileIndex.map(function(J,Y){return[J,d.FullPaths[Y]]}).forEach(function(J){var Y=J[0],ne=J[1];if(Y.type==2&&Y.name.match(/\.iwa/)){var ue=Y.content,Te=Ya(ue),Re=Xa(Te);Re.forEach(function(Ae){f.push(Ae.id),u[Ae.id]={deps:[],location:ne,type:Ir(Ae.messages[0].meta[1][0].data)}})}}),f.sort(function(J,Y){return J-Y});var m=f.filter(function(J){return J>1}).map(function(J){return[J,Zt(J)]});d.FileIndex.map(function(J,Y){return[J,d.FullPaths[Y]]}).forEach(function(J){var Y=J[0];if(J[1],!!Y.name.match(/\.iwa/)){var ne=Xa(Ya(Y.content));ne.forEach(function(ue){ue.messages.forEach(function(Te){m.forEach(function(Re){ue.messages.some(function(Ae){return Ir(Ae.meta[1][0].data)!=11006&&o$(Ae.data,Re[1])})&&u[Re[0]].deps.push(ue.id)})})})}});for(var x=nt.find(d,u[1].location),y=Xa(Ya(x.content)),w,E=0;E<y.length;++E){var b=y[E];b.id==1&&(w=b)}var T=Mn(Ut(w.messages[0].data)[1][0].data);for(x=nt.find(d,u[T].location),y=Xa(Ya(x.content)),E=0;E<y.length;++E)b=y[E],b.id==T&&(w=b);for(T=Mn(Ut(w.messages[0].data)[2][0].data),x=nt.find(d,u[T].location),y=Xa(Ya(x.content)),E=0;E<y.length;++E)b=y[E],b.id==T&&(w=b);for(T=Mn(Ut(w.messages[0].data)[2][0].data),x=nt.find(d,u[T].location),y=Xa(Ya(x.content)),E=0;E<y.length;++E)b=y[E],b.id==T&&(w=b);var I=Ut(w.messages[0].data);{I[6][0].data=Zt(n.e.r+1),I[7][0].data=Zt(n.e.c+1);var R=Mn(I[46][0].data),C=nt.find(d,u[R].location),G=Xa(Ya(C.content));{for(var V=0;V<G.length&&G[V].id!=R;++V);if(G[V].id!=R)throw"Bad ColumnRowUIDMapArchive";var H=Ut(G[V].messages[0].data);H[1]=[],H[2]=[],H[3]=[];for(var A=0;A<=n.e.c;++A){var D=[];D[1]=D[2]=[{type:0,data:Zt(A+420690)}],H[1].push({type:2,data:En(D)}),H[2].push({type:0,data:Zt(A)}),H[3].push({type:0,data:Zt(A)})}H[4]=[],H[5]=[],H[6]=[];for(var N=0;N<=n.e.r;++N)D=[],D[1]=D[2]=[{type:0,data:Zt(N+726270)}],H[4].push({type:2,data:En(D)}),H[5].push({type:0,data:Zt(N)}),H[6].push({type:0,data:Zt(N)});G[V].messages[0].data=En(H)}C.content=Qc(Kc(G)),C.size=C.content.length,delete I[46];var M=Ut(I[4][0].data);{M[7][0].data=Zt(n.e.r+1);var F=Ut(M[1][0].data),j=Mn(F[2][0].data);C=nt.find(d,u[j].location),G=Xa(Ya(C.content));{if(G[0].id!=j)throw"Bad HeaderStorageBucket";var P=Ut(G[0].messages[0].data);for(N=0;N<i.length;++N){var be=Ut(P[2][0].data);be[1][0].data=Zt(N),be[4][0].data=Zt(i[N].length),P[2][N]={type:P[2][0].type,data:En(be)}}G[0].messages[0].data=En(P)}C.content=Qc(Kc(G)),C.size=C.content.length;var ye=Mn(M[2][0].data);C=nt.find(d,u[ye].location),G=Xa(Ya(C.content));{if(G[0].id!=ye)throw"Bad HeaderStorageBucket";for(P=Ut(G[0].messages[0].data),A=0;A<=n.e.c;++A)be=Ut(P[2][0].data),be[1][0].data=Zt(A),be[4][0].data=Zt(n.e.r+1),P[2][A]={type:P[2][0].type,data:En(be)};G[0].messages[0].data=En(P)}C.content=Qc(Kc(G)),C.size=C.content.length;var se=Mn(M[4][0].data);(function(){for(var J=nt.find(d,u[se].location),Y=Xa(Ya(J.content)),ne,ue=0;ue<Y.length;++ue){var Te=Y[ue];Te.id==se&&(ne=Te)}var Re=Ut(ne.messages[0].data);{Re[3]=[];var Ae=[];o.forEach(function(B,Xe){Ae[1]=[{type:0,data:Zt(Xe)}],Ae[2]=[{type:0,data:Zt(1)}],Ae[3]=[{type:2,data:l$(B)}],Re[3].push({type:2,data:En(Ae)})})}ne.messages[0].data=En(Re);var Fe=Kc(Y),st=Qc(Fe);J.content=st,J.size=J.content.length})();var ce=Ut(M[3][0].data);{var le=ce[1][0];delete ce[2];var te=Ut(le.data);{var _e=Mn(te[2][0].data);(function(){for(var J=nt.find(d,u[_e].location),Y=Xa(Ya(J.content)),ne,ue=0;ue<Y.length;++ue){var Te=Y[ue];Te.id==_e&&(ne=Te)}var Re=Ut(ne.messages[0].data);{delete Re[6],delete ce[7];var Ae=new Uint8Array(Re[5][0].data);Re[5]=[];for(var Fe=0,st=0;st<=n.e.r;++st){var B=Ut(Ae);Fe+=w$(B,i[st],o),B[1][0].data=Zt(st),Re[5].push({data:En(B),type:2})}Re[1]=[{type:0,data:Zt(n.e.c+1)}],Re[2]=[{type:0,data:Zt(n.e.r+1)}],Re[3]=[{type:0,data:Zt(Fe)}],Re[4]=[{type:0,data:Zt(n.e.r+1)}]}ne.messages[0].data=En(Re);var Xe=Kc(Y),Pe=Qc(Xe);J.content=Pe,J.size=J.content.length})()}le.data=En(te)}M[3][0].data=En(ce)}I[4][0].data=En(M)}w.messages[0].data=En(I);var Q=Kc(y),L=Qc(Q);return x.content=L,x.size=x.content.length,d}function i3(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Ky(t){i3([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Qy(t){i3([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function E$(t){return St.WS.indexOf(t)>-1?"sheet":t==St.CS?"chart":t==St.DS?"dialog":t==St.MS?"macro":t&&t.length?t:"sheet"}function T$(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,E$(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function S$(t,e,r,n,a,i,o,u,f,d,m,x){try{i[n]=n0(ka(t,r,!0),e);var y=Zr(t,e),w;switch(u){case"sheet":w=XX(y,e,a,f,i[n],d,m,x);break;case"chart":if(w=YX(y,e,a,f,i[n],d,m,x),!w||!w["!drawel"])break;var E=Xf(w["!drawel"].Target,e),b=T0(E),T=FH(ka(t,E,!0),n0(ka(t,b,!0),E)),I=Xf(T,E),R=T0(I);w=wX(ka(t,I,!0),I,f,n0(ka(t,R,!0),I),d,w);break;case"macro":w=$X(y,e,a,f,i[n],d,m,x);break;case"dialog":w=KX(y,e,a,f,i[n],d,m,x);break;default:throw new Error("Unrecognized sheet type "+u)}o[n]=w;var C=[];i&&i[n]&&Dr(i[n]).forEach(function(G){var V="";if(i[n][G].Type==St.CMNT){V=Xf(i[n][G].Target,e);var H=eY(Zr(t,V,!0),V,f);if(!H||!H.length)return;yS(w,H,!1)}i[n][G].Type==St.TCMNT&&(V=Xf(i[n][G].Target,e),C=C.concat(PH(Zr(t,V,!0),f)))}),C&&C.length&&yS(w,C,!0,f.people||[])}catch(G){if(f.WTF)throw G}}function qa(t){return t.charAt(0)=="/"?t.slice(1):t}function A$(t,e){if(ju(),e=e||{},Ky(e),$a(t,"META-INF/manifest.xml")||$a(t,"objectdata.xml"))return RS(t,e);if($a(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ox<"u"){if(t.FileIndex)return ox(t);var r=nt.utils.cfb_new();return VT(t).forEach(function(be){bt(r,be,j7(t,be))}),ox(r)}throw new Error("Unsupported NUMBERS file")}if(!$a(t,"[Content_Types].xml"))throw $a(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):$a(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=VT(t),a=RB(ka(t,"[Content_Types].xml")),i=!1,o,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Zr(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Zr(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},d={};if(!e.bookSheets&&!e.bookProps){if(a0=[],a.sst)try{a0=ZX(Zr(t,qa(a.sst)),a.sst,e)}catch(be){if(e.WTF)throw be}e.cellStyles&&a.themes.length&&(f=JX(ka(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=QX(Zr(t,qa(a.style)),a.style,f,e))}a.links.map(function(be){try{var ye=n0(ka(t,T0(qa(be))),be);return rY(Zr(t,qa(be)),ye,be,e)}catch{}});var m=WX(Zr(t,qa(a.workbooks[0])),a.workbooks[0],e),x={},y="";a.coreprops.length&&(y=Zr(t,qa(a.coreprops[0]),!0),y&&(x=YC(y)),a.extprops.length!==0&&(y=Zr(t,qa(a.extprops[0]),!0),y&&jB(y,x,e)));var w={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(y=ka(t,qa(a.custprops[0]),!0),y&&(w=BB(y,e)));var E={};if((e.bookSheets||e.bookProps)&&(m.Sheets?o=m.Sheets.map(function(ye){return ye.name}):x.Worksheets&&x.SheetNames.length>0&&(o=x.SheetNames),e.bookProps&&(E.Props=x,E.Custprops=w),e.bookSheets&&typeof o<"u"&&(E.SheetNames=o),e.bookSheets?E.SheetNames:e.bookProps))return E;o={};var b={};e.bookDeps&&a.calcchain&&(b=tY(Zr(t,qa(a.calcchain)),a.calcchain));var T=0,I={},R,C;{var G=m.Sheets;x.Worksheets=G.length,x.SheetNames=[];for(var V=0;V!=G.length;++V)x.SheetNames[V]=G[V].name}var H=i?"bin":"xml",A=a.workbooks[0].lastIndexOf("/"),D=(a.workbooks[0].slice(0,A+1)+"_rels/"+a.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");$a(t,D)||(D="xl/_rels/workbook."+H+".rels");var N=n0(ka(t,D,!0),D.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=nY(Zr(t,qa(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=LH(Zr(t,qa(a.people[0])),e)),N&&(N=T$(N,m.Sheets));var M=Zr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(T=0;T!=x.Worksheets;++T){var F="sheet";if(N&&N[T]?(R="xl/"+N[T][1].replace(/[\/]?xl\//,""),$a(t,R)||(R=N[T][1]),$a(t,R)||(R=D.replace(/_rels\/.*$/,"")+N[T][1]),F=N[T][2]):(R="xl/worksheets/sheet"+(T+1-M)+"."+H,R=R.replace(/sheet0\./,"sheet.")),C=R.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(T!=e.sheets)continue e;break;case"string":if(x.SheetNames[T].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var j=!1,P=0;P!=e.sheets.length;++P)typeof e.sheets[P]=="number"&&e.sheets[P]==T&&(j=1),typeof e.sheets[P]=="string"&&e.sheets[P].toLowerCase()==x.SheetNames[T].toLowerCase()&&(j=1);if(!j)continue e}}S$(t,R,C,x.SheetNames[T],T,I,o,F,e,m,f,d)}return E={Directory:a,Workbook:m,Props:x,Custprops:w,Deps:b,Sheets:o,SheetNames:x.SheetNames,Strings:a0,Styles:d,Themes:f,SSF:yr(lt)},e&&e.bookFiles&&(t.files?(E.keys=n,E.files=t.files):(E.keys=[],E.files={},t.FullPaths.forEach(function(be,ye){be=be.replace(/^Root Entry[\/]/,""),E.keys.push(be),E.files[be]=t.FileIndex[ye]}))),e&&e.bookVBA&&(a.vba.length>0?E.vbaraw=Zr(t,qa(a.vba[0]),!0):a.defaults&&a.defaults.bin===WH&&(E.vbaraw=Zr(t,"xl/vbaProject.bin",!0))),E}function k$(t,e){var r=e||{},n="Workbook",a=nt.find(t,n);try{if(n="/!DataSpaces/Version",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(nz(a.content),n="/!DataSpaces/DataSpaceMap",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=sz(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=iz(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);oz(a.content)}catch{}if(n="/EncryptionInfo",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=cz(a.content);if(n="/EncryptedPackage",a=nt.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function C$(t,e){return e.bookType=="ods"?s3(t,e):e.bookType=="numbers"?b$(t,e):e.bookType=="xlsb"?N$(t,e):R$(t,e)}function N$(t,e){au=1024,t&&!t.SSF&&(t.SSF=yr(lt)),t&&t.SSF&&(ju(),Tp(t.SSF),e.revssf=Ap(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,s0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=ON.indexOf(e.bookType)>-1,a=Py();Qy(e=e||{});var i=by(),o="",u=0;if(e.cellXfs=[],ao(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",bt(i,o,$C(t.Props,e)),a.coreprops.push(o),er(e.rels,2,o,St.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}for(t.Props.Worksheets=t.Props.SheetNames.length,bt(i,o,JC(t.Props)),a.extprops.push(o),er(e.rels,3,o,St.EXT_PROPS),t.Custprops!==t.Props&&Dr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",bt(i,o,ZC(t.Custprops)),a.custprops.push(o),er(e.rels,4,o,St.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var m={"!id":{}},x=t.Sheets[t.SheetNames[u-1]],y=(x||{})["!type"]||"sheet";switch(y){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,bt(i,o,sY(u-1,o,e,t,m)),a.sheets.push(o),er(e.wbrels,-1,"worksheets/sheet"+u+"."+r,St.WS[0])}if(x){var w=x["!comments"],E=!1,b="";w&&w.length>0&&(b="xl/comments"+u+"."+r,bt(i,b,oY(w,b)),a.comments.push(b),er(m,-1,"../comments"+u+"."+r,St.CMNT),E=!0),x["!legacy"]&&E&&bt(i,"xl/drawings/vmlDrawing"+u+".vml",IN(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&bt(i,T0(o),uu(m))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,bt(i,o,lY(e.Strings,o,e)),a.strs.push(o),er(e.wbrels,-1,"sharedStrings."+r,St.SST)),o="xl/workbook."+r,bt(i,o,aY(t,o)),a.workbooks.push(o),er(e.rels,1,o,St.WB),o="xl/theme/theme1.xml",bt(i,o,zy(t.Themes,e)),a.themes.push(o),er(e.wbrels,-1,"theme/theme1.xml",St.THEME),o="xl/styles."+r,bt(i,o,iY(t,o,e)),a.styles.push(o),er(e.wbrels,-1,"styles."+r,St.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",bt(i,o,t.vbaraw),a.vba.push(o),er(e.wbrels,-1,"vbaProject.bin",St.VBA)),o="xl/metadata."+r,bt(i,o,cY(o)),a.metadata.push(o),er(e.wbrels,-1,"metadata."+r,St.XLMETA),bt(i,"[Content_Types].xml",WC(a,e)),bt(i,"_rels/.rels",uu(e.rels)),bt(i,"xl/_rels/workbook."+r+".rels",uu(e.wbrels)),delete e.revssf,delete e.ssf,i}function R$(t,e){au=1024,t&&!t.SSF&&(t.SSF=yr(lt)),t&&t.SSF&&(ju(),Tp(t.SSF),e.revssf=Ap(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,s0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=ON.indexOf(e.bookType)>-1,a=Py();Qy(e=e||{});var i=by(),o="",u=0;if(e.cellXfs=[],ao(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",bt(i,o,$C(t.Props,e)),a.coreprops.push(o),er(e.rels,2,o,St.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var f=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(t.SheetNames[d]);t.Props.SheetNames=f}t.Props.Worksheets=t.Props.SheetNames.length,bt(i,o,JC(t.Props)),a.extprops.push(o),er(e.rels,3,o,St.EXT_PROPS),t.Custprops!==t.Props&&Dr(t.Custprops||{}).length>0&&(o="docProps/custom.xml",bt(i,o,ZC(t.Custprops)),a.custprops.push(o),er(e.rels,4,o,St.CUST_PROPS));var m=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var x={"!id":{}},y=t.Sheets[t.SheetNames[u-1]],w=(y||{})["!type"]||"sheet";switch(w){case"chart":default:o="xl/worksheets/sheet"+u+"."+r,bt(i,o,GN(u-1,e,t,x)),a.sheets.push(o),er(e.wbrels,-1,"worksheets/sheet"+u+"."+r,St.WS[0])}if(y){var E=y["!comments"],b=!1,T="";if(E&&E.length>0){var I=!1;E.forEach(function(R){R[1].forEach(function(C){C.T==!0&&(I=!0)})}),I&&(T="xl/threadedComments/threadedComment"+u+"."+r,bt(i,T,jH(E,m,e)),a.threadedcomments.push(T),er(x,-1,"../threadedComments/threadedComment"+u+"."+r,St.TCMNT)),T="xl/comments"+u+"."+r,bt(i,T,DN(E)),a.comments.push(T),er(x,-1,"../comments"+u+"."+r,St.CMNT),b=!0}y["!legacy"]&&b&&bt(i,"xl/drawings/vmlDrawing"+u+".vml",IN(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}x["!id"].rId1&&bt(i,T0(o),uu(x))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,bt(i,o,yN(e.Strings,e)),a.strs.push(o),er(e.wbrels,-1,"sharedStrings."+r,St.SST)),o="xl/workbook."+r,bt(i,o,$N(t)),a.workbooks.push(o),er(e.rels,1,o,St.WB),o="xl/theme/theme1.xml",bt(i,o,zy(t.Themes,e)),a.themes.push(o),er(e.wbrels,-1,"theme/theme1.xml",St.THEME),o="xl/styles."+r,bt(i,o,kN(t,e)),a.styles.push(o),er(e.wbrels,-1,"styles."+r,St.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",bt(i,o,t.vbaraw),a.vba.push(o),er(e.wbrels,-1,"vbaProject.bin",St.VBA)),o="xl/metadata."+r,bt(i,o,RN()),a.metadata.push(o),er(e.wbrels,-1,"metadata."+r,St.XLMETA),m.length>1&&(o="xl/persons/person.xml",bt(i,o,BH(m)),a.people.push(o),er(e.wbrels,-1,"persons/person.xml",St.PEOPLE)),bt(i,"[Content_Types].xml",WC(a,e)),bt(i,"_rels/.rels",uu(e.rels)),bt(i,"xl/_rels/workbook."+r+".rels",uu(e.wbrels)),delete e.revssf,delete e.ssf,i}function Jy(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ia(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function I$(t,e){return nt.find(t,"EncryptedPackage")?k$(t,e):ZN(t,e)}function D$(t,e){var r,n=t,a=e||{};return a.type||(a.type=Tt&&Buffer.isBuffer(t)?"buffer":"base64"),r=wC(n,a),A$(r,a)}function l3(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return tv(t.slice(r),e);default:break e}return Tu.to_workbook(t,e)}function O$(t,e){var r="",n=Jy(t,e);switch(e.type){case"base64":r=Ia(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=$o(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=lr(r)),e.type="binary",l3(r,e)}function F$(t,e){var r=t;return e.type=="base64"&&(r=Ia(r)),r=v0.utils.decode(1200,r.slice(2),"str"),e.type="binary",l3(r,e)}function M$(t){return t.match(/[^\x00-\x7F]/)?Vs(t):t}function cx(t,e,r,n){return n?(r.type="string",Tu.to_workbook(t,r)):Tu.to_workbook(e,r)}function av(t,e){xy();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return av(new Uint8Array(t),(r=yr(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),hu={},r.dateNF&&(hu.dateNF=r.dateNF),r.type||(r.type=Tt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Tt?"buffer":"binary",n=N7(t),typeof Uint8Array<"u"&&!Tt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=M$(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return r=yr(r),r.type="array",av(vy(n),r)}switch((a=Jy(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return I$(nt.read(n,r),r);break;case 9:if(a[1]<=8)return ZN(n,r);break;case 60:return tv(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return VU(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return xN.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?D$(n,r):cx(t,n,r,i);case 239:return a[3]===60?tv(n,r):cx(t,n,r,i);case 255:if(a[1]===254)return F$(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Uo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Uo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ev.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return TN.to_workbook(n,r);break;case 10:case 13:case 32:return O$(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return BU.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?ev.to_workbook(n,r):cx(t,n,r,i)}function o3(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Z0(e.file,nt.write(t,{type:Tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return nt.write(t,e)}function P$(t,e){var r=yr(e||{}),n=C$(t,r);return j$(n,r)}function j$(t,e){var r={},n=Tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?nt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(Ep(a))}return e.password&&typeof encrypt_agile<"u"?o3(encrypt_agile(a,e.password),e):e.type==="file"?Z0(e.file,a):e.type=="string"?lr(a):a}function L$(t,e){var r=e||{},n=MY(t,r);return o3(n,r)}function js(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return y0(Vs(n));case"binary":return Vs(n);case"string":return t;case"file":return Z0(e.file,n,"utf8");case"buffer":return Tt?Bi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):js(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function B$(t,e){switch(e.type){case"base64":return y0(t);case"binary":return t;case"string":return t;case"file":return Z0(e.file,t,"binary");case"buffer":return Tt?Bi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Wd(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?y0(r):e.type=="string"?lr(r):r;case"file":return Z0(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function c3(t,e){xy(),IX(t);var r=yr(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=c3(t,r);return r.type="array",Ep(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return js(CY(t,r),r);case"slk":case"sylk":return js(gN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return js(t3(t.Sheets[t.SheetNames[a]],r),r);case"txt":return B$(u3(t.Sheets[t.SheetNames[a]],r),r);case"csv":return js(Zy(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return js(xN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return Wd(ev.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return js(Tu.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return js(TN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return js(vN.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return js(s3(t,r),r);case"wk1":return Wd(Uo.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return Wd(Uo.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Wd(e3(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),L$(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return P$(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function V$(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function U$(t,e,r){var n={};return n.type="file",n.file=e,V$(n),c3(t,n)}function z$(t,e,r,n,a,i,o,u){var f=Ur(r),d=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,y=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:r,enumerable:!1})}catch{y.__rowNum__=r}else y.__rowNum__=r;if(!o||t[r])for(var w=e.s.c;w<=e.e.c;++w){var E=o?t[r][w]:t[n[w]+f];if(E===void 0||E.t===void 0){if(d===void 0)continue;i[w]!=null&&(y[i[w]]=d);continue}var b=E.v;switch(E.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(i[w]!=null){if(b==null)if(E.t=="e"&&b===null)y[i[w]]=null;else if(d!==void 0)y[i[w]]=d;else if(m&&b===null)y[i[w]]=null;else continue;else y[i[w]]=m&&(E.t!=="n"||E.t==="n"&&u.rawNumbers!==!1)?b:ji(E,b,u);b!=null&&(x=!1)}}return{row:y,isempty:x}}function Gm(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],o=0,u="",f={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},m=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof m){case"string":f=Lt(m);break;case"number":f=Lt(t["!ref"]),f.s.r=m;break;default:f=m}n>0&&(a=0);var x=Ur(f.s.r),y=[],w=[],E=0,b=0,T=Array.isArray(t),I=f.s.r,R=0,C={};T&&!t[I]&&(t[I]=[]);var G=d.skipHidden&&t["!cols"]||[],V=d.skipHidden&&t["!rows"]||[];for(R=f.s.c;R<=f.e.c;++R)if(!(G[R]||{}).hidden)switch(y[R]=Tr(R),r=T?t[I][R]:t[y[R]+x],n){case 1:i[R]=R-f.s.c;break;case 2:i[R]=y[R];break;case 3:i[R]=d.header[R-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=o=ji(r,null,d),b=C[o]||0,!b)C[o]=1;else{do u=o+"_"+b++;while(C[u]);C[o]=b,C[u]=1}i[R]=u}for(I=f.s.r+a;I<=f.e.r;++I)if(!(V[I]||{}).hidden){var H=z$(t,f,I,y,n,i,T,d);(H.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(w[E++]=H.row)}return w.length=E,w}var MS=/"/g;function H$(t,e,r,n,a,i,o,u){for(var f=!0,d=[],m="",x=Ur(r),y=e.s.c;y<=e.e.c;++y)if(n[y]){var w=u.dense?(t[r]||[])[y]:t[n[y]+x];if(w==null)m="";else if(w.v!=null){f=!1,m=""+(u.rawNumbers&&w.t=="n"?w.v:ji(w,null,u));for(var E=0,b=0;E!==m.length;++E)if((b=m.charCodeAt(E))===a||b===i||b===34||u.forceQuotes){m='"'+m.replace(MS,'""')+'"';break}m=="ID"&&(m='"ID"')}else w.f!=null&&!w.F?(f=!1,m="="+w.f,m.indexOf(",")>=0&&(m='"'+m.replace(MS,'""')+'"')):m="";d.push(m)}return u.blankrows===!1&&f?null:d.join(o)}function Zy(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Lt(t["!ref"]),i=n.FS!==void 0?n.FS:",",o=i.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,f=u.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),m="",x=[];n.dense=Array.isArray(t);for(var y=n.skipHidden&&t["!cols"]||[],w=n.skipHidden&&t["!rows"]||[],E=a.s.c;E<=a.e.c;++E)(y[E]||{}).hidden||(x[E]=Tr(E));for(var b=0,T=a.s.r;T<=a.e.r;++T)(w[T]||{}).hidden||(m=H$(t,a,T,x,o,f,i,n),m!=null&&(n.strip&&(m=m.replace(d,"")),(m||n.blankrows!==!1)&&r.push((b++?u:"")+m)));return delete n.dense,r.join("")}function u3(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Zy(t,e);return r}function G$(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Lt(t["!ref"]),i="",o=[],u,f=[],d=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)o[u]=Tr(u);for(var m=a.s.r;m<=a.e.r;++m)for(i=Ur(m),u=a.s.c;u<=a.e.c;++u)if(e=o[u]+i,r=d?(t[m]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=e+"="+n}return f}function f3(t,e,r){var n=r||{},a=+!n.skipHeader,i=t||{},o=0,u=0;if(i&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var f=typeof n.origin=="string"?Sr(n.origin):n.origin;o=f.r,u=f.c}var d,m={s:{c:0,r:0},e:{c:u,r:o+e.length-1+a}};if(i["!ref"]){var x=Lt(i["!ref"]);m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),o==-1&&(o=x.e.r+1,m.e.r=o+e.length-1+a)}else o==-1&&(o=0,m.e.r=e.length-1+a);var y=n.header||[],w=0;e.forEach(function(b,T){Dr(b).forEach(function(I){(w=y.indexOf(I))==-1&&(y[w=y.length]=I);var R=b[I],C="z",G="",V=ot({c:u+w,r:o+T+a});d=I0(i,V),R&&typeof R=="object"&&!(R instanceof Date)?i[V]=R:(typeof R=="number"?C="n":typeof R=="boolean"?C="b":typeof R=="string"?C="s":R instanceof Date?(C="d",n.cellDates||(C="n",R=un(R)),G=n.dateNF||lt[14]):R===null&&n.nullError&&(C="e",R=0),d?(d.t=C,d.v=R,delete d.w,delete d.R,G&&(d.z=G)):i[V]=d={t:C,v:R},G&&(d.z=G))})}),m.e.c=Math.max(m.e.c,u+y.length-1);var E=Ur(o);if(a)for(w=0;w<y.length;++w)i[Tr(w+u)+E]={t:"s",v:y[w]};return i["!ref"]=yt(m),i}function q$(t,e){return f3(null,t,e)}function I0(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Sr(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?I0(t,ot(e)):I0(t,ot({r:e,c:r||0}))}function W$(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function e_(){return{SheetNames:[],Sheets:{}}}function t_(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=o+a)!=-1;++a);}if(YN(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function X$(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=W$(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Y$(t,e){return t.z=e,t}function h3(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function $$(t,e,r){return h3(t,"#"+e,r)}function K$(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Q$(t,e,r,n){for(var a=typeof e!="string"?e:Lt(e),i=typeof e=="string"?e:yt(e),o=a.s.r;o<=a.e.r;++o)for(var u=a.s.c;u<=a.e.c;++u){var f=I0(t,o,u);f.t="n",f.F=i,delete f.v,o==a.s.r&&u==a.s.c&&(f.f=r,n&&(f.D=!0))}return t}var im={encode_col:Tr,encode_row:Ur,encode_cell:ot,encode_range:yt,decode_col:Ry,decode_row:Ny,split_cell:lB,decode_cell:Sr,decode_range:ha,format_cell:ji,sheet_add_aoa:BC,sheet_add_json:f3,sheet_add_dom:r3,aoa_to_sheet:Lu,json_to_sheet:q$,table_to_sheet:n3,table_to_book:n$,sheet_to_csv:Zy,sheet_to_txt:u3,sheet_to_json:Gm,sheet_to_html:t3,sheet_to_formulae:G$,sheet_to_row_object_array:Gm,sheet_get_cell:I0,book_new:e_,book_append_sheet:t_,book_set_sheet_visibility:X$,cell_set_number_format:Y$,cell_set_hyperlink:h3,cell_set_internal_link:$$,cell_add_comment:K$,sheet_set_array_formula:Q$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const J$="";function Z$({group:t,orders:e,currentUser:r,onEdit:n}){const a=r?.name===J$,[i,o]=re.useState(t.exchangeRate||.21),[u,f]=re.useState(t.shippingFee||0);re.useEffect(()=>{t.exchangeRate!==void 0&&o(t.exchangeRate),t.shippingFee!==void 0&&f(t.shippingFee)},[t]);const d=async()=>{if(a)try{await Br(Et(Ke,"artifacts","default-app-id","public","data","groups",t.id),{exchangeRate:Number(i),shippingFee:Number(u)}),console.log("")}catch(b){console.error("",b),alert("")}},m=re.useMemo(()=>e.map(b=>{const T=b.items.reduce((R,C)=>R+C.quantity,0),I=b.items.reduce((R,C)=>R+C.price*C.quantity,0);return{userId:b.userId,userName:b.userName,totalQty:T,totalAmount:I}}).sort((b,T)=>T.totalAmount-b.totalAmount),[e]),x=m.reduce((b,T)=>b+T.totalAmount,0),y=m.reduce((b,T)=>b+T.totalQty,0),w=y>0?u/y:0,E=()=>{const b=[];e.forEach(R=>{R.items.forEach(C=>{const G=C.price*C.quantity,V=w*C.quantity,H=G+V;b.push({:R.userName,:C.name,:C.spec||"-"," ()":C.price,:C.quantity," ()":G," ()":Math.round(V)," () ()":Math.round(H)," (NT$)":Math.round(H*i),:new Date(R.updatedAt).toLocaleString()})})});const T=im.json_to_sheet(b),I=im.book_new();im.book_append_sheet(I,T,""),U$(I,`_${t.title}_${i}.xlsx`)};return p.jsxs("div",{className:"space-y-6 text-slate-800 font-sans",children:[p.jsxs("div",{className:"bg-slate-900 p-4 rounded-lg border-2 border-yellow-400 shadow-lg text-white",children:[p.jsxs("h4",{className:"font-black italic text-xl text-yellow-400 mb-3 transform -skew-x-3",children:[p.jsx(ay,{size:20,className:"inline mr-2 fill-yellow-400 text-slate-900"})," "]}),p.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-bold text-slate-400 flex items-center gap-1",children:[p.jsx(Nk,{size:14,className:"text-red-500"}),"  (JPY  TWD)"]}),a?p.jsx("input",{type:"number",step:"0.001",value:i,onChange:b=>o(b.target.value),onBlur:d,className:"w-full px-3 py-1.5 rounded border-2 border-yellow-400 text-center font-black text-slate-900 focus:outline-none focus:ring-4 focus:ring-red-600 bg-yellow-100 shadow-md transition-all"}):p.jsx("span",{className:"font-mono text-2xl font-black text-yellow-400 bg-slate-800 px-3 py-1 rounded border border-yellow-400",children:i})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-bold text-slate-400 flex items-center gap-1",children:[p.jsx(cy,{size:14,className:"text-red-500"}),"  (JPY)"]}),a?p.jsx("input",{type:"number",value:u,onChange:b=>f(b.target.value),onBlur:d,className:"w-full px-3 py-1.5 rounded border-2 border-yellow-400 text-center font-black text-slate-900 focus:outline-none focus:ring-4 focus:ring-red-600 bg-yellow-100 shadow-md transition-all"}):p.jsx("span",{className:"font-mono text-2xl font-black text-yellow-400 bg-slate-800 px-3 py-1 rounded border border-yellow-400",children:u})]})]})]}),p.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center bg-white p-4 rounded-lg border-2 border-slate-900 shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] gap-4 sm:gap-0",children:[p.jsxs("div",{className:"flex gap-6 text-sm font-bold",children:[p.jsxs("div",{children:[p.jsx("span",{className:"text-slate-500 block text-xs",children:""}),p.jsx("span",{className:"font-black text-3xl text-red-600 italic",children:y})]}),p.jsxs("div",{className:"border-l border-slate-200 pl-4",children:[p.jsx("span",{className:"text-slate-500 block text-xs",children:" ()"}),p.jsxs("div",{className:"flex flex-col leading-snug",children:[p.jsxs("span",{className:"font-black text-xl text-slate-900",children:["",(x+Number(u)).toLocaleString()]}),p.jsxs("span",{className:"text-sm text-yellow-600 font-black tracking-wider",children:[" NT$",Math.round((x+Number(u))*i).toLocaleString()]})]})]})]}),a&&p.jsxs("button",{onClick:E,className:"w-full sm:w-auto flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded border-2 border-green-800 text-sm font-black italic shadow-[2px_2px_0px_0px_rgba(20,83,45,1)] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(Rk,{size:18})," EXCEL "]})]}),p.jsxs("div",{className:"border-2 border-slate-900 rounded-lg overflow-hidden shadow-lg bg-white",children:[p.jsxs("div",{className:"bg-slate-900 px-4 py-3 text-xs font-black text-yellow-400 flex justify-between uppercase",children:[p.jsx("span",{children:" ()"}),p.jsx("span",{className:"text-right",children:" (TWD)"})]}),p.jsxs("div",{className:"divide-y divide-slate-200 max-h-60 overflow-y-auto bg-white",children:[m.map(b=>{const T=Math.round(w*b.totalQty),I=b.totalAmount+T,R=Math.round(I*i);return p.jsxs("div",{className:"flex justify-between items-center px-4 py-3 text-sm hover:bg-slate-50 transition-colors",children:[p.jsxs("div",{className:"flex flex-col",children:[p.jsxs("span",{className:"font-black text-slate-900 flex items-center gap-1",children:[p.jsx(Rm,{size:14,className:"text-red-600"})," ",b.userName]}),p.jsxs("span",{className:"text-slate-500 text-xs italic",children:[b.totalQty," "]})]}),p.jsxs("div",{className:"text-right",children:[p.jsxs("div",{className:"font-black text-lg text-slate-900 font-mono",children:["",I.toLocaleString()]}),p.jsxs("div",{className:"text-xs font-bold bg-yellow-400/30 text-slate-900 px-1.5 py-0.5 rounded inline-block mt-1 border border-yellow-400",children:[" NT$",R.toLocaleString()]}),Number(u)>0&&p.jsxs("span",{className:"text-[10px] text-slate-400 font-medium ml-1 block",children:["(",b.totalAmount," + ",T,")"]})]})]},b.userId)}),m.length===0&&p.jsx("div",{className:"p-4 text-center text-slate-300 text-sm italic",children:""})]})]}),p.jsx("div",{className:"h-2 bg-yellow-400 border-t-2 border-slate-900 mt-5"}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("h4",{className:"font-black italic text-lg text-slate-900 flex items-center gap-2 transform -skew-x-3",children:[p.jsx(eP,{size:20,className:"text-red-600"})," "]}),e.map(b=>{const T=r&&b.userId===r.id,I=b.items.reduce((H,A)=>H+A.price*A.quantity,0),R=b.items.reduce((H,A)=>H+A.quantity,0),C=Math.round(w*R),G=I+C,V=Math.round(G*i);return p.jsxs("div",{className:`bg-white rounded-lg border-4 ${T?"border-red-600 shadow-[4px_4px_0px_0px_#FACC15]":"border-slate-900 shadow-md"} transition-all`,children:[p.jsxs("div",{className:`px-5 py-3 border-b-2 flex justify-between items-center ${T?"bg-red-50 border-red-200":"bg-slate-50 border-slate-100"}`,children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-black ${T?"bg-red-600 text-white":"bg-slate-900 text-yellow-400"}`,children:b.userName.charAt(0)}),p.jsxs("div",{className:"flex flex-col",children:[p.jsxs("span",{className:`font-black italic text-sm ${T?"text-red-700":"text-slate-900"}`,children:[b.userName," ",T&&"(YOU)"]}),p.jsx("span",{className:"text-[10px] text-slate-400 font-medium",children:new Date(b.updatedAt).toLocaleDateString()})]})]}),T&&n&&p.jsxs("button",{onClick:n,className:"flex items-center gap-1 bg-white text-blue-600 text-xs font-black px-3 py-1.5 rounded border-2 border-slate-900 shadow-sm hover:bg-blue-50 transition-all italic",children:[p.jsx(vp,{size:14})," "]})]}),p.jsxs("div",{className:"p-5 bg-white",children:[p.jsx("ul",{className:"space-y-3",children:b.items.map((H,A)=>p.jsxs("li",{className:"flex justify-between items-start text-sm border-b border-dashed border-slate-200 last:border-0 pb-2 last:pb-0",children:[p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{className:"text-slate-900 font-black text-base",children:H.name}),H.spec&&p.jsxs("span",{className:"text-slate-500 text-xs italic",children:[": ",H.spec]})]}),p.jsxs("div",{className:"flex flex-col items-end",children:[p.jsxs("span",{className:"font-black font-mono text-xl text-red-600 italic",children:["x ",H.quantity]}),p.jsx("div",{className:"text-right",children:p.jsxs("span",{className:"text-xs text-slate-500",children:["",H.price]})})]})]},A))}),p.jsxs("div",{className:"mt-4 pt-3 border-t-2 border-slate-200 flex flex-col items-end",children:[p.jsxs("div",{className:"flex gap-4 text-xs text-slate-400 mb-1 font-bold",children:[p.jsxs("span",{children:[" ",I.toLocaleString()]}),p.jsx("span",{children:"+"}),p.jsxs("span",{children:[" ",C]})]}),p.jsxs("div",{className:"flex items-baseline gap-2",children:[p.jsx("span",{className:"text-slate-500 text-sm",children:"TOTAL JPY"}),p.jsxs("span",{className:"font-black text-slate-900 font-mono text-2xl",children:["",G.toLocaleString()]})]}),p.jsxs("div",{className:"text-lg font-black bg-yellow-400 text-slate-900 px-3 py-0.5 rounded mt-1 italic border-2 border-slate-900",children:[" NT$",V.toLocaleString()]})]})]})]},b.userId)})]})]})}const Xd=250;function d3({group:t,orders:e,currentUser:r,onUpdate:n,isReadOnly:a=!1}){const i=!a&&(r?.name===""||r?.id==="yeye"),[o,u]=re.useState(t.secondPayment?.weights||{}),[f,d]=re.useState(t.secondPayment?.boxWeight||0),[m,x]=re.useState(t.secondPayment?.minChargeDiff||0),y=eK(()=>{const G=new Set;return e.forEach(V=>V.items?.forEach(H=>G.add(H.itemId))),t.items?.filter(V=>G.has(V.id))||[]},[t.items,e]),w=e.filter(G=>G.groupId===t.id);let E=0;w.forEach(G=>G.items.forEach(V=>E+=Number(V.quantity)||0));const b=new Set(w.map(G=>G.userId)).size,T=E>0?f*Xd/E:0,I=b>0?m/b:0,R=w.reduce((G,V)=>{let H=0,A=[];return V.items?.forEach(D=>{const N=parseFloat(o[D.itemId]||0),F=(N*Xd+T)*D.quantity;H+=F,A.push({name:D.name,qty:D.quantity,weight:N,subtotal:F})}),H+=I,G[V.userId]?(G[V.userId].details.push(...A),G[V.userId].total+=H):G[V.userId]={name:V.userName,details:A,total:H},G},{}),C=()=>{n({weights:o,boxWeight:f,minChargeDiff:m}),alert("")};return p.jsxs("div",{className:"space-y-6 max-h-[80vh] overflow-y-auto pr-2",children:[i&&p.jsxs("div",{className:"bg-white p-5 rounded-xl border-4 border-slate-900 shadow-[4px_4px_0px_0px_#000]",children:[p.jsxs("h3",{className:"font-black text-slate-900 mb-4 flex items-center gap-2 uppercase italic border-b-2 pb-2",children:[p.jsx(oy,{size:20,className:"text-blue-600"})," Weight Control Panel"]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border-2 border-slate-200",children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1 uppercase",children:"/ (kg)"}),p.jsx("input",{type:"number",step:"0.01",className:"w-full bg-transparent font-mono font-bold text-lg outline-none",value:f,onChange:G=>d(G.target.value)})]}),p.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg border-2 border-slate-200",children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1 uppercase",children:" (TWD)"}),p.jsx("input",{type:"number",className:"w-full bg-transparent font-mono font-bold text-lg outline-none",value:m,onChange:G=>x(G.target.value)})]})]}),p.jsx("p",{className:"text-[10px] font-black text-slate-400 mb-3 uppercase tracking-widest",children:"Individual Item Weights"}),p.jsx("div",{className:"space-y-3",children:y.map(G=>p.jsxs("div",{className:"flex items-center gap-3 bg-slate-50 p-2 rounded-lg border border-slate-200",children:[p.jsx("span",{className:"flex-1 text-xs font-bold text-slate-700 truncate",children:G.name}),p.jsxs("div",{className:"flex items-center gap-1 bg-white px-2 py-1 rounded border border-slate-300",children:[p.jsx("input",{type:"number",step:"0.001",placeholder:"0.000",className:"w-20 text-right font-mono font-black text-blue-600 outline-none",value:o[G.id]||"",onChange:V=>u({...o,[G.id]:V.target.value})}),p.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:"kg"})]})]},G.id))}),p.jsxs("button",{onClick:C,className:"w-full mt-6 py-3 bg-slate-900 text-yellow-400 rounded-xl font-black flex items-center justify-center gap-2 hover:bg-slate-800 shadow-[4px_4px_0px_0px_#ccc] transition-all active:translate-y-1 active:shadow-none",children:[p.jsx(nc,{size:18})," SAVE SETTINGS"]})]}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-end",children:[p.jsxs("h3",{className:"font-black text-slate-900 flex items-center gap-2 italic",children:[p.jsx(ay,{size:20,className:"text-red-600"})," "]}),a&&p.jsx("span",{className:"text-[10px] font-black text-blue-600 border-b-2 border-blue-600 pb-0.5",children:"READ ONLY MODE"})]}),Object.values(R).map((G,V)=>p.jsxs("div",{className:"bg-white border-2 border-slate-900 rounded-xl overflow-hidden shadow-sm",children:[p.jsxs("div",{className:"bg-slate-900 text-white px-4 py-2 flex justify-between items-center",children:[p.jsx("span",{className:"font-black italic uppercase tracking-tighter",children:G.name}),p.jsxs("span",{className:"font-mono font-black text-yellow-400",children:["Total: $",Math.round(G.total)]})]}),p.jsx("div",{className:"p-0",children:p.jsxs("table",{className:"w-full text-[11px] text-left",children:[p.jsx("thead",{className:"bg-slate-50 text-slate-400 font-bold uppercase border-b",children:p.jsxs("tr",{children:[p.jsx("th",{className:"p-2",children:"Item"}),p.jsx("th",{className:"p-2 text-center",children:"Qty"}),p.jsx("th",{className:"p-2 text-center",children:"Weight"}),p.jsx("th",{className:"p-2 text-right",children:"Subtotal"})]})}),p.jsxs("tbody",{className:"divide-y divide-slate-100",children:[G.details.map((H,A)=>p.jsxs("tr",{children:[p.jsx("td",{className:"p-2 font-bold text-slate-700",children:H.name}),p.jsx("td",{className:"p-2 text-center text-slate-500",children:H.qty}),p.jsxs("td",{className:"p-2 text-center font-mono text-slate-400",children:[H.weight,"kg"]}),p.jsxs("td",{className:"p-2 text-right font-mono font-bold",children:["$",Math.round(H.subtotal)]})]},A)),m>0&&p.jsxs("tr",{className:"bg-yellow-50/50",children:[p.jsx("td",{colSpan:3,className:"p-2 text-slate-500 italic",children:" (Person Share)"}),p.jsxs("td",{className:"p-2 text-right font-mono font-bold",children:["$",Math.round(I)]})]})]})]})})]},V))]}),a&&p.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border-2 border-dashed border-slate-300 flex items-start gap-3",children:[p.jsx(xp,{size:18,className:"text-slate-400 shrink-0 mt-0.5"}),p.jsxs("p",{className:"text-[10px] font-bold text-slate-500 leading-relaxed",children:["[(  ",Xd,") + (  ",Xd," / )]   + ( / ) "]})]})]})}function eK(t,e){const[r,n]=Xs.useState(t);return Xs.useEffect(()=>n(t()),e),r}function PS({images:t}){const[e,r]=re.useState(0),n=Array.isArray(t)&&t.length>0?t:[];if(n.length===0)return p.jsx("div",{className:"w-full h-full flex items-center justify-center bg-stone-100 text-stone-300",children:p.jsx(K0,{size:24,className:"opacity-20"})});const a=o=>{o.stopPropagation(),r(u=>(u+1)%n.length)},i=o=>{o.stopPropagation(),r(u=>(u-1+n.length)%n.length)};return p.jsxs("div",{className:"relative w-full h-full bg-stone-100 group",children:[p.jsx("img",{src:n[e],alt:"product",className:"w-full h-full object-cover transition-transform duration-500 hover:scale-105"}),n.length>1&&p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:i,className:"absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white text-stone-600",children:p.jsx(LM,{size:16})}),p.jsx("button",{onClick:a,className:"absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-white text-stone-600",children:p.jsx(kk,{size:16})}),p.jsx("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1",children:n.map((o,u)=>p.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${u===e?"bg-orange-500":"bg-white/70"}`},u))})]})]})}function tK({currentUser:t,onLogout:e,onOpenModal:r}){const[n,a]=re.useState(!1),i=t?.isMember,o=async()=>{if(t)if(t.isMember){if(t.memberValidUntil)window.confirm(`
`)&&(await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{memberValidUntil:null,memberCancelledAt:null}),alert(""));else if(window.confirm(`
 30 `)){const u=new Date;u.setDate(u.getDate()+30),await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberValidUntil:u.toISOString(),memberCancelledAt:new Date().toISOString()}),alert(`
 ${u.toLocaleDateString()}`)}}else window.confirm(` PLUS ULTRA 
`)&&(await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{isMember:!0,memberSince:new Date().toISOString(),memberValidUntil:null,memberCancelledAt:null}),alert(""))};return p.jsxs("div",{className:"relative z-50",children:[p.jsxs("button",{onClick:()=>a(!n),className:`w-10 h-10 rounded-full bg-slate-800 border-2 ${i?"border-purple-500":"border-yellow-400"} shadow-lg overflow-hidden hover:scale-105 transition-all relative`,children:[p.jsx("img",{src:t?.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${t?.name}`,alt:"avatar",className:"w-full h-full object-cover"}),i&&p.jsx("div",{className:"absolute -top-1 -right-1 bg-purple-600 rounded-full p-0.5 border border-white",children:p.jsx(Cm,{size:8,className:"text-white fill-white"})})]}),n&&p.jsxs(p.Fragment,{children:[p.jsx("div",{className:"fixed inset-0 z-[-1]",onClick:()=>a(!1)}),p.jsxs("div",{className:"absolute right-0 mt-2 w-60 bg-white rounded-lg shadow-xl border-2 border-slate-900 py-1 z-50 animate-in fade-in slide-in-from-top-2",children:[p.jsxs("div",{className:"px-3 py-2 border-b-2 border-slate-100 bg-slate-50",children:[p.jsxs("div",{className:"flex justify-between items-center mb-1",children:[p.jsxs("span",{className:"text-xs font-black text-slate-500 flex items-center gap-1",children:[p.jsx(Cm,{size:12,className:i?"text-purple-600 fill-purple-600":"text-slate-300"}),"PLUS "]}),i&&p.jsx("span",{className:"text-[10px] bg-purple-100 text-purple-700 px-1.5 rounded font-bold",children:"SUBSCRIBED"})]}),p.jsx("button",{onClick:o,className:`w-full text-xs font-bold py-1.5 rounded border-2 transition-all ${i&&t.memberValidUntil?"bg-green-100 text-green-700 border-green-300 hover:bg-green-200":i?"bg-white border-slate-300 text-slate-500 hover:bg-red-50 hover:text-red-500 hover:border-red-300":"bg-purple-600 border-purple-800 text-white hover:bg-purple-700"}`,children:i?t.memberValidUntil?"":"":" (NT$90/)"})]}),p.jsxs("button",{onClick:()=>{a(!1),r("changeName")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(bu,{size:16})," "]}),p.jsxs("button",{onClick:()=>{a(!1),r("changeAvatar")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(sy,{size:16})," "]}),p.jsxs("button",{onClick:()=>{a(!1),r("changePwd")},className:"w-full px-4 py-2 text-left text-sm hover:bg-yellow-50 flex items-center gap-2 text-slate-700 font-bold",children:[p.jsx(Dk,{size:16})," "]}),t?.name===""&&p.jsx("div",{className:"border-t border-slate-100 mt-1",children:p.jsxs(du,{to:"/admin/dashboard",className:"block px-4 py-2 text-sm text-blue-700 font-black hover:bg-blue-50 transition-colors flex items-center gap-2",onClick:()=>a(!1),children:[p.jsx(Pk,{size:16})," "]})}),p.jsx("div",{className:"border-t-2 border-slate-100 my-1"}),p.jsxs("button",{onClick:e,className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 text-red-600 flex items-center gap-2 font-black",children:[p.jsx(Ok,{size:16})," "]})]})]})]})}function rK({title:t="",user:e,children:r,onLogout:n,onOpenModal:a}){return p.jsx("header",{className:"sticky top-0 z-30 bg-slate-900 border-b-4 border-yellow-400 px-4 py-3 shadow-md",children:p.jsxs("div",{className:"max-w-5xl mx-auto flex flex-wrap items-center justify-between gap-y-3",children:[p.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto justify-center md:justify-start",children:[p.jsx("div",{className:"bg-yellow-400 p-2 rounded transform -skew-x-12 border-2 border-yellow-800",children:p.jsx(jk,{size:24,className:"text-slate-900 transform skew-x-12"})}),p.jsx("h1",{className:"text-3xl md:text-2xl font-black italic tracking-tight text-white drop-shadow-md",children:t})]}),p.jsxs("div",{className:"flex items-center w-full md:w-auto md:flex-1 md:justify-end gap-2",children:[p.jsx("div",{className:"flex-1 min-w-0 md:flex-none",children:r}),p.jsxs("div",{className:"text-right hidden md:block shrink-0",children:[p.jsx("p",{className:"text-xs text-slate-400",children:"HERO NAME"}),p.jsx("p",{className:"font-bold text-white tracking-wide",children:e?.name})]}),p.jsx("div",{className:"shrink-0 ml-1",children:p.jsx(tK,{currentUser:e,onLogout:n,onOpenModal:a})})]})]})})}function nK({isMember:t,fee:e,amount:r,description:n}){const i=n||`

  ()
 `;return p.jsxs("div",{className:`\r
            relative group border-r border-slate-700 mr-1 pr-2 sm:mr-2 sm:pr-4\r
            flex w-full items-center justify-end gap-3   /*  */\r
            sm:w-auto sm:flex-col sm:items-end sm:gap-0  /*  */\r
        `,children:[p.jsxs("button",{type:"button",onClick:()=>alert(i),className:`\r
                    focus:outline-none group/btn\r
                    flex items-center gap-2              /*  */\r
                    sm:mb-1 sm:gap-1.5\r
                `,children:[p.jsx("span",{className:"text-[16px] sm:text-base text-slate-400 font-bold whitespace-nowrap pt-0.5",children:""}),p.jsxs("span",{className:"text-[10px] text-yellow-500 group-hover/btn:text-yellow-400 border-b border-dashed border-yellow-500/50 flex items-center gap-0.5 transition-colors",children:[p.jsx("span",{className:"hidden sm:inline",children:"?"}),p.jsx(km,{className:"block sm:hidden",size:14}),p.jsx(km,{className:"hidden sm:block",size:10})]})]}),p.jsxs("div",{className:"text-yellow-400 font-black drop-shadow-sm text-right flex items-center",children:[p.jsx("span",{className:"text-xs mr-1 text-yellow-200 mt-1",children:"NT$"}),p.jsx("span",{className:"text-xl sm:text-xl font-mono",children:t?`${e} + ${r.toLocaleString()}`:r.toLocaleString()})]}),p.jsx("div",{className:"absolute top-12 right-0 w-max bg-slate-800 text-white text-xs p-2 rounded border border-yellow-400 shadow-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50 hidden sm:block whitespace-pre-wrap text-left",children:i})]})}const ux=["","","","","","","",""],aK=90;function sK({appUser:t,usersData:e,handleLogout:r}){const[n,a]=re.useState([]),[i,o]=re.useState([]),[u,f]=re.useState([]),[d,m]=re.useState([]),[x,y]=re.useState(null),[w,E]=re.useState(null),[b,T]=re.useState(null),[I,R]=re.useState("wishing"),[C,G]=re.useState(""),[V,H]=re.useState(""),[A,D]=re.useState("<div>Loading...</div>"),N=15,[M,F]=re.useState(1),[j,P]=re.useState(0),be=i.find(B=>B.id===w)||null;re.useEffect(()=>{const B=pn(qt(Ke,"artifacts","default-app-id","public","data","wishes"),je=>a(je.docs.map(ht=>({id:ht.id,...ht.data()})))),Xe=pn(qt(Ke,"artifacts","default-app-id","public","data","groups"),je=>o(je.docs.map(ht=>({id:ht.id,...ht.data()})))),Pe=pn(qt(Ke,"artifacts","default-app-id","public","data","orders"),je=>f(je.docs.map(ht=>({id:ht.id,...ht.data()})))),et=pn(qt(Ke,"artifacts","default-app-id","public","data","miscCharges"),je=>m(je.docs.map(ht=>({id:ht.id,...ht.data()})))),We=pn(Et(Ke,"artifacts","default-app-id","public","data","system","bulletin"),je=>{je.exists()&&D(je.data().content)});return()=>{B(),Xe(),Pe(),et(),We()}},[]),re.useEffect(()=>{F(1)},[I,C,V]);const ye=(B,Xe)=>{const Pe=B.updatedAt||B.createdAt;if(!Pe)return!1;const et=`${Xe}_${B.id}`;let We=t?.readHistory?.[et];if(!We){const je=`read_${t?.id}_${Xe}_${B.id}`;We=localStorage.getItem(je)}return We?new Date(Pe)>new Date(We):!0},se=async(B,Xe)=>{const Pe=new Date().toISOString(),et=`${Xe}_${B.id}`,We=`read_${t?.id}_${Xe}_${B.id}`;if(localStorage.setItem(We,Pe),P(je=>je+1),t&&t.id)try{const je=Et(Ke,"artifacts","default-app-id","public","data","users",t.id);await q0(je,{readHistory:{[et]:Pe}},{merge:!0})}catch(je){console.error("",je)}},ce=async B=>{t&&(await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{password:B}),alert(""),y(null))},le=async B=>{if(t)try{await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{name:B}),alert(""),y(null)}catch{alert("")}},te=async B=>{t&&(await Br(Et(Ke,"artifacts","default-app-id","public","data","users",t.id),{avatar:B}),alert(""),y(null))},_e=async B=>{try{b?await Br(Et(Ke,"artifacts","default-app-id","public","data","wishes",b.id),{...B,updatedAt:new Date().toISOString()}):await Bs(qt(Ke,"artifacts","default-app-id","public","data","wishes"),{...B,authorName:t.name,authorId:t.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),plusOnes:[]}),y(null),T(null)}catch{alert("")}},Q=async B=>{if(confirm(`${B.title}`))try{await wu(Et(Ke,"artifacts","default-app-id","public","data","wishes",B.id))}catch(Xe){console.error(Xe)}},L=async B=>{if(!t)return;se(B,"wish");const Xe=B.plusOnes||[],et=Xe.includes(t.name)?Xe.filter(We=>We!==t.name):[...Xe,t.name];await Br(Et(Ke,"artifacts","default-app-id","public","data","wishes",B.id),{plusOnes:et})},J=async B=>{const Xe={title:`[] ${B.ipName}`,type:"",infoUrl:B.sourceUrl,status:"",createdBy:t.name,createdById:t.id,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),exchangeRate:.21,shippingFee:0,deadline:"",items:B.items.map(Pe=>({id:Pe.id,name:Pe.name,price:Pe.price,limit:Pe.quantity,image:"",spec:""})),note:B.note,requestType:B.type,secondPayment:{},paymentStatus:""};try{const Pe=await Bs(qt(Ke,"artifacts","default-app-id","public","data","groups"),Xe),et=B.items.map(We=>({itemId:We.id,name:We.name,price:We.price,quantity:We.quantity,image:""}));await Bs(qt(Ke,"artifacts","default-app-id","public","data","orders"),{groupId:Pe.id,userId:t.id,userName:t.name,items:et,updatedAt:new Date().toISOString()}),y(null),alert("")}catch{alert("")}},Y=async(B,Xe)=>{const Pe=u.find(We=>We.groupId===Xe&&We.userId===t.id);if(B.length===0){if(Pe)try{await wu(Et(Ke,"artifacts","default-app-id","public","data","orders",Pe.id)),alert("")}catch{alert("")}y("viewOrders");return}const et={groupId:Xe,userId:t.id,userName:t.name,items:B,updatedAt:new Date().toISOString()};Pe?await Br(Et(Ke,"artifacts","default-app-id","public","data","orders",Pe.id),et):await Bs(qt(Ke,"artifacts","default-app-id","public","data","orders"),et),y("viewOrders")},ne=re.useMemo(()=>{if(!u||!i||u.length===0||!t)return 0;const B=u.reduce((Pe,et)=>{if(et.userId!==t.id)return Pe;const We=i.find(_t=>_t.id===et.groupId);if(!We)return Pe;const je=u.filter(_t=>_t.groupId===We.id);let ht=0;if(je.forEach(_t=>_t.items.forEach(Ft=>ht+=Number(Ft.quantity)||0)),["","",""].includes(We.status)){const _t=Number(We.exchangeRate||0),Ft=Number(We.shippingFee||0),Hr=ht>0?Ft/ht:0,ns=(et.items||[]).reduce((Xt,Or)=>Xt+(Number(Or.quantity)||0),0),Gn=(et.items||[]).reduce((Xt,Or)=>Xt+(Number(Or.price)||0)*(Number(Or.quantity)||0),0),zt=Hr*ns,Gr=Math.round((Gn+zt)*_t);let nn=0;if(We.secondPayment){const Or=We.secondPayment.weights||{},dt=parseFloat(We.secondPayment.boxWeight||0),rr=parseFloat(We.secondPayment.minChargeDiff||0),an=ht>0?dt*250/ht:0,Mt=new Set(je.map(qr=>qr.userId)),or=Mt.size>0?rr/Mt.size:0;et.items.forEach(qr=>{const dr=parseFloat(Or[qr.itemId]||0);nn+=(dr*250+an)*qr.quantity}),nn+=or}const qn=We.paymentStatus||"";if(qn==="")return Pe+Gr;if(qn==="")return Pe+Math.round(nn);if(qn==="+")return Pe+Gr+Math.round(nn)}return Pe},0),Xe=d.filter(Pe=>Pe.targetUserId===t.id&&(Pe.paymentStatus||"")==="").reduce((Pe,et)=>Pe+Number(et.amount||0),0);return B+Xe},[u,i,t,d]),{memberFeeSplit:ue,isMember:Te}=re.useMemo(()=>{if(!t||!e.length)return{memberFeeSplit:0,isMember:!1};const B=e.filter(Pe=>Pe.isMember).length;return{memberFeeSplit:B>0?Math.ceil(aK/B):0,isMember:t.isMember}},[t,e]),Re=B=>{let Xe=i.filter(Pe=>B.includes(Pe.status));return(C||V)&&(Xe=Xe.filter(Pe=>{if(!Pe.deadline||Pe.deadline==="")return!1;const et=new Date(Pe.deadline).getTime(),We=C?new Date(C).getTime():0,je=V?new Date(V).getTime()+864e5:1/0;return et>=We&&et<je})),Xe.sort((Pe,et)=>(Pe.releaseDate||"9999-12-31").localeCompare(et.releaseDate||"9999-12-31"))},Ae=I==="active"?Re([""]):I==="completed"?Re([""]):I==="shipping"?Re([""]):I==="closed"?Re([""]):[],Fe=Math.ceil(Ae.length/N),st=Ae.slice((M-1)*N,M*N);return p.jsxs("div",{className:"min-h-screen bg-slate-50 text-slate-800 font-sans pb-20 selection:bg-yellow-400 selection:text-black",children:[p.jsx(rK,{user:t,onLogout:r,onOpenModal:B=>y(B),children:p.jsx(nK,{isMember:Te,fee:ue,amount:ne})}),p.jsx("section",{className:"max-w-5xl mx-auto mt-6 px-4",children:p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[p.jsxs("div",{className:"md:col-span-3 bg-white rounded-lg shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] border-2 border-slate-900 overflow-hidden flex flex-col",children:[p.jsxs("div",{className:"bg-yellow-400 border-b-2 border-slate-900 p-3 flex items-center gap-2 text-slate-900 font-black italic transform -skew-x-6",children:[p.jsx(zx,{size:24,className:"fill-slate-900"}),p.jsx("h2",{children:"ACADEMY NEWS"})]}),p.jsx("div",{className:"p-6 flex-1 prose prose-slate prose-sm max-w-none text-slate-700 font-medium",dangerouslySetInnerHTML:{__html:A}})]}),p.jsx("div",{className:"md:col-span-1",children:p.jsx(du,{to:"/jf26",className:"block w-full h-full group hover:-translate-y-1 transition-all",children:p.jsxs("div",{className:"h-full bg-white p-2 rounded-xl border-4 border-slate-900 shadow-[4px_4px_0px_0px_#FACC15] overflow-hidden relative flex flex-col",children:[p.jsx("div",{className:"bg-slate-900 text-yellow-400 font-black text-center text-sm py-1 mb-1 italic",children:"JF26 "}),p.jsx("img",{src:"https://www.jumpfesta.com/assets/images/top_jumpfesta_pc@2x.webp",alt:"JF26",className:"w-full h-full object-cover rounded-lg border-2 border-slate-100"}),p.jsx("div",{className:"absolute top-2 right-2 bg-red-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full animate-pulse border border-white shadow-sm rotate-12",children:"HOT!"})]})})})]})}),p.jsx("nav",{className:"max-w-5xl mx-auto mt-8 px-4",children:p.jsx("div",{className:"bg-white p-1 rounded-lg shadow-sm border-2 border-slate-200 flex justify-around gap-1",children:[{id:"wishing",label:"",icon:mT},{id:"active",label:"",icon:Im},{id:"completed",label:"",icon:gp},{id:"shipping",label:"",icon:Fk},{id:"misc",label:"",icon:Ik},{id:"closed",label:"",icon:bM}].map(B=>p.jsxs("button",{onClick:()=>R(B.id),className:`flex-1 flex flex-col items-center justify-center gap-1 py-2 rounded font-black transition-all border-2 ${I===B.id?"bg-slate-900 border-slate-900 text-yellow-400 shadow-md transform -translate-y-1":"bg-transparent border-transparent text-slate-500 hover:bg-slate-100 hover:text-slate-900"}`,children:[p.jsx(B.icon,{size:20,className:I===B.id?"animate-pulse":""}),p.jsx("span",{className:"text-[11px] sm:text-sm whitespace-nowrap",children:B.label})]},B.id))})}),p.jsxs("main",{className:"max-w-5xl mx-auto px-4 py-8",children:[I==="wishing"&&p.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:[p.jsx("div",{className:"flex justify-end mb-6",children:p.jsxs("button",{onClick:()=>{T(null),y("wish")},className:"px-6 py-2 bg-red-600 text-white border-2 border-red-800 rounded font-black hover:bg-red-700 flex items-center gap-2 shadow-[2px_2px_0px_0px_rgba(153,27,27,1)] italic",children:[p.jsx(ql,{size:20})," MAKE A WISH"]})}),p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(B=>p.jsxs("div",{className:"bg-white rounded-lg p-4 border-2 border-slate-200 hover:border-slate-900 hover:shadow-[4px_4px_0px_0px_rgba(15,23,42,1)] transition-all flex flex-col relative",onClick:()=>se(B,"wish"),children:[ye(B,"wish")&&p.jsx("div",{className:"absolute -top-3 -left-3 bg-red-600 text-white text-xs font-black px-2 py-1 shadow-md -rotate-12 z-10 border-2 border-white animate-bounce",children:"NEW!"}),p.jsx("div",{className:"mb-3 aspect-video bg-slate-100 rounded overflow-hidden",children:p.jsx(PS,{images:B.images})}),p.jsx("h3",{className:"font-bold text-lg text-slate-900 line-clamp-2 mb-2",children:B.title}),p.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[p.jsxs("span",{className:"bg-yellow-100 text-yellow-800 text-xs px-2 py-1 rounded font-bold",children:["BY: ",B.authorName]}),B.url&&p.jsxs("a",{href:B.url,target:"_blank",rel:"noreferrer",onClick:Xe=>Xe.stopPropagation(),className:"text-blue-600 font-bold text-xs hover:underline flex items-center gap-1",children:[p.jsx(Ti,{size:10})," Link"]})]}),p.jsx("p",{className:"text-slate-600 text-sm mb-4 line-clamp-3 bg-slate-50 p-2 rounded",children:B.note||""}),p.jsxs("div",{className:"pt-4 border-t border-slate-100 flex justify-between items-end mt-auto",children:[p.jsx("div",{className:"text-xs font-bold text-red-600",children:B.plusOnes?.length>0&&p.jsxs("span",{className:"flex items-center gap-1",children:[p.jsx(mT,{size:10,className:"fill-red-600"})," ",B.plusOnes.length," "]})}),p.jsxs("div",{className:"flex gap-2",children:[t?.id===B.authorId&&p.jsx("button",{onClick:Xe=>{Xe.stopPropagation(),Q(B)},className:"text-slate-400 hover:text-red-600 p-1",children:p.jsx(_p,{size:16})}),p.jsx("button",{onClick:Xe=>{Xe.stopPropagation(),L(B)},className:`px-3 py-1.5 rounded-full text-sm font-black border-2 transition-all ${B.plusOnes?.includes(t?.name)?"bg-red-100 border-red-500 text-red-600":"bg-white text-slate-400 hover:border-slate-400"}`,children:"+1"})]})]})]},B.id))})]}),I==="misc"&&p.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:p.jsx("div",{className:"bg-white rounded-lg shadow-sm border-2 border-slate-200 overflow-hidden",children:p.jsxs("table",{className:"w-full text-sm text-left font-bold",children:[p.jsx("thead",{className:"bg-slate-100 text-slate-700 border-b-2 border-slate-200",children:p.jsxs("tr",{children:[p.jsx("th",{className:"px-4 py-3",children:""}),p.jsx("th",{className:"px-4 py-3",children:""}),p.jsx("th",{className:"px-4 py-3",children:""}),p.jsx("th",{className:"px-4 py-3 text-right",children:""}),p.jsx("th",{className:"px-4 py-3 text-center",children:""})]})}),p.jsx("tbody",{children:d.filter(B=>B.targetUserId===t?.id||t?.name==="").sort((B,Xe)=>new Date(Xe.createdAt)-new Date(B.createdAt)).map(B=>p.jsxs("tr",{className:`border-b ${(B.paymentStatus||"")===""?"bg-green-50/50":"hover:bg-slate-50"}`,children:[p.jsx("td",{className:"px-4 py-3 text-slate-500 font-mono text-xs",children:new Date(B.createdAt).toLocaleDateString()}),p.jsx("td",{className:"px-4 py-3",children:B.title}),p.jsx("td",{className:"px-4 py-3 text-slate-400 text-xs truncate max-w-[120px]",children:B.note||"-"}),p.jsxs("td",{className:`px-4 py-3 text-right ${(B.paymentStatus||"")===""?"text-slate-400 line-through":""}`,children:["$",B.amount]}),p.jsx("td",{className:"px-4 py-3 text-center",children:p.jsx("span",{className:`px-2 py-1 rounded text-[10px] ${(B.paymentStatus||"")===""?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:B.paymentStatus||""})})]},B.id))})]})})}),["active","completed","shipping","closed"].includes(I)&&p.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:[p.jsxs("div",{className:"mb-6 bg-slate-200 p-3 rounded-lg flex flex-col sm:flex-row items-center gap-4 border-2 border-slate-300",children:[p.jsx(Mk,{size:18,className:"text-slate-500"}),p.jsxs("div",{className:"flex items-center gap-2 flex-1 w-full font-bold",children:[p.jsx("input",{type:"date",className:"border-2 border-slate-300 rounded px-2 py-1 text-sm flex-1",value:C,onChange:B=>G(B.target.value)}),p.jsx("span",{className:"text-slate-400",children:"~"}),p.jsx("input",{type:"date",className:"border-2 border-slate-300 rounded px-2 py-1 text-sm flex-1",value:V,onChange:B=>H(B.target.value)}),(C||V)&&p.jsx("button",{onClick:()=>{G(""),H("")},className:"text-xs bg-slate-400 text-white px-3 py-1.5 rounded",children:""})]})]}),I==="active"&&t?.name!==""&&p.jsx("div",{className:"flex justify-end mb-6",children:p.jsxs("button",{onClick:()=>y("createPersonalRequest"),className:"px-6 py-2 bg-purple-600 text-white rounded border-2 border-purple-800 font-black hover:bg-purple-700 flex items-center gap-2 shadow-[4px_4px_0px_0px_#4c1d95] italic",children:[p.jsx(Im,{size:18})," "]})}),p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:st.map(B=>{const Xe=!!u.find(Pe=>Pe.groupId===B.id&&Pe.userId===t?.id);return p.jsxs("div",{className:`bg-white rounded-lg p-5 border-2 border-slate-900 flex flex-col relative ${I==="closed"?"opacity-75 grayscale-[0.5]":""}`,onClick:()=>I==="active"&&se(B,"group"),children:[I==="active"&&ye(B,"group")&&p.jsx("div",{className:"absolute -top-3 -left-3 bg-red-600 text-white text-xs font-black px-2 py-1 shadow-md -rotate-12 z-10 border-2 border-white animate-bounce",children:"NEW!"}),p.jsxs("div",{className:"flex flex-col gap-1 mb-2",children:[p.jsx("span",{className:`self-start px-2 py-0.5 text-[10px] font-black rounded border ${B.type===""?"bg-green-600 text-white border-green-800":B.type===""?"bg-purple-600 text-white border-purple-800":"bg-yellow-400 text-slate-900 border-slate-900"}`,children:B.type===""?" ":B.type===""?" ":" "}),p.jsx("h3",{className:"font-black text-xl italic",children:B.title})]}),p.jsx("div",{className:"mb-4 aspect-video bg-slate-100 rounded overflow-hidden",children:p.jsx(PS,{images:B.images||[]})}),p.jsxs("div",{className:"space-y-2 text-sm text-slate-600 mb-6 flex-1 font-bold",children:[p.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1",children:[p.jsx("span",{children:""}),p.jsx("span",{className:"text-red-600",children:B.deadline})]}),B.releaseDate&&p.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1",children:[p.jsx("span",{children:""}),p.jsx("span",{className:"text-blue-600",children:B.releaseDate})]}),B.infoUrl&&p.jsxs("p",{className:"flex justify-between border-b border-slate-100 pb-1",children:[p.jsx("span",{children:""}),p.jsx("a",{href:B.infoUrl,target:"_blank",rel:"noreferrer",onClick:Pe=>Pe.stopPropagation(),className:"text-blue-600 hover:underline",children:"Link"})]}),Xe&&I==="active"&&p.jsx("div",{className:"mt-2 bg-green-100 text-green-700 border border-green-300 px-2 py-1 rounded text-center text-xs font-black",children:" (ORDERED)"})]}),B.status!==""&&p.jsxs("div",{className:"mb-4",children:[p.jsx("div",{className:"flex justify-between text-[10px] text-slate-400 mb-1 font-bold",children:ux.map(Pe=>p.jsx("span",{className:B.trackingStatus===Pe?"text-blue-600":"",children:Pe},Pe))}),p.jsx("div",{className:"h-3 bg-slate-200 rounded-full flex border border-slate-300 overflow-hidden",children:ux.map((Pe,et)=>p.jsx("div",{className:`flex-1 border-r border-white last:border-0 ${et<=ux.indexOf(B.trackingStatus||"")?"bg-blue-600":""}`},Pe))})]}),p.jsxs("div",{className:"flex gap-2 mt-auto",children:[I==="active"&&p.jsx("button",{className:`flex-1 px-4 py-2 rounded font-black text-white border-2 transition-all ${Xe?"bg-green-600 border-green-800":"bg-red-600 border-red-800"}`,onClick:Pe=>{Pe.stopPropagation(),E(B.id),y("joinGroup")},children:Xe?"":""}),p.jsx("button",{className:`px-3 py-2 rounded font-bold border-2 flex-1 ${I==="active"?"bg-white border-slate-300 text-slate-600":"bg-slate-100 border-slate-300 text-slate-700"}`,onClick:Pe=>{Pe.stopPropagation(),E(B.id),y("viewOrders")},children:""}),["shipping","closed"].includes(I)&&p.jsx("button",{className:"px-3 py-2 rounded font-bold border-2 bg-yellow-400 border-slate-900 text-slate-900 flex-1",onClick:Pe=>{Pe.stopPropagation(),E(B.id),y("secondPayment")},children:""})]})]},B.id)})}),Fe>1&&p.jsxs("div",{className:"flex justify-center items-center gap-2 mt-8",children:[p.jsx("button",{onClick:()=>F(B=>Math.max(1,B-1)),className:"px-3 py-1 rounded font-black border-2 border-slate-900 bg-white",children:"PREV"}),Array.from({length:Fe},(B,Xe)=>Xe+1).map(B=>p.jsx("button",{onClick:()=>F(B),className:`w-8 h-8 rounded border-2 border-slate-900 font-black ${M===B?"bg-slate-900 text-yellow-400":"bg-white"}`,children:B},B)),p.jsx("button",{onClick:()=>F(B=>Math.min(Fe,B+1)),className:"px-3 py-1 rounded font-black border-2 border-slate-900 bg-white",children:"NEXT"})]})]})]}),p.jsx($n,{isOpen:x==="wish",onClose:()=>{y(null),T(null)},title:b?"":"",children:p.jsx(YL,{onSubmit:_e,onCancel:()=>{y(null),T(null)},initialData:b})}),p.jsx($n,{isOpen:x==="createPersonalRequest",onClose:()=>y(null),title:"",children:p.jsx($L,{onSubmit:J,onCancel:()=>y(null)})}),p.jsx($n,{isOpen:x==="secondPayment",onClose:()=>y(null),title:"",children:be&&p.jsx(d3,{group:be,orders:u.filter(B=>B.groupId===be?.id),currentUser:t,onUpdate:null,isReadOnly:!0})}),p.jsx($n,{isOpen:x==="changeName",onClose:()=>y(null),title:"",children:p.jsx(tC,{currentUser:t,onSubmit:le,onCancel:()=>y(null)})}),p.jsx($n,{isOpen:x==="changePwd",onClose:()=>y(null),title:"",children:p.jsx(nC,{onSubmit:ce})}),p.jsx($n,{isOpen:x==="changeAvatar",onClose:()=>y(null),title:"",children:p.jsx(rC,{currentUser:t,onSubmit:te})}),p.jsx($n,{isOpen:x==="joinGroup",onClose:()=>y(null),title:`${be?.title}`,children:be&&p.jsx(KL,{group:be,currentOrder:u.find(B=>B.groupId===be?.id&&B.userId===t?.id),onSubmit:B=>Y(B,be.id)})}),p.jsx($n,{isOpen:x==="viewOrders",onClose:()=>y(null),title:`${be?.title}`,children:be&&p.jsx(Z$,{group:be,orders:u.filter(B=>B.groupId===be?.id),currentUser:t,onEdit:be?.status===""?()=>y("joinGroup"):null})})]})}const iK=()=>{const[t,e]=re.useState(!1),[r,n]=re.useState([]),[a,i]=re.useState([]),[o,u]=re.useState(null),[f,d]=re.useState(0),m=O0(),x=["artifacts","default-app-id","public","data","backorders"],y=["artifacts","default-app-id","public","data","groups"],w=V=>n(H=>[...H,V]),E=async()=>{try{const V=qt(Ke,...x),H=await bl(V),A=new Set;H.forEach(D=>{const N=D.data();N.sheetCategory&&A.add(N.sheetCategory)}),i(Array.from(A).sort())}catch(V){console.error("",V)}},b=async()=>{try{const V=qt(Ke,...y),H=await bl(V);d(H.size)}catch(V){console.error(V)}};re.useEffect(()=>{E(),b()},[]);const T=async V=>{if(window.confirm(` ${V}`)){e(!0),w(`  [${V}]...`);try{const H=qt(Ke,...x),A=jx(H,GA("sheetCategory","==",V)),D=await bl(A),N=Lx(Ke);D.forEach(M=>N.delete(M.ref)),await N.commit(),w(" "),E()}catch(H){w(` : ${H.message}`)}finally{e(!1)}}},I=V=>{const H=V.target.files[0];H&&(u(H),n([` ${H.name}`," "]))},R=async()=>{if(!o)return;e(!0),n(H=>[...H," ..."]);const V=new FileReader;V.onload=async H=>{try{const A=H.target.result,D=av(A,{type:"binary"});let N=D.SheetNames.filter(F=>F.includes(""));N.length===0&&(N=D.SheetNames),w(` : ${N.join(", ")}`);const M=[];if(N.forEach(F=>{const j=D.Sheets[F],P=im.sheet_to_json(j,{header:1});let be=-1,ye={};for(let se=0;se<P.length;se++)if(JSON.stringify(P[se]).includes("")){be=se,P[se].forEach((ce,le)=>{if(typeof ce!="string")return;const te=ce.trim();te.includes("")?ye.title=le:te.includes("")?ye.type=le:te.includes("")||te.includes("")?ye.orderDate=le:te.includes("")?ye.rate=le:te.includes("")?ye.status=le:te.includes("")?ye.payProgress=le:te.includes("")?ye.payStatus=le:te.includes("")&&(ye.link=le)});break}if(be!==-1)for(let se=be+1;se<P.length;se++){const ce=P[se];if(!ye.title||!ce[ye.title])continue;let le="";ce[ye.status]&&String(ce[ye.status]).includes("")&&(le="");let te=ce[ye.orderDate],_e=ce[ye.rate];const Q={title:ce[ye.title],type:ce[ye.type]||"",orderDate:te||"",rate:parseFloat(_e)||0,status:le,paymentStatus:`${ce[ye.payProgress]||""} ${ce[ye.payStatus]||""}`.trim(),link:ce[ye.link]||"",sheetCategory:F,createdAt:new Date().toISOString(),isArchived:le===""};Object.keys(Q).forEach(L=>Q[L]===void 0&&delete Q[L]),M.push(Q)}}),M.length===0)w(" ");else{const F=qt(Ke,...x),j=500;let P=0;for(let be=0;be<M.length;be+=j){const ye=M.slice(be,be+j);await Promise.all(ye.map(async se=>{await Bs(F,se),P++}))}w(`  ${P}  backorders`),E(),u(null),document.getElementById("file_input").value=""}}catch(A){w(` : ${A.message}`)}finally{e(!1)}},V.readAsBinaryString(o)},C=async()=>{if(window.confirm(`backordersgroups
 Groups

`)){e(!0),w("  Groups...");try{const V=qt(Ke,...x),H=await bl(V);if(H.empty){w(" backorders "),e(!1);return}const A=qt(Ke,...y);let D=0;const N=H.docs.map(async M=>{const F=M.data();let j=F.rate,P=F.orderDate;(j===0||!j)&&typeof F.orderDate=="number"&&F.orderDate<1&&(j=F.orderDate,P="");let be="2025-12-31T23:59";typeof P=="string"&&P.includes(".")&&(be=P.replace(/\./g,"-")+"T23:59");const ye={title:F.title,exchangeRate:Number(j)||0,deadline:be,status:"",trackingStatus:F.status||"",paymentStatus:F.paymentStatus||"",type:F.type||"",infoUrl:F.link||"",createdBy:"",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),sheetCategory:F.sheetCategory,images:[],items:[{id:1,name:F.title,spec:"",price:"0",image:""}]};await Bs(A,ye),D++});await Promise.all(N),w(`  ${D} `),b()}catch(V){console.error(V),w(` : ${V.message}`)}finally{e(!1)}}},G=async()=>{const V=prompt(`  (Groups)


 'DELETE' `);if(V!=="DELETE"){V!==null&&alert("");return}e(!0),w("  Groups ...");try{const H=qt(Ke,...y),A=await bl(H);if(A.empty){w(" Groups "),e(!1);return}const D=Lx(Ke);let N=0;A.forEach(M=>{D.delete(M.ref),N++}),await D.commit(),w(`  Groups ${N} `),b()}catch(H){w(` : ${H.message}`)}finally{e(!1)}};return p.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:""}),p.jsx("button",{onClick:()=>m("/"),className:"px-4 py-2 bg-white border rounded shadow-sm hover:bg-gray-50",children:" "})]}),p.jsxs("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-blue-500",children:[p.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-2 flex items-center gap-2",children:[p.jsx(YM,{}),"  1 Excel  (Backorders)"]}),p.jsxs("div",{className:"flex gap-4 items-end",children:[p.jsx("input",{id:"file_input",type:"file",accept:".xlsx, .xls",onChange:I,disabled:t,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),p.jsx("button",{onClick:R,disabled:!o||t,className:`px-6 py-2 rounded-lg font-bold text-white ${o?"bg-blue-600 hover:bg-blue-700":"bg-gray-400"}`,children:""})]})]}),p.jsxs("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-yellow-500",children:[p.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:" 2"}),p.jsx("div",{className:"bg-gray-50 rounded-md p-4 max-h-40 overflow-y-auto mb-4",children:a.length===0?p.jsx("p",{className:"text-sm text-gray-400",children:""}):p.jsx("ul",{className:"space-y-2",children:a.map(V=>p.jsxs("li",{className:"flex justify-between items-center text-sm",children:[p.jsx("span",{children:V}),p.jsxs("button",{onClick:()=>T(V),className:"text-red-600 hover:underline flex items-center gap-1",children:[p.jsx(_p,{size:14})," "]})]},V))})})]}),p.jsx("div",{className:"bg-white shadow rounded-lg p-6 border-l-4 border-green-500",children:p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("div",{children:[p.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[p.jsx(DP,{}),"  3 (Sync to Groups)"]}),p.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[" Groups  ",p.jsx("span",{className:"font-bold text-green-600",children:f})," "]})]}),p.jsx("button",{onClick:C,disabled:t||a.length===0,className:`px-6 py-3 rounded-lg font-bold text-white shadow-lg transition-transform transform active:scale-95 ${t||a.length===0?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"}`,children:" "})]})}),p.jsx("div",{className:"bg-red-50 shadow rounded-lg p-6 border-2 border-red-200",children:p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsxs("div",{children:[p.jsxs("h3",{className:"text-lg font-bold text-red-700 flex items-center gap-2",children:[p.jsx(Bk,{})," "]}),p.jsx("p",{className:"text-sm text-red-600 mt-1",children:" Groups "})]}),p.jsxs("button",{onClick:G,disabled:t||f===0,className:`px-4 py-2 rounded-lg font-bold text-white shadow transition-colors ${t||f===0?"bg-gray-400 cursor-not-allowed":"bg-red-600 hover:bg-red-700"}`,children:["  Groups (",f,")"]})]})}),p.jsx("div",{className:"bg-black text-green-400 p-4 rounded-lg shadow h-64 overflow-y-auto font-mono text-xs leading-5",children:r.length===0?"...":r.map((V,H)=>p.jsx("div",{className:"border-b border-gray-800 pb-1 mb-1 break-all",children:V},H))})]})})},lK=({onOpenSecondPay:t})=>{const[e,r]=re.useState([]),[n,a]=re.useState([]),[i,o]=re.useState(null),[u,f]=re.useState([]),[d,m]=re.useState(!0),[x,y]=re.useState(!1),[w,E]=re.useState({});O0();const b=["artifacts","default-app-id","public","data","groups"],T=["artifacts","default-app-id","public","data","users"],I=["artifacts","default-app-id","public","data","orders"],R=async()=>{m(!0);try{const le=qt(Ke,...b),te=jx(le,f9("createdAt","desc")),Q=(await bl(te)).docs.map(Y=>({id:Y.id,...Y.data()}));if(r(Q),Q.length>0){const Y=Q[0].sheetCategory||"";E({[Y]:!0})}const L=qt(Ke,...T),J=await bl(L);a(J.docs.map(Y=>({id:Y.id,...Y.data()})))}catch(le){console.error("",le)}finally{m(!1)}};re.useEffect(()=>{R()},[]);const C=re.useMemo(()=>{const le={};return e.forEach(te=>{const _e=te.sheetCategory||"";le[_e]||(le[_e]=[]),le[_e].push(te)}),Object.keys(le).sort().reduce((te,_e)=>(te[_e]=le[_e],te),{})},[e]),G=le=>{E(te=>({...te,[le]:!te[le]}))},V=async le=>{o(le),f([]);try{const te=qt(Ke,...I),_e=jx(te,GA("groupId","==",le.id)),Q=await bl(_e);f(Q.docs.map(L=>({id:L.id,...L.data()})))}catch(te){console.error("",te)}},H=async()=>{if(i){y(!0);try{const le=Et(Ke,...b,i.id),{id:te,..._e}=i;_e.updatedAt=new Date().toISOString(),_e.trackingStatus===""?(_e.isArchived=!0,_e.status=""):_e.trackingStatus===""?_e.status="":(_e.isArchived=!1,_e.status=""),await Br(le,_e);const Q=qt(Ke,...I),L=u.map(async J=>{const Y=J.items?.reduce((Te,Re)=>Te+Number(Re.price)*Number(Re.quantity),0)||0,ne=Math.ceil(Y*(i.exchangeRate||0)),ue={groupId:i.id,userId:J.userId,userName:J.userName,items:J.items,totalJpy:Y,totalTwd:ne,updatedAt:new Date().toISOString()};if(J.isNew){const{isNew:Te,id:Re,...Ae}=ue;return Ae.createdAt=new Date().toISOString(),Bs(Q,Ae)}else{const Te=Et(Ke,...I,J.id);return Br(Te,ue)}});await Promise.all(L),r(J=>J.map(Y=>Y.id===i.id?{...Y,..._e}:Y)),alert(" ")}catch{alert(" ")}finally{y(!1)}}},A=async le=>{if(window.confirm(" "))try{await wu(Et(Ke,...b,le)),o(null),R()}catch{alert("")}},D=(le,te,_e)=>{const Q=[...i.items];Q[le][te]=_e,o({...i,items:Q})},N=()=>o({...i,items:[...i.items||[],{id:Date.now(),name:"",spec:"",price:"",image:""}]}),M=le=>o({...i,items:i.items.filter((te,_e)=>_e!==le)}),F=()=>f([...u,{id:`temp-${Date.now()}`,isNew:!0,userId:"",userName:"",items:[]}]),j=async le=>{window.confirm("")&&(u[le].isNew||await wu(Et(Ke,...I,u[le].id)),f(u.filter((te,_e)=>_e!==le)))},P=(le,te)=>{const _e=n.find(L=>L.id===te),Q=[...u];Q[le].userId=te,Q[le].userName=_e?_e.name:"",f(Q)},be=le=>{const te=[...u];te[le].items.push({itemId:"",name:"",quantity:1,price:0,spec:""}),f(te)},ye=(le,te,_e,Q)=>{const L=[...u];if(_e==="itemId"){const J=i.items.find(Y=>String(Y.id)===String(Q));J&&(L[le].items[te]={...L[le].items[te],itemId:J.id,name:J.name,price:J.price,spec:J.spec||""})}else L[le].items[te][_e]=Q;f(L)},se=(le,te)=>{const _e=[...u];_e[le].items=_e[le].items.filter((Q,L)=>L!==te),f(_e)},ce=le=>le.items?.reduce((te,_e)=>te+Number(_e.price)*Number(_e.quantity),0)||0;return d?p.jsx("div",{className:"p-10 text-center font-bold text-slate-400 animate-pulse uppercase tracking-widest italic",children:"Syncing Base..."}):p.jsxs("div",{className:"flex h-[calc(100vh-160px)] bg-gray-100 overflow-hidden text-sm rounded-2xl border-4 border-slate-900 shadow-[8px_8px_0px_0px_#0f172a]",children:[p.jsxs("div",{className:"w-1/3 md:w-1/4 bg-white border-r-4 border-slate-900 flex flex-col",children:[p.jsx("div",{className:"p-4 border-b-4 border-slate-900 bg-slate-900 flex justify-between items-center text-white",children:p.jsxs("h2",{className:"font-black italic tracking-tighter uppercase flex items-center gap-2",children:[p.jsx(dT,{size:18,className:"text-yellow-400"})," Mission List"]})}),p.jsx("div",{className:"flex-1 overflow-y-auto p-2 space-y-1 bg-slate-50",children:Object.entries(C).map(([le,te])=>p.jsxs("div",{className:"mb-1",children:[p.jsxs("button",{onClick:()=>G(le),className:"w-full flex items-center gap-2 p-2 hover:bg-white text-left font-black text-slate-700 transition-colors uppercase tracking-tight",children:[w[le]?p.jsx(PM,{size:16}):p.jsx(kk,{size:16}),p.jsx(dT,{size:16,className:`transition-colors ${w[le]?"text-yellow-500 fill-yellow-500":"text-slate-400"}`}),p.jsx("span",{className:"truncate flex-1 text-[10px]",children:le}),p.jsx("span",{className:"text-[10px] bg-slate-900 text-white px-1.5 rounded font-mono",children:te.length})]}),w[le]&&p.jsx("div",{className:"space-y-0.5 mt-0.5",children:te.map(_e=>p.jsxs("div",{onClick:()=>V(_e),className:`group ml-4 pl-4 pr-2 py-2.5 cursor-pointer border-l-4 transition-all flex justify-between items-center rounded-r-lg ${i?.id===_e.id?"bg-blue-600 border-yellow-400 text-white shadow-md":"border-slate-200 text-slate-500 hover:bg-slate-200/50 hover:border-slate-400"}`,children:[p.jsxs("div",{className:"truncate flex-1",children:[p.jsx("div",{className:"truncate font-bold leading-tight",children:_e.title}),p.jsx("div",{className:`text-[9px] font-black uppercase mt-0.5 ${i?.id===_e.id?"text-blue-100":"text-slate-400"}`,children:_e.trackingStatus})]}),p.jsx("button",{onClick:Q=>{Q.stopPropagation(),t(_e.id)},className:`p-1.5 rounded transition-all transform hover:scale-110 active:scale-95 ${i?.id===_e.id?"text-yellow-400 hover:bg-blue-700":"text-slate-400 hover:bg-white hover:text-blue-600 shadow-sm border border-transparent hover:border-slate-200"}`,title:"",children:p.jsx(ay,{size:16,strokeWidth:2.5})})]},_e.id))})]},le))})]}),p.jsx("div",{className:"flex-1 flex flex-col h-full overflow-hidden bg-white",children:i?p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:"p-4 bg-white border-b-4 border-slate-900 flex flex-col md:flex-row justify-between items-start md:items-center gap-3 z-10",children:[p.jsxs("div",{children:[p.jsxs("h2",{className:"text-xl font-black flex items-center gap-2 text-slate-900 italic uppercase tracking-tighter",children:[p.jsx(vp,{size:20,className:"text-blue-600"})," ",i.title]}),p.jsx("div",{className:"flex items-center gap-2 mt-1",children:p.jsxs("span",{className:"text-[10px] font-black bg-slate-100 px-1.5 py-0.5 rounded text-slate-500 border border-slate-200 uppercase tracking-widest",children:["Folder: ",i.sheetCategory||"Unclassified"]})})]}),p.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[p.jsx("button",{onClick:()=>A(i.id),className:"flex-1 md:flex-none px-4 py-2 text-red-600 hover:bg-red-50 border-2 border-transparent hover:border-red-200 rounded font-black text-xs uppercase transition-all",children:"Delete"}),p.jsx("button",{onClick:H,disabled:x,className:"flex-1 md:flex-none px-6 py-2 bg-slate-900 text-yellow-400 rounded-lg hover:bg-slate-800 flex items-center justify-center gap-2 shadow-[4px_4px_0px_0px_#000] font-black text-xs uppercase tracking-widest active:translate-y-0.5 active:shadow-none transition-all",children:x?"Saving...":"Save Mission"})]})]}),p.jsx("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 bg-slate-50/50",children:p.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[p.jsxs("div",{className:"bg-white p-6 rounded-xl border-2 border-slate-900 shadow-sm",children:[p.jsxs("h3",{className:"text-sm font-black mb-4 text-slate-900 border-b-2 border-slate-100 pb-2 flex items-center gap-2 uppercase italic tracking-tighter",children:[p.jsx(xp,{size:16,className:"text-blue-600"})," Basic Intel"]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[p.jsxs("div",{className:"md:col-span-2",children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest",children:"Mission Title"}),p.jsx("input",{type:"text",value:i.title,onChange:le=>o({...i,title:le.target.value}),className:"w-full border-2 border-slate-200 p-2 rounded-lg font-bold focus:border-slate-900 outline-none transition-colors"})]}),p.jsxs("div",{className:"md:col-span-2",children:[p.jsx("label",{className:"block text-[10px] font-black text-blue-600 mb-1 uppercase tracking-widest",children:"Folder Name (Sorting)"}),p.jsx("input",{list:"category-list",type:"text",value:i.sheetCategory||"",onChange:le=>o({...i,sheetCategory:le.target.value}),className:"w-full border-2 border-blue-200 p-2 rounded-lg font-bold bg-blue-50/50 focus:border-blue-600 outline-none transition-colors",placeholder:"e.g. 2025.12 Jump Festa"}),p.jsx("datalist",{id:"category-list",children:Object.keys(C).map(le=>p.jsx("option",{value:le},le))})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest",children:"Group Type"}),p.jsx("select",{value:i.type||"",onChange:le=>o({...i,type:le.target.value}),className:"w-full border-2 border-slate-200 p-2 rounded-lg font-bold bg-white",children:["","",""].map(le=>p.jsx("option",{value:le,children:le},le))})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest",children:"Tracking Status"}),p.jsx("select",{value:i.trackingStatus||"",onChange:le=>o({...i,trackingStatus:le.target.value}),className:"w-full border-2 border-slate-200 p-2 rounded-lg font-bold bg-white",children:["","","","","","","",""].map(le=>p.jsx("option",{value:le,children:le},le))})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase tracking-widest",children:"Exchange Rate"}),p.jsx("input",{type:"number",step:"0.001",value:i.exchangeRate,onChange:le=>o({...i,exchangeRate:Number(le.target.value)}),className:"w-full border-2 border-slate-200 p-2 rounded-lg font-mono font-bold"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-blue-600 mb-1 uppercase tracking-widest",children:"Domestic Ship ()"}),p.jsx("input",{type:"number",value:i.shippingFee||0,onChange:le=>o({...i,shippingFee:Number(le.target.value)}),className:"w-full border-2 border-blue-100 p-2 rounded-lg font-mono font-bold bg-blue-50/30"})]})]})]}),p.jsxs("div",{className:"bg-white p-6 rounded-xl border-2 border-slate-900 shadow-sm",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4 border-b-2 border-slate-100 pb-2",children:[p.jsxs("h3",{className:"text-sm font-black text-slate-900 flex items-center gap-2 uppercase italic tracking-tighter",children:[p.jsx(ly,{size:16,className:"text-blue-600"})," Items List"]}),p.jsx("button",{onClick:N,className:"px-3 py-1 bg-slate-900 text-white rounded-full text-[10px] font-black uppercase tracking-widest hover:bg-slate-700 transition-colors",children:"+ Add Item"})]}),p.jsx("div",{className:"space-y-2",children:i.items?.map((le,te)=>p.jsxs("div",{className:"flex gap-2 items-center bg-slate-50 p-2 rounded-lg border border-slate-100 group",children:[p.jsx("input",{type:"text",placeholder:"Name",value:le.name,onChange:_e=>D(te,"name",_e.target.value),className:"flex-1 p-1.5 border-2 border-transparent bg-transparent focus:bg-white focus:border-slate-200 rounded text-sm font-bold"}),p.jsx("input",{type:"text",placeholder:"Spec",value:le.spec,onChange:_e=>D(te,"spec",_e.target.value),className:"w-24 p-1.5 border-2 border-transparent bg-transparent focus:bg-white focus:border-slate-200 rounded text-sm font-bold"}),p.jsxs("div",{className:"flex items-center gap-1 bg-white px-2 py-1 rounded border border-slate-200",children:[p.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:""}),p.jsx("input",{type:"number",value:le.price,onChange:_e=>D(te,"price",_e.target.value),className:"w-16 text-sm font-black text-blue-600 outline-none text-right"})]}),p.jsx("button",{onClick:()=>M(te),className:"text-slate-300 hover:text-red-500 transition-colors opacity-0 group-hover:opacity-100",children:p.jsx(ua,{size:18})})]},te))})]}),p.jsxs("div",{className:"bg-white p-6 rounded-xl border-2 border-slate-900 shadow-sm relative overflow-hidden",children:[p.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5 pointer-events-none",children:p.jsx(Rm,{size:120})}),p.jsxs("div",{className:"flex justify-between items-center mb-4 border-b-2 border-slate-100 pb-2",children:[p.jsxs("h3",{className:"text-sm font-black text-slate-900 flex items-center gap-2 uppercase italic tracking-tighter relative z-10",children:[p.jsx(Rm,{size:16,className:"text-blue-600"})," Hero Orders"]}),p.jsx("button",{onClick:F,className:"px-3 py-1 bg-blue-600 text-white rounded-full text-[10px] font-black uppercase tracking-widest hover:bg-blue-700 transition-colors shadow-sm relative z-10",children:"+ New Order"})]}),p.jsx("div",{className:"space-y-4 relative z-10",children:u.map((le,te)=>{const _e=ce(le),Q=Math.ceil(_e*(i.exchangeRate||0));return p.jsxs("div",{className:"border-2 border-slate-200 rounded-xl p-4 bg-slate-50/50 hover:border-blue-200 transition-colors",children:[p.jsxs("div",{className:"flex justify-between items-center mb-3",children:[p.jsxs("select",{value:le.userId,onChange:L=>P(te,L.target.value),className:"p-1.5 border-2 border-slate-200 rounded-lg font-black text-blue-600 bg-white text-sm outline-none focus:border-blue-400",children:[p.jsx("option",{value:"",children:"-- Select Member --"}),n.map(L=>p.jsx("option",{value:L.id,children:L.name},L.id))]}),p.jsxs("div",{className:"text-right flex flex-col items-end",children:[p.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-tighter",children:"Est. Subtotal"}),p.jsxs("div",{className:"font-black text-red-600 italic text-lg",children:["NT$ ",Q.toLocaleString()]})]})]}),p.jsxs("div",{className:"pl-4 border-l-4 border-slate-200 space-y-2",children:[le.items?.map((L,J)=>p.jsxs("div",{className:"flex gap-2 items-center",children:[p.jsxs("select",{value:L.itemId,onChange:Y=>ye(te,J,"itemId",Y.target.value),className:"flex-1 p-1.5 border border-slate-200 rounded bg-white text-xs font-bold",children:[p.jsx("option",{value:"",children:"-- Choose Item --"}),i.items?.map(Y=>p.jsxs("option",{value:Y.id,children:[Y.name," (",Y.price,")"]},Y.id))]}),p.jsxs("div",{className:"flex items-center gap-1 bg-slate-200 px-2 rounded",children:[p.jsx("span",{className:"text-[10px] font-bold text-slate-500",children:"x"}),p.jsx("input",{type:"number",value:L.quantity,onChange:Y=>ye(te,J,"quantity",Y.target.value),className:"w-10 p-1 bg-transparent text-center font-black text-slate-700 outline-none text-xs"})]}),p.jsx("button",{onClick:()=>se(te,J),className:"text-slate-300 hover:text-red-500 transition-colors",children:p.jsx(ua,{size:16})})]},J)),p.jsxs("button",{onClick:()=>be(te),className:"text-[10px] font-black text-blue-500 hover:text-blue-700 transition-colors uppercase tracking-widest flex items-center gap-1 mt-2",children:[p.jsx(ql,{size:12})," Append Item"]})]}),p.jsx("div",{className:"text-right mt-3 pt-2 border-t border-slate-200",children:p.jsx("button",{onClick:()=>j(te),className:"text-[10px] font-bold text-slate-300 hover:text-red-400 transition-colors uppercase italic tracking-tighter",children:"Remove Order Record"})})]},le.id)})})]})]})})]}):p.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-200 bg-slate-50/30 uppercase tracking-[0.2em]",children:[p.jsx(yp,{size:100,strokeWidth:1,className:"mb-4 opacity-20 text-slate-400"}),p.jsx("p",{className:"text-xl font-black italic text-slate-300",children:"Select Mission"})]})})]})},oK=({initialContent:t,onChange:e})=>{const r=re.useRef(null);re.useEffect(()=>{r.current&&r.current.innerHTML!==t&&(r.current.innerHTML=t)},[t]);const n=(o,u=null)=>{document.execCommand(o,!1,u),r.current&&e(r.current.innerHTML)},a=[{name:"Black",value:"#000000"},{name:"Red",value:"#EF4444"},{name:"Orange",value:"#F97316"},{name:"Blue",value:"#3B82F6"}],i=({onClick:o,title:u,children:f})=>p.jsx("button",{type:"button",onClick:o,title:u,className:"p-1.5 hover:bg-slate-200 rounded text-slate-600 transition-colors",children:f});return p.jsxs("div",{className:"border-2 border-slate-900 rounded-lg overflow-hidden flex flex-col h-64 bg-white shadow-sm",children:[p.jsxs("div",{className:"bg-slate-50 border-b-2 border-slate-900 p-2 flex flex-wrap gap-1 items-center",children:[p.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[p.jsx(i,{onClick:()=>n("bold"),title:"",children:p.jsx(RM,{size:14})}),p.jsx(i,{onClick:()=>n("italic"),title:"",children:p.jsx(cP,{size:14})}),p.jsx(i,{onClick:()=>n("underline"),title:"",children:p.jsx(sj,{size:14})})]}),p.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[p.jsx(i,{onClick:()=>n("justifyLeft"),title:"",children:p.jsx(JP,{size:14})}),p.jsx(i,{onClick:()=>n("justifyCenter"),title:"",children:p.jsx(KP,{size:14})}),p.jsx(i,{onClick:()=>n("justifyRight"),title:"",children:p.jsx(YP,{size:14})})]}),p.jsxs("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:[p.jsx(i,{onClick:()=>n("fontSize","5"),title:"",children:p.jsx(W1,{size:16})}),p.jsx(i,{onClick:()=>n("fontSize","3"),title:"",children:p.jsx(W1,{size:12})}),p.jsx(i,{onClick:()=>n("fontSize","1"),title:"",children:p.jsx(W1,{size:10})})]}),p.jsx("div",{className:"flex gap-0.5 border-r border-slate-300 pr-1.5 mr-1.5",children:a.map(o=>p.jsx("button",{type:"button",onClick:()=>n("foreColor",o.value),className:"w-5 h-5 rounded border border-slate-300 hover:scale-110 transition-transform",style:{backgroundColor:o.value},title:o.name},o.value))}),p.jsx(i,{onClick:()=>{const o=prompt(":","http://");o&&n("createLink",o)},title:"",children:p.jsx(Nm,{size:14})})]}),p.jsx("div",{className:"flex-1 p-4 focus:outline-none overflow-y-auto prose prose-slate prose-sm max-w-none",contentEditable:!0,suppressContentEditableWarning:!0,ref:r,onInput:o=>e(o.currentTarget.innerHTML)})]})},cK=["","","","","","","",""],uK=250;function fK({currentUser:t}){const[e,r]=re.useState([]),[n,a]=re.useState({exchangeRate:.24,totalShippingJPY:0,status:"",intlShippingTWD:0,secondPayment:{weights:{},boxWeight:0,minChargeDiff:0}}),[i,o]=re.useState(!0),[u,f]=re.useState(!1);re.useEffect(()=>{const w=Et(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),E=pn(w,b=>{if(b.exists()){const T=b.data(),R=(T.orders||[]).sort((C,G)=>C.buyer.localeCompare(G.buyer)||C.id-G.id);r(R),a({exchangeRate:.24,totalShippingJPY:0,status:"",intlShippingTWD:0,secondPayment:{weights:{},boxWeight:0,minChargeDiff:0},...T.settings})}o(!1)});return()=>E()},[]);const d=(w,E,b)=>{r(T=>T.map(I=>I.id===w?{...I,[E]:b}:I)),f(!0)},m=async()=>{try{await q0(Et(Ke,"artifacts","default-app-id","public","data","jf26_calc_data","main"),{orders:e,settings:n,updatedAt:new Date().toISOString(),updatedBy:t?.name||""}),f(!1),alert("JF26 ")}catch(w){alert(""+w.message)}},x=re.useMemo(()=>{const w=new Set;return e.filter(E=>E.isBought&&!w.has(E.name)?(w.add(E.name),!0):!1)},[e]),y=re.useMemo(()=>e.reduce((w,E)=>E.isBought?w+E.quantity:w,0),[e]);return i?p.jsx("div",{className:"p-10 text-center font-black text-slate-400 animate-pulse",children:" JF26 ..."}):p.jsxs("div",{className:"space-y-6 p-4",children:[p.jsxs("div",{className:"bg-white p-6 rounded-2xl border-4 border-slate-900 shadow-[6px_6px_0px_0px_#0f172a]",children:[p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase",children:""}),p.jsx("select",{value:n.status,onChange:w=>{a({...n,status:w.target.value}),f(!0)},className:"w-full font-bold border-2 border-slate-200 rounded-lg px-2 py-1.5 focus:border-yellow-400 outline-none bg-white",children:cK.map(w=>p.jsx("option",{value:w,children:w},w))})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase",children:""}),p.jsx("input",{type:"number",step:"0.001",value:n.exchangeRate,onChange:w=>{a({...n,exchangeRate:parseFloat(w.target.value)||0}),f(!0)},className:"w-full font-mono font-bold border-2 border-slate-200 rounded-lg py-1.5 px-3"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-400 mb-1 uppercase",children:" (JPY)"}),p.jsx("input",{type:"number",value:n.totalShippingJPY,onChange:w=>{a({...n,totalShippingJPY:parseFloat(w.target.value)||0}),f(!0)},className:"w-full font-mono font-bold border-2 border-slate-200 rounded-lg py-1.5 px-3"})]}),p.jsx("div",{className:"flex items-end",children:p.jsxs("button",{onClick:m,disabled:!u,className:`w-full flex items-center justify-center gap-2 py-2.5 rounded-xl font-black transition-all ${u?"bg-red-500 text-white shadow-[4px_4px_0px_0px_#7f1d1d] hover:-translate-y-1":"bg-slate-100 text-slate-300 cursor-not-allowed border-2 border-slate-200"}`,children:[p.jsx(nc,{size:18})," "]})})]}),p.jsxs("div",{className:"border-t-2 border-slate-100 pt-6",children:[p.jsxs("h3",{className:"text-sm font-black mb-4 flex items-center gap-2 uppercase italic text-blue-600",children:[p.jsx(oy,{size:18})," JF26  (1kg = ",uK,")"]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[p.jsx("div",{className:"space-y-4",children:p.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200",children:[p.jsx("label",{className:"block text-xs font-black text-slate-500 mb-2 uppercase",children:" (kg)"}),p.jsx("input",{type:"number",step:"0.01",value:n.secondPayment.boxWeight,onChange:w=>{a({...n,secondPayment:{...n.secondPayment,boxWeight:w.target.value}}),f(!0)},className:"w-full bg-white border-2 border-slate-200 rounded-lg p-2 font-mono font-black text-blue-600"}),p.jsxs("p",{className:"text-[9px] text-slate-400 mt-2 italic",children:["*  ",y," "]})]})}),p.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border-2 border-slate-200 max-h-60 overflow-y-auto",children:[p.jsx("label",{className:"block text-xs font-black text-slate-500 mb-3 uppercase tracking-tighter",children:""}),p.jsx("div",{className:"space-y-2",children:x.map(w=>p.jsxs("div",{className:"flex items-center gap-2 bg-white p-2 rounded-lg border border-slate-200 group",children:[p.jsx("span",{className:"flex-1 text-[11px] font-bold truncate text-slate-600",title:w.name,children:w.name}),p.jsxs("div",{className:"flex items-center gap-1",children:[p.jsx("input",{type:"number",step:"0.001",placeholder:"0.000",value:n.secondPayment.weights[w.name]||"",onChange:E=>{const b={...n.secondPayment.weights,[w.name]:E.target.value};a({...n,secondPayment:{...n.secondPayment,weights:b}}),f(!0)},className:"w-20 text-right font-mono font-black text-blue-600 border-b border-slate-200 outline-none text-xs"}),p.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"kg"})]})]},w.id))})]})]})]})]}),p.jsx("div",{className:"bg-white border-4 border-slate-900 rounded-2xl overflow-hidden shadow-[8px_8px_0px_0px_#0f172a]",children:p.jsx("div",{className:"overflow-x-auto",children:p.jsxs("table",{className:"w-full text-left border-collapse",children:[p.jsx("thead",{children:p.jsxs("tr",{className:"bg-slate-900 text-white text-[10px] uppercase font-black tracking-widest",children:[p.jsx("th",{className:"p-4 w-24",children:""}),p.jsx("th",{className:"p-4",children:""}),p.jsx("th",{className:"p-4 text-center w-20",children:""}),p.jsx("th",{className:"p-4 text-right w-28",children:"()"}),p.jsx("th",{className:"p-4 text-center w-20",children:""}),p.jsx("th",{className:"p-4 text-center w-32",children:""}),p.jsx("th",{className:"p-4 text-center w-32",children:""}),p.jsx("th",{className:"p-4 text-center w-16",children:""})]})}),p.jsx("tbody",{className:"divide-y-2 divide-slate-100 font-bold text-sm",children:e.map(w=>p.jsxs("tr",{className:`hover:bg-slate-50 transition-colors ${!w.isBought&&"bg-red-50/50 opacity-60"}`,children:[p.jsx("td",{className:"p-4 font-black text-blue-600 italic",children:w.buyer}),p.jsx("td",{className:"p-4",children:p.jsxs("div",{className:"flex flex-col",children:[p.jsx("span",{className:"text-[10px] text-slate-400 uppercase",children:w.ip}),p.jsx("span",{className:"truncate max-w-[220px]",children:w.name})]})}),p.jsx("td",{className:"p-4 text-center font-mono",children:w.quantity}),p.jsx("td",{className:"p-4",children:p.jsx("input",{type:"number",value:w.price,onChange:E=>d(w.id,"price",E.target.value),className:"w-full text-right font-mono bg-transparent border-b border-dashed border-slate-300 focus:border-slate-900 outline-none"})}),p.jsx("td",{className:"p-4 text-center",children:p.jsx("input",{type:"checkbox",checked:w.isBought,onChange:E=>d(w.id,"isBought",E.target.checked),className:"w-5 h-5 accent-slate-900"})}),p.jsx("td",{className:"p-4 text-center",children:p.jsxs("select",{value:w.paymentStatus||"",onChange:E=>d(w.id,"paymentStatus",E.target.value),className:`text-[10px] font-black border-2 rounded px-2 py-1 outline-none ${w.paymentStatus===""?"bg-green-100 border-green-500 text-green-700":"bg-white border-red-300 text-red-500"}`,children:[p.jsx("option",{value:"",children:""}),p.jsx("option",{value:"",children:""})]})}),p.jsx("td",{className:"p-4 text-center",children:p.jsxs("select",{value:w.shippingPaymentStatus||"",onChange:E=>d(w.id,"shippingPaymentStatus",E.target.value),className:`text-[10px] font-black border-2 rounded px-2 py-1 outline-none ${w.shippingPaymentStatus===""?"bg-purple-100 border-purple-500 text-purple-700":"bg-slate-50 border-slate-300 text-slate-400"}`,children:[p.jsx("option",{value:"",children:""}),p.jsx("option",{value:"",children:""})]})}),p.jsx("td",{className:"p-4 text-center",children:p.jsx("button",{onClick:()=>batchUpdatePrice(w.ip,w.name,w.price),className:"p-1.5 text-slate-400 hover:text-slate-900 hover:bg-slate-200 rounded",title:"",children:p.jsx(RP,{size:14})})})]},w.id))})]})})}),u&&p.jsxs("div",{className:"fixed bottom-6 right-6 flex items-center gap-3 bg-red-600 text-white px-6 py-4 rounded-2xl shadow-2xl border-4 border-white animate-bounce z-50",children:[p.jsx(Bk,{size:24}),p.jsx("span",{className:"font-black uppercase tracking-widest",children:"Unsaved Changes!"})]})]})}const hK=t=>new Promise(e=>{const r=new FileReader;r.readAsDataURL(t),r.onload=n=>{const a=new Image;a.src=n.target.result,a.onload=()=>{const i=document.createElement("canvas"),o=800,u=800;let f=a.width,d=a.height;f>d?f>o&&(d*=o/f,f=o):d>u&&(f*=u/d,d=u),i.width=f,i.height=d,i.getContext("2d").drawImage(a,0,0,f,d),e(i.toDataURL("image/jpeg",.7))}}});function dK({onSubmit:t,onCancel:e,initialData:r=null,submitLabel:n=""}){const[a,i]=re.useState(r?.title||""),[o,u]=re.useState(r?.type||""),[f,d]=re.useState(()=>r?.images?.filter(M=>M.startsWith("http"))?.join(", ")||""),[m,x]=re.useState(()=>r?.images?.filter(M=>M.startsWith("data:"))||[]),[y,w]=re.useState(r?.infoUrl||""),[E,b]=re.useState(()=>r?.deadline?r.deadline.slice(0,16):""),[T,I]=re.useState(r?.releaseDate||""),[R,C]=re.useState(r?.items||[{id:1,name:"",spec:"",price:"",limit:"",image:""}]),G=()=>C([...R,{id:Date.now(),name:"",spec:"",price:"",limit:"",image:""}]),V=(M,F,j)=>C(R.map(P=>P.id===M?{...P,[F]:j}:P)),H=M=>R.length>1?C(R.filter(F=>F.id!==M)):C([{id:Date.now(),name:"",spec:"",price:"",limit:"",image:""}]),A=(M,F)=>{const j=[...R];F==="up"&&M>0&&([j[M-1],j[M]]=[j[M],j[M-1]]),F==="down"&&M<j.length-1&&([j[M+1],j[M]]=[j[M],j[M+1]]),C(j)},D=async M=>{if(M.target.files){const F=Array.from(M.target.files),j=await Promise.all(F.map(P=>hK(P)));x(P=>[...P,...j]),M.target.value=null}},N=()=>{if(!a||!E)return alert("");const M=R.filter(j=>j.name&&j.price);if(M.length===0)return alert("/");const F=f.split(",").map(j=>j.trim()).filter(j=>j);t({title:a,type:o,images:[...F,...m],infoUrl:y,deadline:E,releaseDate:T,items:M})};return p.jsxs("form",{onSubmit:M=>{M.preventDefault(),N()},className:"space-y-4",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(ly,{size:16}),"  ()"]}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:a,onChange:M=>i(M.target.value),placeholder:" 6  BD ",required:!0})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(bu,{size:16})," "]}),p.jsxs("div",{className:"flex gap-2 text-xs sm:text-sm",children:[p.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg py-2 px-1 text-center font-black transition-all ${o===""?"bg-slate-900 text-yellow-400 border-slate-900 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[p.jsx("input",{type:"radio",className:"hidden",name:"groupType",value:"",checked:o==="",onChange:()=>u("")})," "]}),p.jsxs("label",{className:`flex-1 cursor-pointer border-2 rounded-lg py-2 px-1 text-center font-black transition-all ${o===""?"bg-green-600 text-white border-green-800 shadow-md transform -translate-y-0.5":"bg-white text-slate-400 border-slate-200 hover:border-slate-400"}`,children:[p.jsx("input",{type:"radio",className:"hidden",name:"groupType",value:"",checked:o==="",onChange:()=>u("")})," "]})]})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(K0,{size:16}),"  ()"]}),p.jsx("textarea",{className:"w-full border-2 border-slate-900 rounded p-2 text-sm h-16 focus:outline-none focus:ring-4 focus:ring-yellow-400 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:f,onChange:M=>d(M.target.value),placeholder:" ()"})]}),p.jsxs("div",{className:"flex flex-col gap-2 p-3 border-2 border-dashed border-slate-300 rounded-lg bg-slate-100",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 flex items-center gap-2",children:[p.jsx(uy,{size:16})," "]}),p.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:D,className:"block w-full text-sm text-slate-700 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-2 file:border-red-800 file:text-xs file:font-black file:bg-red-600 file:text-white hover:file:bg-red-700 cursor-pointer"}),m.length>0&&p.jsx("div",{className:"flex gap-2 overflow-x-auto py-2 pb-4",children:m.map((M,F)=>p.jsxs("div",{className:"relative shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 border-slate-900 shadow",children:[p.jsx("img",{src:M,className:"w-full h-full object-cover",alt:"preview"}),p.jsx("button",{type:"button",onClick:()=>x(j=>j.filter((P,be)=>be!==F)),className:"absolute top-0 right-0 bg-red-600 text-white rounded-full p-1 transform translate-x-1/3 -translate-y-1/3 border-2 border-white hover:bg-red-700 transition-all",children:p.jsx(ua,{size:12})})]},F))})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(Nm,{size:16})," / ()"]}),p.jsx("input",{className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:y,onChange:M=>w(M.target.value),placeholder:"https://shueisha.co.jp/..."})]}),p.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsxs("label",{className:"text-sm font-black italic text-slate-900 mb-1 flex items-center gap-1",children:[p.jsx(OM,{size:16})," / ()"]}),p.jsx("input",{type:"datetime-local",className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:E,onChange:M=>b(M.target.value),required:!0})]}),p.jsxs("div",{className:"flex flex-col gap-1",children:[p.jsx("label",{className:"text-sm font-black italic text-slate-900 mb-1",children:" ()"}),p.jsx("input",{type:"date",className:"w-full border-2 border-slate-900 rounded p-2 focus:outline-none focus:ring-4 focus:ring-yellow-400 focus:border-slate-900 font-bold bg-slate-50 placeholder:text-slate-400 transition-all",value:T,onChange:M=>I(M.target.value)})]})]}),p.jsxs("div",{className:"bg-slate-100 p-4 rounded-xl border-2 border-slate-300",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4 flex-wrap gap-2",children:[p.jsx("h4",{className:"font-black italic text-lg text-slate-900 transform -skew-x-3",children:o===""?" (ITEMS)":" (ITEMS)"}),p.jsx("button",{type:"button",onClick:G,className:"text-sm font-black px-3 py-1 bg-yellow-400 text-slate-900 rounded border-2 border-slate-900 hover:bg-yellow-500 transition-all",children:"+ "})]}),p.jsx("div",{className:"space-y-4",children:R.map((M,F)=>p.jsxs("div",{className:"bg-white p-3 rounded-lg border-2 border-slate-900 relative flex gap-3 items-start shadow-[2px_2px_0px_0px_rgba(15,23,42,1)]",children:[p.jsxs("div",{className:"flex flex-col gap-1 justify-center pt-1",children:[p.jsxs("span",{className:"text-xl font-black text-red-600 italic leading-none",children:[F+1,"."]}),p.jsx("button",{type:"button",onClick:()=>A(F,"up"),disabled:F===0,className:"text-slate-400 hover:text-blue-600 disabled:opacity-30 p-0.5",children:p.jsx(CM,{size:16})}),p.jsx("button",{type:"button",onClick:()=>A(F,"down"),disabled:F===R.length-1,className:"text-slate-400 hover:text-blue-600 disabled:opacity-30 p-0.5",children:p.jsx(Sk,{size:16})})]}),p.jsxs("div",{className:"flex-1 grid grid-cols-12 gap-2",children:[p.jsx("div",{className:"col-span-12 sm:col-span-7",children:p.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm bg-slate-50 focus:bg-white focus:ring-2 focus:ring-yellow-400 font-bold placeholder:font-normal",placeholder:"",value:M.name,onChange:j=>V(M.id,"name",j.target.value),required:!0})}),p.jsxs("div",{className:"col-span-12 sm:col-span-5 relative",children:[p.jsx("div",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-slate-400",children:p.jsx(Nm,{size:14})}),p.jsx("input",{className:"w-full border-2 border-slate-300 p-2 pl-7 rounded text-sm text-slate-700 focus:ring-2 focus:ring-yellow-400",placeholder:"",value:M.image||"",onChange:j=>V(M.id,"image",j.target.value)}),M.image&&p.jsx("div",{className:"absolute right-1 top-1/2 -translate-y-1/2 w-6 h-6 rounded border-2 border-slate-900 bg-slate-100 overflow-hidden shadow",children:p.jsx("img",{src:M.image,className:"w-full h-full object-cover",onError:j=>j.target.style.display="none"})})]}),p.jsx("div",{className:"col-span-6 sm:col-span-5",children:p.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400",placeholder:"",value:M.spec,onChange:j=>V(M.id,"spec",j.target.value)})}),p.jsx("div",{className:"col-span-3 sm:col-span-4",children:p.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400 font-black text-red-600",type:"number",placeholder:"",value:M.price,onChange:j=>V(M.id,"price",j.target.value),required:!0})}),p.jsx("div",{className:"col-span-3 sm:col-span-3",children:p.jsx("input",{className:"w-full border-2 border-slate-900 p-2 rounded text-sm focus:ring-2 focus:ring-yellow-400",type:"number",placeholder:"",value:M.limit,onChange:j=>V(M.id,"limit",j.target.value)})})]}),p.jsx("button",{type:"button",onClick:()=>H(M.id),className:"text-red-600 hover:text-red-800 p-1 mt-1 shrink-0",children:p.jsx(ua,{size:18})})]},M.id))})]}),p.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[p.jsxs("button",{type:"button",onClick:e,className:"px-6 py-2 rounded bg-white text-slate-900 border-2 border-slate-900 hover:bg-slate-100 font-bold italic transition-all",children:[p.jsx(ua,{size:16,className:"inline mr-1"})," "]}),p.jsxs("button",{type:"submit",className:"px-6 py-2 rounded bg-slate-900 text-yellow-400 border-2 border-slate-900 hover:bg-slate-700 font-black italic shadow-[4px_4px_0px_0px_#FACC15] active:translate-y-0.5 active:shadow-none transition-all",children:[p.jsx(nc,{size:16,className:"inline mr-1"})," ",n]})]})]})}function mK({currentUser:t}){const e=O0(),[r,n]=re.useState("groups"),[a,i]=re.useState(""),[o,u]=re.useState(""),[f,d]=re.useState([]),[m,x]=re.useState([]),[y,w]=re.useState([]),[E,b]=re.useState([]),[T,I]=re.useState(!1),[R,C]=re.useState({title:"",amount:"",targetUserId:"",note:"",paymentStatus:""}),[G,V]=re.useState(null),H=t?.name===""||t?.id==="yeye",A=y.find(P=>P.id===G);if(re.useEffect(()=>{if(!H)return;const P=pn(Et(Ke,"artifacts","default-app-id","public","data","system","bulletin"),le=>{le.exists()&&(i(le.data().content),u(le.data().content))}),be=pn(qt(Ke,"artifacts","default-app-id","public","data","miscCharges"),le=>d(le.docs.map(te=>({id:te.id,...te.data()})))),ye=pn(qt(Ke,"artifacts","default-app-id","public","data","users"),le=>x(le.docs.map(te=>({id:te.id,...te.data()})))),se=pn(qt(Ke,"artifacts","default-app-id","public","data","groups"),le=>w(le.docs.map(te=>({id:te.id,...te.data()})))),ce=pn(qt(Ke,"artifacts","default-app-id","public","data","orders"),le=>b(le.docs.map(te=>({id:te.id,...te.data()}))));return()=>{P(),be(),ye(),se(),ce()}},[H]),!H)return p.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-100",children:p.jsxs("div",{className:"bg-white p-10 rounded-2xl border-4 border-slate-900 shadow-[8px_8px_0px_0px_#ef4444] text-center",children:[p.jsx("h2",{className:"text-3xl font-black text-red-500 mb-4 italic",children:"ACCESS DENIED"}),p.jsx("p",{className:"font-bold text-slate-600",children:""}),p.jsx("button",{onClick:()=>e("/"),className:"mt-6 px-6 py-2 bg-slate-900 text-white font-bold rounded",children:""})]})});const D=async P=>{try{await Bs(qt(Ke,"artifacts","default-app-id","public","data","groups"),{...P,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"",createdBy:"",exchangeRate:P.exchangeRate||.21,shippingFee:0,secondPayment:{},paymentStatus:""}),I(!1),alert("")}catch{alert("")}},N=async()=>{try{await q0(Et(Ke,"artifacts","default-app-id","public","data","system","bulletin"),{content:o},{merge:!0}),i(o),alert("")}catch{alert("")}},M=async()=>{if(!R.title||!R.amount||!R.targetUserId){alert("");return}try{const P=m.find(be=>be.id===R.targetUserId);await Bs(qt(Ke,"artifacts","default-app-id","public","data","miscCharges"),{...R,amount:Number(R.amount),targetUserName:P?P.name:"Unknown",createdAt:new Date().toISOString()}),C({title:"",amount:"",targetUserId:"",note:"",paymentStatus:""}),alert("")}catch(P){console.error(P)}},F=async(P,be)=>{try{await Br(Et(Ke,"artifacts","default-app-id","public","data","miscCharges",P),{paymentStatus:be})}catch(ye){console.error(ye)}},j=async P=>{if(confirm(""))try{await wu(Et(Ke,"artifacts","default-app-id","public","data","miscCharges",P))}catch(be){console.error(be)}};return p.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col font-sans text-slate-800",children:[p.jsx("header",{className:"bg-slate-900 text-white shadow-md z-50 sticky top-0",children:p.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:p.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center py-4 gap-4",children:[p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("button",{onClick:()=>e("/"),className:"text-gray-400 hover:text-white transition-colors flex items-center gap-1",children:[p.jsx(Ak,{size:20}),p.jsx("span",{className:"hidden sm:inline",children:""})]}),p.jsx("h1",{className:"text-xl font-black italic tracking-wider border-l border-gray-700 pl-4 text-yellow-400",children:"HERO ADMIN"})]}),p.jsx("nav",{className:"flex flex-wrap justify-center gap-2 bg-slate-800 p-1 rounded-lg",children:[{id:"groups",label:"",icon:dP},{id:"misc",label:"",icon:Ik},{id:"js_orders",label:"JF26",icon:jk},{id:"import",label:"Excel",icon:Rk},{id:"bulletin",label:"",icon:zx},{id:"users",label:"",icon:vT}].map(P=>p.jsxs("button",{onClick:()=>n(P.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-black transition-all ${r===P.id?"bg-yellow-400 text-slate-900 shadow-lg":"text-gray-400 hover:text-white hover:bg-slate-700"}`,children:[p.jsx(P.icon,{size:14}),P.label]},P.id))})]})})}),p.jsx("main",{className:"flex-1 overflow-auto p-4 sm:p-8",children:p.jsxs("div",{className:"max-w-7xl mx-auto",children:[r==="import"&&p.jsx(iK,{}),r==="groups"&&p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{className:"flex justify-between items-center",children:[p.jsx("h2",{className:"text-2xl font-black italic text-slate-800",children:""}),p.jsxs("button",{onClick:()=>I(!0),className:"px-6 py-2 bg-slate-900 text-white rounded font-black hover:bg-slate-700 flex items-center gap-2 shadow-[4px_4px_0px_0px_#FACC15] transition-all italic",children:[p.jsx(ql,{size:18})," "]})]}),p.jsx(lK,{onOpenSecondPay:P=>V(P)})]}),r==="js_orders"&&p.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4",children:[p.jsxs("div",{className:"mb-6 px-4",children:[p.jsx("h2",{className:"text-2xl font-black text-slate-800 italic",children:"JF26 JS ONLINE "}),p.jsx("p",{className:"text-slate-500 font-bold text-sm",children:""})]}),p.jsx(fK,{currentUser:t})]}),r==="users"&&p.jsxs("div",{className:"bg-white p-10 rounded-2xl border-4 border-slate-900 text-center font-bold text-slate-400",children:[p.jsx(vT,{size:48,className:"mx-auto mb-4 opacity-20"}),"..."]}),r==="bulletin"&&p.jsxs("div",{className:"bg-white p-6 rounded-lg shadow border-4 border-slate-900",children:[p.jsxs("div",{className:"flex justify-between items-center mb-4 pb-2 border-b-2",children:[p.jsxs("h2",{className:"text-xl font-black flex items-center gap-2 italic",children:[p.jsx(zx,{className:"text-yellow-500"})," "]}),p.jsxs("button",{onClick:N,className:"px-4 py-2 rounded bg-slate-900 text-yellow-400 font-black hover:bg-slate-800 flex items-center gap-2 shadow-[3px_3px_0px_0px_#ccc]",children:[p.jsx(nc,{size:18})," "]})]}),p.jsx(oK,{initialContent:o,onChange:u})]}),r==="misc"&&p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-white p-6 rounded-lg shadow border-4 border-slate-900",children:[p.jsxs("h2",{className:"text-lg font-black mb-4 flex items-center gap-2 text-slate-700 italic",children:[p.jsx(ql,{className:"text-green-600"})," "]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:""}),p.jsxs("select",{className:"w-full border-2 border-slate-200 p-2 rounded font-bold",value:R.targetUserId,onChange:P=>C({...R,targetUserId:P.target.value}),children:[p.jsx("option",{value:"",children:"--  --"}),m.map(P=>p.jsx("option",{value:P.id,children:P.name},P.id))]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:""}),p.jsx("input",{type:"text",className:"w-full border-2 border-slate-200 p-2 rounded font-bold",placeholder:"/",value:R.title,onChange:P=>C({...R,title:P.target.value})})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-[10px] font-black text-slate-500 mb-1",children:" (TWD)"}),p.jsx("input",{type:"number",className:"w-full border-2 border-slate-200 p-2 rounded font-bold",placeholder:"0",value:R.amount,onChange:P=>C({...R,amount:P.target.value})})]}),p.jsx("button",{onClick:M,className:"bg-slate-900 text-yellow-400 p-2.5 rounded font-black hover:bg-slate-800 transition-colors",children:""})]})]}),p.jsx("div",{className:"bg-white rounded-lg shadow border-4 border-slate-900 overflow-hidden",children:p.jsxs("table",{className:"w-full text-sm text-left font-bold",children:[p.jsx("thead",{className:"bg-slate-900 text-white border-b",children:p.jsxs("tr",{children:[p.jsx("th",{className:"px-4 py-3 italic",children:"DATE"}),p.jsx("th",{className:"px-4 py-3",children:"HERO"}),p.jsx("th",{className:"px-4 py-3",children:"TITLE"}),p.jsx("th",{className:"px-4 py-3 text-right",children:"AMOUNT"}),p.jsx("th",{className:"px-4 py-3 text-center",children:"STATUS"}),p.jsx("th",{className:"px-4 py-3 text-center",children:"ACTION"})]})}),p.jsx("tbody",{children:f.sort((P,be)=>new Date(be.createdAt)-new Date(P.createdAt)).map(P=>p.jsxs("tr",{className:"border-b hover:bg-slate-50",children:[p.jsx("td",{className:"px-4 py-3 text-slate-400 font-mono text-xs",children:new Date(P.createdAt).toLocaleDateString()}),p.jsx("td",{className:"px-4 py-3 text-blue-700",children:P.targetUserName}),p.jsx("td",{className:"px-4 py-3",children:P.title}),p.jsxs("td",{className:"px-4 py-3 text-right font-mono",children:["$",P.amount]}),p.jsx("td",{className:"px-4 py-3 text-center",children:p.jsxs("select",{className:`text-[10px] font-black border-2 rounded px-1.5 py-0.5 ${P.paymentStatus===""?"bg-green-100 text-green-700 border-green-300":"bg-red-100 text-red-700 border-red-300"}`,value:P.paymentStatus||"",onChange:be=>F(P.id,be.target.value),children:[p.jsx("option",{value:"",children:""}),p.jsx("option",{value:"",children:""})]})}),p.jsx("td",{className:"px-4 py-3 text-center",children:p.jsx("button",{onClick:()=>j(P.id),className:"text-slate-300 hover:text-red-600 transition-colors",children:p.jsx(_p,{size:16})})})]},P.id))})]})})]})]})}),p.jsx($n,{isOpen:T,onClose:()=>I(!1),title:"",children:p.jsx(dK,{onSubmit:D,onCancel:()=>I(!1),submitLabel:""})}),p.jsx($n,{isOpen:!!G,onClose:()=>V(null),title:"",children:A&&p.jsx(d3,{group:A,orders:E.filter(P=>P.groupId===A.id),currentUser:t,onUpdate:async P=>{await Br(Et(Ke,"artifacts","default-app-id","public","data","groups",A.id),{secondPayment:P}),alert(""),V(null)},isReadOnly:!1})})]})}function pK(){const[t,e]=re.useState(null),[r,n]=re.useState(null),[a,i]=re.useState(!0),[o,u]=re.useState([]),f=re.useCallback(()=>{n(null),localStorage.removeItem("app_user_id"),i(!1)},[]);re.useEffect(()=>((async()=>{try{X1.currentUser||await Q9(X1)}catch(x){console.error("Firebase ",x)}})(),nF(X1,x=>{e(x)})),[]),re.useEffect(()=>{if(!t)return;const m=pn(qt(Ke,"artifacts","default-app-id","public","data","users"),w=>{const E=w.docs.map(b=>({id:b.id,...b.data()}));u(E)}),x=localStorage.getItem("app_user_id");let y=()=>{};return x?y=pn(Et(Ke,"artifacts","default-app-id","public","data","users",x),w=>{w.exists()?(n({id:w.id,...w.data()}),i(!1)):f()},()=>f()):i(!1),()=>{m(),y()}},[t,f]);const d=(m,x)=>{const y=typeof m=="object"&&m!==null?m.id:m,w=o.find(E=>E.id===y);w&&String(w.password).trim()===String(x).trim()?(localStorage.setItem("app_user_id",w.id),n(w),i(!1)):alert("")};return a?p.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-slate-900 text-yellow-400",children:[p.jsx("div",{className:"flex items-center gap-2 mb-4 animate-bounce",children:p.jsx(BP,{size:80,className:"text-yellow-400 drop-shadow-[0_0_15px_rgba(250,204,21,0.5)]"})}),p.jsx("p",{className:"text-3xl font-black italic tracking-widest animate-pulse",children:"PLUS ULTRA..."})]}):p.jsx(p5,{children:p.jsxs("div",{className:"relative min-h-screen",children:[r&&p.jsx(WL,{}),p.jsxs(WR,{children:[p.jsx(Vf,{path:"/",element:r?p.jsx(Sd,{to:"/home",replace:!0}):p.jsx(yj,{users:o,onLogin:d})}),p.jsx(Vf,{path:"/home",element:r?p.jsx(sK,{appUser:r,usersData:o,handleLogout:f}):p.jsx(Sd,{to:"/",replace:!0})}),p.jsx(Vf,{path:"/jf26",element:r?p.jsx(VL,{currentUser:r}):p.jsx(Sd,{to:"/",replace:!0})}),p.jsx(Vf,{path:"/admin/dashboard",element:r?.name===""?p.jsx(mK,{currentUser:r}):p.jsx(Sd,{to:"/home",replace:!0})})]})]})})}eR.createRoot(document.getElementById("root")).render(p.jsx(Xs.StrictMode,{children:p.jsx(pK,{})}));
